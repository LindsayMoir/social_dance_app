2025-06-18 12:41:21 [scrapy.utils.log] INFO: Scrapy 2.13.0 started (bot: scrapybot)
2025-06-18 12:41:21 [scrapy.utils.log] INFO: Versions:
{'lxml': '5.4.0',
 'libxml2': '2.13.8',
 'cssselect': '1.3.0',
 'parsel': '1.10.0',
 'w3lib': '2.3.1',
 'Twisted': '24.11.0',
 'Python': '3.11.7 (main, Dec 15 2023, 18:12:31) [GCC 11.2.0]',
 'pyOpenSSL': '25.0.0 (OpenSSL 3.4.1 11 Feb 2025)',
 'cryptography': '44.0.3',
 'Platform': 'Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.35'}
2025-06-18 12:41:21 [root] INFO: 

scraper.py starting...
2025-06-18 12:41:21 [scrapy.addons] INFO: Enabled addons:
[]
2025-06-18 12:41:21 [scrapy.extensions.telnet] INFO: Telnet Password: b32e9033e2c4be89
2025-06-18 12:41:21 [scrapy.middleware] INFO: Enabled extensions:
['scrapy.extensions.corestats.CoreStats',
 'scrapy.extensions.telnet.TelnetConsole',
 'scrapy.extensions.memusage.MemoryUsage',
 'scrapy.extensions.feedexport.FeedExporter',
 'scrapy.extensions.logstats.LogStats']
2025-06-18 12:41:21 [scrapy.crawler] INFO: Overridden settings:
{'DEPTH_LIMIT': 2, 'LOG_FILE': 'scraper_log', 'LOG_LEVEL': 'INFO'}
2025-06-18 12:41:21 [scrapy.middleware] INFO: Enabled downloader middlewares:
['scrapy.downloadermiddlewares.offsite.OffsiteMiddleware',
 'scrapy.downloadermiddlewares.httpauth.HttpAuthMiddleware',
 'scrapy.downloadermiddlewares.downloadtimeout.DownloadTimeoutMiddleware',
 'scrapy.downloadermiddlewares.defaultheaders.DefaultHeadersMiddleware',
 'scrapy.downloadermiddlewares.useragent.UserAgentMiddleware',
 'scrapy.downloadermiddlewares.retry.RetryMiddleware',
 'scrapy.downloadermiddlewares.redirect.MetaRefreshMiddleware',
 'scrapy.downloadermiddlewares.httpcompression.HttpCompressionMiddleware',
 'scrapy.downloadermiddlewares.redirect.RedirectMiddleware',
 'scrapy.downloadermiddlewares.cookies.CookiesMiddleware',
 'scrapy.downloadermiddlewares.httpproxy.HttpProxyMiddleware',
 'scrapy.downloadermiddlewares.stats.DownloaderStats']
2025-06-18 12:41:21 [scrapy.middleware] INFO: Enabled spider middlewares:
['scrapy.spidermiddlewares.start.StartSpiderMiddleware',
 'scrapy.spidermiddlewares.httperror.HttpErrorMiddleware',
 'scrapy.spidermiddlewares.referer.RefererMiddleware',
 'scrapy.spidermiddlewares.urllength.UrlLengthMiddleware',
 'scrapy.spidermiddlewares.depth.DepthMiddleware']
2025-06-18 12:41:21 [scrapy.middleware] INFO: Enabled item pipelines:
[]
2025-06-18 12:41:21 [scrapy.core.engine] INFO: Spider opened
2025-06-18 12:41:21 [py.warnings] WARNING: /home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/spidermw.py:433: ScrapyDeprecationWarning: __main__.EventSpider defines the deprecated start_requests() method. start_requests() has been deprecated in favor of a new method, start(), to support asynchronous code execution. start_requests() will stop being called in a future version of Scrapy. If you use Scrapy 2.13 or higher only, replace start_requests() with start(); note that start() is a coroutine (async def). If you need to maintain compatibility with lower Scrapy versions, when overriding start_requests() in a spider class, override start() as well; you can use super() to reuse the inherited start() implementation without copy-pasting. See the release notes of Scrapy 2.13 for details: https://docs.scrapy.org/en/2.13/news.html
  warn(

2025-06-18 12:41:21 [scrapy.extensions.logstats] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 12:41:21 [scrapy.extensions.telnet] INFO: Telnet console listening on 127.0.0.1:6023
2025-06-18 12:41:21 [root] INFO: def start_requests(): Connected to the database: Engine(postgresql://postgres:***@localhost/social_dance_db)
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.redhotswing.com/ was last seen as not relevant but hit_ratio (1.33) > 0.1 or crawl_try (7) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.redhotswing.com/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://vlda.ca/resources/ was last seen as not relevant but hit_ratio (0.75) > 0.1 or crawl_try (7) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://vlda.ca/resources/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.victoriawestcoastswing.com/ was last seen as not relevant but hit_ratio (11.50) > 0.1 or crawl_try (25) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.victoriawestcoastswing.com/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://calientedance.com/classes/ was last seen as not relevant but hit_ratio (2.00) > 0.1 or crawl_try (9) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://calientedance.com/classes/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://calientedance.com/ was last seen as not relevant but hit_ratio (0.67) > 0.1 or crawl_try (5) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://calientedance.com/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://latindancecanada.com/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://latindancecanada.com/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.facebook.com/groups/1634269246863069/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/1634269246863069/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.facebook.com/groups/265269613666246/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/265269613666246/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.facebook.com/groups/3158235040/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/3158235040/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.facebook.com/groups/cubansalsaclub/ was last seen as relevant, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/cubansalsaclub/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.facebook.com/groups/245161325497073/user/61552396445868/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/245161325497073/user/61552396445868/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.facebook.com/groups/895697871649474/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/895697871649474/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.facebook.com/Sabor.Asi.Dance.Salsa.Victoria/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/Sabor.Asi.Dance.Salsa.Victoria/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.facebook.com/groups/841245344232320/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/841245344232320/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://alivetangovictoria.ca/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://alivetangovictoria.ca/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.facebook.com/groups/264289526206205/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/264289526206205/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://vlda.ca/resources/ was last seen as not relevant but hit_ratio (0.75) > 0.1 or crawl_try (7) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://vlda.ca/resources/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.redhotswing.com/ was last seen as not relevant but hit_ratio (1.33) > 0.1 or crawl_try (7) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.redhotswing.com/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://calientedance.com/classes/ was last seen as not relevant but hit_ratio (2.00) > 0.1 or crawl_try (9) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://calientedance.com/classes/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.victoriawestcoastswing.com/ was last seen as not relevant but hit_ratio (11.50) > 0.1 or crawl_try (25) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.victoriawestcoastswing.com/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://alivetangovictoria.ca/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://alivetangovictoria.ca/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.facebook.com/groups/alivetango/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/alivetango/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.danceplace.com/places/in/Argentine+Tango/Canada/Victoria_+BC was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.danceplace.com/places/in/Argentine+Tango/Canada/Victoria_+BC
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.facebook.com/groups/TangoVanIsle/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/TangoVanIsle/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.instagram.com/alivetangovictoria/ was last seen as relevant, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.instagram.com/alivetangovictoria/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://tangofestivals.net/events/victoria-tango-marathon-2/ has never been seen before, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://tangofestivals.net/events/victoria-tango-marathon-2/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://milongas-in.com/milongas-in-america.php?c=Canada&city=Victoria has never been seen before, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://milongas-in.com/milongas-in-america.php?c=Canada&city=Victoria
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://abcbookworld.com/writer/winn-vanessa/ has never been seen before, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://abcbookworld.com/writer/winn-vanessa/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.jpost.com/aliyah/article-709647 has never been seen before, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.jpost.com/aliyah/article-709647
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.eventbrite.com/cc/argentine-tango-classes-related-events-2881689 was last seen as not relevant but hit_ratio (2.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.eventbrite.com/cc/argentine-tango-classes-related-events-2881689
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.facebook.com/BaKiSaDance/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/BaKiSaDance/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.instagram.com/bachatavictoria/p/DDX2ly9Tx5D/ was last seen as relevant, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.instagram.com/bachatavictoria/p/DDX2ly9Tx5D/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://latinvictoria.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://latinvictoria.ca/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.eventbrite.com/d/canada--victoria/salsa/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.eventbrite.com/d/canada--victoria/salsa/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://latindancecanada.com/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://latindancecanada.com/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://m.facebook.com/latindancecanada/photos/new-dance-classes-starting-january-httpslatindancecanadacomgroup-classes/1041978164501698/ has never been seen before, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://m.facebook.com/latindancecanada/photos/new-dance-classes-starting-january-httpslatindancecanadacomgroup-classes/1041978164501698/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://social-dance.today/party/sunday-sundown-social-bachata-temptation-salsa-sensation-a0/2025-07-20 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://social-dance.today/party/sunday-sundown-social-bachata-temptation-salsa-sensation-a0/2025-07-20
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.danceplace.com/places/in/Argentine+Tango/Canada/Victoria_+BC was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.danceplace.com/places/in/Argentine+Tango/Canada/Victoria_+BC
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://social-dance.today/party/sunday-sundown-social-salsa-fire-bachata-desire-kizomba-inspire-3f/2025-06-29 has never been seen before, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://social-dance.today/party/sunday-sundown-social-salsa-fire-bachata-desire-kizomba-inspire-3f/2025-06-29
2025-06-18 12:41:21 [root] INFO: start_requests: Skipping blacklisted URL https://ca.linkedin.com/in/alysha-kopala-35a44a15b.
2025-06-18 12:41:21 [root] INFO: start_requests: Skipping blacklisted URL https://ca.linkedin.com/in/gabriela-vieyra/en.
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.facebook.com/groups/105613516148561/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/105613516148561/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://whereiskylenow.com/airstream/americas-finest-city.html was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://whereiskylenow.com/airstream/americas-finest-city.html
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://2traveldads.com/balboa-park-guide-san-diego/minolta-digital-camera-109/ has never been seen before, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://2traveldads.com/balboa-park-guide-san-diego/minolta-digital-camera-109/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://allevents.in/victoria/swing-session-balboa-with-yoshi-and-etsuko/200028272050752 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://allevents.in/victoria/swing-session-balboa-with-yoshi-and-etsuko/200028272050752
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://lambertvillecountrydancers.org/whatsNew.php was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://lambertvillecountrydancers.org/whatsNew.php
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://victoriaarthurmurray.com/country-dance-lessons-victoria was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://victoriaarthurmurray.com/country-dance-lessons-victoria
2025-06-18 12:41:21 [root] INFO: start_requests: Skipping blacklisted URL https://rscds.org/about/donate/jmmf.
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://vecds.bc.ca/join-us/ has never been seen before, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://vecds.bc.ca/join-us/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.nataliepadillamusic.com/ was last seen as relevant, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.nataliepadillamusic.com/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://dancevictoria.com/ was last seen as not relevant but hit_ratio (0.33) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://dancevictoria.com/
2025-06-18 12:41:21 [root] INFO: start_requests: Skipping blacklisted URL https://www.reddit.com/r/VictoriaBC/comments/1fek7zn/date_and_dancing_victoria_bc/.
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://dancevictoria.com/performances/ was last seen as not relevant but hit_ratio (2.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://dancevictoria.com/performances/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.tripadvisor.com/Attractions-g154945-Activities-c20-t109-Victoria_Victoria_Capital_Regional_District_Vancouver_Island_British_Columbia.html has never been seen before, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.tripadvisor.com/Attractions-g154945-Activities-c20-t109-Victoria_Victoria_Capital_Regional_District_Vancouver_Island_British_Columbia.html
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.5rhythms.com/who-we-are/teacher-communities/the-americas/canada-west-coast/ was last seen as not relevant but hit_ratio (3.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.5rhythms.com/who-we-are/teacher-communities/the-americas/canada-west-coast/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.facebook.com/groups/1859019724204253/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/1859019724204253/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.sedadance.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.sedadance.ca/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://swimintothesound.com/blog/2024/5/22/pardoner-nick-normal-guitar-shoplifter-cherry-venom-concert-review was last seen as not relevant but hit_ratio (3.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://swimintothesound.com/blog/2024/5/22/pardoner-nick-normal-guitar-shoplifter-cherry-venom-concert-review
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.redhotswing.com/ was last seen as not relevant but hit_ratio (1.33) > 0.1 or crawl_try (7) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.redhotswing.com/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/dance-studios/locations/british-columbia/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://thedancestudiofinder.com/dance-studios/locations/british-columbia/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.facebook.com/groups/witchdanceunited/posts/596478935870544/ has never been seen before, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/witchdanceunited/posts/596478935870544/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.facebook.com/groups/vancouverwcs/ has never been seen before, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/vancouverwcs/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/learn-to-dance/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://bcswingdance.ca/index.php/learn-to-dance/
2025-06-18 12:41:21 [root] INFO: start_requests: Skipping blacklisted URL https://ca.linkedin.com/in/brian-simmons-349b9417.
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://books.friesenpress.com/store/title/119734000143340479/Jaime-Smith-Foxtrot was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://books.friesenpress.com/store/title/119734000143340479/Jaime-Smith-Foxtrot
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://bartenderatlas.com/bartenders/mike-norbury/ has never been seen before, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://bartenderatlas.com/bartenders/mike-norbury/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://vbds.org/events/bronze-foxtrot-2025-06-18/ has never been seen before, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://vbds.org/events/bronze-foxtrot-2025-06-18/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.foxtrotwine.com/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.facebook.com/groups/1634269246863069/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/1634269246863069/
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.instagram.com/vic_international_kizomba_fest/?hl=en was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (14) ≤ 3, processing it.
2025-06-18 12:41:21 [root] INFO: def start_requests(): Starting crawl for URL: https://www.instagram.com/vic_international_kizomba_fest/?hl=en
2025-06-18 12:41:21 [root] INFO: should_process_url: URL https://www.facebook.com/KizombaVictoriaBC/ does not meet criteria for processing, skipping it.
2025-06-18 12:41:21 [root] INFO: def eventbrite_search(): Skipping URL https://www.facebook.com/KizombaVictoriaBC/ based on historical relevancy.
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://alces.world/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://alces.world/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://alces.world/events/list/featured/?shortcode=758c7f2c was last seen as relevant, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://alces.world/events/list/featured/?shortcode=758c7f2c
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://latinvictoria.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://latinvictoria.ca/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://alces.world/event/victoria-international-kizomba-festival-6th-edition/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://alces.world/event/victoria-international-kizomba-festival-6th-edition/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://social-dance.today/party/sunday-sundown-social-salsa-fire-bachata-desire-kizomba-inspire-3f/2025-06-29 has never been seen before, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://social-dance.today/party/sunday-sundown-social-salsa-fire-bachata-desire-kizomba-inspire-3f/2025-06-29
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.redhotswing.com/ was last seen as not relevant but hit_ratio (1.33) > 0.1 or crawl_try (7) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.redhotswing.com/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.facebook.com/RedHotSwing/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/RedHotSwing/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.swingvictoria.net/ was last seen as not relevant but hit_ratio (2.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.swingvictoria.net/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.facebook.com/groups/169950979714465/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/169950979714465/
2025-06-18 12:41:22 [root] INFO: start_requests: Skipping blacklisted URL https://www.reddit.com/r/VictoriaBC/comments/16xpl6q/dance_class_suggestions_etc/.
2025-06-18 12:41:22 [root] INFO: start_requests: Skipping blacklisted URL https://ca.linkedin.com/in/sebastian-lao-67024847.
2025-06-18 12:41:22 [root] INFO: start_requests: Skipping blacklisted URL https://linedancingvictoria.wordpress.com/.
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://victoriaarthurmurray.com/country-dance-lessons-victoria was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://victoriaarthurmurray.com/country-dance-lessons-victoria
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.facebook.com/groups/meanwhileinsooke/posts/2454654144912925/ has never been seen before, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/meanwhileinsooke/posts/2454654144912925/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://thedukesaloon.com/ was last seen as relevant, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://thedukesaloon.com/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.yelp.ca/search?find_desc=Line+Dancing&find_loc=Victoria%2C+BC has never been seen before, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.yelp.ca/search?find_desc=Line+Dancing&find_loc=Victoria%2C+BC
2025-06-18 12:41:22 [root] INFO: start_requests: Skipping blacklisted URL https://www.nulinedance.com/my-classes/canada/.
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://harvestmoonlinedancefestival.ca/ has never been seen before, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://harvestmoonlinedancefestival.ca/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://dancevictoria.com/ was last seen as not relevant but hit_ratio (0.33) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://dancevictoria.com/
2025-06-18 12:41:22 [root] INFO: start_requests: Skipping blacklisted URL https://www.reddit.com/r/VictoriaBC/comments/1anqssx/anyone_in_victoria_bc_know_where_young_party/.
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://dancevictoria.com/performance/alonzo-king-lines-ballet-2016/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://dancevictoria.com/performance/alonzo-king-lines-ballet-2016/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://livevictoria.com/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://livevictoria.com/
2025-06-18 12:41:22 [root] INFO: start_requests: Skipping blacklisted URL https://www.tourismvictoria.com/blog/groovin-and-movin-victorias-live-music-scene.
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.irishtimespub.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.irishtimespub.ca/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.bandsintown.com/c/victoria-bc was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.bandsintown.com/c/victoria-bc
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.hermannsjazz.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.hermannsjazz.com/
2025-06-18 12:41:22 [root] INFO: start_requests: Skipping blacklisted URL https://www.reddit.com/r/VictoriaBC/comments/1gqy8yl/what_is_happening_to_the_music_scene_in_victoria/.
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://do250.com/events/music/today has never been seen before, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://do250.com/events/music/today
2025-06-18 12:41:22 [root] INFO: start_requests: Skipping blacklisted URL https://www.reddit.com/r/VictoriaBC/comments/1anqssx/anyone_in_victoria_bc_know_where_young_party/.
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.facebook.com/groups/Barsnbandsyyj/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/Barsnbandsyyj/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://northernwilds.com/breaking-tradition-with-christmas-away-2/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://northernwilds.com/breaking-tradition-with-christmas-away-2/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://alivetangovictoria.ca/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://alivetangovictoria.ca/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://milongas-in.com/milongas-in-america.php?c=Canada&city=Victoria has never been seen before, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://milongas-in.com/milongas-in-america.php?c=Canada&city=Victoria
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.facebook.com/groups/TangoVanIsle/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/TangoVanIsle/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.instagram.com/alivetangovictoria/ was last seen as relevant, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.instagram.com/alivetangovictoria/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.danceplace.com/places/in/Argentine+Tango/Canada/Victoria_+BC was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.danceplace.com/places/in/Argentine+Tango/Canada/Victoria_+BC
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://victoriatangomarathon.com/ was last seen as not relevant but hit_ratio (0.33) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://victoriatangomarathon.com/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://alivetangovictoria.ca/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://alivetangovictoria.ca/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://milongas-in.com/milongas-in-america.php?c=Canada&city=Victoria has never been seen before, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://milongas-in.com/milongas-in-america.php?c=Canada&city=Victoria
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.facebook.com/groups/alivetango/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/alivetango/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://allevents.in/victoria/technique-and-milonga-with-monica-parra/200028343998001 has never been seen before, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://allevents.in/victoria/technique-and-milonga-with-monica-parra/200028343998001
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.facebook.com/groups/TangoVanIsle/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/TangoVanIsle/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://victoriatangomarathon.com/ was last seen as not relevant but hit_ratio (0.33) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://victoriatangomarathon.com/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.instagram.com/alivetangovictoria/ was last seen as relevant, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.instagram.com/alivetangovictoria/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.danceplace.com/places/in/Argentine+Tango/Canada/Victoria_+BC was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.danceplace.com/places/in/Argentine+Tango/Canada/Victoria_+BC
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://dancehouse.ca/event/videla/ has never been seen before, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://dancehouse.ca/event/videla/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.eventbrite.com/cc/argentine-tango-classes-related-events-2881689 was last seen as not relevant but hit_ratio (2.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.eventbrite.com/cc/argentine-tango-classes-related-events-2881689
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://rifflandia.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://rifflandia.com/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.victoriafolkmusic.ca/festivals.html was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.victoriafolkmusic.ca/festivals.html
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.phillipsbackyard.com/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.phillipsbackyard.com/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.eventbrite.com/d/canada--victoria/festivals/music-festival/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.eventbrite.com/d/canada--victoria/festivals/music-festival/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.festivalseekers.com/story/20-plus-bc-summer-music-festivals-2024 was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.festivalseekers.com/story/20-plus-bc-summer-music-festivals-2024
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://pubmed.ncbi.nlm.nih.gov/31605958/ has never been seen before, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://pubmed.ncbi.nlm.nih.gov/31605958/
2025-06-18 12:41:22 [root] INFO: start_requests: Skipping blacklisted URL https://www.tourismvictoria.com/events-calendar.
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.shambhalamusicfestival.com/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.shambhalamusicfestival.com/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.cohoferry.com/articles/summer-festivals-in-victoria-bc was last seen as not relevant but hit_ratio (3.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.cohoferry.com/articles/summer-festivals-in-victoria-bc
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.sunfestconcerts.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.sunfestconcerts.com/
2025-06-18 12:41:22 [root] INFO: start_requests: Skipping blacklisted URL https://www.reddit.com/r/VictoriaBC/comments/160knn6/best_gay_bars_and_nightclubs_in_victoria/.
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.hermannsjazz.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.hermannsjazz.com/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://victoriasymphony.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://victoriasymphony.ca/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://butchartgardens.com/summer-entertainment-calendar/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://butchartgardens.com/summer-entertainment-calendar/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://do250.com/p/99-days has never been seen before, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://do250.com/p/99-days
2025-06-18 12:41:22 [root] INFO: start_requests: Skipping blacklisted URL https://www.tourismvictoria.com/blog/groovin-and-movin-victorias-live-music-scene.
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.cohoferry.com/articles/summer-festivals-in-victoria-bc was last seen as not relevant but hit_ratio (3.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.cohoferry.com/articles/summer-festivals-in-victoria-bc
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://taniamiller.com/getting-ready-to-conduct-a-concert-in-front-of-40000-people/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://taniamiller.com/getting-ready-to-conduct-a-concert-in-front-of-40000-people/
2025-06-18 12:41:22 [root] INFO: start_requests: Skipping blacklisted URL https://vcm.bc.ca/.
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/dance-studios/categories/quickstep/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://thedancestudiofinder.com/dance-studios/categories/quickstep/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://victoriaarthurmurray.com/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://victoriaarthurmurray.com/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/dance-studios/categories/paso-doble/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://thedancestudiofinder.com/dance-studios/categories/paso-doble/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://boards.cruisecritic.com/topic/2418703-dance-lessons/ has never been seen before, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://boards.cruisecritic.com/topic/2418703-dance-lessons/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://livevictoria.com/show/732324/view was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://livevictoria.com/show/732324/view
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://vbds.org/events/beginners-pre-bronze-w-t-c-r-2025-06-09/ has never been seen before, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://vbds.org/events/beginners-pre-bronze-w-t-c-r-2025-06-09/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.facebook.com/people/Victoria-Viva-la-Fiesta/61553917640310/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/people/Victoria-Viva-la-Fiesta/61553917640310/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://sipmagazine.com/grazers-part-and-parcel-victoria/ has never been seen before, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://sipmagazine.com/grazers-part-and-parcel-victoria/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://victoriaarthurmurray.com/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://victoriaarthurmurray.com/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/dance-studios/categories/paso-doble/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://thedancestudiofinder.com/dance-studios/categories/paso-doble/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.last.fm/festival/3914293+Rumba/lineup has never been seen before, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.last.fm/festival/3914293+Rumba/lineup
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.facebook.com/salsadancevictoriabc/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/salsadancevictoriabc/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.instagram.com/bachatavictoria/p/DDX2ly9Tx5D/ was last seen as relevant, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.instagram.com/bachatavictoria/p/DDX2ly9Tx5D/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.eventbrite.com/d/canada--victoria/salsa/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.eventbrite.com/d/canada--victoria/salsa/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.salsagonzales.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.salsagonzales.com/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://latinvictoria.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://latinvictoria.ca/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.shambhalamusicfestival.com/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.shambhalamusicfestival.com/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.gigsalad.com/Dance/Belly-Dancer/BC/Victoria was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.gigsalad.com/Dance/Belly-Dancer/BC/Victoria
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/ was last seen as not relevant but hit_ratio (2.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://riobraziliansteakhouse.ca/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.facebook.com/groups/1634269246863069/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/1634269246863069/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.instagram.com/lena.deschner/?hl=en was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.instagram.com/lena.deschner/?hl=en
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.redhotswing.com/ was last seen as not relevant but hit_ratio (1.33) > 0.1 or crawl_try (7) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.redhotswing.com/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.pgatour.com/americas/article/news/latest/2024/06/18/field-set-for-first-event-of-north-america-swing-the-beachlands-victoria-open-presented-by-times-colonist has never been seen before, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.pgatour.com/americas/article/news/latest/2024/06/18/field-set-for-first-event-of-north-america-swing-the-beachlands-victoria-open-presented-by-times-colonist
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.swingvictoria.net/ was last seen as not relevant but hit_ratio (2.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.swingvictoria.net/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.facebook.com/groups/britishcolumbiaphotos/posts/3967435853476303/ has never been seen before, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/britishcolumbiaphotos/posts/3967435853476303/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://alivetangovictoria.ca/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://alivetangovictoria.ca/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.facebook.com/groups/alivetango/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/alivetango/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.instagram.com/alivetangovictoria/ was last seen as relevant, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.instagram.com/alivetangovictoria/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.facebook.com/groups/TangoVanIsle/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/TangoVanIsle/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://tangohair.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://tangohair.com/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://victoriatangomarathon.com/ was last seen as not relevant but hit_ratio (0.33) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://victoriatangomarathon.com/
2025-06-18 12:41:22 [root] INFO: start_requests: Skipping blacklisted URL https://ca.linkedin.com/in/brian-simmons-349b9417.
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://victoriaarthurmurray.com/country-dance-lessons-victoria was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://victoriaarthurmurray.com/country-dance-lessons-victoria
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.facebook.com/groups/1634269246863069/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/1634269246863069/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.instagram.com/lena.deschner/?hl=en was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.instagram.com/lena.deschner/?hl=en
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.facebook.com/KizombaVictoriaBC/ does not meet criteria for processing, skipping it.
2025-06-18 12:41:22 [root] INFO: def eventbrite_search(): Skipping URL https://www.facebook.com/KizombaVictoriaBC/ based on historical relevancy.
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://alces.world/event/victoria-international-kizomba-festival-6th-edition/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://alces.world/event/victoria-international-kizomba-festival-6th-edition/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.facebook.com/groups/vancitykizomba/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/vancitykizomba/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://alces.world/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://alces.world/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://alces.world/events/list/featured/?shortcode=758c7f2c&eventDisplay=past was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://alces.world/events/list/featured/?shortcode=758c7f2c&eventDisplay=past
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/duet-play-along-waltz-czerny-method/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.thisisclassicalguitar.com/duet-play-along-waltz-czerny-method/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.facebook.com/willowandwaltzphoto/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/willowandwaltzphoto/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://victoriasymphony.ca/concerts/parker-beethovens-emperor-concerto/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://victoriasymphony.ca/concerts/parker-beethovens-emperor-concerto/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://dancevictoria.com/performance/malpaso/ was last seen as relevant, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://dancevictoria.com/performance/malpaso/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.weddingwire.ca/wedding-photography/willow-waltz-photography--e70191 has never been seen before, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.weddingwire.ca/wedding-photography/willow-waltz-photography--e70191
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://pacificopera.ca/event/take-this-waltz/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://pacificopera.ca/event/take-this-waltz/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://lambertvillecountrydancers.org/whatsNew.php was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://lambertvillecountrydancers.org/whatsNew.php
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.facebook.com/groups/victoriawestcoastswingcollective/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/victoriawestcoastswingcollective/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.facebook.com/groups/victoriawesties/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/victoriawesties/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.victoriawestcoastswing.com/ was last seen as not relevant but hit_ratio (11.50) > 0.1 or crawl_try (25) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.victoriawestcoastswing.com/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.facebook.com/groups/victoriawestcoastswingcollective/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/victoriawestcoastswingcollective/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.victoriawestcoastswing.com/ was last seen as not relevant but hit_ratio (11.50) > 0.1 or crawl_try (25) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.victoriawestcoastswing.com/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.facebook.com/groups/victoriawesties/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/victoriawesties/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://vbds.org/dances/west-coast-swing/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://vbds.org/dances/west-coast-swing/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/learn-to-dance/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://bcswingdance.ca/index.php/learn-to-dance/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.redhotswing.com/ was last seen as not relevant but hit_ratio (1.33) > 0.1 or crawl_try (7) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.redhotswing.com/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.5rhythms.com/who-we-are/teacher-communities/the-americas/canada-west-coast/ was last seen as not relevant but hit_ratio (3.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.5rhythms.com/who-we-are/teacher-communities/the-americas/canada-west-coast/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.facebook.com/groups/895697871649474/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.facebook.com/groups/895697871649474/
2025-06-18 12:41:22 [root] INFO: start_requests: Skipping blacklisted URL https://ca.linkedin.com/in/rickclark-eit.
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.instagram.com/vic_international_kizomba_fest/?hl=en was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (14) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.instagram.com/vic_international_kizomba_fest/?hl=en
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.eventbrite.com/d/wa--bellingham/arts--events--today/ has never been seen before, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.eventbrite.com/d/wa--bellingham/arts--events--today/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://latindancecalendar.com/festivals/style/zouk/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://latindancecalendar.com/festivals/style/zouk/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.bazadance.com/ was last seen as relevant, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.bazadance.com/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/dance-studios/categories/night-club-slow/ has never been seen before, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://thedancestudiofinder.com/dance-studios/categories/night-club-slow/
2025-06-18 12:41:22 [root] INFO: should_process_url: URL https://www.pgmusic.com/addons.styles.php was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:41:22 [root] INFO: def start_requests(): Starting crawl for URL: https://www.pgmusic.com/addons.styles.php
2025-06-18 12:41:22 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <406 https://vlda.ca/resources/>: HTTP status code is not handled or not allowed
2025-06-18 12:41:22 [root] INFO: def parse(): Found keywords for URL https://latindancecanada.com/: ['bachata', 'cha cha', 'dance', 'kizomba', 'merengue', 'salsa']
2025-06-18 12:41:22 [root] INFO: def generate_prompt(): Generating prompt for URL: https://latindancecanada.com/
2025-06-18 12:41:22 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 12:41:22 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 12:41:22 [root] INFO: query_llm(): Querying Mistral
2025-06-18 12:43:32 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:43:32 [root] INFO: query_llm(): Mistral response received: Here are the extracted events:

1. **Event Name:** Saturday Socials
   - **Day of Week:** Saturday
   - **Start Date:** 2025-06-21
   - **End Date:** 2025-06-21
   - **Start Time:** 20:00
   - **End Time:** 00:00
   - **Price:** $15 cover (cash only)
   - **Location:** Ukrainian Cultural Centre, 3277 Douglas Street, Victoria
   - **Event Type:** social dance
   - **Source:** Latin Dance Canada
   - **Event Name:** Saturday Socials
   - **Day of Week:** Saturday
   - **Start Date:** 2025-06-28
   - **End Date:** 2025-06-28
   - **Start Time:** 20:00
   - **End Time:** 00:00
   - **Price:** $15 cover (cash only)
   - **Location:** Ukrainian Cultural Centre, 3277 Douglas Street, Victoria
   - **Event Type:** social dance
   - **Source:** Latin Dance Canada
   - **Event Name:** Saturday Socials
   - **Day of Week:** Saturday
   - **Start Date:** 2025-07-05
   - **End Date:** 2025-07-05
   - **Start Time:** 20:00
   - **End Time:** 00:00
   - **Price:** $15 cover (cash only)
   - **Location:** Ukrainian Cultural Centre, 3277 Douglas Street, Victoria
   - **Event Type:** social dance
   - **Source:** Latin Dance Canada
   - **Event Name:** Saturday Socials
   - **Day of Week:** Saturday
   - **Start Date:** 2025-07-19
   - **End Date:** 2025-07-19
   - **Start Time:** 20:00
   - **End Time:** 00:00
   - **Price:** $15 cover (cash only)
   - **Location:** Ukrainian Cultural Centre, 3277 Douglas Street, Victoria
   - **Event Type:** social dance
   - **Source:** Latin Dance Canada

2. **Event Name:** New Year's Eve Party
   - **Day of Week:**  (The event occurs on a date that is less than 90 days away and does not fall on the first occurrence (December 31, 2024) of the recurring event. Therefore, we set it to December 31, 2024.)
   - **Start Date:** 2024-12-31
   - **End Date:** 2024-12-31
   - **Start Time:**
   - **End Time:**
   - **Price:**
   - **Location:**
   - **Event Type:** social dance
   - **Source:** Latin Dance Canada
   - **Description:**  New Year's Eve Party

3. **Event Name:** Group Classes
   - **Day of Week:**
   - **Start Date:**
   - **End Date:**
   - **Start Time:**
   - **End Time:**
   - **Price:**
   - **Location:**
   - **Event Type:** workshop
   - **Source:** Latin Dance Canada
   - **Description:** Have fun learning and dancing together! This is the easiest way to meet new people and make new friends. Join our June 2025 classes! Limited spots available—register now to secure yours!

4. **Event Name:** Private Lessons
   - **Day of Week:**
   - **Start Date:**
   - **End Date:**
   - **Start Time:**
   - **End Time:**
   - **Price:**
   - **Location:**
   - **Event Type:** class
   - **Source:** Latin Dance Canada
   - **Description:** Individual lessons with Ronald takes your learning to a whole new level!

5. **Event Name:** Live Music
   - **Day of Week:**
   - **Start Date:**
   - **End Date:**
   - **Start Time:**
   - **End Time:**
   - **Price:**
   - **Location:**
   - **Event Type:** live music
   - **Source:** Latin Dance Canada
2025-06-18 12:43:32 [root] ERROR: def extract_and_parse_json(): couldn't isolate JSON blob in result from https://latindancecanada.com/
2025-06-18 12:43:32 [root] INFO: write_url_to_db(): appended URL 'https://latindancecanada.com/'
2025-06-18 12:43:32 [root] INFO: def parse(): URL https://latindancecanada.com/ marked as irrelevant (LLM negative).
2025-06-18 12:43:32 [root] INFO: def parse(): Found 10 links on https://latindancecanada.com/
2025-06-18 12:43:32 [root] INFO: parse: Skipping blacklisted URL https://www.google.com/maps/place/Ukrainian+Cultural+Centre/@48.4489917,-123.3728093,15z/data=!4m2!3m1!1s0x0:0x97c250a1695f90c2?sa=X&ved=2ahUKEwiMx8Ldn5_4AhXpGzQIHQ_oAvUQ_BJ6BAhVEAU.
2025-06-18 12:43:32 [root] INFO: should_process_url: URL https://latindancecanada.com/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:43:32 [root] INFO: should_process_url: URL https://latindancecanada.com/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:43:32 [root] INFO: write_url_to_db(): appended URL 'https://latindancecanada.com/'
2025-06-18 12:43:32 [root] INFO: def parse(): Crawling next URL: https://latindancecanada.com/
2025-06-18 12:43:32 [scrapy.extensions.logstats] INFO: Crawled 8 pages (at 8 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 12:43:32 [root] INFO: should_process_url: URL https://latindancecanada.com/our-family/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:43:32 [root] INFO: should_process_url: URL https://latindancecanada.com/our-family/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:43:32 [root] INFO: write_url_to_db(): appended URL 'https://latindancecanada.com/our-family/'
2025-06-18 12:43:32 [root] INFO: def parse(): Crawling next URL: https://latindancecanada.com/our-family/
2025-06-18 12:43:32 [root] INFO: def parse(): Found keywords for URL https://www.redhotswing.com/: ['balboa', 'dance', 'lindy hop', 'swing']
2025-06-18 12:43:32 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.redhotswing.com/
2025-06-18 12:43:32 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 12:43:32 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 12:43:32 [root] INFO: query_llm(): Querying Mistral
2025-06-18 12:43:48 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:43:48 [root] INFO: query_llm(): Mistral response received: [
  {
    "source": "Red Hot Swing",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Weekly Friday Social Dances",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-20",
    "start_time": "",
    "end_time": null,
    "price": "",
    "location": "Dance Victoria",
    "description": "Weekly social dances are running on Fridays."
  },
  {
    "source": "Red Hot Swing",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Monthly Monday Social Dances",
    "day_of_week": "Monday",
    "start_date": "2025-06-23",
    "end_date": "2025-06-23",
    "start_time": "",
    "end_time": null,
    "price": "",
    "location": "Strawberry Vale Community Club",
    "description": "Monthly social dance on Mondays."
  },
  {
    "source": "Red Hot Swing",
    "dance_style": "swing",
    "url": "",
    "event_type": "class",
    "event_name": "Class Session",
    "day_of_week": "Monday",
    "start_date": "2025-07-07",
    "end_date": "2025-07-09",
    "start_time": "",
    "end_time": null,
    "price": "",
    "location": "",
    "description": "The next session of our classes is starting in July 7th-9th 2025 on Mondays, Tuesdays, and Wednesdays, and they are all now open for registration."
  },
  {
    "source": "Red Hot Swing",
    "dance_style": "swing",
    "url": "",
    "event_type": "class",
    "event_name": "Class Session",
    "day_of_week": "Tuesday",
    "start_date": "2025-07-08",
    "end_date": "2025-07-09",
    "start_time": "",
    "end_time": null,
    "price": "",
    "location": "",
    "description": "The next session of our classes is starting in July 7th-9th 2025 on Mondays, Tuesdays, and Wednesdays, and they are all now open for registration."
  },
  {
    "source": "Red Hot Swing",
    "dance_style": "swing",
    "url": "",
    "event_type": "class",
    "event_name": "Class Session",
    "day_of_week": "Wednesday",
    "start_date": "2025-07-09",
    "end_date": "2025-07-09",
    "start_time": "",
    "end_time": null,
    "price": "",
    "location": "",
    "description": "The next session of our classes is starting in July 7th-9th 2025 on Mondays, Tuesdays, and Wednesdays, and they are all now open for registration."
  }
]
2025-06-18 12:43:48 [root] INFO: def extract_and_parse_json(): for url https://www.redhotswing.com/, 
Cleaned JSON ready for parsing:
[
  {
    "source": "Red Hot Swing",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Weekly Friday Social Dances",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-20",
    "start_time": "",
    "end_time": null,
    "price": "",
    "location": "Dance Victoria",
    "description": "Weekly social dances are running on Fridays."
  },
  {
    "source": "Red Hot Swing",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Monthly Monday Social Dances",
    "day_of_week": "Monday",
    "start_date": "2025-06-23",
    "end_date": "2025-06-23",
    "start_time": "",
    "end_time": null,
    "price": "",
    "location": "Strawberry Vale Community Club",
    "description": "Monthly social dance on Mondays."
  },
  {
    "source": "Red Hot Swing",
    "dance_style": "swing",
    "url": "",
    "event_type": "class",
    "event_name": "Class Session",
    "day_of_week": "Monday",
    "start_date": "2025-07-07",
    "end_date": "2025-07-09",
    "start_time": "",
    "end_time": null,
    "price": "",
    "location": "",
    "description": "The next session of our classes is starting in July 7th-9th 2025 on Mondays, Tuesdays, and Wednesdays, and they are all now open for registration."
  },
  {
    "source": "Red Hot Swing",
    "dance_style": "swing",
    "url": "",
    "event_type": "class",
    "event_name": "Class Session",
    "day_of_week": "Tuesday",
    "start_date": "2025-07-08",
    "end_date": "2025-07-09",
    "start_time": "",
    "end_time": null,
    "price": "",
    "location": "",
    "description": "The next session of our classes is starting in July 7th-9th 2025 on Mondays, Tuesdays, and Wednesdays, and they are all now open for registration."
  },
  {
    "source": "Red Hot Swing",
    "dance_style": "swing",
    "url": "",
    "event_type": "class",
    "event_name": "Class Session",
    "day_of_week": "Wednesday",
    "start_date": "2025-07-09",
    "end_date": "2025-07-09",
    "start_time": "",
    "end_time": null,
    "price": "",
    "location": "",
    "description": "The next session of our classes is starting in July 7th-9th 2025 on Mondays, Tuesdays, and Wednesdays, and they are all now open for registration."
  }
]
2025-06-18 12:43:48 [root] INFO: def clean_up_address(): Starting with events_df shape: (5, 14)
2025-06-18 12:43:48 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria' (event_id: None)
2025-06-18 12:43:48 [root] INFO: def clean_up_address(): Processing location 'Strawberry Vale Community Club' (event_id: None)
2025-06-18 12:43:48 [root] INFO: write_events_to_db: Number of events to write: 5
2025-06-18 12:43:48 [root] INFO: write_url_to_db(): appended URL 'https://www.redhotswing.com/'
2025-06-18 12:43:48 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:43:48 [root] INFO: def process_llm_response: URL https://www.redhotswing.com/ marked as relevant with events written to the database.
2025-06-18 12:43:48 [root] INFO: write_url_to_db(): appended URL 'https://www.redhotswing.com/'
2025-06-18 12:43:48 [root] INFO: def parse(): URL https://www.redhotswing.com/ marked as relevant (LLM positive).
2025-06-18 12:43:48 [root] INFO: def parse(): Found 10 links on https://www.redhotswing.com/
2025-06-18 12:43:48 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.google.com/calendar/embed?mode=MONTH&showPrint=0&showTabs=0&showCalendars=0&height=600&wkst=1&bgcolor=%23FFFFFF&src=NzljZnAzYXNmN2JvZDlxNGljZ2M0cnR0bm9AZ3JvdXAuY2FsZW5kYXIuZ29vZ2xlLmNvbQ&color=%23B1440E&ctz=America%2FLos_Angeles, URL: https://www.redhotswing.com/, source: Red Hot Swing, keywords: swing, balboa, lindy hop, east coast swing
2025-06-18 12:43:48 [root] INFO: def process_calendar_id(): Processing calendar_id: 79cfp3asf7bod9q4icgc4rttno@group.calendar.google.com from https://www.google.com/calendar/embed?mode=MONTH&showPrint=0&showTabs=0&showCalendars=0&height=600&wkst=1&bgcolor=%23FFFFFF&src=NzljZnAzYXNmN2JvZDlxNGljZ2M0cnR0bm9AZ3JvdXAuY2FsZW5kYXIuZ29vZ2xlLmNvbQ&color=%23B1440E&ctz=America%2FLos_Angeles
2025-06-18 12:43:48 [root] INFO: def get_credentials(): Retrieved credentials for Google.
2025-06-18 12:43:49 [root] INFO: def process_calendar_id(): Found 216 events for calendar_id: 79cfp3asf7bod9q4icgc4rttno@group.calendar.google.com
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Starting with events_df shape: (216, 14)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'City Light Church, 550 Obed Ave, Victoria, BC V9A 1K5, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 4733 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'City Light Church, 550 Obed Ave, Victoria, BC V9A 1K5, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 4733 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Strawberry Vale & District Community Club, 11 High St, Victoria, BC V8Z 5C8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2172 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Strawberry Vale & District Community Club, 11 High St, Victoria, BC V8Z 5C8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2172 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Strawberry Vale & District Community Club, 11 High St, Victoria, BC V8Z 5C8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2172 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'St. Matthias Anglican Church, 600 Richmond Ave, Victoria, BC V8S 3Y7, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 1242 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'St. Matthias Anglican Church, 600 Richmond Ave, Victoria, BC V8S 3Y7, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 1242 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'City Light Church, 550 Obed Ave, Victoria, BC V9A 1K5, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 4733 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'City Light Church, 550 Obed Ave, Victoria, BC V9A 1K5, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 4733 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'St. Matthias Anglican Church, 600 Richmond Ave, Victoria, BC V8S 3Y7, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 1242 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'St. Matthias Anglican Church, 600 Richmond Ave, Victoria, BC V8S 3Y7, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 1242 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'City Light Church, 550 Obed Ave, Victoria, BC V9A 1K5, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 4733 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'City Light Church, 550 Obed Ave, Victoria, BC V9A 1K5, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 4733 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'St. Matthias Anglican Church, 600 Richmond Ave, Victoria, BC V8S 3Y7, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 1242 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'St. Matthias Anglican Church, 600 Richmond Ave, Victoria, BC V8S 3Y7, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 1242 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'City Light Church, 550 Obed Ave, Victoria, BC V9A 1K5, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 4733 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'City Light Church, 550 Obed Ave, Victoria, BC V9A 1K5, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 4733 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'St. Matthias Anglican Church, 600 Richmond Ave, Victoria, BC V8S 3Y7, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 1242 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'St. Matthias Anglican Church, 600 Richmond Ave, Victoria, BC V8S 3Y7, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 1242 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'City Light Church, 550 Obed Ave, Victoria, BC V9A 1K5, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 4733 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'City Light Church, 550 Obed Ave, Victoria, BC V9A 1K5, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 4733 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'St. Matthias Anglican Church, 600 Richmond Ave, Victoria, BC V8S 3Y7, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 1242 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'St. Matthias Anglican Church, 600 Richmond Ave, Victoria, BC V8S 3Y7, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 1242 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'City Light Church, 550 Obed Ave, Victoria, BC V9A 1K5, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 4733 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'City Light Church, 550 Obed Ave, Victoria, BC V9A 1K5, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 4733 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:49 [root] INFO: def clean_up_address(): Processing location 'St. Matthias Anglican Church, 600 Richmond Ave, Victoria, BC V8S 3Y7, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 1242 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'St. Matthias Anglican Church, 600 Richmond Ave, Victoria, BC V8S 3Y7, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 1242 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'City Light Church, 550 Obed Ave, Victoria, BC V9A 1K5, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 4733 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'City Light Church, 550 Obed Ave, Victoria, BC V9A 1K5, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 4733 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'St. Matthias Anglican Church, 600 Richmond Ave, Victoria, BC V8S 3Y7, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 1242 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'St. Matthias Anglican Church, 600 Richmond Ave, Victoria, BC V8S 3Y7, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 1242 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'City Light Church, 550 Obed Ave, Victoria, BC V9A 1K5, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 4733 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'City Light Church, 550 Obed Ave, Victoria, BC V9A 1K5, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 4733 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Strawberry Vale & District Community Club, 11 High St, Victoria, BC V8Z 5C8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2172 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Strawberry Vale & District Community Club, 11 High St, Victoria, BC V8Z 5C8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2172 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Strawberry Vale & District Community Club, 11 High St, Victoria, BC V8Z 5C8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2172 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Strawberry Vale & District Community Club, 11 High St, Victoria, BC V8Z 5C8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2172 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Strawberry Vale & District Community Club, 11 High St, Victoria, BC V8Z 5C8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2172 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Strawberry Vale & District Community Club, 11 High St, Victoria, BC V8Z 5C8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2172 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Strawberry Vale & District Community Club, 11 High St, Victoria, BC V8Z 5C8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2172 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Strawberry Vale & District Community Club, 11 High St, Victoria, BC V8Z 5C8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2172 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Strawberry Vale & District Community Club, 11 High St, Victoria, BC V8Z 5C8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2172 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Strawberry Vale & District Community Club, 11 High St, Victoria, BC V8Z 5C8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2172 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Strawberry Vale & District Community Club, 11 High St, Victoria, BC V8Z 5C8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2172 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Strawberry Vale & District Community Club, 11 High St, Victoria, BC V8Z 5C8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2172 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Strawberry Vale & District Community Club, 11 High St, Victoria, BC V8Z 5C8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2172 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Strawberry Vale & District Community Club, 11 High St, Victoria, BC V8Z 5C8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2172 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Strawberry Vale & District Community Club, 11 High St, Victoria, BC V8Z 5C8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2172 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Strawberry Vale & District Community Club, 11 High St, Victoria, BC V8Z 5C8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2172 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Strawberry Vale & District Community Club, 11 High St, Victoria, BC V8Z 5C8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2172 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Strawberry Vale & District Community Club, 11 High St, Victoria, BC V8Z 5C8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2172 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Strawberry Vale & District Community Club, 11 High St, Victoria, BC V8Z 5C8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2172 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Strawberry Vale & District Community Club, 11 High St, Victoria, BC V8Z 5C8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2172 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Strawberry Vale & District Community Club, 11 High St, Victoria, BC V8Z 5C8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2172 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Strawberry Vale & District Community Club, 11 High St, Victoria, BC V8Z 5C8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2172 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Strawberry Vale & District Community Club, 11 High St, Victoria, BC V8Z 5C8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2172 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Strawberry Vale & District Community Club, 11 High St, Victoria, BC V8Z 5C8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2172 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:43:50 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:43:50 [root] INFO: write_events_to_db: Number of events to write: 216
2025-06-18 12:43:50 [root] INFO: write_url_to_db(): appended URL '79cfp3asf7bod9q4icgc4rttno@group.calendar.google.com'
2025-06-18 12:43:50 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:43:50 [root] INFO: write_url_to_db(): appended URL 'https://www.google.com/calendar/embed?mode=MONTH&showPrint=0&showTabs=0&showCalendars=0&height=600&wkst=1&bgcolor=%23FFFFFF&src=NzljZnAzYXNmN2JvZDlxNGljZ2M0cnR0bm9AZ3JvdXAuY2FsZW5kYXIuZ29vZ2xlLmNvbQ&color=%23B1440E&ctz=America%2FLos_Angeles'
2025-06-18 12:43:50 [root] INFO: should_process_url: URL https://www.redhotswing.com/?page_id=41 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:43:50 [root] INFO: should_process_url: URL https://www.redhotswing.com/?page_id=41 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:43:50 [root] INFO: write_url_to_db(): appended URL 'https://www.redhotswing.com/?page_id=41'
2025-06-18 12:43:50 [root] INFO: def parse(): Crawling next URL: https://www.redhotswing.com/?page_id=41
2025-06-18 12:43:50 [root] INFO: should_process_url: URL https://latindancecanada.com/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:43:50 [root] INFO: should_process_url: URL https://latindancecanada.com/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:43:50 [root] INFO: write_url_to_db(): appended URL 'https://latindancecanada.com/contact/'
2025-06-18 12:43:50 [root] INFO: def parse(): Crawling next URL: https://latindancecanada.com/contact/
2025-06-18 12:43:50 [root] INFO: should_process_url: URL https://www.redhotswing.com/?page_id=32 was last seen as relevant, processing it.
2025-06-18 12:43:50 [root] INFO: should_process_url: URL https://www.redhotswing.com/?page_id=32 was last seen as relevant, processing it.
2025-06-18 12:43:50 [root] INFO: write_url_to_db(): appended URL 'https://www.redhotswing.com/?page_id=32'
2025-06-18 12:43:50 [root] INFO: def parse(): Crawling next URL: https://www.redhotswing.com/?page_id=32
2025-06-18 12:43:50 [scrapy.core.downloader.handlers.http11] WARNING: Got data loss in https://www.facebook.com/groups/1634269246863069/. If you want to process broken responses set the setting DOWNLOAD_FAIL_ON_DATALOSS = False -- This message won't be shown in further requests
2025-06-18 12:43:50 [scrapy.core.downloader.handlers.http11] WARNING: Got data loss in https://www.facebook.com/groups/3158235040/. If you want to process broken responses set the setting DOWNLOAD_FAIL_ON_DATALOSS = False -- This message won't be shown in further requests
2025-06-18 12:43:50 [scrapy.core.downloader.handlers.http11] WARNING: Got data loss in https://www.facebook.com/Sabor.Asi.Dance.Salsa.Victoria/. If you want to process broken responses set the setting DOWNLOAD_FAIL_ON_DATALOSS = False -- This message won't be shown in further requests
2025-06-18 12:43:50 [scrapy.core.downloader.handlers.http11] WARNING: Got data loss in https://www.facebook.com/groups/841245344232320/. If you want to process broken responses set the setting DOWNLOAD_FAIL_ON_DATALOSS = False -- This message won't be shown in further requests
2025-06-18 12:43:50 [scrapy.core.downloader.handlers.http11] WARNING: Got data loss in https://www.facebook.com/groups/895697871649474/. If you want to process broken responses set the setting DOWNLOAD_FAIL_ON_DATALOSS = False -- This message won't be shown in further requests
2025-06-18 12:43:50 [scrapy.core.downloader.handlers.http11] WARNING: Got data loss in https://www.facebook.com/groups/265269613666246/. If you want to process broken responses set the setting DOWNLOAD_FAIL_ON_DATALOSS = False -- This message won't be shown in further requests
2025-06-18 12:43:50 [root] INFO: should_process_url: URL https://www.redhotswing.com/?page_id=25 was last seen as relevant, processing it.
2025-06-18 12:43:50 [root] INFO: should_process_url: URL https://www.redhotswing.com/?page_id=25 was last seen as relevant, processing it.
2025-06-18 12:43:50 [root] INFO: write_url_to_db(): appended URL 'https://www.redhotswing.com/?page_id=25'
2025-06-18 12:43:50 [root] INFO: def parse(): Crawling next URL: https://www.redhotswing.com/?page_id=25
2025-06-18 12:43:50 [root] INFO: should_process_url: URL https://www.redhotswing.com/?page_id=8 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:43:50 [root] INFO: should_process_url: URL https://www.redhotswing.com/?page_id=8 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:43:50 [root] INFO: write_url_to_db(): appended URL 'https://www.redhotswing.com/?page_id=8'
2025-06-18 12:43:50 [root] INFO: def parse(): Crawling next URL: https://www.redhotswing.com/?page_id=8
2025-06-18 12:43:50 [root] INFO: should_process_url: URL https://www.redhotswing.com/ was last seen as not relevant but hit_ratio (1.33) > 0.1 or crawl_try (7) ≤ 3, processing it.
2025-06-18 12:43:50 [root] INFO: should_process_url: URL https://www.redhotswing.com/ was last seen as not relevant but hit_ratio (1.33) > 0.1 or crawl_try (7) ≤ 3, processing it.
2025-06-18 12:43:50 [root] INFO: write_url_to_db(): appended URL 'https://www.redhotswing.com/'
2025-06-18 12:43:50 [root] INFO: def parse(): Crawling next URL: https://www.redhotswing.com/
2025-06-18 12:43:50 [root] INFO: should_process_url: URL https://www.redhotswing.com/?page_id=22 was last seen as relevant, processing it.
2025-06-18 12:43:50 [root] INFO: should_process_url: URL https://www.redhotswing.com/?page_id=22 was last seen as relevant, processing it.
2025-06-18 12:43:50 [root] INFO: write_url_to_db(): appended URL 'https://www.redhotswing.com/?page_id=22'
2025-06-18 12:43:50 [root] INFO: def parse(): Crawling next URL: https://www.redhotswing.com/?page_id=22
2025-06-18 12:43:50 [root] INFO: def parse(): Found keywords for URL https://www.victoriawestcoastswing.com/: ['dance', 'swing', 'wcs', 'west coast swing']
2025-06-18 12:43:50 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.victoriawestcoastswing.com/
2025-06-18 12:43:50 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 12:43:50 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 12:43:50 [root] INFO: query_llm(): Querying Mistral
2025-06-18 12:47:10 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:47:10 [root] INFO: query_llm(): Mistral response received: ```json
[
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "SATURDAY LESSON & SOCIAL DANCE",
        "day_of_week": "Saturday",
        "start_date": "2025-06-22",
        "end_date": "2025-06-22",
        "start_time": "18:45",
        "end_time": "22:15",
        "price": "$12 for students, $15 for everybody else",
        "location": "Dance Victoria, 2750 Quadra St",
        "description": "Every Saturday. With air conditioning. Doors open at 6:45pm. Lesson: 7:00 - 8:00 - Beginner Basics with Intermediate helpers. Social dance: 8:00 - 10:15"
    },
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "TUESDAY PRACTICE & SOCIAL DANCE",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "19:30",
        "end_time": "21:45",
        "price": "Only $7, FREE if you are currently attending a series of WCS lessons",
        "location": "Eastern Star Hall, 3281 Harriet Rd",
        "description": "Every 1st, 3rd, 4th & 5th Tuesday of the month. Doors open at 7:30pm. Practice and social dance: 7:45 - 9:45"
    },
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "TUESDAY PRACTICE & SOCIAL DANCE",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-25",
        "end_date": "2025-06-25",
        "start_time": "19:30",
        "end_time": "21:45",
        "price": "Only $7, FREE if you are currently attending a series of WCS lessons",
        "location": "Eastern Star Hall, 3281 Harriet Rd",
        "description": "Every 1st, 3rd, 4th & 5th Tuesday of the month. Doors open at 7:30pm. Practice and social dance: 7:45 - 9:45"
    },
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "TUESDAY PRACTICE & SOCIAL DANCE",
        "day_of_week": "Tuesday",
        "start_date": "2025-07-02",
        "end_date": "2025-07-02",
        "start_time": "19:30",
        "end_time": "21:45",
        "price": "Only $7, FREE if you are currently attending a series of WCS lessons",
        "location": "Eastern Star Hall, 3281 Harriet Rd",
        "description": "Every 1st, 3rd, 4th & 5th Tuesday of the month. Doors open at 7:30pm. Practice and social dance: 7:45 - 9:45"
    },
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "TUESDAY PRACTICE & SOCIAL DANCE",
        "day_of_week": "Tuesday",
        "start_date": "2025-07-09",
        "end_date": "2025-07-09",
        "start_time": "19:30",
        "end_time": "21:45",
        "price": "Only $7, FREE if you are currently attending a series of WCS lessons",
        "location": "Eastern Star Hall, 3281 Harriet Rd",
        "description": "Every 1st, 3rd, 4th & 5th Tuesday of the month. Doors open at 7:30pm. Practice and social dance: 7:45 - 9:45"
    },
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "TUESDAY PRACTICE & SOCIAL DANCE",
        "day_of_week": "Tuesday",
        "start_date": "2025-07-16",
        "end_date": "2025-07-16",
        "start_time": "19:30",
        "end_time": "21:45",
        "price": "Only $7, FREE if you are currently attending a series of WCS lessons",
        "location": "Eastern Star Hall, 3281 Harriet Rd",
        "description": "Every 1st, 3rd, 4th & 5th Tuesday of the month. Doors open at 7:30pm. Practice and social dance: 7:45 - 9:45"
    },
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "TUESDAY PRACTICE & SOCIAL DANCE",
        "day_of_week": "Tuesday",
        "start_date": "2025-07-23",
        "end_date": "2025-07-23",
        "start_time": "19:30",
        "end_time": "21:45",
        "price": "Only $7, FREE if you are currently attending a series of WCS lessons",
        "location": "Eastern Star Hall, 3281 Harriet Rd",
        "description": "Every 1st, 3rd, 4th & 5th Tuesday of the month. Doors open at 7:30pm. Practice and social dance: 7:45 - 9:45"
    },
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "TUESDAY PRACTICE & SOCIAL DANCE",
        "day_of_week": "Tuesday",
        "start_date": "2025-07-30",
        "end_date": "2025-07-30",
        "start_time": "19:30",
        "end_time": "21:45",
        "price": "Only $7, FREE if you are currently attending a series of WCS lessons",
        "location": "Eastern Star Hall, 3281 Harriet Rd",
        "description": "Every 1st, 3rd, 4th & 5th Tuesday of the month. Doors open at 7:30pm. Practice and social dance: 7:45 - 9:45"
    },
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "TUESDAY PRACTICE & SOCIAL DANCE",
        "day_of_week": "Tuesday",
        "start_date": "2025-08-06",
        "end_date": "2025-08-06",
        "start_time": "19:30",
        "end_time": "21:45",
        "price": "Only $7, FREE if you are currently attending a series of WCS lessons",
        "location": "Eastern Star Hall, 3281 Harriet Rd",
        "description": "Every 1st, 3rd, 4th & 5th Tuesday of the month. Doors open at 7:30pm. Practice and social dance: 7:45 - 9:45"
    },
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "TUESDAY PRACTICE & SOCIAL DANCE",
        "day_of_week": "Tuesday",
        "start_date": "2025-08-13",
        "end_date": "2025-08-13",
        "start_time": "19:30",
        "end_time": "21:45",
        "price": "Only $7, FREE if you are currently attending a series of WCS lessons",
        "location": "Eastern Star Hall, 3281 Harriet Rd",
        "description": "Every 1st, 3rd, 4th & 5th Tuesday of the month. Doors open at 7:30pm. Practice and social dance: 7:45 - 9:45"
    },
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "TUESDAY PRACTICE & SOCIAL DANCE",
        "day_of_week": "Tuesday",
        "start_date": "2025-08-20",
        "end_date": "2025-08-20",
        "start_time": "19:30",
        "end_time": "21:45",
        "price": "Only $7, FREE if you are currently attending a series of WCS lessons",
        "location": "Eastern Star Hall, 3281 Harriet Rd",
        "description": "Every 1st, 3rd, 4th & 5th Tuesday of the month. Doors open at 7:30pm. Practice and social dance: 7:45 - 9:45"
    },
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "TUESDAY PRACTICE & SOCIAL DANCE",
        "day_of_week": "Tuesday",
        "start_date": "2025-08-27",
        "end_date": "2025-08-27",
        "start_time": "19:30",
        "end_time": "21:45",
        "price": "Only $7, FREE if you are currently attending a series of WCS lessons",
        "location": "Eastern Star Hall, 3281 Harriet Rd",
        "description": "Every 1st, 3rd, 4th & 5th Tuesday of the month. Doors open at 7:30pm. Practice and social dance: 7:45 - 9:45"
    },
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "TUESDAY PRACTICE & SOCIAL DANCE",
        "day_of_week": "Tuesday",
        "start_date": "2025-09-03",
        "end_date": "2025-09-03",
        "start_time": "19:30",
        "end_time": "21:45",
        "price": "Only $7, FREE if you are currently attending a series of WCS lessons",
        "location": "Eastern Star Hall, 3281 Harriet Rd",
        "description": "Every 1st, 3rd, 4th & 5th Tuesday of the month. Doors open at 7:30pm. Practice and social dance: 7:45 - 9:45"
    },
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "TUESDAY PRACTICE & SOCIAL DANCE",
        "day_of_week": "Tuesday",
        "start_date": "2025-09-10",
        "end_date": "2025-09-10",
        "start_time": "19:30",
        "end_time": "21:45",
        "price": "Only $7, FREE if you are currently attending a series of WCS lessons",
        "location": "Eastern Star Hall, 3281 Harriet Rd",
        "description": "Every 1st, 3rd, 4th & 5th Tuesday of the month. Doors open at 7:30pm. Practice and social dance: 7:45 - 9:45"
    },
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "TUESDAY PRACTICE & SOCIAL DANCE",
        "day_of_week": "Tuesday",
        "start_date": "2025-09-17",
        "end_date": "2025-09-17",
        "start_time": "19:30",
        "end_time": "21:45",
        "price": "Only $7, FREE if you are currently attending a series of WCS lessons",
        "location": "Eastern Star Hall, 3281 Harriet Rd",
        "description": "Every 1st, 3rd, 4th & 5th Tuesday of the month. Doors open at 7:30pm. Practice and social dance: 7:45 - 9:45"
    },
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "TUESDAY PRACTICE & SOCIAL DANCE",
        "day_of_week": "Tuesday",
        "start_date": "2025-09-24",
        "end_date": "2025-09-24",
        "start_time": "19:30",
        "end_time": "21:45",
        "price": "Only $7, FREE if you are currently attending a series of WCS lessons",
        "location": "Eastern Star Hall, 3281 Harriet Rd",
        "description": "Every 1st, 3rd, 4th & 5th Tuesday of the month. Doors open at 7:30pm. Practice and social dance: 7:45 - 9:45"
    }
]
```
2025-06-18 12:47:10 [root] INFO: def extract_and_parse_json(): for url https://www.victoriawestcoastswing.com/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "SATURDAY LESSON & SOCIAL DANCE",
        "day_of_week": "Saturday",
        "start_date": "2025-06-22",
        "end_date": "2025-06-22",
        "start_time": "18:45",
        "end_time": "22:15",
        "price": "$12 for students, $15 for everybody else",
        "location": "Dance Victoria, 2750 Quadra St",
        "description": "Every Saturday. With air conditioning. Doors open at 6:45pm. Lesson: 7:00 - 8:00 - Beginner Basics with Intermediate helpers. Social dance: 8:00 - 10:15"
    },
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "TUESDAY PRACTICE & SOCIAL DANCE",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "19:30",
        "end_time": "21:45",
        "price": "Only $7, FREE if you are currently attending a series of WCS lessons",
        "location": "Eastern Star Hall, 3281 Harriet Rd",
        "description": "Every 1st, 3rd, 4th & 5th Tuesday of the month. Doors open at 7:30pm. Practice and social dance: 7:45 - 9:45"
    },
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "TUESDAY PRACTICE & SOCIAL DANCE",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-25",
        "end_date": "2025-06-25",
        "start_time": "19:30",
        "end_time": "21:45",
        "price": "Only $7, FREE if you are currently attending a series of WCS lessons",
        "location": "Eastern Star Hall, 3281 Harriet Rd",
        "description": "Every 1st, 3rd, 4th & 5th Tuesday of the month. Doors open at 7:30pm. Practice and social dance: 7:45 - 9:45"
    },
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "TUESDAY PRACTICE & SOCIAL DANCE",
        "day_of_week": "Tuesday",
        "start_date": "2025-07-02",
        "end_date": "2025-07-02",
        "start_time": "19:30",
        "end_time": "21:45",
        "price": "Only $7, FREE if you are currently attending a series of WCS lessons",
        "location": "Eastern Star Hall, 3281 Harriet Rd",
        "description": "Every 1st, 3rd, 4th & 5th Tuesday of the month. Doors open at 7:30pm. Practice and social dance: 7:45 - 9:45"
    },
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "TUESDAY PRACTICE & SOCIAL DANCE",
        "day_of_week": "Tuesday",
        "start_date": "2025-07-09",
        "end_date": "2025-07-09",
        "start_time": "19:30",
        "end_time": "21:45",
        "price": "Only $7, FREE if you are currently attending a series of WCS lessons",
        "location": "Eastern Star Hall, 3281 Harriet Rd",
        "description": "Every 1st, 3rd, 4th & 5th Tuesday of the month. Doors open at 7:30pm. Practice and social dance: 7:45 - 9:45"
    },
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "TUESDAY PRACTICE & SOCIAL DANCE",
        "day_of_week": "Tuesday",
        "start_date": "2025-07-16",
        "end_date": "2025-07-16",
        "start_time": "19:30",
        "end_time": "21:45",
        "price": "Only $7, FREE if you are currently attending a series of WCS lessons",
        "location": "Eastern Star Hall, 3281 Harriet Rd",
        "description": "Every 1st, 3rd, 4th & 5th Tuesday of the month. Doors open at 7:30pm. Practice and social dance: 7:45 - 9:45"
    },
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "TUESDAY PRACTICE & SOCIAL DANCE",
        "day_of_week": "Tuesday",
        "start_date": "2025-07-23",
        "end_date": "2025-07-23",
        "start_time": "19:30",
        "end_time": "21:45",
        "price": "Only $7, FREE if you are currently attending a series of WCS lessons",
        "location": "Eastern Star Hall, 3281 Harriet Rd",
        "description": "Every 1st, 3rd, 4th & 5th Tuesday of the month. Doors open at 7:30pm. Practice and social dance: 7:45 - 9:45"
    },
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "TUESDAY PRACTICE & SOCIAL DANCE",
        "day_of_week": "Tuesday",
        "start_date": "2025-07-30",
        "end_date": "2025-07-30",
        "start_time": "19:30",
        "end_time": "21:45",
        "price": "Only $7, FREE if you are currently attending a series of WCS lessons",
        "location": "Eastern Star Hall, 3281 Harriet Rd",
        "description": "Every 1st, 3rd, 4th & 5th Tuesday of the month. Doors open at 7:30pm. Practice and social dance: 7:45 - 9:45"
    },
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "TUESDAY PRACTICE & SOCIAL DANCE",
        "day_of_week": "Tuesday",
        "start_date": "2025-08-06",
        "end_date": "2025-08-06",
        "start_time": "19:30",
        "end_time": "21:45",
        "price": "Only $7, FREE if you are currently attending a series of WCS lessons",
        "location": "Eastern Star Hall, 3281 Harriet Rd",
        "description": "Every 1st, 3rd, 4th & 5th Tuesday of the month. Doors open at 7:30pm. Practice and social dance: 7:45 - 9:45"
    },
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "TUESDAY PRACTICE & SOCIAL DANCE",
        "day_of_week": "Tuesday",
        "start_date": "2025-08-13",
        "end_date": "2025-08-13",
        "start_time": "19:30",
        "end_time": "21:45",
        "price": "Only $7, FREE if you are currently attending a series of WCS lessons",
        "location": "Eastern Star Hall, 3281 Harriet Rd",
        "description": "Every 1st, 3rd, 4th & 5th Tuesday of the month. Doors open at 7:30pm. Practice and social dance: 7:45 - 9:45"
    },
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "TUESDAY PRACTICE & SOCIAL DANCE",
        "day_of_week": "Tuesday",
        "start_date": "2025-08-20",
        "end_date": "2025-08-20",
        "start_time": "19:30",
        "end_time": "21:45",
        "price": "Only $7, FREE if you are currently attending a series of WCS lessons",
        "location": "Eastern Star Hall, 3281 Harriet Rd",
        "description": "Every 1st, 3rd, 4th & 5th Tuesday of the month. Doors open at 7:30pm. Practice and social dance: 7:45 - 9:45"
    },
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "TUESDAY PRACTICE & SOCIAL DANCE",
        "day_of_week": "Tuesday",
        "start_date": "2025-08-27",
        "end_date": "2025-08-27",
        "start_time": "19:30",
        "end_time": "21:45",
        "price": "Only $7, FREE if you are currently attending a series of WCS lessons",
        "location": "Eastern Star Hall, 3281 Harriet Rd",
        "description": "Every 1st, 3rd, 4th & 5th Tuesday of the month. Doors open at 7:30pm. Practice and social dance: 7:45 - 9:45"
    },
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "TUESDAY PRACTICE & SOCIAL DANCE",
        "day_of_week": "Tuesday",
        "start_date": "2025-09-03",
        "end_date": "2025-09-03",
        "start_time": "19:30",
        "end_time": "21:45",
        "price": "Only $7, FREE if you are currently attending a series of WCS lessons",
        "location": "Eastern Star Hall, 3281 Harriet Rd",
        "description": "Every 1st, 3rd, 4th & 5th Tuesday of the month. Doors open at 7:30pm. Practice and social dance: 7:45 - 9:45"
    },
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "TUESDAY PRACTICE & SOCIAL DANCE",
        "day_of_week": "Tuesday",
        "start_date": "2025-09-10",
        "end_date": "2025-09-10",
        "start_time": "19:30",
        "end_time": "21:45",
        "price": "Only $7, FREE if you are currently attending a series of WCS lessons",
        "location": "Eastern Star Hall, 3281 Harriet Rd",
        "description": "Every 1st, 3rd, 4th & 5th Tuesday of the month. Doors open at 7:30pm. Practice and social dance: 7:45 - 9:45"
    },
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "TUESDAY PRACTICE & SOCIAL DANCE",
        "day_of_week": "Tuesday",
        "start_date": "2025-09-17",
        "end_date": "2025-09-17",
        "start_time": "19:30",
        "end_time": "21:45",
        "price": "Only $7, FREE if you are currently attending a series of WCS lessons",
        "location": "Eastern Star Hall, 3281 Harriet Rd",
        "description": "Every 1st, 3rd, 4th & 5th Tuesday of the month. Doors open at 7:30pm. Practice and social dance: 7:45 - 9:45"
    },
    {
        "source": "Victoria West Coast Swing Collective Society",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "TUESDAY PRACTICE & SOCIAL DANCE",
        "day_of_week": "Tuesday",
        "start_date": "2025-09-24",
        "end_date": "2025-09-24",
        "start_time": "19:30",
        "end_time": "21:45",
        "price": "Only $7, FREE if you are currently attending a series of WCS lessons",
        "location": "Eastern Star Hall, 3281 Harriet Rd",
        "description": "Every 1st, 3rd, 4th & 5th Tuesday of the month. Doors open at 7:30pm. Practice and social dance: 7:45 - 9:45"
    }
]
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Starting with events_df shape: (16, 14)
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St' (event_id: None)
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd' (event_id: None)
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd' (event_id: None)
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd' (event_id: None)
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd' (event_id: None)
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd' (event_id: None)
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd' (event_id: None)
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd' (event_id: None)
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd' (event_id: None)
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd' (event_id: None)
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd' (event_id: None)
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd' (event_id: None)
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd' (event_id: None)
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd' (event_id: None)
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd' (event_id: None)
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd' (event_id: None)
2025-06-18 12:47:10 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:10 [root] INFO: write_events_to_db: Number of events to write: 16
2025-06-18 12:47:10 [root] INFO: write_url_to_db(): appended URL 'https://www.victoriawestcoastswing.com/'
2025-06-18 12:47:10 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:47:10 [root] INFO: def process_llm_response: URL https://www.victoriawestcoastswing.com/ marked as relevant with events written to the database.
2025-06-18 12:47:10 [root] INFO: write_url_to_db(): appended URL 'https://www.victoriawestcoastswing.com/'
2025-06-18 12:47:10 [root] INFO: def parse(): URL https://www.victoriawestcoastswing.com/ marked as relevant (LLM positive).
2025-06-18 12:47:10 [root] INFO: def parse(): Found 4 links on https://www.victoriawestcoastswing.com/
2025-06-18 12:47:10 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://calendar.google.com/calendar/embed?height=600&wkst=1&bgcolor=%23ffffff&ctz=America%2FVancouver&mode=AGENDA&src=dmljdG9yaWF3Y3Njb2xsZWN0aXZlQGdtYWlsLmNvbQ&color=%23039BE5&wmode=opaque, URL: https://www.victoriawestcoastswing.com/, source: Victoria West Coast Swing Collective, keywords: west coast swing, wcs
2025-06-18 12:47:10 [root] INFO: def process_calendar_id(): Processing calendar_id: victoriawcscollective@gmail.com from https://calendar.google.com/calendar/embed?height=600&wkst=1&bgcolor=%23ffffff&ctz=America%2FVancouver&mode=AGENDA&src=dmljdG9yaWF3Y3Njb2xsZWN0aXZlQGdtYWlsLmNvbQ&color=%23039BE5&wmode=opaque
2025-06-18 12:47:10 [root] INFO: def get_credentials(): Retrieved credentials for Google.
2025-06-18 12:47:11 [root] INFO: def process_calendar_id(): Found 98 events for calendar_id: victoriawcscollective@gmail.com
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Starting with events_df shape: (98, 14)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria, 2750 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Processing location 'Eastern Star Hall, 3281 Harriet Rd, Victoria, BC' (event_id: None)
2025-06-18 12:47:11 [root] INFO: def clean_up_address(): Updated event None with address_id 3466 using DB match
2025-06-18 12:47:11 [root] INFO: write_events_to_db: Number of events to write: 98
2025-06-18 12:47:11 [root] INFO: write_url_to_db(): appended URL 'victoriawcscollective@gmail.com'
2025-06-18 12:47:11 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:47:11 [root] INFO: write_url_to_db(): appended URL 'https://calendar.google.com/calendar/embed?height=600&wkst=1&bgcolor=%23ffffff&ctz=America%2FVancouver&mode=AGENDA&src=dmljdG9yaWF3Y3Njb2xsZWN0aXZlQGdtYWlsLmNvbQ&color=%23039BE5&wmode=opaque'
2025-06-18 12:47:11 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/490693954419117/'
2025-06-18 12:47:11 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/groups/490693954419117/
2025-06-18 12:47:11 [root] INFO: should_process_url: URL https://goo.gl/maps/xmdESQHLRW8anzTZ6 does not meet criteria for processing, skipping it.
2025-06-18 12:47:11 [root] INFO: def eventbrite_search(): Skipping URL https://goo.gl/maps/xmdESQHLRW8anzTZ6 based on historical relevancy.
2025-06-18 12:47:11 [root] INFO: should_process_url: URL https://www.victoriawestcoastswing.com/ was last seen as not relevant but hit_ratio (11.50) > 0.1 or crawl_try (25) ≤ 3, processing it.
2025-06-18 12:47:11 [root] INFO: should_process_url: URL https://www.victoriawestcoastswing.com/ was last seen as not relevant but hit_ratio (11.50) > 0.1 or crawl_try (25) ≤ 3, processing it.
2025-06-18 12:47:11 [root] INFO: write_url_to_db(): appended URL 'https://www.victoriawestcoastswing.com/'
2025-06-18 12:47:11 [root] INFO: def parse(): Crawling next URL: https://www.victoriawestcoastswing.com/
2025-06-18 12:47:11 [root] INFO: def parse(): Found keywords for URL https://www.facebook.com/groups/245161325497073/user/61552396445868/: ['dance']
2025-06-18 12:47:11 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.facebook.com/groups/245161325497073/user/61552396445868/
2025-06-18 12:47:11 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 12:47:11 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 12:47:11 [root] INFO: query_llm(): Querying Mistral
2025-06-18 12:47:38 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:47:38 [root] INFO: query_llm(): Mistral response received: [
  {
    "source": "Facebook Group Page",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "",
    "day_of_week": "",
    "start_date": "",
    "end_date": "",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": ""
  }
]
2025-06-18 12:47:38 [root] INFO: def extract_and_parse_json(): for url https://www.facebook.com/groups/245161325497073/user/61552396445868/, 
Cleaned JSON ready for parsing:
[
  {
    "source": "Facebook Group Page",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "",
    "day_of_week": "",
    "start_date": "",
    "end_date": "",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": ""
  }
]
2025-06-18 12:47:38 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:47:38 [root] INFO: write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:47:38 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/245161325497073/user/61552396445868/'
2025-06-18 12:47:38 [root] INFO: def process_llm_response: URL https://www.facebook.com/groups/245161325497073/user/61552396445868/ marked as relevant with events written to the database.
2025-06-18 12:47:38 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/245161325497073/user/61552396445868/'
2025-06-18 12:47:38 [root] INFO: def parse(): URL https://www.facebook.com/groups/245161325497073/user/61552396445868/ marked as relevant (LLM positive).
2025-06-18 12:47:38 [root] INFO: def parse(): Found 10 links on https://www.facebook.com/groups/245161325497073/user/61552396445868/
2025-06-18 12:47:38 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/245161325497073/user/61552396445868/'
2025-06-18 12:47:38 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/groups/245161325497073/user/61552396445868/
2025-06-18 12:47:38 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/'
2025-06-18 12:47:38 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/
2025-06-18 12:47:38 [root] INFO: write_url_to_db(): appended URL 'https://es-la.facebook.com/groups/245161325497073/user/61552396445868/'
2025-06-18 12:47:38 [root] INFO: def parse(): Recorded unwanted URL: https://es-la.facebook.com/groups/245161325497073/user/61552396445868/
2025-06-18 12:47:38 [root] INFO: write_url_to_db(): appended URL 'https://fr-ca.facebook.com/groups/245161325497073/user/61552396445868/'
2025-06-18 12:47:38 [root] INFO: def parse(): Recorded unwanted URL: https://fr-ca.facebook.com/groups/245161325497073/user/61552396445868/
2025-06-18 12:47:38 [root] INFO: write_url_to_db(): appended URL 'https://ko-kr.facebook.com/groups/245161325497073/user/61552396445868/'
2025-06-18 12:47:38 [root] INFO: def parse(): Recorded unwanted URL: https://ko-kr.facebook.com/groups/245161325497073/user/61552396445868/
2025-06-18 12:47:38 [root] INFO: write_url_to_db(): appended URL 'https://ja-jp.facebook.com/groups/245161325497073/user/61552396445868/'
2025-06-18 12:47:38 [root] INFO: def parse(): Recorded unwanted URL: https://ja-jp.facebook.com/groups/245161325497073/user/61552396445868/
2025-06-18 12:47:38 [root] INFO: write_url_to_db(): appended URL 'https://zh-cn.facebook.com/groups/245161325497073/user/61552396445868/'
2025-06-18 12:47:38 [root] INFO: def parse(): Recorded unwanted URL: https://zh-cn.facebook.com/groups/245161325497073/user/61552396445868/
2025-06-18 12:47:38 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/recover/initiate?lwv=110&ars=royal_blue_bar'
2025-06-18 12:47:38 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/recover/initiate?lwv=110&ars=royal_blue_bar
2025-06-18 12:47:38 [root] INFO: write_url_to_db(): appended URL 'https://pt-br.facebook.com/groups/245161325497073/user/61552396445868/'
2025-06-18 12:47:38 [root] INFO: def parse(): Recorded unwanted URL: https://pt-br.facebook.com/groups/245161325497073/user/61552396445868/
2025-06-18 12:47:38 [root] INFO: def parse(): Found keywords for URL https://calientedance.com/classes/: ['bachata', 'dance', 'merengue', 'salsa']
2025-06-18 12:47:38 [root] INFO: def generate_prompt(): Generating prompt for URL: https://calientedance.com/classes/
2025-06-18 12:47:38 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 12:47:38 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 12:47:38 [root] INFO: query_llm(): Querying Mistral
2025-06-18 12:47:48 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:47:48 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "Salsa Caliente",
        "dance_style": "salsa",
        "url": "",
        "event_type": "class",
        "event_name": "Salsa Fundamentals/Beginner",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-24",
        "end_date": "2025-06-24",
        "start_time": "20:00",
        "end_time": "null",
        "price": "",
        "location": "",
        "description": "Salsa Fundamentals/Beginner class on Tuesdays at 8pm."
    },
    {
        "source": "Salsa Caliente",
        "dance_style": "salsa",
        "url": "",
        "event_type": "class",
        "event_name": "Salsa Beginner Intermediate",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-24",
        "end_date": "2025-06-24",
        "start_time": "21:00",
        "end_time": "null",
        "price": "",
        "location": "",
        "description": "Salsa Beginner Intermediate class on Tuesdays at 9pm."
    },
    {
        "source": "Salsa Caliente",
        "dance_style": "salsa",
        "url": "",
        "event_type": "class",
        "event_name": "Salsa Intermediate/Advanced",
        "day_of_week": "Monday",
        "start_date": "2025-06-23",
        "end_date": "2025-06-23",
        "start_time": "20:00",
        "end_time": "null",
        "price": "",
        "location": "",
        "description": "Salsa Intermediate/Advanced class on Mondays at 8pm."
    },
    {
        "source": "Salsa Caliente",
        "dance_style": "bachata, merengue",
        "url": "",
        "event_type": "class",
        "event_name": "Bachata & Merengue All Levels",
        "day_of_week": "Thursday",
        "start_date": "2025-06-26",
        "end_date": "2025-06-26",
        "start_time": "20:00",
        "end_time": "null",
        "price": "",
        "location": "",
        "description": "Bachata & Merengue All Levels class on Thursdays at 8pm."
    }
]
2025-06-18 12:47:48 [root] INFO: def extract_and_parse_json(): for url https://calientedance.com/classes/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Salsa Caliente",
        "dance_style": "salsa",
        "url": "",
        "event_type": "class",
        "event_name": "Salsa Fundamentals/Beginner",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-24",
        "end_date": "2025-06-24",
        "start_time": "20:00",
        "end_time": "null",
        "price": "",
        "location": "",
        "description": "Salsa Fundamentals/Beginner class on Tuesdays at 8pm."
    },
    {
        "source": "Salsa Caliente",
        "dance_style": "salsa",
        "url": "",
        "event_type": "class",
        "event_name": "Salsa Beginner Intermediate",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-24",
        "end_date": "2025-06-24",
        "start_time": "21:00",
        "end_time": "null",
        "price": "",
        "location": "",
        "description": "Salsa Beginner Intermediate class on Tuesdays at 9pm."
    },
    {
        "source": "Salsa Caliente",
        "dance_style": "salsa",
        "url": "",
        "event_type": "class",
        "event_name": "Salsa Intermediate/Advanced",
        "day_of_week": "Monday",
        "start_date": "2025-06-23",
        "end_date": "2025-06-23",
        "start_time": "20:00",
        "end_time": "null",
        "price": "",
        "location": "",
        "description": "Salsa Intermediate/Advanced class on Mondays at 8pm."
    },
    {
        "source": "Salsa Caliente",
        "dance_style": "bachata, merengue",
        "url": "",
        "event_type": "class",
        "event_name": "Bachata & Merengue All Levels",
        "day_of_week": "Thursday",
        "start_date": "2025-06-26",
        "end_date": "2025-06-26",
        "start_time": "20:00",
        "end_time": "null",
        "price": "",
        "location": "",
        "description": "Bachata & Merengue All Levels class on Thursdays at 8pm."
    }
]
2025-06-18 12:47:48 [root] INFO: def clean_up_address(): Starting with events_df shape: (4, 14)
2025-06-18 12:47:48 [root] INFO: write_events_to_db: Number of events to write: 4
2025-06-18 12:47:48 [root] INFO: write_url_to_db(): appended URL 'https://calientedance.com/classes/'
2025-06-18 12:47:48 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:47:48 [root] INFO: def process_llm_response: URL https://calientedance.com/classes/ marked as relevant with events written to the database.
2025-06-18 12:47:48 [root] INFO: write_url_to_db(): appended URL 'https://calientedance.com/classes/'
2025-06-18 12:47:48 [root] INFO: def parse(): URL https://calientedance.com/classes/ marked as relevant (LLM positive).
2025-06-18 12:47:48 [root] INFO: def parse(): Found 9 links on https://calientedance.com/classes/
2025-06-18 12:47:48 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.google.com/calendar/embed?title=Salsa%20Caliente%20-%20Class%20Schedule&mode=MONTH&height=900&wkst=1&bgcolor=%23ffcccc&src=75b7agh1gm6fm5jom929ngrl44%40group.calendar.google.com&color=%23060D5E&src=kvftnqll1kp6must932amj68hg%40group.calendar.google.com&color=%235B123B&src=2skri656scokb6dq4bqfk4nf1s%40group.calendar.google.com&color=%23125A12&src=caepaka4hvam7f8207kfa97up0%40group.calendar.google.com&color=%23333333&src=le6mdl9t8dha2vhgg3qp5kqbj8%40group.calendar.google.com&color=%23A32929&src=nufist0fq81lhh238ptkgjdhl8%40group.calendar.google.com&color=%231B887A&src=lkk7aheuitv2365gpvbnsf317s%40group.calendar.google.com&color=%23856508&ctz=America%2FVancouver, URL: https://calientedance.com/classes/, source: Salsa Caliente, keywords: salsa, bachata, kizomba, merengue, cha cha cha
2025-06-18 12:47:48 [root] INFO: def process_calendar_id(): Processing calendar_id: 75b7agh1gm6fm5jom929ngrl44@group.calendar.google.com from https://www.google.com/calendar/embed?title=Salsa%20Caliente%20-%20Class%20Schedule&mode=MONTH&height=900&wkst=1&bgcolor=%23ffcccc&src=75b7agh1gm6fm5jom929ngrl44%40group.calendar.google.com&color=%23060D5E&src=kvftnqll1kp6must932amj68hg%40group.calendar.google.com&color=%235B123B&src=2skri656scokb6dq4bqfk4nf1s%40group.calendar.google.com&color=%23125A12&src=caepaka4hvam7f8207kfa97up0%40group.calendar.google.com&color=%23333333&src=le6mdl9t8dha2vhgg3qp5kqbj8%40group.calendar.google.com&color=%23A32929&src=nufist0fq81lhh238ptkgjdhl8%40group.calendar.google.com&color=%231B887A&src=lkk7aheuitv2365gpvbnsf317s%40group.calendar.google.com&color=%23856508&ctz=America%2FVancouver
2025-06-18 12:47:48 [root] INFO: def get_credentials(): Retrieved credentials for Google.
2025-06-18 12:47:48 [root] INFO: def process_calendar_id(): Found 27 events for calendar_id: 75b7agh1gm6fm5jom929ngrl44@group.calendar.google.com
2025-06-18 12:47:48 [root] INFO: def clean_up_address(): Starting with events_df shape: (27, 14)
2025-06-18 12:47:48 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:48 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:48 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:48 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:48 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:48 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:48 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:48 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:48 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:48 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:48 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:48 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:48 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:48 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:48 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:48 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:48 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:48 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:48 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:48 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:48 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:48 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:48 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:48 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:48 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:48 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:48 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:48 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:48 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:48 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:48 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:48 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:48 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:48 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:48 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:48 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:48 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:48 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:48 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: write_events_to_db: Number of events to write: 27
2025-06-18 12:47:49 [root] INFO: write_url_to_db(): appended URL '75b7agh1gm6fm5jom929ngrl44@group.calendar.google.com'
2025-06-18 12:47:49 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:47:49 [root] INFO: def process_calendar_id(): Processing calendar_id: kvftnqll1kp6must932amj68hg@group.calendar.google.com from https://www.google.com/calendar/embed?title=Salsa%20Caliente%20-%20Class%20Schedule&mode=MONTH&height=900&wkst=1&bgcolor=%23ffcccc&src=75b7agh1gm6fm5jom929ngrl44%40group.calendar.google.com&color=%23060D5E&src=kvftnqll1kp6must932amj68hg%40group.calendar.google.com&color=%235B123B&src=2skri656scokb6dq4bqfk4nf1s%40group.calendar.google.com&color=%23125A12&src=caepaka4hvam7f8207kfa97up0%40group.calendar.google.com&color=%23333333&src=le6mdl9t8dha2vhgg3qp5kqbj8%40group.calendar.google.com&color=%23A32929&src=nufist0fq81lhh238ptkgjdhl8%40group.calendar.google.com&color=%231B887A&src=lkk7aheuitv2365gpvbnsf317s%40group.calendar.google.com&color=%23856508&ctz=America%2FVancouver
2025-06-18 12:47:49 [root] INFO: def get_credentials(): Retrieved credentials for Google.
2025-06-18 12:47:49 [root] INFO: def process_calendar_id(): Found 25 events for calendar_id: kvftnqll1kp6must932amj68hg@group.calendar.google.com
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Starting with events_df shape: (25, 14)
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:49 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:49 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:49 [root] INFO: write_events_to_db: Number of events to write: 25
2025-06-18 12:47:49 [root] INFO: write_url_to_db(): appended URL 'kvftnqll1kp6must932amj68hg@group.calendar.google.com'
2025-06-18 12:47:49 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:47:49 [root] INFO: def process_calendar_id(): Processing calendar_id: 2skri656scokb6dq4bqfk4nf1s@group.calendar.google.com from https://www.google.com/calendar/embed?title=Salsa%20Caliente%20-%20Class%20Schedule&mode=MONTH&height=900&wkst=1&bgcolor=%23ffcccc&src=75b7agh1gm6fm5jom929ngrl44%40group.calendar.google.com&color=%23060D5E&src=kvftnqll1kp6must932amj68hg%40group.calendar.google.com&color=%235B123B&src=2skri656scokb6dq4bqfk4nf1s%40group.calendar.google.com&color=%23125A12&src=caepaka4hvam7f8207kfa97up0%40group.calendar.google.com&color=%23333333&src=le6mdl9t8dha2vhgg3qp5kqbj8%40group.calendar.google.com&color=%23A32929&src=nufist0fq81lhh238ptkgjdhl8%40group.calendar.google.com&color=%231B887A&src=lkk7aheuitv2365gpvbnsf317s%40group.calendar.google.com&color=%23856508&ctz=America%2FVancouver
2025-06-18 12:47:49 [root] INFO: def get_credentials(): Retrieved credentials for Google.
2025-06-18 12:47:50 [root] INFO: def process_calendar_id(): Found 51 events for calendar_id: 2skri656scokb6dq4bqfk4nf1s@group.calendar.google.com
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Starting with events_df shape: (51, 14)
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:50 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:50 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:50 [root] INFO: write_events_to_db: Number of events to write: 51
2025-06-18 12:47:50 [root] INFO: write_url_to_db(): appended URL '2skri656scokb6dq4bqfk4nf1s@group.calendar.google.com'
2025-06-18 12:47:50 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:47:50 [root] INFO: def process_calendar_id(): Processing calendar_id: caepaka4hvam7f8207kfa97up0@group.calendar.google.com from https://www.google.com/calendar/embed?title=Salsa%20Caliente%20-%20Class%20Schedule&mode=MONTH&height=900&wkst=1&bgcolor=%23ffcccc&src=75b7agh1gm6fm5jom929ngrl44%40group.calendar.google.com&color=%23060D5E&src=kvftnqll1kp6must932amj68hg%40group.calendar.google.com&color=%235B123B&src=2skri656scokb6dq4bqfk4nf1s%40group.calendar.google.com&color=%23125A12&src=caepaka4hvam7f8207kfa97up0%40group.calendar.google.com&color=%23333333&src=le6mdl9t8dha2vhgg3qp5kqbj8%40group.calendar.google.com&color=%23A32929&src=nufist0fq81lhh238ptkgjdhl8%40group.calendar.google.com&color=%231B887A&src=lkk7aheuitv2365gpvbnsf317s%40group.calendar.google.com&color=%23856508&ctz=America%2FVancouver
2025-06-18 12:47:50 [root] INFO: def get_credentials(): Retrieved credentials for Google.
2025-06-18 12:47:51 [root] INFO: def process_calendar_id(): Found 185 events for calendar_id: caepaka4hvam7f8207kfa97up0@group.calendar.google.com
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Starting with events_df shape: (185, 14)
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:51 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:51 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:51 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:52 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:52 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:52 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:53 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:53 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:53 [root] INFO: write_events_to_db: Number of events to write: 185
2025-06-18 12:47:53 [root] INFO: write_url_to_db(): appended URL 'caepaka4hvam7f8207kfa97up0@group.calendar.google.com'
2025-06-18 12:47:53 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:47:53 [root] INFO: def process_calendar_id(): Processing calendar_id: le6mdl9t8dha2vhgg3qp5kqbj8@group.calendar.google.com from https://www.google.com/calendar/embed?title=Salsa%20Caliente%20-%20Class%20Schedule&mode=MONTH&height=900&wkst=1&bgcolor=%23ffcccc&src=75b7agh1gm6fm5jom929ngrl44%40group.calendar.google.com&color=%23060D5E&src=kvftnqll1kp6must932amj68hg%40group.calendar.google.com&color=%235B123B&src=2skri656scokb6dq4bqfk4nf1s%40group.calendar.google.com&color=%23125A12&src=caepaka4hvam7f8207kfa97up0%40group.calendar.google.com&color=%23333333&src=le6mdl9t8dha2vhgg3qp5kqbj8%40group.calendar.google.com&color=%23A32929&src=nufist0fq81lhh238ptkgjdhl8%40group.calendar.google.com&color=%231B887A&src=lkk7aheuitv2365gpvbnsf317s%40group.calendar.google.com&color=%23856508&ctz=America%2FVancouver
2025-06-18 12:47:53 [root] INFO: def get_credentials(): Retrieved credentials for Google.
2025-06-18 12:47:54 [root] INFO: def process_calendar_id(): Found 43 events for calendar_id: le6mdl9t8dha2vhgg3qp5kqbj8@group.calendar.google.com
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Starting with events_df shape: (43, 14)
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:54 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:54 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Victoria Edelweiss Club, 108 Niagara St, Victoria, BC V8V 1E9, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Updated event None with address_id 5 using DB match
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:54 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'The Coda, 751 View St, Victoria, BC V8W 1J9, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Updated event None with address_id 4326 using DB match
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:54 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'STUDIO 4 ATHLETICS, 715 YATES ST' (event_id: None)
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:54 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:54 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:54 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:54 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'STUDIO 4 ATHLETICS, 715 YATES ST' (event_id: None)
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:54 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:54 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Victoria Edelweiss Club, 108 Niagara St, Victoria, BC V8V 1E9, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Updated event None with address_id 5 using DB match
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:54 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:54 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:54 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'STUDIO 4 ATHLETICS, 715 YATES ST' (event_id: None)
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:54 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:54 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Victoria Edelweiss Club, 108 Niagara St, Victoria, BC V8V 1E9, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Updated event None with address_id 5 using DB match
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:54 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:54 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'STUDIO 4 ATHLETICS, 715 YATES ST' (event_id: None)
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:54 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:54 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:54 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:54 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'STUDIO 4 ATHLETICS, 715 YATES ST' (event_id: None)
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:54 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:54 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:54 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Victoria Edelweiss Club, 108 Niagara St, Victoria, BC V8V 1E9, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Updated event None with address_id 5 using DB match
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:54 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:54 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Studio 4 Athletics, 715 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:47:54 [root] INFO: Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Victoria Edelweiss Club, 108 Niagara St, Victoria, BC V8V 1E9, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Updated event None with address_id 5 using DB match
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Victoria Edelweiss Club, 108 Niagara St, Victoria, BC V8V 1E9, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Updated event None with address_id 5 using DB match
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Victoria Edelweiss Club, 108 Niagara St, Victoria, BC V8V 1E9, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Updated event None with address_id 5 using DB match
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Victoria Edelweiss Club, 108 Niagara St, Victoria, BC V8V 1E9, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Updated event None with address_id 5 using DB match
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Victoria Edelweiss Club, 108 Niagara St, Victoria, BC V8V 1E9, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Updated event None with address_id 5 using DB match
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Victoria Edelweiss Club, 108 Niagara St, Victoria, BC V8V 1E9, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Updated event None with address_id 5 using DB match
2025-06-18 12:47:54 [root] INFO: write_events_to_db: Number of events to write: 43
2025-06-18 12:47:54 [root] INFO: write_url_to_db(): appended URL 'le6mdl9t8dha2vhgg3qp5kqbj8@group.calendar.google.com'
2025-06-18 12:47:54 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:47:54 [root] INFO: def process_calendar_id(): Processing calendar_id: nufist0fq81lhh238ptkgjdhl8@group.calendar.google.com from https://www.google.com/calendar/embed?title=Salsa%20Caliente%20-%20Class%20Schedule&mode=MONTH&height=900&wkst=1&bgcolor=%23ffcccc&src=75b7agh1gm6fm5jom929ngrl44%40group.calendar.google.com&color=%23060D5E&src=kvftnqll1kp6must932amj68hg%40group.calendar.google.com&color=%235B123B&src=2skri656scokb6dq4bqfk4nf1s%40group.calendar.google.com&color=%23125A12&src=caepaka4hvam7f8207kfa97up0%40group.calendar.google.com&color=%23333333&src=le6mdl9t8dha2vhgg3qp5kqbj8%40group.calendar.google.com&color=%23A32929&src=nufist0fq81lhh238ptkgjdhl8%40group.calendar.google.com&color=%231B887A&src=lkk7aheuitv2365gpvbnsf317s%40group.calendar.google.com&color=%23856508&ctz=America%2FVancouver
2025-06-18 12:47:54 [root] INFO: def get_credentials(): Retrieved credentials for Google.
2025-06-18 12:47:54 [root] INFO: def process_calendar_id(): Found 3 events for calendar_id: nufist0fq81lhh238ptkgjdhl8@group.calendar.google.com
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Starting with events_df shape: (3, 14)
2025-06-18 12:47:54 [root] INFO: def clean_up_address(): Processing location 'Robson Square, 800 Robson St, Vancouver, BC V6E 1A7, Canada' (event_id: None)
2025-06-18 12:47:54 [root] INFO: get_address_id: Inserted or updated address_id 12538 for address '1030 Robson ST, VANCOUVER, BC, V6E1A7, CA'.
2025-06-18 12:47:54 [root] INFO: Populated from DB for postal code 'V6E1A7': '1030 Robson ST, VANCOUVER, BC, V6E1A7, CA'
2025-06-18 12:47:54 [root] INFO: write_events_to_db: Number of events to write: 3
2025-06-18 12:47:54 [root] INFO: write_url_to_db(): appended URL 'nufist0fq81lhh238ptkgjdhl8@group.calendar.google.com'
2025-06-18 12:47:54 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:47:54 [root] INFO: def process_calendar_id(): Processing calendar_id: lkk7aheuitv2365gpvbnsf317s@group.calendar.google.com from https://www.google.com/calendar/embed?title=Salsa%20Caliente%20-%20Class%20Schedule&mode=MONTH&height=900&wkst=1&bgcolor=%23ffcccc&src=75b7agh1gm6fm5jom929ngrl44%40group.calendar.google.com&color=%23060D5E&src=kvftnqll1kp6must932amj68hg%40group.calendar.google.com&color=%235B123B&src=2skri656scokb6dq4bqfk4nf1s%40group.calendar.google.com&color=%23125A12&src=caepaka4hvam7f8207kfa97up0%40group.calendar.google.com&color=%23333333&src=le6mdl9t8dha2vhgg3qp5kqbj8%40group.calendar.google.com&color=%23A32929&src=nufist0fq81lhh238ptkgjdhl8%40group.calendar.google.com&color=%231B887A&src=lkk7aheuitv2365gpvbnsf317s%40group.calendar.google.com&color=%23856508&ctz=America%2FVancouver
2025-06-18 12:47:54 [root] INFO: def get_credentials(): Retrieved credentials for Google.
2025-06-18 12:47:55 [root] INFO: def get_calendar_events(): No events found for calendar_id: lkk7aheuitv2365gpvbnsf317s@group.calendar.google.com
2025-06-18 12:47:55 [root] INFO: write_url_to_db(): appended URL 'https://www.google.com/calendar/embed?title=Salsa%20Caliente%20-%20Class%20Schedule&mode=MONTH&height=900&wkst=1&bgcolor=%23ffcccc&src=75b7agh1gm6fm5jom929ngrl44%40group.calendar.google.com&color=%23060D5E&src=kvftnqll1kp6must932amj68hg%40group.calendar.google.com&color=%235B123B&src=2skri656scokb6dq4bqfk4nf1s%40group.calendar.google.com&color=%23125A12&src=caepaka4hvam7f8207kfa97up0%40group.calendar.google.com&color=%23333333&src=le6mdl9t8dha2vhgg3qp5kqbj8%40group.calendar.google.com&color=%23A32929&src=nufist0fq81lhh238ptkgjdhl8%40group.calendar.google.com&color=%231B887A&src=lkk7aheuitv2365gpvbnsf317s%40group.calendar.google.com&color=%23856508&ctz=America%2FVancouver'
2025-06-18 12:47:55 [root] INFO: should_process_url: URL https://calientedance.com/classes/ was last seen as not relevant but hit_ratio (2.00) > 0.1 or crawl_try (9) ≤ 3, processing it.
2025-06-18 12:47:55 [root] INFO: should_process_url: URL https://calientedance.com/classes/ was last seen as not relevant but hit_ratio (2.00) > 0.1 or crawl_try (9) ≤ 3, processing it.
2025-06-18 12:47:55 [root] INFO: write_url_to_db(): appended URL 'https://calientedance.com/classes/'
2025-06-18 12:47:55 [root] INFO: def parse(): Crawling next URL: https://calientedance.com/classes/
2025-06-18 12:47:55 [root] INFO: def parse(): Found keywords for URL https://calientedance.com/: ['dance', 'salsa']
2025-06-18 12:47:55 [root] INFO: def generate_prompt(): Generating prompt for URL: https://calientedance.com/
2025-06-18 12:47:55 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 12:47:55 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 12:47:55 [root] INFO: query_llm(): Querying Mistral
2025-06-18 12:48:02 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:48:02 [root] INFO: query_llm(): Mistral response received: ```json
[
    {
        "source": "Salsa Caliente Dance Company",
        "dance_style": "salsa",
        "url": "",
        "event_type": "other",
        "event_name": "roadtrip to kelowna",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Roadtrip to Kelowna"
    },
    {
        "source": "Salsa Caliente Dance Company",
        "dance_style": "",
        "url": "",
        "event_type": "class",
        "event_name": "registration open for july classes",
        "day_of_week": "Saturday",
        "start_date": "2025-06-23",
        "end_date": "2025-06-23",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Registration open for July classes"
    },
    {
        "source": "Salsa Caliente Dance Company",
        "dance_style": "salsa",
        "url": "",
        "event_type": "social dance",
        "event_name": "salsa night @ dance city",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-27",
        "end_date": "2025-06-27",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Dance City",
        "description": "Salsa night at Dance City"
    },
    {
        "source": "Salsa Caliente Dance Company",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "club havana dance party & show",
        "day_of_week": "Friday",
        "start_date": "2025-07-05",
        "end_date": "2025-07-05",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Club Havana",
        "description": "Club Havana dance party & show"
    }
]
```
2025-06-18 12:48:02 [root] INFO: def extract_and_parse_json(): for url https://calientedance.com/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Salsa Caliente Dance Company",
        "dance_style": "salsa",
        "url": "",
        "event_type": "other",
        "event_name": "roadtrip to kelowna",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Roadtrip to Kelowna"
    },
    {
        "source": "Salsa Caliente Dance Company",
        "dance_style": "",
        "url": "",
        "event_type": "class",
        "event_name": "registration open for july classes",
        "day_of_week": "Saturday",
        "start_date": "2025-06-23",
        "end_date": "2025-06-23",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Registration open for July classes"
    },
    {
        "source": "Salsa Caliente Dance Company",
        "dance_style": "salsa",
        "url": "",
        "event_type": "social dance",
        "event_name": "salsa night @ dance city",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-27",
        "end_date": "2025-06-27",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Dance City",
        "description": "Salsa night at Dance City"
    },
    {
        "source": "Salsa Caliente Dance Company",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "club havana dance party & show",
        "day_of_week": "Friday",
        "start_date": "2025-07-05",
        "end_date": "2025-07-05",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Club Havana",
        "description": "Club Havana dance party & show"
    }
]
2025-06-18 12:48:02 [root] INFO: def clean_up_address(): Starting with events_df shape: (4, 14)
2025-06-18 12:48:02 [root] INFO: def clean_up_address(): Processing location 'Dance City' (event_id: None)
2025-06-18 12:48:02 [root] INFO: def clean_up_address(): Processing location 'Club Havana' (event_id: None)
2025-06-18 12:48:02 [root] INFO: write_events_to_db: Number of events to write: 4
2025-06-18 12:48:02 [root] INFO: write_url_to_db(): appended URL 'https://calientedance.com/'
2025-06-18 12:48:02 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:48:02 [root] INFO: def process_llm_response: URL https://calientedance.com/ marked as relevant with events written to the database.
2025-06-18 12:48:02 [root] INFO: write_url_to_db(): appended URL 'https://calientedance.com/'
2025-06-18 12:48:02 [root] INFO: def parse(): URL https://calientedance.com/ marked as relevant (LLM positive).
2025-06-18 12:48:02 [root] INFO: def parse(): Found 10 links on https://calientedance.com/
2025-06-18 12:48:02 [root] INFO: should_process_url: URL https://calientedance.com/classes/ was last seen as not relevant but hit_ratio (2.00) > 0.1 or crawl_try (9) ≤ 3, processing it.
2025-06-18 12:48:02 [root] INFO: should_process_url: URL https://calientedance.com/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:48:02 [root] INFO: should_process_url: URL https://calientedance.com/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:48:02 [root] INFO: write_url_to_db(): appended URL 'https://calientedance.com/contact/'
2025-06-18 12:48:02 [root] INFO: def parse(): Crawling next URL: https://calientedance.com/contact/
2025-06-18 12:48:02 [root] INFO: def parse(): Found keywords for URL https://alivetangovictoria.ca/: ['argentine tango', 'dance', 'milonga', 'tango']
2025-06-18 12:48:02 [root] INFO: def generate_prompt(): Generating prompt for URL: https://alivetangovictoria.ca/
2025-06-18 12:48:02 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 12:48:02 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 12:48:02 [root] INFO: query_llm(): Querying Mistral
2025-06-18 12:48:12 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:48:12 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "Alive Tango Victoria",
        "dance_style": "tango",
        "url": "",
        "event_type": "social dance",
        "event_name": "Milonga de la Tardecita",
        "day_of_week": "Sunday",
        "start_date": "2025-05-05",
        "end_date": "2025-05-05",
        "start_time": "14:00",
        "end_time": "17:00",
        "price": "",
        "location": "Norway House",
        "description": "Milonga de la Tardecita"
    }
]
2025-06-18 12:48:12 [root] INFO: def extract_and_parse_json(): for url https://alivetangovictoria.ca/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Alive Tango Victoria",
        "dance_style": "tango",
        "url": "",
        "event_type": "social dance",
        "event_name": "Milonga de la Tardecita",
        "day_of_week": "Sunday",
        "start_date": "2025-05-05",
        "end_date": "2025-05-05",
        "start_time": "14:00",
        "end_time": "17:00",
        "price": "",
        "location": "Norway House",
        "description": "Milonga de la Tardecita"
    }
]
2025-06-18 12:48:12 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:48:12 [root] INFO: def clean_up_address(): Processing location 'Norway House' (event_id: None)
2025-06-18 12:48:12 [root] INFO: write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:48:12 [root] INFO: write_url_to_db(): appended URL 'https://alivetangovictoria.ca/'
2025-06-18 12:48:12 [root] INFO: def process_llm_response: URL https://alivetangovictoria.ca/ marked as relevant with events written to the database.
2025-06-18 12:48:12 [root] INFO: write_url_to_db(): appended URL 'https://alivetangovictoria.ca/'
2025-06-18 12:48:12 [root] INFO: def parse(): URL https://alivetangovictoria.ca/ marked as relevant (LLM positive).
2025-06-18 12:48:12 [root] INFO: def parse(): Found 10 links on https://alivetangovictoria.ca/
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://alivetangovictoria.ca/studio/ was last seen as relevant, processing it.
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://alivetangovictoria.ca/studio/ was last seen as relevant, processing it.
2025-06-18 12:48:12 [root] INFO: write_url_to_db(): appended URL 'https://alivetangovictoria.ca/studio/'
2025-06-18 12:48:12 [root] INFO: def parse(): Crawling next URL: https://alivetangovictoria.ca/studio/
2025-06-18 12:48:12 [scrapy.extensions.logstats] INFO: Crawled 10 pages (at 2 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://goo.gl/maps/v4AtaEMpTT2cQkZ86 does not meet criteria for processing, skipping it.
2025-06-18 12:48:12 [root] INFO: def eventbrite_search(): Skipping URL https://goo.gl/maps/v4AtaEMpTT2cQkZ86 based on historical relevancy.
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://calientedance.com/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://calientedance.com/radio/ was last seen as relevant, processing it.
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://calientedance.com/radio/ was last seen as relevant, processing it.
2025-06-18 12:48:12 [root] INFO: write_url_to_db(): appended URL 'https://calientedance.com/radio/'
2025-06-18 12:48:12 [root] INFO: def parse(): Crawling next URL: https://calientedance.com/radio/
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://calientedance.com/radio/ was last seen as relevant, processing it.
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://calientedance.com/news/ does not meet criteria for processing, skipping it.
2025-06-18 12:48:12 [root] INFO: def eventbrite_search(): Skipping URL https://calientedance.com/news/ based on historical relevancy.
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://calientedance.com/events/ was last seen as relevant, processing it.
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://calientedance.com/events/ was last seen as relevant, processing it.
2025-06-18 12:48:12 [root] INFO: write_url_to_db(): appended URL 'https://calientedance.com/events/'
2025-06-18 12:48:12 [root] INFO: def parse(): Crawling next URL: https://calientedance.com/events/
2025-06-18 12:48:12 [root] INFO: should_process_url: URL http://alivetangovictoria.ca/calendar was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:48:12 [root] INFO: should_process_url: URL http://alivetangovictoria.ca/calendar was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:48:12 [root] INFO: write_url_to_db(): appended URL 'http://alivetangovictoria.ca/calendar'
2025-06-18 12:48:12 [root] INFO: def parse(): Crawling next URL: http://alivetangovictoria.ca/calendar
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://calientedance.com/news/ does not meet criteria for processing, skipping it.
2025-06-18 12:48:12 [root] INFO: def eventbrite_search(): Skipping URL https://calientedance.com/news/ based on historical relevancy.
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://calientedance.com/events/ was last seen as relevant, processing it.
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://calientedance.com/media/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://calientedance.com/media/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:48:12 [root] INFO: write_url_to_db(): appended URL 'https://calientedance.com/media/'
2025-06-18 12:48:12 [root] INFO: def parse(): Crawling next URL: https://calientedance.com/media/
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://calientedance.com/media/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://calientedance.com/about-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://calientedance.com/about-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:48:12 [root] INFO: write_url_to_db(): appended URL 'https://calientedance.com/about-us/'
2025-06-18 12:48:12 [root] INFO: def parse(): Crawling next URL: https://calientedance.com/about-us/
2025-06-18 12:48:12 [root] INFO: should_process_url: URL http://alivetangovictoria.ca/#community was last seen as relevant, processing it.
2025-06-18 12:48:12 [root] INFO: should_process_url: URL http://alivetangovictoria.ca/#community was last seen as relevant, processing it.
2025-06-18 12:48:12 [root] INFO: write_url_to_db(): appended URL 'http://alivetangovictoria.ca/#community'
2025-06-18 12:48:12 [root] INFO: def parse(): Crawling next URL: http://alivetangovictoria.ca/#community
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://calientedance.com/about-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://calientedance.com/teams/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://calientedance.com/teams/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:48:12 [root] INFO: write_url_to_db(): appended URL 'https://calientedance.com/teams/'
2025-06-18 12:48:12 [root] INFO: def parse(): Crawling next URL: https://calientedance.com/teams/
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://calientedance.com/teams/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://calientedance.com/ was last seen as not relevant but hit_ratio (0.67) > 0.1 or crawl_try (5) ≤ 3, processing it.
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://calientedance.com/ was last seen as not relevant but hit_ratio (0.67) > 0.1 or crawl_try (5) ≤ 3, processing it.
2025-06-18 12:48:12 [root] INFO: write_url_to_db(): appended URL 'https://calientedance.com/'
2025-06-18 12:48:12 [root] INFO: def parse(): Crawling next URL: https://calientedance.com/
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://alivetangovictoria.ca/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://alivetangovictoria.ca/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:48:12 [root] INFO: write_url_to_db(): appended URL 'https://alivetangovictoria.ca/'
2025-06-18 12:48:12 [root] INFO: def parse(): Crawling next URL: https://alivetangovictoria.ca/
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://calientedance.com/ was last seen as not relevant but hit_ratio (0.67) > 0.1 or crawl_try (5) ≤ 3, processing it.
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://calientedance.com/event/roadtrip-to-kelowna/ has never been seen before, processing it.
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://calientedance.com/event/roadtrip-to-kelowna/ has never been seen before, processing it.
2025-06-18 12:48:12 [root] INFO: write_url_to_db(): appended URL 'https://calientedance.com/event/roadtrip-to-kelowna/'
2025-06-18 12:48:12 [root] INFO: def parse(): Crawling next URL: https://calientedance.com/event/roadtrip-to-kelowna/
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://alivetangovictoria.ca/calendar/ was last seen as relevant, processing it.
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://alivetangovictoria.ca/calendar/ was last seen as relevant, processing it.
2025-06-18 12:48:12 [root] INFO: write_url_to_db(): appended URL 'https://alivetangovictoria.ca/calendar/'
2025-06-18 12:48:12 [root] INFO: def parse(): Crawling next URL: https://alivetangovictoria.ca/calendar/
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://alivetangovictoria.ca/classes-and-workshops/ was last seen as relevant, processing it.
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://alivetangovictoria.ca/classes-and-workshops/ was last seen as relevant, processing it.
2025-06-18 12:48:12 [root] INFO: write_url_to_db(): appended URL 'https://alivetangovictoria.ca/classes-and-workshops/'
2025-06-18 12:48:12 [root] INFO: def parse(): Crawling next URL: https://alivetangovictoria.ca/classes-and-workshops/
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://alivetangovictoria.ca/the-team/ was last seen as relevant, processing it.
2025-06-18 12:48:12 [root] INFO: should_process_url: URL https://alivetangovictoria.ca/the-team/ was last seen as relevant, processing it.
2025-06-18 12:48:12 [root] INFO: write_url_to_db(): appended URL 'https://alivetangovictoria.ca/the-team/'
2025-06-18 12:48:12 [root] INFO: def parse(): Crawling next URL: https://alivetangovictoria.ca/the-team/
2025-06-18 12:48:12 [root] INFO: def parse(): Found keywords for URL https://www.facebook.com/groups/cubansalsaclub/: ['bachata', 'dance', 'salsa', 'wcs']
2025-06-18 12:48:12 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.facebook.com/groups/cubansalsaclub/
2025-06-18 12:48:12 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 12:48:12 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 12:48:12 [root] INFO: query_llm(): Querying Mistral
2025-06-18 12:48:15 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 12:48:15 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 595603 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 12:48:15 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 12:48:17 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 12:48:17 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 447758 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 12:48:17 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 12:48:17 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://www.facebook.com/groups/cubansalsaclub/
2025-06-18 12:48:17 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/cubansalsaclub/'
2025-06-18 12:48:17 [root] INFO: def parse(): URL https://www.facebook.com/groups/cubansalsaclub/ marked as irrelevant (LLM negative).
2025-06-18 12:48:17 [root] INFO: def parse(): Found 0 links on https://www.facebook.com/groups/cubansalsaclub/
2025-06-18 12:48:17 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/cubansalsaclub/'
2025-06-18 12:48:17 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/groups/cubansalsaclub/
2025-06-18 12:48:17 [root] INFO: write_url_to_db(): appended URL 'https://www.danceplace.com/places/in/Argentine+Tango/Canada/Victoria_+BC'
2025-06-18 12:48:17 [root] INFO: def parse(): URL https://www.danceplace.com/places/in/Argentine+Tango/Canada/Victoria_+BC marked as irrelevant (no keywords).
2025-06-18 12:48:17 [root] INFO: def parse(): Found 0 links on https://www.danceplace.com/places/in/Argentine+Tango/Canada/Victoria_+BC
2025-06-18 12:48:17 [root] INFO: should_process_url: URL https://www.danceplace.com/places/in/Argentine+Tango/Canada/Victoria_+BC was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:48:17 [root] INFO: should_process_url: URL https://www.danceplace.com/places/in/Argentine+Tango/Canada/Victoria_+BC was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:48:17 [root] INFO: write_url_to_db(): appended URL 'https://www.danceplace.com/places/in/Argentine+Tango/Canada/Victoria_+BC'
2025-06-18 12:48:17 [root] INFO: def parse(): Crawling next URL: https://www.danceplace.com/places/in/Argentine+Tango/Canada/Victoria_+BC
2025-06-18 12:48:17 [root] INFO: should_process_url: URL https://alivetangovictoria.ca/alive-tango-practica/ was last seen as relevant, processing it.
2025-06-18 12:48:17 [root] INFO: should_process_url: URL https://alivetangovictoria.ca/alive-tango-practica/ was last seen as relevant, processing it.
2025-06-18 12:48:17 [root] INFO: write_url_to_db(): appended URL 'https://alivetangovictoria.ca/alive-tango-practica/'
2025-06-18 12:48:17 [root] INFO: def parse(): Crawling next URL: https://alivetangovictoria.ca/alive-tango-practica/
2025-06-18 12:48:17 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <403 https://www.tripadvisor.com/Attractions-g154945-Activities-c20-t109-Victoria_Victoria_Capital_Regional_District_Vancouver_Island_British_Columbia.html>: HTTP status code is not handled or not allowed
2025-06-18 12:48:17 [root] INFO: def parse(): Found keywords for URL https://www.facebook.com/groups/264289526206205/: ['dance']
2025-06-18 12:48:17 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.facebook.com/groups/264289526206205/
2025-06-18 12:48:17 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 12:48:17 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 12:48:17 [root] INFO: query_llm(): Querying Mistral
2025-06-18 12:48:24 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:48:24 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 12:48:24 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 12:48:24 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/264289526206205/'
2025-06-18 12:48:24 [root] INFO: def parse(): URL https://www.facebook.com/groups/264289526206205/ marked as irrelevant (LLM negative).
2025-06-18 12:48:24 [root] INFO: def parse(): Found 10 links on https://www.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F264289526206205%2F
2025-06-18 12:48:24 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/recover/initiate/?ars=facebook_login&cancel_lara_pswd=0&next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F264289526206205%2F'
2025-06-18 12:48:24 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/recover/initiate/?ars=facebook_login&cancel_lara_pswd=0&next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F264289526206205%2F
2025-06-18 12:48:24 [root] INFO: write_url_to_db(): appended URL 'https://de-de.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F264289526206205%2F'
2025-06-18 12:48:24 [root] INFO: def parse(): Recorded unwanted URL: https://de-de.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F264289526206205%2F
2025-06-18 12:48:24 [root] INFO: write_url_to_db(): appended URL 'https://it-it.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F264289526206205%2F'
2025-06-18 12:48:24 [root] INFO: def parse(): Recorded unwanted URL: https://it-it.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F264289526206205%2F
2025-06-18 12:48:24 [root] INFO: write_url_to_db(): appended URL 'https://fr-ca.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F264289526206205%2F'
2025-06-18 12:48:24 [root] INFO: def parse(): Recorded unwanted URL: https://fr-ca.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F264289526206205%2F
2025-06-18 12:48:24 [root] INFO: write_url_to_db(): appended URL 'https://ja-jp.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F264289526206205%2F'
2025-06-18 12:48:24 [root] INFO: def parse(): Recorded unwanted URL: https://ja-jp.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F264289526206205%2F
2025-06-18 12:48:24 [root] INFO: write_url_to_db(): appended URL 'https://zh-cn.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F264289526206205%2F'
2025-06-18 12:48:24 [root] INFO: def parse(): Recorded unwanted URL: https://zh-cn.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F264289526206205%2F
2025-06-18 12:48:24 [root] INFO: write_url_to_db(): appended URL 'https://es-la.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F264289526206205%2F'
2025-06-18 12:48:24 [root] INFO: def parse(): Recorded unwanted URL: https://es-la.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F264289526206205%2F
2025-06-18 12:48:24 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/264289526206205/'
2025-06-18 12:48:24 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/groups/264289526206205/
2025-06-18 12:48:24 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F264289526206205%2F'
2025-06-18 12:48:24 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F264289526206205%2F
2025-06-18 12:48:24 [root] INFO: write_url_to_db(): appended URL 'https://pt-br.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F264289526206205%2F'
2025-06-18 12:48:24 [root] INFO: def parse(): Recorded unwanted URL: https://pt-br.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F264289526206205%2F
2025-06-18 12:48:24 [root] INFO: write_url_to_db(): appended URL 'https://ko-kr.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F264289526206205%2F'
2025-06-18 12:48:24 [root] INFO: def parse(): Recorded unwanted URL: https://ko-kr.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F264289526206205%2F
2025-06-18 12:48:24 [scrapy.extensions.logstats] INFO: Crawled 25 pages (at 15 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 12:48:24 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <406 https://vecds.bc.ca/join-us/>: HTTP status code is not handled or not allowed
2025-06-18 12:48:24 [root] INFO: write_url_to_db(): appended URL 'https://allevents.in/victoria/swing-session-balboa-with-yoshi-and-etsuko/200028272050752'
2025-06-18 12:48:24 [root] INFO: def parse(): URL https://allevents.in/victoria/swing-session-balboa-with-yoshi-and-etsuko/200028272050752 marked as irrelevant (no keywords).
2025-06-18 12:48:24 [root] INFO: def parse(): Found 0 links on https://allevents.in/victoria/swing-session-balboa-with-yoshi-and-etsuko/200028272050752
2025-06-18 12:48:24 [root] INFO: should_process_url: URL https://allevents.in/victoria/swing-session-balboa-with-yoshi-and-etsuko/200028272050752 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:48:24 [root] INFO: should_process_url: URL https://allevents.in/victoria/swing-session-balboa-with-yoshi-and-etsuko/200028272050752 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:48:24 [root] INFO: write_url_to_db(): appended URL 'https://allevents.in/victoria/swing-session-balboa-with-yoshi-and-etsuko/200028272050752'
2025-06-18 12:48:24 [root] INFO: def parse(): Crawling next URL: https://allevents.in/victoria/swing-session-balboa-with-yoshi-and-etsuko/200028272050752
2025-06-18 12:48:24 [root] INFO: def parse(): Found keywords for URL https://www.facebook.com/groups/TangoVanIsle/: ['dance', 'tango']
2025-06-18 12:48:24 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.facebook.com/groups/TangoVanIsle/
2025-06-18 12:48:24 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 12:48:24 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 12:48:24 [root] INFO: query_llm(): Querying Mistral
2025-06-18 12:48:55 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:48:55 [root] INFO: query_llm(): Mistral response received: ```json
[
  {
    "source": "Facebook Tango Van Isle Group",
    "dance_style": "tango",
    "url": "",
    "event_type": "rehearsal",
    "event_name": "Tuesday Night Rehearsal",
    "day_of_week": "Tuesday",
    "start_date": "2025-06-19",
    "end_date": "2025-06-19",
    "start_time": "19:30",
    "end_time": "20:30",
    "price": "$5",
    "location": "St. John’s Hall, 839 Humbolt St, Victoria, BC",
    "description": "Tuesday Night Rehearsal- 7:30-8:30pm. $5. St. John’s Hall, 839 Humbolt St, Victoria, BC"
  },
  {
    "source": "Facebook Tango Van Isle Group",
    "dance_style": "tango",
    "url": "",
    "event_type": "social dance",
    "event_name": "Thursday Practica",
    "day_of_week": "Thursday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-20",
    "start_time": "19:30",
    "end_time": "21:00",
    "price": "",
    "location": "St. John’s Hall, 839 Humbolt St, Victoria, BC",
    "description": "Thursday Practica- 7:30-9:00pm. St. John’s Hall, 839 Humbolt St, Victoria, BC"
  },
  {
    "source": "Facebook Tango Van Isle Group",
    "dance_style": "tango",
    "url": "",
    "event_type": "workshop",
    "event_name": "Sunday Workshop",
    "day_of_week": "Sunday",
    "start_date": "2025-06-23",
    "end_date": "2025-06-23",
    "start_time": "14:00",
    "end_time": "16:00",
    "price": "$25",
    "location": "St. John’s Hall, 839 Humbolt St, Victoria, BC",
    "description": "Sunday Workshop- 2-4pm. $25. St. John’s Hall, 839 Humbolt St, Victoria, BC"
  }
]
```
2025-06-18 12:48:55 [root] INFO: def extract_and_parse_json(): for url https://www.facebook.com/groups/TangoVanIsle/, 
Cleaned JSON ready for parsing:
[
  {
    "source": "Facebook Tango Van Isle Group",
    "dance_style": "tango",
    "url": "",
    "event_type": "rehearsal",
    "event_name": "Tuesday Night Rehearsal",
    "day_of_week": "Tuesday",
    "start_date": "2025-06-19",
    "end_date": "2025-06-19",
    "start_time": "19:30",
    "end_time": "20:30",
    "price": "$5",
    "location": "St. John’s Hall, 839 Humbolt St, Victoria, BC",
    "description": "Tuesday Night Rehearsal- 7:30-8:30pm. $5. St. John’s Hall, 839 Humbolt St, Victoria, BC"
  },
  {
    "source": "Facebook Tango Van Isle Group",
    "dance_style": "tango",
    "url": "",
    "event_type": "social dance",
    "event_name": "Thursday Practica",
    "day_of_week": "Thursday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-20",
    "start_time": "19:30",
    "end_time": "21:00",
    "price": "",
    "location": "St. John’s Hall, 839 Humbolt St, Victoria, BC",
    "description": "Thursday Practica- 7:30-9:00pm. St. John’s Hall, 839 Humbolt St, Victoria, BC"
  },
  {
    "source": "Facebook Tango Van Isle Group",
    "dance_style": "tango",
    "url": "",
    "event_type": "workshop",
    "event_name": "Sunday Workshop",
    "day_of_week": "Sunday",
    "start_date": "2025-06-23",
    "end_date": "2025-06-23",
    "start_time": "14:00",
    "end_time": "16:00",
    "price": "$25",
    "location": "St. John’s Hall, 839 Humbolt St, Victoria, BC",
    "description": "Sunday Workshop- 2-4pm. $25. St. John’s Hall, 839 Humbolt St, Victoria, BC"
  }
]
2025-06-18 12:48:55 [root] INFO: def clean_up_address(): Starting with events_df shape: (3, 14)
2025-06-18 12:48:55 [root] INFO: def clean_up_address(): Processing location 'St. John’s Hall, 839 Humbolt St, Victoria, BC' (event_id: None)
2025-06-18 12:48:55 [root] INFO: def clean_up_address(): Processing location 'St. John’s Hall, 839 Humbolt St, Victoria, BC' (event_id: None)
2025-06-18 12:48:55 [root] INFO: def clean_up_address(): Processing location 'St. John’s Hall, 839 Humbolt St, Victoria, BC' (event_id: None)
2025-06-18 12:48:55 [root] INFO: write_events_to_db: Number of events to write: 3
2025-06-18 12:48:55 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/TangoVanIsle/'
2025-06-18 12:48:55 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:48:55 [root] INFO: def process_llm_response: URL https://www.facebook.com/groups/TangoVanIsle/ marked as relevant with events written to the database.
2025-06-18 12:48:55 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/TangoVanIsle/'
2025-06-18 12:48:55 [root] INFO: def parse(): URL https://www.facebook.com/groups/TangoVanIsle/ marked as relevant (LLM positive).
2025-06-18 12:48:55 [root] INFO: def parse(): Found 10 links on https://www.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2FTangoVanIsle%2F
2025-06-18 12:48:55 [root] INFO: write_url_to_db(): appended URL 'https://fr-ca.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2FTangoVanIsle%2F'
2025-06-18 12:48:55 [root] INFO: def parse(): Recorded unwanted URL: https://fr-ca.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2FTangoVanIsle%2F
2025-06-18 12:48:55 [root] INFO: write_url_to_db(): appended URL 'https://ko-kr.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2FTangoVanIsle%2F'
2025-06-18 12:48:55 [root] INFO: def parse(): Recorded unwanted URL: https://ko-kr.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2FTangoVanIsle%2F
2025-06-18 12:48:55 [root] INFO: write_url_to_db(): appended URL 'https://de-de.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2FTangoVanIsle%2F'
2025-06-18 12:48:55 [root] INFO: def parse(): Recorded unwanted URL: https://de-de.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2FTangoVanIsle%2F
2025-06-18 12:48:55 [root] INFO: write_url_to_db(): appended URL 'https://ja-jp.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2FTangoVanIsle%2F'
2025-06-18 12:48:55 [root] INFO: def parse(): Recorded unwanted URL: https://ja-jp.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2FTangoVanIsle%2F
2025-06-18 12:48:55 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/recover/initiate/?ars=facebook_login&cancel_lara_pswd=0&next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2FTangoVanIsle%2F'
2025-06-18 12:48:55 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/recover/initiate/?ars=facebook_login&cancel_lara_pswd=0&next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2FTangoVanIsle%2F
2025-06-18 12:48:55 [root] INFO: write_url_to_db(): appended URL 'https://pt-br.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2FTangoVanIsle%2F'
2025-06-18 12:48:55 [root] INFO: def parse(): Recorded unwanted URL: https://pt-br.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2FTangoVanIsle%2F
2025-06-18 12:48:55 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/TangoVanIsle/'
2025-06-18 12:48:55 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/groups/TangoVanIsle/
2025-06-18 12:48:55 [root] INFO: write_url_to_db(): appended URL 'https://it-it.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2FTangoVanIsle%2F'
2025-06-18 12:48:55 [root] INFO: def parse(): Recorded unwanted URL: https://it-it.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2FTangoVanIsle%2F
2025-06-18 12:48:55 [root] INFO: write_url_to_db(): appended URL 'https://zh-cn.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2FTangoVanIsle%2F'
2025-06-18 12:48:55 [root] INFO: def parse(): Recorded unwanted URL: https://zh-cn.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2FTangoVanIsle%2F
2025-06-18 12:48:55 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2FTangoVanIsle%2F'
2025-06-18 12:48:55 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2FTangoVanIsle%2F
2025-06-18 12:48:55 [root] INFO: write_url_to_db(): appended URL 'https://es-la.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2FTangoVanIsle%2F'
2025-06-18 12:48:55 [root] INFO: def parse(): Recorded unwanted URL: https://es-la.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2FTangoVanIsle%2F
2025-06-18 12:48:55 [root] INFO: def parse(): Found keywords for URL https://www.facebook.com/groups/105613516148561/: ['dance']
2025-06-18 12:48:55 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.facebook.com/groups/105613516148561/
2025-06-18 12:48:55 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 12:48:55 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 12:48:55 [root] INFO: query_llm(): Querying Mistral
2025-06-18 12:48:55 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-06-18 12:48:55 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 429
{"object":"rejection","message":"Service tier capacity exceeded for this model.","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 12:48:55 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 12:48:58 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:48:58 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 12:48:58 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 12:48:58 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/105613516148561/'
2025-06-18 12:48:58 [root] INFO: def parse(): URL https://www.facebook.com/groups/105613516148561/ marked as irrelevant (LLM negative).
2025-06-18 12:48:58 [root] INFO: def parse(): Found 10 links on https://www.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F105613516148561%2F
2025-06-18 12:48:58 [root] INFO: write_url_to_db(): appended URL 'https://ko-kr.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F105613516148561%2F'
2025-06-18 12:48:58 [root] INFO: def parse(): Recorded unwanted URL: https://ko-kr.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F105613516148561%2F
2025-06-18 12:48:58 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/105613516148561/'
2025-06-18 12:48:58 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/groups/105613516148561/
2025-06-18 12:48:58 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/recover/initiate/?ars=facebook_login&cancel_lara_pswd=0&next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F105613516148561%2F'
2025-06-18 12:48:58 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/recover/initiate/?ars=facebook_login&cancel_lara_pswd=0&next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F105613516148561%2F
2025-06-18 12:48:58 [root] INFO: write_url_to_db(): appended URL 'https://zh-cn.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F105613516148561%2F'
2025-06-18 12:48:58 [root] INFO: def parse(): Recorded unwanted URL: https://zh-cn.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F105613516148561%2F
2025-06-18 12:48:58 [root] INFO: write_url_to_db(): appended URL 'https://es-la.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F105613516148561%2F'
2025-06-18 12:48:58 [root] INFO: def parse(): Recorded unwanted URL: https://es-la.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F105613516148561%2F
2025-06-18 12:48:58 [root] INFO: write_url_to_db(): appended URL 'https://de-de.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F105613516148561%2F'
2025-06-18 12:48:58 [root] INFO: def parse(): Recorded unwanted URL: https://de-de.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F105613516148561%2F
2025-06-18 12:48:58 [root] INFO: write_url_to_db(): appended URL 'https://it-it.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F105613516148561%2F'
2025-06-18 12:48:58 [root] INFO: def parse(): Recorded unwanted URL: https://it-it.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F105613516148561%2F
2025-06-18 12:48:58 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F105613516148561%2F'
2025-06-18 12:48:58 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F105613516148561%2F
2025-06-18 12:48:58 [root] INFO: write_url_to_db(): appended URL 'https://fr-ca.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F105613516148561%2F'
2025-06-18 12:48:58 [root] INFO: def parse(): Recorded unwanted URL: https://fr-ca.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F105613516148561%2F
2025-06-18 12:48:58 [root] INFO: write_url_to_db(): appended URL 'https://ja-jp.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F105613516148561%2F'
2025-06-18 12:48:58 [root] INFO: def parse(): Recorded unwanted URL: https://ja-jp.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F105613516148561%2F
2025-06-18 12:48:58 [root] INFO: write_url_to_db(): appended URL 'https://pt-br.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F105613516148561%2F'
2025-06-18 12:48:58 [root] INFO: def parse(): Recorded unwanted URL: https://pt-br.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F105613516148561%2F
2025-06-18 12:48:58 [root] INFO: def parse(): Found keywords for URL https://www.facebook.com/groups/1859019724204253/: ['dance']
2025-06-18 12:48:58 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.facebook.com/groups/1859019724204253/
2025-06-18 12:48:58 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 12:48:58 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 12:48:58 [root] INFO: query_llm(): Querying Mistral
2025-06-18 12:49:16 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:49:16 [root] INFO: query_llm(): Mistral response received: [
  {
    "source": "https://www.facebook.com/groups/1859019724204253/",
    "dance_style": "",
    "url": "",
    "event_type": "",
    "event_name": "",
    "day_of_week": "",
    "start_date": "2025-06-18",
    "end_date": "2025-06-18",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": ""
  }
]
2025-06-18 12:49:16 [root] INFO: def extract_and_parse_json(): for url https://www.facebook.com/groups/1859019724204253/, 
Cleaned JSON ready for parsing:
[
  {
    "source": "https://www.facebook.com/groups/1859019724204253/",
    "dance_style": "",
    "url": "",
    "event_type": "",
    "event_name": "",
    "day_of_week": "",
    "start_date": "2025-06-18",
    "end_date": "2025-06-18",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": ""
  }
]
2025-06-18 12:49:16 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:49:16 [root] INFO: write_events_to_db: Number of events to write: 1
2025-06-18 12:49:16 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/1859019724204253/'
2025-06-18 12:49:16 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:49:16 [root] INFO: def process_llm_response: URL https://www.facebook.com/groups/1859019724204253/ marked as relevant with events written to the database.
2025-06-18 12:49:16 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/1859019724204253/'
2025-06-18 12:49:16 [root] INFO: def parse(): URL https://www.facebook.com/groups/1859019724204253/ marked as relevant (LLM positive).
2025-06-18 12:49:16 [root] INFO: def parse(): Found 10 links on https://www.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F1859019724204253%2F
2025-06-18 12:49:16 [root] INFO: write_url_to_db(): appended URL 'https://fr-ca.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F1859019724204253%2F'
2025-06-18 12:49:16 [root] INFO: def parse(): Recorded unwanted URL: https://fr-ca.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F1859019724204253%2F
2025-06-18 12:49:16 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/1859019724204253/'
2025-06-18 12:49:16 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/groups/1859019724204253/
2025-06-18 12:49:16 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F1859019724204253%2F'
2025-06-18 12:49:16 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F1859019724204253%2F
2025-06-18 12:49:16 [root] INFO: write_url_to_db(): appended URL 'https://de-de.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F1859019724204253%2F'
2025-06-18 12:49:16 [root] INFO: def parse(): Recorded unwanted URL: https://de-de.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F1859019724204253%2F
2025-06-18 12:49:16 [root] INFO: write_url_to_db(): appended URL 'https://es-la.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F1859019724204253%2F'
2025-06-18 12:49:16 [root] INFO: def parse(): Recorded unwanted URL: https://es-la.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F1859019724204253%2F
2025-06-18 12:49:16 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/recover/initiate/?ars=facebook_login&cancel_lara_pswd=0&next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F1859019724204253%2F'
2025-06-18 12:49:16 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/recover/initiate/?ars=facebook_login&cancel_lara_pswd=0&next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F1859019724204253%2F
2025-06-18 12:49:16 [root] INFO: write_url_to_db(): appended URL 'https://ja-jp.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F1859019724204253%2F'
2025-06-18 12:49:16 [root] INFO: def parse(): Recorded unwanted URL: https://ja-jp.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F1859019724204253%2F
2025-06-18 12:49:16 [root] INFO: write_url_to_db(): appended URL 'https://it-it.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F1859019724204253%2F'
2025-06-18 12:49:16 [root] INFO: def parse(): Recorded unwanted URL: https://it-it.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F1859019724204253%2F
2025-06-18 12:49:16 [root] INFO: write_url_to_db(): appended URL 'https://pt-br.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F1859019724204253%2F'
2025-06-18 12:49:16 [root] INFO: def parse(): Recorded unwanted URL: https://pt-br.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F1859019724204253%2F
2025-06-18 12:49:16 [root] INFO: write_url_to_db(): appended URL 'https://zh-cn.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F1859019724204253%2F'
2025-06-18 12:49:16 [root] INFO: def parse(): Recorded unwanted URL: https://zh-cn.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F1859019724204253%2F
2025-06-18 12:49:16 [root] INFO: write_url_to_db(): appended URL 'https://ko-kr.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F1859019724204253%2F'
2025-06-18 12:49:16 [root] INFO: def parse(): Recorded unwanted URL: https://ko-kr.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F1859019724204253%2F
2025-06-18 12:49:16 [root] INFO: def parse(): Found keywords for URL https://dancevictoria.com/: ['dance']
2025-06-18 12:49:16 [root] INFO: def generate_prompt(): Generating prompt for URL: https://dancevictoria.com/
2025-06-18 12:49:16 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 12:49:16 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 12:49:16 [root] INFO: query_llm(): Querying Mistral
2025-06-18 12:49:56 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:49:56 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "https://dancevictoria.com/performances/at-the-royal-series-25-26/#special",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Ukrainian Shumka Dancers’ Nutcracker",
        "day_of_week": "Thursday",
        "start_date": "2025-12-04",
        "end_date": "2025-12-04",
        "start_time": "19:30",
        "end_time": "22:30",
        "price": "$29-$99",
        "location": "Royal Theatre, 805 Broughton St, Victoria, BC",
        "description": "Shumka’s Nutcracker is a new holiday tradition showcasing the many dance styles of the Canadian prairies, including Ukrainian, indigenous, folk, ballet, and character dance."
    },
    {
        "source": "https://dancevictoria.com/performances/at-the-royal-series-25-26/#special",
        "dance_style": "ballet",
        "url": "",
        "event_type": "live music",
        "event_name": "Belle Spirale Dance Projects",
        "day_of_week": "Friday",
        "start_date": "2026-04-24",
        "end_date": "2026-04-24",
        "start_time": "19:30",
        "end_time": "22:30",
        "price": "$29-$99",
        "location": "Royal Theatre, 805 Broughton St, Victoria, BC",
        "description": "Belle Spirale Dance Projects is a ballet performance."
    }
]
2025-06-18 12:49:56 [root] INFO: def extract_and_parse_json(): for url https://dancevictoria.com/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "https://dancevictoria.com/performances/at-the-royal-series-25-26/#special",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Ukrainian Shumka Dancers’ Nutcracker",
        "day_of_week": "Thursday",
        "start_date": "2025-12-04",
        "end_date": "2025-12-04",
        "start_time": "19:30",
        "end_time": "22:30",
        "price": "$29-$99",
        "location": "Royal Theatre, 805 Broughton St, Victoria, BC",
        "description": "Shumka’s Nutcracker is a new holiday tradition showcasing the many dance styles of the Canadian prairies, including Ukrainian, indigenous, folk, ballet, and character dance."
    },
    {
        "source": "https://dancevictoria.com/performances/at-the-royal-series-25-26/#special",
        "dance_style": "ballet",
        "url": "",
        "event_type": "live music",
        "event_name": "Belle Spirale Dance Projects",
        "day_of_week": "Friday",
        "start_date": "2026-04-24",
        "end_date": "2026-04-24",
        "start_time": "19:30",
        "end_time": "22:30",
        "price": "$29-$99",
        "location": "Royal Theatre, 805 Broughton St, Victoria, BC",
        "description": "Belle Spirale Dance Projects is a ballet performance."
    }
]
2025-06-18 12:49:56 [root] INFO: def clean_up_address(): Starting with events_df shape: (2, 14)
2025-06-18 12:49:56 [root] INFO: def clean_up_address(): Processing location 'Royal Theatre, 805 Broughton St, Victoria, BC' (event_id: None)
2025-06-18 12:49:56 [root] INFO: def clean_up_address(): Updated event None with address_id 3446 using DB match
2025-06-18 12:49:56 [root] INFO: def clean_up_address(): Processing location 'Royal Theatre, 805 Broughton St, Victoria, BC' (event_id: None)
2025-06-18 12:49:56 [root] INFO: def clean_up_address(): Updated event None with address_id 3446 using DB match
2025-06-18 12:49:56 [root] INFO: write_events_to_db: Number of events to write: 2
2025-06-18 12:49:56 [root] INFO: write_url_to_db(): appended URL 'https://dancevictoria.com/'
2025-06-18 12:49:56 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:49:56 [root] INFO: def process_llm_response: URL https://dancevictoria.com/ marked as relevant with events written to the database.
2025-06-18 12:49:56 [root] INFO: write_url_to_db(): appended URL 'https://dancevictoria.com/'
2025-06-18 12:49:56 [root] INFO: def parse(): URL https://dancevictoria.com/ marked as relevant (LLM positive).
2025-06-18 12:49:56 [root] INFO: def parse(): Found 10 links on https://dancevictoria.com/
2025-06-18 12:49:56 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-TKPSD4XK, URL: https://dancevictoria.com/, source: Dance Victoria brings the World's Best Dance to Victoria Canada, keywords: dance
2025-06-18 12:49:56 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 12:49:56 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-TKPSD4XK
2025-06-18 12:49:56 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-TKPSD4XK'
2025-06-18 12:49:56 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/DanceVictoria/'
2025-06-18 12:49:56 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/DanceVictoria/
2025-06-18 12:49:56 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/dance_victoria/'
2025-06-18 12:49:56 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/dance_victoria/
2025-06-18 12:49:56 [root] INFO: should_process_url: URL https://dancevictoria.com/learn/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:49:56 [root] INFO: should_process_url: URL https://dancevictoria.com/learn/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:49:56 [root] INFO: write_url_to_db(): appended URL 'https://dancevictoria.com/learn/contact/'
2025-06-18 12:49:56 [root] INFO: def parse(): Crawling next URL: https://dancevictoria.com/learn/contact/
2025-06-18 12:49:56 [root] INFO: def parse(): Found keywords for URL https://dancevictoria.com/performances/: ['dance']
2025-06-18 12:49:56 [root] INFO: def generate_prompt(): Generating prompt for URL: https://dancevictoria.com/performances/
2025-06-18 12:49:56 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 12:49:56 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 12:49:56 [root] INFO: query_llm(): Querying Mistral
2025-06-18 12:50:47 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:50:47 [root] INFO: query_llm(): Mistral response received: [
  {
    "source": "Dance at the Royal",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "Dance at the Royal Series",
    "day_of_week": "",
    "start_date": "",
    "end_date": "",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Royal Theatre",
    "description": "Join us for our 2025/26 Dance at the Royal subscription season. Learn about subscriber options and benefits."
  },
  {
    "source": "Dance at the Royal",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Ukrainian Shumka Dancers’ Nutcracker",
    "day_of_week": "",
    "start_date": "2025-12-01",
    "end_date": "2025-12-01",
    "start_time": "19:00",
    "end_time": "21:00",
    "price": "",
    "location": "Royal Theatre",
    "description": "Join us for Ukrainian Shumka Dancers’ Nutcracker with Victoria Symphony at Royal Theatre."
  },
  {
    "source": "Dance at the Royal",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Belle Spirale Dance Projects in UNIVERSUS",
    "day_of_week": "",
    "start_date": "2026-01-01",
    "end_date": "2026-01-01",
    "start_time": "19:00",
    "end_time": "21:00",
    "price": "",
    "location": "McPherson Playhouse",
    "description": "At the McPherson Playhouse, in January, witness the powerful elegance of Belle Spirale Dance Projects in UNIVERSUS."
  }
]
2025-06-18 12:50:47 [root] INFO: def extract_and_parse_json(): for url https://dancevictoria.com/performances/, 
Cleaned JSON ready for parsing:
[
  {
    "source": "Dance at the Royal",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "Dance at the Royal Series",
    "day_of_week": "",
    "start_date": "",
    "end_date": "",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Royal Theatre",
    "description": "Join us for our 2025/26 Dance at the Royal subscription season. Learn about subscriber options and benefits."
  },
  {
    "source": "Dance at the Royal",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Ukrainian Shumka Dancers’ Nutcracker",
    "day_of_week": "",
    "start_date": "2025-12-01",
    "end_date": "2025-12-01",
    "start_time": "19:00",
    "end_time": "21:00",
    "price": "",
    "location": "Royal Theatre",
    "description": "Join us for Ukrainian Shumka Dancers’ Nutcracker with Victoria Symphony at Royal Theatre."
  },
  {
    "source": "Dance at the Royal",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Belle Spirale Dance Projects in UNIVERSUS",
    "day_of_week": "",
    "start_date": "2026-01-01",
    "end_date": "2026-01-01",
    "start_time": "19:00",
    "end_time": "21:00",
    "price": "",
    "location": "McPherson Playhouse",
    "description": "At the McPherson Playhouse, in January, witness the powerful elegance of Belle Spirale Dance Projects in UNIVERSUS."
  }
]
2025-06-18 12:50:47 [root] INFO: def clean_up_address(): Starting with events_df shape: (3, 14)
2025-06-18 12:50:47 [root] INFO: def clean_up_address(): Processing location 'Royal Theatre' (event_id: None)
2025-06-18 12:50:47 [root] INFO: def clean_up_address(): Processing location 'Royal Theatre' (event_id: None)
2025-06-18 12:50:47 [root] INFO: def clean_up_address(): Processing location 'McPherson Playhouse' (event_id: None)
2025-06-18 12:50:47 [root] INFO: write_events_to_db: Number of events to write: 3
2025-06-18 12:50:47 [root] INFO: write_url_to_db(): appended URL 'https://dancevictoria.com/performances/'
2025-06-18 12:50:47 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:50:47 [root] INFO: def process_llm_response: URL https://dancevictoria.com/performances/ marked as relevant with events written to the database.
2025-06-18 12:50:47 [root] INFO: write_url_to_db(): appended URL 'https://dancevictoria.com/performances/'
2025-06-18 12:50:47 [root] INFO: def parse(): URL https://dancevictoria.com/performances/ marked as relevant (LLM positive).
2025-06-18 12:50:47 [root] INFO: def parse(): Found 10 links on https://dancevictoria.com/performances/
2025-06-18 12:50:47 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-TKPSD4XK, URL: https://dancevictoria.com/performances/, source: Performances - Dance Victoria, keywords: dance
2025-06-18 12:50:47 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 12:50:47 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-TKPSD4XK
2025-06-18 12:50:47 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-TKPSD4XK'
2025-06-18 12:50:47 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/DanceVictoria/'
2025-06-18 12:50:47 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/DanceVictoria/
2025-06-18 12:50:47 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/dance_victoria/'
2025-06-18 12:50:47 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/dance_victoria/
2025-06-18 12:50:47 [root] INFO: should_process_url: URL https://dancevictoria.com/learn/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:50:47 [root] INFO: should_process_url: URL https://dancevictoria.com/performances/tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:50:47 [root] INFO: should_process_url: URL https://dancevictoria.com/performances/tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:50:47 [root] INFO: write_url_to_db(): appended URL 'https://dancevictoria.com/performances/tickets/'
2025-06-18 12:50:47 [root] INFO: def parse(): Crawling next URL: https://dancevictoria.com/performances/tickets/
2025-06-18 12:50:47 [scrapy.extensions.logstats] INFO: Crawled 28 pages (at 3 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 12:50:47 [root] INFO: should_process_url: URL https://dancevictoria.com/performances/tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:50:47 [root] INFO: should_process_url: URL https://dancevictoria.com/ was last seen as not relevant but hit_ratio (0.33) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:50:47 [root] INFO: should_process_url: URL https://dancevictoria.com/ was last seen as not relevant but hit_ratio (0.33) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:50:47 [root] INFO: write_url_to_db(): appended URL 'https://dancevictoria.com/'
2025-06-18 12:50:47 [root] INFO: def parse(): Crawling next URL: https://dancevictoria.com/
2025-06-18 12:50:47 [root] INFO: should_process_url: URL https://dancevictoria.com/performances/ was last seen as not relevant but hit_ratio (2.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:50:47 [root] INFO: should_process_url: URL https://dancevictoria.com/performances/ was last seen as not relevant but hit_ratio (2.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:50:47 [root] INFO: write_url_to_db(): appended URL 'https://dancevictoria.com/performances/'
2025-06-18 12:50:47 [root] INFO: def parse(): Crawling next URL: https://dancevictoria.com/performances/
2025-06-18 12:50:47 [root] INFO: should_process_url: URL https://vimeo.com/dancevictoria was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:50:47 [root] INFO: should_process_url: URL https://vimeo.com/dancevictoria was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:50:47 [root] INFO: write_url_to_db(): appended URL 'https://vimeo.com/dancevictoria'
2025-06-18 12:50:47 [root] INFO: def parse(): Crawling next URL: https://vimeo.com/dancevictoria
2025-06-18 12:50:47 [root] INFO: should_process_url: URL https://vimeo.com/dancevictoria was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:50:47 [root] INFO: should_process_url: URL https://dancevictoria.com/calendar/ was last seen as relevant, processing it.
2025-06-18 12:50:47 [root] INFO: should_process_url: URL https://dancevictoria.com/calendar/ was last seen as relevant, processing it.
2025-06-18 12:50:47 [root] INFO: write_url_to_db(): appended URL 'https://dancevictoria.com/calendar/'
2025-06-18 12:50:47 [root] INFO: def parse(): Crawling next URL: https://dancevictoria.com/calendar/
2025-06-18 12:50:47 [scrapy.core.downloader.handlers.http11] WARNING: Got data loss in https://www.facebook.com/RedHotSwing/. If you want to process broken responses set the setting DOWNLOAD_FAIL_ON_DATALOSS = False -- This message won't be shown in further requests
2025-06-18 12:50:47 [root] INFO: should_process_url: URL https://dancevictoria.com/calendar/ was last seen as relevant, processing it.
2025-06-18 12:50:47 [root] INFO: should_process_url: URL https://dancevictoria.com/learn/news/ was last seen as relevant, processing it.
2025-06-18 12:50:47 [root] INFO: should_process_url: URL https://dancevictoria.com/learn/news/ was last seen as relevant, processing it.
2025-06-18 12:50:47 [root] INFO: write_url_to_db(): appended URL 'https://dancevictoria.com/learn/news/'
2025-06-18 12:50:47 [root] INFO: def parse(): Crawling next URL: https://dancevictoria.com/learn/news/
2025-06-18 12:50:47 [root] INFO: should_process_url: URL https://dancevictoria.com/learn/news/ was last seen as relevant, processing it.
2025-06-18 12:50:47 [root] INFO: should_process_url: URL https://dancevictoria.com/ was last seen as not relevant but hit_ratio (0.33) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:50:47 [root] INFO: should_process_url: URL https://dancevictoria.com/support/donate/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:50:47 [root] INFO: should_process_url: URL https://dancevictoria.com/support/donate/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:50:47 [root] INFO: write_url_to_db(): appended URL 'https://dancevictoria.com/support/donate/'
2025-06-18 12:50:47 [root] INFO: def parse(): Crawling next URL: https://dancevictoria.com/support/donate/
2025-06-18 12:50:47 [root] INFO: should_process_url: URL https://dancevictoria.com/support/donate/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:50:47 [root] INFO: should_process_url: URL https://dancevictoria.com/season-trailer/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:50:47 [root] INFO: should_process_url: URL https://dancevictoria.com/season-trailer/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:50:47 [root] INFO: write_url_to_db(): appended URL 'https://dancevictoria.com/season-trailer/'
2025-06-18 12:50:47 [root] INFO: def parse(): Crawling next URL: https://dancevictoria.com/season-trailer/
2025-06-18 12:50:47 [root] INFO: should_process_url: URL https://dancevictoria.com/season-trailer/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:50:47 [root] INFO: def parse(): Found keywords for URL https://lambertvillecountrydancers.org/whatsNew.php: ['dance', 'tango', 'waltz', 'zouk']
2025-06-18 12:50:47 [root] INFO: def generate_prompt(): Generating prompt for URL: https://lambertvillecountrydancers.org/whatsNew.php
2025-06-18 12:50:47 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 12:50:47 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 12:50:47 [root] INFO: query_llm(): Querying Mistral
2025-06-18 12:50:48 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 12:50:48 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 158597 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 12:50:48 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 12:51:08 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:51:08 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 12:51:08 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 12:51:08 [root] INFO: write_url_to_db(): appended URL 'https://lambertvillecountrydancers.org/whatsNew.php'
2025-06-18 12:51:08 [root] INFO: def parse(): URL https://lambertvillecountrydancers.org/whatsNew.php marked as irrelevant (LLM negative).
2025-06-18 12:51:08 [root] INFO: def parse(): Found 10 links on https://lambertvillecountrydancers.org/whatsNew.php
2025-06-18 12:51:08 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/watch?v=60TOL5LfCdU.
2025-06-18 12:51:08 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/watch?v=eD8w9OlQcs4.
2025-06-18 12:51:08 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/watch?v=-VPXnUUbhWA.
2025-06-18 12:51:08 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/watch?v=cs4eo0WmAtU.
2025-06-18 12:51:08 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/watch?v=Nv2phbWPSdg.
2025-06-18 12:51:08 [root] INFO: should_process_url: URL https://lambertvillecountrydancers.org/whatsNew.php was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:51:08 [root] INFO: should_process_url: URL https://lambertvillecountrydancers.org/whatsNew.php was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:51:08 [root] INFO: write_url_to_db(): appended URL 'https://lambertvillecountrydancers.org/whatsNew.php'
2025-06-18 12:51:08 [root] INFO: def parse(): Crawling next URL: https://lambertvillecountrydancers.org/whatsNew.php
2025-06-18 12:51:08 [root] INFO: def parse(): Found keywords for URL https://www.sedadance.ca/: ['dance']
2025-06-18 12:51:08 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.sedadance.ca/
2025-06-18 12:51:08 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 12:51:08 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 12:51:08 [root] INFO: query_llm(): Querying Mistral
2025-06-18 12:51:49 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:51:49 [root] INFO: query_llm(): Mistral response received: **No events found.**
2025-06-18 12:51:49 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 12:51:49 [root] INFO: write_url_to_db(): appended URL 'https://www.sedadance.ca/'
2025-06-18 12:51:49 [root] INFO: def parse(): URL https://www.sedadance.ca/ marked as irrelevant (LLM negative).
2025-06-18 12:51:49 [root] INFO: def parse(): Found 10 links on https://www.sedadance.ca/
2025-06-18 12:51:49 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/SEDAdance'
2025-06-18 12:51:49 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/SEDAdance
2025-06-18 12:51:49 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/sedadance_arts/'
2025-06-18 12:51:49 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/sedadance_arts/
2025-06-18 12:51:49 [root] INFO: should_process_url: URL https://www.sedadance.ca/our-studio was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:51:49 [root] INFO: should_process_url: URL https://www.sedadance.ca/our-studio was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:51:49 [root] INFO: write_url_to_db(): appended URL 'https://www.sedadance.ca/our-studio'
2025-06-18 12:51:49 [root] INFO: def parse(): Crawling next URL: https://www.sedadance.ca/our-studio
2025-06-18 12:51:49 [root] INFO: def parse(): Found keywords for URL https://www.facebook.com/groups/vancouverwcs/: ['dance', 'wcs']
2025-06-18 12:51:49 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.facebook.com/groups/vancouverwcs/
2025-06-18 12:51:49 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 12:51:49 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 12:51:49 [root] INFO: query_llm(): Querying Mistral
2025-06-18 12:52:01 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:52:01 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 12:52:01 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 12:52:01 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/vancouverwcs/'
2025-06-18 12:52:01 [root] INFO: def parse(): URL https://www.facebook.com/groups/vancouverwcs/ marked as irrelevant (LLM negative).
2025-06-18 12:52:01 [root] INFO: def parse(): Found 10 links on https://www.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2Fvancouverwcs%2F
2025-06-18 12:52:01 [root] INFO: write_url_to_db(): appended URL 'https://fr-ca.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2Fvancouverwcs%2F'
2025-06-18 12:52:01 [root] INFO: def parse(): Recorded unwanted URL: https://fr-ca.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2Fvancouverwcs%2F
2025-06-18 12:52:01 [root] INFO: write_url_to_db(): appended URL 'https://es-la.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2Fvancouverwcs%2F'
2025-06-18 12:52:01 [root] INFO: def parse(): Recorded unwanted URL: https://es-la.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2Fvancouverwcs%2F
2025-06-18 12:52:01 [root] INFO: write_url_to_db(): appended URL 'https://zh-cn.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2Fvancouverwcs%2F'
2025-06-18 12:52:01 [root] INFO: def parse(): Recorded unwanted URL: https://zh-cn.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2Fvancouverwcs%2F
2025-06-18 12:52:01 [root] INFO: write_url_to_db(): appended URL 'https://ko-kr.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2Fvancouverwcs%2F'
2025-06-18 12:52:01 [root] INFO: def parse(): Recorded unwanted URL: https://ko-kr.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2Fvancouverwcs%2F
2025-06-18 12:52:01 [root] INFO: write_url_to_db(): appended URL 'https://pt-br.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2Fvancouverwcs%2F'
2025-06-18 12:52:01 [root] INFO: def parse(): Recorded unwanted URL: https://pt-br.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2Fvancouverwcs%2F
2025-06-18 12:52:01 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/vancouverwcs/'
2025-06-18 12:52:01 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/groups/vancouverwcs/
2025-06-18 12:52:01 [root] INFO: write_url_to_db(): appended URL 'https://ja-jp.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2Fvancouverwcs%2F'
2025-06-18 12:52:01 [root] INFO: def parse(): Recorded unwanted URL: https://ja-jp.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2Fvancouverwcs%2F
2025-06-18 12:52:01 [root] INFO: write_url_to_db(): appended URL 'https://it-it.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2Fvancouverwcs%2F'
2025-06-18 12:52:01 [root] INFO: def parse(): Recorded unwanted URL: https://it-it.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2Fvancouverwcs%2F
2025-06-18 12:52:01 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/recover/initiate/?ars=facebook_login&cancel_lara_pswd=0&next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2Fvancouverwcs%2F'
2025-06-18 12:52:01 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/recover/initiate/?ars=facebook_login&cancel_lara_pswd=0&next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2Fvancouverwcs%2F
2025-06-18 12:52:01 [root] INFO: write_url_to_db(): appended URL 'https://de-de.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2Fvancouverwcs%2F'
2025-06-18 12:52:01 [root] INFO: def parse(): Recorded unwanted URL: https://de-de.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2Fvancouverwcs%2F
2025-06-18 12:52:01 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2Fvancouverwcs%2F'
2025-06-18 12:52:01 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2Fvancouverwcs%2F
2025-06-18 12:52:01 [root] INFO: def parse(): Found keywords for URL https://2traveldads.com/balboa-park-guide-san-diego/minolta-digital-camera-109/: ['balboa']
2025-06-18 12:52:01 [root] INFO: def generate_prompt(): Generating prompt for URL: https://2traveldads.com/balboa-park-guide-san-diego/minolta-digital-camera-109/
2025-06-18 12:52:01 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 12:52:01 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 12:52:01 [root] INFO: query_llm(): Querying Mistral
2025-06-18 12:52:05 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 502 Bad Gateway"
2025-06-18 12:52:05 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 502
<html>
<head><title>502 Bad Gateway</title></head>
<body>
<center><h1>502 Bad Gateway</h1></center>
<hr><center>cloudflare</center>
</body>
</html>

2025-06-18 12:52:05 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 12:52:09 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:52:09 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 12:52:09 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 12:52:09 [root] INFO: write_url_to_db(): appended URL 'https://2traveldads.com/balboa-park-guide-san-diego/minolta-digital-camera-109/'
2025-06-18 12:52:09 [root] INFO: def parse(): URL https://2traveldads.com/balboa-park-guide-san-diego/minolta-digital-camera-109/ marked as irrelevant (LLM negative).
2025-06-18 12:52:09 [root] INFO: def parse(): Found 10 links on https://2traveldads.com/balboa-park-guide-san-diego/minolta-digital-camera-109/
2025-06-18 12:52:09 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/florida/florida-keys/ has never been seen before, processing it.
2025-06-18 12:52:09 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/florida/florida-keys/ has never been seen before, processing it.
2025-06-18 12:52:09 [root] INFO: write_url_to_db(): appended URL 'https://2traveldads.com/category/southeastern-us/florida/florida-keys/'
2025-06-18 12:52:09 [root] INFO: def parse(): Crawling next URL: https://2traveldads.com/category/southeastern-us/florida/florida-keys/
2025-06-18 12:52:09 [root] INFO: def parse(): Found keywords for URL https://www.nataliepadillamusic.com/: ['dance', 'waltz']
2025-06-18 12:52:09 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.nataliepadillamusic.com/
2025-06-18 12:52:09 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 12:52:09 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 12:52:09 [root] INFO: query_llm(): Querying Mistral
2025-06-18 12:52:36 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:52:36 [root] INFO: query_llm(): Mistral response received: [
  {
    "source": "Natalie Padilla",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Going Going Gone",
    "day_of_week": "Wednesday",
    "start_date": "2025-06-19",
    "end_date": "2025-06-19",
    "start_time": "00:00",
    "end_time": "null",
    "price": "",
    "location": "",
    "description": "“Light to Dark” oil painting by Easthampton, MA artist Laura Radwell, the perfect cover art for Going Going Gone, single released June 20, 2024. It’s a ballad, written on the summer solstice of 2023, about creating space for new beginnings and following instincts. Canadian multi-instrumentalist Quinn Bachand produced, engineered and mixed, mastering by Trevor Buckingham."
  }
]
2025-06-18 12:52:36 [root] INFO: def extract_and_parse_json(): for url https://www.nataliepadillamusic.com/, 
Cleaned JSON ready for parsing:
[
  {
    "source": "Natalie Padilla",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Going Going Gone",
    "day_of_week": "Wednesday",
    "start_date": "2025-06-19",
    "end_date": "2025-06-19",
    "start_time": "00:00",
    "end_time": "null",
    "price": "",
    "location": "",
    "description": "“Light to Dark” oil painting by Easthampton, MA artist Laura Radwell, the perfect cover art for Going Going Gone, single released June 20, 2024. It’s a ballad, written on the summer solstice of 2023, about creating space for new beginnings and following instincts. Canadian multi-instrumentalist Quinn Bachand produced, engineered and mixed, mastering by Trevor Buckingham."
  }
]
2025-06-18 12:52:36 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:52:36 [root] INFO: write_events_to_db: Number of events to write: 1
2025-06-18 12:52:36 [root] INFO: write_url_to_db(): appended URL 'https://www.nataliepadillamusic.com/'
2025-06-18 12:52:36 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:52:36 [root] INFO: def process_llm_response: URL https://www.nataliepadillamusic.com/ marked as relevant with events written to the database.
2025-06-18 12:52:36 [root] INFO: write_url_to_db(): appended URL 'https://www.nataliepadillamusic.com/'
2025-06-18 12:52:36 [root] INFO: def parse(): URL https://www.nataliepadillamusic.com/ marked as relevant (LLM positive).
2025-06-18 12:52:36 [root] INFO: def parse(): Found 10 links on https://www.nataliepadillamusic.com/
2025-06-18 12:52:36 [root] INFO: should_process_url: URL https://folkalley.com/folk-alley-favorites-best-trad-of-2023/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:52:36 [root] INFO: should_process_url: URL https://folkalley.com/folk-alley-favorites-best-trad-of-2023/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:52:36 [root] INFO: write_url_to_db(): appended URL 'https://folkalley.com/folk-alley-favorites-best-trad-of-2023/'
2025-06-18 12:52:36 [root] INFO: def parse(): Crawling next URL: https://folkalley.com/folk-alley-favorites-best-trad-of-2023/
2025-06-18 12:52:36 [root] INFO: def parse(): Found keywords for URL https://victoriaarthurmurray.com/country-dance-lessons-victoria: ['argentine tango', 'dance', 'salsa', 'swing', 'tango', 'waltz']
2025-06-18 12:52:36 [root] INFO: def generate_prompt(): Generating prompt for URL: https://victoriaarthurmurray.com/country-dance-lessons-victoria
2025-06-18 12:52:36 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 12:52:36 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 12:52:36 [root] INFO: query_llm(): Querying Mistral
2025-06-18 12:52:38 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:52:38 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 12:52:38 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 12:52:38 [root] INFO: write_url_to_db(): appended URL 'https://victoriaarthurmurray.com/country-dance-lessons-victoria'
2025-06-18 12:52:38 [root] INFO: def parse(): URL https://victoriaarthurmurray.com/country-dance-lessons-victoria marked as irrelevant (LLM negative).
2025-06-18 12:52:38 [root] INFO: def parse(): Found 4 links on https://victoriaarthurmurray.com/country-dance-lessons-victoria
2025-06-18 12:52:38 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://player.vimeo.com/video/532060114?h=009df7df2f, URL: https://victoriaarthurmurray.com/country-dance-lessons-victoria, source: Country Dance Lessons Victoria | Arthur Murray Dance Studio Victoria, keywords: country waltz
2025-06-18 12:52:38 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: Vzoרӭ5׈
2025-06-18 12:52:38 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://player.vimeo.com/video/532060114?h=009df7df2f
2025-06-18 12:52:38 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://open.spotify.com/embed/playlist/37i9dQZF1EIe1zKORHCwau?utm_source=generator, URL: https://victoriaarthurmurray.com/country-dance-lessons-victoria, source: Country Dance Lessons Victoria | Arthur Murray Dance Studio Victoria, keywords: country waltz
2025-06-18 12:52:38 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: -oޙZXPd]D!s(G٬zz
2025-06-18 12:52:38 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://open.spotify.com/embed/playlist/37i9dQZF1EIe1zKORHCwau?utm_source=generator
2025-06-18 12:52:38 [root] INFO: write_url_to_db(): appended URL 'https://open.spotify.com/embed/playlist/37i9dQZF1EIe1zKORHCwau?utm_source=generator'
2025-06-18 12:52:38 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/arthurmurrayvictoria/'
2025-06-18 12:52:38 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/arthurmurrayvictoria/
2025-06-18 12:52:38 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/arthurmurrayvictoria/videos/?paipv=0&eav=Afbzsw7yT8_U9vONkYXTLCfaMs9d58V0nv6aINH-fx05iJy6FRRTITOIQMpEK2Y1-kM&_rdr'
2025-06-18 12:52:38 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/arthurmurrayvictoria/videos/?paipv=0&eav=Afbzsw7yT8_U9vONkYXTLCfaMs9d58V0nv6aINH-fx05iJy6FRRTITOIQMpEK2Y1-kM&_rdr
2025-06-18 12:52:38 [root] INFO: should_process_url: URL https://onbeatmarketing.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:52:38 [root] INFO: should_process_url: URL https://onbeatmarketing.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:52:38 [root] INFO: write_url_to_db(): appended URL 'https://onbeatmarketing.com'
2025-06-18 12:52:38 [root] INFO: def parse(): Crawling next URL: https://onbeatmarketing.com
2025-06-18 12:52:38 [root] INFO: def parse(): Found keywords for URL https://www.5rhythms.com/who-we-are/teacher-communities/the-americas/canada-west-coast/: ['dance']
2025-06-18 12:52:38 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.5rhythms.com/who-we-are/teacher-communities/the-americas/canada-west-coast/
2025-06-18 12:52:38 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 12:52:38 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 12:52:38 [root] INFO: query_llm(): Querying Mistral
2025-06-18 12:52:38 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-06-18 12:52:38 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 429
{"object":"rejection","message":"Service tier capacity exceeded for this model.","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 12:52:38 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 12:52:57 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:52:57 [root] INFO: query_llm(): OpenAI response received: [{
    "source": "5Rhythms | West Coast Canada",
    "dance_style": "",
    "url": "",
    "event_type": "workshop",
    "event_name": "UNTAMED: Campout Retreat WILD EXPANSION",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-22",
    "start_time": "",
    "end_time": "",
    "price": "$485",
    "location": "Salt Spring Island",
    "description": "A weekend retreat including 2 nights camping, 5 meals and 5 sessions celebrating Summer Solstice through dance, writing, circle/partner work and ritual."
},
{
    "source": "5Rhythms | West Coast Canada",
    "dance_style": "",
    "url": "",
    "event_type": "workshop",
    "event_name": "FLOWSTATE",
    "day_of_week": "Saturday",
    "start_date": "2025-06-28",
    "end_date": "2025-06-28",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Vancouver",
    "description": "A one-day 5Rhythms® workshop exploring flowstate – a deep current of presence through the Wave of Flowing, Staccato, Chaos, Lyrical, and Stillness."
}]
2025-06-18 12:52:57 [root] INFO: def extract_and_parse_json(): for url https://www.5rhythms.com/who-we-are/teacher-communities/the-americas/canada-west-coast/, 
Cleaned JSON ready for parsing:
[{
    "source": "5Rhythms | West Coast Canada",
    "dance_style": "",
    "url": "",
    "event_type": "workshop",
    "event_name": "UNTAMED: Campout Retreat WILD EXPANSION",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-22",
    "start_time": "",
    "end_time": "",
    "price": "$485",
    "location": "Salt Spring Island",
    "description": "A weekend retreat including 2 nights camping, 5 meals and 5 sessions celebrating Summer Solstice through dance, writing, circle/partner work and ritual."
},
{
    "source": "5Rhythms | West Coast Canada",
    "dance_style": "",
    "url": "",
    "event_type": "workshop",
    "event_name": "FLOWSTATE",
    "day_of_week": "Saturday",
    "start_date": "2025-06-28",
    "end_date": "2025-06-28",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Vancouver",
    "description": "A one-day 5Rhythms® workshop exploring flowstate – a deep current of presence through the Wave of Flowing, Staccato, Chaos, Lyrical, and Stillness."
}]
2025-06-18 12:52:57 [root] INFO: def clean_up_address(): Starting with events_df shape: (2, 14)
2025-06-18 12:52:57 [root] INFO: def clean_up_address(): Processing location 'Salt Spring Island' (event_id: None)
2025-06-18 12:52:57 [root] INFO: def clean_up_address(): Processing location 'Vancouver' (event_id: None)
2025-06-18 12:52:57 [root] INFO: write_events_to_db: Number of events to write: 2
2025-06-18 12:52:57 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/who-we-are/teacher-communities/the-americas/canada-west-coast/'
2025-06-18 12:52:57 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:52:57 [root] INFO: def process_llm_response: URL https://www.5rhythms.com/who-we-are/teacher-communities/the-americas/canada-west-coast/ marked as relevant with events written to the database.
2025-06-18 12:52:57 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/who-we-are/teacher-communities/the-americas/canada-west-coast/'
2025-06-18 12:52:57 [root] INFO: def parse(): URL https://www.5rhythms.com/who-we-are/teacher-communities/the-americas/canada-west-coast/ marked as relevant (LLM positive).
2025-06-18 12:52:57 [root] INFO: def parse(): Found 10 links on https://www.5rhythms.com/who-we-are/teacher-communities/the-americas/canada-west-coast/
2025-06-18 12:52:57 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/5rhythms'
2025-06-18 12:52:57 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/5rhythms
2025-06-18 12:52:57 [root] INFO: write_url_to_db(): appended URL 'https://instagram.com/5rhythms/'
2025-06-18 12:52:57 [root] INFO: def parse(): Recorded unwanted URL: https://instagram.com/5rhythms/
2025-06-18 12:52:57 [root] INFO: should_process_url: URL https://www.5rhythms.com/EventSearch.php was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:52:57 [root] INFO: should_process_url: URL https://www.5rhythms.com/EventSearch.php was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:52:57 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/EventSearch.php'
2025-06-18 12:52:57 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/EventSearch.php
2025-06-18 12:52:57 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/watch?v=ausx09jkNCU.
2025-06-18 12:52:57 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/watch?v=1YNzuR7xlmg.
2025-06-18 12:52:57 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/watch?v=H3_ymWT0-xY.
2025-06-18 12:52:57 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/watch?v=2jxpL-cl25w.
2025-06-18 12:52:57 [scrapy.extensions.logstats] INFO: Crawled 32 pages (at 4 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 12:52:57 [root] INFO: should_process_url: URL https://www.sedadance.ca/dropin was last seen as relevant, processing it.
2025-06-18 12:52:57 [root] INFO: should_process_url: URL https://www.sedadance.ca/dropin was last seen as relevant, processing it.
2025-06-18 12:52:57 [root] INFO: write_url_to_db(): appended URL 'https://www.sedadance.ca/dropin'
2025-06-18 12:52:57 [root] INFO: def parse(): Crawling next URL: https://www.sedadance.ca/dropin
2025-06-18 12:52:57 [root] INFO: should_process_url: URL https://2traveldads.com/southeast-usa/ has never been seen before, processing it.
2025-06-18 12:52:57 [root] INFO: should_process_url: URL https://2traveldads.com/southeast-usa/ has never been seen before, processing it.
2025-06-18 12:52:57 [root] INFO: write_url_to_db(): appended URL 'https://2traveldads.com/southeast-usa/'
2025-06-18 12:52:57 [root] INFO: def parse(): Crawling next URL: https://2traveldads.com/southeast-usa/
2025-06-18 12:52:57 [root] INFO: should_process_url: URL https://www.fatea-records.co.uk/magazine/reviews/NataliePadilla/ was last seen as relevant, processing it.
2025-06-18 12:52:57 [root] INFO: should_process_url: URL https://www.fatea-records.co.uk/magazine/reviews/NataliePadilla/ was last seen as relevant, processing it.
2025-06-18 12:52:57 [root] INFO: write_url_to_db(): appended URL 'https://www.fatea-records.co.uk/magazine/reviews/NataliePadilla/'
2025-06-18 12:52:57 [root] INFO: def parse(): Crawling next URL: https://www.fatea-records.co.uk/magazine/reviews/NataliePadilla/
2025-06-18 12:52:57 [root] INFO: should_process_url: URL https://nataliepadilla.bandcamp.com/album/eostre was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:52:57 [root] INFO: should_process_url: URL https://nataliepadilla.bandcamp.com/album/eostre was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:52:57 [root] INFO: write_url_to_db(): appended URL 'https://nataliepadilla.bandcamp.com/album/eostre'
2025-06-18 12:52:57 [root] INFO: def parse(): Crawling next URL: https://nataliepadilla.bandcamp.com/album/eostre
2025-06-18 12:52:57 [root] INFO: should_process_url: URL https://maps.app.goo.gl/xu9uqzPrPHXQjyQNA was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:52:57 [root] INFO: should_process_url: URL https://maps.app.goo.gl/xu9uqzPrPHXQjyQNA was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:52:57 [root] INFO: write_url_to_db(): appended URL 'https://maps.app.goo.gl/xu9uqzPrPHXQjyQNA'
2025-06-18 12:52:57 [root] INFO: def parse(): Crawling next URL: https://maps.app.goo.gl/xu9uqzPrPHXQjyQNA
2025-06-18 12:52:57 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/who-we-are/teacher-communities/the-americas/canada-west-coast/ was last seen as relevant, processing it.
2025-06-18 12:52:57 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/who-we-are/teacher-communities/the-americas/canada-west-coast/ was last seen as relevant, processing it.
2025-06-18 12:52:57 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/hr/who-we-are/teacher-communities/the-americas/canada-west-coast/'
2025-06-18 12:52:57 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/hr/who-we-are/teacher-communities/the-americas/canada-west-coast/
2025-06-18 12:52:57 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/5Rhythms.
2025-06-18 12:52:57 [root] INFO: should_process_url: URL https://www.5rhythms.com/who-we-are/teacher-communities/the-americas/canada-west-coast/ was last seen as not relevant but hit_ratio (3.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:52:57 [root] INFO: should_process_url: URL https://www.5rhythms.com/who-we-are/teacher-communities/the-americas/canada-west-coast/ was last seen as not relevant but hit_ratio (3.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:52:57 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/who-we-are/teacher-communities/the-americas/canada-west-coast/'
2025-06-18 12:52:57 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/who-we-are/teacher-communities/the-americas/canada-west-coast/
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://www.sedadance.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://www.sedadance.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:52:58 [root] INFO: write_url_to_db(): appended URL 'https://www.sedadance.ca/'
2025-06-18 12:52:58 [root] INFO: def parse(): Crawling next URL: https://www.sedadance.ca/
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/florida/ has never been seen before, processing it.
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/florida/ has never been seen before, processing it.
2025-06-18 12:52:58 [root] INFO: write_url_to_db(): appended URL 'https://2traveldads.com/category/southeastern-us/florida/'
2025-06-18 12:52:58 [root] INFO: def parse(): Crawling next URL: https://2traveldads.com/category/southeastern-us/florida/
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://bluegrasscountry.org/brad-kolodner-on-air-interviews/ was last seen as relevant, processing it.
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://bluegrasscountry.org/brad-kolodner-on-air-interviews/ was last seen as relevant, processing it.
2025-06-18 12:52:58 [root] INFO: write_url_to_db(): appended URL 'https://bluegrasscountry.org/brad-kolodner-on-air-interviews/'
2025-06-18 12:52:58 [root] INFO: def parse(): Crawling next URL: https://bluegrasscountry.org/brad-kolodner-on-air-interviews/
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://victoriaarthurmurray.com/country-dance-lessons-victoria was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://victoriaarthurmurray.com/country-dance-lessons-victoria was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:52:58 [root] INFO: write_url_to_db(): appended URL 'https://victoriaarthurmurray.com/country-dance-lessons-victoria'
2025-06-18 12:52:58 [root] INFO: def parse(): Crawling next URL: https://victoriaarthurmurray.com/country-dance-lessons-victoria
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/who-we-are/teacher-communities/the-americas/canada-west-coast/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/who-we-are/teacher-communities/the-americas/canada-west-coast/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:52:58 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/nl/who-we-are/teacher-communities/the-americas/canada-west-coast/'
2025-06-18 12:52:58 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/nl/who-we-are/teacher-communities/the-americas/canada-west-coast/
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://2traveldads.com/ has never been seen before, processing it.
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://2traveldads.com/ has never been seen before, processing it.
2025-06-18 12:52:58 [root] INFO: write_url_to_db(): appended URL 'https://2traveldads.com/'
2025-06-18 12:52:58 [root] INFO: def parse(): Crawling next URL: https://2traveldads.com/
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://stringsmagazine.com/forget-me-not-is-a-simple-waltz-that-offers-fiddlers-freedom-at-a-gentle-tempo/ was last seen as relevant, processing it.
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://stringsmagazine.com/forget-me-not-is-a-simple-waltz-that-offers-fiddlers-freedom-at-a-gentle-tempo/ was last seen as relevant, processing it.
2025-06-18 12:52:58 [root] INFO: write_url_to_db(): appended URL 'https://stringsmagazine.com/forget-me-not-is-a-simple-waltz-that-offers-fiddlers-freedom-at-a-gentle-tempo/'
2025-06-18 12:52:58 [root] INFO: def parse(): Crawling next URL: https://stringsmagazine.com/forget-me-not-is-a-simple-waltz-that-offers-fiddlers-freedom-at-a-gentle-tempo/
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://www.5rhythms.com/es/who-we-are/teacher-communities/the-americas/canada-west-coast/ was last seen as relevant, processing it.
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://www.5rhythms.com/es/who-we-are/teacher-communities/the-americas/canada-west-coast/ was last seen as relevant, processing it.
2025-06-18 12:52:58 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/es/who-we-are/teacher-communities/the-americas/canada-west-coast/'
2025-06-18 12:52:58 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/es/who-we-are/teacher-communities/the-americas/canada-west-coast/
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://www.5rhythms.com/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://www.5rhythms.com/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:52:58 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/'
2025-06-18 12:52:58 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://2traveldads.com/category/southwestern-us/ has never been seen before, processing it.
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://2traveldads.com/category/southwestern-us/ has never been seen before, processing it.
2025-06-18 12:52:58 [root] INFO: write_url_to_db(): appended URL 'https://2traveldads.com/category/southwestern-us/'
2025-06-18 12:52:58 [root] INFO: def parse(): Crawling next URL: https://2traveldads.com/category/southwestern-us/
2025-06-18 12:52:58 [root] INFO: should_process_url: URL http://www.folkworld.eu/81/e/cds1.html was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:52:58 [root] INFO: should_process_url: URL http://www.folkworld.eu/81/e/cds1.html was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:52:58 [root] INFO: write_url_to_db(): appended URL 'http://www.folkworld.eu/81/e/cds1.html'
2025-06-18 12:52:58 [root] INFO: def parse(): Crawling next URL: http://www.folkworld.eu/81/e/cds1.html
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://www.5rhythms.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://www.5rhythms.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:52:58 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com'
2025-06-18 12:52:58 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://2traveldads.com/balboa-park-guide-san-diego/minolta-digital-camera-109/ has never been seen before, processing it.
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://2traveldads.com/balboa-park-guide-san-diego/minolta-digital-camera-109/ has never been seen before, processing it.
2025-06-18 12:52:58 [root] INFO: write_url_to_db(): appended URL 'https://2traveldads.com/balboa-park-guide-san-diego/minolta-digital-camera-109/'
2025-06-18 12:52:58 [root] INFO: def parse(): Crawling next URL: https://2traveldads.com/balboa-park-guide-san-diego/minolta-digital-camera-109/
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://www.lauraradwell.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://www.lauraradwell.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:52:58 [root] INFO: write_url_to_db(): appended URL 'https://www.lauraradwell.com/'
2025-06-18 12:52:58 [root] INFO: def parse(): Crawling next URL: https://www.lauraradwell.com/
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://www.5rhythms.com/TeacherSearch.php was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://www.5rhythms.com/TeacherSearch.php was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:52:58 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/TeacherSearch.php'
2025-06-18 12:52:58 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/TeacherSearch.php
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/alabama/ has never been seen before, processing it.
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/alabama/ has never been seen before, processing it.
2025-06-18 12:52:58 [root] INFO: write_url_to_db(): appended URL 'https://2traveldads.com/category/southeastern-us/alabama/'
2025-06-18 12:52:58 [root] INFO: def parse(): Crawling next URL: https://2traveldads.com/category/southeastern-us/alabama/
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://nataliepadilla.bandcamp.com/album/montana-wildflower was last seen as relevant, processing it.
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://nataliepadilla.bandcamp.com/album/montana-wildflower was last seen as relevant, processing it.
2025-06-18 12:52:58 [root] INFO: write_url_to_db(): appended URL 'https://nataliepadilla.bandcamp.com/album/montana-wildflower'
2025-06-18 12:52:58 [root] INFO: def parse(): Crawling next URL: https://nataliepadilla.bandcamp.com/album/montana-wildflower
2025-06-18 12:52:58 [root] INFO: write_url_to_db(): appended URL 'https://whereiskylenow.com/airstream/americas-finest-city.html'
2025-06-18 12:52:58 [root] INFO: def parse(): URL https://whereiskylenow.com/airstream/americas-finest-city.html marked as irrelevant (no keywords).
2025-06-18 12:52:58 [root] INFO: def parse(): Found 0 links on https://whereiskylenow.com/airstream/americas-finest-city.html
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://whereiskylenow.com/airstream/americas-finest-city.html was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:52:58 [root] INFO: should_process_url: URL https://whereiskylenow.com/airstream/americas-finest-city.html was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:52:58 [root] INFO: write_url_to_db(): appended URL 'https://whereiskylenow.com/airstream/americas-finest-city.html'
2025-06-18 12:52:58 [root] INFO: def parse(): Crawling next URL: https://whereiskylenow.com/airstream/americas-finest-city.html
2025-06-18 12:52:58 [root] INFO: def parse(): Found keywords for URL https://swimintothesound.com/blog/2024/5/22/pardoner-nick-normal-guitar-shoplifter-cherry-venom-concert-review: ['live music']
2025-06-18 12:52:58 [root] INFO: def generate_prompt(): Generating prompt for URL: https://swimintothesound.com/blog/2024/5/22/pardoner-nick-normal-guitar-shoplifter-cherry-venom-concert-review
2025-06-18 12:52:58 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 12:52:58 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 12:52:58 [root] INFO: query_llm(): Querying Mistral
2025-06-18 12:53:48 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:53:48 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "Swim Into The Sound",
        "dance_style": "live music",
        "url": "",
        "event_type": "live music",
        "event_name": "North Carolina Triple Threat: Wednesday, Kerosene Heights, and Eliza McLamb",
        "day_of_week": "Thursday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "19:00",
        "end_time": "",
        "price": "",
        "location": "White Eagle Polish Hall, 707 Southwest Washington Street, Portland, OR, 97205",
        "description": "This event is part of a live music review featuring bands Wednesday, Kerosene Heights, and Eliza McLamb."
    },
    {
        "source": "Swim Into The Sound",
        "dance_style": "live music",
        "url": "",
        "event_type": "live music",
        "event_name": "Pardoner, Nick Normal, Guitar, Shoplifter, Cherry Venom | Concert Review",
        "day_of_week": "Thursday",
        "start_date": "2024-05-09",
        "end_date": "2024-05-09",
        "start_time": "19:00",
        "end_time": "",
        "price": "",
        "location": "White Eagle Polish Hall, 707 Southwest Washington Street, Portland, OR, 97205",
        "description": "A concert review featuring the bands Pardoner, Nick Normal, Guitar, Shoplifter, and Cherry Venom."
    }
]
2025-06-18 12:53:48 [root] INFO: def extract_and_parse_json(): for url https://swimintothesound.com/blog/2024/5/22/pardoner-nick-normal-guitar-shoplifter-cherry-venom-concert-review, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Swim Into The Sound",
        "dance_style": "live music",
        "url": "",
        "event_type": "live music",
        "event_name": "North Carolina Triple Threat: Wednesday, Kerosene Heights, and Eliza McLamb",
        "day_of_week": "Thursday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "19:00",
        "end_time": "",
        "price": "",
        "location": "White Eagle Polish Hall, 707 Southwest Washington Street, Portland, OR, 97205",
        "description": "This event is part of a live music review featuring bands Wednesday, Kerosene Heights, and Eliza McLamb."
    },
    {
        "source": "Swim Into The Sound",
        "dance_style": "live music",
        "url": "",
        "event_type": "live music",
        "event_name": "Pardoner, Nick Normal, Guitar, Shoplifter, Cherry Venom | Concert Review",
        "day_of_week": "Thursday",
        "start_date": "2024-05-09",
        "end_date": "2024-05-09",
        "start_time": "19:00",
        "end_time": "",
        "price": "",
        "location": "White Eagle Polish Hall, 707 Southwest Washington Street, Portland, OR, 97205",
        "description": "A concert review featuring the bands Pardoner, Nick Normal, Guitar, Shoplifter, and Cherry Venom."
    }
]
2025-06-18 12:53:48 [root] INFO: def clean_up_address(): Starting with events_df shape: (2, 14)
2025-06-18 12:53:48 [root] INFO: def clean_up_address(): Processing location 'White Eagle Polish Hall, 707 Southwest Washington Street, Portland, OR, 97205' (event_id: None)
2025-06-18 12:53:48 [root] INFO: def clean_up_address(): Processing location 'White Eagle Polish Hall, 707 Southwest Washington Street, Portland, OR, 97205' (event_id: None)
2025-06-18 12:53:48 [root] INFO: write_events_to_db: Number of events to write: 2
2025-06-18 12:53:49 [root] INFO: write_url_to_db(): appended URL 'https://swimintothesound.com/blog/2024/5/22/pardoner-nick-normal-guitar-shoplifter-cherry-venom-concert-review'
2025-06-18 12:53:49 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:53:49 [root] INFO: def process_llm_response: URL https://swimintothesound.com/blog/2024/5/22/pardoner-nick-normal-guitar-shoplifter-cherry-venom-concert-review marked as relevant with events written to the database.
2025-06-18 12:53:49 [root] INFO: write_url_to_db(): appended URL 'https://swimintothesound.com/blog/2024/5/22/pardoner-nick-normal-guitar-shoplifter-cherry-venom-concert-review'
2025-06-18 12:53:49 [root] INFO: def parse(): URL https://swimintothesound.com/blog/2024/5/22/pardoner-nick-normal-guitar-shoplifter-cherry-venom-concert-review marked as relevant (LLM positive).
2025-06-18 12:53:49 [root] INFO: def parse(): Found 10 links on https://swimintothesound.com/blog/2024/5/22/pardoner-nick-normal-guitar-shoplifter-cherry-venom-concert-review
2025-06-18 12:53:49 [root] INFO: write_url_to_db(): appended URL 'http://instagram.com/swimintosound'
2025-06-18 12:53:49 [root] INFO: def parse(): Recorded unwanted URL: http://instagram.com/swimintosound
2025-06-18 12:53:49 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/p/C4d4-0puKAb/?hl=en&img_index=1'
2025-06-18 12:53:49 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/p/C4d4-0puKAb/?hl=en&img_index=1
2025-06-18 12:53:49 [root] INFO: should_process_url: URL https://swimintothesound.com/blog/2024/5/22/pardoner-nick-normal-guitar-shoplifter-cherry-venom-concert-review was last seen as not relevant but hit_ratio (3.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:53:49 [root] INFO: should_process_url: URL https://swimintothesound.com/blog/2024/5/22/pardoner-nick-normal-guitar-shoplifter-cherry-venom-concert-review was last seen as not relevant but hit_ratio (3.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:53:49 [root] INFO: write_url_to_db(): appended URL 'https://swimintothesound.com/blog/2024/5/22/pardoner-nick-normal-guitar-shoplifter-cherry-venom-concert-review'
2025-06-18 12:53:49 [root] INFO: def parse(): Crawling next URL: https://swimintothesound.com/blog/2024/5/22/pardoner-nick-normal-guitar-shoplifter-cherry-venom-concert-review
2025-06-18 12:53:49 [root] INFO: def parse(): Found keywords for URL https://www.facebook.com/groups/witchdanceunited/posts/596478935870544/: ['dance', 'wcs']
2025-06-18 12:53:49 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.facebook.com/groups/witchdanceunited/posts/596478935870544/
2025-06-18 12:53:49 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 12:53:49 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 12:53:49 [root] INFO: query_llm(): Querying Mistral
2025-06-18 12:53:51 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 12:53:51 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 492404 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 12:53:51 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 12:53:53 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 12:53:53 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 367357 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 12:53:53 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 12:53:53 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://www.facebook.com/groups/witchdanceunited/posts/596478935870544/
2025-06-18 12:53:53 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/witchdanceunited/posts/596478935870544/'
2025-06-18 12:53:53 [root] INFO: def parse(): URL https://www.facebook.com/groups/witchdanceunited/posts/596478935870544/ marked as irrelevant (LLM negative).
2025-06-18 12:53:53 [root] INFO: def parse(): Found 0 links on https://www.facebook.com/groups/witchdanceunited/posts/596478935870544/
2025-06-18 12:53:53 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/witchdanceunited/posts/596478935870544/'
2025-06-18 12:53:53 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/groups/witchdanceunited/posts/596478935870544/
2025-06-18 12:53:53 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/georgia/ has never been seen before, processing it.
2025-06-18 12:53:53 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/georgia/ has never been seen before, processing it.
2025-06-18 12:53:53 [root] INFO: write_url_to_db(): appended URL 'https://2traveldads.com/category/southeastern-us/georgia/'
2025-06-18 12:53:53 [root] INFO: def parse(): Crawling next URL: https://2traveldads.com/category/southeastern-us/georgia/
2025-06-18 12:53:53 [root] INFO: should_process_url: URL https://www.bradkolodner.com/radio.html was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:53:53 [root] INFO: should_process_url: URL https://www.bradkolodner.com/radio.html was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:53:53 [root] INFO: write_url_to_db(): appended URL 'https://www.bradkolodner.com/radio.html'
2025-06-18 12:53:53 [root] INFO: def parse(): Crawling next URL: https://www.bradkolodner.com/radio.html
2025-06-18 12:53:53 [scrapy.extensions.logstats] INFO: Crawled 32 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 12:53:53 [root] INFO: should_process_url: URL https://bsky.app/profile/swimintosound.bsky.social was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:53:53 [root] INFO: should_process_url: URL https://bsky.app/profile/swimintosound.bsky.social was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:53:53 [root] INFO: write_url_to_db(): appended URL 'https://bsky.app/profile/swimintosound.bsky.social'
2025-06-18 12:53:53 [root] INFO: def parse(): Crawling next URL: https://bsky.app/profile/swimintosound.bsky.social
2025-06-18 12:53:53 [root] INFO: should_process_url: URL https://2traveldads.com/basics-of-visiting-the-united-states/ has never been seen before, processing it.
2025-06-18 12:53:53 [root] INFO: should_process_url: URL https://2traveldads.com/basics-of-visiting-the-united-states/ has never been seen before, processing it.
2025-06-18 12:53:53 [root] INFO: write_url_to_db(): appended URL 'https://2traveldads.com/basics-of-visiting-the-united-states/'
2025-06-18 12:53:53 [root] INFO: def parse(): Crawling next URL: https://2traveldads.com/basics-of-visiting-the-united-states/
2025-06-18 12:53:53 [root] INFO: should_process_url: URL https://www.nataliepadillamusic.com/ was last seen as relevant, processing it.
2025-06-18 12:53:53 [root] INFO: should_process_url: URL https://www.nataliepadillamusic.com/ was last seen as relevant, processing it.
2025-06-18 12:53:53 [root] INFO: write_url_to_db(): appended URL 'https://www.nataliepadillamusic.com/'
2025-06-18 12:53:53 [root] INFO: def parse(): Crawling next URL: https://www.nataliepadillamusic.com/
2025-06-18 12:53:53 [root] INFO: should_process_url: URL https://pardoner.bandcamp.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:53:53 [root] INFO: should_process_url: URL https://pardoner.bandcamp.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:53:53 [root] INFO: write_url_to_db(): appended URL 'https://pardoner.bandcamp.com/'
2025-06-18 12:53:53 [root] INFO: def parse(): Crawling next URL: https://pardoner.bandcamp.com/
2025-06-18 12:53:53 [root] INFO: should_process_url: URL https://2traveldads.com/all-blog-posts/ has never been seen before, processing it.
2025-06-18 12:53:53 [root] INFO: should_process_url: URL https://2traveldads.com/all-blog-posts/ has never been seen before, processing it.
2025-06-18 12:53:53 [root] INFO: write_url_to_db(): appended URL 'https://2traveldads.com/all-blog-posts/'
2025-06-18 12:53:53 [root] INFO: def parse(): Crawling next URL: https://2traveldads.com/all-blog-posts/
2025-06-18 12:53:53 [root] INFO: should_process_url: URL https://nataliepadilla.bandcamp.com/track/going-going-gone was last seen as relevant, processing it.
2025-06-18 12:53:53 [root] INFO: should_process_url: URL https://nataliepadilla.bandcamp.com/track/going-going-gone was last seen as relevant, processing it.
2025-06-18 12:53:53 [root] INFO: write_url_to_db(): appended URL 'https://nataliepadilla.bandcamp.com/track/going-going-gone'
2025-06-18 12:53:53 [root] INFO: def parse(): Crawling next URL: https://nataliepadilla.bandcamp.com/track/going-going-gone
2025-06-18 12:53:53 [root] INFO: parse: Skipping blacklisted URL https://open.spotify.com/user/j9tp7rd60p43zp19m6jzafo5a?si=8jUkSJViQLCy77PYH3562w.
2025-06-18 12:53:53 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/SwimIntoSound.
2025-06-18 12:53:53 [root] INFO: def parse(): Found keywords for URL https://dancevictoria.com/performance/alonzo-king-lines-ballet-2016/: ['dance']
2025-06-18 12:53:53 [root] INFO: def generate_prompt(): Generating prompt for URL: https://dancevictoria.com/performance/alonzo-king-lines-ballet-2016/
2025-06-18 12:53:53 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 12:53:53 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 12:53:53 [root] INFO: query_llm(): Querying Mistral
2025-06-18 12:54:24 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:54:24 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "Dance Victoria",
        "dance_style": "",
        "url": "",
        "event_type": "live dance",
        "event_name": "Sand & Shostakovich by Alonzo King LINES Ballet",
        "day_of_week": "Friday",
        "start_date": "2025-03-14",
        "end_date": "2025-03-14",
        "start_time": "19:30",
        "end_time": null,
        "price": "",
        "location": "Royal Theatre, 805 Broughton St, Victoria, BC",
        "description": "The long awaited return of one of Victoria’s favourite dance companies! Alonzo King is a visionary choreographer whose pieces are in the repertoire of the Royal Swedish Ballet, Frankfurt Ballet, Alvin Ailey American Dance Theater, Hubbard Street Dance and many, many more."
    },
    {
        "source": "Dance Victoria",
        "dance_style": "",
        "url": "",
        "event_type": "live dance",
        "event_name": "Sand & Shostakovich by Alonzo King LINES Ballet",
        "day_of_week": "Saturday",
        "start_date": "2025-03-15",
        "end_date": "2025-03-15",
        "start_time": "19:30",
        "end_time": null,
        "price": "",
        "location": "Royal Theatre, 805 Broughton St, Victoria, BC",
        "description": "The long awaited return of one of Victoria’s favourite dance companies! Alonzo King is a visionary choreographer whose pieces are in the repertoire of the Royal Swedish Ballet, Frankfurt Ballet, Alvin Ailey American Dance Theater, Hubbard Street Dance and many, many more."
    }
]
2025-06-18 12:54:24 [root] INFO: def extract_and_parse_json(): for url https://dancevictoria.com/performance/alonzo-king-lines-ballet-2016/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Dance Victoria",
        "dance_style": "",
        "url": "",
        "event_type": "live dance",
        "event_name": "Sand & Shostakovich by Alonzo King LINES Ballet",
        "day_of_week": "Friday",
        "start_date": "2025-03-14",
        "end_date": "2025-03-14",
        "start_time": "19:30",
        "end_time": null,
        "price": "",
        "location": "Royal Theatre, 805 Broughton St, Victoria, BC",
        "description": "The long awaited return of one of Victoria’s favourite dance companies! Alonzo King is a visionary choreographer whose pieces are in the repertoire of the Royal Swedish Ballet, Frankfurt Ballet, Alvin Ailey American Dance Theater, Hubbard Street Dance and many, many more."
    },
    {
        "source": "Dance Victoria",
        "dance_style": "",
        "url": "",
        "event_type": "live dance",
        "event_name": "Sand & Shostakovich by Alonzo King LINES Ballet",
        "day_of_week": "Saturday",
        "start_date": "2025-03-15",
        "end_date": "2025-03-15",
        "start_time": "19:30",
        "end_time": null,
        "price": "",
        "location": "Royal Theatre, 805 Broughton St, Victoria, BC",
        "description": "The long awaited return of one of Victoria’s favourite dance companies! Alonzo King is a visionary choreographer whose pieces are in the repertoire of the Royal Swedish Ballet, Frankfurt Ballet, Alvin Ailey American Dance Theater, Hubbard Street Dance and many, many more."
    }
]
2025-06-18 12:54:24 [root] INFO: def clean_up_address(): Starting with events_df shape: (2, 14)
2025-06-18 12:54:24 [root] INFO: def clean_up_address(): Processing location 'Royal Theatre, 805 Broughton St, Victoria, BC' (event_id: None)
2025-06-18 12:54:24 [root] INFO: def clean_up_address(): Updated event None with address_id 3446 using DB match
2025-06-18 12:54:24 [root] INFO: def clean_up_address(): Processing location 'Royal Theatre, 805 Broughton St, Victoria, BC' (event_id: None)
2025-06-18 12:54:24 [root] INFO: def clean_up_address(): Updated event None with address_id 3446 using DB match
2025-06-18 12:54:24 [root] INFO: write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:54:24 [root] INFO: write_url_to_db(): appended URL 'https://dancevictoria.com/performance/alonzo-king-lines-ballet-2016/'
2025-06-18 12:54:24 [root] INFO: def process_llm_response: URL https://dancevictoria.com/performance/alonzo-king-lines-ballet-2016/ marked as relevant with events written to the database.
2025-06-18 12:54:24 [root] INFO: write_url_to_db(): appended URL 'https://dancevictoria.com/performance/alonzo-king-lines-ballet-2016/'
2025-06-18 12:54:24 [root] INFO: def parse(): URL https://dancevictoria.com/performance/alonzo-king-lines-ballet-2016/ marked as relevant (LLM positive).
2025-06-18 12:54:24 [root] INFO: def parse(): Found 10 links on https://dancevictoria.com/performance/alonzo-king-lines-ballet-2016/
2025-06-18 12:54:24 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-TKPSD4XK, URL: https://dancevictoria.com/performance/alonzo-king-lines-ballet-2016/, source: Alonzo King LINES Ballet | Dance Victoria, keywords: line dance
2025-06-18 12:54:24 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 12:54:24 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-TKPSD4XK
2025-06-18 12:54:24 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://player.vimeo.com/video/198271236?dnt=1&app_id=122963, URL: https://dancevictoria.com/performance/alonzo-king-lines-ballet-2016/, source: Alonzo King LINES Ballet | Dance Victoria, keywords: line dance
2025-06-18 12:54:24 [root] WARNING: def decode_calendar_id(): Exception for https://player.vimeo.com/video/198271236?dnt=1&app_id=122963 - Incorrect padding
2025-06-18 12:54:24 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://player.vimeo.com/video/198271236?dnt=1&app_id=122963
2025-06-18 12:54:24 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://player.vimeo.com/video/176283036?dnt=1&app_id=122963, URL: https://dancevictoria.com/performance/alonzo-king-lines-ballet-2016/, source: Alonzo King LINES Ballet | Dance Victoria, keywords: line dance
2025-06-18 12:54:24 [root] WARNING: def decode_calendar_id(): Exception for https://player.vimeo.com/video/176283036?dnt=1&app_id=122963 - Incorrect padding
2025-06-18 12:54:24 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://player.vimeo.com/video/176283036?dnt=1&app_id=122963
2025-06-18 12:54:24 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://e.issuu.com/embed.html?d=dv_2017_insert_-_lines_proof_e&u=dancevictoria, URL: https://dancevictoria.com/performance/alonzo-king-lines-ballet-2016/, source: Alonzo King LINES Ballet | Dance Victoria, keywords: line dance
2025-06-18 12:54:24 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: z+,(mai]v׸)޲
2025-06-18 12:54:24 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://e.issuu.com/embed.html?d=dv_2017_insert_-_lines_proof_e&u=dancevictoria
2025-06-18 12:54:24 [root] INFO: write_url_to_db(): appended URL 'https://e.issuu.com/embed.html?d=dv_2017_insert_-_lines_proof_e&u=dancevictoria'
2025-06-18 12:54:24 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/DanceVictoria/'
2025-06-18 12:54:24 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/DanceVictoria/
2025-06-18 12:54:24 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/dance_victoria/'
2025-06-18 12:54:24 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/dance_victoria/
2025-06-18 12:54:24 [root] INFO: should_process_url: URL https://dancevictoria.com/performance/alonzo-king-lines-ballet-2016/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:54:24 [root] INFO: should_process_url: URL https://dancevictoria.com/performance/alonzo-king-lines-ballet-2016/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:54:24 [root] INFO: write_url_to_db(): appended URL 'https://dancevictoria.com/performance/alonzo-king-lines-ballet-2016/'
2025-06-18 12:54:24 [root] INFO: def parse(): Crawling next URL: https://dancevictoria.com/performance/alonzo-king-lines-ballet-2016/
2025-06-18 12:54:24 [root] INFO: def parse(): Found keywords for URL https://bcswingdance.ca/index.php/learn-to-dance/: ['bachata', 'dance', 'line dance', 'salsa', 'swing', 'wcs', 'west coast swing']
2025-06-18 12:54:24 [root] INFO: def generate_prompt(): Generating prompt for URL: https://bcswingdance.ca/index.php/learn-to-dance/
2025-06-18 12:54:24 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 12:54:24 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 12:54:24 [root] INFO: query_llm(): Querying Mistral
2025-06-18 12:57:42 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:57:42 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "The Roundhouse Experiment (Rx)",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "$15, or $70 for a ten-dances-in-a-row pass",
        "location": "181 Roundhouse Mews, Vancouver",
        "description": "100% West Coast Swing"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "SwingSoul Practice Social",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "17:00",
        "end_time": "18:30",
        "price": "$5 (free for SwingSoul students)",
        "location": "1627 W Broadway, Vancouver (at Dance Vancouver Studio)",
        "description": "100% WCS played at lower volume to facilitate practice & conversation"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "SwingSoul Dance Party",
        "day_of_week": "Sunday",
        "start_date": "2025-06-22",
        "end_date": "2025-06-22",
        "start_time": "20:00",
        "end_time": "22:30",
        "price": "$10 (free for SwingSoul students)",
        "location": "1627 W Broadway, Vancouver (at Dance Vancouver Studio)",
        "description": "100% WCS"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Club",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "19:00",
        "end_time": "23:00",
        "price": "$15 (or $12 for members. Lesson is +$8 members, +$10 guests)",
        "location": "new location to be determined",
        "description": "7pm-8pm Lesson, 8pm-11pm"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Dancing for Dessert",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "20279 97 Ave #3, Langley",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "class",
        "event_name": "SwingSoul",
        "day_of_week": "Sunday",
        "start_date": "2025-06-22",
        "end_date": "2025-06-22",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "DanceVancouver Studio - 1627 W Broadway, Vancouver",
        "description": "Beginner & Intermediate West Coast Swing"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "class",
        "event_name": "Learn West Coast Swing with Michael and Amy",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-24",
        "end_date": "2025-06-24",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Famee Furlane Hall - 2605 East Pender, East Vancouver (Near PNE)",
        "description": "Beginner and Intermediate Classes"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "class",
        "event_name": "Learn West Coast Swing with Michael and Amy",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-25",
        "end_date": "2025-06-25",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Holy Trinity Ukrainian Orthodox Cathedral - 154 E 10th Ave, Vancouver",
        "description": "Beginner and Intermediate Classes"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "class",
        "event_name": "Dancing for Dessert",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "20279 97 Ave #3, Langley",
        "description": "Intermediate West Coast Swing with Inna Stetsiak"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "class",
        "event_name": "DanceFixx",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "The Evergreen Hall - 9291 Corbould St., Chilliwack",
        "description": "Beginner & Intermediate West Coast Swing"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "class",
        "event_name": "Dancing for Dessert",
        "day_of_week": "Thursday",
        "start_date": "2025-06-26",
        "end_date": "2025-06-26",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "20279 97 Ave #3, Langley",
        "description": "Introductory West Coast Swing"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "class",
        "event_name": "SwingSoul",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "16:00",
        "end_time": null,
        "price": "",
        "location": "DanceVancouver Studio - 1627 W Broadway, Vancouver",
        "description": "Beginner & Intermediate West Coast Swing"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "class",
        "event_name": "Private Lessons with Michael Shibasaki and Amy Shibasaki",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": "Teaching WCS for 15 years"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "class",
        "event_name": "Private Lessons with Gerald and Robin Cote",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": "25 Year Professional West Coast Swing Instructors"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "class",
        "event_name": "Private Lessons with Jen Malcolm",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "class",
        "event_name": "Private Lessons with Ian Kirkconnell",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "class",
        "event_name": "Private Lessons with Inna Stetsiak",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "workshop",
        "event_name": "Teacher Training: Swing Literacy Development Method (SLDM)",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": "by Myles Munroe and Tessa Cunningham Munroe"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "SwingCouver",
        "day_of_week": "",
        "start_date": "2025-01-01",
        "end_date": "2025-01-01",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Vancouver, WA",
        "description": "100% WCS, WSDC"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Rose City Swing",
        "day_of_week": "",
        "start_date": "2025-02-01",
        "end_date": "2025-02-01",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Portland, WA",
        "description": "100% WCS, WSDC"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs, salsa, bachata, line dance",
        "url": "",
        "event_type": "social dance",
        "event_name": "Seattle's Easter Swing",
        "day_of_week": "",
        "start_date": "2025-03-31",
        "end_date": "2025-03-31",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Seattle, WA",
        "description": "100% WCS, WSDC"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs, salsa, bachata, line dance",
        "url": "",
        "event_type": "social dance",
        "event_name": "Nanaimo Dance Fusion",
        "day_of_week": "",
        "start_date": "2025-05-01",
        "end_date": "2025-05-01",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Nanaimo, BC",
        "description": "WCS, Salsa, Bachata, Line Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Dance'n'Play",
        "day_of_week": "",
        "start_date": "2025-06-01",
        "end_date": "2025-06-01",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Redmond, OR",
        "description": "100% WCS, WSDC"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Retaliation Swing",
        "day_of_week": "",
        "start_date": "2025-09-01",
        "end_date": "2025-09-01",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Seattle, WA",
        "description": "100% WCS, WSDC"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Sea to Sky",
        "day_of_week": "",
        "start_date": "2025-11-01",
        "end_date": "2025-11-01",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Seattle, WA",
        "description": "100% WCS, WSDC"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "live music",
        "event_name": "Bellingham West Coast Swing",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-24",
        "end_date": "2025-06-24",
        "start_time": "19:00",
        "end_time": "21:30",
        "price": "$5",
        "location": "VFW Hall, Post 1585, at 625 N State St in Bellingham",
        "description": "Participants in the dance practices are asked to contribute 5 dollars. This and all other funds collected go towards expenses."
    }
]
2025-06-18 12:57:42 [root] INFO: def extract_and_parse_json(): for url https://bcswingdance.ca/index.php/learn-to-dance/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "The Roundhouse Experiment (Rx)",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "$15, or $70 for a ten-dances-in-a-row pass",
        "location": "181 Roundhouse Mews, Vancouver",
        "description": "100% West Coast Swing"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "SwingSoul Practice Social",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "17:00",
        "end_time": "18:30",
        "price": "$5 (free for SwingSoul students)",
        "location": "1627 W Broadway, Vancouver (at Dance Vancouver Studio)",
        "description": "100% WCS played at lower volume to facilitate practice & conversation"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "SwingSoul Dance Party",
        "day_of_week": "Sunday",
        "start_date": "2025-06-22",
        "end_date": "2025-06-22",
        "start_time": "20:00",
        "end_time": "22:30",
        "price": "$10 (free for SwingSoul students)",
        "location": "1627 W Broadway, Vancouver (at Dance Vancouver Studio)",
        "description": "100% WCS"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Club",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "19:00",
        "end_time": "23:00",
        "price": "$15 (or $12 for members. Lesson is +$8 members, +$10 guests)",
        "location": "new location to be determined",
        "description": "7pm-8pm Lesson, 8pm-11pm"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Dancing for Dessert",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "20279 97 Ave #3, Langley",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "class",
        "event_name": "SwingSoul",
        "day_of_week": "Sunday",
        "start_date": "2025-06-22",
        "end_date": "2025-06-22",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "DanceVancouver Studio - 1627 W Broadway, Vancouver",
        "description": "Beginner & Intermediate West Coast Swing"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "class",
        "event_name": "Learn West Coast Swing with Michael and Amy",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-24",
        "end_date": "2025-06-24",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Famee Furlane Hall - 2605 East Pender, East Vancouver (Near PNE)",
        "description": "Beginner and Intermediate Classes"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "class",
        "event_name": "Learn West Coast Swing with Michael and Amy",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-25",
        "end_date": "2025-06-25",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Holy Trinity Ukrainian Orthodox Cathedral - 154 E 10th Ave, Vancouver",
        "description": "Beginner and Intermediate Classes"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "class",
        "event_name": "Dancing for Dessert",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "20279 97 Ave #3, Langley",
        "description": "Intermediate West Coast Swing with Inna Stetsiak"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "class",
        "event_name": "DanceFixx",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "The Evergreen Hall - 9291 Corbould St., Chilliwack",
        "description": "Beginner & Intermediate West Coast Swing"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "class",
        "event_name": "Dancing for Dessert",
        "day_of_week": "Thursday",
        "start_date": "2025-06-26",
        "end_date": "2025-06-26",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "20279 97 Ave #3, Langley",
        "description": "Introductory West Coast Swing"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "class",
        "event_name": "SwingSoul",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "16:00",
        "end_time": null,
        "price": "",
        "location": "DanceVancouver Studio - 1627 W Broadway, Vancouver",
        "description": "Beginner & Intermediate West Coast Swing"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "class",
        "event_name": "Private Lessons with Michael Shibasaki and Amy Shibasaki",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": "Teaching WCS for 15 years"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "class",
        "event_name": "Private Lessons with Gerald and Robin Cote",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": "25 Year Professional West Coast Swing Instructors"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "class",
        "event_name": "Private Lessons with Jen Malcolm",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "class",
        "event_name": "Private Lessons with Ian Kirkconnell",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "class",
        "event_name": "Private Lessons with Inna Stetsiak",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "workshop",
        "event_name": "Teacher Training: Swing Literacy Development Method (SLDM)",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": "by Myles Munroe and Tessa Cunningham Munroe"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "SwingCouver",
        "day_of_week": "",
        "start_date": "2025-01-01",
        "end_date": "2025-01-01",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Vancouver, WA",
        "description": "100% WCS, WSDC"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Rose City Swing",
        "day_of_week": "",
        "start_date": "2025-02-01",
        "end_date": "2025-02-01",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Portland, WA",
        "description": "100% WCS, WSDC"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs, salsa, bachata, line dance",
        "url": "",
        "event_type": "social dance",
        "event_name": "Seattle's Easter Swing",
        "day_of_week": "",
        "start_date": "2025-03-31",
        "end_date": "2025-03-31",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Seattle, WA",
        "description": "100% WCS, WSDC"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs, salsa, bachata, line dance",
        "url": "",
        "event_type": "social dance",
        "event_name": "Nanaimo Dance Fusion",
        "day_of_week": "",
        "start_date": "2025-05-01",
        "end_date": "2025-05-01",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Nanaimo, BC",
        "description": "WCS, Salsa, Bachata, Line Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Dance'n'Play",
        "day_of_week": "",
        "start_date": "2025-06-01",
        "end_date": "2025-06-01",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Redmond, OR",
        "description": "100% WCS, WSDC"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Retaliation Swing",
        "day_of_week": "",
        "start_date": "2025-09-01",
        "end_date": "2025-09-01",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Seattle, WA",
        "description": "100% WCS, WSDC"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Sea to Sky",
        "day_of_week": "",
        "start_date": "2025-11-01",
        "end_date": "2025-11-01",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Seattle, WA",
        "description": "100% WCS, WSDC"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "live music",
        "event_name": "Bellingham West Coast Swing",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-24",
        "end_date": "2025-06-24",
        "start_time": "19:00",
        "end_time": "21:30",
        "price": "$5",
        "location": "VFW Hall, Post 1585, at 625 N State St in Bellingham",
        "description": "Participants in the dance practices are asked to contribute 5 dollars. This and all other funds collected go towards expenses."
    }
]
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Starting with events_df shape: (26, 14)
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Processing location '181 Roundhouse Mews, Vancouver' (event_id: None)
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Updated event None with address_id 1088 using DB match
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Processing location '1627 W Broadway, Vancouver (at Dance Vancouver Studio)' (event_id: None)
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Updated event None with address_id 1089 using DB match
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Processing location '1627 W Broadway, Vancouver (at Dance Vancouver Studio)' (event_id: None)
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Updated event None with address_id 1089 using DB match
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Processing location 'new location to be determined' (event_id: None)
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Processing location '20279 97 Ave #3, Langley' (event_id: None)
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Updated event None with address_id 4033 using DB match
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Processing location 'DanceVancouver Studio - 1627 W Broadway, Vancouver' (event_id: None)
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Updated event None with address_id 1089 using DB match
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Processing location 'Famee Furlane Hall - 2605 East Pender, East Vancouver (Near PNE)' (event_id: None)
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Updated event None with address_id 1093 using DB match
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Processing location 'Holy Trinity Ukrainian Orthodox Cathedral - 154 E 10th Ave, Vancouver' (event_id: None)
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Updated event None with address_id 1094 using DB match
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Processing location '20279 97 Ave #3, Langley' (event_id: None)
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Updated event None with address_id 4033 using DB match
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Processing location 'The Evergreen Hall - 9291 Corbould St., Chilliwack' (event_id: None)
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Updated event None with address_id 12074 using DB match
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Processing location '20279 97 Ave #3, Langley' (event_id: None)
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Updated event None with address_id 4033 using DB match
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Processing location 'DanceVancouver Studio - 1627 W Broadway, Vancouver' (event_id: None)
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Updated event None with address_id 1089 using DB match
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Processing location 'Vancouver, WA' (event_id: None)
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Processing location 'Portland, WA' (event_id: None)
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Processing location 'Seattle, WA' (event_id: None)
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Processing location 'Nanaimo, BC' (event_id: None)
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Processing location 'Redmond, OR' (event_id: None)
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Processing location 'Seattle, WA' (event_id: None)
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Processing location 'Seattle, WA' (event_id: None)
2025-06-18 12:57:42 [root] INFO: def clean_up_address(): Processing location 'VFW Hall, Post 1585, at 625 N State St in Bellingham' (event_id: None)
2025-06-18 12:57:42 [py.warnings] WARNING: /mnt/d/GitHub/social_dance_app/src/db.py:730: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  cleaned_df['end_date'] = pd.to_datetime(cleaned_df['end_date'], errors='coerce')

2025-06-18 12:57:42 [root] INFO: write_events_to_db: Number of events to write: 26
2025-06-18 12:57:42 [root] INFO: write_url_to_db(): appended URL 'https://bcswingdance.ca/index.php/learn-to-dance/'
2025-06-18 12:57:42 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:57:42 [root] INFO: def process_llm_response: URL https://bcswingdance.ca/index.php/learn-to-dance/ marked as relevant with events written to the database.
2025-06-18 12:57:42 [root] INFO: write_url_to_db(): appended URL 'https://bcswingdance.ca/index.php/learn-to-dance/'
2025-06-18 12:57:42 [root] INFO: def parse(): URL https://bcswingdance.ca/index.php/learn-to-dance/ marked as relevant (LLM positive).
2025-06-18 12:57:42 [root] INFO: def parse(): Found 10 links on https://bcswingdance.ca/index.php/learn-to-dance/
2025-06-18 12:57:42 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.youtube.com/embed/RWO_bFvs_8o?si=77--jELHiwaZSoQ8, URL: https://bcswingdance.ca/index.php/learn-to-dance/, source: WCS Lessons, Social Dances, and Conventions – BC Swing Dance ..., keywords: east coast swing
2025-06-18 12:57:42 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: 2nm(mEc<
2025-06-18 12:57:42 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.youtube.com/embed/RWO_bFvs_8o?si=77--jELHiwaZSoQ8
2025-06-18 12:57:42 [root] INFO: write_url_to_db(): appended URL 'https://www.youtube.com/embed/RWO_bFvs_8o?si=77--jELHiwaZSoQ8'
2025-06-18 12:57:42 [root] INFO: should_process_url: URL https://bcswingdance.ca/ was last seen as relevant, processing it.
2025-06-18 12:57:42 [root] INFO: should_process_url: URL https://bcswingdance.ca/ was last seen as relevant, processing it.
2025-06-18 12:57:42 [root] INFO: write_url_to_db(): appended URL 'https://bcswingdance.ca/'
2025-06-18 12:57:42 [root] INFO: def parse(): Crawling next URL: https://bcswingdance.ca/
2025-06-18 12:57:42 [root] INFO: write_url_to_db(): appended URL 'https://allevents.in/victoria/technique-and-milonga-with-monica-parra/200028343998001'
2025-06-18 12:57:42 [root] INFO: def parse(): URL https://allevents.in/victoria/technique-and-milonga-with-monica-parra/200028343998001 marked as irrelevant (no keywords).
2025-06-18 12:57:42 [root] INFO: def parse(): Found 0 links on https://allevents.in/victoria/technique-and-milonga-with-monica-parra/200028343998001
2025-06-18 12:57:42 [root] INFO: should_process_url: URL https://allevents.in/victoria/technique-and-milonga-with-monica-parra/200028343998001 has never been seen before, processing it.
2025-06-18 12:57:42 [root] INFO: should_process_url: URL https://allevents.in/victoria/technique-and-milonga-with-monica-parra/200028343998001 has never been seen before, processing it.
2025-06-18 12:57:42 [root] INFO: write_url_to_db(): appended URL 'https://allevents.in/victoria/technique-and-milonga-with-monica-parra/200028343998001'
2025-06-18 12:57:42 [root] INFO: def parse(): Crawling next URL: https://allevents.in/victoria/technique-and-milonga-with-monica-parra/200028343998001
2025-06-18 12:57:42 [scrapy.extensions.logstats] INFO: Crawled 37 pages (at 5 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 12:57:42 [root] INFO: should_process_url: URL https://dancevictoria.com/learn/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:57:42 [root] INFO: should_process_url: URL https://dancevictoria.com/performances/tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:57:42 [root] INFO: should_process_url: URL https://vimeo.com/dancevictoria was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:57:42 [root] INFO: should_process_url: URL https://dancevictoria.com/calendar/ was last seen as relevant, processing it.
2025-06-18 12:57:42 [root] INFO: should_process_url: URL https://dancevictoria.com/learn/news/ was last seen as relevant, processing it.
2025-06-18 12:57:42 [root] INFO: should_process_url: URL https://dancevictoria.com/ was last seen as not relevant but hit_ratio (0.33) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:57:42 [root] INFO: should_process_url: URL https://dancevictoria.com/support/donate/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:57:42 [root] INFO: should_process_url: URL https://dancevictoria.com/season-trailer/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:57:42 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/current-board-of-directors/ was last seen as relevant, processing it.
2025-06-18 12:57:42 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/current-board-of-directors/ was last seen as relevant, processing it.
2025-06-18 12:57:42 [root] INFO: write_url_to_db(): appended URL 'https://bcswingdance.ca/index.php/current-board-of-directors/'
2025-06-18 12:57:42 [root] INFO: def parse(): Crawling next URL: https://bcswingdance.ca/index.php/current-board-of-directors/
2025-06-18 12:57:42 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/make-the-club-great/ was last seen as relevant, processing it.
2025-06-18 12:57:42 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/make-the-club-great/ was last seen as relevant, processing it.
2025-06-18 12:57:42 [root] INFO: write_url_to_db(): appended URL 'https://bcswingdance.ca/index.php/make-the-club-great/'
2025-06-18 12:57:42 [root] INFO: def parse(): Crawling next URL: https://bcswingdance.ca/index.php/make-the-club-great/
2025-06-18 12:57:42 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/history/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:57:42 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/history/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:57:42 [root] INFO: write_url_to_db(): appended URL 'https://bcswingdance.ca/index.php/history/'
2025-06-18 12:57:42 [root] INFO: def parse(): Crawling next URL: https://bcswingdance.ca/index.php/history/
2025-06-18 12:57:42 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/documents/ was last seen as relevant, processing it.
2025-06-18 12:57:42 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/documents/ was last seen as relevant, processing it.
2025-06-18 12:57:42 [root] INFO: write_url_to_db(): appended URL 'https://bcswingdance.ca/index.php/documents/'
2025-06-18 12:57:42 [root] INFO: def parse(): Crawling next URL: https://bcswingdance.ca/index.php/documents/
2025-06-18 12:57:42 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/learn-to-dance/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:57:42 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/learn-to-dance/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 12:57:42 [root] INFO: write_url_to_db(): appended URL 'https://bcswingdance.ca/index.php/learn-to-dance/'
2025-06-18 12:57:42 [root] INFO: def parse(): Crawling next URL: https://bcswingdance.ca/index.php/learn-to-dance/
2025-06-18 12:57:42 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/board-minutes/ was last seen as relevant, processing it.
2025-06-18 12:57:42 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/board-minutes/ was last seen as relevant, processing it.
2025-06-18 12:57:42 [root] INFO: write_url_to_db(): appended URL 'https://bcswingdance.ca/index.php/board-minutes/'
2025-06-18 12:57:42 [root] INFO: def parse(): Crawling next URL: https://bcswingdance.ca/index.php/board-minutes/
2025-06-18 12:57:42 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/about-the-bc-swing-dance-club/ was last seen as relevant, processing it.
2025-06-18 12:57:42 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/about-the-bc-swing-dance-club/ was last seen as relevant, processing it.
2025-06-18 12:57:42 [root] INFO: write_url_to_db(): appended URL 'https://bcswingdance.ca/index.php/about-the-bc-swing-dance-club/'
2025-06-18 12:57:42 [root] INFO: def parse(): Crawling next URL: https://bcswingdance.ca/index.php/about-the-bc-swing-dance-club/
2025-06-18 12:57:42 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/membership/ was last seen as relevant, processing it.
2025-06-18 12:57:42 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/membership/ was last seen as relevant, processing it.
2025-06-18 12:57:42 [root] INFO: write_url_to_db(): appended URL 'https://bcswingdance.ca/index.php/membership/'
2025-06-18 12:57:42 [root] INFO: def parse(): Crawling next URL: https://bcswingdance.ca/index.php/membership/
2025-06-18 12:57:42 [root] INFO: should_process_url: URL http://bcswingdance.ca was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:57:42 [root] INFO: should_process_url: URL http://bcswingdance.ca was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:57:42 [root] INFO: write_url_to_db(): appended URL 'http://bcswingdance.ca'
2025-06-18 12:57:42 [root] INFO: def parse(): Crawling next URL: http://bcswingdance.ca
2025-06-18 12:57:42 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <406 https://dancehouse.ca/event/videla/>: HTTP status code is not handled or not allowed
2025-06-18 12:57:42 [root] INFO: def parse(): Found keywords for URL https://victoriasymphony.ca/: ['dance']
2025-06-18 12:57:42 [root] INFO: def generate_prompt(): Generating prompt for URL: https://victoriasymphony.ca/
2025-06-18 12:57:42 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 12:57:42 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 12:57:42 [root] INFO: query_llm(): Querying Mistral
2025-06-18 13:12:43 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 504 Gateway Timeout"
2025-06-18 13:12:43 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 504
{
  "message":"The upstream server is timing out",
  "request_id":"a8d30d24d00fee7228fb991f14cbd905"
}
2025-06-18 13:12:43 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 13:14:51 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:14:51 [root] INFO: query_llm(): OpenAI response received: [{
    "source": "Victoria Symphony",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "VS and Pacific Opera Victoria at The Butchart Gardens",
    "day_of_week": "Thursday",
    "start_date": "2025-07-24",
    "end_date": "2025-07-24",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "The Butchart Gardens",
    "description": "A signature musical event of the summer! Led by Maestro Giuseppe Pietraroia, Principal Conductor of Pacific Opera Victoria, the Victoria Symphony performs at The Butchart Gardens alongside soprano Lau..."
},
{
    "source": "Victoria Symphony",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "VS at Christ Church Cathedral",
    "day_of_week": "Friday",
    "start_date": "2025-07-25",
    "end_date": "2025-07-25",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Christ Church Cathedral",
    "description": "Join us for an evening of classical charm and lyrical beauty at Victoria’s majestic Christ Church Cathedral! Led by Maestro Giuseppe Pietraroia, the evening opens with Mozart’s Overture to The..."
},
{
    "source": "Victoria Symphony",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "VS at Qualicum Beach",
    "day_of_week": "Sunday",
    "start_date": "2025-07-27",
    "end_date": "2025-07-27",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Qualicum Beach",
    "description": "VS returns to Qualicum Beach for an evening of classical charm and lyrical beauty! Led by Maestro Giuseppe Pietraroia, the evening opens with Mozart’s Overture to The Magic Flute, a..."
},
{
    "source": "Victoria Symphony",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "The National Youth Orchestra of Canada (Christ Church Cathed...",
    "day_of_week": "Friday",
    "start_date": "2025-08-01",
    "end_date": "2025-08-01",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Christ Church Cathedral",
    "description": "Celebrate 65 incredible years of music with NYO Canada! Led by acclaimed Music Director Naomi Woo, this one-night only anniversary performance transforms Victoria’s Christ Church Cathedral into a sp..."
},
{
    "source": "Victoria Symphony",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Celeigh Cardinal & Shawnee Kish with The National Youth...",
    "day_of_week": "Saturday",
    "start_date": "2025-08-02",
    "end_date": "2025-08-02",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "Two powerhouse voices. One unforgettable afternoon by the water. JUNO-nominated singer-songwriters Celeigh Cardinal and Shawnee Kish join forces with The National Youth Orchestra of Canada for a genre..."
},
{
    "source": "Victoria Symphony",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Latin Nights with Sal Ferreras Ft. Adonis Puentes with the V...",
    "day_of_week": "Saturday",
    "start_date": "2025-08-02",
    "end_date": "2025-08-02",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "They say Latin America’s greatest contribution to the world is joy. Sal Ferreras’ Latin Jazz Sextet with vocalist Adonis Puentes join forces with the Victoria Symphony for an unforgettable evening..."
},
{
    "source": "Victoria Symphony",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "The National Youth Orchestra of Canada (SPLASH!)",
    "day_of_week": "Sunday",
    "start_date": "2025-08-03",
    "end_date": "2025-08-03",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "An afternoon of intensity and beauty from the country’s most promising orchestral musicians. In this sweeping 40-minute performance, The National Youth Orchestra of Canada, under the baton of Naomi ..."
},
{
    "source": "Victoria Symphony",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Traditional Symphony SPLASH!",
    "day_of_week": "Sunday",
    "start_date": "2025-08-03",
    "end_date": "2025-08-03",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "The evening you’ve been waiting for is finally here—half a decade later! Victoria’s iconic night of symphonic music returns to a floating barge in the Inner Harbour. Led by VS..."
}]
2025-06-18 13:14:51 [root] INFO: def extract_and_parse_json(): for url https://victoriasymphony.ca/, 
Cleaned JSON ready for parsing:
[{
    "source": "Victoria Symphony",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "VS and Pacific Opera Victoria at The Butchart Gardens",
    "day_of_week": "Thursday",
    "start_date": "2025-07-24",
    "end_date": "2025-07-24",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "The Butchart Gardens",
    "description": "A signature musical event of the summer! Led by Maestro Giuseppe Pietraroia, Principal Conductor of Pacific Opera Victoria, the Victoria Symphony performs at The Butchart Gardens alongside soprano Lau"
},
{
    "source": "Victoria Symphony",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "VS at Christ Church Cathedral",
    "day_of_week": "Friday",
    "start_date": "2025-07-25",
    "end_date": "2025-07-25",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Christ Church Cathedral",
    "description": "Join us for an evening of classical charm and lyrical beauty at Victoria’s majestic Christ Church Cathedral! Led by Maestro Giuseppe Pietraroia, the evening opens with Mozart’s Overture to The"
},
{
    "source": "Victoria Symphony",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "VS at Qualicum Beach",
    "day_of_week": "Sunday",
    "start_date": "2025-07-27",
    "end_date": "2025-07-27",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Qualicum Beach",
    "description": "VS returns to Qualicum Beach for an evening of classical charm and lyrical beauty! Led by Maestro Giuseppe Pietraroia, the evening opens with Mozart’s Overture to The Magic Flute, a"
},
{
    "source": "Victoria Symphony",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "The National Youth Orchestra of Canada (Christ Church Cathed",
    "day_of_week": "Friday",
    "start_date": "2025-08-01",
    "end_date": "2025-08-01",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Christ Church Cathedral",
    "description": "Celebrate 65 incredible years of music with NYO Canada! Led by acclaimed Music Director Naomi Woo, this one-night only anniversary performance transforms Victoria’s Christ Church Cathedral into a sp"
},
{
    "source": "Victoria Symphony",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Celeigh Cardinal & Shawnee Kish with The National Youth",
    "day_of_week": "Saturday",
    "start_date": "2025-08-02",
    "end_date": "2025-08-02",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "Two powerhouse voices. One unforgettable afternoon by the water. JUNO-nominated singer-songwriters Celeigh Cardinal and Shawnee Kish join forces with The National Youth Orchestra of Canada for a genre"
},
{
    "source": "Victoria Symphony",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Latin Nights with Sal Ferreras Ft. Adonis Puentes with the V",
    "day_of_week": "Saturday",
    "start_date": "2025-08-02",
    "end_date": "2025-08-02",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "They say Latin America’s greatest contribution to the world is joy. Sal Ferreras’ Latin Jazz Sextet with vocalist Adonis Puentes join forces with the Victoria Symphony for an unforgettable evening"
},
{
    "source": "Victoria Symphony",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "The National Youth Orchestra of Canada (SPLASH!)",
    "day_of_week": "Sunday",
    "start_date": "2025-08-03",
    "end_date": "2025-08-03",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "An afternoon of intensity and beauty from the country’s most promising orchestral musicians. In this sweeping 40-minute performance, The National Youth Orchestra of Canada, under the baton of Naomi "
},
{
    "source": "Victoria Symphony",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Traditional Symphony SPLASH!",
    "day_of_week": "Sunday",
    "start_date": "2025-08-03",
    "end_date": "2025-08-03",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "The evening you’ve been waiting for is finally here—half a decade later! Victoria’s iconic night of symphonic music returns to a floating barge in the Inner Harbour. Led by VS"
}]
2025-06-18 13:14:51 [root] INFO: def clean_up_address(): Starting with events_df shape: (8, 14)
2025-06-18 13:14:51 [root] INFO: def clean_up_address(): Processing location 'The Butchart Gardens' (event_id: None)
2025-06-18 13:14:51 [root] INFO: def clean_up_address(): Processing location 'Christ Church Cathedral' (event_id: None)
2025-06-18 13:14:51 [root] INFO: def clean_up_address(): Processing location 'Qualicum Beach' (event_id: None)
2025-06-18 13:14:51 [root] INFO: def clean_up_address(): Processing location 'Christ Church Cathedral' (event_id: None)
2025-06-18 13:14:51 [root] INFO: write_events_to_db: Number of events to write: 8
2025-06-18 13:14:51 [root] INFO: write_url_to_db(): appended URL 'https://victoriasymphony.ca/'
2025-06-18 13:14:51 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:14:51 [root] INFO: def process_llm_response: URL https://victoriasymphony.ca/ marked as relevant with events written to the database.
2025-06-18 13:14:51 [root] INFO: write_url_to_db(): appended URL 'https://victoriasymphony.ca/'
2025-06-18 13:14:51 [root] INFO: def parse(): URL https://victoriasymphony.ca/ marked as relevant (LLM positive).
2025-06-18 13:14:51 [root] INFO: def parse(): Found 10 links on https://victoriasymphony.ca/
2025-06-18 13:14:51 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5RJF5B3, URL: https://victoriasymphony.ca/, source: Victoria Symphony: Home, keywords: outdoor music
2025-06-18 13:14:51 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 13:14:51 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5RJF5B3
2025-06-18 13:14:51 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-5RJF5B3'
2025-06-18 13:14:51 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/vicsymphony/'
2025-06-18 13:14:51 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/vicsymphony/
2025-06-18 13:14:51 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/vicsymphony'
2025-06-18 13:14:51 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/vicsymphony
2025-06-18 13:14:51 [root] INFO: should_process_url: URL https://victoriasymphony.ca/contact-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:14:51 [root] INFO: should_process_url: URL https://victoriasymphony.ca/contact-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:14:51 [root] INFO: write_url_to_db(): appended URL 'https://victoriasymphony.ca/contact-us/'
2025-06-18 13:14:51 [root] INFO: def parse(): Crawling next URL: https://victoriasymphony.ca/contact-us/
2025-06-18 13:14:51 [root] INFO: def parse(): Found keywords for URL https://thedancestudiofinder.com/dance-studios/categories/quickstep/: ['argentine tango', 'bachata', 'balboa', 'cha cha', 'dance', 'east coast swing', 'foxtrot', 'kizomba', 'lindy hop', 'line dance', 'merengue', 'milonga', 'quickstep', 'rumba', 'salsa', 'samba', 'swing', 'tango', 'two step', 'waltz', 'west coast swing', 'zouk']
2025-06-18 13:14:51 [root] INFO: def generate_prompt(): Generating prompt for URL: https://thedancestudiofinder.com/dance-studios/categories/quickstep/
2025-06-18 13:14:51 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 13:14:51 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 13:14:51 [root] INFO: query_llm(): Querying Mistral
2025-06-18 13:14:52 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 13:14:52 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 167266 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 13:14:52 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 13:15:03 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:15:03 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 13:15:03 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 13:15:03 [root] INFO: write_url_to_db(): appended URL 'https://thedancestudiofinder.com/dance-studios/categories/quickstep/'
2025-06-18 13:15:03 [root] INFO: def parse(): URL https://thedancestudiofinder.com/dance-studios/categories/quickstep/ marked as irrelevant (LLM negative).
2025-06-18 13:15:03 [root] INFO: def parse(): Found 10 links on https://thedancestudiofinder.com/dance-studios/categories/quickstep/
2025-06-18 13:15:03 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/dance-studios/categories/quickstep/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:15:03 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/dance-studios/categories/quickstep/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:15:03 [root] INFO: write_url_to_db(): appended URL 'https://thedancestudiofinder.com/dance-studios/categories/quickstep/'
2025-06-18 13:15:03 [root] INFO: def parse(): Crawling next URL: https://thedancestudiofinder.com/dance-studios/categories/quickstep/
2025-06-18 13:15:03 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/summer-entertainment-calendar/'
2025-06-18 13:15:03 [root] INFO: def parse(): URL https://butchartgardens.com/summer-entertainment-calendar/ marked as irrelevant (no keywords).
2025-06-18 13:15:03 [root] INFO: def parse(): Found 10 links on https://butchartgardens.com/summer-entertainment-calendar/
2025-06-18 13:15:03 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/mediterranean-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:15:03 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/mediterranean-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:15:03 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/garden/mediterranean-garden/'
2025-06-18 13:15:03 [root] INFO: def parse(): Crawling next URL: https://butchartgardens.com/garden/mediterranean-garden/
2025-06-18 13:15:03 [root] INFO: def parse(): Found keywords for URL https://www.facebook.com/groups/169950979714465/: ['dance']
2025-06-18 13:15:03 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.facebook.com/groups/169950979714465/
2025-06-18 13:15:03 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 13:15:03 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 13:15:03 [root] INFO: query_llm(): Querying Mistral
2025-06-18 13:15:09 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:15:09 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 13:15:09 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 13:15:09 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/169950979714465/'
2025-06-18 13:15:09 [root] INFO: def parse(): URL https://www.facebook.com/groups/169950979714465/ marked as irrelevant (LLM negative).
2025-06-18 13:15:09 [root] INFO: def parse(): Found 10 links on https://www.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F169950979714465%2F
2025-06-18 13:15:09 [root] INFO: write_url_to_db(): appended URL 'https://es-la.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F169950979714465%2F'
2025-06-18 13:15:09 [root] INFO: def parse(): Recorded unwanted URL: https://es-la.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F169950979714465%2F
2025-06-18 13:15:09 [root] INFO: write_url_to_db(): appended URL 'https://ko-kr.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F169950979714465%2F'
2025-06-18 13:15:09 [root] INFO: def parse(): Recorded unwanted URL: https://ko-kr.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F169950979714465%2F
2025-06-18 13:15:09 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/169950979714465/'
2025-06-18 13:15:09 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/groups/169950979714465/
2025-06-18 13:15:09 [root] INFO: write_url_to_db(): appended URL 'https://ja-jp.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F169950979714465%2F'
2025-06-18 13:15:09 [root] INFO: def parse(): Recorded unwanted URL: https://ja-jp.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F169950979714465%2F
2025-06-18 13:15:09 [root] INFO: write_url_to_db(): appended URL 'https://fr-ca.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F169950979714465%2F'
2025-06-18 13:15:09 [root] INFO: def parse(): Recorded unwanted URL: https://fr-ca.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F169950979714465%2F
2025-06-18 13:15:09 [root] INFO: write_url_to_db(): appended URL 'https://zh-cn.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F169950979714465%2F'
2025-06-18 13:15:09 [root] INFO: def parse(): Recorded unwanted URL: https://zh-cn.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F169950979714465%2F
2025-06-18 13:15:09 [root] INFO: write_url_to_db(): appended URL 'https://de-de.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F169950979714465%2F'
2025-06-18 13:15:09 [root] INFO: def parse(): Recorded unwanted URL: https://de-de.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F169950979714465%2F
2025-06-18 13:15:09 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/recover/initiate/?ars=facebook_login&cancel_lara_pswd=0&next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F169950979714465%2F'
2025-06-18 13:15:09 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/recover/initiate/?ars=facebook_login&cancel_lara_pswd=0&next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F169950979714465%2F
2025-06-18 13:15:09 [root] INFO: write_url_to_db(): appended URL 'https://pt-br.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F169950979714465%2F'
2025-06-18 13:15:09 [root] INFO: def parse(): Recorded unwanted URL: https://pt-br.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F169950979714465%2F
2025-06-18 13:15:09 [root] INFO: write_url_to_db(): appended URL 'https://it-it.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F169950979714465%2F'
2025-06-18 13:15:09 [root] INFO: def parse(): Recorded unwanted URL: https://it-it.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F169950979714465%2F
2025-06-18 13:15:09 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F169950979714465%2F'
2025-06-18 13:15:09 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/login/?next=https%3A%2F%2Fwww.facebook.com%2Fgroups%2F169950979714465%2F
2025-06-18 13:15:09 [scrapy.extensions.logstats] INFO: Crawled 41 pages (at 4 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 13:15:09 [root] INFO: should_process_url: URL https://victoriasymphony.ca/support/donations/how-to-donate/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:15:09 [root] INFO: should_process_url: URL https://victoriasymphony.ca/support/donations/how-to-donate/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:15:09 [root] INFO: write_url_to_db(): appended URL 'https://victoriasymphony.ca/support/donations/how-to-donate/'
2025-06-18 13:15:09 [root] INFO: def parse(): Crawling next URL: https://victoriasymphony.ca/support/donations/how-to-donate/
2025-06-18 13:15:09 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/contact-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:15:09 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/contact-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:15:09 [root] INFO: write_url_to_db(): appended URL 'https://thedancestudiofinder.com/contact-us/'
2025-06-18 13:15:09 [root] INFO: def parse(): Crawling next URL: https://thedancestudiofinder.com/contact-us/
2025-06-18 13:15:09 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/sunken-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:15:09 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/sunken-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:15:09 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/garden/sunken-garden/'
2025-06-18 13:15:09 [root] INFO: def parse(): Crawling next URL: https://butchartgardens.com/garden/sunken-garden/
2025-06-18 13:15:09 [root] INFO: should_process_url: URL https://victoriasymphony.ca/concerts-events/#concertseries was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:15:09 [root] INFO: should_process_url: URL https://victoriasymphony.ca/concerts-events/#concertseries was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:15:09 [root] INFO: write_url_to_db(): appended URL 'https://victoriasymphony.ca/concerts-events/#concertseries'
2025-06-18 13:15:09 [root] INFO: def parse(): Crawling next URL: https://victoriasymphony.ca/concerts-events/#concertseries
2025-06-18 13:15:09 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/blog/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:15:09 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/blog/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:15:09 [root] INFO: write_url_to_db(): appended URL 'https://thedancestudiofinder.com/blog/'
2025-06-18 13:15:09 [root] INFO: def parse(): Crawling next URL: https://thedancestudiofinder.com/blog/
2025-06-18 13:15:09 [root] INFO: should_process_url: URL https://butchartgardens.com/summer-entertainment-calendar/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:15:09 [root] INFO: should_process_url: URL https://butchartgardens.com/summer-entertainment-calendar/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:15:09 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/summer-entertainment-calendar/'
2025-06-18 13:15:09 [root] INFO: def parse(): Crawling next URL: https://butchartgardens.com/summer-entertainment-calendar/
2025-06-18 13:15:09 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <403 https://www.pgatour.com/americas/article/news/latest/2024/06/18/field-set-for-first-event-of-north-america-swing-the-beachlands-victoria-open-presented-by-times-colonist>: HTTP status code is not handled or not allowed
2025-06-18 13:15:09 [root] INFO: should_process_url: URL https://victoriasymphony.ca/concerts-events/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:15:09 [root] INFO: should_process_url: URL https://victoriasymphony.ca/concerts-events/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:15:09 [root] INFO: write_url_to_db(): appended URL 'https://victoriasymphony.ca/concerts-events/'
2025-06-18 13:15:09 [root] INFO: def parse(): Crawling next URL: https://victoriasymphony.ca/concerts-events/
2025-06-18 13:15:09 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/my-account/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:15:09 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/my-account/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:15:09 [root] INFO: write_url_to_db(): appended URL 'https://thedancestudiofinder.com/my-account/'
2025-06-18 13:15:09 [root] INFO: def parse(): Crawling next URL: https://thedancestudiofinder.com/my-account/
2025-06-18 13:15:09 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/italian-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:15:09 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/italian-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:15:09 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/garden/italian-garden/'
2025-06-18 13:15:09 [root] INFO: def parse(): Crawling next URL: https://butchartgardens.com/garden/italian-garden/
2025-06-18 13:15:09 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/VicSymphony.
2025-06-18 13:15:09 [root] INFO: should_process_url: URL https://victoriasymphony.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:15:09 [root] INFO: should_process_url: URL https://victoriasymphony.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:15:09 [root] INFO: write_url_to_db(): appended URL 'https://victoriasymphony.ca/'
2025-06-18 13:15:09 [root] INFO: def parse(): Crawling next URL: https://victoriasymphony.ca/
2025-06-18 13:15:09 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/join/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:15:09 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/join/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:15:09 [root] INFO: write_url_to_db(): appended URL 'https://thedancestudiofinder.com/join/'
2025-06-18 13:15:09 [root] INFO: def parse(): Crawling next URL: https://thedancestudiofinder.com/join/
2025-06-18 13:15:09 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/rose-garden/ was last seen as relevant, processing it.
2025-06-18 13:15:09 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/rose-garden/ was last seen as relevant, processing it.
2025-06-18 13:15:09 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/garden/rose-garden/'
2025-06-18 13:15:10 [root] INFO: def parse(): Crawling next URL: https://butchartgardens.com/garden/rose-garden/
2025-06-18 13:15:10 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/user/VictoriaSymphony.
2025-06-18 13:15:10 [root] INFO: should_process_url: URL https://victoriasymphony.ca/cart/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:15:10 [root] INFO: should_process_url: URL https://victoriasymphony.ca/cart/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:15:10 [root] INFO: write_url_to_db(): appended URL 'https://victoriasymphony.ca/cart/'
2025-06-18 13:15:10 [root] INFO: def parse(): Crawling next URL: https://victoriasymphony.ca/cart/
2025-06-18 13:15:10 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:15:10 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:15:10 [root] INFO: write_url_to_db(): appended URL 'https://thedancestudiofinder.com/'
2025-06-18 13:15:10 [root] INFO: def parse(): Crawling next URL: https://thedancestudiofinder.com/
2025-06-18 13:15:10 [root] INFO: should_process_url: URL https://butchartgardens.com/how-to-get-here/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:15:10 [root] INFO: should_process_url: URL https://butchartgardens.com/how-to-get-here/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:15:10 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/how-to-get-here/'
2025-06-18 13:15:10 [root] INFO: def parse(): Crawling next URL: https://butchartgardens.com/how-to-get-here/
2025-06-18 13:15:10 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/about-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:15:10 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/about-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:15:10 [root] INFO: write_url_to_db(): appended URL 'https://thedancestudiofinder.com/about-us/'
2025-06-18 13:15:10 [root] INFO: def parse(): Crawling next URL: https://thedancestudiofinder.com/about-us/
2025-06-18 13:15:10 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/japanese-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:15:10 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/japanese-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:15:10 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/garden/japanese-garden/'
2025-06-18 13:15:10 [root] INFO: def parse(): Crawling next URL: https://butchartgardens.com/garden/japanese-garden/
2025-06-18 13:15:10 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/dance-studios/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:15:10 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/dance-studios/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:15:10 [root] INFO: write_url_to_db(): appended URL 'https://thedancestudiofinder.com/dance-studios/'
2025-06-18 13:15:10 [root] INFO: def parse(): Crawling next URL: https://thedancestudiofinder.com/dance-studios/
2025-06-18 13:15:10 [root] INFO: should_process_url: URL https://tickets.butchartgardens.com/WebStore/shop/viewItems.aspx?cg=tt&c=DAtt was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:15:10 [root] INFO: should_process_url: URL https://tickets.butchartgardens.com/WebStore/shop/viewItems.aspx?cg=tt&c=DAtt was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:15:10 [root] INFO: write_url_to_db(): appended URL 'https://tickets.butchartgardens.com/WebStore/shop/viewItems.aspx?cg=tt&c=DAtt'
2025-06-18 13:15:10 [root] INFO: def parse(): Crawling next URL: https://tickets.butchartgardens.com/WebStore/shop/viewItems.aspx?cg=tt&c=DAtt
2025-06-18 13:15:10 [root] INFO: should_process_url: URL https://butchartgardens.com/hours-rates/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:15:10 [root] INFO: should_process_url: URL https://butchartgardens.com/hours-rates/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:15:10 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/hours-rates/'
2025-06-18 13:15:10 [root] INFO: def parse(): Crawling next URL: https://butchartgardens.com/hours-rates/
2025-06-18 13:15:10 [root] INFO: should_process_url: URL https://butchartgardens.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:15:10 [root] INFO: should_process_url: URL https://butchartgardens.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:15:10 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/'
2025-06-18 13:15:10 [root] INFO: def parse(): Crawling next URL: https://butchartgardens.com/
2025-06-18 13:15:10 [root] INFO: def parse(): Found keywords for URL https://dancevictoria.com/performance/malpaso/: ['dance', 'waltz']
2025-06-18 13:15:10 [root] INFO: def generate_prompt(): Generating prompt for URL: https://dancevictoria.com/performance/malpaso/
2025-06-18 13:15:10 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 13:15:10 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 13:15:10 [root] INFO: query_llm(): Querying Mistral
2025-06-18 13:16:12 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:16:12 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "Dance Victoria Calendar",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Malpaso Dance Company",
        "day_of_week": "Friday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "19:30",
        "end_time": "21:07",
        "price": "free",
        "location": "Dance Victoria Studios, 2750 Quadra St (north entrance), Victoria, BC V8T 4E8",
        "description": "Please join us in the theatre lobby (Blanshard St. side) for a free pre-show chat at 6:50 p.m. with Dr. Allana Lindgren. Dr. Lindgren will chat with Fernando Sáez, Executive Director and Co-Founder of Malpaso, about the company and the contemporary works that you will experience in the mixed repertoire program."
    },
    {
        "source": "Dance Victoria Calendar",
        "dance_style": "contemporary",
        "url": "",
        "event_type": "other",
        "event_name": "Malpaso Dance Company",
        "day_of_week": "Saturday",
        "start_date": "2023-04-28",
        "end_date": "2023-04-28",
        "start_time": "19:30",
        "end_time": null,
        "price": "",
        "location": "Royal Theatre, 805 Broughton St, Victoria, BC",
        "description": "Malpaso Dance Company has become one of the most sought-after Cuban dance companies with a growing international profile. Committed to collaborating with top international choreographers and nurturing new voices in Cuban choreography, the company brings a diverse program that lays contemporary dance atop intentional storytelling to create an engrossing evening of exceptional dance."
    },
    {
        "source": "Dance Victoria Calendar",
        "dance_style": "contemporary",
        "url": "",
        "event_type": "other",
        "event_name": "Malpaso Dance Company",
        "day_of_week": "Saturday",
        "start_date": "2023-04-29",
        "end_date": "2023-04-29",
        "start_time": "19:30",
        "end_time": null,
        "price": "",
        "location": "Royal Theatre, 805 Broughton St, Victoria, BC",
        "description": "Malpaso Dance Company has become one of the most sought-after Cuban dance companies with a growing international profile. Committed to collaborating with top international choreographers and nurturing new voices in Cuban choreography, the company brings a diverse program that lays contemporary dance atop intentional storytelling to create an engrossing evening of exceptional dance."
    }
]
2025-06-18 13:16:12 [root] INFO: def extract_and_parse_json(): for url https://dancevictoria.com/performance/malpaso/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Dance Victoria Calendar",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Malpaso Dance Company",
        "day_of_week": "Friday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "19:30",
        "end_time": "21:07",
        "price": "free",
        "location": "Dance Victoria Studios, 2750 Quadra St (north entrance), Victoria, BC V8T 4E8",
        "description": "Please join us in the theatre lobby (Blanshard St. side) for a free pre-show chat at 6:50 p.m. with Dr. Allana Lindgren. Dr. Lindgren will chat with Fernando Sáez, Executive Director and Co-Founder of Malpaso, about the company and the contemporary works that you will experience in the mixed repertoire program."
    },
    {
        "source": "Dance Victoria Calendar",
        "dance_style": "contemporary",
        "url": "",
        "event_type": "other",
        "event_name": "Malpaso Dance Company",
        "day_of_week": "Saturday",
        "start_date": "2023-04-28",
        "end_date": "2023-04-28",
        "start_time": "19:30",
        "end_time": null,
        "price": "",
        "location": "Royal Theatre, 805 Broughton St, Victoria, BC",
        "description": "Malpaso Dance Company has become one of the most sought-after Cuban dance companies with a growing international profile. Committed to collaborating with top international choreographers and nurturing new voices in Cuban choreography, the company brings a diverse program that lays contemporary dance atop intentional storytelling to create an engrossing evening of exceptional dance."
    },
    {
        "source": "Dance Victoria Calendar",
        "dance_style": "contemporary",
        "url": "",
        "event_type": "other",
        "event_name": "Malpaso Dance Company",
        "day_of_week": "Saturday",
        "start_date": "2023-04-29",
        "end_date": "2023-04-29",
        "start_time": "19:30",
        "end_time": null,
        "price": "",
        "location": "Royal Theatre, 805 Broughton St, Victoria, BC",
        "description": "Malpaso Dance Company has become one of the most sought-after Cuban dance companies with a growing international profile. Committed to collaborating with top international choreographers and nurturing new voices in Cuban choreography, the company brings a diverse program that lays contemporary dance atop intentional storytelling to create an engrossing evening of exceptional dance."
    }
]
2025-06-18 13:16:12 [root] INFO: def clean_up_address(): Starting with events_df shape: (3, 14)
2025-06-18 13:16:12 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria Studios, 2750 Quadra St (north entrance), Victoria, BC V8T 4E8' (event_id: None)
2025-06-18 13:16:12 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 13:16:12 [root] INFO: def clean_up_address(): Processing location 'Royal Theatre, 805 Broughton St, Victoria, BC' (event_id: None)
2025-06-18 13:16:12 [root] INFO: def clean_up_address(): Updated event None with address_id 3446 using DB match
2025-06-18 13:16:12 [root] INFO: def clean_up_address(): Processing location 'Royal Theatre, 805 Broughton St, Victoria, BC' (event_id: None)
2025-06-18 13:16:12 [root] INFO: def clean_up_address(): Updated event None with address_id 3446 using DB match
2025-06-18 13:16:12 [root] INFO: write_events_to_db: Number of events to write: 3
2025-06-18 13:16:12 [root] INFO: write_url_to_db(): appended URL 'https://dancevictoria.com/performance/malpaso/'
2025-06-18 13:16:12 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:16:12 [root] INFO: def process_llm_response: URL https://dancevictoria.com/performance/malpaso/ marked as relevant with events written to the database.
2025-06-18 13:16:12 [root] INFO: write_url_to_db(): appended URL 'https://dancevictoria.com/performance/malpaso/'
2025-06-18 13:16:12 [root] INFO: def parse(): URL https://dancevictoria.com/performance/malpaso/ marked as relevant (LLM positive).
2025-06-18 13:16:12 [root] INFO: def parse(): Found 10 links on https://dancevictoria.com/performance/malpaso/
2025-06-18 13:16:12 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-TKPSD4XK, URL: https://dancevictoria.com/performance/malpaso/, source: Malpaso Dance Company | Dance Victoria | April 2023, keywords: waltz
2025-06-18 13:16:12 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 13:16:12 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-TKPSD4XK
2025-06-18 13:16:12 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://player.vimeo.com/video/744749201?dnt=1&app_id=122963, URL: https://dancevictoria.com/performance/malpaso/, source: Malpaso Dance Company | Dance Victoria | April 2023, keywords: waltz
2025-06-18 13:16:12 [root] WARNING: def decode_calendar_id(): Exception for https://player.vimeo.com/video/744749201?dnt=1&app_id=122963 - Incorrect padding
2025-06-18 13:16:12 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://player.vimeo.com/video/744749201?dnt=1&app_id=122963
2025-06-18 13:16:12 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://player.vimeo.com/video/744752154?dnt=1&app_id=122963, URL: https://dancevictoria.com/performance/malpaso/, source: Malpaso Dance Company | Dance Victoria | April 2023, keywords: waltz
2025-06-18 13:16:12 [root] WARNING: def decode_calendar_id(): Exception for https://player.vimeo.com/video/744752154?dnt=1&app_id=122963 - Incorrect padding
2025-06-18 13:16:12 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://player.vimeo.com/video/744752154?dnt=1&app_id=122963
2025-06-18 13:16:12 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://player.vimeo.com/video/744759825?dnt=1&app_id=122963, URL: https://dancevictoria.com/performance/malpaso/, source: Malpaso Dance Company | Dance Victoria | April 2023, keywords: waltz
2025-06-18 13:16:12 [root] WARNING: def decode_calendar_id(): Exception for https://player.vimeo.com/video/744759825?dnt=1&app_id=122963 - Incorrect padding
2025-06-18 13:16:12 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://player.vimeo.com/video/744759825?dnt=1&app_id=122963
2025-06-18 13:16:12 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://e.issuu.com/embed.html?d=dv_2022-23_program_insert_-_malpaso_print&u=dancevictoria, URL: https://dancevictoria.com/performance/malpaso/, source: Malpaso Dance Company | Dance Victoria | April 2023, keywords: waltz
2025-06-18 13:16:12 [root] WARNING: def decode_calendar_id(): Exception for https://e.issuu.com/embed.html?d=dv_2022-23_program_insert_-_malpaso_print&u=dancevictoria - Invalid base64-encoded string: number of data characters (57) cannot be 1 more than a multiple of 4
2025-06-18 13:16:12 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://e.issuu.com/embed.html?d=dv_2022-23_program_insert_-_malpaso_print&u=dancevictoria
2025-06-18 13:16:12 [root] INFO: write_url_to_db(): appended URL 'https://e.issuu.com/embed.html?d=dv_2022-23_program_insert_-_malpaso_print&u=dancevictoria'
2025-06-18 13:16:12 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/DanceVictoria/'
2025-06-18 13:16:12 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/DanceVictoria/
2025-06-18 13:16:12 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/dance_victoria/'
2025-06-18 13:16:12 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/dance_victoria/
2025-06-18 13:16:12 [root] INFO: should_process_url: URL https://dancevictoria.com/learn/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:16:12 [root] INFO: should_process_url: URL https://dancevictoria.com/performances/tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:16:12 [root] INFO: should_process_url: URL https://vimeo.com/dancevictoria was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:16:12 [root] INFO: should_process_url: URL https://dancevictoria.com/calendar/ was last seen as relevant, processing it.
2025-06-18 13:16:12 [root] INFO: should_process_url: URL https://dancevictoria.com/performance/malpaso/ was last seen as relevant, processing it.
2025-06-18 13:16:12 [root] INFO: should_process_url: URL https://dancevictoria.com/performance/malpaso/ was last seen as relevant, processing it.
2025-06-18 13:16:12 [root] INFO: write_url_to_db(): appended URL 'https://dancevictoria.com/performance/malpaso/'
2025-06-18 13:16:12 [root] INFO: def parse(): Crawling next URL: https://dancevictoria.com/performance/malpaso/
2025-06-18 13:16:12 [root] INFO: def parse(): Found keywords for URL https://riobraziliansteakhouse.ca/: ['dance', 'samba']
2025-06-18 13:16:12 [root] INFO: def generate_prompt(): Generating prompt for URL: https://riobraziliansteakhouse.ca/
2025-06-18 13:16:12 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 13:16:12 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 13:16:12 [root] INFO: query_llm(): Querying Mistral
2025-06-18 13:18:24 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:18:24 [root] INFO: query_llm(): Mistral response received: The extracted text contains information about several events. Here is the JSON array representing the events:

```json
[
    {
        "source": "Rio Brazilian Steakhouse",
        "dance_style": "samba",
        "url": "",
        "event_type": "live music",
        "event_name": "Live Samba Shows",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-19",
        "end_date": "2025-06-19",
        "start_time": "18:00",
        "end_time": "22:00",
        "price": "",
        "location": "Rio Brazilian Steakhouse, 1122 Denman St, Vancouver BC V6G 1T2, Canada",
        "description": "Enjoy our vibrant atmosphere with live Samba Shows while savoring our dishes."
    },
    {
        "source": "Rio Brazilian Steakhouse",
        "dance_style": "",
        "url": "",
        "event_type": "social dance",
        "event_name": "Father’s Day Lunch Plans",
        "day_of_week": "Sunday",
        "start_date": "2025-06-16",
        "end_date": "2025-06-16",
        "start_time": "12:00",
        "end_time": "16:00",
        "price": "",
        "location": "Rio Brazilian Steakhouse, 1122 Denman St, Vancouver BC V6G 1T2, Canada",
        "description": "Father’s Day Lunch Plans? We’ve got you. Just steps from English Bay. 🔥 Rooftop open patio 🍖 Variety of carved BBQ cuts 🥗 Salad bar + hot buffet 🍻 Cold pints from @parallel49beer Don’t wait — book your Father’s Day lunch now! 🌐 www.riobraziliansteakhouse.ca Must be 19+ for any alcoholic beverage."
    },
    {
        "source": "Rio Brazilian Steakhouse",
        "dance_style": "",
        "url": "",
        "event_type": "social dance",
        "event_name": "Father’s Day on the Rooftop",
        "day_of_week": "Sunday",
        "start_date": "2025-06-16",
        "end_date": "2025-06-16",
        "start_time": "12:00",
        "end_time": "21:30",
        "price": "50",
        "location": "Rio Brazilian Steakhouse, 1122 Denman St, Vancouver BC V6G 1T2, Canada",
        "description": "Celebrate Dad with an unforgettable all-you-can-eat experience for Lunch or Dinner this June 15th. Full dinner menu all day — from 12 PM to 9:30 PM, just steps from English Bay or in Coquitlam. 🔥 Fire-grilled carved BBQ 🍽️ All-you-can-eat Brazilian Rodízio 🥗 Salad bar & Hot Buffet 🍻 Local craft beer from @parallel49beer 🌴 And yes — our rooftop patio is OPEN! Spots are filling fast. Reserve your table today! Must be 19+ for any alcoholic beverage. 🌐 www.riobraziliansteakhouse.ca"
    },
    {
        "source": "Rio Brazilian Steakhouse",
        "dance_style": "",
        "url": "",
        "event_type": "social dance",
        "event_name": "Dinner Menu All Day for Dad",
        "day_of_week": "Sunday",
        "start_date": "2025-06-16",
        "end_date": "2025-06-16",
        "start_time": "12:00",
        "end_time": "21:30",
        "price": "",
        "location": "Rio Brazilian Steakhouse, 1122 Denman st, Vancouver BC V6G 1T2, Canada",
        "description": "This Father’s Day, June 15th, we’re serving our full dinner menu — all day long! From 12 PM to 9:30 PM, enjoy the full Brazilian All-you-can-eat experience at Rio Brazilian Steakhouse: 🥩 Over 10 cuts of premium carved barbecue 🥗 Fresh salad bar 🍲 Hot buffet & starters 🌞 Open patio 🍻 Plus, local craft beer from @parallel49beer Lunch or dinner — Dad gets the full feast, no matter the time. Must be 19+ for any alcoholic beverage. Book your table now and celebrate big. 🇧🇷 🌐 www.riobraziliansteakhouse.ca"
    },
    {
        "source": "Rio Brazilian Steakhouse",
        "dance_style": "",
        "url": "",
        "event_type": "social dance",
        "event_name": "Father’s Day, Brazilian Style",
        "day_of_week": "Sunday",
        "start_date": "2025-06-16",
        "end_date": "2025-06-16",
        "start_time": "12:00",
        "end_time": "21:30",
        "price": "",
        "location": "Rio Brazilian Steakhouse, 1122 Denman St, Vancouver BC V6G 1T2, Canada",
        "description": "We’ve teamed up with local legends @parallel49beer to bring you the ultimate Father’s Day celebration this June 15th! From 12:00 PM to 9:30 PM, enjoy our FULL DINNER MENU ALL DAY, bring Dad for LUNCH or DINNER – featuring over 10 cuts of fire-grilled meat, a fresh salad bar, hot buffet, and more at both Vancouver and Coquitlam locations! Lunch & Dinner | $50 per adult | Open patio available | Dinner menu all day 📍 Coquitlam – Reserve now: 604-941-9969 📍 Vancouver – Reserve now: 604-568-7722 🔥 Book your table and celebrate with flavor! Must be 19+ for any alcoholic beverage. 🍻 🌐 www.riobraziliansteakhouse.ca"
    }
]
```
2025-06-18 13:18:24 [root] INFO: def extract_and_parse_json(): for url https://riobraziliansteakhouse.ca/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Rio Brazilian Steakhouse",
        "dance_style": "samba",
        "url": "",
        "event_type": "live music",
        "event_name": "Live Samba Shows",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-19",
        "end_date": "2025-06-19",
        "start_time": "18:00",
        "end_time": "22:00",
        "price": "",
        "location": "Rio Brazilian Steakhouse, 1122 Denman St, Vancouver BC V6G 1T2, Canada",
        "description": "Enjoy our vibrant atmosphere with live Samba Shows while savoring our dishes."
    },
    {
        "source": "Rio Brazilian Steakhouse",
        "dance_style": "",
        "url": "",
        "event_type": "social dance",
        "event_name": "Father’s Day Lunch Plans",
        "day_of_week": "Sunday",
        "start_date": "2025-06-16",
        "end_date": "2025-06-16",
        "start_time": "12:00",
        "end_time": "16:00",
        "price": "",
        "location": "Rio Brazilian Steakhouse, 1122 Denman St, Vancouver BC V6G 1T2, Canada",
        "description": "Father’s Day Lunch Plans? We’ve got you. Just steps from English Bay. 🔥 Rooftop open patio 🍖 Variety of carved BBQ cuts 🥗 Salad bar + hot buffet 🍻 Cold pints from @parallel49beer Don’t wait — book your Father’s Day lunch now! 🌐 www.riobraziliansteakhouse.ca Must be 19+ for any alcoholic beverage."
    },
    {
        "source": "Rio Brazilian Steakhouse",
        "dance_style": "",
        "url": "",
        "event_type": "social dance",
        "event_name": "Father’s Day on the Rooftop",
        "day_of_week": "Sunday",
        "start_date": "2025-06-16",
        "end_date": "2025-06-16",
        "start_time": "12:00",
        "end_time": "21:30",
        "price": "50",
        "location": "Rio Brazilian Steakhouse, 1122 Denman St, Vancouver BC V6G 1T2, Canada",
        "description": "Celebrate Dad with an unforgettable all-you-can-eat experience for Lunch or Dinner this June 15th. Full dinner menu all day — from 12 PM to 9:30 PM, just steps from English Bay or in Coquitlam. 🔥 Fire-grilled carved BBQ 🍽️ All-you-can-eat Brazilian Rodízio 🥗 Salad bar & Hot Buffet 🍻 Local craft beer from @parallel49beer 🌴 And yes — our rooftop patio is OPEN! Spots are filling fast. Reserve your table today! Must be 19+ for any alcoholic beverage. 🌐 www.riobraziliansteakhouse.ca"
    },
    {
        "source": "Rio Brazilian Steakhouse",
        "dance_style": "",
        "url": "",
        "event_type": "social dance",
        "event_name": "Dinner Menu All Day for Dad",
        "day_of_week": "Sunday",
        "start_date": "2025-06-16",
        "end_date": "2025-06-16",
        "start_time": "12:00",
        "end_time": "21:30",
        "price": "",
        "location": "Rio Brazilian Steakhouse, 1122 Denman st, Vancouver BC V6G 1T2, Canada",
        "description": "This Father’s Day, June 15th, we’re serving our full dinner menu — all day long! From 12 PM to 9:30 PM, enjoy the full Brazilian All-you-can-eat experience at Rio Brazilian Steakhouse: 🥩 Over 10 cuts of premium carved barbecue 🥗 Fresh salad bar 🍲 Hot buffet & starters 🌞 Open patio 🍻 Plus, local craft beer from @parallel49beer Lunch or dinner — Dad gets the full feast, no matter the time. Must be 19+ for any alcoholic beverage. Book your table now and celebrate big. 🇧🇷 🌐 www.riobraziliansteakhouse.ca"
    },
    {
        "source": "Rio Brazilian Steakhouse",
        "dance_style": "",
        "url": "",
        "event_type": "social dance",
        "event_name": "Father’s Day, Brazilian Style",
        "day_of_week": "Sunday",
        "start_date": "2025-06-16",
        "end_date": "2025-06-16",
        "start_time": "12:00",
        "end_time": "21:30",
        "price": "",
        "location": "Rio Brazilian Steakhouse, 1122 Denman St, Vancouver BC V6G 1T2, Canada",
        "description": "We’ve teamed up with local legends @parallel49beer to bring you the ultimate Father’s Day celebration this June 15th! From 12:00 PM to 9:30 PM, enjoy our FULL DINNER MENU ALL DAY, bring Dad for LUNCH or DINNER – featuring over 10 cuts of fire-grilled meat, a fresh salad bar, hot buffet, and more at both Vancouver and Coquitlam locations! Lunch & Dinner | $50 per adult | Open patio available | Dinner menu all day 📍 Coquitlam – Reserve now: 604-941-9969 📍 Vancouver – Reserve now: 604-568-7722 🔥 Book your table and celebrate with flavor! Must be 19+ for any alcoholic beverage. 🍻 🌐 www.riobraziliansteakhouse.ca"
    }
]
2025-06-18 13:18:24 [root] INFO: def clean_up_address(): Starting with events_df shape: (5, 14)
2025-06-18 13:18:24 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse, 1122 Denman St, Vancouver BC V6G 1T2, Canada' (event_id: None)
2025-06-18 13:18:24 [root] INFO: get_address_id: Inserted or updated address_id 4090 for address '1765 Pendrell ST, VANCOUVER, BC, V6G1T2, CA'.
2025-06-18 13:18:24 [root] INFO: Populated from DB for postal code 'V6G1T2': '1765 Pendrell ST, VANCOUVER, BC, V6G1T2, CA'
2025-06-18 13:18:24 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse, 1122 Denman St, Vancouver BC V6G 1T2, Canada' (event_id: None)
2025-06-18 13:18:24 [root] INFO: get_address_id: Inserted or updated address_id 4090 for address '1765 Pendrell ST, VANCOUVER, BC, V6G1T2, CA'.
2025-06-18 13:18:24 [root] INFO: Populated from DB for postal code 'V6G1T2': '1765 Pendrell ST, VANCOUVER, BC, V6G1T2, CA'
2025-06-18 13:18:24 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse, 1122 Denman St, Vancouver BC V6G 1T2, Canada' (event_id: None)
2025-06-18 13:18:24 [root] INFO: get_address_id: Inserted or updated address_id 4090 for address '1765 Pendrell ST, VANCOUVER, BC, V6G1T2, CA'.
2025-06-18 13:18:24 [root] INFO: Populated from DB for postal code 'V6G1T2': '1765 Pendrell ST, VANCOUVER, BC, V6G1T2, CA'
2025-06-18 13:18:24 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse, 1122 Denman st, Vancouver BC V6G 1T2, Canada' (event_id: None)
2025-06-18 13:18:24 [root] INFO: get_address_id: Inserted or updated address_id 4090 for address '1765 Pendrell ST, VANCOUVER, BC, V6G1T2, CA'.
2025-06-18 13:18:24 [root] INFO: Populated from DB for postal code 'V6G1T2': '1765 Pendrell ST, VANCOUVER, BC, V6G1T2, CA'
2025-06-18 13:18:24 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse, 1122 Denman St, Vancouver BC V6G 1T2, Canada' (event_id: None)
2025-06-18 13:18:24 [root] INFO: get_address_id: Inserted or updated address_id 4090 for address '1765 Pendrell ST, VANCOUVER, BC, V6G1T2, CA'.
2025-06-18 13:18:24 [root] INFO: Populated from DB for postal code 'V6G1T2': '1765 Pendrell ST, VANCOUVER, BC, V6G1T2, CA'
2025-06-18 13:18:24 [root] INFO: write_events_to_db: Number of events to write: 5
2025-06-18 13:18:24 [root] INFO: write_url_to_db(): appended URL 'https://riobraziliansteakhouse.ca/'
2025-06-18 13:18:24 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:18:24 [root] INFO: def process_llm_response: URL https://riobraziliansteakhouse.ca/ marked as relevant with events written to the database.
2025-06-18 13:18:24 [root] INFO: write_url_to_db(): appended URL 'https://riobraziliansteakhouse.ca/'
2025-06-18 13:18:24 [root] INFO: def parse(): URL https://riobraziliansteakhouse.ca/ marked as relevant (LLM positive).
2025-06-18 13:18:24 [root] INFO: def parse(): Found 10 links on https://riobraziliansteakhouse.ca/
2025-06-18 13:18:24 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.tbdine.com/book/restaurant/rio-brazillian-steakhouse?idApp=68632&language=en-us, URL: https://riobraziliansteakhouse.ca/, source: Rio Brazilian Steakhouse: Home, keywords: samba
2025-06-18 13:18:24 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: -mاy&(޲֮nYbj{-y!):
2025-06-18 13:18:24 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.tbdine.com/book/restaurant/rio-brazillian-steakhouse?idApp=68632&language=en-us
2025-06-18 13:18:24 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.tbdine.com/book/restaurant/rio-brazilian-steakhouse-coquitlam?idApp=68692&language=en-us, URL: https://riobraziliansteakhouse.ca/, source: Rio Brazilian Steakhouse: Home, keywords: samba
2025-06-18 13:18:24 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: -mاy&(޲֮nX^jHhǜV):
2025-06-18 13:18:24 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.tbdine.com/book/restaurant/rio-brazilian-steakhouse-coquitlam?idApp=68692&language=en-us
2025-06-18 13:18:24 [root] INFO: write_url_to_db(): appended URL 'https://www.tbdine.com/book/restaurant/rio-brazilian-steakhouse-coquitlam?idApp=68692&language=en-us'
2025-06-18 13:18:24 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/vancouver/ was last seen as relevant, processing it.
2025-06-18 13:18:24 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/vancouver/ was last seen as relevant, processing it.
2025-06-18 13:18:24 [root] INFO: write_url_to_db(): appended URL 'https://riobraziliansteakhouse.ca/vancouver/'
2025-06-18 13:18:24 [root] INFO: def parse(): Crawling next URL: https://riobraziliansteakhouse.ca/vancouver/
2025-06-18 13:18:24 [root] INFO: def parse(): Found keywords for URL https://victoriasymphony.ca/concerts/parker-beethovens-emperor-concerto/: ['dance', 'waltz']
2025-06-18 13:18:24 [root] INFO: def generate_prompt(): Generating prompt for URL: https://victoriasymphony.ca/concerts/parker-beethovens-emperor-concerto/
2025-06-18 13:18:24 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 13:18:24 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 13:18:24 [root] INFO: query_llm(): Querying Mistral
2025-06-18 13:18:45 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:18:45 [root] INFO: query_llm(): Mistral response received: ### Event 1: Parker – Beethoven's Emperor Concerto

**Source:** Victoria Symphony

**Dance Style:**

**URL:** ''

**Event Type:** live music

**Event Name:** Parker – Beethoven's Emperor Concerto

**Day of Week:** Sunday

**Start Date:** 2024-10-06

**End Date:** 2024-10-06

**Start Time:** 14:30

**End Time:** 16:30

**Price:** $15

**Location:** Royal Theatre, 805 Broughton St

**Description:** The “Emperor Concerto” reigns among Beethoven’s greatest works, especially in the hands of returning piano soloist Jon Kimura Parker. VS also welcomes the recently enthroned Artistic Director of the Vancouver Island Symphony, Cosette Justo Valdés, to lead this regal program. Along with music of Johann Strauss, we also recruit flashy and folksy Hungarian dances by Kodály, and the concert premiere of a contemporary Canadian work based on a 13th-century song by Alfonso X of Castile.

**Notes:** This event has passed.
2025-06-18 13:18:45 [root] ERROR: def extract_and_parse_json(): couldn't isolate JSON blob in result from https://victoriasymphony.ca/concerts/parker-beethovens-emperor-concerto/
2025-06-18 13:18:45 [root] INFO: write_url_to_db(): appended URL 'https://victoriasymphony.ca/concerts/parker-beethovens-emperor-concerto/'
2025-06-18 13:18:45 [root] INFO: def parse(): URL https://victoriasymphony.ca/concerts/parker-beethovens-emperor-concerto/ marked as irrelevant (LLM negative).
2025-06-18 13:18:45 [root] INFO: def parse(): Found 10 links on https://victoriasymphony.ca/concerts/parker-beethovens-emperor-concerto/
2025-06-18 13:18:45 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5RJF5B3, URL: https://victoriasymphony.ca/concerts/parker-beethovens-emperor-concerto/, source: Parker – Beethoven's Emperor Concerto - Victoria Symphony, keywords: waltz
2025-06-18 13:18:45 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 13:18:45 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5RJF5B3
2025-06-18 13:18:45 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.youtube.com/embed/1etc5R9SK58?feature=oembed, URL: https://victoriasymphony.ca/concerts/parker-beethovens-emperor-concerto/, source: Parker – Beethoven's Emperor Concerto - Victoria Symphony, keywords: waltz
2025-06-18 13:18:45 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: 2nm(m\R+yn
2025-06-18 13:18:45 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.youtube.com/embed/1etc5R9SK58?feature=oembed
2025-06-18 13:18:45 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.google.com/maps/embed/v1/place?key=AIzaSyDNsicAsP6-VuGtAb1O9riI3oc_NOb7IOU&q=805+Broughton+St+&zoom=10, URL: https://victoriasymphony.ca/concerts/parker-beethovens-emperor-concerto/, source: Parker – Beethoven's Emperor Concerto - Victoria Symphony, keywords: waltz
2025-06-18 13:18:45 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %y&fm_镧
2025-06-18 13:18:45 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.google.com/maps/embed/v1/place?key=AIzaSyDNsicAsP6-VuGtAb1O9riI3oc_NOb7IOU&q=805+Broughton+St+&zoom=10
2025-06-18 13:18:45 [root] INFO: write_url_to_db(): appended URL 'https://www.google.com/maps/embed/v1/place?key=AIzaSyDNsicAsP6-VuGtAb1O9riI3oc_NOb7IOU&q=805+Broughton+St+&zoom=10'
2025-06-18 13:18:45 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/vicsymphony/'
2025-06-18 13:18:45 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/vicsymphony/
2025-06-18 13:18:45 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/vicsymphony'
2025-06-18 13:18:45 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/vicsymphony
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://victoriasymphony.ca/contact-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://victoriasymphony.ca/support/donations/how-to-donate/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://victoriasymphony.ca/concerts-events/#concertseries was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://victoriasymphony.ca/concerts/parker-beethovens-emperor-concerto/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://victoriasymphony.ca/concerts/parker-beethovens-emperor-concerto/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: write_url_to_db(): appended URL 'https://victoriasymphony.ca/concerts/parker-beethovens-emperor-concerto/'
2025-06-18 13:18:45 [root] INFO: def parse(): Crawling next URL: https://victoriasymphony.ca/concerts/parker-beethovens-emperor-concerto/
2025-06-18 13:18:45 [scrapy.extensions.logstats] INFO: Crawled 52 pages (at 11 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://dancevictoria.com/learn/news/ was last seen as relevant, processing it.
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://dancevictoria.com/ was last seen as not relevant but hit_ratio (0.33) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://dancevictoria.com/support/donate/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://dancevictoria.com/season-trailer/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/about-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/about-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: write_url_to_db(): appended URL 'https://riobraziliansteakhouse.ca/about-us/'
2025-06-18 13:18:45 [root] INFO: def parse(): Crawling next URL: https://riobraziliansteakhouse.ca/about-us/
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://victoriasymphony.ca/concerts-events/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/VicSymphony.
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://victoriasymphony.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/user/VictoriaSymphony.
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://victoriasymphony.ca/cart/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/ was last seen as not relevant but hit_ratio (2.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/ was last seen as not relevant but hit_ratio (2.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: write_url_to_db(): appended URL 'https://riobraziliansteakhouse.ca/'
2025-06-18 13:18:45 [root] INFO: def parse(): Crawling next URL: https://riobraziliansteakhouse.ca/
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/coquitlam/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/coquitlam/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: write_url_to_db(): appended URL 'https://riobraziliansteakhouse.ca/coquitlam/'
2025-06-18 13:18:45 [root] INFO: def parse(): Crawling next URL: https://riobraziliansteakhouse.ca/coquitlam/
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/take-out-menu/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/take-out-menu/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: write_url_to_db(): appended URL 'https://riobraziliansteakhouse.ca/take-out-menu/'
2025-06-18 13:18:45 [root] INFO: def parse(): Crawling next URL: https://riobraziliansteakhouse.ca/take-out-menu/
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/blog/ was last seen as relevant, processing it.
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/blog/ was last seen as relevant, processing it.
2025-06-18 13:18:45 [root] INFO: write_url_to_db(): appended URL 'https://riobraziliansteakhouse.ca/blog/'
2025-06-18 13:18:45 [root] INFO: def parse(): Crawling next URL: https://riobraziliansteakhouse.ca/blog/
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/langley/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/langley/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: write_url_to_db(): appended URL 'https://riobraziliansteakhouse.ca/langley/'
2025-06-18 13:18:45 [root] INFO: def parse(): Crawling next URL: https://riobraziliansteakhouse.ca/langley/
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: write_url_to_db(): appended URL 'https://riobraziliansteakhouse.ca/contact/'
2025-06-18 13:18:45 [root] INFO: def parse(): Crawling next URL: https://riobraziliansteakhouse.ca/contact/
2025-06-18 13:18:45 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/garden/mediterranean-garden/'
2025-06-18 13:18:45 [root] INFO: def parse(): URL https://butchartgardens.com/garden/mediterranean-garden/ marked as irrelevant (no keywords).
2025-06-18 13:18:45 [root] INFO: def parse(): Found 10 links on https://butchartgardens.com/garden/mediterranean-garden/
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/mediterranean-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/sunken-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/italian-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/rose-garden/ was last seen as relevant, processing it.
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://butchartgardens.com/how-to-get-here/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/japanese-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://tickets.butchartgardens.com/WebStore/shop/viewItems.aspx?cg=tt&c=DAtt was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://butchartgardens.com/hours-rates/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: should_process_url: URL https://butchartgardens.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:18:45 [root] INFO: def parse(): Found keywords for URL https://bcswingdance.ca/index.php/about-the-bc-swing-dance-club/: ['cha cha', 'dance', 'east coast swing', 'salsa', 'swing', 'waltz', 'west coast swing']
2025-06-18 13:18:45 [root] INFO: def generate_prompt(): Generating prompt for URL: https://bcswingdance.ca/index.php/about-the-bc-swing-dance-club/
2025-06-18 13:18:45 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 13:18:45 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 13:18:45 [root] INFO: query_llm(): Querying Mistral
2025-06-18 13:20:04 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:20:04 [root] INFO: query_llm(): Mistral response received: ```json
[
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Thursday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "20:00",
        "end_time": "24:00",
        "price": "$12 for members and $15 for guests",
        "location": "Confederation Centre in North Burnaby",
        "description": "Regular dance admission is $12 for members and $15 for guests, and we offer a discount to students with ID."
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2025-07-19",
        "end_date": "2025-07-19",
        "start_time": "20:00",
        "end_time": "24:00",
        "price": "$12 for members and $15 for guests",
        "location": "Confederation Centre in North Burnaby",
        "description": "Regular dance admission is $12 for members and $15 for guests, and we offer a discount to students with ID."
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2025-08-16",
        "end_date": "2025-08-16",
        "start_time": "20:00",
        "end_time": "24:00",
        "price": "$12 for members and $15 for guests",
        "location": "Confederation Centre in North Burnaby",
        "description": "Regular dance admission is $12 for members and $15 for guests, and we offer a discount to students with ID."
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2025-09-13",
        "end_date": "2025-09-13",
        "start_time": "20:00",
        "end_time": "24:00",
        "price": "$12 for members and $15 for guests",
        "location": "Confederation Centre in North Burnaby",
        "description": "Regular dance admission is $12 for members and $15 for guests, and we offer a discount to students with ID."
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2025-10-18",
        "end_date": "2025-10-18",
        "start_time": "20:00",
        "end_time": "24:00",
        "price": "$12 for members and $15 for guests",
        "location": "Confederation Centre in North Burnaby",
        "description": "Regular dance admission is $12 for members and $15 for guests, and we offer a discount to students with ID."
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2025-11-29",
        "end_date": "2025-11-29",
        "start_time": "20:00",
        "end_time": "24:00",
        "price": "$12 for members and $15 for guests",
        "location": "Confederation Centre in North Burnaby",
        "description": "Regular dance admission is $12 for members and $15 for guests, and we offer a discount to students with ID."
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2025-12-13",
        "end_date": "2025-12-13",
        "start_time": "20:00",
        "end_time": "24:00",
        "price": "$12 for members and $15 for guests",
        "location": "Confederation Centre in North Burnaby",
        "description": "Regular dance admission is $12 for members and $15 for guests, and we offer a discount to students with ID."
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2026-01-17",
        "end_date": "2026-01-17",
        "start_time": "20:00",
        "end_time": "24:00",
        "price": "$12 for members and $15 for guests",
        "location": "Confederation Centre in North Burnaby",
        "description": "Regular dance admission is $12 for members and $15 for guests, and we offer a discount to students with ID."
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2026-02-14",
        "end_date": "2026-02-14",
        "start_time": "20:00",
        "end_time": "24:00",
        "price": "$12 for members and $15 for guests",
        "location": "Confederation Centre in North Burnaby",
        "description": "Regular dance admission is $12 for members and $15 for guests, and we offer a discount to students with ID."
    }
]
```
2025-06-18 13:20:04 [root] INFO: def extract_and_parse_json(): for url https://bcswingdance.ca/index.php/about-the-bc-swing-dance-club/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Thursday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "20:00",
        "end_time": "24:00",
        "price": "$12 for members and $15 for guests",
        "location": "Confederation Centre in North Burnaby",
        "description": "Regular dance admission is $12 for members and $15 for guests, and we offer a discount to students with ID."
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2025-07-19",
        "end_date": "2025-07-19",
        "start_time": "20:00",
        "end_time": "24:00",
        "price": "$12 for members and $15 for guests",
        "location": "Confederation Centre in North Burnaby",
        "description": "Regular dance admission is $12 for members and $15 for guests, and we offer a discount to students with ID."
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2025-08-16",
        "end_date": "2025-08-16",
        "start_time": "20:00",
        "end_time": "24:00",
        "price": "$12 for members and $15 for guests",
        "location": "Confederation Centre in North Burnaby",
        "description": "Regular dance admission is $12 for members and $15 for guests, and we offer a discount to students with ID."
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2025-09-13",
        "end_date": "2025-09-13",
        "start_time": "20:00",
        "end_time": "24:00",
        "price": "$12 for members and $15 for guests",
        "location": "Confederation Centre in North Burnaby",
        "description": "Regular dance admission is $12 for members and $15 for guests, and we offer a discount to students with ID."
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2025-10-18",
        "end_date": "2025-10-18",
        "start_time": "20:00",
        "end_time": "24:00",
        "price": "$12 for members and $15 for guests",
        "location": "Confederation Centre in North Burnaby",
        "description": "Regular dance admission is $12 for members and $15 for guests, and we offer a discount to students with ID."
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2025-11-29",
        "end_date": "2025-11-29",
        "start_time": "20:00",
        "end_time": "24:00",
        "price": "$12 for members and $15 for guests",
        "location": "Confederation Centre in North Burnaby",
        "description": "Regular dance admission is $12 for members and $15 for guests, and we offer a discount to students with ID."
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2025-12-13",
        "end_date": "2025-12-13",
        "start_time": "20:00",
        "end_time": "24:00",
        "price": "$12 for members and $15 for guests",
        "location": "Confederation Centre in North Burnaby",
        "description": "Regular dance admission is $12 for members and $15 for guests, and we offer a discount to students with ID."
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2026-01-17",
        "end_date": "2026-01-17",
        "start_time": "20:00",
        "end_time": "24:00",
        "price": "$12 for members and $15 for guests",
        "location": "Confederation Centre in North Burnaby",
        "description": "Regular dance admission is $12 for members and $15 for guests, and we offer a discount to students with ID."
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2026-02-14",
        "end_date": "2026-02-14",
        "start_time": "20:00",
        "end_time": "24:00",
        "price": "$12 for members and $15 for guests",
        "location": "Confederation Centre in North Burnaby",
        "description": "Regular dance admission is $12 for members and $15 for guests, and we offer a discount to students with ID."
    }
]
2025-06-18 13:20:04 [root] INFO: def clean_up_address(): Starting with events_df shape: (9, 14)
2025-06-18 13:20:04 [root] INFO: def clean_up_address(): Processing location 'Confederation Centre in North Burnaby' (event_id: None)
2025-06-18 13:20:04 [root] INFO: def clean_up_address(): Processing location 'Confederation Centre in North Burnaby' (event_id: None)
2025-06-18 13:20:04 [root] INFO: def clean_up_address(): Processing location 'Confederation Centre in North Burnaby' (event_id: None)
2025-06-18 13:20:04 [root] INFO: def clean_up_address(): Processing location 'Confederation Centre in North Burnaby' (event_id: None)
2025-06-18 13:20:04 [root] INFO: def clean_up_address(): Processing location 'Confederation Centre in North Burnaby' (event_id: None)
2025-06-18 13:20:04 [root] INFO: def clean_up_address(): Processing location 'Confederation Centre in North Burnaby' (event_id: None)
2025-06-18 13:20:04 [root] INFO: def clean_up_address(): Processing location 'Confederation Centre in North Burnaby' (event_id: None)
2025-06-18 13:20:04 [root] INFO: def clean_up_address(): Processing location 'Confederation Centre in North Burnaby' (event_id: None)
2025-06-18 13:20:04 [root] INFO: def clean_up_address(): Processing location 'Confederation Centre in North Burnaby' (event_id: None)
2025-06-18 13:20:04 [root] INFO: write_events_to_db: Number of events to write: 9
2025-06-18 13:20:04 [root] INFO: write_url_to_db(): appended URL 'https://bcswingdance.ca/index.php/about-the-bc-swing-dance-club/'
2025-06-18 13:20:04 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:20:04 [root] INFO: def process_llm_response: URL https://bcswingdance.ca/index.php/about-the-bc-swing-dance-club/ marked as relevant with events written to the database.
2025-06-18 13:20:04 [root] INFO: write_url_to_db(): appended URL 'https://bcswingdance.ca/index.php/about-the-bc-swing-dance-club/'
2025-06-18 13:20:04 [root] INFO: def parse(): URL https://bcswingdance.ca/index.php/about-the-bc-swing-dance-club/ marked as relevant (LLM positive).
2025-06-18 13:20:04 [root] INFO: def parse(): Found 10 links on https://bcswingdance.ca/index.php/about-the-bc-swing-dance-club/
2025-06-18 13:20:04 [root] INFO: should_process_url: URL https://bcswingdance.ca/ was last seen as relevant, processing it.
2025-06-18 13:20:04 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/current-board-of-directors/ was last seen as relevant, processing it.
2025-06-18 13:20:04 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/make-the-club-great/ was last seen as relevant, processing it.
2025-06-18 13:20:04 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/history/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:20:04 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/documents/ was last seen as relevant, processing it.
2025-06-18 13:20:04 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/board-minutes/ was last seen as relevant, processing it.
2025-06-18 13:20:04 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/about-the-bc-swing-dance-club/ was last seen as relevant, processing it.
2025-06-18 13:20:04 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/membership/ was last seen as relevant, processing it.
2025-06-18 13:20:04 [root] INFO: should_process_url: URL http://bcswingdance.ca was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:20:04 [root] INFO: def parse(): Found keywords for URL https://bcswingdance.ca/index.php/documents/: ['dance', 'swing']
2025-06-18 13:20:04 [root] INFO: def generate_prompt(): Generating prompt for URL: https://bcswingdance.ca/index.php/documents/
2025-06-18 13:20:04 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 13:20:04 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 13:20:04 [root] INFO: query_llm(): Querying Mistral
2025-06-18 13:21:23 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:21:23 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "BC Swing Dance Club",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2025-07-19",
        "end_date": "2025-07-19",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2025-08-16",
        "end_date": "2025-08-16",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2025-09-13",
        "end_date": "2025-09-13",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2025-10-18",
        "end_date": "2025-10-18",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2025-11-29",
        "end_date": "2025-11-29",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2025-12-13",
        "end_date": "2025-12-13",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2026-01-17",
        "end_date": "2026-01-17",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2026-02-14",
        "end_date": "2026-02-14",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": "Annual General Meeting"
    }
]
2025-06-18 13:21:23 [root] INFO: def extract_and_parse_json(): for url https://bcswingdance.ca/index.php/documents/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "BC Swing Dance Club",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2025-07-19",
        "end_date": "2025-07-19",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2025-08-16",
        "end_date": "2025-08-16",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2025-09-13",
        "end_date": "2025-09-13",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2025-10-18",
        "end_date": "2025-10-18",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2025-11-29",
        "end_date": "2025-11-29",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2025-12-13",
        "end_date": "2025-12-13",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2026-01-17",
        "end_date": "2026-01-17",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Club Burnaby Dance",
        "day_of_week": "Friday",
        "start_date": "2026-02-14",
        "end_date": "2026-02-14",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": "Annual General Meeting"
    }
]
2025-06-18 13:21:23 [root] INFO: def clean_up_address(): Starting with events_df shape: (9, 14)
2025-06-18 13:21:23 [root] INFO: write_events_to_db: Number of events to write: 9
2025-06-18 13:21:23 [root] INFO: write_url_to_db(): appended URL 'https://bcswingdance.ca/index.php/documents/'
2025-06-18 13:21:23 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:21:23 [root] INFO: def process_llm_response: URL https://bcswingdance.ca/index.php/documents/ marked as relevant with events written to the database.
2025-06-18 13:21:23 [root] INFO: write_url_to_db(): appended URL 'https://bcswingdance.ca/index.php/documents/'
2025-06-18 13:21:23 [root] INFO: def parse(): URL https://bcswingdance.ca/index.php/documents/ marked as relevant (LLM positive).
2025-06-18 13:21:23 [root] INFO: def parse(): Found 10 links on https://bcswingdance.ca/index.php/documents/
2025-06-18 13:21:23 [root] INFO: should_process_url: URL https://bcswingdance.ca/ was last seen as relevant, processing it.
2025-06-18 13:21:23 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/current-board-of-directors/ was last seen as relevant, processing it.
2025-06-18 13:21:23 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/make-the-club-great/ was last seen as relevant, processing it.
2025-06-18 13:21:23 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/history/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:21:23 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/documents/ was last seen as relevant, processing it.
2025-06-18 13:21:23 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/board-minutes/ was last seen as relevant, processing it.
2025-06-18 13:21:23 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/about-the-bc-swing-dance-club/ was last seen as relevant, processing it.
2025-06-18 13:21:23 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/membership/ was last seen as relevant, processing it.
2025-06-18 13:21:23 [root] INFO: should_process_url: URL http://bcswingdance.ca was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:21:23 [root] INFO: def parse(): Found keywords for URL https://bcswingdance.ca/index.php/current-board-of-directors/: ['argentine tango', 'bachata', 'dance', 'east coast swing', 'lindy hop', 'live music', 'salsa', 'swing', 'tango', 'wcs', 'west coast swing', 'zouk']
2025-06-18 13:21:23 [root] INFO: def generate_prompt(): Generating prompt for URL: https://bcswingdance.ca/index.php/current-board-of-directors/
2025-06-18 13:21:23 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 13:21:23 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 13:21:23 [root] INFO: query_llm(): Querying Mistral
2025-06-18 13:22:48 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:22:48 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Monthly Dance",
        "day_of_week": "Friday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Monthly Dance",
        "day_of_week": "Thursday",
        "start_date": "2025-07-19",
        "end_date": "2025-07-19",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Monthly Dance",
        "day_of_week": "Friday",
        "start_date": "2025-08-16",
        "end_date": "2025-08-16",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Monthly Dance",
        "day_of_week": "Thursday",
        "start_date": "2025-09-13",
        "end_date": "2025-09-13",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Monthly Dance",
        "day_of_week": "Friday",
        "start_date": "2025-10-18",
        "end_date": "2025-10-18",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Monthly Dance",
        "day_of_week": "Saturday",
        "start_date": "2025-11-29",
        "end_date": "2025-11-29",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Monthly Dance",
        "day_of_week": "Thursday",
        "start_date": "2025-12-13",
        "end_date": "2025-12-13",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Monthly Dance",
        "day_of_week": "Thursday",
        "start_date": "2026-01-17",
        "end_date": "2026-01-17",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Monthly Dance and Annual General Meeting",
        "day_of_week": "Wednesday",
        "start_date": "2026-02-14",
        "end_date": "2026-02-14",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    }
]
2025-06-18 13:22:48 [root] INFO: def extract_and_parse_json(): for url https://bcswingdance.ca/index.php/current-board-of-directors/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Monthly Dance",
        "day_of_week": "Friday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Monthly Dance",
        "day_of_week": "Thursday",
        "start_date": "2025-07-19",
        "end_date": "2025-07-19",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Monthly Dance",
        "day_of_week": "Friday",
        "start_date": "2025-08-16",
        "end_date": "2025-08-16",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Monthly Dance",
        "day_of_week": "Thursday",
        "start_date": "2025-09-13",
        "end_date": "2025-09-13",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Monthly Dance",
        "day_of_week": "Friday",
        "start_date": "2025-10-18",
        "end_date": "2025-10-18",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Monthly Dance",
        "day_of_week": "Saturday",
        "start_date": "2025-11-29",
        "end_date": "2025-11-29",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Monthly Dance",
        "day_of_week": "Thursday",
        "start_date": "2025-12-13",
        "end_date": "2025-12-13",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Monthly Dance",
        "day_of_week": "Thursday",
        "start_date": "2026-01-17",
        "end_date": "2026-01-17",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Monthly Dance and Annual General Meeting",
        "day_of_week": "Wednesday",
        "start_date": "2026-02-14",
        "end_date": "2026-02-14",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": ""
    }
]
2025-06-18 13:22:48 [root] INFO: def clean_up_address(): Starting with events_df shape: (9, 14)
2025-06-18 13:22:48 [root] INFO: write_events_to_db: Number of events to write: 9
2025-06-18 13:22:48 [root] INFO: write_url_to_db(): appended URL 'https://bcswingdance.ca/index.php/current-board-of-directors/'
2025-06-18 13:22:48 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:22:48 [root] INFO: def process_llm_response: URL https://bcswingdance.ca/index.php/current-board-of-directors/ marked as relevant with events written to the database.
2025-06-18 13:22:48 [root] INFO: write_url_to_db(): appended URL 'https://bcswingdance.ca/index.php/current-board-of-directors/'
2025-06-18 13:22:48 [root] INFO: def parse(): URL https://bcswingdance.ca/index.php/current-board-of-directors/ marked as relevant (LLM positive).
2025-06-18 13:22:48 [root] INFO: def parse(): Found 10 links on https://bcswingdance.ca/index.php/current-board-of-directors/
2025-06-18 13:22:48 [root] INFO: should_process_url: URL https://bcswingdance.ca/ was last seen as relevant, processing it.
2025-06-18 13:22:48 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/current-board-of-directors/ was last seen as relevant, processing it.
2025-06-18 13:22:48 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/make-the-club-great/ was last seen as relevant, processing it.
2025-06-18 13:22:48 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/history/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:22:48 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/documents/ was last seen as relevant, processing it.
2025-06-18 13:22:48 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/board-minutes/ was last seen as relevant, processing it.
2025-06-18 13:22:48 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/about-the-bc-swing-dance-club/ was last seen as relevant, processing it.
2025-06-18 13:22:48 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/membership/ was last seen as relevant, processing it.
2025-06-18 13:22:48 [root] INFO: should_process_url: URL http://bcswingdance.ca was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:22:48 [root] INFO: def parse(): Found keywords for URL https://bcswingdance.ca/index.php/membership/: ['dance', 'swing']
2025-06-18 13:22:48 [root] INFO: def generate_prompt(): Generating prompt for URL: https://bcswingdance.ca/index.php/membership/
2025-06-18 13:22:48 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 13:22:48 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 13:22:48 [root] INFO: query_llm(): Querying Mistral
2025-06-18 13:24:07 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:24:07 [root] INFO: query_llm(): Mistral response received: [
  {
    "source": "https://bcswingdance.ca/index.php/membership/",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Swing Club Burnaby Dance",
    "day_of_week": "Friday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "null",
    "end_time": "null",
    "price": "null",
    "location": "BC Swing Dance Club",
    "description": "null"
  },
  {
    "source": "https://bcswingdance.ca/index.php/membership/",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Swing Club Burnaby Dance",
    "day_of_week": "Thursday",
    "start_date": "2025-07-19",
    "end_date": "2025-07-19",
    "start_time": "null",
    "end_time": "null",
    "price": "null",
    "location": "BC Swing Dance Club",
    "description": "null"
  },
  {
    "source": "https://bcswingdance.ca/index.php/membership/",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Swing Club Burnaby Dance",
    "day_of_week": "Wednesday",
    "start_date": "2025-08-21",
    "end_date": "2025-08-21",
    "start_time": "null",
    "end_time": "null",
    "price": "null",
    "location": "BC Swing Dance Club",
    "description": "null"
  },
  {
    "source": "https://bcswingdance.ca/index.php/membership/",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Swing Club Burnaby Dance",
    "day_of_week": "Tuesday",
    "start_date": "2025-09-17",
    "end_date": "2025-09-17",
    "start_time": "null",
    "end_time": "null",
    "price": "null",
    "location": "BC Swing Dance Club",
    "description": "null"
  },
  {
    "source": "https://bcswingdance.ca/index.php/membership/",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Swing Club Burnaby Dance",
    "day_of_week": "Sunday",
    "start_date": "2025-10-20",
    "end_date": "2025-10-20",
    "start_time": "null",
    "end_time": "null",
    "price": "null",
    "location": "BC Swing Dance Club",
    "description": "null"
  },
  {
    "source": "https://bcswingdance.ca/index.php/membership/",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Swing Club Burnaby Dance",
    "day_of_week": "Saturday",
    "start_date": "2025-11-29",
    "end_date": "2025-11-29",
    "start_time": "null",
    "end_time": "null",
    "price": "null",
    "location": "BC Swing Dance Club",
    "description": "null"
  },
  {
    "source": "https://bcswingdance.ca/index.php/membership/",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Swing Club Burnaby Dance",
    "day_of_week": "Thursday",
    "start_date": "2025-12-12",
    "end_date": "2025-12-12",
    "start_time": "null",
    "end_time": "null",
    "price": "null",
    "location": "BC Swing Dance Club",
    "description": "null"
  },
  {
    "source": "https://bcswingdance.ca/index.php/membership/",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Swing Club Burnaby Dance",
    "day_of_week": "Wednesday",
    "start_date": "2026-01-15",
    "end_date": "2026-01-15",
    "start_time": "null",
    "end_time": "null",
    "price": "null",
    "location": "BC Swing Dance Club",
    "description": "null"
  },
  {
    "source": "https://bcswingdance.ca/index.php/membership/",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Swing Club Burnaby Dance AGM",
    "day_of_week": "Tuesday",
    "start_date": "2026-02-14",
    "end_date": "2026-02-14",
    "start_time": "null",
    "end_time": "null",
    "price": "null",
    "location": "BC Swing Dance Club",
    "description": "null"
  }
]
2025-06-18 13:24:07 [root] INFO: def extract_and_parse_json(): for url https://bcswingdance.ca/index.php/membership/, 
Cleaned JSON ready for parsing:
[
  {
    "source": "https://bcswingdance.ca/index.php/membership/",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Swing Club Burnaby Dance",
    "day_of_week": "Friday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "null",
    "end_time": "null",
    "price": "null",
    "location": "BC Swing Dance Club",
    "description": "null"
  },
  {
    "source": "https://bcswingdance.ca/index.php/membership/",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Swing Club Burnaby Dance",
    "day_of_week": "Thursday",
    "start_date": "2025-07-19",
    "end_date": "2025-07-19",
    "start_time": "null",
    "end_time": "null",
    "price": "null",
    "location": "BC Swing Dance Club",
    "description": "null"
  },
  {
    "source": "https://bcswingdance.ca/index.php/membership/",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Swing Club Burnaby Dance",
    "day_of_week": "Wednesday",
    "start_date": "2025-08-21",
    "end_date": "2025-08-21",
    "start_time": "null",
    "end_time": "null",
    "price": "null",
    "location": "BC Swing Dance Club",
    "description": "null"
  },
  {
    "source": "https://bcswingdance.ca/index.php/membership/",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Swing Club Burnaby Dance",
    "day_of_week": "Tuesday",
    "start_date": "2025-09-17",
    "end_date": "2025-09-17",
    "start_time": "null",
    "end_time": "null",
    "price": "null",
    "location": "BC Swing Dance Club",
    "description": "null"
  },
  {
    "source": "https://bcswingdance.ca/index.php/membership/",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Swing Club Burnaby Dance",
    "day_of_week": "Sunday",
    "start_date": "2025-10-20",
    "end_date": "2025-10-20",
    "start_time": "null",
    "end_time": "null",
    "price": "null",
    "location": "BC Swing Dance Club",
    "description": "null"
  },
  {
    "source": "https://bcswingdance.ca/index.php/membership/",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Swing Club Burnaby Dance",
    "day_of_week": "Saturday",
    "start_date": "2025-11-29",
    "end_date": "2025-11-29",
    "start_time": "null",
    "end_time": "null",
    "price": "null",
    "location": "BC Swing Dance Club",
    "description": "null"
  },
  {
    "source": "https://bcswingdance.ca/index.php/membership/",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Swing Club Burnaby Dance",
    "day_of_week": "Thursday",
    "start_date": "2025-12-12",
    "end_date": "2025-12-12",
    "start_time": "null",
    "end_time": "null",
    "price": "null",
    "location": "BC Swing Dance Club",
    "description": "null"
  },
  {
    "source": "https://bcswingdance.ca/index.php/membership/",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Swing Club Burnaby Dance",
    "day_of_week": "Wednesday",
    "start_date": "2026-01-15",
    "end_date": "2026-01-15",
    "start_time": "null",
    "end_time": "null",
    "price": "null",
    "location": "BC Swing Dance Club",
    "description": "null"
  },
  {
    "source": "https://bcswingdance.ca/index.php/membership/",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Swing Club Burnaby Dance AGM",
    "day_of_week": "Tuesday",
    "start_date": "2026-02-14",
    "end_date": "2026-02-14",
    "start_time": "null",
    "end_time": "null",
    "price": "null",
    "location": "BC Swing Dance Club",
    "description": "null"
  }
]
2025-06-18 13:24:07 [root] INFO: def clean_up_address(): Starting with events_df shape: (9, 14)
2025-06-18 13:24:07 [root] INFO: def clean_up_address(): Processing location 'BC Swing Dance Club' (event_id: None)
2025-06-18 13:24:07 [root] INFO: def clean_up_address(): Processing location 'BC Swing Dance Club' (event_id: None)
2025-06-18 13:24:07 [root] INFO: def clean_up_address(): Processing location 'BC Swing Dance Club' (event_id: None)
2025-06-18 13:24:07 [root] INFO: def clean_up_address(): Processing location 'BC Swing Dance Club' (event_id: None)
2025-06-18 13:24:07 [root] INFO: def clean_up_address(): Processing location 'BC Swing Dance Club' (event_id: None)
2025-06-18 13:24:07 [root] INFO: def clean_up_address(): Processing location 'BC Swing Dance Club' (event_id: None)
2025-06-18 13:24:07 [root] INFO: def clean_up_address(): Processing location 'BC Swing Dance Club' (event_id: None)
2025-06-18 13:24:07 [root] INFO: def clean_up_address(): Processing location 'BC Swing Dance Club' (event_id: None)
2025-06-18 13:24:07 [root] INFO: def clean_up_address(): Processing location 'BC Swing Dance Club' (event_id: None)
2025-06-18 13:24:07 [root] INFO: write_events_to_db: Number of events to write: 9
2025-06-18 13:24:07 [root] INFO: write_url_to_db(): appended URL 'https://bcswingdance.ca/index.php/membership/'
2025-06-18 13:24:07 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:24:07 [root] INFO: def process_llm_response: URL https://bcswingdance.ca/index.php/membership/ marked as relevant with events written to the database.
2025-06-18 13:24:07 [root] INFO: write_url_to_db(): appended URL 'https://bcswingdance.ca/index.php/membership/'
2025-06-18 13:24:07 [root] INFO: def parse(): URL https://bcswingdance.ca/index.php/membership/ marked as relevant (LLM positive).
2025-06-18 13:24:07 [root] INFO: def parse(): Found 10 links on https://bcswingdance.ca/index.php/membership/
2025-06-18 13:24:07 [root] INFO: should_process_url: URL https://bcswingdance.ca/ was last seen as relevant, processing it.
2025-06-18 13:24:07 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/current-board-of-directors/ was last seen as relevant, processing it.
2025-06-18 13:24:07 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/make-the-club-great/ was last seen as relevant, processing it.
2025-06-18 13:24:07 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/history/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:24:07 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/documents/ was last seen as relevant, processing it.
2025-06-18 13:24:07 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/board-minutes/ was last seen as relevant, processing it.
2025-06-18 13:24:07 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/about-the-bc-swing-dance-club/ was last seen as relevant, processing it.
2025-06-18 13:24:07 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/membership/ was last seen as relevant, processing it.
2025-06-18 13:24:07 [root] INFO: should_process_url: URL http://bcswingdance.ca was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:24:07 [root] INFO: def parse(): Found keywords for URL https://bcswingdance.ca/index.php/make-the-club-great/: ['dance', 'swing']
2025-06-18 13:24:07 [root] INFO: def generate_prompt(): Generating prompt for URL: https://bcswingdance.ca/index.php/make-the-club-great/
2025-06-18 13:24:07 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 13:24:07 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 13:24:07 [root] INFO: query_llm(): Querying Mistral
2025-06-18 13:25:57 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:25:57 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "https://bcswingdance.ca/index.php/make-the-club-great/",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Dance",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Confederation Centre",
        "description": "Swing Dance Event"
    },
    {
        "source": "https://bcswingdance.ca/index.php/make-the-club-great/",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Dance",
        "day_of_week": "Thursday",
        "start_date": "2025-07-19",
        "end_date": "2025-07-19",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Confederation Centre",
        "description": "Swing Dance Event"
    },
    {
        "source": "https://bcswingdance.ca/index.php/make-the-club-great/",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Dance",
        "day_of_week": "Friday",
        "start_date": "2025-08-16",
        "end_date": "2025-08-16",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Confederation Centre",
        "description": "Swing Dance Event"
    },
    {
        "source": "https://bcswingdance.ca/index.php/make-the-club-great/",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Dance",
        "day_of_week": "Wednesday",
        "start_date": "2025-09-13",
        "end_date": "2025-09-13",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Confederation Centre",
        "description": "Swing Dance Event"
    },
    {
        "source": "https://bcswingdance.ca/index.php/make-the-club-great/",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Dance",
        "day_of_week": "Thursday",
        "start_date": "2025-10-18",
        "end_date": "2025-10-18",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Confederation Centre",
        "description": "Swing Dance Event"
    },
    {
        "source": "https://bcswingdance.ca/index.php/make-the-club-great/",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Dance",
        "day_of_week": "Friday",
        "start_date": "2025-11-29",
        "end_date": "2025-11-29",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Confederation Centre",
        "description": "Swing Dance Event"
    },
    {
        "source": "https://bcswingdance.ca/index.php/make-the-club-great/",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Dance",
        "day_of_week": "Wednesday",
        "start_date": "2025-12-13",
        "end_date": "2025-12-13",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Confederation Centre",
        "description": "Swing Dance Event"
    },
    {
        "source": "https://bcswingdance.ca/index.php/make-the-club-great/",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Dance",
        "day_of_week": "Thursday",
        "start_date": "2025-01-17",
        "end_date": "2025-01-17",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Confederation Centre",
        "description": "Swing Dance Event"
    },
    {
        "source": "https://bcswingdance.ca/index.php/make-the-club-great/",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Dance",
        "day_of_week": "Wednesday",
        "start_date": "2026-02-14",
        "end_date": "2026-02-14",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Confederation Centre",
        "description": "Swing Dance Event"
    }
]
2025-06-18 13:25:57 [root] INFO: def extract_and_parse_json(): for url https://bcswingdance.ca/index.php/make-the-club-great/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "https://bcswingdance.ca/index.php/make-the-club-great/",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Dance",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Confederation Centre",
        "description": "Swing Dance Event"
    },
    {
        "source": "https://bcswingdance.ca/index.php/make-the-club-great/",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Dance",
        "day_of_week": "Thursday",
        "start_date": "2025-07-19",
        "end_date": "2025-07-19",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Confederation Centre",
        "description": "Swing Dance Event"
    },
    {
        "source": "https://bcswingdance.ca/index.php/make-the-club-great/",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Dance",
        "day_of_week": "Friday",
        "start_date": "2025-08-16",
        "end_date": "2025-08-16",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Confederation Centre",
        "description": "Swing Dance Event"
    },
    {
        "source": "https://bcswingdance.ca/index.php/make-the-club-great/",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Dance",
        "day_of_week": "Wednesday",
        "start_date": "2025-09-13",
        "end_date": "2025-09-13",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Confederation Centre",
        "description": "Swing Dance Event"
    },
    {
        "source": "https://bcswingdance.ca/index.php/make-the-club-great/",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Dance",
        "day_of_week": "Thursday",
        "start_date": "2025-10-18",
        "end_date": "2025-10-18",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Confederation Centre",
        "description": "Swing Dance Event"
    },
    {
        "source": "https://bcswingdance.ca/index.php/make-the-club-great/",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Dance",
        "day_of_week": "Friday",
        "start_date": "2025-11-29",
        "end_date": "2025-11-29",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Confederation Centre",
        "description": "Swing Dance Event"
    },
    {
        "source": "https://bcswingdance.ca/index.php/make-the-club-great/",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Dance",
        "day_of_week": "Wednesday",
        "start_date": "2025-12-13",
        "end_date": "2025-12-13",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Confederation Centre",
        "description": "Swing Dance Event"
    },
    {
        "source": "https://bcswingdance.ca/index.php/make-the-club-great/",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Dance",
        "day_of_week": "Thursday",
        "start_date": "2025-01-17",
        "end_date": "2025-01-17",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Confederation Centre",
        "description": "Swing Dance Event"
    },
    {
        "source": "https://bcswingdance.ca/index.php/make-the-club-great/",
        "dance_style": "swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "Swing Dance",
        "day_of_week": "Wednesday",
        "start_date": "2026-02-14",
        "end_date": "2026-02-14",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Confederation Centre",
        "description": "Swing Dance Event"
    }
]
2025-06-18 13:25:57 [root] INFO: def clean_up_address(): Starting with events_df shape: (9, 14)
2025-06-18 13:25:57 [root] INFO: def clean_up_address(): Processing location 'Confederation Centre' (event_id: None)
2025-06-18 13:25:57 [root] INFO: def clean_up_address(): Processing location 'Confederation Centre' (event_id: None)
2025-06-18 13:25:57 [root] INFO: def clean_up_address(): Processing location 'Confederation Centre' (event_id: None)
2025-06-18 13:25:57 [root] INFO: def clean_up_address(): Processing location 'Confederation Centre' (event_id: None)
2025-06-18 13:25:57 [root] INFO: def clean_up_address(): Processing location 'Confederation Centre' (event_id: None)
2025-06-18 13:25:57 [root] INFO: def clean_up_address(): Processing location 'Confederation Centre' (event_id: None)
2025-06-18 13:25:57 [root] INFO: def clean_up_address(): Processing location 'Confederation Centre' (event_id: None)
2025-06-18 13:25:57 [root] INFO: def clean_up_address(): Processing location 'Confederation Centre' (event_id: None)
2025-06-18 13:25:57 [root] INFO: def clean_up_address(): Processing location 'Confederation Centre' (event_id: None)
2025-06-18 13:25:57 [root] INFO: write_events_to_db: Number of events to write: 9
2025-06-18 13:25:57 [root] INFO: write_url_to_db(): appended URL 'https://bcswingdance.ca/index.php/make-the-club-great/'
2025-06-18 13:25:57 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:25:57 [root] INFO: def process_llm_response: URL https://bcswingdance.ca/index.php/make-the-club-great/ marked as relevant with events written to the database.
2025-06-18 13:25:57 [root] INFO: write_url_to_db(): appended URL 'https://bcswingdance.ca/index.php/make-the-club-great/'
2025-06-18 13:25:57 [root] INFO: def parse(): URL https://bcswingdance.ca/index.php/make-the-club-great/ marked as relevant (LLM positive).
2025-06-18 13:25:57 [root] INFO: def parse(): Found 10 links on https://bcswingdance.ca/index.php/make-the-club-great/
2025-06-18 13:25:57 [root] INFO: should_process_url: URL https://bcswingdance.ca/ was last seen as relevant, processing it.
2025-06-18 13:25:57 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/current-board-of-directors/ was last seen as relevant, processing it.
2025-06-18 13:25:57 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/make-the-club-great/ was last seen as relevant, processing it.
2025-06-18 13:25:57 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/history/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:25:57 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/documents/ was last seen as relevant, processing it.
2025-06-18 13:25:57 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/board-minutes/ was last seen as relevant, processing it.
2025-06-18 13:25:57 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/about-the-bc-swing-dance-club/ was last seen as relevant, processing it.
2025-06-18 13:25:57 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/membership/ was last seen as relevant, processing it.
2025-06-18 13:25:57 [root] INFO: should_process_url: URL http://bcswingdance.ca was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:25:57 [root] INFO: def parse(): Found keywords for URL https://bcswingdance.ca/index.php/history/: ['dance', 'swing', 'wcs', 'west coast swing']
2025-06-18 13:25:57 [root] INFO: def generate_prompt(): Generating prompt for URL: https://bcswingdance.ca/index.php/history/
2025-06-18 13:25:57 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 13:25:57 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 13:25:57 [root] INFO: query_llm(): Querying Mistral
2025-06-18 13:27:23 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:27:23 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Social Dance",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Confederation Centre in North Burnaby",
        "description": "BC Swing Dance Club Social Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Social Dance",
        "day_of_week": "Friday",
        "start_date": "2025-07-19",
        "end_date": "2025-07-19",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Confederation Centre in North Burnaby",
        "description": "BC Swing Dance Club Social Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Social Dance",
        "day_of_week": "Saturday",
        "start_date": "2025-08-16",
        "end_date": "2025-08-16",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Confederation Centre in North Burnaby",
        "description": "BC Swing Dance Club Social Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Social Dance",
        "day_of_week": "Wednesday",
        "start_date": "2025-09-13",
        "end_date": "2025-09-13",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Confederation Centre in North Burnaby",
        "description": "BC Swing Dance Club Social Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Social Dance",
        "day_of_week": "Thursday",
        "start_date": "2025-10-18",
        "end_date": "2025-10-18",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Confederation Centre in North Burnaby",
        "description": "BC Swing Dance Club Social Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Social Dance",
        "day_of_week": "Saturday",
        "start_date": "2025-11-29",
        "end_date": "2025-11-29",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Confederation Centre in North Burnaby",
        "description": "BC Swing Dance Club Social Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Social Dance",
        "day_of_week": "Friday",
        "start_date": "2025-12-13",
        "end_date": "2025-12-13",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Confederation Centre in North Burnaby",
        "description": "BC Swing Dance Club Social Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Social Dance",
        "day_of_week": "Saturday",
        "start_date": "2026-01-17",
        "end_date": "2026-01-17",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Confederation Centre in North Burnaby",
        "description": "BC Swing Dance Club Social Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Annual General Meeting (AGM)",
        "day_of_week": "Wednesday",
        "start_date": "2026-02-14",
        "end_date": "2026-02-14",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Confederation Centre in North Burnaby",
        "description": "Annual General Meeting (AGM)"
    }
]
2025-06-18 13:27:23 [root] INFO: def extract_and_parse_json(): for url https://bcswingdance.ca/index.php/history/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Social Dance",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Confederation Centre in North Burnaby",
        "description": "BC Swing Dance Club Social Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Social Dance",
        "day_of_week": "Friday",
        "start_date": "2025-07-19",
        "end_date": "2025-07-19",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Confederation Centre in North Burnaby",
        "description": "BC Swing Dance Club Social Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Social Dance",
        "day_of_week": "Saturday",
        "start_date": "2025-08-16",
        "end_date": "2025-08-16",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Confederation Centre in North Burnaby",
        "description": "BC Swing Dance Club Social Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Social Dance",
        "day_of_week": "Wednesday",
        "start_date": "2025-09-13",
        "end_date": "2025-09-13",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Confederation Centre in North Burnaby",
        "description": "BC Swing Dance Club Social Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Social Dance",
        "day_of_week": "Thursday",
        "start_date": "2025-10-18",
        "end_date": "2025-10-18",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Confederation Centre in North Burnaby",
        "description": "BC Swing Dance Club Social Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Social Dance",
        "day_of_week": "Saturday",
        "start_date": "2025-11-29",
        "end_date": "2025-11-29",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Confederation Centre in North Burnaby",
        "description": "BC Swing Dance Club Social Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Social Dance",
        "day_of_week": "Friday",
        "start_date": "2025-12-13",
        "end_date": "2025-12-13",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Confederation Centre in North Burnaby",
        "description": "BC Swing Dance Club Social Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Social Dance",
        "day_of_week": "Saturday",
        "start_date": "2026-01-17",
        "end_date": "2026-01-17",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Confederation Centre in North Burnaby",
        "description": "BC Swing Dance Club Social Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Annual General Meeting (AGM)",
        "day_of_week": "Wednesday",
        "start_date": "2026-02-14",
        "end_date": "2026-02-14",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Confederation Centre in North Burnaby",
        "description": "Annual General Meeting (AGM)"
    }
]
2025-06-18 13:27:24 [root] INFO: def clean_up_address(): Starting with events_df shape: (9, 14)
2025-06-18 13:27:24 [root] INFO: def clean_up_address(): Processing location 'Confederation Centre in North Burnaby' (event_id: None)
2025-06-18 13:27:24 [root] INFO: def clean_up_address(): Processing location 'Confederation Centre in North Burnaby' (event_id: None)
2025-06-18 13:27:24 [root] INFO: def clean_up_address(): Processing location 'Confederation Centre in North Burnaby' (event_id: None)
2025-06-18 13:27:24 [root] INFO: def clean_up_address(): Processing location 'Confederation Centre in North Burnaby' (event_id: None)
2025-06-18 13:27:24 [root] INFO: def clean_up_address(): Processing location 'Confederation Centre in North Burnaby' (event_id: None)
2025-06-18 13:27:24 [root] INFO: def clean_up_address(): Processing location 'Confederation Centre in North Burnaby' (event_id: None)
2025-06-18 13:27:24 [root] INFO: def clean_up_address(): Processing location 'Confederation Centre in North Burnaby' (event_id: None)
2025-06-18 13:27:24 [root] INFO: def clean_up_address(): Processing location 'Confederation Centre in North Burnaby' (event_id: None)
2025-06-18 13:27:24 [root] INFO: def clean_up_address(): Processing location 'Confederation Centre in North Burnaby' (event_id: None)
2025-06-18 13:27:24 [root] INFO: write_events_to_db: Number of events to write: 9
2025-06-18 13:27:24 [root] INFO: write_url_to_db(): appended URL 'https://bcswingdance.ca/index.php/history/'
2025-06-18 13:27:24 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:27:24 [root] INFO: def process_llm_response: URL https://bcswingdance.ca/index.php/history/ marked as relevant with events written to the database.
2025-06-18 13:27:24 [root] INFO: write_url_to_db(): appended URL 'https://bcswingdance.ca/index.php/history/'
2025-06-18 13:27:24 [root] INFO: def parse(): URL https://bcswingdance.ca/index.php/history/ marked as relevant (LLM positive).
2025-06-18 13:27:24 [root] INFO: def parse(): Found 10 links on https://bcswingdance.ca/index.php/history/
2025-06-18 13:27:24 [root] INFO: should_process_url: URL https://bcswingdance.ca/ was last seen as relevant, processing it.
2025-06-18 13:27:24 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/current-board-of-directors/ was last seen as relevant, processing it.
2025-06-18 13:27:24 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/make-the-club-great/ was last seen as relevant, processing it.
2025-06-18 13:27:24 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/history/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:27:24 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/documents/ was last seen as relevant, processing it.
2025-06-18 13:27:24 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/board-minutes/ was last seen as relevant, processing it.
2025-06-18 13:27:24 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/about-the-bc-swing-dance-club/ was last seen as relevant, processing it.
2025-06-18 13:27:24 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/membership/ was last seen as relevant, processing it.
2025-06-18 13:27:24 [root] INFO: should_process_url: URL http://bcswingdance.ca was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:27:24 [root] INFO: def parse(): Found keywords for URL https://thedancestudiofinder.com/dance-studios/categories/night-club-slow/: ['argentine tango', 'bachata', 'balboa', 'cha cha', 'dance', 'east coast swing', 'foxtrot', 'kizomba', 'lindy hop', 'line dance', 'merengue', 'milonga', 'quickstep', 'rumba', 'salsa', 'samba', 'swing', 'tango', 'two step', 'waltz', 'west coast swing', 'zouk']
2025-06-18 13:27:24 [root] INFO: def generate_prompt(): Generating prompt for URL: https://thedancestudiofinder.com/dance-studios/categories/night-club-slow/
2025-06-18 13:27:24 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 13:27:24 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 13:27:24 [root] INFO: query_llm(): Querying Mistral
2025-06-18 13:27:50 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:27:50 [root] INFO: query_llm(): Mistral response received: <meta name="generator" content="Powered by WPBakery Page Builder - drag and drop page builder for WordPress."/>
<!-- Built with WPBakery Page Builder - https://wpbakery.com -->

<!-- Compressed /wp-content/plugins/wp-seo/css/wp-seo.min.css?ver=25.3 using Autoptimize -->
<link rel='stylesheet' id='wp-autop-settings-css' href='https://thedancestudiofinder.com/wp-content/uploads/autoptimize/aggregate.622c61b53a7f85e14c7f82f53794414.css' media='all' />
2025-06-18 13:27:50 [root] ERROR: def extract_and_parse_json(): couldn't isolate JSON blob in result from https://thedancestudiofinder.com/dance-studios/categories/night-club-slow/
2025-06-18 13:27:50 [root] INFO: write_url_to_db(): appended URL 'https://thedancestudiofinder.com/dance-studios/categories/night-club-slow/'
2025-06-18 13:27:50 [root] INFO: def parse(): URL https://thedancestudiofinder.com/dance-studios/categories/night-club-slow/ marked as irrelevant (LLM negative).
2025-06-18 13:27:50 [root] INFO: def parse(): Found 10 links on https://thedancestudiofinder.com/dance-studios/categories/night-club-slow/
2025-06-18 13:27:50 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/contact-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:27:50 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/blog/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:27:50 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/my-account/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:27:50 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/join/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:27:50 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:27:50 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/about-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:27:50 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/dance-studios/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:27:50 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/dance-studios/categories/night-club-slow/ has never been seen before, processing it.
2025-06-18 13:27:50 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/dance-studios/categories/night-club-slow/ has never been seen before, processing it.
2025-06-18 13:27:50 [root] INFO: write_url_to_db(): appended URL 'https://thedancestudiofinder.com/dance-studios/categories/night-club-slow/'
2025-06-18 13:27:50 [root] INFO: def parse(): Crawling next URL: https://thedancestudiofinder.com/dance-studios/categories/night-club-slow/
2025-06-18 13:27:50 [root] INFO: def parse(): Found keywords for URL https://bcswingdance.ca/index.php/board-minutes/: ['dance', 'swing']
2025-06-18 13:27:50 [root] INFO: def generate_prompt(): Generating prompt for URL: https://bcswingdance.ca/index.php/board-minutes/
2025-06-18 13:27:50 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 13:27:50 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 13:27:50 [root] INFO: query_llm(): Querying Mistral
2025-06-18 13:28:48 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:28:48 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "BC Swing Dance Club",
        "dance_style": "social dance, other",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Upcoming Dances",
        "day_of_week": "Friday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "BC Swing Dance Club Upcoming Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "social dance, other",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Upcoming Dances",
        "day_of_week": "Thursday",
        "start_date": "2025-07-19",
        "end_date": "2025-07-19",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "BC Swing Dance Club Upcoming Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "social dance, other",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Upcoming Dances",
        "day_of_week": "Wednesday",
        "start_date": "2025-08-16",
        "end_date": "2025-08-16",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "BC Swing Dance Club Upcoming Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "social dance, other",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Upcoming Dances",
        "day_of_week": "Friday",
        "start_date": "2025-09-13",
        "end_date": "2025-09-13",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "BC Swing Dance Club Upcoming Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "social dance, other",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Upcoming Dances",
        "day_of_week": "Wednesday",
        "start_date": "2025-10-18",
        "end_date": "2025-10-18",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "BC Swing Dance Club Upcoming Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "social dance, other",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Upcoming Dances",
        "day_of_week": "Friday",
        "start_date": "2025-11-29",
        "end_date": "2025-11-29",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "BC Swing Dance Club Upcoming Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "social dance, other",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Upcoming Dances",
        "day_of_week": "Thursday",
        "start_date": "2025-12-13",
        "end_date": "2025-12-13",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "BC Swing Dance Club Upcoming Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "social dance, other",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Upcoming Dances",
        "day_of_week": "Wednesday",
        "start_date": "2026-01-17",
        "end_date": "2026-01-17",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "BC Swing Dance Club Upcoming Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "social dance, other",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Upcoming Dances",
        "day_of_week": "Tuesday",
        "start_date": "2026-02-14",
        "end_date": "2026-02-14",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "BC Swing Dance Club Upcoming Dance"
    }
]
2025-06-18 13:28:48 [root] INFO: def extract_and_parse_json(): for url https://bcswingdance.ca/index.php/board-minutes/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "BC Swing Dance Club",
        "dance_style": "social dance, other",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Upcoming Dances",
        "day_of_week": "Friday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "BC Swing Dance Club Upcoming Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "social dance, other",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Upcoming Dances",
        "day_of_week": "Thursday",
        "start_date": "2025-07-19",
        "end_date": "2025-07-19",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "BC Swing Dance Club Upcoming Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "social dance, other",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Upcoming Dances",
        "day_of_week": "Wednesday",
        "start_date": "2025-08-16",
        "end_date": "2025-08-16",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "BC Swing Dance Club Upcoming Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "social dance, other",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Upcoming Dances",
        "day_of_week": "Friday",
        "start_date": "2025-09-13",
        "end_date": "2025-09-13",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "BC Swing Dance Club Upcoming Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "social dance, other",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Upcoming Dances",
        "day_of_week": "Wednesday",
        "start_date": "2025-10-18",
        "end_date": "2025-10-18",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "BC Swing Dance Club Upcoming Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "social dance, other",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Upcoming Dances",
        "day_of_week": "Friday",
        "start_date": "2025-11-29",
        "end_date": "2025-11-29",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "BC Swing Dance Club Upcoming Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "social dance, other",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Upcoming Dances",
        "day_of_week": "Thursday",
        "start_date": "2025-12-13",
        "end_date": "2025-12-13",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "BC Swing Dance Club Upcoming Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "social dance, other",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Upcoming Dances",
        "day_of_week": "Wednesday",
        "start_date": "2026-01-17",
        "end_date": "2026-01-17",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "BC Swing Dance Club Upcoming Dance"
    },
    {
        "source": "BC Swing Dance Club",
        "dance_style": "social dance, other",
        "url": "",
        "event_type": "social dance",
        "event_name": "BC Swing Dance Club Upcoming Dances",
        "day_of_week": "Tuesday",
        "start_date": "2026-02-14",
        "end_date": "2026-02-14",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "BC Swing Dance Club Upcoming Dance"
    }
]
2025-06-18 13:28:48 [root] INFO: def clean_up_address(): Starting with events_df shape: (9, 14)
2025-06-18 13:28:48 [root] INFO: write_events_to_db: Number of events to write: 9
2025-06-18 13:28:48 [root] INFO: write_url_to_db(): appended URL 'https://bcswingdance.ca/index.php/board-minutes/'
2025-06-18 13:28:48 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:28:48 [root] INFO: def process_llm_response: URL https://bcswingdance.ca/index.php/board-minutes/ marked as relevant with events written to the database.
2025-06-18 13:28:48 [root] INFO: write_url_to_db(): appended URL 'https://bcswingdance.ca/index.php/board-minutes/'
2025-06-18 13:28:48 [root] INFO: def parse(): URL https://bcswingdance.ca/index.php/board-minutes/ marked as relevant (LLM positive).
2025-06-18 13:28:48 [root] INFO: def parse(): Found 10 links on https://bcswingdance.ca/index.php/board-minutes/
2025-06-18 13:28:48 [root] INFO: should_process_url: URL https://bcswingdance.ca/ was last seen as relevant, processing it.
2025-06-18 13:28:48 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/current-board-of-directors/ was last seen as relevant, processing it.
2025-06-18 13:28:48 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/make-the-club-great/ was last seen as relevant, processing it.
2025-06-18 13:28:48 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/history/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:28:48 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/documents/ was last seen as relevant, processing it.
2025-06-18 13:28:48 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/board-minutes/ was last seen as relevant, processing it.
2025-06-18 13:28:48 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/about-the-bc-swing-dance-club/ was last seen as relevant, processing it.
2025-06-18 13:28:48 [root] INFO: should_process_url: URL https://bcswingdance.ca/index.php/membership/ was last seen as relevant, processing it.
2025-06-18 13:28:48 [root] INFO: should_process_url: URL http://bcswingdance.ca was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:28:48 [root] INFO: def parse(): Found keywords for URL https://www.bazadance.com/: ['bachata', 'dance', 'kizomba', 'salsa', 'zouk']
2025-06-18 13:28:48 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.bazadance.com/
2025-06-18 13:28:48 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 13:28:48 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 13:28:48 [root] INFO: query_llm(): Querying Mistral
2025-06-18 13:30:26 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:30:26 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "www.bazadance.com",
        "dance_style": "bachata, salsa, kizomba, brazilian zouk",
        "url": "",
        "event_type": "rehearsal",
        "event_name": "Saturday Practica",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Baza Dance Studios, 1304 Seymour St, Vancouver",
        "description": "8-Week Progressive Courses | No Partner Required"
    },
    {
        "source": "www.bazadance.com",
        "dance_style": "bachata, salsa, kizomba, brazilian zouk",
        "url": "",
        "event_type": "social dance",
        "event_name": "Baza Friday",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Baza Dance Studios, 1304 Seymour St, Vancouver",
        "description": "8-Week Progressive Courses | No Partner Required"
    },
    {
        "source": "www.bazadance.com",
        "dance_style": "bachata",
        "url": "",
        "event_type": "class",
        "event_name": "Bachata Body Movement and Styling - Beginner",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Baza Dance Studios, 1304 Seymour St, Vancouver",
        "description": ""
    },
    {
        "source": "www.bazadance.com",
        "dance_style": "bachata",
        "url": "",
        "event_type": "class",
        "event_name": "Femme Bachatitude - Intermediate",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Baza Dance Studios, 1304 Seymour St, Vancouver",
        "description": ""
    },
    {
        "source": "www.bazadance.com",
        "dance_style": "bachata",
        "url": "",
        "event_type": "class",
        "event_name": "Bachata Swag",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Baza Dance Studios, 1304 Seymour St, Vancouver",
        "description": ""
    },
    {
        "source": "www.bazadance.com",
        "dance_style": "bachata",
        "url": "",
        "event_type": "class",
        "event_name": "Dominican Bachata Footwork",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Baza Dance Studios, 1304 Seymour St, Vancouver",
        "description": ""
    },
    {
        "source": "www.bazadance.com",
        "dance_style": "salsa",
        "url": "",
        "event_type": "class",
        "event_name": "Salsa (on1) Footwork & Styling (Exp Beg)",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Baza Dance Studios, 1304 Seymour St, Vancouver",
        "description": ""
    },
    {
        "source": "www.bazadance.com",
        "dance_style": "salsa",
        "url": "",
        "event_type": "class",
        "event_name": "Salsa (on2) Body Movement & Styling (Exp Beg/Int)",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Baza Dance Studios, 1304 Seymour St, Vancouver",
        "description": ""
    },
    {
        "source": "www.bazadance.com",
        "dance_style": "salsa",
        "url": "",
        "event_type": "class",
        "event_name": "Salsa (on2) Dance Technique & Drills (Int/Adv)",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Baza Dance Studios, 1304 Seymour St, Vancouver",
        "description": ""
    },
    {
        "source": "www.bazadance.com",
        "dance_style": "salsa",
        "url": "",
        "event_type": "class",
        "event_name": "Salsa (on1) Footwork & Styling (Exp Beg)",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Baza Dance Studios, 1304 Seymour St, Vancouver",
        "description": ""
    },
    {
        "source": "www.bazadance.com",
        "dance_style": "zumba",
        "url": "",
        "event_type": "class",
        "event_name": "Zumba",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Baza Dance Studios, 1304 Seymour St, Vancouver",
        "description": ""
    },
    {
        "source": "www.bazadance.com",
        "dance_style": "reggaeton",
        "url": "",
        "event_type": "class",
        "event_name": "Reggaeton Grooving (Beg)",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Baza Dance Studios, 1304 Seymour St, Vancouver",
        "description": ""
    },
    {
        "source": "www.bazadance.com",
        "dance_style": "reggaeton",
        "url": "",
        "event_type": "class",
        "event_name": "Reggaeton Choreography (Exp Beg-Int)",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Baza Dance Studios, 1304 Seymour St, Vancouver",
        "description": ""
    }
]
2025-06-18 13:30:26 [root] INFO: def extract_and_parse_json(): for url https://www.bazadance.com/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "www.bazadance.com",
        "dance_style": "bachata, salsa, kizomba, brazilian zouk",
        "url": "",
        "event_type": "rehearsal",
        "event_name": "Saturday Practica",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Baza Dance Studios, 1304 Seymour St, Vancouver",
        "description": "8-Week Progressive Courses | No Partner Required"
    },
    {
        "source": "www.bazadance.com",
        "dance_style": "bachata, salsa, kizomba, brazilian zouk",
        "url": "",
        "event_type": "social dance",
        "event_name": "Baza Friday",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Baza Dance Studios, 1304 Seymour St, Vancouver",
        "description": "8-Week Progressive Courses | No Partner Required"
    },
    {
        "source": "www.bazadance.com",
        "dance_style": "bachata",
        "url": "",
        "event_type": "class",
        "event_name": "Bachata Body Movement and Styling - Beginner",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Baza Dance Studios, 1304 Seymour St, Vancouver",
        "description": ""
    },
    {
        "source": "www.bazadance.com",
        "dance_style": "bachata",
        "url": "",
        "event_type": "class",
        "event_name": "Femme Bachatitude - Intermediate",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Baza Dance Studios, 1304 Seymour St, Vancouver",
        "description": ""
    },
    {
        "source": "www.bazadance.com",
        "dance_style": "bachata",
        "url": "",
        "event_type": "class",
        "event_name": "Bachata Swag",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Baza Dance Studios, 1304 Seymour St, Vancouver",
        "description": ""
    },
    {
        "source": "www.bazadance.com",
        "dance_style": "bachata",
        "url": "",
        "event_type": "class",
        "event_name": "Dominican Bachata Footwork",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Baza Dance Studios, 1304 Seymour St, Vancouver",
        "description": ""
    },
    {
        "source": "www.bazadance.com",
        "dance_style": "salsa",
        "url": "",
        "event_type": "class",
        "event_name": "Salsa (on1) Footwork & Styling (Exp Beg)",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Baza Dance Studios, 1304 Seymour St, Vancouver",
        "description": ""
    },
    {
        "source": "www.bazadance.com",
        "dance_style": "salsa",
        "url": "",
        "event_type": "class",
        "event_name": "Salsa (on2) Body Movement & Styling (Exp Beg/Int)",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Baza Dance Studios, 1304 Seymour St, Vancouver",
        "description": ""
    },
    {
        "source": "www.bazadance.com",
        "dance_style": "salsa",
        "url": "",
        "event_type": "class",
        "event_name": "Salsa (on2) Dance Technique & Drills (Int/Adv)",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Baza Dance Studios, 1304 Seymour St, Vancouver",
        "description": ""
    },
    {
        "source": "www.bazadance.com",
        "dance_style": "salsa",
        "url": "",
        "event_type": "class",
        "event_name": "Salsa (on1) Footwork & Styling (Exp Beg)",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Baza Dance Studios, 1304 Seymour St, Vancouver",
        "description": ""
    },
    {
        "source": "www.bazadance.com",
        "dance_style": "zumba",
        "url": "",
        "event_type": "class",
        "event_name": "Zumba",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Baza Dance Studios, 1304 Seymour St, Vancouver",
        "description": ""
    },
    {
        "source": "www.bazadance.com",
        "dance_style": "reggaeton",
        "url": "",
        "event_type": "class",
        "event_name": "Reggaeton Grooving (Beg)",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Baza Dance Studios, 1304 Seymour St, Vancouver",
        "description": ""
    },
    {
        "source": "www.bazadance.com",
        "dance_style": "reggaeton",
        "url": "",
        "event_type": "class",
        "event_name": "Reggaeton Choreography (Exp Beg-Int)",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Baza Dance Studios, 1304 Seymour St, Vancouver",
        "description": ""
    }
]
2025-06-18 13:30:26 [root] INFO: def clean_up_address(): Starting with events_df shape: (13, 14)
2025-06-18 13:30:26 [root] INFO: def clean_up_address(): Processing location 'Baza Dance Studios, 1304 Seymour St, Vancouver' (event_id: None)
2025-06-18 13:30:26 [root] INFO: def clean_up_address(): Updated event None with address_id 2642 using DB match
2025-06-18 13:30:26 [root] INFO: def clean_up_address(): Processing location 'Baza Dance Studios, 1304 Seymour St, Vancouver' (event_id: None)
2025-06-18 13:30:26 [root] INFO: def clean_up_address(): Updated event None with address_id 2642 using DB match
2025-06-18 13:30:26 [root] INFO: def clean_up_address(): Processing location 'Baza Dance Studios, 1304 Seymour St, Vancouver' (event_id: None)
2025-06-18 13:30:26 [root] INFO: def clean_up_address(): Updated event None with address_id 2642 using DB match
2025-06-18 13:30:26 [root] INFO: def clean_up_address(): Processing location 'Baza Dance Studios, 1304 Seymour St, Vancouver' (event_id: None)
2025-06-18 13:30:26 [root] INFO: def clean_up_address(): Updated event None with address_id 2642 using DB match
2025-06-18 13:30:26 [root] INFO: def clean_up_address(): Processing location 'Baza Dance Studios, 1304 Seymour St, Vancouver' (event_id: None)
2025-06-18 13:30:26 [root] INFO: def clean_up_address(): Updated event None with address_id 2642 using DB match
2025-06-18 13:30:26 [root] INFO: def clean_up_address(): Processing location 'Baza Dance Studios, 1304 Seymour St, Vancouver' (event_id: None)
2025-06-18 13:30:26 [root] INFO: def clean_up_address(): Updated event None with address_id 2642 using DB match
2025-06-18 13:30:26 [root] INFO: def clean_up_address(): Processing location 'Baza Dance Studios, 1304 Seymour St, Vancouver' (event_id: None)
2025-06-18 13:30:26 [root] INFO: def clean_up_address(): Updated event None with address_id 2642 using DB match
2025-06-18 13:30:26 [root] INFO: def clean_up_address(): Processing location 'Baza Dance Studios, 1304 Seymour St, Vancouver' (event_id: None)
2025-06-18 13:30:26 [root] INFO: def clean_up_address(): Updated event None with address_id 2642 using DB match
2025-06-18 13:30:26 [root] INFO: def clean_up_address(): Processing location 'Baza Dance Studios, 1304 Seymour St, Vancouver' (event_id: None)
2025-06-18 13:30:26 [root] INFO: def clean_up_address(): Updated event None with address_id 2642 using DB match
2025-06-18 13:30:26 [root] INFO: def clean_up_address(): Processing location 'Baza Dance Studios, 1304 Seymour St, Vancouver' (event_id: None)
2025-06-18 13:30:26 [root] INFO: def clean_up_address(): Updated event None with address_id 2642 using DB match
2025-06-18 13:30:26 [root] INFO: def clean_up_address(): Processing location 'Baza Dance Studios, 1304 Seymour St, Vancouver' (event_id: None)
2025-06-18 13:30:26 [root] INFO: def clean_up_address(): Updated event None with address_id 2642 using DB match
2025-06-18 13:30:26 [root] INFO: def clean_up_address(): Processing location 'Baza Dance Studios, 1304 Seymour St, Vancouver' (event_id: None)
2025-06-18 13:30:26 [root] INFO: def clean_up_address(): Updated event None with address_id 2642 using DB match
2025-06-18 13:30:26 [root] INFO: def clean_up_address(): Processing location 'Baza Dance Studios, 1304 Seymour St, Vancouver' (event_id: None)
2025-06-18 13:30:26 [root] INFO: def clean_up_address(): Updated event None with address_id 2642 using DB match
2025-06-18 13:30:26 [root] INFO: write_events_to_db: Number of events to write: 13
2025-06-18 13:30:26 [root] INFO: write_url_to_db(): appended URL 'https://www.bazadance.com/'
2025-06-18 13:30:26 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:30:26 [root] INFO: def process_llm_response: URL https://www.bazadance.com/ marked as relevant with events written to the database.
2025-06-18 13:30:26 [root] INFO: write_url_to_db(): appended URL 'https://www.bazadance.com/'
2025-06-18 13:30:26 [root] INFO: def parse(): URL https://www.bazadance.com/ marked as relevant (LLM positive).
2025-06-18 13:30:26 [root] INFO: def parse(): Found 6 links on https://www.bazadance.com/
2025-06-18 13:30:26 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://widgets.sociablekit.com/google-reviews/iframe/25424951, URL: https://www.bazadance.com/, source: Beginner Latin Dance and Fitness Classes in Downtown Vancouver, keywords: zouk
2025-06-18 13:30:26 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: '`z,ȚnW((	^{?ڙ獸
2025-06-18 13:30:26 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://widgets.sociablekit.com/google-reviews/iframe/25424951
2025-06-18 13:30:26 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-PLMCM3X, URL: https://www.bazadance.com/, source: Beginner Latin Dance and Fitness Classes in Downtown Vancouver, keywords: zouk
2025-06-18 13:30:26 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 13:30:26 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-PLMCM3X
2025-06-18 13:30:26 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-PLMCM3X'
2025-06-18 13:30:26 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/events/534934322307160/534934355640490/?active_tab=about'
2025-06-18 13:30:26 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/events/534934322307160/534934355640490/?active_tab=about
2025-06-18 13:30:26 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/bazadancestudios/'
2025-06-18 13:30:26 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/bazadancestudios/
2025-06-18 13:30:26 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/bazadance?_rdr=p'
2025-06-18 13:30:26 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/bazadance?_rdr=p
2025-06-18 13:30:26 [root] INFO: should_process_url: URL https://www.wellnessliving.com/rs/event/baza?k_class=793226&k_class_tab=31450 was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:30:26 [root] INFO: should_process_url: URL https://www.wellnessliving.com/rs/event/baza?k_class=793226&k_class_tab=31450 was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:30:26 [root] INFO: write_url_to_db(): appended URL 'https://www.wellnessliving.com/rs/event/baza?k_class=793226&k_class_tab=31450'
2025-06-18 13:30:26 [root] INFO: def parse(): Crawling next URL: https://www.wellnessliving.com/rs/event/baza?k_class=793226&k_class_tab=31450
2025-06-18 13:30:26 [root] INFO: write_url_to_db(): appended URL 'https://victoriasymphony.ca/contact-us/'
2025-06-18 13:30:26 [root] INFO: def parse(): URL https://victoriasymphony.ca/contact-us/ marked as irrelevant (no keywords).
2025-06-18 13:30:26 [root] INFO: def parse(): Found 10 links on https://victoriasymphony.ca/contact-us/
2025-06-18 13:30:26 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5RJF5B3, URL: https://victoriasymphony.ca/contact-us/, source: Victoria Symphony: Home, keywords: outdoor music
2025-06-18 13:30:26 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 13:30:26 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5RJF5B3
2025-06-18 13:30:26 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-5RJF5B3'
2025-06-18 13:30:26 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/vicsymphony/'
2025-06-18 13:30:26 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/vicsymphony/
2025-06-18 13:30:26 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/vicsymphony'
2025-06-18 13:30:26 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/vicsymphony
2025-06-18 13:30:26 [root] INFO: should_process_url: URL https://victoriasymphony.ca/contact-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:30:26 [root] INFO: should_process_url: URL https://victoriasymphony.ca/support/donations/how-to-donate/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:30:26 [root] INFO: should_process_url: URL https://victoriasymphony.ca/concerts-events/#concertseries was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:30:26 [root] INFO: should_process_url: URL https://victoriasymphony.ca/concerts-events/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:30:26 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/VicSymphony.
2025-06-18 13:30:26 [root] INFO: should_process_url: URL https://victoriasymphony.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:30:26 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/user/VictoriaSymphony.
2025-06-18 13:30:26 [root] INFO: should_process_url: URL https://victoriasymphony.ca/cart/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:30:26 [scrapy.extensions.logstats] INFO: Crawled 67 pages (at 15 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 13:30:26 [root] INFO: should_process_url: URL https://www.bazadance.com/ was last seen as relevant, processing it.
2025-06-18 13:30:26 [root] INFO: should_process_url: URL https://www.bazadance.com/ was last seen as relevant, processing it.
2025-06-18 13:30:26 [root] INFO: write_url_to_db(): appended URL 'https://www.bazadance.com/'
2025-06-18 13:30:26 [root] INFO: def parse(): Crawling next URL: https://www.bazadance.com/
2025-06-18 13:30:26 [root] INFO: should_process_url: URL https://www.wellnessliving.com/rs/schedule/baza?k_business=306611&k_class_tab=29432&uid=15733813&id_class_tab=1 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 13:30:26 [root] INFO: should_process_url: URL https://www.wellnessliving.com/rs/schedule/baza?k_business=306611&k_class_tab=29432&uid=15733813&id_class_tab=1 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 13:30:26 [root] INFO: write_url_to_db(): appended URL 'https://www.wellnessliving.com/rs/schedule/baza?k_business=306611&k_class_tab=29432&uid=15733813&id_class_tab=1'
2025-06-18 13:30:26 [root] INFO: def parse(): Crawling next URL: https://www.wellnessliving.com/rs/schedule/baza?k_business=306611&k_class_tab=29432&uid=15733813&id_class_tab=1
2025-06-18 13:30:26 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <403 https://tickets.butchartgardens.com/WebStore/shop/viewItems.aspx?cg=tt&c=DAtt>: HTTP status code is not handled or not allowed
2025-06-18 13:30:26 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/garden/italian-garden/'
2025-06-18 13:30:26 [root] INFO: def parse(): URL https://butchartgardens.com/garden/italian-garden/ marked as irrelevant (no keywords).
2025-06-18 13:30:26 [root] INFO: def parse(): Found 10 links on https://butchartgardens.com/garden/italian-garden/
2025-06-18 13:30:26 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/mediterranean-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:30:26 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/sunken-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:30:26 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/italian-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:30:26 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/rose-garden/ was last seen as relevant, processing it.
2025-06-18 13:30:26 [root] INFO: should_process_url: URL https://butchartgardens.com/how-to-get-here/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:30:26 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/japanese-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:30:26 [root] INFO: should_process_url: URL https://tickets.butchartgardens.com/WebStore/shop/viewItems.aspx?cg=tt&c=DAtt was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:30:26 [root] INFO: should_process_url: URL https://butchartgardens.com/hours-rates/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:30:26 [root] INFO: should_process_url: URL https://butchartgardens.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:30:26 [root] INFO: def parse(): Found keywords for URL https://butchartgardens.com/how-to-get-here/: ['semba']
2025-06-18 13:30:26 [root] INFO: def generate_prompt(): Generating prompt for URL: https://butchartgardens.com/how-to-get-here/
2025-06-18 13:30:26 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 13:30:26 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 13:30:26 [root] INFO: query_llm(): Querying Mistral
2025-06-18 13:30:51 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:30:51 [root] INFO: query_llm(): Mistral response received: 6.9 ms of database time saved by 6.9 ms of database time saved by 166 queries
2025-06-18 13:30:51 [root] INFO: def extract_and_parse_json(): No valid events found in result.
2025-06-18 13:30:51 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/how-to-get-here/'
2025-06-18 13:30:51 [root] INFO: def parse(): URL https://butchartgardens.com/how-to-get-here/ marked as irrelevant (LLM negative).
2025-06-18 13:30:51 [root] INFO: def parse(): Found 10 links on https://butchartgardens.com/how-to-get-here/
2025-06-18 13:30:51 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/mediterranean-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:30:51 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/sunken-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:30:51 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/italian-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:30:51 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/rose-garden/ was last seen as relevant, processing it.
2025-06-18 13:30:51 [root] INFO: should_process_url: URL https://butchartgardens.com/how-to-get-here/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:30:51 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/japanese-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:30:51 [root] INFO: should_process_url: URL https://tickets.butchartgardens.com/WebStore/shop/viewItems.aspx?cg=tt&c=DAtt was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:30:51 [root] INFO: should_process_url: URL https://butchartgardens.com/hours-rates/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:30:51 [root] INFO: should_process_url: URL https://butchartgardens.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:30:51 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/hours-rates/'
2025-06-18 13:30:51 [root] INFO: def parse(): URL https://butchartgardens.com/hours-rates/ marked as irrelevant (no keywords).
2025-06-18 13:30:51 [root] INFO: def parse(): Found 10 links on https://butchartgardens.com/hours-rates/
2025-06-18 13:30:51 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/mediterranean-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:30:51 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/sunken-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:30:51 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/italian-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:30:51 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/rose-garden/ was last seen as relevant, processing it.
2025-06-18 13:30:51 [root] INFO: should_process_url: URL https://butchartgardens.com/how-to-get-here/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:30:51 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/japanese-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:30:51 [root] INFO: should_process_url: URL https://tickets.butchartgardens.com/WebStore/shop/viewItems.aspx?cg=tt&c=DAtt was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:30:51 [root] INFO: should_process_url: URL https://butchartgardens.com/hours-rates/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:30:51 [root] INFO: should_process_url: URL https://butchartgardens.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:30:51 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/garden/japanese-garden/'
2025-06-18 13:30:51 [root] INFO: def parse(): URL https://butchartgardens.com/garden/japanese-garden/ marked as irrelevant (no keywords).
2025-06-18 13:30:51 [root] INFO: def parse(): Found 10 links on https://butchartgardens.com/garden/japanese-garden/
2025-06-18 13:30:51 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/mediterranean-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:30:51 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/sunken-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:30:51 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/italian-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:30:51 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/rose-garden/ was last seen as relevant, processing it.
2025-06-18 13:30:51 [root] INFO: should_process_url: URL https://butchartgardens.com/how-to-get-here/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:30:51 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/japanese-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:30:51 [root] INFO: should_process_url: URL https://tickets.butchartgardens.com/WebStore/shop/viewItems.aspx?cg=tt&c=DAtt was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:30:51 [root] INFO: should_process_url: URL https://butchartgardens.com/hours-rates/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:30:51 [root] INFO: should_process_url: URL https://butchartgardens.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:30:51 [root] INFO: def parse(): Found keywords for URL https://butchartgardens.com/garden/rose-garden/: ['dance']
2025-06-18 13:30:51 [root] INFO: def generate_prompt(): Generating prompt for URL: https://butchartgardens.com/garden/rose-garden/
2025-06-18 13:30:51 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 13:30:51 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 13:30:51 [root] INFO: query_llm(): Querying Mistral
2025-06-18 13:31:52 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:31:52 [root] INFO: query_llm(): Mistral response received: 1. **Extract**

The webpage's text contains several events. Here they are:

1. **Event**: Summer Firework Saturdays
   - **Source**: The Butchart Gardens
   - **Dance Style**: ''
   - **URL**: ''
   - **Event Type**: social dance
   - **Event Name**: Summer Firework Saturdays
   - **Day of the Week**: Saturday
   - **Start Date**: 2025-06-21
   - **End Date**: 2025-06-21
   - **Start Time**: 20:00
   - **End Time**: 00:00
   - **Price**: ''
   - **Location**: The Butchart Gardens
   - **Description**: ''

2. **Event**: Rose Garden
   - **Source**: The Butchart Gardens
   - **Dance Style**: ''
   - **URL**: ''
   - **Event Type**: other
   - **Event Name**: Rose Garden
   - **Day of the Week**: ''
   - **Start Date**: 2025-01-06
   - **End Date**: 2025-01-06
   - **Start Time**: ''
   - **End Time**: ''
   - **Price**: ''
   - **Location**: The Butchart Gardens
   - **Description**: Vibrant colours and luscious scents
2025-06-18 13:31:52 [root] ERROR: def extract_and_parse_json(): couldn't isolate JSON blob in result from https://butchartgardens.com/garden/rose-garden/
2025-06-18 13:31:52 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/garden/rose-garden/'
2025-06-18 13:31:52 [root] INFO: def parse(): URL https://butchartgardens.com/garden/rose-garden/ marked as irrelevant (LLM negative).
2025-06-18 13:31:52 [root] INFO: def parse(): Found 10 links on https://butchartgardens.com/garden/rose-garden/
2025-06-18 13:31:52 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/mediterranean-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:31:52 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/sunken-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:31:52 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/italian-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:31:52 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/rose-garden/ was last seen as relevant, processing it.
2025-06-18 13:31:52 [root] INFO: should_process_url: URL https://butchartgardens.com/how-to-get-here/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:31:52 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/japanese-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:31:52 [root] INFO: should_process_url: URL https://tickets.butchartgardens.com/WebStore/shop/viewItems.aspx?cg=tt&c=DAtt was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:31:52 [root] INFO: should_process_url: URL https://butchartgardens.com/hours-rates/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:31:52 [root] INFO: should_process_url: URL https://butchartgardens.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:31:52 [root] INFO: def parse(): Found keywords for URL https://thedancestudiofinder.com/join/: ['dance', 'quickstep']
2025-06-18 13:31:52 [root] INFO: def generate_prompt(): Generating prompt for URL: https://thedancestudiofinder.com/join/
2025-06-18 13:31:52 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 13:31:52 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 13:31:52 [root] INFO: query_llm(): Querying Mistral
2025-06-18 13:32:58 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:32:58 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "The Dance Studio Finder - Join",
        "dance_style": "",
        "url": "",
        "event_type": "rehearsal",
        "event_name": "Dancers Community User Account",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "11:00",
        "end_time": "null",
        "price": "$0",
        "location": "The Dance Studio Finder",
        "description": "Become a community user for free and enjoy the following benefits: Save your favorite dance studios. Get notified when studios update their listings. Get informative articles on the latest in Dance, new features and more. Sign-up today."
    },
    {
        "source": "The Dance Studio Finder - Join",
        "dance_style": "",
        "url": "",
        "event_type": "rehearsal",
        "event_name": "Dance Studio Owners Free Listings",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "11:00",
        "end_time": "null",
        "price": "$0",
        "location": "The Dance Studio Finder",
        "description": "Our FREE Listing package has less features and available fields, but it is perfect for getting started! Create your listing in just minutes. Easily update your listing anytime. FREE info includes: your studio name, year opened, brief studio description, your address, phone number, map and driving directions, website link, dance styles, age groups, ability levels, and your optional COVID policies. Inclusion in our searchable database of studios where customers can search for you by location, dance styles taught, age groups, and ability levels. Secure inquiry form that goes direct to you. Upgrade at anytime."
    },
    {
        "source": "The Dance Studio Finder - Join",
        "dance_style": "",
        "url": "",
        "event_type": "rehearsal",
        "event_name": "Dance Studio Owners Premium Listings",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "11:00",
        "end_time": "null",
        "price": "$0",
        "location": "The Dance Studio Finder",
        "description": "Our affordable Premium Dance Studio Listing package is ideal for dance studio owners that want to get a “leg up” on the competition and share more about their studio with the community! Create your listing in just minutes. Easily update your listing anytime. FREE info includes: your studio name, year opened, brief studio description, your address, phone number, map and driving directions, website link, dance styles, age groups, ability levels, and your optional COVID policies. Premium info includes: studio logo, studio hours, studio amenities, available performing opportunities, current studio news, specialized programs and classes, customer testimonials, awards and accolades received, performing alumni, staff qualifications and certifications, tags, and social media links. Inclusion in our searchable database of studios where customers can search for you by location, dance styles taught, age groups, and ability levels. Secure inquiry form that goes direct to you. Photo Gallery to share your studio and students photos with the community. Video Gallery to share your promotional studio videos and performance clips. Upload and share your current dance class schedule, upcoming performances and studio events, sales and specials, and more! “Featured Dance Studio” post on TheDanceStudioFinder blog. This allows us to further showcase your studio on our social media platforms and bring additional visibility to your business. Cancel at anytime."
    }
]
2025-06-18 13:32:58 [root] INFO: def extract_and_parse_json(): for url https://thedancestudiofinder.com/join/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "The Dance Studio Finder - Join",
        "dance_style": "",
        "url": "",
        "event_type": "rehearsal",
        "event_name": "Dancers Community User Account",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "11:00",
        "end_time": "null",
        "price": "$0",
        "location": "The Dance Studio Finder",
        "description": "Become a community user for free and enjoy the following benefits: Save your favorite dance studios. Get notified when studios update their listings. Get informative articles on the latest in Dance, new features and more. Sign-up today."
    },
    {
        "source": "The Dance Studio Finder - Join",
        "dance_style": "",
        "url": "",
        "event_type": "rehearsal",
        "event_name": "Dance Studio Owners Free Listings",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "11:00",
        "end_time": "null",
        "price": "$0",
        "location": "The Dance Studio Finder",
        "description": "Our FREE Listing package has less features and available fields, but it is perfect for getting started! Create your listing in just minutes. Easily update your listing anytime. FREE info includes: your studio name, year opened, brief studio description, your address, phone number, map and driving directions, website link, dance styles, age groups, ability levels, and your optional COVID policies. Inclusion in our searchable database of studios where customers can search for you by location, dance styles taught, age groups, and ability levels. Secure inquiry form that goes direct to you. Upgrade at anytime."
    },
    {
        "source": "The Dance Studio Finder - Join",
        "dance_style": "",
        "url": "",
        "event_type": "rehearsal",
        "event_name": "Dance Studio Owners Premium Listings",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "11:00",
        "end_time": "null",
        "price": "$0",
        "location": "The Dance Studio Finder",
        "description": "Our affordable Premium Dance Studio Listing package is ideal for dance studio owners that want to get a “leg up” on the competition and share more about their studio with the community! Create your listing in just minutes. Easily update your listing anytime. FREE info includes: your studio name, year opened, brief studio description, your address, phone number, map and driving directions, website link, dance styles, age groups, ability levels, and your optional COVID policies. Premium info includes: studio logo, studio hours, studio amenities, available performing opportunities, current studio news, specialized programs and classes, customer testimonials, awards and accolades received, performing alumni, staff qualifications and certifications, tags, and social media links. Inclusion in our searchable database of studios where customers can search for you by location, dance styles taught, age groups, and ability levels. Secure inquiry form that goes direct to you. Photo Gallery to share your studio and students photos with the community. Video Gallery to share your promotional studio videos and performance clips. Upload and share your current dance class schedule, upcoming performances and studio events, sales and specials, and more! “Featured Dance Studio” post on TheDanceStudioFinder blog. This allows us to further showcase your studio on our social media platforms and bring additional visibility to your business. Cancel at anytime."
    }
]
2025-06-18 13:32:58 [root] INFO: def clean_up_address(): Starting with events_df shape: (3, 14)
2025-06-18 13:32:58 [root] INFO: def clean_up_address(): Processing location 'The Dance Studio Finder' (event_id: None)
2025-06-18 13:32:58 [root] INFO: def clean_up_address(): Processing location 'The Dance Studio Finder' (event_id: None)
2025-06-18 13:32:58 [root] INFO: def clean_up_address(): Processing location 'The Dance Studio Finder' (event_id: None)
2025-06-18 13:32:58 [root] INFO: write_events_to_db: Number of events to write: 3
2025-06-18 13:32:58 [root] INFO: write_url_to_db(): appended URL 'https://thedancestudiofinder.com/join/'
2025-06-18 13:32:58 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:32:58 [root] INFO: def process_llm_response: URL https://thedancestudiofinder.com/join/ marked as relevant with events written to the database.
2025-06-18 13:32:58 [root] INFO: write_url_to_db(): appended URL 'https://thedancestudiofinder.com/join/'
2025-06-18 13:32:58 [root] INFO: def parse(): URL https://thedancestudiofinder.com/join/ marked as relevant (LLM positive).
2025-06-18 13:32:58 [root] INFO: def parse(): Found 10 links on https://thedancestudiofinder.com/join/
2025-06-18 13:32:58 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/contact-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:32:58 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/blog/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:32:58 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/my-account/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:32:58 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/join/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:32:58 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:32:58 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/about-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:32:58 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/dance-studios/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:32:58 [root] INFO: def parse(): Found keywords for URL https://thedancestudiofinder.com/: ['argentine tango', 'bachata', 'balboa', 'cha cha', 'dance', 'east coast swing', 'foxtrot', 'kizomba', 'lindy hop', 'line dance', 'merengue', 'milonga', 'quickstep', 'rumba', 'salsa', 'samba', 'swing', 'tango', 'two step', 'waltz', 'west coast swing', 'zouk']
2025-06-18 13:32:58 [root] INFO: def generate_prompt(): Generating prompt for URL: https://thedancestudiofinder.com/
2025-06-18 13:32:58 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 13:32:58 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 13:32:58 [root] INFO: query_llm(): Querying Mistral
2025-06-18 13:33:00 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 13:33:00 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 179223 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 13:33:00 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 13:33:11 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:33:11 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 13:33:11 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 13:33:11 [root] INFO: write_url_to_db(): appended URL 'https://thedancestudiofinder.com/'
2025-06-18 13:33:11 [root] INFO: def parse(): URL https://thedancestudiofinder.com/ marked as irrelevant (LLM negative).
2025-06-18 13:33:11 [root] INFO: def parse(): Found 10 links on https://thedancestudiofinder.com/
2025-06-18 13:33:11 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/contact-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:33:11 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/blog/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:33:11 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/my-account/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:33:11 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/join/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:33:11 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:33:11 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/about-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:33:11 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/dance-studios/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:33:11 [root] INFO: def parse(): Found keywords for URL https://thedancestudiofinder.com/about-us/: ['dance', 'quickstep']
2025-06-18 13:33:11 [root] INFO: def generate_prompt(): Generating prompt for URL: https://thedancestudiofinder.com/about-us/
2025-06-18 13:33:11 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 13:33:11 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 13:33:11 [root] INFO: query_llm(): Querying Mistral
2025-06-18 13:33:37 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:33:37 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "https://thedancestudiofinder.com/dance-studios/categories/quickstep",
        "dance_style": "ballet, jazz, ballroom, lyrical, world, dance fitness",
        "url": "",
        "event_type": "social dance",
        "event_name": "TheDanceStudioFinder.com",
        "day_of_week": "Monday",
        "start_date": "2025-06-24",
        "end_date": "2025-06-24",
        "start_time": "19:00",
        "end_time": "21:00",
        "price": "$15",
        "location": "The Dance Studio Finder, Seattle",
        "description": "TheDanceStudioFinder.com was developed to help parents and dancers locate the perfect dance studio through an easy-to-use custom search engine."
    }
]
2025-06-18 13:33:37 [root] INFO: def extract_and_parse_json(): for url https://thedancestudiofinder.com/about-us/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "https://thedancestudiofinder.com/dance-studios/categories/quickstep",
        "dance_style": "ballet, jazz, ballroom, lyrical, world, dance fitness",
        "url": "",
        "event_type": "social dance",
        "event_name": "TheDanceStudioFinder.com",
        "day_of_week": "Monday",
        "start_date": "2025-06-24",
        "end_date": "2025-06-24",
        "start_time": "19:00",
        "end_time": "21:00",
        "price": "$15",
        "location": "The Dance Studio Finder, Seattle",
        "description": "TheDanceStudioFinder.com was developed to help parents and dancers locate the perfect dance studio through an easy-to-use custom search engine."
    }
]
2025-06-18 13:33:37 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:33:37 [root] INFO: def clean_up_address(): Processing location 'The Dance Studio Finder, Seattle' (event_id: None)
2025-06-18 13:33:37 [root] INFO: write_events_to_db: Number of events to write: 1
2025-06-18 13:33:37 [root] INFO: write_url_to_db(): appended URL 'https://thedancestudiofinder.com/about-us/'
2025-06-18 13:33:37 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:33:37 [root] INFO: def process_llm_response: URL https://thedancestudiofinder.com/about-us/ marked as relevant with events written to the database.
2025-06-18 13:33:37 [root] INFO: write_url_to_db(): appended URL 'https://thedancestudiofinder.com/about-us/'
2025-06-18 13:33:37 [root] INFO: def parse(): URL https://thedancestudiofinder.com/about-us/ marked as relevant (LLM positive).
2025-06-18 13:33:37 [root] INFO: def parse(): Found 10 links on https://thedancestudiofinder.com/about-us/
2025-06-18 13:33:37 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/contact-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:33:37 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/blog/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:33:37 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/join/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:33:37 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/about-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:33:37 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:33:37 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/my-account/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:33:37 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/dance-studios/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:33:37 [root] INFO: def parse(): Found keywords for URL https://thedancestudiofinder.com/my-account/: ['dance', 'quickstep', 'wcs']
2025-06-18 13:33:37 [root] INFO: def generate_prompt(): Generating prompt for URL: https://thedancestudiofinder.com/my-account/
2025-06-18 13:33:37 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 13:33:37 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 13:33:37 [root] INFO: query_llm(): Querying Mistral
2025-06-18 13:33:47 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:33:47 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 13:33:47 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 13:33:47 [root] INFO: write_url_to_db(): appended URL 'https://thedancestudiofinder.com/my-account/'
2025-06-18 13:33:47 [root] INFO: def parse(): URL https://thedancestudiofinder.com/my-account/ marked as irrelevant (LLM negative).
2025-06-18 13:33:47 [root] INFO: def parse(): Found 10 links on https://thedancestudiofinder.com/my-account/
2025-06-18 13:33:47 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/contact-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:33:47 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/blog/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:33:47 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/join/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:33:47 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/my-account/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:33:47 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:33:47 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/about-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:33:47 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/dance-studios/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:33:47 [root] INFO: def parse(): Found keywords for URL https://thedancestudiofinder.com/blog/: ['dance', 'quickstep']
2025-06-18 13:33:47 [root] INFO: def generate_prompt(): Generating prompt for URL: https://thedancestudiofinder.com/blog/
2025-06-18 13:33:47 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 13:33:47 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 13:33:47 [root] INFO: query_llm(): Querying Mistral
2025-06-18 13:36:30 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:36:30 [root] INFO: query_llm(): Mistral response received: [
  {
    "source": "https://thedancestudiofinder.com/blog/",
    "dance_style": "ballet, bachata, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "A Parent’s Guide to Choosing a Great Dance Studio",
    "day_of_week": "Friday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "00:00",
    "end_time": null,
    "price": "",
    "location": "",
    "description": "When searching for a dance studio for your child, there are certain things to look for to encourage a..."
  },
  {
    "source": "https://thedancestudiofinder.com/blog/",
    "dance_style": "ballet, bachata, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "10 Delightful Ballet Books to Inspire Your Young Dancer",
    "day_of_week": "Tuesday",
    "start_date": "2025-06-13",
    "end_date": "2025-06-13",
    "start_time": "00:00",
    "end_time": null,
    "price": "",
    "location": "",
    "description": "Note that this post may contain affiliate links. If you make a purchase through these links, I may earn a..."
  },
  {
    "source": "https://thedancestudiofinder.com/blog/",
    "dance_style": "ballet, bachata, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "Tiny Tumblers: A Parent’s Guide to Preschool Acrobatics Classes",
    "day_of_week": "Saturday",
    "start_date": "2025-04-20",
    "end_date": "2025-04-20",
    "start_time": "00:00",
    "end_time": null,
    "price": "",
    "location": "",
    "description": "Acrobatics dance classes are a thrilling and dynamic way for preschoolers to develop strength, flexibility, and coordination while having fun!..."
  },
  {
    "source": "https://thedancestudiofinder.com/blog/",
    "dance_style": "ballet, bachata, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "Junior Jazz: A Parent’s Guide to Preschool Jazz Classes",
    "day_of_week": "Thursday",
    "start_date": "2025-04-11",
    "end_date": "2025-04-11",
    "start_time": "00:00",
    "end_time": null,
    "price": "",
    "location": "",
    "description": "Jazz dance is an exciting and upbeat style that blends rhythm, coordination, and self-expression. For preschoolers, jazz classes offer a..."
  },
  {
    "source": "https://thedancestudiofinder.com/blog/",
    "dance_style": "ballet, bachata, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "Tiny Tutus: A Parent’s Guide to Preschool Ballet Classes",
    "day_of_week": "Wednesday",
    "start_date": "2025-04-10",
    "end_date": "2025-04-10",
    "start_time": "00:00",
    "end_time": null,
    "price": "",
    "location": "",
    "description": "Ballet is a magical experience for young children, combining movement, music, and imagination! For preschoolers ages 3-5, ballet provides a..."
  },
  {
    "source": "https://thedancestudiofinder.com/blog/",
    "dance_style": "ballet, bachata, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "Tot Tap: A Parent’s Guide to Preschool Tap Classes",
    "day_of_week": "Tuesday",
    "start_date": "2025-04-09",
    "end_date": "2025-04-09",
    "start_time": "00:00",
    "end_time": null,
    "price": "",
    "location": "",
    "description": "Tap dancing is an exciting way for preschoolers to explore rhythm, coordination, and creativity—all while making musical sounds with their..."
  },
  {
    "source": "https://thedancestudiofinder.com/blog/",
    "dance_style": "ballet, bachata, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "Grace, Expression, and Fun: All About Lyrical Dance Classes for Kids",
    "day_of_week": "Monday",
    "start_date": "2025-04-02",
    "end_date": "2025-04-02",
    "start_time": "00:00",
    "end_time": null,
    "price": "",
    "location": "",
    "description": "Lyrical dance combines the elegance of ballet with the energy of jazz, making it a beautiful and expressive style for..."
  },
  {
    "source": "https://thedancestudiofinder.com/blog/",
    "dance_style": "ballet, bachata, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "Broadway Bound: All About Musical Theater Dance Classes for Kids",
    "day_of_week": "Tuesday",
    "start_date": "2025-03-19",
    "end_date": "2025-03-19",
    "start_time": "00:00",
    "end_time": null,
    "price": "",
    "location": "",
    "description": "Musical theater dance is an exciting and expressive style that allows kids to combine movement, acting, and storytelling. Sometimes called..."
  },
  {
    "source": "https://thedancestudiofinder.com/blog/",
    "dance_style": "ballet, bachata, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "Breaking it Down: All About Hip Hop Dance Classes for Kids",
    "day_of_week": "Sunday",
    "start_date": "2025-03-17",
    "end_date": "2025-03-17",
    "start_time": "00:00",
    "end_time": null,
    "price": "",
    "location": "",
    "description": "Hip hop dance is a fun, high-energy style that allows kids to express themselves while building confidence and coordination. Whether..."
  },
  {
    "source": "https://thedancestudiofinder.com/blog/",
    "dance_style": "ballet, bachata, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "What to Wear to Dance Class: A Parent’s Guide",
    "day_of_week": "Friday",
    "start_date": "2025-03-16",
    "end_date": "2025-03-16",
    "start_time": "00:00",
    "end_time": null,
    "price": "",
    "location": "",
    "description": "A dress code in dance class is more than just a uniform requirement; it plays a crucial role in..."
  },
  {
    "source": "https://thedancestudiofinder.com/blog/",
    "dance_style": "ballet, bachata, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "Essential Dance Gear for Boys: What to Wear to Class",
    "day_of_week": "Friday",
    "start_date": "2025-03-16",
    "end_date": "2025-03-16",
    "start_time": "00:00",
    "end_time": null,
    "price": "",
    "location": "",
    "description": "When boys start dance classes, having the right attire is essential! Proper dancewear ensures comfort, freedom of movement, and allows..."
  }
]
2025-06-18 13:36:30 [root] INFO: def extract_and_parse_json(): for url https://thedancestudiofinder.com/blog/, 
Cleaned JSON ready for parsing:
[
  {
    "source": "https://thedancestudiofinder.com/blog/",
    "dance_style": "ballet, bachata, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "A Parent’s Guide to Choosing a Great Dance Studio",
    "day_of_week": "Friday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "00:00",
    "end_time": null,
    "price": "",
    "location": "",
    "description": "When searching for a dance studio for your child, there are certain things to look for to encourage a"
  },
  {
    "source": "https://thedancestudiofinder.com/blog/",
    "dance_style": "ballet, bachata, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "10 Delightful Ballet Books to Inspire Your Young Dancer",
    "day_of_week": "Tuesday",
    "start_date": "2025-06-13",
    "end_date": "2025-06-13",
    "start_time": "00:00",
    "end_time": null,
    "price": "",
    "location": "",
    "description": "Note that this post may contain affiliate links. If you make a purchase through these links, I may earn a"
  },
  {
    "source": "https://thedancestudiofinder.com/blog/",
    "dance_style": "ballet, bachata, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "Tiny Tumblers: A Parent’s Guide to Preschool Acrobatics Classes",
    "day_of_week": "Saturday",
    "start_date": "2025-04-20",
    "end_date": "2025-04-20",
    "start_time": "00:00",
    "end_time": null,
    "price": "",
    "location": "",
    "description": "Acrobatics dance classes are a thrilling and dynamic way for preschoolers to develop strength, flexibility, and coordination while having fun!"
  },
  {
    "source": "https://thedancestudiofinder.com/blog/",
    "dance_style": "ballet, bachata, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "Junior Jazz: A Parent’s Guide to Preschool Jazz Classes",
    "day_of_week": "Thursday",
    "start_date": "2025-04-11",
    "end_date": "2025-04-11",
    "start_time": "00:00",
    "end_time": null,
    "price": "",
    "location": "",
    "description": "Jazz dance is an exciting and upbeat style that blends rhythm, coordination, and self-expression. For preschoolers, jazz classes offer a"
  },
  {
    "source": "https://thedancestudiofinder.com/blog/",
    "dance_style": "ballet, bachata, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "Tiny Tutus: A Parent’s Guide to Preschool Ballet Classes",
    "day_of_week": "Wednesday",
    "start_date": "2025-04-10",
    "end_date": "2025-04-10",
    "start_time": "00:00",
    "end_time": null,
    "price": "",
    "location": "",
    "description": "Ballet is a magical experience for young children, combining movement, music, and imagination! For preschoolers ages 3-5, ballet provides a"
  },
  {
    "source": "https://thedancestudiofinder.com/blog/",
    "dance_style": "ballet, bachata, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "Tot Tap: A Parent’s Guide to Preschool Tap Classes",
    "day_of_week": "Tuesday",
    "start_date": "2025-04-09",
    "end_date": "2025-04-09",
    "start_time": "00:00",
    "end_time": null,
    "price": "",
    "location": "",
    "description": "Tap dancing is an exciting way for preschoolers to explore rhythm, coordination, and creativity—all while making musical sounds with their"
  },
  {
    "source": "https://thedancestudiofinder.com/blog/",
    "dance_style": "ballet, bachata, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "Grace, Expression, and Fun: All About Lyrical Dance Classes for Kids",
    "day_of_week": "Monday",
    "start_date": "2025-04-02",
    "end_date": "2025-04-02",
    "start_time": "00:00",
    "end_time": null,
    "price": "",
    "location": "",
    "description": "Lyrical dance combines the elegance of ballet with the energy of jazz, making it a beautiful and expressive style for"
  },
  {
    "source": "https://thedancestudiofinder.com/blog/",
    "dance_style": "ballet, bachata, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "Broadway Bound: All About Musical Theater Dance Classes for Kids",
    "day_of_week": "Tuesday",
    "start_date": "2025-03-19",
    "end_date": "2025-03-19",
    "start_time": "00:00",
    "end_time": null,
    "price": "",
    "location": "",
    "description": "Musical theater dance is an exciting and expressive style that allows kids to combine movement, acting, and storytelling. Sometimes called"
  },
  {
    "source": "https://thedancestudiofinder.com/blog/",
    "dance_style": "ballet, bachata, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "Breaking it Down: All About Hip Hop Dance Classes for Kids",
    "day_of_week": "Sunday",
    "start_date": "2025-03-17",
    "end_date": "2025-03-17",
    "start_time": "00:00",
    "end_time": null,
    "price": "",
    "location": "",
    "description": "Hip hop dance is a fun, high-energy style that allows kids to express themselves while building confidence and coordination. Whether"
  },
  {
    "source": "https://thedancestudiofinder.com/blog/",
    "dance_style": "ballet, bachata, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "What to Wear to Dance Class: A Parent’s Guide",
    "day_of_week": "Friday",
    "start_date": "2025-03-16",
    "end_date": "2025-03-16",
    "start_time": "00:00",
    "end_time": null,
    "price": "",
    "location": "",
    "description": "A dress code in dance class is more than just a uniform requirement; it plays a crucial role in"
  },
  {
    "source": "https://thedancestudiofinder.com/blog/",
    "dance_style": "ballet, bachata, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "Essential Dance Gear for Boys: What to Wear to Class",
    "day_of_week": "Friday",
    "start_date": "2025-03-16",
    "end_date": "2025-03-16",
    "start_time": "00:00",
    "end_time": null,
    "price": "",
    "location": "",
    "description": "When boys start dance classes, having the right attire is essential! Proper dancewear ensures comfort, freedom of movement, and allows"
  }
]
2025-06-18 13:36:30 [root] INFO: def clean_up_address(): Starting with events_df shape: (11, 14)
2025-06-18 13:36:30 [root] INFO: write_events_to_db: Number of events to write: 11
2025-06-18 13:36:30 [root] INFO: write_url_to_db(): appended URL 'https://thedancestudiofinder.com/blog/'
2025-06-18 13:36:30 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:36:30 [root] INFO: def process_llm_response: URL https://thedancestudiofinder.com/blog/ marked as relevant with events written to the database.
2025-06-18 13:36:30 [root] INFO: write_url_to_db(): appended URL 'https://thedancestudiofinder.com/blog/'
2025-06-18 13:36:30 [root] INFO: def parse(): URL https://thedancestudiofinder.com/blog/ marked as relevant (LLM positive).
2025-06-18 13:36:30 [root] INFO: def parse(): Found 10 links on https://thedancestudiofinder.com/blog/
2025-06-18 13:36:30 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/contact-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:36:30 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/blog/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:36:30 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/my-account/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:36:30 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/join/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:36:30 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:36:30 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/about-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:36:30 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/dance-studios/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:36:30 [root] INFO: def parse(): Found keywords for URL https://thedancestudiofinder.com/dance-studios/: ['argentine tango', 'bachata', 'balboa', 'cha cha', 'dance', 'east coast swing', 'foxtrot', 'kizomba', 'lindy hop', 'line dance', 'merengue', 'milonga', 'quickstep', 'rumba', 'salsa', 'samba', 'swing', 'tango', 'two step', 'waltz', 'west coast swing', 'zouk']
2025-06-18 13:36:30 [root] INFO: def generate_prompt(): Generating prompt for URL: https://thedancestudiofinder.com/dance-studios/
2025-06-18 13:36:30 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 13:36:30 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 13:36:30 [root] INFO: query_llm(): Querying Mistral
2025-06-18 13:36:32 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 13:36:32 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 216198 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 13:36:32 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 13:36:45 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:36:45 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 13:36:45 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 13:36:45 [root] INFO: write_url_to_db(): appended URL 'https://thedancestudiofinder.com/dance-studios/'
2025-06-18 13:36:45 [root] INFO: def parse(): URL https://thedancestudiofinder.com/dance-studios/ marked as irrelevant (LLM negative).
2025-06-18 13:36:45 [root] INFO: def parse(): Found 10 links on https://thedancestudiofinder.com/dance-studios/
2025-06-18 13:36:45 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/contact-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:36:45 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/blog/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:36:45 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/my-account/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:36:45 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/join/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:36:45 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:36:45 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/about-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:36:45 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/dance-studios/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:36:45 [root] INFO: write_url_to_db(): appended URL 'https://victoriasymphony.ca/concerts-events/#concertseries'
2025-06-18 13:36:45 [root] INFO: def parse(): URL https://victoriasymphony.ca/concerts-events/#concertseries marked as irrelevant (no keywords).
2025-06-18 13:36:45 [root] INFO: def parse(): Found 10 links on https://victoriasymphony.ca/concerts-events/
2025-06-18 13:36:45 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5RJF5B3, URL: https://victoriasymphony.ca/concerts-events/#concertseries, source: Victoria Symphony: Home, keywords: outdoor music
2025-06-18 13:36:45 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 13:36:45 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5RJF5B3
2025-06-18 13:36:45 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-5RJF5B3'
2025-06-18 13:36:45 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/vicsymphony/'
2025-06-18 13:36:45 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/vicsymphony/
2025-06-18 13:36:45 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/vicsymphony'
2025-06-18 13:36:45 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/vicsymphony
2025-06-18 13:36:45 [root] INFO: should_process_url: URL https://victoriasymphony.ca/contact-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:36:45 [root] INFO: should_process_url: URL https://victoriasymphony.ca/support/donations/how-to-donate/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:36:45 [root] INFO: should_process_url: URL https://victoriasymphony.ca/concerts-events/#concertseries was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:36:45 [root] INFO: should_process_url: URL https://victoriasymphony.ca/concerts-events/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:36:45 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/VicSymphony.
2025-06-18 13:36:45 [root] INFO: should_process_url: URL https://victoriasymphony.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:36:45 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/user/VictoriaSymphony.
2025-06-18 13:36:45 [root] INFO: should_process_url: URL https://victoriasymphony.ca/cart/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:36:45 [root] INFO: def parse(): Found keywords for URL https://victoriasymphony.ca/cart/: ['semba']
2025-06-18 13:36:45 [root] INFO: def generate_prompt(): Generating prompt for URL: https://victoriasymphony.ca/cart/
2025-06-18 13:36:45 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 13:36:45 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 13:36:45 [root] INFO: query_llm(): Querying Mistral
2025-06-18 13:39:05 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:39:05 [root] INFO: query_llm(): Mistral response received: 1. **Ticketed Social Dance and Live Music Events**:
    - **Event Title**: Symphony In The Summer Festival
    - **Date**: July 2 to July 14, 2025
    - **Time**: 7:30 PM
    - **Venue**: Butchart Gardens
    - **Address**: 5521 Butchart Gardens Road, Duncan, BC V9L 6B3
    - **Price**: Starting from $25
    - **Description**: Join us for our annual Symphony In The Summer Festival, featuring live music performances by renowned artists.

2. **Ticketed Social Dance and Live Music Events**:
    - **Event Title**: Beethoven’s Ninth
    - **Date**: Saturday, January 18, 2025
    - **Time**: 7:30 PM
    - **Venue**: Royal Theatre
    - **Address**: 805 Broughton Street, Victoria, BC V8W 1E5
    - **Price**: From $25
    - **Description**: Beethoven’s Ninth with the Victoria Symphony and Chorus. Tania Miller, conductor.

3. **Ticketed Social Dance and Live Music Events**:
    - **Event Title**: Rossini & Respighi
    - **Date**: Sunday, February 2, 2025
    - **Time**: 2:30 PM
    - **Venue**: Royal Theatre
    - **Address**: 805 Broughton Street, Victoria, BC V8W 1E5
    - **Price**: From $25
    - **Description**: Rossini & Respighi with the Victoria Symphony. Giordano Bellincampi, conductor. Piotr Foltynski, piano.

4. **Ticketed Social Dance and Live Music Events**:
    - **Event Title**: Brahms & Schumann
    - **Date**: Sunday, March 23, 2025
    - **Time**: 2:30 PM
    - **Venue**: Royal Theatre
    - **Address**: 805 Broughton Street, Victoria, BC V8W 1E5
    - **Price**: From $25
    - **Description**: Brahms & Schumann with the Victoria Symphony. Christian Kluxen, conductor. Lorraine Min, piano.

5. **Ticketed Social Dance and Live Music Events**:
    - **Event Title**: Mendelssohn’s Elijah
    - **Date**: Sunday, April 27, 2025
    - **Time**: 2:30 PM
    - **Venue**: Royal Theatre
    - **Address**: 805 Broughton Street, Victoria, BC V8W 1E5
    - **Price**: From $25
    - **Description**: Mendelssohn’s Elijah with the Victoria Symphony and Chorus. Giordano Bellincampi, conductor.

6. **Ticketed Social Dance and Live Music Events**:
    - **Event Title**: Season Finale – Tchaikovsky’s Fifth
    - **Date**: Sunday, May 18, 2025
    - **Time**: 2:30 PM
    - **Venue**: Royal Theatre
    - **Address**: 805 Broughton Street, Victoria, BC V8W 1E5
    - **Price**: From $25
    - **Description**: Season Finale – Tchaikovsky’s Fifth with the Victoria Symphony. Christian Kluxen, conductor. Lorraine Min, piano.

7. **Ticketed Social Dance and Live Music Events**:
    - **Event Title**: Splash! Family Concert
    - **Date**: Sunday, July 13, 2025
    - **Time**: 4:00 PM
    - **Venue**: Butchart Gardens
    - **Address**: 5521 Butchart Gardens Road, Duncan, BC V9L 6B3
    - **Price**: Adults $20, Kids $5
    - **Description**: Splash! Family Concert. Experience the joy of live music with your family.

8. **Ticketed Social Dance and Live Music Events**:
    - **Event Title**: Mozart & Haydn
    - **Date**: Sunday, September 21, 2025
    - **Time**: 2:30 PM
    - **Venue**: Royal Theatre
    - **Address**: 805 Broughton Street, Victoria, BC V8W 1E5
    - **Price**: From $25
    - **Description**: Mozart & Haydn with the Victoria Symphony. Giordano Bellincampi, conductor. Lorraine Min, piano.

9. **Ticketed Social Dance and Live Music Events**:
    - **Event Title**: Mahler’s Resurrection
    - **Date**: Sunday, October 26, 2025
    - **Time**: 2:30 PM
    - **Venue**: Royal Theatre
    - **Address**: 805 Broughton Street, Victoria, BC V8W 1E5
    - **Price**: From $25
    - **Description**: Mahler’s Resurrection with the Victoria Symphony and Chorus. Giordano Bellincampi, conductor.

10. **Ticketed Social Dance and Live Music Events**:
    - **Event Title**: Beethoven & Bach
    - **Date**: Sunday, November 23, 2025
    - **Time**: 2:30 PM
    - **Venue**: Royal Theatre
    - **Address**: 805 Broughton Street, Victoria, BC V8W 1E5
    - **Price**: From $25
    - **Description**: Beethoven & Bach with the Victoria Symphony. Christian Kluxen, conductor. Lorraine Min, piano.

11. **Ticketed Social Dance and Live Music Events**:
    - **Event Title**: Handel’s Messiah
    - **Date**: Sunday, December 14, 2025
    - **Time**: 2:30 PM
    - **Venue**: Royal Theatre
    - **Address**: 805 Broughton Street, Victoria, BC V8W 1E5
    - **Price**: From $25
    - **Description**: Handel’s Messiah with the Victoria Symphony and Chorus. Giordano Bellincampi, conductor.

12. **Ticketed Social Dance and Live Music Events**:
    - **Event Title**: Christmas Pops
    - **Date**: Sunday, December 21, 2025
    - **Time**: 2:30 PM
    - **Venue**: Royal Theatre
    - **Address**: 805 Broughton Street, Victoria, BC V8W 1E5
    - **Price**: From $25
    - **Description**: Christmas Pops with the Victoria Symphony. Giordano Bellincampi, conductor.

13. **Ticketed Social Dance and Live Music Events**:
    - **Event Title**: New Year’s in Vienna
    - **Date**: Sunday, January 1, 2026
    - **Time**: 2:30 PM
    - **Venue**: Royal Theatre
    - **Address**: 805 Broughton Street, Victoria, BC V8W 1E5
    - **Price**: From $25
    - **Description**: New Year’s in Vienna with the Victoria Symphony. Giordano Bellincampi, conductor.
2025-06-18 13:39:05 [root] ERROR: def extract_and_parse_json(): couldn't isolate JSON blob in result from https://victoriasymphony.ca/cart/
2025-06-18 13:39:05 [root] INFO: write_url_to_db(): appended URL 'https://victoriasymphony.ca/cart/'
2025-06-18 13:39:05 [root] INFO: def parse(): URL https://victoriasymphony.ca/cart/ marked as irrelevant (LLM negative).
2025-06-18 13:39:05 [root] INFO: def parse(): Found 10 links on https://victoriasymphony.ca/cart/
2025-06-18 13:39:05 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5RJF5B3, URL: https://victoriasymphony.ca/cart/, source: Victoria Symphony: Home, keywords: outdoor music
2025-06-18 13:39:05 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 13:39:05 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5RJF5B3
2025-06-18 13:39:05 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-5RJF5B3'
2025-06-18 13:39:05 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/vicsymphony/'
2025-06-18 13:39:05 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/vicsymphony/
2025-06-18 13:39:05 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/vicsymphony'
2025-06-18 13:39:05 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/vicsymphony
2025-06-18 13:39:05 [root] INFO: should_process_url: URL https://victoriasymphony.ca/contact-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:39:05 [root] INFO: should_process_url: URL https://victoriasymphony.ca/support/donations/how-to-donate/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:39:05 [root] INFO: should_process_url: URL https://victoriasymphony.ca/concerts-events/#concertseries was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:39:05 [root] INFO: should_process_url: URL https://victoriasymphony.ca/concerts-events/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:39:05 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/VicSymphony.
2025-06-18 13:39:05 [root] INFO: should_process_url: URL https://victoriasymphony.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:39:05 [root] INFO: should_process_url: URL https://victoriasymphony.ca/cart/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:39:05 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/user/VictoriaSymphony.
2025-06-18 13:39:05 [root] INFO: def parse(): Found keywords for URL https://riobraziliansteakhouse.ca/vancouver/: ['dance', 'samba']
2025-06-18 13:39:05 [root] INFO: def generate_prompt(): Generating prompt for URL: https://riobraziliansteakhouse.ca/vancouver/
2025-06-18 13:39:05 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 13:39:05 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 13:39:05 [root] INFO: query_llm(): Querying Mistral
2025-06-18 13:40:19 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:40:19 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "https://riobraziliansteakhouse.ca/vancouver/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Father’s Day Lunch Plans",
        "day_of_week": "Sunday",
        "start_date": "2025-06-15",
        "end_date": "2025-06-15",
        "start_time": "12:00",
        "end_time": "21:30",
        "price": "$50 per adult",
        "location": "Rio Brazilian Steakhouse, 1122 Denman St, Vancouver, BC V6G 1T2, Canada",
        "description": "🥩 Father’s Day Lunch Plans? We’ve got you. You can still join us for lunch in Coquitlam and Downtown Vancouver, just steps from English Bay! 🔥 Rooftop open patio 🍖 Variety of carved BBQ cuts 🥗 Salad bar + hot buffet 🍻 Cold pints from @parallel49beer 🕛 Full Dinner Menu served all day, from 12PM to 9:30PM Don’t wait — book your Father’s Day lunch now! 🌐 www.riobraziliansteakhouse.ca Must be 19+ for any alcoholic beverage."
    },
    {
        "source": "https://riobraziliansteakhouse.ca/vancouver/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Father’s Day on the Rooftop",
        "day_of_week": "Sunday",
        "start_date": "2025-06-15",
        "end_date": "2025-06-15",
        "start_time": "12:00",
        "end_time": "21:30",
        "price": "$50 per adult",
        "location": "Rio Brazilian Steakhouse, 1122 Denman St, Vancouver, BC V6G 1T2, Canada",
        "description": "Celebrate Dad with a unforgettable all-you-can-eat experience for Lunch or Dinner this June 15th. Full dinner menu all day — from 12PM to 9:30PM — just steps from English Bay or in Coquitlam. 🔥 Fire-grilled carved BBQ 🍽️ All-you-can-eat Brazilian Rodízio 🥗 Salad bar & Hot Buffet 🍻 Local craft beer from @parallel49beer 🌴 And yes — our rooftop patio is OPEN! Spots are filling fast. Reserve your table today! Must be 19+ for any alcoholic beverage. 🌐 www.riobraziliansteakhouse.ca"
    },
    {
        "source": "https://riobraziliansteakhouse.ca/vancouver/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Dinner Menu All Day for Dad",
        "day_of_week": "Sunday",
        "start_date": "2025-06-15",
        "end_date": "2025-06-15",
        "start_time": "12:00",
        "end_time": "21:30",
        "price": "$50 per adult",
        "location": "Rio Brazilian Steakhouse, 1122 Denman St, Vancouver, BC V6G 1T2, Canada",
        "description": "This Father’s Day, June 15th, we’re serving our full dinner menu — all day long! From 12PM to 9:30PM, enjoy the full Brazilian All-you-can-eat experience at Rio Brazilian Steakhouse: 🥩 Over 10 cuts of premium carved barbecue 🥗 Fresh salad bar 🍲 Hot buffet & starters 🌞 Open patio 🍻 Plus, local craft beer from @parallel49beer Lunch or dinner — Dad gets the full feast, no matter the time. Book your table now and celebrate big. 🇧🇷 🌐 www.riobraziliansteakhouse.ca"
    },
    {
        "source": "https://riobraziliansteakhouse.ca/vancouver/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Father’s Day, Brazilian Style",
        "day_of_week": "Sunday",
        "start_date": "2025-06-15",
        "end_date": "2025-06-15",
        "start_time": "12:00",
        "end_time": "21:30",
        "price": "$50 per adult",
        "location": "Rio Brazilian Steakhouse, 1122 Denman St, Vancouver, BC V6G 1T2, Canada",
        "description": "We’ve teamed up with local legends @parallel49beer to bring you the ultimate Father’s Day celebration this June 15th! From 12:00 PM to 9:30 PM, enjoy our FULL DINNER MENU ALL DAY, bring Dad for LUNCH or DINNER – featuring over 10 cuts of fire-grilled meat, a fresh salad bar, hot buffet, and more at both Vancouver and Coquitlam locations! Lunch & Dinner | $50 per adult | Open patio available | Dinner menu all day 🔥 Book your table and celebrate with flavor! Must be 19+ for any alcoholic beverage. 🍻 Reserve now and give Dad the flavour trip to Brazil he deserves. 🌐 www.riobraziliansteakhouse.ca"
    }
]
2025-06-18 13:40:19 [root] INFO: def extract_and_parse_json(): for url https://riobraziliansteakhouse.ca/vancouver/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "https://riobraziliansteakhouse.ca/vancouver/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Father’s Day Lunch Plans",
        "day_of_week": "Sunday",
        "start_date": "2025-06-15",
        "end_date": "2025-06-15",
        "start_time": "12:00",
        "end_time": "21:30",
        "price": "$50 per adult",
        "location": "Rio Brazilian Steakhouse, 1122 Denman St, Vancouver, BC V6G 1T2, Canada",
        "description": "🥩 Father’s Day Lunch Plans? We’ve got you. You can still join us for lunch in Coquitlam and Downtown Vancouver, just steps from English Bay! 🔥 Rooftop open patio 🍖 Variety of carved BBQ cuts 🥗 Salad bar + hot buffet 🍻 Cold pints from @parallel49beer 🕛 Full Dinner Menu served all day, from 12PM to 9:30PM Don’t wait — book your Father’s Day lunch now! 🌐 www.riobraziliansteakhouse.ca Must be 19+ for any alcoholic beverage."
    },
    {
        "source": "https://riobraziliansteakhouse.ca/vancouver/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Father’s Day on the Rooftop",
        "day_of_week": "Sunday",
        "start_date": "2025-06-15",
        "end_date": "2025-06-15",
        "start_time": "12:00",
        "end_time": "21:30",
        "price": "$50 per adult",
        "location": "Rio Brazilian Steakhouse, 1122 Denman St, Vancouver, BC V6G 1T2, Canada",
        "description": "Celebrate Dad with a unforgettable all-you-can-eat experience for Lunch or Dinner this June 15th. Full dinner menu all day — from 12PM to 9:30PM — just steps from English Bay or in Coquitlam. 🔥 Fire-grilled carved BBQ 🍽️ All-you-can-eat Brazilian Rodízio 🥗 Salad bar & Hot Buffet 🍻 Local craft beer from @parallel49beer 🌴 And yes — our rooftop patio is OPEN! Spots are filling fast. Reserve your table today! Must be 19+ for any alcoholic beverage. 🌐 www.riobraziliansteakhouse.ca"
    },
    {
        "source": "https://riobraziliansteakhouse.ca/vancouver/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Dinner Menu All Day for Dad",
        "day_of_week": "Sunday",
        "start_date": "2025-06-15",
        "end_date": "2025-06-15",
        "start_time": "12:00",
        "end_time": "21:30",
        "price": "$50 per adult",
        "location": "Rio Brazilian Steakhouse, 1122 Denman St, Vancouver, BC V6G 1T2, Canada",
        "description": "This Father’s Day, June 15th, we’re serving our full dinner menu — all day long! From 12PM to 9:30PM, enjoy the full Brazilian All-you-can-eat experience at Rio Brazilian Steakhouse: 🥩 Over 10 cuts of premium carved barbecue 🥗 Fresh salad bar 🍲 Hot buffet & starters 🌞 Open patio 🍻 Plus, local craft beer from @parallel49beer Lunch or dinner — Dad gets the full feast, no matter the time. Book your table now and celebrate big. 🇧🇷 🌐 www.riobraziliansteakhouse.ca"
    },
    {
        "source": "https://riobraziliansteakhouse.ca/vancouver/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Father’s Day, Brazilian Style",
        "day_of_week": "Sunday",
        "start_date": "2025-06-15",
        "end_date": "2025-06-15",
        "start_time": "12:00",
        "end_time": "21:30",
        "price": "$50 per adult",
        "location": "Rio Brazilian Steakhouse, 1122 Denman St, Vancouver, BC V6G 1T2, Canada",
        "description": "We’ve teamed up with local legends @parallel49beer to bring you the ultimate Father’s Day celebration this June 15th! From 12:00 PM to 9:30 PM, enjoy our FULL DINNER MENU ALL DAY, bring Dad for LUNCH or DINNER – featuring over 10 cuts of fire-grilled meat, a fresh salad bar, hot buffet, and more at both Vancouver and Coquitlam locations! Lunch & Dinner | $50 per adult | Open patio available | Dinner menu all day 🔥 Book your table and celebrate with flavor! Must be 19+ for any alcoholic beverage. 🍻 Reserve now and give Dad the flavour trip to Brazil he deserves. 🌐 www.riobraziliansteakhouse.ca"
    }
]
2025-06-18 13:40:19 [root] INFO: def clean_up_address(): Starting with events_df shape: (4, 14)
2025-06-18 13:40:19 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse, 1122 Denman St, Vancouver, BC V6G 1T2, Canada' (event_id: None)
2025-06-18 13:40:19 [root] INFO: get_address_id: Inserted or updated address_id 4090 for address '1765 Pendrell ST, VANCOUVER, BC, V6G1T2, CA'.
2025-06-18 13:40:19 [root] INFO: Populated from DB for postal code 'V6G1T2': '1765 Pendrell ST, VANCOUVER, BC, V6G1T2, CA'
2025-06-18 13:40:19 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse, 1122 Denman St, Vancouver, BC V6G 1T2, Canada' (event_id: None)
2025-06-18 13:40:19 [root] INFO: get_address_id: Inserted or updated address_id 4090 for address '1765 Pendrell ST, VANCOUVER, BC, V6G1T2, CA'.
2025-06-18 13:40:19 [root] INFO: Populated from DB for postal code 'V6G1T2': '1765 Pendrell ST, VANCOUVER, BC, V6G1T2, CA'
2025-06-18 13:40:19 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse, 1122 Denman St, Vancouver, BC V6G 1T2, Canada' (event_id: None)
2025-06-18 13:40:19 [root] INFO: get_address_id: Inserted or updated address_id 4090 for address '1765 Pendrell ST, VANCOUVER, BC, V6G1T2, CA'.
2025-06-18 13:40:19 [root] INFO: Populated from DB for postal code 'V6G1T2': '1765 Pendrell ST, VANCOUVER, BC, V6G1T2, CA'
2025-06-18 13:40:19 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse, 1122 Denman St, Vancouver, BC V6G 1T2, Canada' (event_id: None)
2025-06-18 13:40:19 [root] INFO: get_address_id: Inserted or updated address_id 4090 for address '1765 Pendrell ST, VANCOUVER, BC, V6G1T2, CA'.
2025-06-18 13:40:19 [root] INFO: Populated from DB for postal code 'V6G1T2': '1765 Pendrell ST, VANCOUVER, BC, V6G1T2, CA'
2025-06-18 13:40:19 [root] INFO: write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 13:40:19 [root] INFO: write_url_to_db(): appended URL 'https://riobraziliansteakhouse.ca/vancouver/'
2025-06-18 13:40:19 [root] INFO: def process_llm_response: URL https://riobraziliansteakhouse.ca/vancouver/ marked as relevant with events written to the database.
2025-06-18 13:40:19 [root] INFO: write_url_to_db(): appended URL 'https://riobraziliansteakhouse.ca/vancouver/'
2025-06-18 13:40:19 [root] INFO: def parse(): URL https://riobraziliansteakhouse.ca/vancouver/ marked as relevant (LLM positive).
2025-06-18 13:40:19 [root] INFO: def parse(): Found 10 links on https://riobraziliansteakhouse.ca/vancouver/
2025-06-18 13:40:19 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.tbdine.com/book/restaurant/rio-brazillian-steakhouse?idApp=68632&language=en-us, URL: https://riobraziliansteakhouse.ca/vancouver/, source: Rio Brazilian Steakhouse: Home, keywords: samba
2025-06-18 13:40:19 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: -mاy&(޲֮nYbj{-y!):
2025-06-18 13:40:19 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.tbdine.com/book/restaurant/rio-brazillian-steakhouse?idApp=68632&language=en-us
2025-06-18 13:40:19 [root] INFO: write_url_to_db(): appended URL 'https://www.tbdine.com/book/restaurant/rio-brazillian-steakhouse?idApp=68632&language=en-us'
2025-06-18 13:40:19 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/vancouver/ was last seen as relevant, processing it.
2025-06-18 13:40:19 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/about-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:40:19 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/ was last seen as not relevant but hit_ratio (2.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:40:19 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/coquitlam/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 13:40:19 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/take-out-menu/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:40:19 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/blog/ was last seen as relevant, processing it.
2025-06-18 13:40:19 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/langley/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:40:19 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:40:19 [scrapy.extensions.logstats] INFO: Crawled 78 pages (at 11 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 13:40:19 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/garden/sunken-garden/'
2025-06-18 13:40:19 [root] INFO: def parse(): URL https://butchartgardens.com/garden/sunken-garden/ marked as irrelevant (no keywords).
2025-06-18 13:40:19 [root] INFO: def parse(): Found 10 links on https://butchartgardens.com/garden/sunken-garden/
2025-06-18 13:40:19 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/mediterranean-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:40:19 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/sunken-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:40:19 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/italian-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:40:19 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/rose-garden/ was last seen as relevant, processing it.
2025-06-18 13:40:19 [root] INFO: should_process_url: URL https://butchartgardens.com/how-to-get-here/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:40:19 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/japanese-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:40:19 [root] INFO: should_process_url: URL https://tickets.butchartgardens.com/WebStore/shop/viewItems.aspx?cg=tt&c=DAtt was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:40:19 [root] INFO: should_process_url: URL https://butchartgardens.com/hours-rates/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:40:19 [root] INFO: should_process_url: URL https://butchartgardens.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:40:19 [root] INFO: def parse(): Found keywords for URL https://thedancestudiofinder.com/contact-us/: ['dance', 'quickstep']
2025-06-18 13:40:19 [root] INFO: def generate_prompt(): Generating prompt for URL: https://thedancestudiofinder.com/contact-us/
2025-06-18 13:40:19 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 13:40:19 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 13:40:19 [root] INFO: query_llm(): Querying Mistral
2025-06-18 13:41:54 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:41:54 [root] INFO: query_llm(): Mistral response received: [
  {
    "source": "https://thedancestudiofinder.com/",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "Saturday Salsa",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "20:00",
    "end_time": "00:00",
    "price": "$15",
    "location": "Downtown Dance Studio, 123 Main St, Anytown, USA",
    "description": "Join us every Saturday for a night of salsa dancing. All levels welcome."
  },
  {
    "source": "https://thedancestudiofinder.com/",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "Friday Night Tango",
    "day_of_week": "Friday",
    "start_date": "2025-06-27",
    "end_date": "2025-06-27",
    "start_time": "19:00",
    "end_time": "23:00",
    "price": "$20",
    "location": "Uptown Tango Club, 456 Broadway, Anytown, USA",
    "description": "Experience the passion of tango every Friday night. Beginners and experienced dancers alike are welcome."
  },
  {
    "source": "https://thedancestudiofinder.com/",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "Sunday Samba",
    "day_of_week": "Sunday",
    "start_date": "2025-06-22",
    "end_date": "2025-06-22",
    "start_time": "15:00",
    "end_time": "18:00",
    "price": "$10",
    "location": "Beachfront Dance Hall, 789 Ocean Ave, Anytown, USA",
    "description": "Enjoy an afternoon of samba by the beach. All levels welcome."
  },
  {
    "source": "https://thedancestudiofinder.com/",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "Wednesday Waltz",
    "day_of_week": "Wednesday",
    "start_date": "2025-06-25",
    "end_date": "2025-06-25",
    "start_time": "18:00",
    "end_time": "21:00",
    "price": "$12",
    "location": "Elegant Waltz Ballroom, 101 Pine St, Anytown, USA",
    "description": "Glide across the floor every Wednesday evening with our waltz night. Perfect for beginners and experienced dancers."
  },
  {
    "source": "https://thedancestudiofinder.com/",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "Tuesday Swing",
    "day_of_week": "Tuesday",
    "start_date": "2025-06-24",
    "end_date": "2025-06-24",
    "start_time": "19:00",
    "end_time": "22:00",
    "price": "$15",
    "location": "Swing Dance Palace, 234 Maple Ave, Anytown, USA",
    "description": "Get ready to swing every Tuesday night. All levels welcome."
  },
  {
    "source": "https://thedancestudiofinder.com/",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "Thursday Bachata",
    "day_of_week": "Thursday",
    "start_date": "2025-06-26",
    "end_date": "2025-06-26",
    "start_time": "20:00",
    "end_time": "00:00",
    "price": "$15",
    "location": "Bachata Bliss Studio, 567 Cedar St, Anytown, USA",
    "description": "Feel the rhythm of bachata every Thursday night. All levels welcome."
  },
  {
    "source": "https://thedancestudiofinder.com/",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "Monday Merengue",
    "day_of_week": "Monday",
    "start_date": "2025-06-23",
    "end_date": "2025-06-23",
    "start_time": "19:00",
    "end_time": "22:00",
    "price": "$10",
    "location": "Merengue Magic Hall, 890 Birch St, Anytown, USA",
    "description": "Start your week with merengue every Monday night. All levels welcome."
  }
]
2025-06-18 13:41:54 [root] INFO: def extract_and_parse_json(): for url https://thedancestudiofinder.com/contact-us/, 
Cleaned JSON ready for parsing:
[
  {
    "source": "https://thedancestudiofinder.com/",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "Saturday Salsa",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "20:00",
    "end_time": "00:00",
    "price": "$15",
    "location": "Downtown Dance Studio, 123 Main St, Anytown, USA",
    "description": "Join us every Saturday for a night of salsa dancing. All levels welcome."
  },
  {
    "source": "https://thedancestudiofinder.com/",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "Friday Night Tango",
    "day_of_week": "Friday",
    "start_date": "2025-06-27",
    "end_date": "2025-06-27",
    "start_time": "19:00",
    "end_time": "23:00",
    "price": "$20",
    "location": "Uptown Tango Club, 456 Broadway, Anytown, USA",
    "description": "Experience the passion of tango every Friday night. Beginners and experienced dancers alike are welcome."
  },
  {
    "source": "https://thedancestudiofinder.com/",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "Sunday Samba",
    "day_of_week": "Sunday",
    "start_date": "2025-06-22",
    "end_date": "2025-06-22",
    "start_time": "15:00",
    "end_time": "18:00",
    "price": "$10",
    "location": "Beachfront Dance Hall, 789 Ocean Ave, Anytown, USA",
    "description": "Enjoy an afternoon of samba by the beach. All levels welcome."
  },
  {
    "source": "https://thedancestudiofinder.com/",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "Wednesday Waltz",
    "day_of_week": "Wednesday",
    "start_date": "2025-06-25",
    "end_date": "2025-06-25",
    "start_time": "18:00",
    "end_time": "21:00",
    "price": "$12",
    "location": "Elegant Waltz Ballroom, 101 Pine St, Anytown, USA",
    "description": "Glide across the floor every Wednesday evening with our waltz night. Perfect for beginners and experienced dancers."
  },
  {
    "source": "https://thedancestudiofinder.com/",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "Tuesday Swing",
    "day_of_week": "Tuesday",
    "start_date": "2025-06-24",
    "end_date": "2025-06-24",
    "start_time": "19:00",
    "end_time": "22:00",
    "price": "$15",
    "location": "Swing Dance Palace, 234 Maple Ave, Anytown, USA",
    "description": "Get ready to swing every Tuesday night. All levels welcome."
  },
  {
    "source": "https://thedancestudiofinder.com/",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "Thursday Bachata",
    "day_of_week": "Thursday",
    "start_date": "2025-06-26",
    "end_date": "2025-06-26",
    "start_time": "20:00",
    "end_time": "00:00",
    "price": "$15",
    "location": "Bachata Bliss Studio, 567 Cedar St, Anytown, USA",
    "description": "Feel the rhythm of bachata every Thursday night. All levels welcome."
  },
  {
    "source": "https://thedancestudiofinder.com/",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "Monday Merengue",
    "day_of_week": "Monday",
    "start_date": "2025-06-23",
    "end_date": "2025-06-23",
    "start_time": "19:00",
    "end_time": "22:00",
    "price": "$10",
    "location": "Merengue Magic Hall, 890 Birch St, Anytown, USA",
    "description": "Start your week with merengue every Monday night. All levels welcome."
  }
]
2025-06-18 13:41:54 [root] INFO: def clean_up_address(): Starting with events_df shape: (7, 14)
2025-06-18 13:41:54 [root] INFO: def clean_up_address(): Processing location 'Downtown Dance Studio, 123 Main St, Anytown, USA' (event_id: None)
2025-06-18 13:41:54 [root] INFO: def clean_up_address(): Processing location 'Uptown Tango Club, 456 Broadway, Anytown, USA' (event_id: None)
2025-06-18 13:41:54 [root] INFO: def clean_up_address(): Processing location 'Beachfront Dance Hall, 789 Ocean Ave, Anytown, USA' (event_id: None)
2025-06-18 13:41:54 [root] INFO: def clean_up_address(): Processing location 'Elegant Waltz Ballroom, 101 Pine St, Anytown, USA' (event_id: None)
2025-06-18 13:41:54 [root] INFO: def clean_up_address(): Processing location 'Swing Dance Palace, 234 Maple Ave, Anytown, USA' (event_id: None)
2025-06-18 13:41:54 [root] INFO: def clean_up_address(): Processing location 'Bachata Bliss Studio, 567 Cedar St, Anytown, USA' (event_id: None)
2025-06-18 13:41:54 [root] INFO: def clean_up_address(): Processing location 'Merengue Magic Hall, 890 Birch St, Anytown, USA' (event_id: None)
2025-06-18 13:41:54 [root] INFO: write_events_to_db: Number of events to write: 7
2025-06-18 13:41:54 [root] INFO: write_url_to_db(): appended URL 'https://thedancestudiofinder.com/contact-us/'
2025-06-18 13:41:54 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:41:54 [root] INFO: def process_llm_response: URL https://thedancestudiofinder.com/contact-us/ marked as relevant with events written to the database.
2025-06-18 13:41:54 [root] INFO: write_url_to_db(): appended URL 'https://thedancestudiofinder.com/contact-us/'
2025-06-18 13:41:54 [root] INFO: def parse(): URL https://thedancestudiofinder.com/contact-us/ marked as relevant (LLM positive).
2025-06-18 13:41:54 [root] INFO: def parse(): Found 10 links on https://thedancestudiofinder.com/contact-us/
2025-06-18 13:41:54 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/contact-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:41:54 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/blog/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:41:54 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/my-account/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:41:54 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/join/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:41:54 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:41:54 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/about-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:41:55 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/dance-studios/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:41:55 [root] INFO: def parse(): Found keywords for URL https://nataliepadilla.bandcamp.com/track/going-going-gone: ['bachata', 'dance', 'merengue', 'salsa', 'swing', 'tango']
2025-06-18 13:41:55 [root] INFO: def generate_prompt(): Generating prompt for URL: https://nataliepadilla.bandcamp.com/track/going-going-gone
2025-06-18 13:41:55 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 13:41:55 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 13:41:55 [root] INFO: query_llm(): Querying Mistral
2025-06-18 13:42:28 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:42:28 [root] INFO: query_llm(): Mistral response received: <!-- Thursday from 20:00:00 2024 -->
[
  {
    "source": "nataliepadilla.bandcamp.com",
    "dance_style": "folk, bluegrass, celtic, oldtime, singer-songwriter",
    "url": "",
    "event_type": "live music",
    "event_name": "Going Going Gone by Natalie Padilla",
    "day_of_week": "Thursday",
    "start_date": "2024-06-20",
    "end_date": "2024-06-20",
    "start_time": "00:00",
    "end_time": "null",
    "price": "$3",
    "location": "Natalie Padilla, Williamsburg, MA, US",
    "description": "Written on the summer solstice, it's about creating time for new beginnings and following instincts. It starts with a stripped-down folksound, blooming into cinematic strings and drums",
    "additional_notes": "Produced, engineered and mixed by Quinn Bachand\nMastered by Trevor Buckingham\nMusic and lyrics by Natalie Padilla\nOil Painting Artwork by Laura Radwell"
  }
]
2025-06-18 13:42:28 [root] INFO: def extract_and_parse_json(): for url https://nataliepadilla.bandcamp.com/track/going-going-gone, 
Cleaned JSON ready for parsing:
[
  {
    "source": "nataliepadilla.bandcamp.com",
    "dance_style": "folk, bluegrass, celtic, oldtime, singer-songwriter",
    "url": "",
    "event_type": "live music",
    "event_name": "Going Going Gone by Natalie Padilla",
    "day_of_week": "Thursday",
    "start_date": "2024-06-20",
    "end_date": "2024-06-20",
    "start_time": "00:00",
    "end_time": "null",
    "price": "$3",
    "location": "Natalie Padilla, Williamsburg, MA, US",
    "description": "Written on the summer solstice, it's about creating time for new beginnings and following instincts. It starts with a stripped-down folksound, blooming into cinematic strings and drums",
    "additional_notes": "Produced, engineered and mixed by Quinn Bachand\nMastered by Trevor Buckingham\nMusic and lyrics by Natalie Padilla\nOil Painting Artwork by Laura Radwell"
  }
]
2025-06-18 13:42:28 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 15)
2025-06-18 13:42:28 [root] INFO: def clean_up_address(): Processing location 'Natalie Padilla, Williamsburg, MA, US' (event_id: None)
2025-06-18 13:42:28 [root] INFO: write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 13:42:28 [root] INFO: write_url_to_db(): appended URL 'https://nataliepadilla.bandcamp.com/track/going-going-gone'
2025-06-18 13:42:28 [root] INFO: def process_llm_response: URL https://nataliepadilla.bandcamp.com/track/going-going-gone marked as relevant with events written to the database.
2025-06-18 13:42:28 [root] INFO: write_url_to_db(): appended URL 'https://nataliepadilla.bandcamp.com/track/going-going-gone'
2025-06-18 13:42:28 [root] INFO: def parse(): URL https://nataliepadilla.bandcamp.com/track/going-going-gone marked as relevant (LLM positive).
2025-06-18 13:42:28 [root] INFO: def parse(): Found 10 links on https://nataliepadilla.bandcamp.com/track/going-going-gone
2025-06-18 13:42:28 [root] INFO: should_process_url: URL https://bandcamp.com/logout was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:42:28 [root] INFO: should_process_url: URL https://bandcamp.com/logout was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:42:28 [root] INFO: write_url_to_db(): appended URL 'https://bandcamp.com/logout'
2025-06-18 13:42:28 [root] INFO: def parse(): Crawling next URL: https://bandcamp.com/logout
2025-06-18 13:42:29 [root] INFO: def parse(): Found keywords for URL https://www.wellnessliving.com/rs/event/baza?k_class=793226&k_class_tab=31450: ['bachata', 'cha cha', 'dance', 'kizomba', 'salsa', 'semba', 'urban kiz', 'zouk']
2025-06-18 13:42:29 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.wellnessliving.com/rs/event/baza?k_class=793226&k_class_tab=31450
2025-06-18 13:42:29 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 13:42:29 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 13:42:29 [root] INFO: query_llm(): Querying Mistral
2025-06-18 13:43:03 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:43:03 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "WellnessLiving",
        "dance_style": "bachata, bachazouk, sensual bachata, brazilian zouk",
        "url": "",
        "event_type": "workshop",
        "event_name": "Bachazouk workshop with Javi & Carla",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "13:00",
        "end_time": "14:30",
        "price": "$40 + GST per person",
        "location": "Baza Dance Studios",
        "description": "A passionate fusion of Sensual Bachata and Brazilian Zouk. Take your Sensual Bachata to the next level by integrating the fluidity, depth, and creativity of Brazilian Zouk. Learn how to build stronger connection, explore three-dimensional movement, and flow with greater freedom and intention."
    }
]
2025-06-18 13:43:03 [root] INFO: def extract_and_parse_json(): for url https://www.wellnessliving.com/rs/event/baza?k_class=793226&k_class_tab=31450, 
Cleaned JSON ready for parsing:
[
    {
        "source": "WellnessLiving",
        "dance_style": "bachata, bachazouk, sensual bachata, brazilian zouk",
        "url": "",
        "event_type": "workshop",
        "event_name": "Bachazouk workshop with Javi & Carla",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "13:00",
        "end_time": "14:30",
        "price": "$40 + GST per person",
        "location": "Baza Dance Studios",
        "description": "A passionate fusion of Sensual Bachata and Brazilian Zouk. Take your Sensual Bachata to the next level by integrating the fluidity, depth, and creativity of Brazilian Zouk. Learn how to build stronger connection, explore three-dimensional movement, and flow with greater freedom and intention."
    }
]
2025-06-18 13:43:03 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:43:03 [root] INFO: def clean_up_address(): Processing location 'Baza Dance Studios' (event_id: None)
2025-06-18 13:43:03 [root] INFO: write_events_to_db: Number of events to write: 1
2025-06-18 13:43:03 [root] INFO: write_url_to_db(): appended URL 'https://www.wellnessliving.com/rs/event/baza?k_class=793226&k_class_tab=31450'
2025-06-18 13:43:03 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:43:03 [root] INFO: def process_llm_response: URL https://www.wellnessliving.com/rs/event/baza?k_class=793226&k_class_tab=31450 marked as relevant with events written to the database.
2025-06-18 13:43:03 [root] INFO: write_url_to_db(): appended URL 'https://www.wellnessliving.com/rs/event/baza?k_class=793226&k_class_tab=31450'
2025-06-18 13:43:03 [root] INFO: def parse(): URL https://www.wellnessliving.com/rs/event/baza?k_class=793226&k_class_tab=31450 marked as relevant (LLM positive).
2025-06-18 13:43:03 [root] INFO: def parse(): Found 10 links on https://www.wellnessliving.com/rs/event/baza?k_class=793226&k_class_tab=31450
2025-06-18 13:43:03 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-P8NSG8D, URL: https://www.wellnessliving.com/rs/event/baza?k_class=793226&k_class_tab=31450, source: Beginner Latin Dance and Fitness Classes in Downtown Vancouver, keywords: zouk
2025-06-18 13:43:03 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 13:43:03 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-P8NSG8D
2025-06-18 13:43:03 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-P8NSG8D'
2025-06-18 13:43:03 [root] INFO: should_process_url: URL https://www.wellnessliving.com/rs/profile.html was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 13:43:03 [root] INFO: should_process_url: URL https://www.wellnessliving.com/rs/profile.html was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 13:43:03 [root] INFO: write_url_to_db(): appended URL 'https://www.wellnessliving.com/rs/profile.html'
2025-06-18 13:43:03 [root] INFO: def parse(): Crawling next URL: https://www.wellnessliving.com/rs/profile.html
2025-06-18 13:43:03 [root] INFO: write_url_to_db(): appended URL 'https://victoriasymphony.ca/support/donations/how-to-donate/'
2025-06-18 13:43:03 [root] INFO: def parse(): URL https://victoriasymphony.ca/support/donations/how-to-donate/ marked as irrelevant (no keywords).
2025-06-18 13:43:03 [root] INFO: def parse(): Found 10 links on https://victoriasymphony.ca/support/donations/how-to-donate/
2025-06-18 13:43:03 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5RJF5B3, URL: https://victoriasymphony.ca/support/donations/how-to-donate/, source: Victoria Symphony: Home, keywords: outdoor music
2025-06-18 13:43:03 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 13:43:03 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5RJF5B3
2025-06-18 13:43:03 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-5RJF5B3'
2025-06-18 13:43:03 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/vicsymphony/'
2025-06-18 13:43:03 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/vicsymphony/
2025-06-18 13:43:03 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/vicsymphony'
2025-06-18 13:43:03 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/vicsymphony
2025-06-18 13:43:03 [root] INFO: should_process_url: URL https://victoriasymphony.ca/contact-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:43:03 [root] INFO: should_process_url: URL https://victoriasymphony.ca/support/donations/how-to-donate/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:43:03 [root] INFO: should_process_url: URL https://victoriasymphony.ca/concerts-events/#concertseries was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:43:03 [root] INFO: should_process_url: URL https://victoriasymphony.ca/concerts-events/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:43:03 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/VicSymphony.
2025-06-18 13:43:03 [root] INFO: should_process_url: URL https://victoriasymphony.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:43:03 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/user/VictoriaSymphony.
2025-06-18 13:43:03 [root] INFO: should_process_url: URL https://victoriasymphony.ca/cart/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:43:03 [root] INFO: def parse(): Found keywords for URL https://riobraziliansteakhouse.ca/blog/: ['samba']
2025-06-18 13:43:03 [root] INFO: def generate_prompt(): Generating prompt for URL: https://riobraziliansteakhouse.ca/blog/
2025-06-18 13:43:03 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 13:43:03 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 13:43:03 [root] INFO: query_llm(): Querying Mistral
2025-06-18 13:58:04 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 504 Gateway Timeout"
2025-06-18 13:58:04 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 504
{
  "message":"The upstream server is timing out",
  "request_id":"d403b4699937c86f4a74f17093394854"
}
2025-06-18 13:58:04 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 13:59:11 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:59:11 [root] INFO: query_llm(): OpenAI response received: [{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-06-20","end_date":"2025-06-20","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-06-27","end_date":"2025-06-27","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-07-04","end_date":"2025-07-04","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-07-11","end_date":"2025-07-11","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-07-18","end_date":"2025-07-18","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-07-25","end_date":"2025-07-25","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-08-01","end_date":"2025-08-01","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-08-08","end_date":"2025-08-08","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-08-15","end_date":"2025-08-15","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-08-22","end_date":"2025-08-22","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-08-29","end_date":"2025-08-29","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-09-05","end_date":"2025-09-05","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-09-12","end_date":"2025-09-12","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-09-19","end_date":"2025-09-19","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-09-26","end_date":"2025-09-26","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-10-03","end_date":"2025-10-03","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-10-10","end_date":"2025-10-10","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-10-17","end_date":"2025-10-17","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-10-24","end_date":"2025-10-24","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-10-31","end_date":"2025-10-31","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-11-07","end_date":"2025-11-07","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-11-14","end_date":"2025-11-14","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-11-21","end_date":"2025-11-21","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-11-28","end_date":"2025-11-28","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-12-05","end_date":"2025-12-05","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-12-12","end_date":"2025-12-12","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-12-19","end_date":"2025-12-19","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-12-26","end_date":"2025-12-26","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-01-02","end_date":"2026-01-02","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-01-09","end_date":"2026-01-09","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-01-16","end_date":"2026-01-16","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-01-23","end_date":"2026-01-23","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-01-30","end_date":"2026-01-30","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-02-06","end_date":"2026-02-06","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-02-13","end_date":"2026-02-13","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-02-20","end_date":"2026-02-20","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-02-27","end_date":"2026-02-27","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-03-06","end_date":"2026-03-06","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-03-13","end_date":"2026-03-13","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-03-20","end_date":"2026-03-20","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-03-27","end_date":"2026-03-27","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-04-03","end_date":"2026-04-03","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-04-10","end_date":"2026-04-10","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-04-17","end_date":"2026-04-17","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-04-24","end_date":"2026-04-24","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-05-01","end_date":"2026-05-01","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-05-08","end_date":"2026-05-08","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-05-15","end_date":"2026-05-15","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-05-22","end_date":"2026-05-22","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-05-29","end_date":"2026-05-29","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-06-05","end_date":"2026-06-05","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-06-12","end_date":"2026-06-12","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."}]
2025-06-18 13:59:11 [root] INFO: def extract_and_parse_json(): for url https://riobraziliansteakhouse.ca/blog/, 
Cleaned JSON ready for parsing:
[{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-06-20","end_date":"2025-06-20","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-06-27","end_date":"2025-06-27","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-07-04","end_date":"2025-07-04","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-07-11","end_date":"2025-07-11","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-07-18","end_date":"2025-07-18","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-07-25","end_date":"2025-07-25","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-08-01","end_date":"2025-08-01","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-08-08","end_date":"2025-08-08","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-08-15","end_date":"2025-08-15","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-08-22","end_date":"2025-08-22","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-08-29","end_date":"2025-08-29","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-09-05","end_date":"2025-09-05","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-09-12","end_date":"2025-09-12","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-09-19","end_date":"2025-09-19","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-09-26","end_date":"2025-09-26","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-10-03","end_date":"2025-10-03","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-10-10","end_date":"2025-10-10","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-10-17","end_date":"2025-10-17","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-10-24","end_date":"2025-10-24","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-10-31","end_date":"2025-10-31","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-11-07","end_date":"2025-11-07","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-11-14","end_date":"2025-11-14","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-11-21","end_date":"2025-11-21","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-11-28","end_date":"2025-11-28","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-12-05","end_date":"2025-12-05","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-12-12","end_date":"2025-12-12","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-12-19","end_date":"2025-12-19","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2025-12-26","end_date":"2025-12-26","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-01-02","end_date":"2026-01-02","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-01-09","end_date":"2026-01-09","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-01-16","end_date":"2026-01-16","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-01-23","end_date":"2026-01-23","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-01-30","end_date":"2026-01-30","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-02-06","end_date":"2026-02-06","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-02-13","end_date":"2026-02-13","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-02-20","end_date":"2026-02-20","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-02-27","end_date":"2026-02-27","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-03-06","end_date":"2026-03-06","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-03-13","end_date":"2026-03-13","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-03-20","end_date":"2026-03-20","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-03-27","end_date":"2026-03-27","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-04-03","end_date":"2026-04-03","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-04-10","end_date":"2026-04-10","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-04-17","end_date":"2026-04-17","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-04-24","end_date":"2026-04-24","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-05-01","end_date":"2026-05-01","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-05-08","end_date":"2026-05-08","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-05-15","end_date":"2026-05-15","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-05-22","end_date":"2026-05-22","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-05-29","end_date":"2026-05-29","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-06-05","end_date":"2026-06-05","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."},{"source":"https://riobraziliansteakhouse.ca/samba-live-shows-every-friday/","dance_style":"","url":"","event_type":"live music","event_name":"Samba Live Shows Every Friday!","day_of_week":"Friday","start_date":"2026-06-12","end_date":"2026-06-12","start_time":"","end_time":"","price":"","location":"Rio Brazilian Steakhouse","description":"Experience the Rhythm of Samba at Rio Brazilian Steakhouse every Friday."}]
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Starting with events_df shape: (52, 14)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse' (event_id: None)
2025-06-18 13:59:11 [root] INFO: write_events_to_db: Number of events to write: 52
2025-06-18 13:59:11 [root] INFO: write_url_to_db(): appended URL 'https://riobraziliansteakhouse.ca/blog/'
2025-06-18 13:59:11 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:59:11 [root] INFO: def process_llm_response: URL https://riobraziliansteakhouse.ca/blog/ marked as relevant with events written to the database.
2025-06-18 13:59:11 [root] INFO: write_url_to_db(): appended URL 'https://riobraziliansteakhouse.ca/blog/'
2025-06-18 13:59:11 [root] INFO: def parse(): URL https://riobraziliansteakhouse.ca/blog/ marked as relevant (LLM positive).
2025-06-18 13:59:11 [root] INFO: def parse(): Found 10 links on https://riobraziliansteakhouse.ca/blog/
2025-06-18 13:59:11 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/vancouver/ was last seen as relevant, processing it.
2025-06-18 13:59:11 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/about-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:59:11 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/ was last seen as not relevant but hit_ratio (2.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:59:11 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/coquitlam/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 13:59:11 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/take-out-menu/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:59:11 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/blog/ was last seen as relevant, processing it.
2025-06-18 13:59:11 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/langley/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:59:11 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:59:11 [root] INFO: write_url_to_db(): appended URL 'https://riobraziliansteakhouse.ca/contact/'
2025-06-18 13:59:11 [root] INFO: def parse(): URL https://riobraziliansteakhouse.ca/contact/ marked as irrelevant (no keywords).
2025-06-18 13:59:11 [root] INFO: def parse(): Found 10 links on https://riobraziliansteakhouse.ca/contact/
2025-06-18 13:59:11 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/vancouver/ was last seen as relevant, processing it.
2025-06-18 13:59:11 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/about-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:59:11 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/ was last seen as not relevant but hit_ratio (2.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 13:59:11 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/coquitlam/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 13:59:11 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/take-out-menu/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:59:11 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/blog/ was last seen as relevant, processing it.
2025-06-18 13:59:11 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/langley/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:59:11 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:59:11 [root] INFO: def parse(): Found keywords for URL https://riobraziliansteakhouse.ca/coquitlam/: ['dance', 'samba']
2025-06-18 13:59:11 [root] INFO: def generate_prompt(): Generating prompt for URL: https://riobraziliansteakhouse.ca/coquitlam/
2025-06-18 13:59:11 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 13:59:11 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 13:59:11 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:00:15 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:00:15 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "Rio Brazilian Steakhouse",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Father’s Day Lunch Plans? We’ve got you.",
        "day_of_week": "Sunday",
        "start_date": "2025-06-15",
        "end_date": "2025-06-15",
        "start_time": "12:00",
        "end_time": "21:30",
        "price": "",
        "location": "Rio Brazilian Steakhouse, 2729 Barnet Hwy, Coquitlam, BC V6C3R3, Canada",
        "description": "Enjoy a special Father's Day lunch with a variety of carved BBQ cuts, salad bar, hot buffet, and cold pints from Parallel 49 Beer. Dinner menu served all day from 12 PM to 9:30 PM."
    },
    {
        "source": "Rio Brazilian Steakhouse",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Father’s Day on the Rooftop",
        "day_of_week": "Sunday",
        "start_date": "2025-06-15",
        "end_date": "2025-06-15",
        "start_time": "12:00",
        "end_time": "21:30",
        "price": "",
        "location": "Rio Brazilian Steakhouse, 2729 Barnet Hwy, Coquitlam, BC V6C3R3, Canada",
        "description": "Celebrate Father's Day with an all-you-can-eat experience for lunch or dinner. Enjoy fire-grilled carved BBQ, salad bar, hot buffet, and local craft beer from Parallel 49 Beer. Rooftop patio is open."
    },
    {
        "source": "Rio Brazilian Steakhouse",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Dinner Menu All Day for Dad",
        "day_of_week": "Sunday",
        "start_date": "2025-06-15",
        "end_date": "2025-06-15",
        "start_time": "12:00",
        "end_time": "21:30",
        "price": "",
        "location": "Rio Brazilian Steakhouse, 2729 Barnet Hwy, Coquitlam, BC V6C3R3, Canada",
        "description": "Enjoy the full dinner menu all day long on Father's Day. Experience over 10 cuts of premium carved barbecue, fresh salad bar, hot buffet, starters, and local craft beer from Parallel 49 Beer."
    },
    {
        "source": "Rio Brazilian Steakhouse",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Father’s Day, Brazilian Style",
        "day_of_week": "Sunday",
        "start_date": "2025-06-15",
        "end_date": "2025-06-15",
        "start_time": "12:00",
        "end_time": "21:30",
        "price": "",
        "location": "Rio Brazilian Steakhouse, 2729 Barnet Hwy, Coquitlam, BC V6C3R3, Canada",
        "description": "Celebrate Father's Day with a Brazilian-style feast. Enjoy the full dinner menu all day, featuring over 10 cuts of fire-grilled meat, fresh salad bar, hot buffet, and local craft beer from Parallel 49 Beer."
    }
]
2025-06-18 14:00:15 [root] INFO: def extract_and_parse_json(): for url https://riobraziliansteakhouse.ca/coquitlam/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Rio Brazilian Steakhouse",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Father’s Day Lunch Plans? We’ve got you.",
        "day_of_week": "Sunday",
        "start_date": "2025-06-15",
        "end_date": "2025-06-15",
        "start_time": "12:00",
        "end_time": "21:30",
        "price": "",
        "location": "Rio Brazilian Steakhouse, 2729 Barnet Hwy, Coquitlam, BC V6C3R3, Canada",
        "description": "Enjoy a special Father's Day lunch with a variety of carved BBQ cuts, salad bar, hot buffet, and cold pints from Parallel 49 Beer. Dinner menu served all day from 12 PM to 9:30 PM."
    },
    {
        "source": "Rio Brazilian Steakhouse",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Father’s Day on the Rooftop",
        "day_of_week": "Sunday",
        "start_date": "2025-06-15",
        "end_date": "2025-06-15",
        "start_time": "12:00",
        "end_time": "21:30",
        "price": "",
        "location": "Rio Brazilian Steakhouse, 2729 Barnet Hwy, Coquitlam, BC V6C3R3, Canada",
        "description": "Celebrate Father's Day with an all-you-can-eat experience for lunch or dinner. Enjoy fire-grilled carved BBQ, salad bar, hot buffet, and local craft beer from Parallel 49 Beer. Rooftop patio is open."
    },
    {
        "source": "Rio Brazilian Steakhouse",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Dinner Menu All Day for Dad",
        "day_of_week": "Sunday",
        "start_date": "2025-06-15",
        "end_date": "2025-06-15",
        "start_time": "12:00",
        "end_time": "21:30",
        "price": "",
        "location": "Rio Brazilian Steakhouse, 2729 Barnet Hwy, Coquitlam, BC V6C3R3, Canada",
        "description": "Enjoy the full dinner menu all day long on Father's Day. Experience over 10 cuts of premium carved barbecue, fresh salad bar, hot buffet, starters, and local craft beer from Parallel 49 Beer."
    },
    {
        "source": "Rio Brazilian Steakhouse",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Father’s Day, Brazilian Style",
        "day_of_week": "Sunday",
        "start_date": "2025-06-15",
        "end_date": "2025-06-15",
        "start_time": "12:00",
        "end_time": "21:30",
        "price": "",
        "location": "Rio Brazilian Steakhouse, 2729 Barnet Hwy, Coquitlam, BC V6C3R3, Canada",
        "description": "Celebrate Father's Day with a Brazilian-style feast. Enjoy the full dinner menu all day, featuring over 10 cuts of fire-grilled meat, fresh salad bar, hot buffet, and local craft beer from Parallel 49 Beer."
    }
]
2025-06-18 14:00:16 [root] INFO: def clean_up_address(): Starting with events_df shape: (4, 14)
2025-06-18 14:00:16 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse, 2729 Barnet Hwy, Coquitlam, BC V6C3R3, Canada' (event_id: None)
2025-06-18 14:00:16 [root] INFO: get_address_id: Inserted or updated address_id 12043 for address '1288 Cordova ST W, VANCOUVER, BC, V6C3R3, CA'.
2025-06-18 14:00:16 [root] INFO: Populated from DB for postal code 'V6C3R3': '1288 Cordova ST W, VANCOUVER, BC, V6C3R3, CA'
2025-06-18 14:00:16 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse, 2729 Barnet Hwy, Coquitlam, BC V6C3R3, Canada' (event_id: None)
2025-06-18 14:00:16 [root] INFO: get_address_id: Inserted or updated address_id 12043 for address '1288 Cordova ST W, VANCOUVER, BC, V6C3R3, CA'.
2025-06-18 14:00:16 [root] INFO: Populated from DB for postal code 'V6C3R3': '1288 Cordova ST W, VANCOUVER, BC, V6C3R3, CA'
2025-06-18 14:00:16 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse, 2729 Barnet Hwy, Coquitlam, BC V6C3R3, Canada' (event_id: None)
2025-06-18 14:00:16 [root] INFO: get_address_id: Inserted or updated address_id 12043 for address '1288 Cordova ST W, VANCOUVER, BC, V6C3R3, CA'.
2025-06-18 14:00:16 [root] INFO: Populated from DB for postal code 'V6C3R3': '1288 Cordova ST W, VANCOUVER, BC, V6C3R3, CA'
2025-06-18 14:00:16 [root] INFO: def clean_up_address(): Processing location 'Rio Brazilian Steakhouse, 2729 Barnet Hwy, Coquitlam, BC V6C3R3, Canada' (event_id: None)
2025-06-18 14:00:16 [root] INFO: get_address_id: Inserted or updated address_id 12043 for address '1288 Cordova ST W, VANCOUVER, BC, V6C3R3, CA'.
2025-06-18 14:00:16 [root] INFO: Populated from DB for postal code 'V6C3R3': '1288 Cordova ST W, VANCOUVER, BC, V6C3R3, CA'
2025-06-18 14:00:16 [root] INFO: write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 14:00:16 [root] INFO: write_url_to_db(): appended URL 'https://riobraziliansteakhouse.ca/coquitlam/'
2025-06-18 14:00:16 [root] INFO: def process_llm_response: URL https://riobraziliansteakhouse.ca/coquitlam/ marked as relevant with events written to the database.
2025-06-18 14:00:16 [root] INFO: write_url_to_db(): appended URL 'https://riobraziliansteakhouse.ca/coquitlam/'
2025-06-18 14:00:16 [root] INFO: def parse(): URL https://riobraziliansteakhouse.ca/coquitlam/ marked as relevant (LLM positive).
2025-06-18 14:00:16 [root] INFO: def parse(): Found 10 links on https://riobraziliansteakhouse.ca/coquitlam/
2025-06-18 14:00:16 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.tbdine.com/book/restaurant/rio-brazilian-steakhouse-coquitlam?idApp=68692&language=en-us, URL: https://riobraziliansteakhouse.ca/coquitlam/, source: Rio Brazilian Steakhouse: Home, keywords: samba
2025-06-18 14:00:16 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: -mاy&(޲֮nX^jHhǜV):
2025-06-18 14:00:16 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.tbdine.com/book/restaurant/rio-brazilian-steakhouse-coquitlam?idApp=68692&language=en-us
2025-06-18 14:00:16 [root] INFO: write_url_to_db(): appended URL 'https://www.tbdine.com/book/restaurant/rio-brazilian-steakhouse-coquitlam?idApp=68692&language=en-us'
2025-06-18 14:00:16 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/vancouver/ was last seen as relevant, processing it.
2025-06-18 14:00:16 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/about-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:00:16 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/ was last seen as not relevant but hit_ratio (2.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:00:16 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/coquitlam/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:00:16 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/take-out-menu/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:00:16 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/blog/ was last seen as relevant, processing it.
2025-06-18 14:00:16 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/langley/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:00:16 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:00:16 [root] INFO: write_url_to_db(): appended URL 'https://riobraziliansteakhouse.ca/about-us/'
2025-06-18 14:00:16 [root] INFO: def parse(): URL https://riobraziliansteakhouse.ca/about-us/ marked as irrelevant (no keywords).
2025-06-18 14:00:16 [root] INFO: def parse(): Found 10 links on https://riobraziliansteakhouse.ca/about-us/
2025-06-18 14:00:16 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/vancouver/ was last seen as relevant, processing it.
2025-06-18 14:00:16 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/about-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:00:16 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/ was last seen as not relevant but hit_ratio (2.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:00:16 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/coquitlam/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:00:16 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/take-out-menu/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:00:16 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/blog/ was last seen as relevant, processing it.
2025-06-18 14:00:16 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/langley/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:00:16 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:00:16 [root] INFO: write_url_to_db(): appended URL 'https://riobraziliansteakhouse.ca/take-out-menu/'
2025-06-18 14:00:16 [root] INFO: def parse(): URL https://riobraziliansteakhouse.ca/take-out-menu/ marked as irrelevant (no keywords).
2025-06-18 14:00:16 [root] INFO: def parse(): Found 10 links on https://riobraziliansteakhouse.ca/take-out-menu/
2025-06-18 14:00:16 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/vancouver/ was last seen as relevant, processing it.
2025-06-18 14:00:16 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/about-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:00:16 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/ was last seen as not relevant but hit_ratio (2.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:00:16 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/coquitlam/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:00:16 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/take-out-menu/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:00:16 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/blog/ was last seen as relevant, processing it.
2025-06-18 14:00:16 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/langley/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:00:16 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:00:16 [root] INFO: def parse(): Found keywords for URL https://riobraziliansteakhouse.ca/langley/: ['samba']
2025-06-18 14:00:16 [root] INFO: def generate_prompt(): Generating prompt for URL: https://riobraziliansteakhouse.ca/langley/
2025-06-18 14:00:16 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:00:16 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:00:16 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:01:48 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:01:48 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "https://riobraziliansteakhouse.ca/langley/",
        "dance_style": "live music",
        "url": "",
        "event_type": "live music",
        "event_name": "Father’s Day Lunch Plans",
        "day_of_week": "Sunday",
        "start_date": "2025-06-15",
        "end_date": "2025-06-15",
        "start_time": "12:00",
        "end_time": "21:30",
        "price": "",
        "location": "RIO Brazilian Steakhouse, 1122 Denman St, Vancouver, BC",
        "description": "This Father's Day Lunch Plans? We’ve got you. 🥩 Father’s Day Lunch Plans? We’ve got you. You can still join us for lunch in Coquitlam and Downtown Vancouver, just steps from English Bay! 🔥 Rooftop open patio 🍖 Variety of carved BBQ cuts 🥗 Salad bar + hot buffet 🍻 Cold pints from @parallel49beer 🕛 Full Dinner Menu served all day, from 12PM to 9:30PM Don’t wait — book your Father’s Day lunch now! 🌐 www.riobraziliansteakhouse.ca Must be 19+ for any alcoholic beverage."
    },
    {
        "source": "https://riobraziliansteakhouse.ca/langley/",
        "dance_style": "live music",
        "url": "",
        "event_type": "live music",
        "event_name": "Father’s Day on the Rooftop",
        "day_of_week": "Sunday",
        "start_date": "2025-06-15",
        "end_date": "2025-06-15",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "RIO Brazilian Steakhouse, 1122 Denman St, Vancouver, BC",
        "description": "Celebrate Dad. 🌞 Celebrate Dad with a unforgettable all-you-can-eat experience for Lunch or Dinner this June 15th. Full dinner menu all day — from 12PM to 9:30PM — just steps from English Bay or in Coquitlam. 🔥 Fire-grilled carved BBQ 🍽️ All-you-can-eat Brazilian Rodízio 🥗 Salad bar & Hot Buffet 🍻 Local craft beer from @parallel49beer 🌴 And yes — our rooftop patio is OPEN! Spots are filling fast. Reserve your table today! Must be 19+ for any alcoholic beverage. 🌐 www.riobraziliansteakhouse.ca"
    },
    {
        "source": "https://riobraziliansteakhouse.ca/langley/",
        "dance_style": "live music",
        "url": "",
        "event_type": "live music",
        "event_name": "Dinner Menu All Day for Dad",
        "day_of_week": "Sunday",
        "start_date": "2025-06-15",
        "end_date": "2025-06-15",
        "start_time": "12:00",
        "end_time": "21:30",
        "price": "",
        "location": "RIO Brazilian Steakhouse, 1122 Denman St, Vancouver, BC",
        "description": "This Father’s Day, June 15th, we’re serving our full dinner menu — all day long! From 12PM to 9:30PM, enjoy the full Brazilian All-you-can-eat experience at Rio Brazilian Steakhouse: 🥩 Over 10 cuts of premium carved barbecue 🥗 Fresh salad bar 🍲 Hot buffet & starters 🌞 Open patio 🍻 Plus, local craft beer from @parallel49beer Lunch or dinner — Dad gets the full feast, no matter the time. Book your table now and celebrate big. 🇧🇷 🌐 www.riobraziliansteakhouse.ca"
    },
    {
        "source": "https://riobraziliansteakhouse.ca/langley/",
        "dance_style": "live music",
        "url": "",
        "event_type": "live music",
        "event_name": "Father’s Day, Brazilian Style",
        "day_of_week": "Sunday",
        "start_date": "2025-06-15",
        "end_date": "2025-06-15",
        "start_time": "12:00",
        "end_time": "21:30",
        "price": "$50 per adult",
        "location": "RIO Brazilian Steakhouse, 1122 Denman St, Vancouver, BC",
        "description": "We’ve teamed up with local legends @parallel49beer to bring you the ultimate Father’s Day celebration this June 15th! From 12:00 PM to 9:30 PM, enjoy our FULL DINNER MENU ALL DAY, bring Dad for LUNCH or DINNER – featuring over 10 cuts of fire-grilled meat, a fresh salad bar, hot buffet, and more at both Vancouver and Coquitlam locations! Lunch & Dinner | $50 per adult | Open patio available | Dinner menu all day 🔥 Book your table and celebrate with flavor! Must be 19+ for any alcoholic beverage. 🍻 Reserve now and give Dad the flavour trip to Brazil he deserves. 🌐 www.riobraziliansteakhouse.ca"
    }
]
2025-06-18 14:01:48 [root] INFO: def extract_and_parse_json(): for url https://riobraziliansteakhouse.ca/langley/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "https://riobraziliansteakhouse.ca/langley/",
        "dance_style": "live music",
        "url": "",
        "event_type": "live music",
        "event_name": "Father’s Day Lunch Plans",
        "day_of_week": "Sunday",
        "start_date": "2025-06-15",
        "end_date": "2025-06-15",
        "start_time": "12:00",
        "end_time": "21:30",
        "price": "",
        "location": "RIO Brazilian Steakhouse, 1122 Denman St, Vancouver, BC",
        "description": "This Father's Day Lunch Plans? We’ve got you. 🥩 Father’s Day Lunch Plans? We’ve got you. You can still join us for lunch in Coquitlam and Downtown Vancouver, just steps from English Bay! 🔥 Rooftop open patio 🍖 Variety of carved BBQ cuts 🥗 Salad bar + hot buffet 🍻 Cold pints from @parallel49beer 🕛 Full Dinner Menu served all day, from 12PM to 9:30PM Don’t wait — book your Father’s Day lunch now! 🌐 www.riobraziliansteakhouse.ca Must be 19+ for any alcoholic beverage."
    },
    {
        "source": "https://riobraziliansteakhouse.ca/langley/",
        "dance_style": "live music",
        "url": "",
        "event_type": "live music",
        "event_name": "Father’s Day on the Rooftop",
        "day_of_week": "Sunday",
        "start_date": "2025-06-15",
        "end_date": "2025-06-15",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "RIO Brazilian Steakhouse, 1122 Denman St, Vancouver, BC",
        "description": "Celebrate Dad. 🌞 Celebrate Dad with a unforgettable all-you-can-eat experience for Lunch or Dinner this June 15th. Full dinner menu all day — from 12PM to 9:30PM — just steps from English Bay or in Coquitlam. 🔥 Fire-grilled carved BBQ 🍽️ All-you-can-eat Brazilian Rodízio 🥗 Salad bar & Hot Buffet 🍻 Local craft beer from @parallel49beer 🌴 And yes — our rooftop patio is OPEN! Spots are filling fast. Reserve your table today! Must be 19+ for any alcoholic beverage. 🌐 www.riobraziliansteakhouse.ca"
    },
    {
        "source": "https://riobraziliansteakhouse.ca/langley/",
        "dance_style": "live music",
        "url": "",
        "event_type": "live music",
        "event_name": "Dinner Menu All Day for Dad",
        "day_of_week": "Sunday",
        "start_date": "2025-06-15",
        "end_date": "2025-06-15",
        "start_time": "12:00",
        "end_time": "21:30",
        "price": "",
        "location": "RIO Brazilian Steakhouse, 1122 Denman St, Vancouver, BC",
        "description": "This Father’s Day, June 15th, we’re serving our full dinner menu — all day long! From 12PM to 9:30PM, enjoy the full Brazilian All-you-can-eat experience at Rio Brazilian Steakhouse: 🥩 Over 10 cuts of premium carved barbecue 🥗 Fresh salad bar 🍲 Hot buffet & starters 🌞 Open patio 🍻 Plus, local craft beer from @parallel49beer Lunch or dinner — Dad gets the full feast, no matter the time. Book your table now and celebrate big. 🇧🇷 🌐 www.riobraziliansteakhouse.ca"
    },
    {
        "source": "https://riobraziliansteakhouse.ca/langley/",
        "dance_style": "live music",
        "url": "",
        "event_type": "live music",
        "event_name": "Father’s Day, Brazilian Style",
        "day_of_week": "Sunday",
        "start_date": "2025-06-15",
        "end_date": "2025-06-15",
        "start_time": "12:00",
        "end_time": "21:30",
        "price": "$50 per adult",
        "location": "RIO Brazilian Steakhouse, 1122 Denman St, Vancouver, BC",
        "description": "We’ve teamed up with local legends @parallel49beer to bring you the ultimate Father’s Day celebration this June 15th! From 12:00 PM to 9:30 PM, enjoy our FULL DINNER MENU ALL DAY, bring Dad for LUNCH or DINNER – featuring over 10 cuts of fire-grilled meat, a fresh salad bar, hot buffet, and more at both Vancouver and Coquitlam locations! Lunch & Dinner | $50 per adult | Open patio available | Dinner menu all day 🔥 Book your table and celebrate with flavor! Must be 19+ for any alcoholic beverage. 🍻 Reserve now and give Dad the flavour trip to Brazil he deserves. 🌐 www.riobraziliansteakhouse.ca"
    }
]
2025-06-18 14:01:48 [root] INFO: def clean_up_address(): Starting with events_df shape: (4, 14)
2025-06-18 14:01:48 [root] INFO: def clean_up_address(): Processing location 'RIO Brazilian Steakhouse, 1122 Denman St, Vancouver, BC' (event_id: None)
2025-06-18 14:01:48 [root] INFO: def clean_up_address(): Processing location 'RIO Brazilian Steakhouse, 1122 Denman St, Vancouver, BC' (event_id: None)
2025-06-18 14:01:48 [root] INFO: def clean_up_address(): Processing location 'RIO Brazilian Steakhouse, 1122 Denman St, Vancouver, BC' (event_id: None)
2025-06-18 14:01:48 [root] INFO: def clean_up_address(): Processing location 'RIO Brazilian Steakhouse, 1122 Denman St, Vancouver, BC' (event_id: None)
2025-06-18 14:01:48 [root] INFO: write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 14:01:48 [root] INFO: write_url_to_db(): appended URL 'https://riobraziliansteakhouse.ca/langley/'
2025-06-18 14:01:48 [root] INFO: def process_llm_response: URL https://riobraziliansteakhouse.ca/langley/ marked as relevant with events written to the database.
2025-06-18 14:01:48 [root] INFO: write_url_to_db(): appended URL 'https://riobraziliansteakhouse.ca/langley/'
2025-06-18 14:01:48 [root] INFO: def parse(): URL https://riobraziliansteakhouse.ca/langley/ marked as relevant (LLM positive).
2025-06-18 14:01:48 [root] INFO: def parse(): Found 10 links on https://riobraziliansteakhouse.ca/langley/
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/vancouver/ was last seen as relevant, processing it.
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/about-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/ was last seen as not relevant but hit_ratio (2.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/coquitlam/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/take-out-menu/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/blog/ was last seen as relevant, processing it.
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/langley/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://riobraziliansteakhouse.ca/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:01:48 [scrapy.extensions.logstats] INFO: Crawled 79 pages (at 1 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://bandcamp.com/partner was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://bandcamp.com/partner was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:01:48 [root] INFO: write_url_to_db(): appended URL 'https://bandcamp.com/partner'
2025-06-18 14:01:48 [root] INFO: def parse(): Crawling next URL: https://bandcamp.com/partner
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://www.wellnessliving.com/login/baza was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://www.wellnessliving.com/login/baza was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:01:48 [root] INFO: write_url_to_db(): appended URL 'https://www.wellnessliving.com/login/baza'
2025-06-18 14:01:48 [root] INFO: def parse(): Crawling next URL: https://www.wellnessliving.com/login/baza
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://bandcamp.com/settings?from=menubar was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://bandcamp.com/settings?from=menubar was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:01:48 [root] INFO: write_url_to_db(): appended URL 'https://bandcamp.com/settings?from=menubar'
2025-06-18 14:01:48 [root] INFO: def parse(): Crawling next URL: https://bandcamp.com/settings?from=menubar
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://www.wellnessliving.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://www.wellnessliving.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:01:48 [root] INFO: write_url_to_db(): appended URL 'https://www.wellnessliving.com/'
2025-06-18 14:01:48 [root] INFO: def parse(): Crawling next URL: https://www.wellnessliving.com/
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://bandcamp.com/?from=menubar_logo_logged_out was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://bandcamp.com/?from=menubar_logo_logged_out was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:01:48 [root] INFO: write_url_to_db(): appended URL 'https://bandcamp.com/?from=menubar_logo_logged_out'
2025-06-18 14:01:48 [root] INFO: def parse(): Crawling next URL: https://bandcamp.com/?from=menubar_logo_logged_out
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://www.wellnessliving.com/catalog/baza was last seen as relevant, processing it.
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://www.wellnessliving.com/catalog/baza was last seen as relevant, processing it.
2025-06-18 14:01:48 [root] INFO: write_url_to_db(): appended URL 'https://www.wellnessliving.com/catalog/baza'
2025-06-18 14:01:48 [root] INFO: def parse(): Crawling next URL: https://www.wellnessliving.com/catalog/baza
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://bandcamp.com/cart was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://bandcamp.com/cart was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:01:48 [root] INFO: write_url_to_db(): appended URL 'https://bandcamp.com/cart'
2025-06-18 14:01:48 [root] INFO: def parse(): Crawling next URL: https://bandcamp.com/cart
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://www.wellnessliving.com/signup/baza was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://www.wellnessliving.com/signup/baza was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:01:48 [root] INFO: write_url_to_db(): appended URL 'https://www.wellnessliving.com/signup/baza'
2025-06-18 14:01:48 [root] INFO: def parse(): Crawling next URL: https://www.wellnessliving.com/signup/baza
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://nataliepadilla.bandcamp.com/track/going-going-gone was last seen as relevant, processing it.
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://nataliepadilla.bandcamp.com was last seen as relevant, processing it.
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://nataliepadilla.bandcamp.com was last seen as relevant, processing it.
2025-06-18 14:01:48 [root] INFO: write_url_to_db(): appended URL 'https://nataliepadilla.bandcamp.com'
2025-06-18 14:01:48 [root] INFO: def parse(): Crawling next URL: https://nataliepadilla.bandcamp.com
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://www.wellnessliving.com/rs/report-page.html?sid_report_page=profile-attendance-schedule was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://www.wellnessliving.com/rs/report-page.html?sid_report_page=profile-attendance-schedule was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:01:48 [root] INFO: write_url_to_db(): appended URL 'https://www.wellnessliving.com/rs/report-page.html?sid_report_page=profile-attendance-schedule'
2025-06-18 14:01:48 [root] INFO: def parse(): Crawling next URL: https://www.wellnessliving.com/rs/report-page.html?sid_report_page=profile-attendance-schedule
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://bandcamp.com/login?from=menubar was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://bandcamp.com/login?from=menubar was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:01:48 [root] INFO: write_url_to_db(): appended URL 'https://bandcamp.com/login?from=menubar'
2025-06-18 14:01:48 [root] INFO: def parse(): Crawling next URL: https://bandcamp.com/login?from=menubar
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://www.wellnessliving.com/rs/event/baza?k_class=793226&k_class_tab=31450 was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://www.wellnessliving.com/rs/reward-board.html was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://www.wellnessliving.com/rs/reward-board.html was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:01:48 [root] INFO: write_url_to_db(): appended URL 'https://www.wellnessliving.com/rs/reward-board.html'
2025-06-18 14:01:48 [root] INFO: def parse(): Crawling next URL: https://www.wellnessliving.com/rs/reward-board.html
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://f4.bcbits.com/img/a2049198990_10.jpg was last seen as relevant, processing it.
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://f4.bcbits.com/img/a2049198990_10.jpg was last seen as relevant, processing it.
2025-06-18 14:01:48 [root] INFO: write_url_to_db(): appended URL 'https://f4.bcbits.com/img/a2049198990_10.jpg'
2025-06-18 14:01:48 [root] INFO: def parse(): Crawling next URL: https://f4.bcbits.com/img/a2049198990_10.jpg
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://www.wellnessliving.com/schedule/baza was last seen as relevant, processing it.
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://www.wellnessliving.com/schedule/baza was last seen as relevant, processing it.
2025-06-18 14:01:48 [root] INFO: write_url_to_db(): appended URL 'https://www.wellnessliving.com/schedule/baza'
2025-06-18 14:01:48 [root] INFO: def parse(): Crawling next URL: https://www.wellnessliving.com/schedule/baza
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://get.bandcamp.help was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:01:48 [root] INFO: should_process_url: URL https://get.bandcamp.help was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:01:48 [root] INFO: write_url_to_db(): appended URL 'https://get.bandcamp.help'
2025-06-18 14:01:48 [root] INFO: def parse(): Crawling next URL: https://get.bandcamp.help
2025-06-18 14:01:49 [root] INFO: def parse(): Found keywords for URL https://nataliepadilla.bandcamp.com/album/montana-wildflower: ['bachata', 'dance', 'merengue', 'salsa', 'swing', 'tango', 'zouk']
2025-06-18 14:01:49 [root] INFO: def generate_prompt(): Generating prompt for URL: https://nataliepadilla.bandcamp.com/album/montana-wildflower
2025-06-18 14:01:49 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:01:49 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:01:49 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:02:55 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:02:55 [root] INFO: query_llm(): Mistral response received: <!--source_type: album -->
<!-- extracted_date: 2023-06-18 -->
<!-- performer: Natalie Padilla -->
<!-- genre: celtic -->
<!-- dance_style: ,  -->
<!-- event_type: live music event -->
<!-- start_date: June 18, 2023 -->
<!-- start_time: 19:00 -->
<!-- timezone: PDT -->
<!-- venue:
Williamsburg Community Center
34 Hen St
Williamsburg, MA 01096
United States
 -->
<!-- organizer:

Williamsburg, MA, United States
 -->
<!-- description: Dance to the lively rhythms of Natalie Padilla's celtic and old-time tunes. Enjoy an evening of traditional music and dance, featuring a variety of dances including contras and squares. All levels welcome!

Tickets: $20
 -->
<!-- status: valid -->
<!-- source: valid -->
<!-- start_date is less than or equal to one year from today's date (June 18, 2024) or unspecified -->
<!-- The event occurs on a Sunday and the current date is also a Sunday. -->
<!-- The event is a one-time event. -->

No events found.
2025-06-18 14:02:55 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 14:02:55 [root] INFO: write_url_to_db(): appended URL 'https://nataliepadilla.bandcamp.com/album/montana-wildflower'
2025-06-18 14:02:55 [root] INFO: def parse(): URL https://nataliepadilla.bandcamp.com/album/montana-wildflower marked as irrelevant (LLM negative).
2025-06-18 14:02:55 [root] INFO: def parse(): Found 10 links on https://nataliepadilla.bandcamp.com/album/montana-wildflower
2025-06-18 14:02:55 [root] INFO: should_process_url: URL https://bandcamp.com/logout was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:02:55 [root] INFO: should_process_url: URL https://bandcamp.com/partner was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:02:55 [root] INFO: should_process_url: URL https://bandcamp.com/settings?from=menubar was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:02:55 [root] INFO: should_process_url: URL https://f4.bcbits.com/img/a0298106877_10.jpg was last seen as relevant, processing it.
2025-06-18 14:02:55 [root] INFO: should_process_url: URL https://f4.bcbits.com/img/a0298106877_10.jpg was last seen as relevant, processing it.
2025-06-18 14:02:55 [root] INFO: write_url_to_db(): appended URL 'https://f4.bcbits.com/img/a0298106877_10.jpg'
2025-06-18 14:02:55 [root] INFO: def parse(): Crawling next URL: https://f4.bcbits.com/img/a0298106877_10.jpg
2025-06-18 14:02:55 [scrapy.extensions.logstats] INFO: Crawled 84 pages (at 5 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 14:02:55 [root] INFO: should_process_url: URL https://nataliepadilla.bandcamp.com/album/montana-wildflower was last seen as relevant, processing it.
2025-06-18 14:02:55 [root] INFO: should_process_url: URL https://bandcamp.com/?from=menubar_logo_logged_out was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:02:55 [root] INFO: should_process_url: URL https://bandcamp.com/cart was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:02:55 [root] INFO: should_process_url: URL https://bandcamp.com/login?from=menubar was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:02:55 [root] INFO: should_process_url: URL https://nataliepadilla.bandcamp.com was last seen as relevant, processing it.
2025-06-18 14:02:55 [root] INFO: should_process_url: URL https://get.bandcamp.help was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:02:56 [root] INFO: def parse(): Found keywords for URL https://dancevictoria.com/support/donate/: ['dance']
2025-06-18 14:02:56 [root] INFO: def generate_prompt(): Generating prompt for URL: https://dancevictoria.com/support/donate/
2025-06-18 14:02:56 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:02:56 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:02:56 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:03:20 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:03:20 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "Dance Victoria: Donate Today",
        "dance_style": "",
        "url": "",
        "event_type": "social dance",
        "event_name": "Dance Victoria",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-25",
        "end_date": "2025-06-25",
        "start_time": "10:00",
        "end_time": "17:00",
        "price": "",
        "location": "Dance Victoria Studios, 2750 Quadra St (north entrance), Victoria, BC V8T 4E8",
        "description": "A social dance event at Dance Victoria Studios."
    },
    {
        "source": "Dance Victoria: Donate Today",
        "dance_style": "",
        "url": "",
        "event_type": "rehearsal",
        "event_name": "Rough Cuts",
        "day_of_week": "Saturday",
        "start_date": "2025-06-29",
        "end_date": "2025-06-29",
        "start_time": "19:00",
        "end_time": null,
        "price": "",
        "location": "Dance Victoria Studios, 2750 Quadra St (north entrance), Victoria, BC V8T 4E8",
        "description": "Rough Cuts rehearsal event at Dance Victoria Studios."
    }
]
2025-06-18 14:03:20 [root] INFO: def extract_and_parse_json(): for url https://dancevictoria.com/support/donate/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Dance Victoria: Donate Today",
        "dance_style": "",
        "url": "",
        "event_type": "social dance",
        "event_name": "Dance Victoria",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-25",
        "end_date": "2025-06-25",
        "start_time": "10:00",
        "end_time": "17:00",
        "price": "",
        "location": "Dance Victoria Studios, 2750 Quadra St (north entrance), Victoria, BC V8T 4E8",
        "description": "A social dance event at Dance Victoria Studios."
    },
    {
        "source": "Dance Victoria: Donate Today",
        "dance_style": "",
        "url": "",
        "event_type": "rehearsal",
        "event_name": "Rough Cuts",
        "day_of_week": "Saturday",
        "start_date": "2025-06-29",
        "end_date": "2025-06-29",
        "start_time": "19:00",
        "end_time": null,
        "price": "",
        "location": "Dance Victoria Studios, 2750 Quadra St (north entrance), Victoria, BC V8T 4E8",
        "description": "Rough Cuts rehearsal event at Dance Victoria Studios."
    }
]
2025-06-18 14:03:20 [root] INFO: def clean_up_address(): Starting with events_df shape: (2, 14)
2025-06-18 14:03:20 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria Studios, 2750 Quadra St (north entrance), Victoria, BC V8T 4E8' (event_id: None)
2025-06-18 14:03:20 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 14:03:20 [root] INFO: def clean_up_address(): Processing location 'Dance Victoria Studios, 2750 Quadra St (north entrance), Victoria, BC V8T 4E8' (event_id: None)
2025-06-18 14:03:20 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 14:03:20 [root] INFO: write_events_to_db: Number of events to write: 2
2025-06-18 14:03:20 [root] INFO: write_url_to_db(): appended URL 'https://dancevictoria.com/support/donate/'
2025-06-18 14:03:20 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 14:03:20 [root] INFO: def process_llm_response: URL https://dancevictoria.com/support/donate/ marked as relevant with events written to the database.
2025-06-18 14:03:20 [root] INFO: write_url_to_db(): appended URL 'https://dancevictoria.com/support/donate/'
2025-06-18 14:03:20 [root] INFO: def parse(): URL https://dancevictoria.com/support/donate/ marked as relevant (LLM positive).
2025-06-18 14:03:20 [root] INFO: def parse(): Found 10 links on https://dancevictoria.com/support/donate/
2025-06-18 14:03:20 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-TKPSD4XK, URL: https://dancevictoria.com/support/donate/, source: Performances - Dance Victoria, keywords: dance
2025-06-18 14:03:20 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 14:03:20 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-TKPSD4XK
2025-06-18 14:03:20 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-TKPSD4XK'
2025-06-18 14:03:20 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/DanceVictoria/'
2025-06-18 14:03:20 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/DanceVictoria/
2025-06-18 14:03:20 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/dance_victoria/'
2025-06-18 14:03:20 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/dance_victoria/
2025-06-18 14:03:20 [root] INFO: should_process_url: URL https://dancevictoria.com/learn/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:03:20 [root] INFO: should_process_url: URL https://dancevictoria.com/performances/tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:03:20 [root] INFO: should_process_url: URL https://vimeo.com/dancevictoria was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:03:20 [root] INFO: should_process_url: URL https://dancevictoria.com/calendar/ was last seen as relevant, processing it.
2025-06-18 14:03:20 [root] INFO: should_process_url: URL https://dancevictoria.com/learn/news/ was last seen as relevant, processing it.
2025-06-18 14:03:20 [root] INFO: should_process_url: URL https://dancevictoria.com/ was last seen as not relevant but hit_ratio (0.33) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 14:03:20 [root] INFO: should_process_url: URL https://dancevictoria.com/support/donate/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:03:20 [root] INFO: should_process_url: URL https://dancevictoria.com/season-trailer/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:03:20 [root] INFO: def parse(): Found keywords for URL https://dancevictoria.com/season-trailer/: ['dance']
2025-06-18 14:03:20 [root] INFO: def generate_prompt(): Generating prompt for URL: https://dancevictoria.com/season-trailer/
2025-06-18 14:03:20 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:03:20 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:03:20 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:03:33 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:03:33 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 14:03:33 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 14:03:33 [root] INFO: write_url_to_db(): appended URL 'https://dancevictoria.com/season-trailer/'
2025-06-18 14:03:33 [root] INFO: def parse(): URL https://dancevictoria.com/season-trailer/ marked as irrelevant (LLM negative).
2025-06-18 14:03:33 [root] INFO: def parse(): Found 10 links on https://dancevictoria.com/season-trailer/
2025-06-18 14:03:33 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-TKPSD4XK, URL: https://dancevictoria.com/season-trailer/, source: Dance Victoria brings the World's Best Dance to Victoria Canada, keywords: dance
2025-06-18 14:03:33 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 14:03:33 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-TKPSD4XK
2025-06-18 14:03:33 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://player.vimeo.com/video/1084395331?dnt=1&app_id=122963, URL: https://dancevictoria.com/season-trailer/, source: Dance Victoria brings the World's Best Dance to Victoria Canada, keywords: dance
2025-06-18 14:03:33 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: Vzoר]<y}]
2025-06-18 14:03:33 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://player.vimeo.com/video/1084395331?dnt=1&app_id=122963
2025-06-18 14:03:33 [root] INFO: write_url_to_db(): appended URL 'https://player.vimeo.com/video/1084395331?dnt=1&app_id=122963'
2025-06-18 14:03:33 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/DanceVictoria/'
2025-06-18 14:03:33 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/DanceVictoria/
2025-06-18 14:03:33 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/dance_victoria/'
2025-06-18 14:03:33 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/dance_victoria/
2025-06-18 14:03:33 [root] INFO: should_process_url: URL https://dancevictoria.com/learn/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:03:33 [root] INFO: should_process_url: URL https://dancevictoria.com/performances/tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:03:33 [root] INFO: should_process_url: URL https://vimeo.com/dancevictoria was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:03:33 [root] INFO: should_process_url: URL https://dancevictoria.com/calendar/ was last seen as relevant, processing it.
2025-06-18 14:03:33 [root] INFO: should_process_url: URL https://dancevictoria.com/learn/news/ was last seen as relevant, processing it.
2025-06-18 14:03:33 [root] INFO: should_process_url: URL https://dancevictoria.com/ was last seen as not relevant but hit_ratio (0.33) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 14:03:33 [root] INFO: should_process_url: URL https://dancevictoria.com/support/donate/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:03:33 [root] INFO: should_process_url: URL https://dancevictoria.com/season-trailer/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:03:34 [root] INFO: def parse(): Found keywords for URL https://dancevictoria.com/learn/news/: ['dance']
2025-06-18 14:03:34 [root] INFO: def generate_prompt(): Generating prompt for URL: https://dancevictoria.com/learn/news/
2025-06-18 14:03:34 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:03:34 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:03:34 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:05:17 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:05:17 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "https://dancevictoria.com/learn/news/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Compañía Rafaela Carrasco Brings Award-winning Contemporary Flamenco to Victoria",
        "day_of_week": "Friday",
        "start_date": "2025-04-11",
        "end_date": "2025-04-11",
        "start_time": "19:30",
        "end_time": null,
        "price": "",
        "location": "Royal Theatre",
        "description": "Friday + Saturday, April 11 + 12, 7:30 pm, Royal Theatre Dance Victoria’s 28th season of the World’s Best..."
    },
    {
        "source": "https://dancevictoria.com/learn/news/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Compañía Rafaela Carrasco Brings Award-winning Contemporary Flamenco to Victoria",
        "day_of_week": "Saturday",
        "start_date": "2025-04-12",
        "end_date": "2025-04-12",
        "start_time": "19:30",
        "end_time": null,
        "price": "",
        "location": "Royal Theatre",
        "description": "Friday + Saturday, April 11 + 12, 7:30 pm, Royal Theatre Dance Victoria’s 28th season of the World’s Best..."
    },
    {
        "source": "https://dancevictoria.com/learn/news/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Les Ballets Trockadero de Monte Carlo returns to Victoria in a 50th Anniversary Program",
        "day_of_week": "Friday",
        "start_date": "2025-02-07",
        "end_date": "2025-02-07",
        "start_time": "19:30",
        "end_time": null,
        "price": "",
        "location": "Royal Theatre",
        "description": "Friday + Saturday, February 7 + 8, 7:30 pm Royal Theatre The world’s foremost all-male comic ballet company, Les..."
    },
    {
        "source": "https://dancevictoria.com/learn/news/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Les Ballets Trockadero de Monte Carlo returns to Victoria in a 50th Anniversary Program",
        "day_of_week": "Saturday",
        "start_date": "2025-02-08",
        "end_date": "2025-02-08",
        "start_time": "19:30",
        "end_time": null,
        "price": "",
        "location": "Royal Theatre",
        "description": "Friday + Saturday, February 7 + 8, 7:30 pm Royal Theatre The world’s foremost all-male comic ballet company, Les..."
    },
    {
        "source": "https://dancevictoria.com/learn/news/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Canadian Premiere: Shamel Pitts | TRIBE Brings Afrofuturist Contemporary Dance to Victoria",
        "day_of_week": "Thursday",
        "start_date": "2025-02-20",
        "end_date": "2025-02-20",
        "start_time": "19:30",
        "end_time": null,
        "price": "",
        "location": "McPherson Playhouse",
        "description": "ONE NIGHT ONLY! Thursday, February 20, 7:30 pm McPherson Playhouse Dance Victoria presents the Canadian Premiere of 2024 MacArthur..."
    },
    {
        "source": "https://dancevictoria.com/learn/news/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Dance Victoria and Impulse Theatre Co-Present Premiere by Award-winning Local Choreographer Amber Downie-Back",
        "day_of_week": "Friday",
        "start_date": "2025-03-28",
        "end_date": "2025-03-28",
        "start_time": "19:00",
        "end_time": null,
        "price": "",
        "location": "DV Studios, 2750 Quadra St.",
        "description": "March 28 + 29, 7:00 pm, DV Studios, 2750 Quadra St. On March 28 + 29, Dance Victoria and..."
    },
    {
        "source": "https://dancevictoria.com/learn/news/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Dance Victoria and Impulse Theatre Co-Present Premiere by Award-winning Local Choreographer Amber Downie-Back",
        "day_of_week": "Saturday",
        "start_date": "2025-03-29",
        "end_date": "2025-03-29",
        "start_time": "19:00",
        "end_time": null,
        "price": "",
        "location": "DV Studios, 2750 Quadra St.",
        "description": "March 28 + 29, 7:00 pm, DV Studios, 2750 Quadra St. On March 28 + 29, Dance Victoria and..."
    },
    {
        "source": "https://dancevictoria.com/learn/news/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Ballet BC returns to Victoria with two new works in monumental triple bill",
        "day_of_week": "Friday",
        "start_date": "2025-03-14",
        "end_date": "2025-03-14",
        "start_time": "19:30",
        "end_time": null,
        "price": "",
        "location": "Royal Theatre",
        "description": "Friday + Saturday, March 14 + 15, 7:30 pm, Royal Theatre On March 14 + 15, Ballet BC returns..."
    },
    {
        "source": "https://dancevictoria.com/learn/news/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Ballet BC returns to Victoria with two new works in monumental triple bill",
        "day_of_week": "Saturday",
        "start_date": "2025-03-15",
        "end_date": "2025-03-15",
        "start_time": "19:30",
        "end_time": null,
        "price": "",
        "location": "Royal Theatre",
        "description": "Friday + Saturday, March 14 + 15, 7:30 pm, Royal Theatre On March 14 + 15, Ballet BC returns..."
    }
]
2025-06-18 14:05:17 [root] INFO: def extract_and_parse_json(): for url https://dancevictoria.com/learn/news/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "https://dancevictoria.com/learn/news/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Compañía Rafaela Carrasco Brings Award-winning Contemporary Flamenco to Victoria",
        "day_of_week": "Friday",
        "start_date": "2025-04-11",
        "end_date": "2025-04-11",
        "start_time": "19:30",
        "end_time": null,
        "price": "",
        "location": "Royal Theatre",
        "description": "Friday + Saturday, April 11 + 12, 7:30 pm, Royal Theatre Dance Victoria’s 28th season of the World’s Best"
    },
    {
        "source": "https://dancevictoria.com/learn/news/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Compañía Rafaela Carrasco Brings Award-winning Contemporary Flamenco to Victoria",
        "day_of_week": "Saturday",
        "start_date": "2025-04-12",
        "end_date": "2025-04-12",
        "start_time": "19:30",
        "end_time": null,
        "price": "",
        "location": "Royal Theatre",
        "description": "Friday + Saturday, April 11 + 12, 7:30 pm, Royal Theatre Dance Victoria’s 28th season of the World’s Best"
    },
    {
        "source": "https://dancevictoria.com/learn/news/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Les Ballets Trockadero de Monte Carlo returns to Victoria in a 50th Anniversary Program",
        "day_of_week": "Friday",
        "start_date": "2025-02-07",
        "end_date": "2025-02-07",
        "start_time": "19:30",
        "end_time": null,
        "price": "",
        "location": "Royal Theatre",
        "description": "Friday + Saturday, February 7 + 8, 7:30 pm Royal Theatre The world’s foremost all-male comic ballet company, Les"
    },
    {
        "source": "https://dancevictoria.com/learn/news/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Les Ballets Trockadero de Monte Carlo returns to Victoria in a 50th Anniversary Program",
        "day_of_week": "Saturday",
        "start_date": "2025-02-08",
        "end_date": "2025-02-08",
        "start_time": "19:30",
        "end_time": null,
        "price": "",
        "location": "Royal Theatre",
        "description": "Friday + Saturday, February 7 + 8, 7:30 pm Royal Theatre The world’s foremost all-male comic ballet company, Les"
    },
    {
        "source": "https://dancevictoria.com/learn/news/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Canadian Premiere: Shamel Pitts | TRIBE Brings Afrofuturist Contemporary Dance to Victoria",
        "day_of_week": "Thursday",
        "start_date": "2025-02-20",
        "end_date": "2025-02-20",
        "start_time": "19:30",
        "end_time": null,
        "price": "",
        "location": "McPherson Playhouse",
        "description": "ONE NIGHT ONLY! Thursday, February 20, 7:30 pm McPherson Playhouse Dance Victoria presents the Canadian Premiere of 2024 MacArthur"
    },
    {
        "source": "https://dancevictoria.com/learn/news/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Dance Victoria and Impulse Theatre Co-Present Premiere by Award-winning Local Choreographer Amber Downie-Back",
        "day_of_week": "Friday",
        "start_date": "2025-03-28",
        "end_date": "2025-03-28",
        "start_time": "19:00",
        "end_time": null,
        "price": "",
        "location": "DV Studios, 2750 Quadra St.",
        "description": "March 28 + 29, 7:00 pm, DV Studios, 2750 Quadra St. On March 28 + 29, Dance Victoria and"
    },
    {
        "source": "https://dancevictoria.com/learn/news/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Dance Victoria and Impulse Theatre Co-Present Premiere by Award-winning Local Choreographer Amber Downie-Back",
        "day_of_week": "Saturday",
        "start_date": "2025-03-29",
        "end_date": "2025-03-29",
        "start_time": "19:00",
        "end_time": null,
        "price": "",
        "location": "DV Studios, 2750 Quadra St.",
        "description": "March 28 + 29, 7:00 pm, DV Studios, 2750 Quadra St. On March 28 + 29, Dance Victoria and"
    },
    {
        "source": "https://dancevictoria.com/learn/news/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Ballet BC returns to Victoria with two new works in monumental triple bill",
        "day_of_week": "Friday",
        "start_date": "2025-03-14",
        "end_date": "2025-03-14",
        "start_time": "19:30",
        "end_time": null,
        "price": "",
        "location": "Royal Theatre",
        "description": "Friday + Saturday, March 14 + 15, 7:30 pm, Royal Theatre On March 14 + 15, Ballet BC returns"
    },
    {
        "source": "https://dancevictoria.com/learn/news/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Ballet BC returns to Victoria with two new works in monumental triple bill",
        "day_of_week": "Saturday",
        "start_date": "2025-03-15",
        "end_date": "2025-03-15",
        "start_time": "19:30",
        "end_time": null,
        "price": "",
        "location": "Royal Theatre",
        "description": "Friday + Saturday, March 14 + 15, 7:30 pm, Royal Theatre On March 14 + 15, Ballet BC returns"
    }
]
2025-06-18 14:05:17 [root] INFO: def clean_up_address(): Starting with events_df shape: (9, 14)
2025-06-18 14:05:17 [root] INFO: def clean_up_address(): Processing location 'Royal Theatre' (event_id: None)
2025-06-18 14:05:17 [root] INFO: def clean_up_address(): Processing location 'Royal Theatre' (event_id: None)
2025-06-18 14:05:17 [root] INFO: def clean_up_address(): Processing location 'Royal Theatre' (event_id: None)
2025-06-18 14:05:17 [root] INFO: def clean_up_address(): Processing location 'Royal Theatre' (event_id: None)
2025-06-18 14:05:17 [root] INFO: def clean_up_address(): Processing location 'McPherson Playhouse' (event_id: None)
2025-06-18 14:05:17 [root] INFO: def clean_up_address(): Processing location 'DV Studios, 2750 Quadra St.' (event_id: None)
2025-06-18 14:05:17 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 14:05:17 [root] INFO: def clean_up_address(): Processing location 'DV Studios, 2750 Quadra St.' (event_id: None)
2025-06-18 14:05:17 [root] INFO: def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 14:05:17 [root] INFO: def clean_up_address(): Processing location 'Royal Theatre' (event_id: None)
2025-06-18 14:05:17 [root] INFO: def clean_up_address(): Processing location 'Royal Theatre' (event_id: None)
2025-06-18 14:05:17 [root] INFO: write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 14:05:17 [root] INFO: write_url_to_db(): appended URL 'https://dancevictoria.com/learn/news/'
2025-06-18 14:05:17 [root] INFO: def process_llm_response: URL https://dancevictoria.com/learn/news/ marked as relevant with events written to the database.
2025-06-18 14:05:17 [root] INFO: write_url_to_db(): appended URL 'https://dancevictoria.com/learn/news/'
2025-06-18 14:05:18 [root] INFO: def parse(): URL https://dancevictoria.com/learn/news/ marked as relevant (LLM positive).
2025-06-18 14:05:18 [root] INFO: def parse(): Found 10 links on https://dancevictoria.com/learn/news/
2025-06-18 14:05:18 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-TKPSD4XK, URL: https://dancevictoria.com/learn/news/, source: Dance Victoria brings the World's Best Dance to Victoria Canada, keywords: dance
2025-06-18 14:05:18 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 14:05:18 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-TKPSD4XK
2025-06-18 14:05:18 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-TKPSD4XK'
2025-06-18 14:05:18 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/DanceVictoria/'
2025-06-18 14:05:18 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/DanceVictoria/
2025-06-18 14:05:18 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/dance_victoria/'
2025-06-18 14:05:18 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/dance_victoria/
2025-06-18 14:05:18 [root] INFO: should_process_url: URL https://dancevictoria.com/learn/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:05:18 [root] INFO: should_process_url: URL https://dancevictoria.com/performances/tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:05:18 [root] INFO: should_process_url: URL https://vimeo.com/dancevictoria was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:05:18 [root] INFO: should_process_url: URL https://dancevictoria.com/calendar/ was last seen as relevant, processing it.
2025-06-18 14:05:18 [root] INFO: should_process_url: URL https://dancevictoria.com/learn/news/ was last seen as relevant, processing it.
2025-06-18 14:05:18 [root] INFO: should_process_url: URL https://dancevictoria.com/ was last seen as not relevant but hit_ratio (0.33) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 14:05:18 [root] INFO: should_process_url: URL https://dancevictoria.com/support/donate/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:05:18 [root] INFO: should_process_url: URL https://dancevictoria.com/season-trailer/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:05:18 [root] INFO: def parse(): Found keywords for URL https://nataliepadilla.bandcamp.com/album/eostre: ['bachata', 'dance', 'merengue', 'salsa', 'swing', 'tango']
2025-06-18 14:05:18 [root] INFO: def generate_prompt(): Generating prompt for URL: https://nataliepadilla.bandcamp.com/album/eostre
2025-06-18 14:05:18 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:05:18 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:05:18 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:05:43 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:05:43 [root] INFO: query_llm(): Mistral response received: <!--The page in the app that allows users to find events happening near them. -->
<!-- The page in the app that allows users to find events happening near them. -->

No events found.
2025-06-18 14:05:43 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 14:05:43 [root] INFO: write_url_to_db(): appended URL 'https://nataliepadilla.bandcamp.com/album/eostre'
2025-06-18 14:05:43 [root] INFO: def parse(): URL https://nataliepadilla.bandcamp.com/album/eostre marked as irrelevant (LLM negative).
2025-06-18 14:05:43 [root] INFO: def parse(): Found 10 links on https://nataliepadilla.bandcamp.com/album/eostre
2025-06-18 14:05:43 [root] INFO: should_process_url: URL https://nataliepadilla.bandcamp.com/album/eostre was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:05:43 [root] INFO: should_process_url: URL https://bandcamp.com/logout was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:05:43 [root] INFO: should_process_url: URL https://f4.bcbits.com/img/a1105103918_10.jpg was last seen as relevant, processing it.
2025-06-18 14:05:43 [root] INFO: should_process_url: URL https://f4.bcbits.com/img/a1105103918_10.jpg was last seen as relevant, processing it.
2025-06-18 14:05:43 [root] INFO: write_url_to_db(): appended URL 'https://f4.bcbits.com/img/a1105103918_10.jpg'
2025-06-18 14:05:43 [root] INFO: def parse(): Crawling next URL: https://f4.bcbits.com/img/a1105103918_10.jpg
2025-06-18 14:05:43 [root] INFO: def parse(): Found keywords for URL https://dancevictoria.com/calendar/: ['dance']
2025-06-18 14:05:43 [root] INFO: def generate_prompt(): Generating prompt for URL: https://dancevictoria.com/calendar/
2025-06-18 14:05:43 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:05:43 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:05:43 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:07:08 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:07:08 [root] INFO: query_llm(): Mistral response received: 																																																																																																																																																																																																													
2025-06-18 14:07:08 [root] ERROR: def extract_and_parse_json(): couldn't isolate JSON blob in result from https://dancevictoria.com/calendar/
2025-06-18 14:07:08 [root] INFO: write_url_to_db(): appended URL 'https://dancevictoria.com/calendar/'
2025-06-18 14:07:08 [root] INFO: def parse(): URL https://dancevictoria.com/calendar/ marked as irrelevant (LLM negative).
2025-06-18 14:07:08 [root] INFO: def parse(): Found 10 links on https://dancevictoria.com/calendar/
2025-06-18 14:07:08 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-TKPSD4XK, URL: https://dancevictoria.com/calendar/, source: Performances - Dance Victoria, keywords: dance
2025-06-18 14:07:08 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 14:07:08 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-TKPSD4XK
2025-06-18 14:07:08 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-TKPSD4XK'
2025-06-18 14:07:08 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/DanceVictoria/'
2025-06-18 14:07:08 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/DanceVictoria/
2025-06-18 14:07:08 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/dance_victoria/'
2025-06-18 14:07:08 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/dance_victoria/
2025-06-18 14:07:08 [root] INFO: should_process_url: URL https://dancevictoria.com/learn/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:07:08 [root] INFO: should_process_url: URL https://dancevictoria.com/performances/tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:07:08 [root] INFO: should_process_url: URL https://vimeo.com/dancevictoria was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:07:08 [root] INFO: should_process_url: URL https://dancevictoria.com/calendar/ was last seen as relevant, processing it.
2025-06-18 14:07:08 [root] INFO: should_process_url: URL https://dancevictoria.com/learn/news/ was last seen as relevant, processing it.
2025-06-18 14:07:08 [root] INFO: should_process_url: URL https://dancevictoria.com/ was last seen as not relevant but hit_ratio (0.33) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 14:07:08 [root] INFO: should_process_url: URL https://dancevictoria.com/support/donate/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:07:08 [root] INFO: should_process_url: URL https://dancevictoria.com/season-trailer/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:07:08 [scrapy.extensions.logstats] INFO: Crawled 91 pages (at 7 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 14:07:08 [root] INFO: should_process_url: URL https://bandcamp.com/partner was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:07:08 [root] INFO: should_process_url: URL https://bandcamp.com/settings?from=menubar was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:07:08 [root] INFO: should_process_url: URL https://bandcamp.com/?from=menubar_logo_logged_out was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:07:08 [root] INFO: should_process_url: URL https://bandcamp.com/cart was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:07:08 [root] INFO: should_process_url: URL https://bandcamp.com/login?from=menubar was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:07:08 [root] INFO: should_process_url: URL https://nataliepadilla.bandcamp.com was last seen as relevant, processing it.
2025-06-18 14:07:08 [root] INFO: should_process_url: URL https://get.bandcamp.help was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:07:08 [root] INFO: def parse(): Found keywords for URL https://www.wellnessliving.com/rs/profile.html: ['dance']
2025-06-18 14:07:08 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.wellnessliving.com/rs/profile.html
2025-06-18 14:07:08 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:07:08 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:07:08 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:07:12 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:07:12 [root] INFO: query_llm(): Mistral response received: ```json
[
    {
        "source": "Baza Dance Studios Inc.",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Sign In",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Sign In"
    }
]
```
2025-06-18 14:07:12 [root] INFO: def extract_and_parse_json(): for url https://www.wellnessliving.com/rs/profile.html, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Baza Dance Studios Inc.",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Sign In",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Sign In"
    }
]
2025-06-18 14:07:12 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 14:07:12 [root] INFO: write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 14:07:12 [root] INFO: write_url_to_db(): appended URL 'https://www.wellnessliving.com/rs/profile.html'
2025-06-18 14:07:12 [root] INFO: def process_llm_response: URL https://www.wellnessliving.com/rs/profile.html marked as relevant with events written to the database.
2025-06-18 14:07:12 [root] INFO: write_url_to_db(): appended URL 'https://www.wellnessliving.com/rs/profile.html'
2025-06-18 14:07:12 [root] INFO: def parse(): URL https://www.wellnessliving.com/rs/profile.html marked as relevant (LLM positive).
2025-06-18 14:07:12 [root] INFO: def parse(): Found 7 links on https://www.wellnessliving.com/passport/login-enter.html?url_return=OCnu31BU294rskpjz38nEiLquQI%3Ahttps%3A%2F%2Fwww.wellnessliving.com%2Frs%2Fprofile.html
2025-06-18 14:07:12 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-P8NSG8D, URL: https://www.wellnessliving.com/rs/profile.html, source: Beginner Latin Dance and Fitness Classes in Downtown Vancouver, keywords: zouk
2025-06-18 14:07:12 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 14:07:12 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-P8NSG8D
2025-06-18 14:07:12 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-P8NSG8D'
2025-06-18 14:07:12 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/dialog/oauth?client_id=496623497017932&redirect_uri=https%3A%2F%2Fwww.wellnessliving.com%2Ffacebook%2Flogin.html&scope=email%2Cpublic_profile%2Cuser_birthday%2Cuser_gender%2Cuser_link%2Cuser_location&state=_JAm1NmzJn6QNoo1KEVxtr5kDaU&display=popup'
2025-06-18 14:07:12 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/dialog/oauth?client_id=496623497017932&redirect_uri=https%3A%2F%2Fwww.wellnessliving.com%2Ffacebook%2Flogin.html&scope=email%2Cpublic_profile%2Cuser_birthday%2Cuser_gender%2Cuser_link%2Cuser_location&state=_JAm1NmzJn6QNoo1KEVxtr5kDaU&display=popup
2025-06-18 14:07:12 [root] INFO: should_process_url: URL https://www.wellnessliving.com/knowledge-sharing/terms-of-use/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:07:12 [root] INFO: should_process_url: URL https://www.wellnessliving.com/knowledge-sharing/terms-of-use/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:07:12 [root] INFO: write_url_to_db(): appended URL 'https://www.wellnessliving.com/knowledge-sharing/terms-of-use/'
2025-06-18 14:07:12 [root] INFO: def parse(): Crawling next URL: https://www.wellnessliving.com/knowledge-sharing/terms-of-use/
2025-06-18 14:07:12 [root] INFO: should_process_url: URL https://www.wellnessliving.com/rs/profile.html was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:07:12 [root] INFO: should_process_url: URL https://www.wellnessliving.com/dance/vancouver/baza/review/?id_mode=12 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:07:12 [root] INFO: should_process_url: URL https://www.wellnessliving.com/dance/vancouver/baza/review/?id_mode=12 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:07:12 [root] INFO: write_url_to_db(): appended URL 'https://www.wellnessliving.com/dance/vancouver/baza/review/?id_mode=12'
2025-06-18 14:07:12 [root] INFO: def parse(): Crawling next URL: https://www.wellnessliving.com/dance/vancouver/baza/review/?id_mode=12
2025-06-18 14:07:12 [root] INFO: should_process_url: URL https://www.wellnessliving.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:07:12 [root] INFO: should_process_url: URL https://www.wellnessliving.com/passport/chpwd-begin.html?is_mail=1&url_back=https%3A%2F%2Fwww.wellnessliving.com%2Flogin%2Fbaza&k_business=306611 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:07:12 [root] INFO: should_process_url: URL https://www.wellnessliving.com/passport/chpwd-begin.html?is_mail=1&url_back=https%3A%2F%2Fwww.wellnessliving.com%2Flogin%2Fbaza&k_business=306611 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:07:12 [root] INFO: write_url_to_db(): appended URL 'https://www.wellnessliving.com/passport/chpwd-begin.html?is_mail=1&url_back=https%3A%2F%2Fwww.wellnessliving.com%2Flogin%2Fbaza&k_business=306611'
2025-06-18 14:07:12 [root] INFO: def parse(): Crawling next URL: https://www.wellnessliving.com/passport/chpwd-begin.html?is_mail=1&url_back=https%3A%2F%2Fwww.wellnessliving.com%2Flogin%2Fbaza&k_business=306611
2025-06-18 14:07:12 [root] INFO: should_process_url: URL https://www.wellnessliving.com/signup/baza was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:07:12 [root] INFO: should_process_url: URL https://www.wellnessliving.com/knowledge-sharing/privacy-policy/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:07:12 [root] INFO: should_process_url: URL https://www.wellnessliving.com/knowledge-sharing/privacy-policy/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:07:12 [root] INFO: write_url_to_db(): appended URL 'https://www.wellnessliving.com/knowledge-sharing/privacy-policy/'
2025-06-18 14:07:12 [root] INFO: def parse(): Crawling next URL: https://www.wellnessliving.com/knowledge-sharing/privacy-policy/
2025-06-18 14:07:12 [root] INFO: def parse(): Found keywords for URL https://www.wellnessliving.com/signup/baza: ['dance']
2025-06-18 14:07:12 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.wellnessliving.com/signup/baza
2025-06-18 14:07:12 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:07:12 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:07:12 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:07:19 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:07:19 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 14:07:19 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 14:07:19 [root] INFO: write_url_to_db(): appended URL 'https://www.wellnessliving.com/signup/baza'
2025-06-18 14:07:19 [root] INFO: def parse(): URL https://www.wellnessliving.com/signup/baza marked as irrelevant (LLM negative).
2025-06-18 14:07:19 [root] INFO: def parse(): Found 6 links on https://www.wellnessliving.com/signup/baza
2025-06-18 14:07:19 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-P8NSG8D, URL: https://www.wellnessliving.com/signup/baza, source: Beginner Latin Dance and Fitness Classes in Downtown Vancouver, keywords: zouk
2025-06-18 14:07:19 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 14:07:19 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-P8NSG8D
2025-06-18 14:07:19 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-P8NSG8D'
2025-06-18 14:07:19 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/dialog/oauth?client_id=496623497017932&redirect_uri=https%3A%2F%2Fwww.wellnessliving.com%2Ffacebook%2Flogin.html&scope=email%2Cpublic_profile%2Cuser_birthday%2Cuser_gender%2Cuser_link%2Cuser_location&state=_JAm1NmzJn6QNoo1KEVxtr5kDaU&display=popup'
2025-06-18 14:07:19 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/dialog/oauth?client_id=496623497017932&redirect_uri=https%3A%2F%2Fwww.wellnessliving.com%2Ffacebook%2Flogin.html&scope=email%2Cpublic_profile%2Cuser_birthday%2Cuser_gender%2Cuser_link%2Cuser_location&state=_JAm1NmzJn6QNoo1KEVxtr5kDaU&display=popup
2025-06-18 14:07:19 [root] INFO: should_process_url: URL https://www.wellnessliving.com/knowledge-sharing/terms-of-use/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:07:19 [root] INFO: should_process_url: URL https://www.wellnessliving.com/login/baza was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:07:19 [root] INFO: should_process_url: URL https://www.wellnessliving.com/dance/vancouver/baza/review/?id_mode=12 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:07:19 [root] INFO: should_process_url: URL https://www.wellnessliving.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:07:19 [root] INFO: should_process_url: URL https://www.wellnessliving.com/signup/baza was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:07:19 [root] INFO: should_process_url: URL https://www.wellnessliving.com/knowledge-sharing/privacy-policy/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:07:19 [root] INFO: def parse(): Found keywords for URL https://maps.app.goo.gl/xu9uqzPrPHXQjyQNA: ['argentine tango', 'cha cha', 'dance', 'live music', 'milonga', 'rumba', 'salsa', 'swing', 'tango', 'waltz', 'wcs']
2025-06-18 14:07:19 [root] INFO: def generate_prompt(): Generating prompt for URL: https://maps.app.goo.gl/xu9uqzPrPHXQjyQNA
2025-06-18 14:07:19 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:07:20 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:07:20 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:07:21 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 14:07:21 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 201071 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 14:07:21 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 14:07:34 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:07:34 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 14:07:34 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 14:07:34 [root] INFO: write_url_to_db(): appended URL 'https://maps.app.goo.gl/xu9uqzPrPHXQjyQNA'
2025-06-18 14:07:34 [root] INFO: def parse(): URL https://maps.app.goo.gl/xu9uqzPrPHXQjyQNA marked as irrelevant (LLM negative).
2025-06-18 14:07:34 [root] INFO: def parse(): Found 1 links on https://www.google.com/maps/place/Arthur+Murray+Dance+Studio+%7C+Victoria+Dance+Lessons/@48.4576218,-123.3752954,15z/data=!4m6!3m5!1s0x548f734a509524bf:0xe37b8863316af9b0!8m2!3d48.4576218!4d-123.3752954!16s%2Fg%2F11h18_x85d?entry=tts&g_ep=EgoyMDI0MDUxNC4wKgBIAVAD
2025-06-18 14:07:34 [root] INFO: should_process_url: URL https://maps.app.goo.gl/xu9uqzPrPHXQjyQNA was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:07:34 [root] INFO: parse: Skipping blacklisted URL https://support.google.com/maps/?hl=en&authuser=0&p=no_javascript.
2025-06-18 14:07:34 [root] INFO: def parse(): Found keywords for URL https://nataliepadilla.bandcamp.com: ['bachata', 'dance', 'merengue', 'salsa', 'swing', 'tango']
2025-06-18 14:07:34 [root] INFO: def generate_prompt(): Generating prompt for URL: https://nataliepadilla.bandcamp.com
2025-06-18 14:07:34 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:07:34 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:07:34 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:08:00 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:08:00 [root] INFO: query_llm(): Mistral response received: The webpage's text contains information about several events, including live music performances by Natalie Padilla. Here is the JSON output:

```json
[
    {
        "source": "Natalie Padilla",
        "dance_style": "live music",
        "url": "",
        "event_type": "live streams",
        "event_name": "Natalie Padilla Live Streams",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Natalie Padilla. Williamsburg, Massachusetts. Born into a family of acclaimed roots musicians, Natalie was immersed in music at a very young age. She studies, composes, teaches, records and performs within the traditions of Old-Time, Celtic, Texas and Bluegrass Fiddle music, as well as classical violin."
    }
]
```
2025-06-18 14:08:00 [root] INFO: def extract_and_parse_json(): for url https://nataliepadilla.bandcamp.com, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Natalie Padilla",
        "dance_style": "live music",
        "url": "",
        "event_type": "live streams",
        "event_name": "Natalie Padilla Live Streams",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Natalie Padilla. Williamsburg, Massachusetts. Born into a family of acclaimed roots musicians, Natalie was immersed in music at a very young age. She studies, composes, teaches, records and performs within the traditions of Old-Time, Celtic, Texas and Bluegrass Fiddle music, as well as classical violin."
    }
]
2025-06-18 14:08:00 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 14:08:00 [root] INFO: write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 14:08:00 [root] INFO: write_url_to_db(): appended URL 'https://nataliepadilla.bandcamp.com'
2025-06-18 14:08:00 [root] INFO: def process_llm_response: URL https://nataliepadilla.bandcamp.com marked as relevant with events written to the database.
2025-06-18 14:08:00 [root] INFO: write_url_to_db(): appended URL 'https://nataliepadilla.bandcamp.com'
2025-06-18 14:08:00 [root] INFO: def parse(): URL https://nataliepadilla.bandcamp.com marked as relevant (LLM positive).
2025-06-18 14:08:00 [root] INFO: def parse(): Found 10 links on https://nataliepadilla.bandcamp.com
2025-06-18 14:08:00 [root] INFO: should_process_url: URL https://bandcamp.com/logout was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:08:00 [root] INFO: should_process_url: URL https://bandcamp.com/partner was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:08:00 [root] INFO: should_process_url: URL https://bandcamp.com/settings?from=menubar was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:08:00 [root] INFO: should_process_url: URL https://bandcamp.com/?from=menubar_logo_logged_out was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:08:00 [root] INFO: should_process_url: URL https://bandcamp.com/help/downloading?from=tralbum_downloading was last seen as relevant, processing it.
2025-06-18 14:08:00 [root] INFO: should_process_url: URL https://bandcamp.com/help/downloading?from=tralbum_downloading was last seen as relevant, processing it.
2025-06-18 14:08:00 [root] INFO: write_url_to_db(): appended URL 'https://bandcamp.com/help/downloading?from=tralbum_downloading'
2025-06-18 14:08:00 [root] INFO: def parse(): Crawling next URL: https://bandcamp.com/help/downloading?from=tralbum_downloading
2025-06-18 14:08:00 [root] INFO: should_process_url: URL https://bandcamp.com/login?from=menubar was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:08:00 [root] INFO: should_process_url: URL https://nataliepadilla.bandcamp.com was last seen as relevant, processing it.
2025-06-18 14:08:00 [root] INFO: should_process_url: URL https://bandcamp.com/cart was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:08:00 [root] INFO: should_process_url: URL https://get.bandcamp.help was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:08:00 [root] INFO: should_process_url: URL https://f4.bcbits.com/img/0031875133_10.jpg was last seen as relevant, processing it.
2025-06-18 14:08:00 [root] INFO: should_process_url: URL https://f4.bcbits.com/img/0031875133_10.jpg was last seen as relevant, processing it.
2025-06-18 14:08:00 [root] INFO: write_url_to_db(): appended URL 'https://f4.bcbits.com/img/0031875133_10.jpg'
2025-06-18 14:08:00 [root] INFO: def parse(): Crawling next URL: https://f4.bcbits.com/img/0031875133_10.jpg
2025-06-18 14:08:00 [root] INFO: write_url_to_db(): appended URL 'https://bandcamp.com/login?from=menubar'
2025-06-18 14:08:00 [root] INFO: def parse(): URL https://bandcamp.com/login?from=menubar marked as irrelevant (no keywords).
2025-06-18 14:08:00 [root] INFO: def parse(): Found 1 links on https://bandcamp.com/login?from=menubar
2025-06-18 14:08:00 [root] INFO: should_process_url: URL https://bandcamp.com was last seen as relevant, processing it.
2025-06-18 14:08:00 [root] INFO: should_process_url: URL https://bandcamp.com was last seen as relevant, processing it.
2025-06-18 14:08:00 [root] INFO: write_url_to_db(): appended URL 'https://bandcamp.com'
2025-06-18 14:08:00 [root] INFO: def parse(): Crawling next URL: https://bandcamp.com
2025-06-18 14:08:00 [root] INFO: should_process_url: URL https://bandcamp.com/login?from=menubar was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:08:00 [root] INFO: def parse(): Found keywords for URL https://www.wellnessliving.com/catalog/baza: ['bachata', 'dance', 'salsa', 'zouk']
2025-06-18 14:08:00 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.wellnessliving.com/catalog/baza
2025-06-18 14:08:00 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:08:00 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:08:00 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:09:15 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:09:15 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "Baza Dance Studios Inc.",
        "dance_style": "salsa",
        "url": "",
        "event_type": "class",
        "event_name": "Mon Salsa Caleña (Cali style Salsa) Course starts Jul 7",
        "day_of_week": "Monday",
        "start_date": "2025-07-07",
        "end_date": "2025-08-25",
        "start_time": "",
        "end_time": "",
        "price": "$162.00",
        "location": "",
        "description": "Mon Salsa Caleña (Cali style Salsa) Course starts Jul 7."
    },
    {
        "source": "Baza Dance Studios Inc.",
        "dance_style": "salsa",
        "url": "",
        "event_type": "class",
        "event_name": "Mon Salsa Fundamentals (Lvl 2) 7-week Course starts Jul 7",
        "day_of_week": "Monday",
        "start_date": "2025-07-07",
        "end_date": "2025-08-25",
        "start_time": "",
        "end_time": "",
        "price": "$162.00",
        "location": "",
        "description": "Mon Salsa Fundamentals (Lvl 2) 7-week Course starts Jul 7."
    },
    {
        "source": "Baza Dance Studios Inc.",
        "dance_style": "salsa",
        "url": "",
        "event_type": "class",
        "event_name": "Mon Salsa Intro (Lvl 1) 7-week Course at 6:15pm starts Jul 7",
        "day_of_week": "Monday",
        "start_date": "2025-07-07",
        "end_date": "2025-08-25",
        "start_time": "",
        "end_time": "",
        "price": "$162.00",
        "location": "",
        "description": "Mon Salsa Intro (Lvl 1) 7-week Course at 6:15pm starts Jul 7."
    },
    {
        "source": "Baza Dance Studios Inc.",
        "dance_style": "zouk",
        "url": "",
        "event_type": "class",
        "event_name": "Mon Brazilian Zouk Intro (Lvl 1) 6-week Course starts Jul 7",
        "day_of_week": "Monday",
        "start_date": "2025-07-07",
        "end_date": "2025-08-18",
        "start_time": "",
        "end_time": "",
        "price": "$140.00",
        "location": "",
        "description": "Mon Brazilian Zouk Intro (Lvl 1) 6-week Course starts Jul 7."
    },
    {
        "source": "Baza Dance Studios Inc.",
        "dance_style": "salsa",
        "url": "",
        "event_type": "class",
        "event_name": "Sat Salsa Intro (Lvl 1) 5-week CONDENSED Course at 10:45a...",
        "day_of_week": "Saturday",
        "start_date": "2025-07-12",
        "end_date": "2025-08-16",
        "start_time": "",
        "end_time": "",
        "price": "$185.00",
        "location": "",
        "description": "Sat Salsa Intro (Lvl 1) 5-week CONDENSED Course at 10:45a..."
    },
    {
        "source": "Baza Dance Studios Inc.",
        "dance_style": "salsa",
        "url": "",
        "event_type": "class",
        "event_name": "Sat Salsa Fundamentals (Lvl 2) 5-week CONDENSED Course at...",
        "day_of_week": "Saturday",
        "start_date": "2025-07-12",
        "end_date": "2025-08-16",
        "start_time": "",
        "end_time": "",
        "price": "$185.00",
        "location": "",
        "description": "Sat Salsa Fundamentals (Lvl 2) 5-week CONDENSED Course at..."
    },
    {
        "source": "Baza Dance Studios Inc.",
        "dance_style": "bachata",
        "url": "",
        "event_type": "class",
        "event_name": "Baza Kids Summer Dance Camp - Enchanted Forest Adventures",
        "day_of_week": "Monday",
        "start_date": "2025-07-21",
        "end_date": "2025-07-24",
        "start_time": "",
        "end_time": "",
        "price": "$120.00",
        "location": "",
        "description": "Baza Kids Summer Dance Camp - Enchanted Forest Adventures."
    },
    {
        "source": "Baza Dance Studios Inc.",
        "dance_style": "bachata",
        "url": "",
        "event_type": "class",
        "event_name": "Baza Kids Summer Dance Camp - Puppy Parade",
        "day_of_week": "Monday",
        "start_date": "2025-07-28",
        "end_date": "2025-07-31",
        "start_time": "",
        "end_time": "",
        "price": "$120.00",
        "location": "",
        "description": "Baza Kids Summer Dance Camp - Puppy Parade."
    },
    {
        "source": "Baza Dance Studios Inc.",
        "dance_style": "bachata",
        "url": "",
        "event_type": "class",
        "event_name": "Baza Hip Hop Kids Summer Dance Camp - week 1",
        "day_of_week": "Monday",
        "start_date": "2025-07-21",
        "end_date": "2025-07-24",
        "start_time": "",
        "end_time": "",
        "price": "$120.00",
        "location": "",
        "description": "Baza Hip Hop Kids Summer Dance Camp - week 1."
    },
    {
        "source": "Baza Dance Studios Inc.",
        "dance_style": "bachata",
        "url": "",
        "event_type": "class",
        "event_name": "Baza Hip Hop Kids Summer Dance Camp - week 2",
        "day_of_week": "Monday",
        "start_date": "2025-07-28",
        "end_date": "2025-07-31",
        "start_time": "",
        "end_time": "",
        "price": "$120.00",
        "location": "",
        "description": "Baza Hip Hop Kids Summer Dance Camp - week 2."
    }
]
2025-06-18 14:09:15 [root] INFO: def extract_and_parse_json(): for url https://www.wellnessliving.com/catalog/baza, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Baza Dance Studios Inc.",
        "dance_style": "salsa",
        "url": "",
        "event_type": "class",
        "event_name": "Mon Salsa Caleña (Cali style Salsa) Course starts Jul 7",
        "day_of_week": "Monday",
        "start_date": "2025-07-07",
        "end_date": "2025-08-25",
        "start_time": "",
        "end_time": "",
        "price": "$162.00",
        "location": "",
        "description": "Mon Salsa Caleña (Cali style Salsa) Course starts Jul 7."
    },
    {
        "source": "Baza Dance Studios Inc.",
        "dance_style": "salsa",
        "url": "",
        "event_type": "class",
        "event_name": "Mon Salsa Fundamentals (Lvl 2) 7-week Course starts Jul 7",
        "day_of_week": "Monday",
        "start_date": "2025-07-07",
        "end_date": "2025-08-25",
        "start_time": "",
        "end_time": "",
        "price": "$162.00",
        "location": "",
        "description": "Mon Salsa Fundamentals (Lvl 2) 7-week Course starts Jul 7."
    },
    {
        "source": "Baza Dance Studios Inc.",
        "dance_style": "salsa",
        "url": "",
        "event_type": "class",
        "event_name": "Mon Salsa Intro (Lvl 1) 7-week Course at 6:15pm starts Jul 7",
        "day_of_week": "Monday",
        "start_date": "2025-07-07",
        "end_date": "2025-08-25",
        "start_time": "",
        "end_time": "",
        "price": "$162.00",
        "location": "",
        "description": "Mon Salsa Intro (Lvl 1) 7-week Course at 6:15pm starts Jul 7."
    },
    {
        "source": "Baza Dance Studios Inc.",
        "dance_style": "zouk",
        "url": "",
        "event_type": "class",
        "event_name": "Mon Brazilian Zouk Intro (Lvl 1) 6-week Course starts Jul 7",
        "day_of_week": "Monday",
        "start_date": "2025-07-07",
        "end_date": "2025-08-18",
        "start_time": "",
        "end_time": "",
        "price": "$140.00",
        "location": "",
        "description": "Mon Brazilian Zouk Intro (Lvl 1) 6-week Course starts Jul 7."
    },
    {
        "source": "Baza Dance Studios Inc.",
        "dance_style": "salsa",
        "url": "",
        "event_type": "class",
        "event_name": "Sat Salsa Intro (Lvl 1) 5-week CONDENSED Course at 10:45a",
        "day_of_week": "Saturday",
        "start_date": "2025-07-12",
        "end_date": "2025-08-16",
        "start_time": "",
        "end_time": "",
        "price": "$185.00",
        "location": "",
        "description": "Sat Salsa Intro (Lvl 1) 5-week CONDENSED Course at 10:45a"
    },
    {
        "source": "Baza Dance Studios Inc.",
        "dance_style": "salsa",
        "url": "",
        "event_type": "class",
        "event_name": "Sat Salsa Fundamentals (Lvl 2) 5-week CONDENSED Course at",
        "day_of_week": "Saturday",
        "start_date": "2025-07-12",
        "end_date": "2025-08-16",
        "start_time": "",
        "end_time": "",
        "price": "$185.00",
        "location": "",
        "description": "Sat Salsa Fundamentals (Lvl 2) 5-week CONDENSED Course at"
    },
    {
        "source": "Baza Dance Studios Inc.",
        "dance_style": "bachata",
        "url": "",
        "event_type": "class",
        "event_name": "Baza Kids Summer Dance Camp - Enchanted Forest Adventures",
        "day_of_week": "Monday",
        "start_date": "2025-07-21",
        "end_date": "2025-07-24",
        "start_time": "",
        "end_time": "",
        "price": "$120.00",
        "location": "",
        "description": "Baza Kids Summer Dance Camp - Enchanted Forest Adventures."
    },
    {
        "source": "Baza Dance Studios Inc.",
        "dance_style": "bachata",
        "url": "",
        "event_type": "class",
        "event_name": "Baza Kids Summer Dance Camp - Puppy Parade",
        "day_of_week": "Monday",
        "start_date": "2025-07-28",
        "end_date": "2025-07-31",
        "start_time": "",
        "end_time": "",
        "price": "$120.00",
        "location": "",
        "description": "Baza Kids Summer Dance Camp - Puppy Parade."
    },
    {
        "source": "Baza Dance Studios Inc.",
        "dance_style": "bachata",
        "url": "",
        "event_type": "class",
        "event_name": "Baza Hip Hop Kids Summer Dance Camp - week 1",
        "day_of_week": "Monday",
        "start_date": "2025-07-21",
        "end_date": "2025-07-24",
        "start_time": "",
        "end_time": "",
        "price": "$120.00",
        "location": "",
        "description": "Baza Hip Hop Kids Summer Dance Camp - week 1."
    },
    {
        "source": "Baza Dance Studios Inc.",
        "dance_style": "bachata",
        "url": "",
        "event_type": "class",
        "event_name": "Baza Hip Hop Kids Summer Dance Camp - week 2",
        "day_of_week": "Monday",
        "start_date": "2025-07-28",
        "end_date": "2025-07-31",
        "start_time": "",
        "end_time": "",
        "price": "$120.00",
        "location": "",
        "description": "Baza Hip Hop Kids Summer Dance Camp - week 2."
    }
]
2025-06-18 14:09:15 [root] INFO: def clean_up_address(): Starting with events_df shape: (10, 14)
2025-06-18 14:09:15 [root] INFO: write_events_to_db: Number of events to write: 10
2025-06-18 14:09:15 [root] INFO: write_url_to_db(): appended URL 'https://www.wellnessliving.com/catalog/baza'
2025-06-18 14:09:15 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 14:09:15 [root] INFO: def process_llm_response: URL https://www.wellnessliving.com/catalog/baza marked as relevant with events written to the database.
2025-06-18 14:09:15 [root] INFO: write_url_to_db(): appended URL 'https://www.wellnessliving.com/catalog/baza'
2025-06-18 14:09:15 [root] INFO: def parse(): URL https://www.wellnessliving.com/catalog/baza marked as relevant (LLM positive).
2025-06-18 14:09:15 [root] INFO: def parse(): Found 10 links on https://www.wellnessliving.com/catalog/baza
2025-06-18 14:09:15 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-P8NSG8D, URL: https://www.wellnessliving.com/catalog/baza, source: Beginner Latin Dance and Fitness Classes in Downtown Vancouver, keywords: zouk
2025-06-18 14:09:15 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 14:09:15 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-P8NSG8D
2025-06-18 14:09:15 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-P8NSG8D'
2025-06-18 14:09:15 [root] INFO: should_process_url: URL https://www.wellnessliving.com/rs/profile.html was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:09:15 [root] INFO: should_process_url: URL https://www.wellnessliving.com/login/baza was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:09:15 [root] INFO: should_process_url: URL https://www.wellnessliving.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:09:15 [root] INFO: should_process_url: URL https://www.wellnessliving.com/catalog/baza was last seen as relevant, processing it.
2025-06-18 14:09:15 [root] INFO: should_process_url: URL https://www.wellnessliving.com/signup/baza was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:09:15 [root] INFO: should_process_url: URL https://www.wellnessliving.com/rs/report-page.html?sid_report_page=profile-attendance-schedule was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:09:15 [root] INFO: should_process_url: URL https://www.wellnessliving.com/rs/reward-board.html was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:09:15 [root] INFO: should_process_url: URL https://www.wellnessliving.com/schedule/baza was last seen as relevant, processing it.
2025-06-18 14:09:15 [root] INFO: def parse(): Found keywords for URL https://www.wellnessliving.com/rs/reward-board.html: ['dance']
2025-06-18 14:09:15 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.wellnessliving.com/rs/reward-board.html
2025-06-18 14:09:15 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:09:15 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:09:15 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:09:25 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:09:25 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 14:09:25 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 14:09:25 [root] INFO: write_url_to_db(): appended URL 'https://www.wellnessliving.com/rs/reward-board.html'
2025-06-18 14:09:25 [root] INFO: def parse(): URL https://www.wellnessliving.com/rs/reward-board.html marked as irrelevant (LLM negative).
2025-06-18 14:09:25 [root] INFO: def parse(): Found 10 links on https://www.wellnessliving.com/rs/reward-board.html
2025-06-18 14:09:25 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-P8NSG8D, URL: https://www.wellnessliving.com/rs/reward-board.html, source: Beginner Latin Dance and Fitness Classes in Downtown Vancouver, keywords: zouk
2025-06-18 14:09:25 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 14:09:25 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-P8NSG8D
2025-06-18 14:09:25 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-P8NSG8D'
2025-06-18 14:09:25 [root] INFO: should_process_url: URL https://www.wellnessliving.com/rs/profile.html was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:09:25 [root] INFO: should_process_url: URL https://www.wellnessliving.com/login/baza was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:09:25 [root] INFO: should_process_url: URL https://www.wellnessliving.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:09:25 [root] INFO: should_process_url: URL https://www.wellnessliving.com/catalog/baza was last seen as relevant, processing it.
2025-06-18 14:09:25 [root] INFO: should_process_url: URL https://www.wellnessliving.com/signup/baza was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:09:25 [root] INFO: should_process_url: URL https://www.wellnessliving.com/rs/report-page.html?sid_report_page=profile-attendance-schedule was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:09:25 [root] INFO: should_process_url: URL https://www.wellnessliving.com/rs/reward-board.html was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:09:25 [root] INFO: should_process_url: URL https://www.wellnessliving.com/schedule/baza was last seen as relevant, processing it.
2025-06-18 14:09:25 [scrapy.extensions.logstats] INFO: Crawled 98 pages (at 7 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 14:09:25 [root] INFO: def parse(): Found keywords for URL https://dancevictoria.com/learn/contact/: ['dance']
2025-06-18 14:09:25 [root] INFO: def generate_prompt(): Generating prompt for URL: https://dancevictoria.com/learn/contact/
2025-06-18 14:09:25 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:09:25 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:09:25 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:09:32 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:09:32 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 14:09:32 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 14:09:32 [root] INFO: write_url_to_db(): appended URL 'https://dancevictoria.com/learn/contact/'
2025-06-18 14:09:32 [root] INFO: def parse(): URL https://dancevictoria.com/learn/contact/ marked as irrelevant (LLM negative).
2025-06-18 14:09:32 [root] INFO: def parse(): Found 10 links on https://dancevictoria.com/learn/contact/
2025-06-18 14:09:32 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-TKPSD4XK, URL: https://dancevictoria.com/learn/contact/, source: Dance Victoria brings the World's Best Dance to Victoria Canada, keywords: dance
2025-06-18 14:09:32 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 14:09:32 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-TKPSD4XK
2025-06-18 14:09:32 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-TKPSD4XK'
2025-06-18 14:09:32 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/DanceVictoria/'
2025-06-18 14:09:32 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/DanceVictoria/
2025-06-18 14:09:32 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/dance_victoria/'
2025-06-18 14:09:32 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/dance_victoria/
2025-06-18 14:09:32 [root] INFO: should_process_url: URL https://dancevictoria.com/learn/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:09:32 [root] INFO: should_process_url: URL https://dancevictoria.com/performances/tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:09:32 [root] INFO: should_process_url: URL https://vimeo.com/dancevictoria was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:09:32 [root] INFO: should_process_url: URL https://dancevictoria.com/calendar/ was last seen as relevant, processing it.
2025-06-18 14:09:32 [root] INFO: should_process_url: URL https://dancevictoria.com/learn/news/ was last seen as relevant, processing it.
2025-06-18 14:09:32 [root] INFO: should_process_url: URL https://dancevictoria.com/ was last seen as not relevant but hit_ratio (0.33) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 14:09:32 [root] INFO: should_process_url: URL https://dancevictoria.com/support/donate/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:09:32 [root] INFO: should_process_url: URL https://dancevictoria.com/season-trailer/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:09:32 [root] INFO: def parse(): Found keywords for URL https://dancevictoria.com/performances/tickets/: ['dance']
2025-06-18 14:09:32 [root] INFO: def generate_prompt(): Generating prompt for URL: https://dancevictoria.com/performances/tickets/
2025-06-18 14:09:32 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:09:32 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:09:32 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:10:49 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:10:49 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "Dance Victoria",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "2025/26 Single performance ticket options:",
        "day_of_week": "",
        "start_date": "2025-09-02",
        "end_date": "2025-09-02",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Royal Theatre, 805 Broughton Street, Victoria, BC V8W 1E5",
        "description": "Single tickets for subscription season performances"
    }
]
2025-06-18 14:10:49 [root] INFO: def extract_and_parse_json(): for url https://dancevictoria.com/performances/tickets/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Dance Victoria",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "2025/26 Single performance ticket options:",
        "day_of_week": "",
        "start_date": "2025-09-02",
        "end_date": "2025-09-02",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Royal Theatre, 805 Broughton Street, Victoria, BC V8W 1E5",
        "description": "Single tickets for subscription season performances"
    }
]
2025-06-18 14:10:49 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 14:10:49 [root] INFO: def clean_up_address(): Processing location 'Royal Theatre, 805 Broughton Street, Victoria, BC V8W 1E5' (event_id: None)
2025-06-18 14:10:49 [root] INFO: def clean_up_address(): Updated event None with address_id 3446 using DB match
2025-06-18 14:10:49 [root] INFO: write_events_to_db: Number of events to write: 1
2025-06-18 14:10:49 [root] INFO: write_url_to_db(): appended URL 'https://dancevictoria.com/performances/tickets/'
2025-06-18 14:10:49 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 14:10:49 [root] INFO: def process_llm_response: URL https://dancevictoria.com/performances/tickets/ marked as relevant with events written to the database.
2025-06-18 14:10:49 [root] INFO: write_url_to_db(): appended URL 'https://dancevictoria.com/performances/tickets/'
2025-06-18 14:10:49 [root] INFO: def parse(): URL https://dancevictoria.com/performances/tickets/ marked as relevant (LLM positive).
2025-06-18 14:10:49 [root] INFO: def parse(): Found 10 links on https://dancevictoria.com/performances/tickets/
2025-06-18 14:10:49 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-TKPSD4XK, URL: https://dancevictoria.com/performances/tickets/, source: Performances - Dance Victoria, keywords: dance
2025-06-18 14:10:49 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 14:10:49 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-TKPSD4XK
2025-06-18 14:10:49 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-TKPSD4XK'
2025-06-18 14:10:49 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/DanceVictoria/'
2025-06-18 14:10:49 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/DanceVictoria/
2025-06-18 14:10:49 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/dance_victoria/'
2025-06-18 14:10:49 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/dance_victoria/
2025-06-18 14:10:49 [root] INFO: should_process_url: URL https://dancevictoria.com/learn/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:10:49 [root] INFO: should_process_url: URL https://dancevictoria.com/performances/tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:10:49 [root] INFO: should_process_url: URL https://vimeo.com/dancevictoria was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:10:49 [root] INFO: should_process_url: URL https://dancevictoria.com/calendar/ was last seen as relevant, processing it.
2025-06-18 14:10:49 [root] INFO: should_process_url: URL https://dancevictoria.com/learn/news/ was last seen as relevant, processing it.
2025-06-18 14:10:49 [root] INFO: should_process_url: URL https://dancevictoria.com/ was last seen as not relevant but hit_ratio (0.33) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 14:10:49 [root] INFO: should_process_url: URL https://dancevictoria.com/support/donate/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:10:49 [root] INFO: should_process_url: URL https://dancevictoria.com/season-trailer/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:10:49 [root] INFO: def parse(): Found keywords for URL https://www.wellnessliving.com/rs/report-page.html?sid_report_page=profile-attendance-schedule: ['dance']
2025-06-18 14:10:49 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.wellnessliving.com/rs/report-page.html?sid_report_page=profile-attendance-schedule
2025-06-18 14:10:49 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:10:49 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:10:49 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:10:53 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:10:53 [root] INFO: query_llm(): Mistral response received: ```json
[
    {
        "source": "Baza Dance Studios Inc.",
        "dance_style": "",
        "url": "",
        "event_type": "",
        "event_name": "",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Baza Dance Studios Inc.",
        "description": ""
    }
]
```
2025-06-18 14:10:53 [root] INFO: def extract_and_parse_json(): for url https://www.wellnessliving.com/rs/report-page.html?sid_report_page=profile-attendance-schedule, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Baza Dance Studios Inc.",
        "dance_style": "",
        "url": "",
        "event_type": "",
        "event_name": "",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Baza Dance Studios Inc.",
        "description": ""
    }
]
2025-06-18 14:10:53 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 14:10:53 [root] INFO: def clean_up_address(): Processing location 'Baza Dance Studios Inc.' (event_id: None)
2025-06-18 14:10:53 [root] INFO: write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 14:10:53 [root] INFO: write_url_to_db(): appended URL 'https://www.wellnessliving.com/rs/report-page.html?sid_report_page=profile-attendance-schedule'
2025-06-18 14:10:53 [root] INFO: def process_llm_response: URL https://www.wellnessliving.com/rs/report-page.html?sid_report_page=profile-attendance-schedule marked as relevant with events written to the database.
2025-06-18 14:10:53 [root] INFO: write_url_to_db(): appended URL 'https://www.wellnessliving.com/rs/report-page.html?sid_report_page=profile-attendance-schedule'
2025-06-18 14:10:53 [root] INFO: def parse(): URL https://www.wellnessliving.com/rs/report-page.html?sid_report_page=profile-attendance-schedule marked as relevant (LLM positive).
2025-06-18 14:10:53 [root] INFO: def parse(): Found 7 links on https://www.wellnessliving.com/passport/login-enter.html?url_return=puOVQRoX2Czzx1zLW-gjgZN01NM%3Ahttps%3A%2F%2Fwww.wellnessliving.com%2Frs%2Freport-page.html%3Fsid_report_page%3Dprofile-attendance-schedule
2025-06-18 14:10:53 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-P8NSG8D, URL: https://www.wellnessliving.com/rs/report-page.html?sid_report_page=profile-attendance-schedule, source: Beginner Latin Dance and Fitness Classes in Downtown Vancouver, keywords: zouk
2025-06-18 14:10:53 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 14:10:53 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-P8NSG8D
2025-06-18 14:10:53 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-P8NSG8D'
2025-06-18 14:10:53 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/dialog/oauth?client_id=496623497017932&redirect_uri=https%3A%2F%2Fwww.wellnessliving.com%2Ffacebook%2Flogin.html&scope=email%2Cpublic_profile%2Cuser_birthday%2Cuser_gender%2Cuser_link%2Cuser_location&state=_JAm1NmzJn6QNoo1KEVxtr5kDaU&display=popup'
2025-06-18 14:10:53 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/dialog/oauth?client_id=496623497017932&redirect_uri=https%3A%2F%2Fwww.wellnessliving.com%2Ffacebook%2Flogin.html&scope=email%2Cpublic_profile%2Cuser_birthday%2Cuser_gender%2Cuser_link%2Cuser_location&state=_JAm1NmzJn6QNoo1KEVxtr5kDaU&display=popup
2025-06-18 14:10:54 [root] INFO: should_process_url: URL https://www.wellnessliving.com/knowledge-sharing/terms-of-use/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:10:54 [root] INFO: should_process_url: URL https://www.wellnessliving.com/dance/vancouver/baza/review/?id_mode=12 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:10:54 [root] INFO: should_process_url: URL https://www.wellnessliving.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:10:54 [root] INFO: should_process_url: URL https://www.wellnessliving.com/passport/chpwd-begin.html?is_mail=1&url_back=https%3A%2F%2Fwww.wellnessliving.com%2Flogin%2Fbaza&k_business=306611 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:10:54 [root] INFO: should_process_url: URL https://www.wellnessliving.com/signup/baza was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:10:54 [root] INFO: should_process_url: URL https://www.wellnessliving.com/rs/report-page.html?sid_report_page=profile-attendance-schedule was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:10:54 [root] INFO: should_process_url: URL https://www.wellnessliving.com/knowledge-sharing/privacy-policy/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:10:54 [root] INFO: def parse(): Found keywords for URL https://www.wellnessliving.com/login/baza: ['dance']
2025-06-18 14:10:54 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.wellnessliving.com/login/baza
2025-06-18 14:10:54 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:10:54 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:10:54 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:10:57 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:10:57 [root] INFO: query_llm(): Mistral response received: ```json
[
    {
        "source": "Baza Dance Studios Inc.",
        "dance_style": "",
        "url": "",
        "event_type": "",
        "event_name": "",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": ""
    }
]
```
2025-06-18 14:10:57 [root] INFO: def extract_and_parse_json(): for url https://www.wellnessliving.com/login/baza, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Baza Dance Studios Inc.",
        "dance_style": "",
        "url": "",
        "event_type": "",
        "event_name": "",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": ""
    }
]
2025-06-18 14:10:57 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 14:10:57 [root] INFO: write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 14:10:57 [root] INFO: write_url_to_db(): appended URL 'https://www.wellnessliving.com/login/baza'
2025-06-18 14:10:57 [root] INFO: def process_llm_response: URL https://www.wellnessliving.com/login/baza marked as relevant with events written to the database.
2025-06-18 14:10:57 [root] INFO: write_url_to_db(): appended URL 'https://www.wellnessliving.com/login/baza'
2025-06-18 14:10:57 [root] INFO: def parse(): URL https://www.wellnessliving.com/login/baza marked as relevant (LLM positive).
2025-06-18 14:10:57 [root] INFO: def parse(): Found 7 links on https://www.wellnessliving.com/login/baza
2025-06-18 14:10:57 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-P8NSG8D, URL: https://www.wellnessliving.com/login/baza, source: Beginner Latin Dance and Fitness Classes in Downtown Vancouver, keywords: zouk
2025-06-18 14:10:57 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 14:10:57 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-P8NSG8D
2025-06-18 14:10:57 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-P8NSG8D'
2025-06-18 14:10:57 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/dialog/oauth?client_id=496623497017932&redirect_uri=https%3A%2F%2Fwww.wellnessliving.com%2Ffacebook%2Flogin.html&scope=email%2Cpublic_profile%2Cuser_birthday%2Cuser_gender%2Cuser_link%2Cuser_location&state=_JAm1NmzJn6QNoo1KEVxtr5kDaU&display=popup'
2025-06-18 14:10:57 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/dialog/oauth?client_id=496623497017932&redirect_uri=https%3A%2F%2Fwww.wellnessliving.com%2Ffacebook%2Flogin.html&scope=email%2Cpublic_profile%2Cuser_birthday%2Cuser_gender%2Cuser_link%2Cuser_location&state=_JAm1NmzJn6QNoo1KEVxtr5kDaU&display=popup
2025-06-18 14:10:57 [root] INFO: should_process_url: URL https://www.wellnessliving.com/knowledge-sharing/terms-of-use/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:10:57 [root] INFO: should_process_url: URL https://www.wellnessliving.com/login/baza was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:10:57 [root] INFO: should_process_url: URL https://www.wellnessliving.com/dance/vancouver/baza/review/?id_mode=12 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:10:57 [root] INFO: should_process_url: URL https://www.wellnessliving.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:10:57 [root] INFO: should_process_url: URL https://www.wellnessliving.com/passport/chpwd-begin.html?is_mail=1&url_back=https%3A%2F%2Fwww.wellnessliving.com%2Flogin%2Fbaza&k_business=306611 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:10:57 [root] INFO: should_process_url: URL https://www.wellnessliving.com/signup/baza was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:10:57 [root] INFO: should_process_url: URL https://www.wellnessliving.com/knowledge-sharing/privacy-policy/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:10:57 [root] INFO: def parse(): Found keywords for URL https://calientedance.com/event/roadtrip-to-kelowna/: ['bachata', 'dance', 'salsa']
2025-06-18 14:10:57 [root] INFO: def generate_prompt(): Generating prompt for URL: https://calientedance.com/event/roadtrip-to-kelowna/
2025-06-18 14:10:57 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:10:57 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:10:57 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:11:13 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:11:13 [root] INFO: query_llm(): Mistral response received: [
  {
    "source": "https://calientedance.com/event/roadtrip-to-kelowna/",
    "dance_style": "salsa, bachata, latin",
    "url": "",
    "event_type": "workshop",
    "event_name": "Salsa Workshop by Salsa Caliente",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "14:00",
    "end_time": null,
    "price": "",
    "location": "Kelowna, BC",
    "description": "Salsa Workshop by Salsa Caliente"
  },
  {
    "source": "https://calientedance.com/event/roadtrip-to-kelowna/",
    "dance_style": "salsa, bachata, latin",
    "url": "",
    "event_type": "workshop",
    "event_name": "Bachata Workshop by Salsa Caliente",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "15:30",
    "end_time": null,
    "price": "",
    "location": "Kelowna, BC",
    "description": "Bachata Workshop by Salsa Caliente"
  },
  {
    "source": "https://calientedance.com/event/roadtrip-to-kelowna/",
    "dance_style": "salsa, bachata, latin",
    "url": "",
    "event_type": "social dance",
    "event_name": "Social dancing & performances at KSBK Show & Shine",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "",
    "end_time": null,
    "price": "",
    "location": "Kelowna, BC",
    "description": "Social dancing & performances at KSBK Show & Shine"
  },
  {
    "source": "https://calientedance.com/event/roadtrip-to-kelowna/",
    "dance_style": "salsa, bachata, latin",
    "url": "",
    "event_type": "workshop",
    "event_name": "Latin percussion workshop",
    "day_of_week": "Sunday",
    "start_date": "2025-06-22",
    "end_date": "2025-06-22",
    "start_time": "",
    "end_time": null,
    "price": "",
    "location": "Kelowna, BC",
    "description": "Latin percussion workshop"
  },
  {
    "source": "https://calientedance.com/event/roadtrip-to-kelowna/",
    "dance_style": "salsa, bachata, latin",
    "url": "",
    "event_type": "social dance",
    "event_name": "Social dancing at La Noche Pa’ Gozar @ Dance Vancouver",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-20",
    "start_time": "",
    "end_time": null,
    "price": "",
    "location": "Vancouver, BC",
    "description": "Social dancing at La Noche Pa’ Gozar @ Dance Vancouver"
  },
  {
    "source": "https://calientedance.com/event/roadtrip-to-kelowna/",
    "dance_style": "salsa, bachata, latin",
    "url": "",
    "event_type": "social dance",
    "event_name": "After party at Havana Fridays",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-20",
    "start_time": "",
    "end_time": null,
    "price": "",
    "location": "Vancouver, BC",
    "description": "After party at Havana Fridays"
  }
]
2025-06-18 14:11:13 [root] INFO: def extract_and_parse_json(): for url https://calientedance.com/event/roadtrip-to-kelowna/, 
Cleaned JSON ready for parsing:
[
  {
    "source": "https://calientedance.com/event/roadtrip-to-kelowna/",
    "dance_style": "salsa, bachata, latin",
    "url": "",
    "event_type": "workshop",
    "event_name": "Salsa Workshop by Salsa Caliente",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "14:00",
    "end_time": null,
    "price": "",
    "location": "Kelowna, BC",
    "description": "Salsa Workshop by Salsa Caliente"
  },
  {
    "source": "https://calientedance.com/event/roadtrip-to-kelowna/",
    "dance_style": "salsa, bachata, latin",
    "url": "",
    "event_type": "workshop",
    "event_name": "Bachata Workshop by Salsa Caliente",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "15:30",
    "end_time": null,
    "price": "",
    "location": "Kelowna, BC",
    "description": "Bachata Workshop by Salsa Caliente"
  },
  {
    "source": "https://calientedance.com/event/roadtrip-to-kelowna/",
    "dance_style": "salsa, bachata, latin",
    "url": "",
    "event_type": "social dance",
    "event_name": "Social dancing & performances at KSBK Show & Shine",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "",
    "end_time": null,
    "price": "",
    "location": "Kelowna, BC",
    "description": "Social dancing & performances at KSBK Show & Shine"
  },
  {
    "source": "https://calientedance.com/event/roadtrip-to-kelowna/",
    "dance_style": "salsa, bachata, latin",
    "url": "",
    "event_type": "workshop",
    "event_name": "Latin percussion workshop",
    "day_of_week": "Sunday",
    "start_date": "2025-06-22",
    "end_date": "2025-06-22",
    "start_time": "",
    "end_time": null,
    "price": "",
    "location": "Kelowna, BC",
    "description": "Latin percussion workshop"
  },
  {
    "source": "https://calientedance.com/event/roadtrip-to-kelowna/",
    "dance_style": "salsa, bachata, latin",
    "url": "",
    "event_type": "social dance",
    "event_name": "Social dancing at La Noche Pa’ Gozar @ Dance Vancouver",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-20",
    "start_time": "",
    "end_time": null,
    "price": "",
    "location": "Vancouver, BC",
    "description": "Social dancing at La Noche Pa’ Gozar @ Dance Vancouver"
  },
  {
    "source": "https://calientedance.com/event/roadtrip-to-kelowna/",
    "dance_style": "salsa, bachata, latin",
    "url": "",
    "event_type": "social dance",
    "event_name": "After party at Havana Fridays",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-20",
    "start_time": "",
    "end_time": null,
    "price": "",
    "location": "Vancouver, BC",
    "description": "After party at Havana Fridays"
  }
]
2025-06-18 14:11:13 [root] INFO: def clean_up_address(): Starting with events_df shape: (6, 14)
2025-06-18 14:11:13 [root] INFO: def clean_up_address(): Processing location 'Kelowna, BC' (event_id: None)
2025-06-18 14:11:13 [root] INFO: def clean_up_address(): Processing location 'Kelowna, BC' (event_id: None)
2025-06-18 14:11:13 [root] INFO: def clean_up_address(): Processing location 'Kelowna, BC' (event_id: None)
2025-06-18 14:11:13 [root] INFO: def clean_up_address(): Processing location 'Kelowna, BC' (event_id: None)
2025-06-18 14:11:13 [root] INFO: def clean_up_address(): Processing location 'Vancouver, BC' (event_id: None)
2025-06-18 14:11:13 [root] INFO: def clean_up_address(): Processing location 'Vancouver, BC' (event_id: None)
2025-06-18 14:11:13 [root] INFO: write_events_to_db: Number of events to write: 6
2025-06-18 14:11:13 [root] INFO: write_url_to_db(): appended URL 'https://calientedance.com/event/roadtrip-to-kelowna/'
2025-06-18 14:11:13 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 14:11:13 [root] INFO: def process_llm_response: URL https://calientedance.com/event/roadtrip-to-kelowna/ marked as relevant with events written to the database.
2025-06-18 14:11:13 [root] INFO: write_url_to_db(): appended URL 'https://calientedance.com/event/roadtrip-to-kelowna/'
2025-06-18 14:11:13 [root] INFO: def parse(): URL https://calientedance.com/event/roadtrip-to-kelowna/ marked as relevant (LLM positive).
2025-06-18 14:11:13 [root] INFO: def parse(): Found 10 links on https://calientedance.com/event/roadtrip-to-kelowna/
2025-06-18 14:11:13 [root] INFO: should_process_url: URL https://calientedance.com/classes/ was last seen as not relevant but hit_ratio (2.00) > 0.1 or crawl_try (9) ≤ 3, processing it.
2025-06-18 14:11:13 [root] INFO: should_process_url: URL https://calientedance.com/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:11:13 [root] INFO: should_process_url: URL https://calientedance.com/radio/ was last seen as relevant, processing it.
2025-06-18 14:11:13 [root] INFO: should_process_url: URL https://calientedance.com/news/ does not meet criteria for processing, skipping it.
2025-06-18 14:11:13 [root] INFO: def eventbrite_search(): Skipping URL https://calientedance.com/news/ based on historical relevancy.
2025-06-18 14:11:13 [root] INFO: should_process_url: URL https://calientedance.com/events/ was last seen as relevant, processing it.
2025-06-18 14:11:13 [root] INFO: should_process_url: URL https://calientedance.com/media/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:11:13 [root] INFO: should_process_url: URL https://calientedance.com/about-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:11:13 [root] INFO: should_process_url: URL https://calientedance.com/teams/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:11:13 [root] INFO: should_process_url: URL https://calientedance.com/ was last seen as not relevant but hit_ratio (0.67) > 0.1 or crawl_try (5) ≤ 3, processing it.
2025-06-18 14:11:13 [root] INFO: should_process_url: URL https://calientedance.com/event/roadtrip-to-kelowna/ has never been seen before, processing it.
2025-06-18 14:11:13 [root] INFO: def parse(): Found keywords for URL https://www.wellnessliving.com/schedule/baza: ['bachata', 'dance', 'kizomba', 'salsa', 'zouk']
2025-06-18 14:11:13 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.wellnessliving.com/schedule/baza
2025-06-18 14:11:13 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:11:13 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:11:13 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:13:24 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:13:24 [root] INFO: query_llm(): Mistral response received: ```json
[
    {
        "source": "WellnessLiving Systems Booking Event",
        "dance_style": "bachata",
        "url": "",
        "event_type": "workshop",
        "event_name": "Get To Know 2-hour workshop: Intro to Bachata",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "12:30",
        "end_time": "14:30",
        "price": "$45 + GST per person per 2-hour bootcamp",
        "location": "",
        "description": "New to Bachata? Baza's Get To Know (GTK) 2-hour Intro to Bachata workshop is perfect for you! Next GTK Bachata: Sat, May 3, 12:30-2:30pm. Our GTK sessions are a chance for you to Get To Know the dance, Get To Know our lovely instructors and Get To Know Baza and the amazing vibes here! These special 2-hour Intro bootcamp workshops are catered to Absolute Beginners. We know starting on your dance journey can be a bit scary at first or intimidating, which is why these sessions are a perfect place to start. The pace will be nice and slow, allowing you to wet your feet in the dance without feeling too overwhelmed. You will learn the very basics of the dance which will allow you to feel more confident heading into our Level 1 classes. Most of our students are here to have fun, mingle and get into Social dancing in this amazing community! No experience is necessary! These 2-hour bootcamps are catered for those new to latin social dancing, and perfect for beginner dancers who wish to have a solid refresher on the basics. Open to all dancers of all ages, backgrounds, and skill levels, signing up with a partner is not required as leads and follows will rotate (change partners) throughout the workshop."
    },
    {
        "source": "WellnessLiving Systems Booking Event",
        "dance_style": "salsa",
        "url": "",
        "event_type": "workshop",
        "event_name": "Get To Know 2-hour workshop: Intro to Salsa",
        "day_of_week": "Saturday",
        "start_date": "2025-06-28",
        "end_date": "2025-06-28",
        "start_time": "12:30",
        "end_time": "14:30",
        "price": "$45 + GST per person per 2-hour bootcamp",
        "location": "",
        "description": "New to Salsa? Baza's Get To Know (GTK) 2-hour Intro to Salsa workshop is perfect for you! NEXT GTK Salsa: Sat, June 21, 12:30-2:30pm. Our GTK sessions are a chance for you to Get To Know the dance, Get To Know our lovely instructors and Get To Know Baza and the amazing vibes here! These special Intro drop-in lessons are catered to Absolute Beginners. We know starting on your dance journey can be a bit scary at first or intimidating, which is why these sessions are a perfect place to start. The pace will be nice and slow, allowing you to wet your feet in the dance without feeling too overwhelmed. You will learn the very basics of the dance which will allow you to feel more confident heading into our Level 1 classes. Most of our students are here to have fun, mingle and get into Social dancing in this amazing community! No experience is necessary! These 2-hour bootcamps are catered for those new to latin social dancing, and perfect for beginner dancers who wish to have a solid refresher on the basics. Open to all dancers of all ages, backgrounds, and skill levels, signing up with a partner is not required as leads and follows will rotate (change partners) throughout the workshop."
    },
    {
        "source": "WellnessLiving Systems Booking Event",
        "dance_style": "zouk",
        "url": "",
        "event_type": "class",
        "event_name": "Mon Brazilian Zouk Intro (Lvl 1) 6-week Course starts Jul 7",
        "day_of_week": "Monday",
        "start_date": "2025-07-07",
        "end_date": "2025-08-18",
        "start_time": "18:15",
        "end_time": "19:15",
        "price": "$140+ GST/person",
        "location": "",
        "description": "Welcome to Baza! Baza Dance Studio's Brazilian Zouk Intro course is for absolute beginners and those new to Brazilian Zouk dancing. This course has no pre-requisites and registering with a partner is not necessary. NEXT 6-week COURSE begins on Mon Jul 7. Class dates: Jul 7, 14, 21, 28, Aug 11, 18 (no class Aug 4). Registered students commit to the entire course. Class takes place on Mondays from 6:15 - 7:15pm. Ultimate Access members can enroll in this course as part of their membership, however you must commit to the entire course. Instructors: Carla & Javi."
    },
    {
        "source": "WellnessLiving Systems Booking Event",
        "dance_style": "salsa",
        "url": "",
        "event_type": "class",
        "event_name": "Mon Salsa Intro (Lvl 1) 7-week Course at 6:15pm starts Jul 7",
        "day_of_week": "Monday",
        "start_date": "2025-07-07",
        "end_date": "2025-08-25",
        "start_time": "18:15",
        "end_time": "19:15",
        "price": "$162 + GST per person",
        "location": "",
        "description": "Welcome to Baza! Baza Dance Studio's Salsa Intro course is for absolute beginners and those new to Salsa dancing. There are no pre-requisites for this course and you do not have to have your own partner to enroll. NEXT 7-week Progressive Course on Mondays starts Mon, Jul 7. Class dates: Jul 7, 14, 21, 28, Aug 11, 18 & 25. Class takes place on Mondays from 6:15 - 7:15pm. We also offer this course on Thursdays at 6:15pm and Saturdays at 11:15am. *Make-up classes available. Cost: $162 + GST per person. Ultimate Access Members have access to this course but must commit to the entire 6 weeks. *This is a partner dancing class but students are not required to register with a partner. All students will be partnered up with a fellow student or one of our friendly helpers. Dancers have the option to rotate during the class so everyone has a chance to dance with everyone. Instructor: Nupur."
    },
    {
        "source": "WellnessLiving Systems Booking Event",
        "dance_style": "bachata",
        "url": "",
        "event_type": "class",
        "event_name": "Tue Bachata Intro (Lvl 1) Course at 6:15pm starts Jul 8",
        "day_of_week": "Tuesday",
        "start_date": "2025-07-08",
        "end_date": "2025-08-26",
        "start_time": "18:15",
        "end_time": "19:15",
        "price": "$185+ GST per person",
        "location": "",
        "description": "Welcome to Baza! Baza Dance Studio's Bachata Intro course is for absolute beginners and those new to Bachata dancing. There are no pre-requisites for this course and you do not have to have your own partner to enroll. NEXT 8-week Tue Progressive course starts Tue Jul 8. Class dates: Jul 8, 15, 22, 29, Aug 5, 12, 19 & 26. Registered students commit to the entire course. Class takes place on Tuesdays from 6:15 - 7:15pm. We also offer this same course on Wednesdays at 6:15pm. *Make up classes available. Cost: $185+ GST per person. Ultimate Access Members have access to this course but must commit to the entire course. *This is a partner dancing class but students are not required to register with a partner. All students will be partnered up with a fellow student or one of our friendly helpers. Dancers have the option to rotate during the class so everyone has a chance to dance with everyone. Instructor: Nupur."
    }
]
```
2025-06-18 14:13:24 [root] INFO: def extract_and_parse_json(): for url https://www.wellnessliving.com/schedule/baza, 
Cleaned JSON ready for parsing:
[
    {
        "source": "WellnessLiving Systems Booking Event",
        "dance_style": "bachata",
        "url": "",
        "event_type": "workshop",
        "event_name": "Get To Know 2-hour workshop: Intro to Bachata",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "12:30",
        "end_time": "14:30",
        "price": "$45 + GST per person per 2-hour bootcamp",
        "location": "",
        "description": "New to Bachata? Baza's Get To Know (GTK) 2-hour Intro to Bachata workshop is perfect for you! Next GTK Bachata: Sat, May 3, 12:30-2:30pm. Our GTK sessions are a chance for you to Get To Know the dance, Get To Know our lovely instructors and Get To Know Baza and the amazing vibes here! These special 2-hour Intro bootcamp workshops are catered to Absolute Beginners. We know starting on your dance journey can be a bit scary at first or intimidating, which is why these sessions are a perfect place to start. The pace will be nice and slow, allowing you to wet your feet in the dance without feeling too overwhelmed. You will learn the very basics of the dance which will allow you to feel more confident heading into our Level 1 classes. Most of our students are here to have fun, mingle and get into Social dancing in this amazing community! No experience is necessary! These 2-hour bootcamps are catered for those new to latin social dancing, and perfect for beginner dancers who wish to have a solid refresher on the basics. Open to all dancers of all ages, backgrounds, and skill levels, signing up with a partner is not required as leads and follows will rotate (change partners) throughout the workshop."
    },
    {
        "source": "WellnessLiving Systems Booking Event",
        "dance_style": "salsa",
        "url": "",
        "event_type": "workshop",
        "event_name": "Get To Know 2-hour workshop: Intro to Salsa",
        "day_of_week": "Saturday",
        "start_date": "2025-06-28",
        "end_date": "2025-06-28",
        "start_time": "12:30",
        "end_time": "14:30",
        "price": "$45 + GST per person per 2-hour bootcamp",
        "location": "",
        "description": "New to Salsa? Baza's Get To Know (GTK) 2-hour Intro to Salsa workshop is perfect for you! NEXT GTK Salsa: Sat, June 21, 12:30-2:30pm. Our GTK sessions are a chance for you to Get To Know the dance, Get To Know our lovely instructors and Get To Know Baza and the amazing vibes here! These special Intro drop-in lessons are catered to Absolute Beginners. We know starting on your dance journey can be a bit scary at first or intimidating, which is why these sessions are a perfect place to start. The pace will be nice and slow, allowing you to wet your feet in the dance without feeling too overwhelmed. You will learn the very basics of the dance which will allow you to feel more confident heading into our Level 1 classes. Most of our students are here to have fun, mingle and get into Social dancing in this amazing community! No experience is necessary! These 2-hour bootcamps are catered for those new to latin social dancing, and perfect for beginner dancers who wish to have a solid refresher on the basics. Open to all dancers of all ages, backgrounds, and skill levels, signing up with a partner is not required as leads and follows will rotate (change partners) throughout the workshop."
    },
    {
        "source": "WellnessLiving Systems Booking Event",
        "dance_style": "zouk",
        "url": "",
        "event_type": "class",
        "event_name": "Mon Brazilian Zouk Intro (Lvl 1) 6-week Course starts Jul 7",
        "day_of_week": "Monday",
        "start_date": "2025-07-07",
        "end_date": "2025-08-18",
        "start_time": "18:15",
        "end_time": "19:15",
        "price": "$140+ GST/person",
        "location": "",
        "description": "Welcome to Baza! Baza Dance Studio's Brazilian Zouk Intro course is for absolute beginners and those new to Brazilian Zouk dancing. This course has no pre-requisites and registering with a partner is not necessary. NEXT 6-week COURSE begins on Mon Jul 7. Class dates: Jul 7, 14, 21, 28, Aug 11, 18 (no class Aug 4). Registered students commit to the entire course. Class takes place on Mondays from 6:15 - 7:15pm. Ultimate Access members can enroll in this course as part of their membership, however you must commit to the entire course. Instructors: Carla & Javi."
    },
    {
        "source": "WellnessLiving Systems Booking Event",
        "dance_style": "salsa",
        "url": "",
        "event_type": "class",
        "event_name": "Mon Salsa Intro (Lvl 1) 7-week Course at 6:15pm starts Jul 7",
        "day_of_week": "Monday",
        "start_date": "2025-07-07",
        "end_date": "2025-08-25",
        "start_time": "18:15",
        "end_time": "19:15",
        "price": "$162 + GST per person",
        "location": "",
        "description": "Welcome to Baza! Baza Dance Studio's Salsa Intro course is for absolute beginners and those new to Salsa dancing. There are no pre-requisites for this course and you do not have to have your own partner to enroll. NEXT 7-week Progressive Course on Mondays starts Mon, Jul 7. Class dates: Jul 7, 14, 21, 28, Aug 11, 18 & 25. Class takes place on Mondays from 6:15 - 7:15pm. We also offer this course on Thursdays at 6:15pm and Saturdays at 11:15am. *Make-up classes available. Cost: $162 + GST per person. Ultimate Access Members have access to this course but must commit to the entire 6 weeks. *This is a partner dancing class but students are not required to register with a partner. All students will be partnered up with a fellow student or one of our friendly helpers. Dancers have the option to rotate during the class so everyone has a chance to dance with everyone. Instructor: Nupur."
    },
    {
        "source": "WellnessLiving Systems Booking Event",
        "dance_style": "bachata",
        "url": "",
        "event_type": "class",
        "event_name": "Tue Bachata Intro (Lvl 1) Course at 6:15pm starts Jul 8",
        "day_of_week": "Tuesday",
        "start_date": "2025-07-08",
        "end_date": "2025-08-26",
        "start_time": "18:15",
        "end_time": "19:15",
        "price": "$185+ GST per person",
        "location": "",
        "description": "Welcome to Baza! Baza Dance Studio's Bachata Intro course is for absolute beginners and those new to Bachata dancing. There are no pre-requisites for this course and you do not have to have your own partner to enroll. NEXT 8-week Tue Progressive course starts Tue Jul 8. Class dates: Jul 8, 15, 22, 29, Aug 5, 12, 19 & 26. Registered students commit to the entire course. Class takes place on Tuesdays from 6:15 - 7:15pm. We also offer this same course on Wednesdays at 6:15pm. *Make up classes available. Cost: $185+ GST per person. Ultimate Access Members have access to this course but must commit to the entire course. *This is a partner dancing class but students are not required to register with a partner. All students will be partnered up with a fellow student or one of our friendly helpers. Dancers have the option to rotate during the class so everyone has a chance to dance with everyone. Instructor: Nupur."
    }
]
2025-06-18 14:13:24 [root] INFO: def clean_up_address(): Starting with events_df shape: (5, 14)
2025-06-18 14:13:24 [root] INFO: write_events_to_db: Number of events to write: 5
2025-06-18 14:13:24 [root] INFO: write_url_to_db(): appended URL 'https://www.wellnessliving.com/schedule/baza'
2025-06-18 14:13:24 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 14:13:24 [root] INFO: def process_llm_response: URL https://www.wellnessliving.com/schedule/baza marked as relevant with events written to the database.
2025-06-18 14:13:25 [root] INFO: write_url_to_db(): appended URL 'https://www.wellnessliving.com/schedule/baza'
2025-06-18 14:13:25 [root] INFO: def parse(): URL https://www.wellnessliving.com/schedule/baza marked as relevant (LLM positive).
2025-06-18 14:13:25 [root] INFO: def parse(): Found 10 links on https://www.wellnessliving.com/rs/event/baza?k_business=306611&k_class_tab=54718&id_class_tab=2
2025-06-18 14:13:25 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-P8NSG8D, URL: https://www.wellnessliving.com/schedule/baza, source: Beginner Latin Dance and Fitness Classes in Downtown Vancouver, keywords: zouk
2025-06-18 14:13:25 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 14:13:25 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-P8NSG8D
2025-06-18 14:13:25 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-P8NSG8D'
2025-06-18 14:13:25 [root] INFO: should_process_url: URL https://www.wellnessliving.com/rs/profile.html was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:13:25 [root] INFO: should_process_url: URL https://www.wellnessliving.com/login/baza was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:13:25 [root] INFO: should_process_url: URL https://www.wellnessliving.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:13:25 [root] INFO: should_process_url: URL https://www.wellnessliving.com/catalog/baza was last seen as relevant, processing it.
2025-06-18 14:13:25 [root] INFO: should_process_url: URL https://www.wellnessliving.com/signup/baza was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:13:25 [root] INFO: should_process_url: URL https://www.wellnessliving.com/rs/report-page.html?sid_report_page=profile-attendance-schedule was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:13:25 [root] INFO: should_process_url: URL https://www.wellnessliving.com/rs/reward-board.html was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:13:25 [root] INFO: should_process_url: URL https://www.wellnessliving.com/schedule/baza was last seen as relevant, processing it.
2025-06-18 14:13:25 [root] INFO: def parse(): Found keywords for URL https://vimeo.com/dancevictoria: ['dance']
2025-06-18 14:13:25 [root] INFO: def generate_prompt(): Generating prompt for URL: https://vimeo.com/dancevictoria
2025-06-18 14:13:25 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:13:25 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:13:25 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:13:26 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 14:13:26 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 137930 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 14:13:26 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 14:13:33 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:13:33 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 14:13:33 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 14:13:33 [root] INFO: write_url_to_db(): appended URL 'https://vimeo.com/dancevictoria'
2025-06-18 14:13:33 [root] INFO: def parse(): URL https://vimeo.com/dancevictoria marked as irrelevant (LLM negative).
2025-06-18 14:13:33 [root] INFO: def parse(): Found 0 links on https://vimeo.com/dancevictoria
2025-06-18 14:13:33 [root] INFO: should_process_url: URL https://vimeo.com/dancevictoria was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:13:33 [root] INFO: def parse(): Found keywords for URL https://bandcamp.com/logout: ['bachata', 'balboa', 'dance', 'merengue', 'salsa', 'samba', 'swing', 'tango']
2025-06-18 14:13:33 [root] INFO: def generate_prompt(): Generating prompt for URL: https://bandcamp.com/logout
2025-06-18 14:13:33 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:13:33 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:13:33 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:13:35 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 14:13:35 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 194983 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 14:13:35 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 14:14:08 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:14:08 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 14:14:08 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 14:14:08 [root] INFO: write_url_to_db(): appended URL 'https://bandcamp.com/logout'
2025-06-18 14:14:08 [root] INFO: def parse(): URL https://bandcamp.com/logout marked as irrelevant (LLM negative).
2025-06-18 14:14:08 [root] INFO: def parse(): Found 10 links on https://bandcamp.com
2025-06-18 14:14:08 [root] INFO: should_process_url: URL https://bandcamp.com/logout was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:14:08 [root] INFO: should_process_url: URL https://bandcamp.com/partner was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:14:08 [root] INFO: should_process_url: URL https://bandcamp.com/settings?from=menubar was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:14:08 [root] INFO: should_process_url: URL https://store.bandcamp.com was last seen as relevant, processing it.
2025-06-18 14:14:08 [root] INFO: should_process_url: URL https://store.bandcamp.com was last seen as relevant, processing it.
2025-06-18 14:14:08 [root] INFO: write_url_to_db(): appended URL 'https://store.bandcamp.com'
2025-06-18 14:14:08 [root] INFO: def parse(): Crawling next URL: https://store.bandcamp.com
2025-06-18 14:14:08 [root] INFO: should_process_url: URL https://bandcamp.com/?from=menubar_logo_logged_out was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:14:08 [root] INFO: should_process_url: URL https://bandcamp.com/cart was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:14:08 [root] INFO: should_process_url: URL https://bandcamp.com/login?from=menubar was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:14:08 [root] INFO: should_process_url: URL https://get.bandcamp.help was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:14:08 [scrapy.extensions.logstats] INFO: Crawled 115 pages (at 17 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 14:14:08 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <406 https://alivetangovictoria.ca/calendar/>: HTTP status code is not handled or not allowed
2025-06-18 14:14:08 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <406 https://alivetangovictoria.ca/classes-and-workshops/>: HTTP status code is not handled or not allowed
2025-06-18 14:14:08 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <406 https://alivetangovictoria.ca/the-team/>: HTTP status code is not handled or not allowed
2025-06-18 14:14:08 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <406 https://alivetangovictoria.ca/alive-tango-practica/>: HTTP status code is not handled or not allowed
2025-06-18 14:14:08 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <403 https://get.bandcamp.help/hc/en-us>: HTTP status code is not handled or not allowed
2025-06-18 14:14:08 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <406 http://alivetangovictoria.ca/calendar>: HTTP status code is not handled or not allowed
2025-06-18 14:14:08 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <406 http://alivetangovictoria.ca/>: HTTP status code is not handled or not allowed
2025-06-18 14:14:08 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <406 https://calientedance.com/about-us/>: HTTP status code is not handled or not allowed
2025-06-18 14:14:08 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <406 https://calientedance.com/events/>: HTTP status code is not handled or not allowed
2025-06-18 14:14:08 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <406 https://calientedance.com/media/>: HTTP status code is not handled or not allowed
2025-06-18 14:14:08 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <406 https://calientedance.com/radio/>: HTTP status code is not handled or not allowed
2025-06-18 14:14:08 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <406 https://calientedance.com/contact/>: HTTP status code is not handled or not allowed
2025-06-18 14:14:08 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <406 https://latindancecanada.com/contact/>: HTTP status code is not handled or not allowed
2025-06-18 14:14:09 [root] INFO: write_url_to_db(): appended URL 'https://bandcamp.com/partner'
2025-06-18 14:14:09 [root] INFO: def parse(): URL https://bandcamp.com/partner marked as irrelevant (no keywords).
2025-06-18 14:14:09 [root] INFO: def parse(): Found 1 links on https://bandcamp.com/login?bounce=https%3A%2F%2Fbandcamp.com%2Fpartner&sig=4b4c94f22b1f675e30584660ae1e2b72
2025-06-18 14:14:09 [root] INFO: should_process_url: URL https://bandcamp.com/partner was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:14:09 [root] INFO: should_process_url: URL https://bandcamp.com was last seen as relevant, processing it.
2025-06-18 14:14:09 [root] INFO: write_url_to_db(): appended URL 'https://bandcamp.com/settings?from=menubar'
2025-06-18 14:14:09 [root] INFO: def parse(): URL https://bandcamp.com/settings?from=menubar marked as irrelevant (no keywords).
2025-06-18 14:14:09 [root] INFO: def parse(): Found 1 links on https://bandcamp.com/login?bounce=https%3A%2F%2Fbandcamp.com%2Fsettings%3Ffrom%3Dmenubar&sig=e8e774950aecb966806c0bd87c73c3f8
2025-06-18 14:14:09 [root] INFO: should_process_url: URL https://bandcamp.com was last seen as relevant, processing it.
2025-06-18 14:14:09 [root] INFO: should_process_url: URL https://bandcamp.com/settings?from=menubar was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:14:09 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <406 https://latinvictoria.ca/>: HTTP status code is not handled or not allowed
2025-06-18 14:14:09 [root] INFO: def parse(): Found keywords for URL https://m.facebook.com/latindancecanada/photos/new-dance-classes-starting-january-httpslatindancecanadacomgroup-classes/1041978164501698/: ['dance']
2025-06-18 14:14:09 [root] INFO: def generate_prompt(): Generating prompt for URL: https://m.facebook.com/latindancecanada/photos/new-dance-classes-starting-january-httpslatindancecanadacomgroup-classes/1041978164501698/
2025-06-18 14:14:09 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:14:09 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:14:09 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:14:10 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:14:10 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 14:14:10 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 14:14:10 [root] INFO: write_url_to_db(): appended URL 'https://m.facebook.com/latindancecanada/photos/new-dance-classes-starting-january-httpslatindancecanadacomgroup-classes/1041978164501698/'
2025-06-18 14:14:10 [root] INFO: def parse(): URL https://m.facebook.com/latindancecanada/photos/new-dance-classes-starting-january-httpslatindancecanadacomgroup-classes/1041978164501698/ marked as irrelevant (LLM negative).
2025-06-18 14:14:10 [root] INFO: def parse(): Found 0 links on https://m.facebook.com/login/?next=https%3A%2F%2Fm.facebook.com%2Flatindancecanada%2Fphotos%2Fnew-dance-classes-starting-january-httpslatindancecanadacomgroup-classes%2F1041978164501698%2F&refsrc=deprecated&_rdr
2025-06-18 14:14:10 [root] INFO: write_url_to_db(): appended URL 'https://m.facebook.com/latindancecanada/photos/new-dance-classes-starting-january-httpslatindancecanadacomgroup-classes/1041978164501698/'
2025-06-18 14:14:10 [root] INFO: def parse(): Recorded unwanted URL: https://m.facebook.com/latindancecanada/photos/new-dance-classes-starting-january-httpslatindancecanadacomgroup-classes/1041978164501698/
2025-06-18 14:14:10 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <403 https://social-dance.today/party/sunday-sundown-social-bachata-temptation-salsa-sensation-a0/2025-07-20>: HTTP status code is not handled or not allowed
2025-06-18 14:14:10 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <403 https://social-dance.today/party/sunday-sundown-social-salsa-fire-bachata-desire-kizomba-inspire-3f/2025-06-29>: HTTP status code is not handled or not allowed
2025-06-18 14:14:10 [root] INFO: def parse(): Found keywords for URL https://www.instagram.com/alivetangovictoria/: ['argentine tango', 'balboa', 'dance', 'tango', 'wcs']
2025-06-18 14:14:10 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.instagram.com/alivetangovictoria/
2025-06-18 14:14:10 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:14:10 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:14:10 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:14:13 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 14:14:13 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 404840 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 14:14:13 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 14:14:13 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 14:14:13 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 308814 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 14:14:13 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 14:14:13 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://www.instagram.com/alivetangovictoria/
2025-06-18 14:14:13 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/alivetangovictoria/'
2025-06-18 14:14:13 [root] INFO: def parse(): URL https://www.instagram.com/alivetangovictoria/ marked as irrelevant (LLM negative).
2025-06-18 14:14:14 [root] INFO: def parse(): Found 0 links on https://www.instagram.com/alivetangovictoria/
2025-06-18 14:14:14 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/alivetangovictoria/'
2025-06-18 14:14:14 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/alivetangovictoria/
2025-06-18 14:14:14 [root] INFO: def parse(): Found keywords for URL https://www.jpost.com/aliyah/article-709647: ['argentine tango', 'dance', 'tango']
2025-06-18 14:14:14 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.jpost.com/aliyah/article-709647
2025-06-18 14:14:14 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:14:14 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:14:14 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:14:46 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:14:46 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 14:14:46 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 14:14:46 [root] INFO: write_url_to_db(): appended URL 'https://www.jpost.com/aliyah/article-709647'
2025-06-18 14:14:46 [root] INFO: def parse(): URL https://www.jpost.com/aliyah/article-709647 marked as irrelevant (LLM negative).
2025-06-18 14:14:46 [root] INFO: def parse(): Found 10 links on https://www.jpost.com/aliyah/article-709647
2025-06-18 14:14:46 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/thejerusalem_post/'
2025-06-18 14:14:46 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/thejerusalem_post/
2025-06-18 14:14:46 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/TheJerusalemPost'
2025-06-18 14:14:46 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/TheJerusalemPost
2025-06-18 14:14:46 [root] INFO: should_process_url: URL https://store.jpost.com/ has never been seen before, processing it.
2025-06-18 14:14:46 [root] INFO: should_process_url: URL https://store.jpost.com/ has never been seen before, processing it.
2025-06-18 14:14:46 [root] INFO: write_url_to_db(): appended URL 'https://store.jpost.com/'
2025-06-18 14:14:46 [root] INFO: def parse(): Crawling next URL: https://store.jpost.com/
2025-06-18 14:14:46 [scrapy.extensions.logstats] INFO: Crawled 133 pages (at 18 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 14:14:46 [root] INFO: should_process_url: URL https://x.com/Jerusalem_Post has never been seen before, processing it.
2025-06-18 14:14:46 [root] INFO: should_process_url: URL https://x.com/Jerusalem_Post has never been seen before, processing it.
2025-06-18 14:14:46 [root] INFO: write_url_to_db(): appended URL 'https://x.com/Jerusalem_Post'
2025-06-18 14:14:46 [root] INFO: def parse(): Crawling next URL: https://x.com/Jerusalem_Post
2025-06-18 14:14:46 [root] INFO: parse: Skipping blacklisted URL https://www.linkedin.com/company/jerusalem-post/.
2025-06-18 14:14:46 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/channel/UCLLLdCANnMAdMyrXdYbSlxg.
2025-06-18 14:14:46 [root] INFO: should_process_url: URL https://www.jpost.com/aliyah/article-709647 has never been seen before, processing it.
2025-06-18 14:14:46 [root] INFO: should_process_url: URL https://www.jpost.com/aliyah/article-709647 has never been seen before, processing it.
2025-06-18 14:14:46 [root] INFO: write_url_to_db(): appended URL 'https://www.jpost.com/aliyah/article-709647'
2025-06-18 14:14:46 [root] INFO: def parse(): Crawling next URL: https://www.jpost.com/aliyah/article-709647
2025-06-18 14:14:46 [root] INFO: should_process_url: URL https://t.me/The_Jerusalem_Post has never been seen before, processing it.
2025-06-18 14:14:46 [root] INFO: should_process_url: URL https://t.me/The_Jerusalem_Post has never been seen before, processing it.
2025-06-18 14:14:46 [root] INFO: write_url_to_db(): appended URL 'https://t.me/The_Jerusalem_Post'
2025-06-18 14:14:46 [root] INFO: def parse(): Crawling next URL: https://t.me/The_Jerusalem_Post
2025-06-18 14:14:47 [root] INFO: parse: Skipping blacklisted URL https://realestate.jpost.com/.
2025-06-18 14:14:47 [root] INFO: should_process_url: URL https://payments.jpost.com/paywall/paywallpersonaldetails has never been seen before, processing it.
2025-06-18 14:14:47 [root] INFO: should_process_url: URL https://payments.jpost.com/paywall/paywallpersonaldetails has never been seen before, processing it.
2025-06-18 14:14:47 [root] INFO: write_url_to_db(): appended URL 'https://payments.jpost.com/paywall/paywallpersonaldetails'
2025-06-18 14:14:47 [root] INFO: def parse(): Crawling next URL: https://payments.jpost.com/paywall/paywallpersonaldetails
2025-06-18 14:14:47 [root] INFO: def parse(): Found keywords for URL https://alces.world/events/list/featured/?shortcode=758c7f2c: ['dance', 'kizomba']
2025-06-18 14:14:47 [root] INFO: def generate_prompt(): Generating prompt for URL: https://alces.world/events/list/featured/?shortcode=758c7f2c
2025-06-18 14:14:47 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:14:47 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:14:47 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:16:45 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:16:45 [root] INFO: query_llm(): Mistral response received: [
  {
    "source": "Afro-Latin Cultural Exchange Society",
    "dance_style": "kizomba, urbankiz",
    "url": "",
    "event_type": "class",
    "event_name": "Kizomba Practica Thursdays",
    "day_of_week": "Thursday",
    "start_date": "2025-06-19",
    "end_date": "2025-06-19",
    "start_time": "20:00",
    "end_time": "17:00",
    "price": "$10 – $15",
    "location": "Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, Canada",
    "description": "Join us every Thursday for Kizomba/Urbankiz classes. Intermediate 7:30PM-8:15pm Beginner 8:15pm-9:00pm Practica until 10:30pm Class only: $10 Class & Practica: $15 or $10 for university students w/ID Practice only $10"
  },
  {
    "source": "Afro-Latin Cultural Exchange Society",
    "dance_style": "kizomba, urbankiz",
    "url": "",
    "event_type": "class",
    "event_name": "Kizomba Practica Thursdays",
    "day_of_week": "Thursday",
    "start_date": "2025-06-26",
    "end_date": "2025-06-26",
    "start_time": "20:00",
    "end_time": "17:00",
    "price": "$10 – $15",
    "location": "Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, Canada",
    "description": "Join us every Thursday for Kizomba/Urbankiz classes. Intermediate 7:30PM-8:15pm Beginner 8:15pm-9:00pm Practica until 10:30pm Class only: $10 Class & Practica: $15 or $10 for university students w/ID Practice only $10"
  },
  {
    "source": "Afro-Latin Cultural Exchange Society",
    "dance_style": "kizomba, urbankiz",
    "url": "",
    "event_type": "class",
    "event_name": "Kizomba Practica Thursdays",
    "day_of_week": "Thursday",
    "start_date": "2025-07-03",
    "end_date": "2025-07-03",
    "start_time": "20:00",
    "end_time": "17:00",
    "price": "$10 – $15",
    "location": "Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, Canada",
    "description": "Join us every Thursday for Kizomba/Urbankiz classes. Intermediate 7:30PM-8:15pm Beginner 8:15pm-9:00pm Practica until 10:30pm Class only: $10 Class & Practica: $15 or $10 for university students w/ID Practice only $10"
  },
  {
    "source": "Afro-Latin Cultural Exchange Society",
    "dance_style": "kizomba, urbankiz",
    "url": "",
    "event_type": "class",
    "event_name": "Kizomba Practica Thursdays",
    "day_of_week": "Thursday",
    "start_date": "2025-07-10",
    "end_date": "2025-07-10",
    "start_time": "20:00",
    "end_time": "17:00",
    "price": "$10 – $15",
    "location": "Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, Canada",
    "description": "Join us every Thursday for Kizomba/Urbankiz classes. Intermediate 7:30PM-8:15pm Beginner 8:15pm-9:00pm Practica until 10:30pm Class only: $10 Class & Practica: $15 or $10 for university students w/ID Practice only $10"
  },
  {
    "source": "Afro-Latin Cultural Exchange Society",
    "dance_style": "kizomba, urbankiz",
    "url": "",
    "event_type": "class",
    "event_name": "Kizomba Practica Thursdays",
    "day_of_week": "Thursday",
    "start_date": "2025-07-17",
    "end_date": "2025-07-17",
    "start_time": "20:00",
    "end_time": "17:00",
    "price": "$10 – $15",
    "location": "Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, Canada",
    "description": "Join us every Thursday for Kizomba/Urbankiz classes. Intermediate 7:30PM-8:15pm Beginner 8:15pm-9:00pm Practica until 10:30pm Class only: $10 Class & Practica: $15 or $10 for university students w/ID Practice only $10"
  },
  {
    "source": "Afro-Latin Cultural Exchange Society",
    "dance_style": "kizomba, urbankiz",
    "url": "",
    "event_type": "class",
    "event_name": "Kizomba Practica Thursdays",
    "day_of_week": "Thursday",
    "start_date": "2025-07-24",
    "end_date": "2025-07-24",
    "start_time": "20:00",
    "end_time": "17:00",
    "price": "$10 – $15",
    "location": "Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, Canada",
    "description": "Join us every Thursday for Kizomba/Urbankiz classes. Intermediate 7:30PM-8:15pm Beginner 8:15pm-9:00pm Practica until 10:30pm Class only: $10 Class & Practica: $15 or $10 for university students w/ID Practice only $10"
  }
]
2025-06-18 14:16:45 [root] INFO: def extract_and_parse_json(): for url https://alces.world/events/list/featured/?shortcode=758c7f2c, 
Cleaned JSON ready for parsing:
[
  {
    "source": "Afro-Latin Cultural Exchange Society",
    "dance_style": "kizomba, urbankiz",
    "url": "",
    "event_type": "class",
    "event_name": "Kizomba Practica Thursdays",
    "day_of_week": "Thursday",
    "start_date": "2025-06-19",
    "end_date": "2025-06-19",
    "start_time": "20:00",
    "end_time": "17:00",
    "price": "$10 – $15",
    "location": "Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, Canada",
    "description": "Join us every Thursday for Kizomba/Urbankiz classes. Intermediate 7:30PM-8:15pm Beginner 8:15pm-9:00pm Practica until 10:30pm Class only: $10 Class & Practica: $15 or $10 for university students w/ID Practice only $10"
  },
  {
    "source": "Afro-Latin Cultural Exchange Society",
    "dance_style": "kizomba, urbankiz",
    "url": "",
    "event_type": "class",
    "event_name": "Kizomba Practica Thursdays",
    "day_of_week": "Thursday",
    "start_date": "2025-06-26",
    "end_date": "2025-06-26",
    "start_time": "20:00",
    "end_time": "17:00",
    "price": "$10 – $15",
    "location": "Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, Canada",
    "description": "Join us every Thursday for Kizomba/Urbankiz classes. Intermediate 7:30PM-8:15pm Beginner 8:15pm-9:00pm Practica until 10:30pm Class only: $10 Class & Practica: $15 or $10 for university students w/ID Practice only $10"
  },
  {
    "source": "Afro-Latin Cultural Exchange Society",
    "dance_style": "kizomba, urbankiz",
    "url": "",
    "event_type": "class",
    "event_name": "Kizomba Practica Thursdays",
    "day_of_week": "Thursday",
    "start_date": "2025-07-03",
    "end_date": "2025-07-03",
    "start_time": "20:00",
    "end_time": "17:00",
    "price": "$10 – $15",
    "location": "Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, Canada",
    "description": "Join us every Thursday for Kizomba/Urbankiz classes. Intermediate 7:30PM-8:15pm Beginner 8:15pm-9:00pm Practica until 10:30pm Class only: $10 Class & Practica: $15 or $10 for university students w/ID Practice only $10"
  },
  {
    "source": "Afro-Latin Cultural Exchange Society",
    "dance_style": "kizomba, urbankiz",
    "url": "",
    "event_type": "class",
    "event_name": "Kizomba Practica Thursdays",
    "day_of_week": "Thursday",
    "start_date": "2025-07-10",
    "end_date": "2025-07-10",
    "start_time": "20:00",
    "end_time": "17:00",
    "price": "$10 – $15",
    "location": "Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, Canada",
    "description": "Join us every Thursday for Kizomba/Urbankiz classes. Intermediate 7:30PM-8:15pm Beginner 8:15pm-9:00pm Practica until 10:30pm Class only: $10 Class & Practica: $15 or $10 for university students w/ID Practice only $10"
  },
  {
    "source": "Afro-Latin Cultural Exchange Society",
    "dance_style": "kizomba, urbankiz",
    "url": "",
    "event_type": "class",
    "event_name": "Kizomba Practica Thursdays",
    "day_of_week": "Thursday",
    "start_date": "2025-07-17",
    "end_date": "2025-07-17",
    "start_time": "20:00",
    "end_time": "17:00",
    "price": "$10 – $15",
    "location": "Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, Canada",
    "description": "Join us every Thursday for Kizomba/Urbankiz classes. Intermediate 7:30PM-8:15pm Beginner 8:15pm-9:00pm Practica until 10:30pm Class only: $10 Class & Practica: $15 or $10 for university students w/ID Practice only $10"
  },
  {
    "source": "Afro-Latin Cultural Exchange Society",
    "dance_style": "kizomba, urbankiz",
    "url": "",
    "event_type": "class",
    "event_name": "Kizomba Practica Thursdays",
    "day_of_week": "Thursday",
    "start_date": "2025-07-24",
    "end_date": "2025-07-24",
    "start_time": "20:00",
    "end_time": "17:00",
    "price": "$10 – $15",
    "location": "Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, Canada",
    "description": "Join us every Thursday for Kizomba/Urbankiz classes. Intermediate 7:30PM-8:15pm Beginner 8:15pm-9:00pm Practica until 10:30pm Class only: $10 Class & Practica: $15 or $10 for university students w/ID Practice only $10"
  }
]
2025-06-18 14:16:45 [root] INFO: def clean_up_address(): Starting with events_df shape: (6, 14)
2025-06-18 14:16:45 [root] INFO: def clean_up_address(): Processing location 'Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, Canada' (event_id: None)
2025-06-18 14:16:45 [root] INFO: def clean_up_address(): Updated event None with address_id 4317 using DB match
2025-06-18 14:16:45 [root] INFO: def clean_up_address(): Processing location 'Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, Canada' (event_id: None)
2025-06-18 14:16:45 [root] INFO: def clean_up_address(): Updated event None with address_id 4317 using DB match
2025-06-18 14:16:45 [root] INFO: def clean_up_address(): Processing location 'Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, Canada' (event_id: None)
2025-06-18 14:16:45 [root] INFO: def clean_up_address(): Updated event None with address_id 4317 using DB match
2025-06-18 14:16:45 [root] INFO: def clean_up_address(): Processing location 'Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, Canada' (event_id: None)
2025-06-18 14:16:45 [root] INFO: def clean_up_address(): Updated event None with address_id 4317 using DB match
2025-06-18 14:16:45 [root] INFO: def clean_up_address(): Processing location 'Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, Canada' (event_id: None)
2025-06-18 14:16:45 [root] INFO: def clean_up_address(): Updated event None with address_id 4317 using DB match
2025-06-18 14:16:45 [root] INFO: def clean_up_address(): Processing location 'Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, Canada' (event_id: None)
2025-06-18 14:16:45 [root] INFO: def clean_up_address(): Updated event None with address_id 4317 using DB match
2025-06-18 14:16:46 [root] INFO: write_events_to_db: Number of events to write: 6
2025-06-18 14:16:46 [root] INFO: write_url_to_db(): appended URL 'https://alces.world/events/list/featured/?shortcode=758c7f2c'
2025-06-18 14:16:46 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 14:16:46 [root] INFO: def process_llm_response: URL https://alces.world/events/list/featured/?shortcode=758c7f2c marked as relevant with events written to the database.
2025-06-18 14:16:46 [root] INFO: write_url_to_db(): appended URL 'https://alces.world/events/list/featured/?shortcode=758c7f2c'
2025-06-18 14:16:46 [root] INFO: def parse(): URL https://alces.world/events/list/featured/?shortcode=758c7f2c marked as relevant (LLM positive).
2025-06-18 14:16:46 [root] INFO: def parse(): Found 10 links on https://alces.world/events/list/featured/?shortcode=758c7f2c
2025-06-18 14:16:46 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/events/758501768607647/?acontext=%7B%22event_action_history%22%3A%5B%7B%22surface%22%3A%22external%22%7D%2C%7B%22mechanism%22%3A%22your_upcoming_events_unit%22%2C%22surface%22%3A%22bookmark%22%7D%5D%2C%22ref_notif_type%22%3Anull%7D'
2025-06-18 14:16:46 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/events/758501768607647/?acontext=%7B%22event_action_history%22%3A%5B%7B%22surface%22%3A%22external%22%7D%2C%7B%22mechanism%22%3A%22your_upcoming_events_unit%22%2C%22surface%22%3A%22bookmark%22%7D%5D%2C%22ref_notif_type%22%3Anull%7D
2025-06-18 14:16:46 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/vic_international_kizomba_fest/'
2025-06-18 14:16:46 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/vic_international_kizomba_fest/
2025-06-18 14:16:46 [root] INFO: should_process_url: URL https://alces.world/about-us/#volunteer was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:16:46 [root] INFO: should_process_url: URL https://alces.world/about-us/#volunteer was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:16:46 [root] INFO: write_url_to_db(): appended URL 'https://alces.world/about-us/#volunteer'
2025-06-18 14:16:46 [root] INFO: def parse(): Crawling next URL: https://alces.world/about-us/#volunteer
2025-06-18 14:16:46 [root] INFO: def parse(): Found keywords for URL https://milongas-in.com/milongas-in-america.php?c=Canada&city=Victoria: ['argentine tango', 'dance', 'milonga', 'tango']
2025-06-18 14:16:46 [root] INFO: def generate_prompt(): Generating prompt for URL: https://milongas-in.com/milongas-in-america.php?c=Canada&city=Victoria
2025-06-18 14:16:46 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:16:46 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:16:46 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:16:49 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:16:49 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "Milongas in any city",
        "dance_style": "tango",
        "url": "",
        "event_type": "social dance",
        "event_name": "Milonga Victoria",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "$12 CDN",
        "location": "Cafe Casablanca, 2514 Bridge Street, Victoria, British Columbia",
        "description": "Traditional Argentine tango."
    }
]
2025-06-18 14:16:49 [root] INFO: def extract_and_parse_json(): for url https://milongas-in.com/milongas-in-america.php?c=Canada&city=Victoria, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Milongas in any city",
        "dance_style": "tango",
        "url": "",
        "event_type": "social dance",
        "event_name": "Milonga Victoria",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "$12 CDN",
        "location": "Cafe Casablanca, 2514 Bridge Street, Victoria, British Columbia",
        "description": "Traditional Argentine tango."
    }
]
2025-06-18 14:16:49 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 14:16:49 [root] INFO: def clean_up_address(): Processing location 'Cafe Casablanca, 2514 Bridge Street, Victoria, British Columbia' (event_id: None)
2025-06-18 14:16:49 [root] INFO: write_events_to_db: Number of events to write: 1
2025-06-18 14:16:49 [root] INFO: write_url_to_db(): appended URL 'https://milongas-in.com/milongas-in-america.php?c=Canada&city=Victoria'
2025-06-18 14:16:49 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 14:16:49 [root] INFO: def process_llm_response: URL https://milongas-in.com/milongas-in-america.php?c=Canada&city=Victoria marked as relevant with events written to the database.
2025-06-18 14:16:49 [root] INFO: write_url_to_db(): appended URL 'https://milongas-in.com/milongas-in-america.php?c=Canada&city=Victoria'
2025-06-18 14:16:49 [root] INFO: def parse(): URL https://milongas-in.com/milongas-in-america.php?c=Canada&city=Victoria marked as relevant (LLM positive).
2025-06-18 14:16:49 [root] INFO: def parse(): Found 3 links on https://milongas-in.com/milongas-in-america.php?c=Canada&city=Victoria
2025-06-18 14:16:49 [root] INFO: should_process_url: URL https://milongas-in.com/milongas-in-america.php?c=Canada&city=Victoria has never been seen before, processing it.
2025-06-18 14:16:49 [root] INFO: should_process_url: URL https://milongas-in.com/milongas-in-america.php?c=Canada&city=Victoria has never been seen before, processing it.
2025-06-18 14:16:49 [root] INFO: write_url_to_db(): appended URL 'https://milongas-in.com/milongas-in-america.php?c=Canada&city=Victoria'
2025-06-18 14:16:49 [root] INFO: def parse(): Crawling next URL: https://milongas-in.com/milongas-in-america.php?c=Canada&city=Victoria
2025-06-18 14:16:49 [root] INFO: def parse(): Found keywords for URL https://alces.world/: ['bachata', 'dance', 'kizomba', 'semba']
2025-06-18 14:16:49 [root] INFO: def generate_prompt(): Generating prompt for URL: https://alces.world/
2025-06-18 14:16:49 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:16:49 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:16:49 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:17:26 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:17:26 [root] INFO: query_llm(): Mistral response received: **Instructions:**

Examine the extracted text and build a JSON array according to the provided rules.

No events are found

## No events found
2025-06-18 14:17:26 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 14:17:26 [root] INFO: write_url_to_db(): appended URL 'https://alces.world/'
2025-06-18 14:17:26 [root] INFO: def parse(): URL https://alces.world/ marked as irrelevant (LLM negative).
2025-06-18 14:17:26 [root] INFO: def parse(): Found 10 links on https://alces.world/
2025-06-18 14:17:26 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/events/758501768607647/?acontext=%7B%22event_action_history%22%3A%5B%7B%22surface%22%3A%22external%22%7D%2C%7B%22mechanism%22%3A%22your_upcoming_events_unit%22%2C%22surface%22%3A%22bookmark%22%7D%5D%2C%22ref_notif_type%22%3Anull%7D'
2025-06-18 14:17:26 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/events/758501768607647/?acontext=%7B%22event_action_history%22%3A%5B%7B%22surface%22%3A%22external%22%7D%2C%7B%22mechanism%22%3A%22your_upcoming_events_unit%22%2C%22surface%22%3A%22bookmark%22%7D%5D%2C%22ref_notif_type%22%3Anull%7D
2025-06-18 14:17:26 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/vic_international_kizomba_fest/'
2025-06-18 14:17:26 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/vic_international_kizomba_fest/
2025-06-18 14:17:26 [root] INFO: should_process_url: URL https://alces.world/about-us/#volunteer was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:17:26 [root] INFO: should_process_url: URL https://alces.world/about-us/ was last seen as relevant, processing it.
2025-06-18 14:17:26 [root] INFO: should_process_url: URL https://alces.world/about-us/ was last seen as relevant, processing it.
2025-06-18 14:17:26 [root] INFO: write_url_to_db(): appended URL 'https://alces.world/about-us/'
2025-06-18 14:17:26 [root] INFO: def parse(): Crawling next URL: https://alces.world/about-us/
2025-06-18 14:17:26 [root] INFO: def parse(): Found keywords for URL https://www.eventbrite.com/cc/argentine-tango-classes-related-events-2881689: ['argentine tango', 'dance', 'milonga', 'tango']
2025-06-18 14:17:26 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.eventbrite.com/cc/argentine-tango-classes-related-events-2881689
2025-06-18 14:17:26 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:17:26 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:17:26 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:17:28 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 14:17:28 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 184418 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 14:17:28 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 14:18:40 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:18:40 [root] INFO: query_llm(): OpenAI response received: [{
    "source": "Eventbrite",
    "dance_style": "tango",
    "url": "",
    "event_type": "workshop",
    "event_name": "Kundalini Tango (Vancouver)",
    "day_of_week": "Saturday",
    "start_date": "2025-10-11",
    "end_date": "2025-10-11",
    "start_time": "14:00",
    "end_time": "",
    "price": "From $0.00",
    "location": "",
    "description": ""
}]
2025-06-18 14:18:40 [root] INFO: def extract_and_parse_json(): for url https://www.eventbrite.com/cc/argentine-tango-classes-related-events-2881689, 
Cleaned JSON ready for parsing:
[{
    "source": "Eventbrite",
    "dance_style": "tango",
    "url": "",
    "event_type": "workshop",
    "event_name": "Kundalini Tango (Vancouver)",
    "day_of_week": "Saturday",
    "start_date": "2025-10-11",
    "end_date": "2025-10-11",
    "start_time": "14:00",
    "end_time": "",
    "price": "From $0.00",
    "location": "",
    "description": ""
}]
2025-06-18 14:18:40 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 14:18:40 [root] INFO: write_events_to_db: Number of events to write: 1
2025-06-18 14:18:40 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/cc/argentine-tango-classes-related-events-2881689'
2025-06-18 14:18:40 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 14:18:40 [root] INFO: def process_llm_response: URL https://www.eventbrite.com/cc/argentine-tango-classes-related-events-2881689 marked as relevant with events written to the database.
2025-06-18 14:18:40 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/cc/argentine-tango-classes-related-events-2881689'
2025-06-18 14:18:40 [root] INFO: def parse(): URL https://www.eventbrite.com/cc/argentine-tango-classes-related-events-2881689 marked as relevant (LLM positive).
2025-06-18 14:18:40 [root] INFO: def parse(): Found 10 links on https://www.eventbrite.com/cc/argentine-tango-classes-related-events-2881689
2025-06-18 14:18:40 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ, URL: https://www.eventbrite.com/cc/argentine-tango-classes-related-events-2881689, source: Argentine tango classes & related events | Eventbrite, keywords: argentine tango
2025-06-18 14:18:40 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 14:18:40 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ
2025-06-18 14:18:40 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ'
2025-06-18 14:18:40 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/signup/?referrer=%2Fcc%2Fargentine-tango-classes-related-events-2881689 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:18:40 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/signup/?referrer=%2Fcc%2Fargentine-tango-classes-related-events-2881689 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:18:40 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/signin/signup/?referrer=%2Fcc%2Fargentine-tango-classes-related-events-2881689'
2025-06-18 14:18:40 [root] INFO: def parse(): Crawling next URL: https://www.eventbrite.com/signin/signup/?referrer=%2Fcc%2Fargentine-tango-classes-related-events-2881689
2025-06-18 14:18:40 [root] INFO: def parse(): Found keywords for URL https://www.facebook.com/groups/895697871649474/: ['dance', 'wcs', 'zouk']
2025-06-18 14:18:40 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.facebook.com/groups/895697871649474/
2025-06-18 14:18:40 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:18:40 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:18:40 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:18:43 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 14:18:43 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 568028 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 14:18:43 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 14:18:45 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 14:18:45 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 427055 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 14:18:45 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 14:18:45 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://www.facebook.com/groups/895697871649474/
2025-06-18 14:18:45 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/895697871649474/'
2025-06-18 14:18:45 [root] INFO: def parse(): URL https://www.facebook.com/groups/895697871649474/ marked as irrelevant (LLM negative).
2025-06-18 14:18:45 [root] INFO: def parse(): Found 0 links on https://www.facebook.com/groups/895697871649474/
2025-06-18 14:18:45 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/895697871649474/'
2025-06-18 14:18:45 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/groups/895697871649474/
2025-06-18 14:18:45 [root] INFO: def parse(): Found keywords for URL https://www.facebook.com/groups/265269613666246/: ['dance', 'kizomba', 'wcs', 'zouk']
2025-06-18 14:18:45 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.facebook.com/groups/265269613666246/
2025-06-18 14:18:45 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:18:45 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:18:45 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:18:48 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 14:18:48 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 601979 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 14:18:48 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 14:18:49 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 14:18:49 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 456730 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 14:18:49 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 14:18:49 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://www.facebook.com/groups/265269613666246/
2025-06-18 14:18:49 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/265269613666246/'
2025-06-18 14:18:49 [root] INFO: def parse(): URL https://www.facebook.com/groups/265269613666246/ marked as irrelevant (LLM negative).
2025-06-18 14:18:49 [root] INFO: def parse(): Found 0 links on https://www.facebook.com/groups/265269613666246/
2025-06-18 14:18:49 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/265269613666246/'
2025-06-18 14:18:49 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/groups/265269613666246/
2025-06-18 14:18:49 [root] INFO: def parse(): Found keywords for URL https://www.facebook.com/Sabor.Asi.Dance.Salsa.Victoria/: ['bachata', 'cha cha', 'dance', 'merengue', 'salsa', 'wcs', 'zouk']
2025-06-18 14:18:49 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.facebook.com/Sabor.Asi.Dance.Salsa.Victoria/
2025-06-18 14:18:49 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:18:49 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:18:49 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:18:52 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 14:18:52 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 603889 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 14:18:52 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 14:18:53 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 14:18:53 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 457584 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 14:18:53 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 14:18:53 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://www.facebook.com/Sabor.Asi.Dance.Salsa.Victoria/
2025-06-18 14:18:53 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/Sabor.Asi.Dance.Salsa.Victoria/'
2025-06-18 14:18:53 [root] INFO: def parse(): URL https://www.facebook.com/Sabor.Asi.Dance.Salsa.Victoria/ marked as irrelevant (LLM negative).
2025-06-18 14:18:53 [root] INFO: def parse(): Found 0 links on https://www.facebook.com/Sabor.Asi.Dance.Salsa.Victoria/
2025-06-18 14:18:53 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/Sabor.Asi.Dance.Salsa.Victoria/'
2025-06-18 14:18:53 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/Sabor.Asi.Dance.Salsa.Victoria/
2025-06-18 14:18:53 [root] INFO: def parse(): Found keywords for URL https://www.facebook.com/groups/841245344232320/: ['bachata', 'dance', 'kizomba', 'merengue', 'salsa', 'wcs']
2025-06-18 14:18:53 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.facebook.com/groups/841245344232320/
2025-06-18 14:18:53 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:18:53 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:18:53 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:18:56 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 14:18:56 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 620519 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 14:18:56 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 14:18:57 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 14:18:57 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 468208 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 14:18:57 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 14:18:57 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://www.facebook.com/groups/841245344232320/
2025-06-18 14:18:57 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/841245344232320/'
2025-06-18 14:18:57 [root] INFO: def parse(): URL https://www.facebook.com/groups/841245344232320/ marked as irrelevant (LLM negative).
2025-06-18 14:18:57 [root] INFO: def parse(): Found 0 links on https://www.facebook.com/groups/841245344232320/
2025-06-18 14:18:57 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/841245344232320/'
2025-06-18 14:18:57 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/groups/841245344232320/
2025-06-18 14:18:57 [root] INFO: def parse(): Found keywords for URL https://tangofestivals.net/events/victoria-tango-marathon-2/: ['argentine tango', 'dance', 'swing', 'tango']
2025-06-18 14:18:57 [root] INFO: def generate_prompt(): Generating prompt for URL: https://tangofestivals.net/events/victoria-tango-marathon-2/
2025-06-18 14:18:57 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:18:57 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:18:57 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:19:24 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:19:24 [root] INFO: query_llm(): Mistral response received: <!--Page generated by WP Super Cache v1.8.1 on 2025-06-18 20:53:40 -->
2025-06-18 14:19:24 [root] INFO: def extract_and_parse_json(): No valid events found in result.
2025-06-18 14:19:24 [root] INFO: write_url_to_db(): appended URL 'https://tangofestivals.net/events/victoria-tango-marathon-2/'
2025-06-18 14:19:24 [root] INFO: def parse(): URL https://tangofestivals.net/events/victoria-tango-marathon-2/ marked as irrelevant (LLM negative).
2025-06-18 14:19:24 [root] INFO: def parse(): Found 10 links on https://tangofestivals.net/events/victoria-tango-marathon-2/
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://tangofestivals.net/events/victoria-tango-marathon-2/ has never been seen before, processing it.
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://tangofestivals.net/events/victoria-tango-marathon-2/ has never been seen before, processing it.
2025-06-18 14:19:24 [root] INFO: write_url_to_db(): appended URL 'https://tangofestivals.net/events/victoria-tango-marathon-2/'
2025-06-18 14:19:24 [root] INFO: def parse(): Crawling next URL: https://tangofestivals.net/events/victoria-tango-marathon-2/
2025-06-18 14:19:24 [scrapy.extensions.logstats] INFO: Crawled 139 pages (at 6 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://alces.world/about-us/ was last seen as relevant, processing it.
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://alces.world/about-us/#values was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://alces.world/about-us/#values was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:19:24 [root] INFO: write_url_to_db(): appended URL 'https://alces.world/about-us/#values'
2025-06-18 14:19:24 [root] INFO: def parse(): Crawling next URL: https://alces.world/about-us/#values
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://www.google.ca/maps/place/2514+Bridge+St,+Victoria,+BC+V8T+5H3/@48.4358314,-123.375177,17z/data=!3m1!4b1!4m5!3m4!1s0x548f737db485e64f:0x2d281917422952de!8m2!3d48.4358314!4d-123.372983?hl=en has never been seen before, processing it.
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://www.google.ca/maps/place/2514+Bridge+St,+Victoria,+BC+V8T+5H3/@48.4358314,-123.375177,17z/data=!3m1!4b1!4m5!3m4!1s0x548f737db485e64f:0x2d281917422952de!8m2!3d48.4358314!4d-123.372983?hl=en has never been seen before, processing it.
2025-06-18 14:19:24 [root] INFO: write_url_to_db(): appended URL 'https://www.google.ca/maps/place/2514+Bridge+St,+Victoria,+BC+V8T+5H3/@48.4358314,-123.375177,17z/data=!3m1!4b1!4m5!3m4!1s0x548f737db485e64f:0x2d281917422952de!8m2!3d48.4358314!4d-123.372983?hl=en'
2025-06-18 14:19:24 [root] INFO: def parse(): Crawling next URL: https://www.google.ca/maps/place/2514+Bridge+St,+Victoria,+BC+V8T+5H3/@48.4358314,-123.375177,17z/data=!3m1!4b1!4m5!3m4!1s0x548f737db485e64f:0x2d281917422952de!8m2!3d48.4358314!4d-123.372983?hl=en
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://alces.world/about-us/#values was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://alces.world/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://alces.world/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 14:19:24 [root] INFO: write_url_to_db(): appended URL 'https://alces.world/'
2025-06-18 14:19:24 [root] INFO: def parse(): Crawling next URL: https://alces.world/
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://www.eventbrite.com/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://www.eventbrite.com/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:19:24 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/'
2025-06-18 14:19:24 [root] INFO: def parse(): Crawling next URL: https://www.eventbrite.com/
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://tangofestivals.net/location/ has never been seen before, processing it.
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://tangofestivals.net/location/ has never been seen before, processing it.
2025-06-18 14:19:24 [root] INFO: write_url_to_db(): appended URL 'https://tangofestivals.net/location/'
2025-06-18 14:19:24 [root] INFO: def parse(): Crawling next URL: https://tangofestivals.net/location/
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://tangofestivals.net/ has never been seen before, processing it.
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://tangofestivals.net/ has never been seen before, processing it.
2025-06-18 14:19:24 [root] INFO: write_url_to_db(): appended URL 'https://tangofestivals.net/'
2025-06-18 14:19:24 [root] INFO: def parse(): Crawling next URL: https://tangofestivals.net/
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://alces.world/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://alces.world/events/list/featured/?shortcode=758c7f2c was last seen as relevant, processing it.
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://alces.world/events/list/featured/?shortcode=758c7f2c was last seen as relevant, processing it.
2025-06-18 14:19:24 [root] INFO: write_url_to_db(): appended URL 'https://alces.world/events/list/featured/?shortcode=758c7f2c'
2025-06-18 14:19:24 [root] INFO: def parse(): Crawling next URL: https://alces.world/events/list/featured/?shortcode=758c7f2c
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://rollercoin.com/?r=kj1s38ir was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://rollercoin.com/?r=kj1s38ir was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 14:19:24 [root] INFO: write_url_to_db(): appended URL 'https://rollercoin.com/?r=kj1s38ir'
2025-06-18 14:19:24 [root] INFO: def parse(): Crawling next URL: https://rollercoin.com/?r=kj1s38ir
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://alces.world/6th-edition/ was last seen as relevant, processing it.
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://alces.world/6th-edition/ was last seen as relevant, processing it.
2025-06-18 14:19:24 [root] INFO: write_url_to_db(): appended URL 'https://alces.world/6th-edition/'
2025-06-18 14:19:24 [root] INFO: def parse(): Crawling next URL: https://alces.world/6th-edition/
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/signup/?referrer=%2Fmytickets was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/signup/?referrer=%2Fmytickets was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:19:24 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/signin/signup/?referrer=%2Fmytickets'
2025-06-18 14:19:24 [root] INFO: def parse(): Crawling next URL: https://www.eventbrite.com/signin/signup/?referrer=%2Fmytickets
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://tangofestivals.net/category/festival-experiences/ has never been seen before, processing it.
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://tangofestivals.net/category/festival-experiences/ has never been seen before, processing it.
2025-06-18 14:19:24 [root] INFO: write_url_to_db(): appended URL 'https://tangofestivals.net/category/festival-experiences/'
2025-06-18 14:19:24 [root] INFO: def parse(): Crawling next URL: https://tangofestivals.net/category/festival-experiences/
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://alces.world/6th-edition/ was last seen as relevant, processing it.
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/sell-tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/sell-tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:19:24 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/organizer/features/sell-tickets/'
2025-06-18 14:19:24 [root] INFO: def parse(): Crawling next URL: https://www.eventbrite.com/organizer/features/sell-tickets/
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://tangofestivals.net/category/festival-locations/ has never been seen before, processing it.
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://tangofestivals.net/category/festival-locations/ has never been seen before, processing it.
2025-06-18 14:19:24 [root] INFO: write_url_to_db(): appended URL 'https://tangofestivals.net/category/festival-locations/'
2025-06-18 14:19:24 [root] INFO: def parse(): Crawling next URL: https://tangofestivals.net/category/festival-locations/
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://tangofestivals.net/location/Argentina/ has never been seen before, processing it.
2025-06-18 14:19:24 [root] INFO: should_process_url: URL https://tangofestivals.net/location/Argentina/ has never been seen before, processing it.
2025-06-18 14:19:24 [root] INFO: write_url_to_db(): appended URL 'https://tangofestivals.net/location/Argentina/'
2025-06-18 14:19:24 [root] INFO: def parse(): Crawling next URL: https://tangofestivals.net/location/Argentina/
2025-06-18 14:19:24 [root] INFO: def parse(): Found keywords for URL https://www.instagram.com/bachatavictoria/p/DDX2ly9Tx5D/: ['bachata', 'balboa', 'dance', 'salsa', 'wcs']
2025-06-18 14:19:24 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.instagram.com/bachatavictoria/p/DDX2ly9Tx5D/
2025-06-18 14:19:24 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:19:24 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:19:24 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:19:26 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 14:19:26 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 460167 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 14:19:26 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 14:19:27 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 14:19:27 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 348301 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 14:19:27 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 14:19:27 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://www.instagram.com/bachatavictoria/p/DDX2ly9Tx5D/
2025-06-18 14:19:27 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/bachatavictoria/p/DDX2ly9Tx5D/'
2025-06-18 14:19:27 [root] INFO: def parse(): URL https://www.instagram.com/bachatavictoria/p/DDX2ly9Tx5D/ marked as irrelevant (LLM negative).
2025-06-18 14:19:27 [root] INFO: def parse(): Found 0 links on https://www.instagram.com/bachatavictoria/p/DDX2ly9Tx5D/
2025-06-18 14:19:27 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/bachatavictoria/p/DDX2ly9Tx5D/'
2025-06-18 14:19:27 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/bachatavictoria/p/DDX2ly9Tx5D/
2025-06-18 14:19:27 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/event-marketing-platform/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:19:27 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/event-marketing-platform/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:19:27 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/organizer/features/event-marketing-platform/'
2025-06-18 14:19:27 [root] INFO: def parse(): Crawling next URL: https://www.eventbrite.com/organizer/features/event-marketing-platform/
2025-06-18 14:19:27 [root] INFO: should_process_url: URL https://tangofestivals.net/blog/ has never been seen before, processing it.
2025-06-18 14:19:27 [root] INFO: should_process_url: URL https://tangofestivals.net/blog/ has never been seen before, processing it.
2025-06-18 14:19:27 [root] INFO: write_url_to_db(): appended URL 'https://tangofestivals.net/blog/'
2025-06-18 14:19:27 [root] INFO: def parse(): Crawling next URL: https://tangofestivals.net/blog/
2025-06-18 14:19:27 [root] INFO: should_process_url: URL https://www.eventbrite.com/cc/argentine-tango-classes-related-events-2881689 was last seen as not relevant but hit_ratio (2.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:19:27 [root] INFO: should_process_url: URL https://www.eventbrite.com/cc/argentine-tango-classes-related-events-2881689 was last seen as not relevant but hit_ratio (2.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:19:27 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/cc/argentine-tango-classes-related-events-2881689'
2025-06-18 14:19:27 [root] INFO: def parse(): Crawling next URL: https://www.eventbrite.com/cc/argentine-tango-classes-related-events-2881689
2025-06-18 14:19:27 [root] INFO: should_process_url: URL https://tangofestivals.net/location/United-States/ has never been seen before, processing it.
2025-06-18 14:19:27 [root] INFO: should_process_url: URL https://tangofestivals.net/location/United-States/ has never been seen before, processing it.
2025-06-18 14:19:27 [root] INFO: write_url_to_db(): appended URL 'https://tangofestivals.net/location/United-States/'
2025-06-18 14:19:27 [root] INFO: def parse(): Crawling next URL: https://tangofestivals.net/location/United-States/
2025-06-18 14:19:27 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/event-payment/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:19:27 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/event-payment/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:19:27 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/organizer/features/event-payment/'
2025-06-18 14:19:27 [root] INFO: def parse(): Crawling next URL: https://www.eventbrite.com/organizer/features/event-payment/
2025-06-18 14:19:27 [root] INFO: should_process_url: URL https://tangofestivals.net/category/festival-guides/ has never been seen before, processing it.
2025-06-18 14:19:27 [root] INFO: should_process_url: URL https://tangofestivals.net/category/festival-guides/ has never been seen before, processing it.
2025-06-18 14:19:27 [root] INFO: write_url_to_db(): appended URL 'https://tangofestivals.net/category/festival-guides/'
2025-06-18 14:19:27 [root] INFO: def parse(): Crawling next URL: https://tangofestivals.net/category/festival-guides/
2025-06-18 14:19:28 [root] INFO: def parse(): Found keywords for URL https://www.facebook.com/groups/alivetango/: ['dance', 'tango', 'wcs']
2025-06-18 14:19:28 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.facebook.com/groups/alivetango/
2025-06-18 14:19:28 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:19:28 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:19:28 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:19:30 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 14:19:30 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 602220 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 14:19:30 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 14:19:32 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 14:19:32 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 454849 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 14:19:32 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 14:19:32 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://www.facebook.com/groups/alivetango/
2025-06-18 14:19:32 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/alivetango/'
2025-06-18 14:19:32 [root] INFO: def parse(): URL https://www.facebook.com/groups/alivetango/ marked as irrelevant (LLM negative).
2025-06-18 14:19:32 [root] INFO: def parse(): Found 0 links on https://www.facebook.com/groups/alivetango/
2025-06-18 14:19:32 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/alivetango/'
2025-06-18 14:19:32 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/groups/alivetango/
2025-06-18 14:19:32 [root] INFO: def parse(): Found keywords for URL https://alces.world/event/victoria-international-kizomba-festival-6th-edition/: ['dance', 'kizomba', 'semba', 'urban kiz']
2025-06-18 14:19:32 [root] INFO: def generate_prompt(): Generating prompt for URL: https://alces.world/event/victoria-international-kizomba-festival-6th-edition/
2025-06-18 14:19:32 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:19:32 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:19:32 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:20:16 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:20:16 [root] INFO: query_llm(): Mistral response received: [
    {
    "source": "https://alces.world/event/victoria-international-kizomba-festival-6th-edition/",
    "dance_style": "semba, kizomba, urban kiz, tarraxinha, tarraxo, douceur, afro beat, afro house, kuduro",
    "url": "",
    "event_type": "social dance",
    "event_name": "Victoria International Kizomba Festival 6th Edition",
    "day_of_week": "Wednesday",
    "start_date": "2025-04-17",
    "end_date": "2025-04-21",
    "start_time": "21:00",
    "end_time": "07:00",
    "price": "$138.72",
    "location": "Victoria Convention Centre, 720 Douglas Street, Victoria, British Columbia, V8W 3M7, Canada",
    "description": "What to expect? Locally and Internationally renowned instructors, teaching Semba, Kizomba, Urban Kiz, Tarraxinha, Tarraxo, Douceur, Afro Beat, Afro House, Kuduro and More!"
    },
    {
    "source": "https://alces.world/event/victoria-international-kizomba-festival-6th-edition/",
    "dance_style": "kizomba, urban kiz, tarraxinha, tarraxo, douceur",
    "url": "",
    "event_type": "social dance",
    "event_name": "Kizomba Practica Thursdays",
    "day_of_week": "Thursday",
    "start_date": "2025-04-17",
    "end_date": "2025-04-17",
    "start_time": "null",
    "end_time": "null",
    "price": "",
    "location": "",
    "description": ""
    },
    {
    "source": "https://alces.world/event/victoria-international-kizomba-festival-6th-edition/",
    "dance_style": "kizomba, urban kiz, tarraxinha, tarraxo, douceur",
    "url": "",
    "event_type": "social dance",
    "event_name": "Kizomba Practica Thursdays",
    "day_of_week": "Thursday",
    "start_date": "2025-04-24",
    "end_date": "2025-04-24",
    "start_time": "null",
    "end_time": "null",
    "price": "",
    "location": "",
    "description": ""
    }
]
2025-06-18 14:20:16 [root] INFO: def extract_and_parse_json(): for url https://alces.world/event/victoria-international-kizomba-festival-6th-edition/, 
Cleaned JSON ready for parsing:
[
    {
    "source": "https://alces.world/event/victoria-international-kizomba-festival-6th-edition/",
    "dance_style": "semba, kizomba, urban kiz, tarraxinha, tarraxo, douceur, afro beat, afro house, kuduro",
    "url": "",
    "event_type": "social dance",
    "event_name": "Victoria International Kizomba Festival 6th Edition",
    "day_of_week": "Wednesday",
    "start_date": "2025-04-17",
    "end_date": "2025-04-21",
    "start_time": "21:00",
    "end_time": "07:00",
    "price": "$138.72",
    "location": "Victoria Convention Centre, 720 Douglas Street, Victoria, British Columbia, V8W 3M7, Canada",
    "description": "What to expect? Locally and Internationally renowned instructors, teaching Semba, Kizomba, Urban Kiz, Tarraxinha, Tarraxo, Douceur, Afro Beat, Afro House, Kuduro and More!"
    },
    {
    "source": "https://alces.world/event/victoria-international-kizomba-festival-6th-edition/",
    "dance_style": "kizomba, urban kiz, tarraxinha, tarraxo, douceur",
    "url": "",
    "event_type": "social dance",
    "event_name": "Kizomba Practica Thursdays",
    "day_of_week": "Thursday",
    "start_date": "2025-04-17",
    "end_date": "2025-04-17",
    "start_time": "null",
    "end_time": "null",
    "price": "",
    "location": "",
    "description": ""
    },
    {
    "source": "https://alces.world/event/victoria-international-kizomba-festival-6th-edition/",
    "dance_style": "kizomba, urban kiz, tarraxinha, tarraxo, douceur",
    "url": "",
    "event_type": "social dance",
    "event_name": "Kizomba Practica Thursdays",
    "day_of_week": "Thursday",
    "start_date": "2025-04-24",
    "end_date": "2025-04-24",
    "start_time": "null",
    "end_time": "null",
    "price": "",
    "location": "",
    "description": ""
    }
]
2025-06-18 14:20:16 [root] INFO: def clean_up_address(): Starting with events_df shape: (3, 14)
2025-06-18 14:20:16 [root] INFO: def clean_up_address(): Processing location 'Victoria Convention Centre, 720 Douglas Street, Victoria, British Columbia, V8W 3M7, Canada' (event_id: None)
2025-06-18 14:20:16 [root] INFO: def clean_up_address(): Updated event None with address_id 19777 using DB match
2025-06-18 14:20:16 [root] INFO: write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 14:20:16 [root] INFO: write_url_to_db(): appended URL 'https://alces.world/event/victoria-international-kizomba-festival-6th-edition/'
2025-06-18 14:20:16 [root] INFO: def process_llm_response: URL https://alces.world/event/victoria-international-kizomba-festival-6th-edition/ marked as relevant with events written to the database.
2025-06-18 14:20:16 [root] INFO: write_url_to_db(): appended URL 'https://alces.world/event/victoria-international-kizomba-festival-6th-edition/'
2025-06-18 14:20:16 [root] INFO: def parse(): URL https://alces.world/event/victoria-international-kizomba-festival-6th-edition/ marked as relevant (LLM positive).
2025-06-18 14:20:16 [root] INFO: def parse(): Found 10 links on https://alces.world/event/victoria-international-kizomba-festival-6th-edition/
2025-06-18 14:20:16 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.google.com/maps/embed/v1/place?key=AIzaSyDNsicAsP6-VuGtAb1O9riI3oc_NOb7IOU&q=720+Douglas+Street+Victoria+British+Columbia+V8W+3M7+Canada+&zoom=10, URL: https://alces.world/event/victoria-international-kizomba-festival-6th-edition/, source: Victoria International Kizomba Festival 6th Edition - Afro-Latin ..., keywords: kizomba
2025-06-18 14:20:16 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %y&fm_镧
2025-06-18 14:20:16 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.google.com/maps/embed/v1/place?key=AIzaSyDNsicAsP6-VuGtAb1O9riI3oc_NOb7IOU&q=720+Douglas+Street+Victoria+British+Columbia+V8W+3M7+Canada+&zoom=10
2025-06-18 14:20:16 [root] INFO: write_url_to_db(): appended URL 'https://www.google.com/maps/embed/v1/place?key=AIzaSyDNsicAsP6-VuGtAb1O9riI3oc_NOb7IOU&q=720+Douglas+Street+Victoria+British+Columbia+V8W+3M7+Canada+&zoom=10'
2025-06-18 14:20:16 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/events/758501768607647/?acontext=%7B%22event_action_history%22%3A%5B%7B%22surface%22%3A%22external%22%7D%2C%7B%22mechanism%22%3A%22your_upcoming_events_unit%22%2C%22surface%22%3A%22bookmark%22%7D%5D%2C%22ref_notif_type%22%3Anull%7D'
2025-06-18 14:20:16 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/events/758501768607647/?acontext=%7B%22event_action_history%22%3A%5B%7B%22surface%22%3A%22external%22%7D%2C%7B%22mechanism%22%3A%22your_upcoming_events_unit%22%2C%22surface%22%3A%22bookmark%22%7D%5D%2C%22ref_notif_type%22%3Anull%7D
2025-06-18 14:20:16 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/vic_international_kizomba_fest/'
2025-06-18 14:20:16 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/vic_international_kizomba_fest/
2025-06-18 14:20:16 [root] INFO: should_process_url: URL https://alces.world/about-us/#volunteer was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:20:16 [root] INFO: should_process_url: URL https://alces.world/event/victoria-international-kizomba-festival-6th-edition/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 14:20:16 [root] INFO: should_process_url: URL https://alces.world/event/victoria-international-kizomba-festival-6th-edition/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 14:20:16 [root] INFO: write_url_to_db(): appended URL 'https://alces.world/event/victoria-international-kizomba-festival-6th-edition/'
2025-06-18 14:20:16 [root] INFO: def parse(): Crawling next URL: https://alces.world/event/victoria-international-kizomba-festival-6th-edition/
2025-06-18 14:20:16 [root] INFO: def parse(): Found keywords for URL https://www.facebook.com/BaKiSaDance/: ['bachata', 'dance', 'kizomba', 'salsa', 'wcs']
2025-06-18 14:20:16 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.facebook.com/BaKiSaDance/
2025-06-18 14:20:16 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:20:16 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:20:16 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:20:18 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 14:20:18 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 589271 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 14:20:18 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 14:20:20 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 14:20:20 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 446112 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 14:20:20 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 14:20:20 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://www.facebook.com/BaKiSaDance/
2025-06-18 14:20:20 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/BaKiSaDance/'
2025-06-18 14:20:20 [root] INFO: def parse(): URL https://www.facebook.com/BaKiSaDance/ marked as irrelevant (LLM negative).
2025-06-18 14:20:20 [root] INFO: def parse(): Found 0 links on https://www.facebook.com/BaKiSaDance/
2025-06-18 14:20:20 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/BaKiSaDance/'
2025-06-18 14:20:20 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/BaKiSaDance/
2025-06-18 14:20:20 [root] INFO: def parse(): Found keywords for URL https://www.facebook.com/groups/3158235040/: ['bachata', 'dance', 'kizomba', 'salsa', 'wcs']
2025-06-18 14:20:20 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.facebook.com/groups/3158235040/
2025-06-18 14:20:20 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:20:20 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:20:20 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:20:23 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 14:20:23 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 567675 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 14:20:23 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 14:20:24 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 14:20:24 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 425991 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 14:20:24 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 14:20:24 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://www.facebook.com/groups/3158235040/
2025-06-18 14:20:24 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/3158235040/'
2025-06-18 14:20:24 [root] INFO: def parse(): URL https://www.facebook.com/groups/3158235040/ marked as irrelevant (LLM negative).
2025-06-18 14:20:24 [root] INFO: def parse(): Found 0 links on https://www.facebook.com/groups/3158235040/
2025-06-18 14:20:24 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/3158235040/'
2025-06-18 14:20:24 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/groups/3158235040/
2025-06-18 14:20:24 [root] INFO: def parse(): Found keywords for URL https://www.instagram.com/vic_international_kizomba_fest/?hl=en: ['balboa', 'dance', 'kizomba', 'wcs']
2025-06-18 14:20:24 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.instagram.com/vic_international_kizomba_fest/?hl=en
2025-06-18 14:20:24 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:20:24 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:20:24 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:20:27 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 14:20:27 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 405429 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 14:20:27 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 14:20:28 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 14:20:28 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 309198 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 14:20:28 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 14:20:28 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://www.instagram.com/vic_international_kizomba_fest/?hl=en
2025-06-18 14:20:28 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/vic_international_kizomba_fest/?hl=en'
2025-06-18 14:20:28 [root] INFO: def parse(): URL https://www.instagram.com/vic_international_kizomba_fest/?hl=en marked as irrelevant (LLM negative).
2025-06-18 14:20:28 [root] INFO: def parse(): Found 0 links on https://www.instagram.com/vic_international_kizomba_fest/?hl=en
2025-06-18 14:20:28 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/vic_international_kizomba_fest/?hl=en'
2025-06-18 14:20:28 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/vic_international_kizomba_fest/?hl=en
2025-06-18 14:20:28 [root] INFO: should_process_url: URL https://www.eventbrite.com/d/local/events/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:20:28 [root] INFO: should_process_url: URL https://www.eventbrite.com/d/local/events/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:20:28 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/d/local/events/'
2025-06-18 14:20:28 [root] INFO: def parse(): Crawling next URL: https://www.eventbrite.com/d/local/events/
2025-06-18 14:20:28 [root] INFO: should_process_url: URL https://alces.world/about-us/ was last seen as relevant, processing it.
2025-06-18 14:20:28 [root] INFO: should_process_url: URL https://alces.world/about-us/#values was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:20:28 [root] INFO: should_process_url: URL https://alces.world/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 14:20:28 [root] INFO: should_process_url: URL https://alces.world/6th-edition/ was last seen as relevant, processing it.
2025-06-18 14:20:28 [scrapy.extensions.logstats] INFO: Crawled 139 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 14:20:28 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/?referrer=%2Fcc%2Fargentine-tango-classes-related-events-2881689 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:20:28 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/?referrer=%2Fcc%2Fargentine-tango-classes-related-events-2881689 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:20:28 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/signin/?referrer=%2Fcc%2Fargentine-tango-classes-related-events-2881689'
2025-06-18 14:20:28 [root] INFO: def parse(): Crawling next URL: https://www.eventbrite.com/signin/?referrer=%2Fcc%2Fargentine-tango-classes-related-events-2881689
2025-06-18 14:20:28 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/eventbrite-ads/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:20:28 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/eventbrite-ads/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:20:28 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/organizer/features/eventbrite-ads/'
2025-06-18 14:20:28 [root] INFO: def parse(): Crawling next URL: https://www.eventbrite.com/organizer/features/eventbrite-ads/
2025-06-18 14:20:28 [root] INFO: def parse(): Found keywords for URL https://www.eventbrite.com/d/canada--victoria/salsa/: ['bachata', 'dance', 'kizomba', 'live music', 'merengue', 'salsa', 'tango']
2025-06-18 14:20:28 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.eventbrite.com/d/canada--victoria/salsa/
2025-06-18 14:20:28 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:20:28 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:20:28 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:20:30 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 14:20:30 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 262124 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 14:20:30 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 14:21:30 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:21:30 [root] WARNING: query_llm(): OpenAI returned no response.
2025-06-18 14:21:30 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://www.eventbrite.com/d/canada--victoria/salsa/
2025-06-18 14:21:30 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/d/canada--victoria/salsa/'
2025-06-18 14:21:30 [root] INFO: def parse(): URL https://www.eventbrite.com/d/canada--victoria/salsa/ marked as irrelevant (LLM negative).
2025-06-18 14:21:30 [root] INFO: def parse(): Found 10 links on https://www.eventbrite.com/d/canada--victoria/salsa/
2025-06-18 14:21:30 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ, URL: https://www.eventbrite.com/d/canada--victoria/salsa/, source: Discover Salsa Events & Activities in Victoria, Canada | Eventbrite, keywords: bachata
2025-06-18 14:21:30 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 14:21:30 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ
2025-06-18 14:21:30 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ'
2025-06-18 14:21:30 [root] INFO: should_process_url: URL https://www.eventbrite.com/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:21:30 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/signup/?referrer=%2Fmytickets was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:21:30 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/sell-tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:21:30 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/eventbrite-ads/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:21:30 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/event-marketing-platform/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:21:30 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/event-payment/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:21:30 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/signup/?referrer=%2Fd%2Fcanada--victoria%2Fsalsa%2F was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:21:30 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/signup/?referrer=%2Fd%2Fcanada--victoria%2Fsalsa%2F was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:21:31 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/signin/signup/?referrer=%2Fd%2Fcanada--victoria%2Fsalsa%2F'
2025-06-18 14:21:31 [root] INFO: def parse(): Crawling next URL: https://www.eventbrite.com/signin/signup/?referrer=%2Fd%2Fcanada--victoria%2Fsalsa%2F
2025-06-18 14:21:31 [root] INFO: def parse(): Found keywords for URL https://thedancestudiofinder.com/dance-studios/locations/british-columbia/: ['cha cha', 'dance', 'east coast swing', 'foxtrot', 'merengue', 'quickstep', 'rumba', 'salsa', 'samba', 'swing', 'tango', 'waltz']
2025-06-18 14:21:31 [root] INFO: def generate_prompt(): Generating prompt for URL: https://thedancestudiofinder.com/dance-studios/locations/british-columbia/
2025-06-18 14:21:31 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:21:31 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:21:31 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:21:32 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 14:21:32 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 144422 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 14:21:32 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 14:21:40 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:21:40 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 14:21:40 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 14:21:40 [root] INFO: write_url_to_db(): appended URL 'https://thedancestudiofinder.com/dance-studios/locations/british-columbia/'
2025-06-18 14:21:40 [root] INFO: def parse(): URL https://thedancestudiofinder.com/dance-studios/locations/british-columbia/ marked as irrelevant (LLM negative).
2025-06-18 14:21:40 [root] INFO: def parse(): Found 10 links on https://thedancestudiofinder.com/dance-studios/locations/british-columbia/
2025-06-18 14:21:40 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/contact-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:21:40 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/dance-studios/locations/british-columbia/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:21:40 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/dance-studios/locations/british-columbia/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:21:40 [root] INFO: write_url_to_db(): appended URL 'https://thedancestudiofinder.com/dance-studios/locations/british-columbia/'
2025-06-18 14:21:40 [root] INFO: def parse(): Crawling next URL: https://thedancestudiofinder.com/dance-studios/locations/british-columbia/
2025-06-18 14:21:40 [root] INFO: def parse(): Found keywords for URL https://www.foxtrotwine.com/: ['foxtrot']
2025-06-18 14:21:40 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.foxtrotwine.com/
2025-06-18 14:21:40 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:21:40 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:21:40 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:22:08 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:22:08 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "Foxtrot Vineyards",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Opening",
        "day_of_week": "Wednesday",
        "start_date": "2025-05-29",
        "end_date": "2025-05-29",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "1201 Gawne Road, Naramata, BC, V0H 1N1",
        "description": "Exciting new beginnings are on their way! Opening May 29, 2025. Foxtrot Vineyards is a boutique winery focused on crafting terroir-driven Pinot Noir and premium Chardonnay. Foxtrot has built a reputation as the premier producer of age-worthy Pinot Noir in the Okanagan Valley, BC by showcasing grapes grown from 24-year-old own-rooted vines in its estate vineyard — demonstrating what the Naramata Bench sub-region can achieve when a pure and subtle hand is applied."
    }
]
2025-06-18 14:22:08 [root] INFO: def extract_and_parse_json(): for url https://www.foxtrotwine.com/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Foxtrot Vineyards",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Opening",
        "day_of_week": "Wednesday",
        "start_date": "2025-05-29",
        "end_date": "2025-05-29",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "1201 Gawne Road, Naramata, BC, V0H 1N1",
        "description": "Exciting new beginnings are on their way! Opening May 29, 2025. Foxtrot Vineyards is a boutique winery focused on crafting terroir-driven Pinot Noir and premium Chardonnay. Foxtrot has built a reputation as the premier producer of age-worthy Pinot Noir in the Okanagan Valley, BC by showcasing grapes grown from 24-year-old own-rooted vines in its estate vineyard — demonstrating what the Naramata Bench sub-region can achieve when a pure and subtle hand is applied."
    }
]
2025-06-18 14:22:08 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 14:22:08 [root] INFO: def clean_up_address(): Processing location '1201 Gawne Road, Naramata, BC, V0H 1N1' (event_id: None)
2025-06-18 14:22:08 [root] INFO: def clean_up_address(): Updated event None with address_id 8536 using DB match
2025-06-18 14:22:08 [root] INFO: write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 14:22:08 [root] INFO: write_url_to_db(): appended URL 'https://www.foxtrotwine.com/'
2025-06-18 14:22:08 [root] INFO: def process_llm_response: URL https://www.foxtrotwine.com/ marked as relevant with events written to the database.
2025-06-18 14:22:08 [root] INFO: write_url_to_db(): appended URL 'https://www.foxtrotwine.com/'
2025-06-18 14:22:08 [root] INFO: def parse(): URL https://www.foxtrotwine.com/ marked as relevant (LLM positive).
2025-06-18 14:22:08 [root] INFO: def parse(): Found 10 links on https://www.foxtrotwine.com/
2025-06-18 14:22:08 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/wp-content/uploads/2022/11/Black-White-Minimalist-Business-Logo.png was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:22:08 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/wp-content/uploads/2022/11/Black-White-Minimalist-Business-Logo.png was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:22:08 [root] INFO: write_url_to_db(): appended URL 'https://www.foxtrotwine.com/wp-content/uploads/2022/11/Black-White-Minimalist-Business-Logo.png'
2025-06-18 14:22:08 [root] INFO: def parse(): Crawling next URL: https://www.foxtrotwine.com/wp-content/uploads/2022/11/Black-White-Minimalist-Business-Logo.png
2025-06-18 14:22:08 [scrapy.extensions.logstats] INFO: Crawled 139 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 14:22:08 [root] INFO: should_process_url: URL https://www.eventbrite.com/d/local/events/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:22:08 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/?referrer=%2Fd%2Fcanada--victoria%2Fsalsa%2F was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:22:08 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/?referrer=%2Fd%2Fcanada--victoria%2Fsalsa%2F was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:22:08 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/signin/?referrer=%2Fd%2Fcanada--victoria%2Fsalsa%2F'
2025-06-18 14:22:08 [root] INFO: def parse(): Crawling next URL: https://www.eventbrite.com/signin/?referrer=%2Fd%2Fcanada--victoria%2Fsalsa%2F
2025-06-18 14:22:08 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/blog/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:22:08 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/my-account/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:22:08 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/join/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:22:08 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:22:08 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/about-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:22:08 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/dance-studios/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:22:08 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/our-philosophy/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:22:08 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/our-philosophy/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:22:08 [root] INFO: write_url_to_db(): appended URL 'https://www.foxtrotwine.com/our-philosophy/'
2025-06-18 14:22:08 [root] INFO: def parse(): Crawling next URL: https://www.foxtrotwine.com/our-philosophy/
2025-06-18 14:22:08 [root] INFO: should_process_url: URL https://www.eventbrite.com/d/canada--victoria/salsa/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 14:22:08 [root] INFO: should_process_url: URL https://www.eventbrite.com/d/canada--victoria/salsa/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 14:22:08 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/d/canada--victoria/salsa/'
2025-06-18 14:22:08 [root] INFO: def parse(): Crawling next URL: https://www.eventbrite.com/d/canada--victoria/salsa/
2025-06-18 14:22:08 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 14:22:08 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 14:22:08 [root] INFO: write_url_to_db(): appended URL 'https://www.foxtrotwine.com/'
2025-06-18 14:22:08 [root] INFO: def parse(): Crawling next URL: https://www.foxtrotwine.com/
2025-06-18 14:22:08 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/the-story-behind-the-label/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:22:08 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/the-story-behind-the-label/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:22:08 [root] INFO: write_url_to_db(): appended URL 'https://www.foxtrotwine.com/the-story-behind-the-label/'
2025-06-18 14:22:08 [root] INFO: def parse(): Crawling next URL: https://www.foxtrotwine.com/the-story-behind-the-label/
2025-06-18 14:22:08 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/contact-us/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:22:08 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/contact-us/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:22:08 [root] INFO: write_url_to_db(): appended URL 'https://www.foxtrotwine.com/contact-us/'
2025-06-18 14:22:08 [root] INFO: def parse(): Crawling next URL: https://www.foxtrotwine.com/contact-us/
2025-06-18 14:22:08 [root] INFO: should_process_url: URL http://eepurl.com/hRLq6H was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:22:08 [root] INFO: should_process_url: URL http://eepurl.com/hRLq6H was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:22:08 [root] INFO: write_url_to_db(): appended URL 'http://eepurl.com/hRLq6H'
2025-06-18 14:22:08 [root] INFO: def parse(): Crawling next URL: http://eepurl.com/hRLq6H
2025-06-18 14:22:08 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/club/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:22:08 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/club/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:22:08 [root] INFO: write_url_to_db(): appended URL 'https://www.foxtrotwine.com/club/'
2025-06-18 14:22:08 [root] INFO: def parse(): Crawling next URL: https://www.foxtrotwine.com/club/
2025-06-18 14:22:08 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/category/uncategorized/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:22:08 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/category/uncategorized/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:22:08 [root] INFO: write_url_to_db(): appended URL 'https://www.foxtrotwine.com/category/uncategorized/'
2025-06-18 14:22:08 [root] INFO: def parse(): Crawling next URL: https://www.foxtrotwine.com/category/uncategorized/
2025-06-18 14:22:08 [root] INFO: should_process_url: URL https://calendly.com/tastingexperience/tasting-reservation was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:22:08 [root] INFO: should_process_url: URL https://calendly.com/tastingexperience/tasting-reservation was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:22:08 [root] INFO: write_url_to_db(): appended URL 'https://calendly.com/tastingexperience/tasting-reservation'
2025-06-18 14:22:08 [root] INFO: def parse(): Crawling next URL: https://calendly.com/tastingexperience/tasting-reservation
2025-06-18 14:22:08 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/visit/ was last seen as relevant, processing it.
2025-06-18 14:22:08 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/visit/ was last seen as relevant, processing it.
2025-06-18 14:22:08 [root] INFO: write_url_to_db(): appended URL 'https://www.foxtrotwine.com/visit/'
2025-06-18 14:22:08 [root] INFO: def parse(): Crawling next URL: https://www.foxtrotwine.com/visit/
2025-06-18 14:22:08 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <403 https://rollercoin.com/?r=kj1s38ir>: HTTP status code is not handled or not allowed
2025-06-18 14:22:08 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/signin/signup/?referrer=%2Fmytickets'
2025-06-18 14:22:08 [root] INFO: def parse(): URL https://www.eventbrite.com/signin/signup/?referrer=%2Fmytickets marked as irrelevant (no keywords).
2025-06-18 14:22:08 [root] INFO: def parse(): Found 0 links on https://www.eventbrite.com/signin/signup/?referrer=%2Fmytickets
2025-06-18 14:22:08 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ, URL: https://www.eventbrite.com/signin/signup/?referrer=%2Fmytickets, source: Argentine tango classes & related events | Eventbrite, keywords: argentine tango
2025-06-18 14:22:08 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 14:22:08 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ
2025-06-18 14:22:08 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ'
2025-06-18 14:22:08 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/signup/?referrer=%2Fmytickets was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:22:08 [root] INFO: def parse(): Found keywords for URL https://www.eventbrite.com/signin/?referrer=%2Fcc%2Fargentine-tango-classes-related-events-2881689: ['tango']
2025-06-18 14:22:08 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.eventbrite.com/signin/?referrer=%2Fcc%2Fargentine-tango-classes-related-events-2881689
2025-06-18 14:22:08 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:22:08 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:22:08 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:22:13 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:22:13 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 14:22:13 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 14:22:13 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/signin/?referrer=%2Fcc%2Fargentine-tango-classes-related-events-2881689'
2025-06-18 14:22:13 [root] INFO: def parse(): URL https://www.eventbrite.com/signin/?referrer=%2Fcc%2Fargentine-tango-classes-related-events-2881689 marked as irrelevant (LLM negative).
2025-06-18 14:22:13 [root] INFO: def parse(): Found 0 links on https://www.eventbrite.com/signin/?referrer=%2Fcc%2Fargentine-tango-classes-related-events-2881689
2025-06-18 14:22:13 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ, URL: https://www.eventbrite.com/signin/?referrer=%2Fcc%2Fargentine-tango-classes-related-events-2881689, source: Argentine tango classes & related events | Eventbrite, keywords: argentine tango
2025-06-18 14:22:13 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 14:22:13 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ
2025-06-18 14:22:13 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ'
2025-06-18 14:22:13 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/?referrer=%2Fcc%2Fargentine-tango-classes-related-events-2881689 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:22:13 [root] INFO: def parse(): Found keywords for URL https://tangofestivals.net/category/festival-guides/: ['swing', 'tango']
2025-06-18 14:22:13 [root] INFO: def generate_prompt(): Generating prompt for URL: https://tangofestivals.net/category/festival-guides/
2025-06-18 14:22:13 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:22:13 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:22:13 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:22:36 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:22:36 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 14:22:36 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 14:22:36 [root] INFO: write_url_to_db(): appended URL 'https://tangofestivals.net/category/festival-guides/'
2025-06-18 14:22:36 [root] INFO: def parse(): URL https://tangofestivals.net/category/festival-guides/ marked as irrelevant (LLM negative).
2025-06-18 14:22:36 [root] INFO: def parse(): Found 10 links on https://tangofestivals.net/category/festival-guides/
2025-06-18 14:22:36 [root] INFO: should_process_url: URL https://tangofestivals.net/location/ has never been seen before, processing it.
2025-06-18 14:22:36 [root] INFO: should_process_url: URL https://tangofestivals.net/ has never been seen before, processing it.
2025-06-18 14:22:36 [root] INFO: should_process_url: URL https://tangofestivals.net/category/festival-experiences/ has never been seen before, processing it.
2025-06-18 14:22:36 [root] INFO: should_process_url: URL https://tangofestivals.net/category/festival-locations/ has never been seen before, processing it.
2025-06-18 14:22:36 [root] INFO: should_process_url: URL https://tangofestivals.net/location/Argentina/ has never been seen before, processing it.
2025-06-18 14:22:36 [root] INFO: should_process_url: URL https://tangofestivals.net/blog/ has never been seen before, processing it.
2025-06-18 14:22:36 [root] INFO: should_process_url: URL https://tangofestivals.net/location/United-States/ has never been seen before, processing it.
2025-06-18 14:22:36 [root] INFO: should_process_url: URL https://tangofestivals.net/category/festival-guides/ has never been seen before, processing it.
2025-06-18 14:22:36 [root] INFO: def parse(): Found keywords for URL https://tangofestivals.net/category/festival-locations/: ['dance', 'milonga', 'swing', 'tango']
2025-06-18 14:22:36 [root] INFO: def generate_prompt(): Generating prompt for URL: https://tangofestivals.net/category/festival-locations/
2025-06-18 14:22:36 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:22:36 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:22:36 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:37:37 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 504 Gateway Timeout"
2025-06-18 14:37:37 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 504
{
  "message":"The upstream server is timing out",
  "request_id":"3db782088c82f001586049658180eb66"
}
2025-06-18 14:37:37 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 14:37:43 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:37:43 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 14:37:43 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 14:37:43 [root] INFO: write_url_to_db(): appended URL 'https://tangofestivals.net/category/festival-locations/'
2025-06-18 14:37:43 [root] INFO: def parse(): URL https://tangofestivals.net/category/festival-locations/ marked as irrelevant (LLM negative).
2025-06-18 14:37:43 [root] INFO: def parse(): Found 10 links on https://tangofestivals.net/category/festival-locations/
2025-06-18 14:37:43 [root] INFO: should_process_url: URL https://tangofestivals.net/location/ has never been seen before, processing it.
2025-06-18 14:37:43 [root] INFO: should_process_url: URL https://tangofestivals.net/ has never been seen before, processing it.
2025-06-18 14:37:43 [root] INFO: should_process_url: URL https://tangofestivals.net/category/festival-experiences/ has never been seen before, processing it.
2025-06-18 14:37:43 [root] INFO: should_process_url: URL https://tangofestivals.net/category/festival-locations/ has never been seen before, processing it.
2025-06-18 14:37:43 [root] INFO: should_process_url: URL https://tangofestivals.net/location/Argentina/ has never been seen before, processing it.
2025-06-18 14:37:43 [root] INFO: should_process_url: URL https://tangofestivals.net/blog/ has never been seen before, processing it.
2025-06-18 14:37:43 [root] INFO: should_process_url: URL https://tangofestivals.net/location/United-States/ has never been seen before, processing it.
2025-06-18 14:37:43 [root] INFO: should_process_url: URL https://tangofestivals.net/category/festival-guides/ has never been seen before, processing it.
2025-06-18 14:37:43 [root] INFO: def parse(): Found keywords for URL https://alces.world/6th-edition/: ['bachata', 'dance', 'kizomba', 'urban kiz']
2025-06-18 14:37:43 [root] INFO: def generate_prompt(): Generating prompt for URL: https://alces.world/6th-edition/
2025-06-18 14:37:43 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:37:43 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:37:43 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:39:23 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:39:23 [root] INFO: query_llm(): Mistral response received: [
	{
		"source": "https://alces.world/6th-edition/",
		"dance_style": "kizomba, urban kiz",
		"url": "",
		"event_type": "social dance",
		"event_name": "Dance Kizomba in Victoria, BC",
		"day_of_week": "Thursday",
		"start_date": "2025-04-17",
		"end_date": "2025-04-17",
		"start_time": "20:00",
		"end_time": "00:00",
		"price": "",
		"location": "104-845 Burdett Avenue, Victoria, BC V8W 1B3",
		"description": "Event is part of the VIKF 6th Edition Schedule"
	},
	{
		"source": "https://alces.world/6th-edition/",
		"dance_style": "bachata",
		"url": "",
		"event_type": "social dance",
		"event_name": "Dance Bachata in Victoria, BC",
		"day_of_week": "Friday",
		"start_date": "2025-04-18",
		"end_date": "2025-04-18",
		"start_time": "20:00",
		"end_time": "00:00",
		"price": "",
		"location": "104-845 Burdett Avenue, Victoria, BC V8W 1B3",
		"description": "Event is part of the VIKF 6th Edition Schedule"
	},
	{
		"source": "https://alces.world/6th-edition/",
		"dance_style": "kizomba, urban kiz",
		"url": "",
		"event_type": "social dance",
		"event_name": "Dance Kizomba in Victoria, BC",
		"day_of_week": "Friday",
		"start_date": "2025-04-18",
		"end_date": "2025-04-18",
		"start_time": "20:00",
		"end_time": "00:00",
		"price": "",
		"location": "104-845 Burdett Avenue, Victoria, BC V8W 1B3",
		"description": "Event is part of the VIKF 6th Edition Schedule"
	},
	{
		"source": "https://alces.world/6th-edition/",
		"dance_style": "bachata",
		"url": "",
		"event_type": "social dance",
		"event_name": "Dance Bachata in Victoria, BC",
		"day_of_week": "Saturday",
		"start_date": "2025-04-19",
		"end_date": "2025-04-19",
		"start_time": "20:00",
		"end_time": "00:00",
		"price": "",
		"location": "104-845 Burdett Avenue, Victoria, BC V8W 1B3",
		"description": "Event is part of the VIKF 6th Edition Schedule"
	},
	{
		"source": "https://alces.world/6th-edition/",
		"dance_style": "kizomba, urban kiz",
		"url": "",
		"event_type": "social dance",
		"event_name": "Dance Kizomba in Victoria, BC",
		"day_of_week": "Saturday",
		"start_date": "2025-04-19",
		"end_date": "2025-04-19",
		"start_time": "20:00",
		"end_time": "00:00",
		"price": "",
		"location": "104-845 Burdett Avenue, Victoria, BC V8W 1B3",
		"description": "Event is part of the VIKF 6th Edition Schedule"
	},
	{
		"source": "https://alces.world/6th-edition/",
		"dance_style": "bachata",
		"url": "",
		"event_type": "social dance",
		"event_name": "Dance Bachata in Victoria, BC",
		"day_of_week": "Sunday",
		"start_date": "2025-04-20",
		"end_date": "2025-04-20",
		"start_time": "20:00",
		"end_time": "00:00",
		"price": "",
		"location": "104-845 Burdett Avenue, Victoria, BC V8W 1B3",
		"description": "Event is part of the VIKF 6th Edition Schedule"
	},
	{
		"source": "https://alces.world/6th-edition/",
		"dance_style": "kizomba, urban kiz",
		"url": "",
		"event_type": "social dance",
		"event_name": "Dance Kizomba in Victoria, BC",
		"day_of_week": "Sunday",
		"start_date": "2025-04-20",
		"end_date": "2025-04-20",
		"start_time": "20:00",
		"end_time": "00:00",
		"price": "",
		"location": "104-845 Burdett Avenue, Victoria, BC V8W 1B3",
		"description": "Event is part of the VIKF 6th Edition Schedule"
	}
]
2025-06-18 14:39:23 [root] INFO: def extract_and_parse_json(): for url https://alces.world/6th-edition/, 
Cleaned JSON ready for parsing:
[
	{
		"source": "https://alces.world/6th-edition/",
		"dance_style": "kizomba, urban kiz",
		"url": "",
		"event_type": "social dance",
		"event_name": "Dance Kizomba in Victoria, BC",
		"day_of_week": "Thursday",
		"start_date": "2025-04-17",
		"end_date": "2025-04-17",
		"start_time": "20:00",
		"end_time": "00:00",
		"price": "",
		"location": "104-845 Burdett Avenue, Victoria, BC V8W 1B3",
		"description": "Event is part of the VIKF 6th Edition Schedule"
	},
	{
		"source": "https://alces.world/6th-edition/",
		"dance_style": "bachata",
		"url": "",
		"event_type": "social dance",
		"event_name": "Dance Bachata in Victoria, BC",
		"day_of_week": "Friday",
		"start_date": "2025-04-18",
		"end_date": "2025-04-18",
		"start_time": "20:00",
		"end_time": "00:00",
		"price": "",
		"location": "104-845 Burdett Avenue, Victoria, BC V8W 1B3",
		"description": "Event is part of the VIKF 6th Edition Schedule"
	},
	{
		"source": "https://alces.world/6th-edition/",
		"dance_style": "kizomba, urban kiz",
		"url": "",
		"event_type": "social dance",
		"event_name": "Dance Kizomba in Victoria, BC",
		"day_of_week": "Friday",
		"start_date": "2025-04-18",
		"end_date": "2025-04-18",
		"start_time": "20:00",
		"end_time": "00:00",
		"price": "",
		"location": "104-845 Burdett Avenue, Victoria, BC V8W 1B3",
		"description": "Event is part of the VIKF 6th Edition Schedule"
	},
	{
		"source": "https://alces.world/6th-edition/",
		"dance_style": "bachata",
		"url": "",
		"event_type": "social dance",
		"event_name": "Dance Bachata in Victoria, BC",
		"day_of_week": "Saturday",
		"start_date": "2025-04-19",
		"end_date": "2025-04-19",
		"start_time": "20:00",
		"end_time": "00:00",
		"price": "",
		"location": "104-845 Burdett Avenue, Victoria, BC V8W 1B3",
		"description": "Event is part of the VIKF 6th Edition Schedule"
	},
	{
		"source": "https://alces.world/6th-edition/",
		"dance_style": "kizomba, urban kiz",
		"url": "",
		"event_type": "social dance",
		"event_name": "Dance Kizomba in Victoria, BC",
		"day_of_week": "Saturday",
		"start_date": "2025-04-19",
		"end_date": "2025-04-19",
		"start_time": "20:00",
		"end_time": "00:00",
		"price": "",
		"location": "104-845 Burdett Avenue, Victoria, BC V8W 1B3",
		"description": "Event is part of the VIKF 6th Edition Schedule"
	},
	{
		"source": "https://alces.world/6th-edition/",
		"dance_style": "bachata",
		"url": "",
		"event_type": "social dance",
		"event_name": "Dance Bachata in Victoria, BC",
		"day_of_week": "Sunday",
		"start_date": "2025-04-20",
		"end_date": "2025-04-20",
		"start_time": "20:00",
		"end_time": "00:00",
		"price": "",
		"location": "104-845 Burdett Avenue, Victoria, BC V8W 1B3",
		"description": "Event is part of the VIKF 6th Edition Schedule"
	},
	{
		"source": "https://alces.world/6th-edition/",
		"dance_style": "kizomba, urban kiz",
		"url": "",
		"event_type": "social dance",
		"event_name": "Dance Kizomba in Victoria, BC",
		"day_of_week": "Sunday",
		"start_date": "2025-04-20",
		"end_date": "2025-04-20",
		"start_time": "20:00",
		"end_time": "00:00",
		"price": "",
		"location": "104-845 Burdett Avenue, Victoria, BC V8W 1B3",
		"description": "Event is part of the VIKF 6th Edition Schedule"
	}
]
2025-06-18 14:39:23 [root] INFO: def clean_up_address(): Starting with events_df shape: (7, 14)
2025-06-18 14:39:23 [root] INFO: def clean_up_address(): Processing location '104-845 Burdett Avenue, Victoria, BC V8W 1B3' (event_id: None)
2025-06-18 14:39:23 [root] INFO: get_address_id: Inserted or updated address_id 1319 for address '845 Burdett AVE, VICTORIA, BC, V8W1B3, CA'.
2025-06-18 14:39:23 [root] INFO: Populated from DB for postal code 'V8W1B3': '845 Burdett AVE, VICTORIA, BC, V8W1B3, CA'
2025-06-18 14:39:23 [root] INFO: def clean_up_address(): Processing location '104-845 Burdett Avenue, Victoria, BC V8W 1B3' (event_id: None)
2025-06-18 14:39:23 [root] INFO: get_address_id: Inserted or updated address_id 1319 for address '845 Burdett AVE, VICTORIA, BC, V8W1B3, CA'.
2025-06-18 14:39:23 [root] INFO: Populated from DB for postal code 'V8W1B3': '845 Burdett AVE, VICTORIA, BC, V8W1B3, CA'
2025-06-18 14:39:23 [root] INFO: def clean_up_address(): Processing location '104-845 Burdett Avenue, Victoria, BC V8W 1B3' (event_id: None)
2025-06-18 14:39:23 [root] INFO: get_address_id: Inserted or updated address_id 1319 for address '845 Burdett AVE, VICTORIA, BC, V8W1B3, CA'.
2025-06-18 14:39:23 [root] INFO: Populated from DB for postal code 'V8W1B3': '845 Burdett AVE, VICTORIA, BC, V8W1B3, CA'
2025-06-18 14:39:23 [root] INFO: def clean_up_address(): Processing location '104-845 Burdett Avenue, Victoria, BC V8W 1B3' (event_id: None)
2025-06-18 14:39:23 [root] INFO: get_address_id: Inserted or updated address_id 1319 for address '845 Burdett AVE, VICTORIA, BC, V8W1B3, CA'.
2025-06-18 14:39:23 [root] INFO: Populated from DB for postal code 'V8W1B3': '845 Burdett AVE, VICTORIA, BC, V8W1B3, CA'
2025-06-18 14:39:23 [root] INFO: def clean_up_address(): Processing location '104-845 Burdett Avenue, Victoria, BC V8W 1B3' (event_id: None)
2025-06-18 14:39:23 [root] INFO: get_address_id: Inserted or updated address_id 1319 for address '845 Burdett AVE, VICTORIA, BC, V8W1B3, CA'.
2025-06-18 14:39:23 [root] INFO: Populated from DB for postal code 'V8W1B3': '845 Burdett AVE, VICTORIA, BC, V8W1B3, CA'
2025-06-18 14:39:23 [root] INFO: def clean_up_address(): Processing location '104-845 Burdett Avenue, Victoria, BC V8W 1B3' (event_id: None)
2025-06-18 14:39:23 [root] INFO: get_address_id: Inserted or updated address_id 1319 for address '845 Burdett AVE, VICTORIA, BC, V8W1B3, CA'.
2025-06-18 14:39:23 [root] INFO: Populated from DB for postal code 'V8W1B3': '845 Burdett AVE, VICTORIA, BC, V8W1B3, CA'
2025-06-18 14:39:23 [root] INFO: def clean_up_address(): Processing location '104-845 Burdett Avenue, Victoria, BC V8W 1B3' (event_id: None)
2025-06-18 14:39:23 [root] INFO: get_address_id: Inserted or updated address_id 1319 for address '845 Burdett AVE, VICTORIA, BC, V8W1B3, CA'.
2025-06-18 14:39:23 [root] INFO: Populated from DB for postal code 'V8W1B3': '845 Burdett AVE, VICTORIA, BC, V8W1B3, CA'
2025-06-18 14:39:23 [root] INFO: write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 14:39:23 [root] INFO: write_url_to_db(): appended URL 'https://alces.world/6th-edition/'
2025-06-18 14:39:23 [root] INFO: def process_llm_response: URL https://alces.world/6th-edition/ marked as relevant with events written to the database.
2025-06-18 14:39:23 [root] INFO: write_url_to_db(): appended URL 'https://alces.world/6th-edition/'
2025-06-18 14:39:23 [root] INFO: def parse(): URL https://alces.world/6th-edition/ marked as relevant (LLM positive).
2025-06-18 14:39:23 [root] INFO: def parse(): Found 10 links on https://alces.world/6th-edition/
2025-06-18 14:39:23 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/events/758501768607647/?acontext=%7B%22event_action_history%22%3A%5B%7B%22surface%22%3A%22external%22%7D%2C%7B%22mechanism%22%3A%22your_upcoming_events_unit%22%2C%22surface%22%3A%22bookmark%22%7D%5D%2C%22ref_notif_type%22%3Anull%7D'
2025-06-18 14:39:23 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/events/758501768607647/?acontext=%7B%22event_action_history%22%3A%5B%7B%22surface%22%3A%22external%22%7D%2C%7B%22mechanism%22%3A%22your_upcoming_events_unit%22%2C%22surface%22%3A%22bookmark%22%7D%5D%2C%22ref_notif_type%22%3Anull%7D
2025-06-18 14:39:23 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/vic_international_kizomba_fest/'
2025-06-18 14:39:23 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/vic_international_kizomba_fest/
2025-06-18 14:39:23 [root] INFO: should_process_url: URL https://alces.world/about-us/#volunteer was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:39:23 [root] INFO: should_process_url: URL https://alces.world/about-us/ was last seen as relevant, processing it.
2025-06-18 14:39:23 [root] INFO: should_process_url: URL https://alces.world/about-us/#values was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:39:23 [root] INFO: should_process_url: URL https://alces.world/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 14:39:23 [root] INFO: should_process_url: URL https://alces.world/6th-edition/ was last seen as relevant, processing it.
2025-06-18 14:39:23 [root] INFO: def parse(): Found keywords for URL https://tangofestivals.net/: ['argentine tango', 'dance', 'milonga', 'swing', 'tango']
2025-06-18 14:39:23 [root] INFO: def generate_prompt(): Generating prompt for URL: https://tangofestivals.net/
2025-06-18 14:39:23 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:39:23 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:39:23 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:54:24 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 504 Gateway Timeout"
2025-06-18 14:54:24 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 504
{
  "message":"The upstream server is timing out",
  "request_id":"dcdd7202d751fc6963029123aad33653"
}
2025-06-18 14:54:24 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 14:55:22 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:55:22 [root] INFO: query_llm(): OpenAI response received: [{
    "source": "TangoFestivals",
    "dance_style": "tango",
    "url": "",
    "event_type": "social dance",
    "event_name": "Color Cielo Festival",
    "day_of_week": "Thursday",
    "start_date": "2025-06-19",
    "end_date": "2025-06-22",
    "start_time": "20:30",
    "end_time": "",
    "price": "",
    "location": "Girona, Spain",
    "description": "Program THURSDAY, JUNE 19 20:30 – REGISTRATION; 20:45 – Mauro and Joanna Class; 22:00-03:00 – Milonga Show; Welcome – Ronda"
},
{
    "source": "TangoFestivals",
    "dance_style": "tango",
    "url": "",
    "event_type": "social dance",
    "event_name": "Fethiye Tango Marathon",
    "day_of_week": "Thursday",
    "start_date": "2025-06-19",
    "end_date": "2025-06-22",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Fethiye, Turkey",
    "description": "Are you ready to say hello to summer for the third time in our little paradise Fethiye…"
},
{
    "source": "TangoFestivals",
    "dance_style": "tango",
    "url": "",
    "event_type": "social dance",
    "event_name": "El Yeite Tango Fiesta 2025 Marathon Party",
    "day_of_week": "Thursday",
    "start_date": "2025-06-19",
    "end_date": "2025-06-22",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Budapest, Hungary",
    "description": "June 19–22, 2025. DJs: Octavio Fernandez, Balazs, Andres Molina, Yanina Erramosupe, Dusika"
},
{
    "source": "TangoFestivals",
    "dance_style": "tango",
    "url": "",
    "event_type": "social dance",
    "event_name": "Select Tango Weekend at The Art Museum Hotel",
    "day_of_week": "Thursday",
    "start_date": "2025-06-19",
    "end_date": "2025-06-22",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Beijing, China",
    "description": "Experience the magic of Argentine tango at the Select Tango Weekend, June"
},
{
    "source": "TangoFestivals",
    "dance_style": "tango",
    "url": "",
    "event_type": "workshop",
    "event_name": "Tango Focus del Alma with Guille “El Peque” Barrionuevo and Sol Cerquides",
    "day_of_week": "Thursday",
    "start_date": "2025-06-19",
    "end_date": "2025-06-22",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Timișoara, Romania",
    "description": "Tango Focus by Tango del Alma, 2025, 7th edition"
},
{
    "source": "TangoFestivals",
    "dance_style": "tango",
    "url": "",
    "event_type": "social dance",
    "event_name": "Strawberry Tango Marathon",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-22",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Lodz, Poland",
    "description": "This year, we invite all of you who want to dance tango and meet again with friends"
}]
2025-06-18 14:55:22 [root] INFO: def extract_and_parse_json(): for url https://tangofestivals.net/, 
Cleaned JSON ready for parsing:
[{
    "source": "TangoFestivals",
    "dance_style": "tango",
    "url": "",
    "event_type": "social dance",
    "event_name": "Color Cielo Festival",
    "day_of_week": "Thursday",
    "start_date": "2025-06-19",
    "end_date": "2025-06-22",
    "start_time": "20:30",
    "end_time": "",
    "price": "",
    "location": "Girona, Spain",
    "description": "Program THURSDAY, JUNE 19 20:30 – REGISTRATION; 20:45 – Mauro and Joanna Class; 22:00-03:00 – Milonga Show; Welcome – Ronda"
},
{
    "source": "TangoFestivals",
    "dance_style": "tango",
    "url": "",
    "event_type": "social dance",
    "event_name": "Fethiye Tango Marathon",
    "day_of_week": "Thursday",
    "start_date": "2025-06-19",
    "end_date": "2025-06-22",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Fethiye, Turkey",
    "description": "Are you ready to say hello to summer for the third time in our little paradise Fethiye…"
},
{
    "source": "TangoFestivals",
    "dance_style": "tango",
    "url": "",
    "event_type": "social dance",
    "event_name": "El Yeite Tango Fiesta 2025 Marathon Party",
    "day_of_week": "Thursday",
    "start_date": "2025-06-19",
    "end_date": "2025-06-22",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Budapest, Hungary",
    "description": "June 19–22, 2025. DJs: Octavio Fernandez, Balazs, Andres Molina, Yanina Erramosupe, Dusika"
},
{
    "source": "TangoFestivals",
    "dance_style": "tango",
    "url": "",
    "event_type": "social dance",
    "event_name": "Select Tango Weekend at The Art Museum Hotel",
    "day_of_week": "Thursday",
    "start_date": "2025-06-19",
    "end_date": "2025-06-22",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Beijing, China",
    "description": "Experience the magic of Argentine tango at the Select Tango Weekend, June"
},
{
    "source": "TangoFestivals",
    "dance_style": "tango",
    "url": "",
    "event_type": "workshop",
    "event_name": "Tango Focus del Alma with Guille “El Peque” Barrionuevo and Sol Cerquides",
    "day_of_week": "Thursday",
    "start_date": "2025-06-19",
    "end_date": "2025-06-22",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Timișoara, Romania",
    "description": "Tango Focus by Tango del Alma, 2025, 7th edition"
},
{
    "source": "TangoFestivals",
    "dance_style": "tango",
    "url": "",
    "event_type": "social dance",
    "event_name": "Strawberry Tango Marathon",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-22",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Lodz, Poland",
    "description": "This year, we invite all of you who want to dance tango and meet again with friends"
}]
2025-06-18 14:55:22 [root] INFO: def clean_up_address(): Starting with events_df shape: (6, 14)
2025-06-18 14:55:22 [root] INFO: def clean_up_address(): Processing location 'Girona, Spain' (event_id: None)
2025-06-18 14:55:22 [root] INFO: def clean_up_address(): Processing location 'Fethiye, Turkey' (event_id: None)
2025-06-18 14:55:22 [root] INFO: def clean_up_address(): Processing location 'Budapest, Hungary' (event_id: None)
2025-06-18 14:55:22 [root] INFO: def clean_up_address(): Processing location 'Beijing, China' (event_id: None)
2025-06-18 14:55:22 [root] INFO: def clean_up_address(): Processing location 'Timișoara, Romania' (event_id: None)
2025-06-18 14:55:22 [root] INFO: def clean_up_address(): Processing location 'Lodz, Poland' (event_id: None)
2025-06-18 14:55:22 [root] INFO: write_events_to_db: Number of events to write: 6
2025-06-18 14:55:23 [root] INFO: write_url_to_db(): appended URL 'https://tangofestivals.net/'
2025-06-18 14:55:23 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 14:55:23 [root] INFO: def process_llm_response: URL https://tangofestivals.net/ marked as relevant with events written to the database.
2025-06-18 14:55:23 [root] INFO: write_url_to_db(): appended URL 'https://tangofestivals.net/'
2025-06-18 14:55:23 [root] INFO: def parse(): URL https://tangofestivals.net/ marked as relevant (LLM positive).
2025-06-18 14:55:23 [root] INFO: def parse(): Found 10 links on https://tangofestivals.net/
2025-06-18 14:55:23 [root] INFO: should_process_url: URL https://tangofestivals.net/location/ has never been seen before, processing it.
2025-06-18 14:55:23 [root] INFO: should_process_url: URL https://tangofestivals.net/category/festival-locations/ has never been seen before, processing it.
2025-06-18 14:55:23 [root] INFO: should_process_url: URL https://tangofestivals.net/category/festival-experiences/ has never been seen before, processing it.
2025-06-18 14:55:23 [root] INFO: should_process_url: URL https://tangofestivals.net/ has never been seen before, processing it.
2025-06-18 14:55:23 [root] INFO: should_process_url: URL https://tangofestivals.net/location/Argentina/ has never been seen before, processing it.
2025-06-18 14:55:23 [root] INFO: should_process_url: URL https://tangofestivals.net/blog/ has never been seen before, processing it.
2025-06-18 14:55:23 [root] INFO: should_process_url: URL https://tangofestivals.net/location/United-States/ has never been seen before, processing it.
2025-06-18 14:55:23 [root] INFO: should_process_url: URL https://tangofestivals.net/category/festival-guides/ has never been seen before, processing it.
2025-06-18 14:55:23 [root] INFO: def parse(): Found keywords for URL https://www.eventbrite.com/organizer/features/sell-tickets/: ['dance']
2025-06-18 14:55:23 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.eventbrite.com/organizer/features/sell-tickets/
2025-06-18 14:55:23 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:55:23 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:55:23 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:55:58 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:55:58 [root] INFO: query_llm(): Mistral response received: **No events found**
2025-06-18 14:55:58 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 14:55:58 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/organizer/features/sell-tickets/'
2025-06-18 14:55:58 [root] INFO: def parse(): URL https://www.eventbrite.com/organizer/features/sell-tickets/ marked as irrelevant (LLM negative).
2025-06-18 14:55:58 [root] INFO: def parse(): Found 10 links on https://www.eventbrite.com/organizer/features/sell-tickets/
2025-06-18 14:55:58 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ, URL: https://www.eventbrite.com/organizer/features/sell-tickets/, source: Argentine tango classes & related events | Eventbrite, keywords: argentine tango
2025-06-18 14:55:58 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 14:55:58 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ
2025-06-18 14:55:58 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ, URL: https://www.eventbrite.com/organizer/features/sell-tickets/, source: Argentine tango classes & related events | Eventbrite, keywords: argentine tango
2025-06-18 14:55:58 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 14:55:58 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ
2025-06-18 14:55:58 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ'
2025-06-18 14:55:58 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/?referrer=/manage/events/create/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:55:58 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/?referrer=/manage/events/create/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:55:58 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/signin/?referrer=/manage/events/create/'
2025-06-18 14:55:58 [root] INFO: def parse(): Crawling next URL: https://www.eventbrite.com/signin/?referrer=/manage/events/create/
2025-06-18 14:55:58 [root] INFO: def parse(): Found keywords for URL https://www.foxtrotwine.com/visit/: ['foxtrot']
2025-06-18 14:55:58 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.foxtrotwine.com/visit/
2025-06-18 14:55:58 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:55:58 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:55:58 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:56:21 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:56:21 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "Foxtrot Vineyards",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "The Terroir Experience",
        "day_of_week": "Thursday",
        "start_date": "2025-05-29",
        "end_date": "2025-05-29",
        "start_time": "12:00",
        "end_time": "17:00",
        "price": "$15",
        "location": "Foxtrot Vineyards, 1201 Gawne Road, Naramata, BC, V0H 1N1",
        "description": "Opening May 29, 2025! We're Open DAILY 12 to 5 pm. Tastings are $15 per guest and are waived with purchase. 6 guests per group maximum Reservations are ~45 mins Pet-friendly Entry on Gawne Road"
    }
]
2025-06-18 14:56:21 [root] INFO: def extract_and_parse_json(): for url https://www.foxtrotwine.com/visit/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Foxtrot Vineyards",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "The Terroir Experience",
        "day_of_week": "Thursday",
        "start_date": "2025-05-29",
        "end_date": "2025-05-29",
        "start_time": "12:00",
        "end_time": "17:00",
        "price": "$15",
        "location": "Foxtrot Vineyards, 1201 Gawne Road, Naramata, BC, V0H 1N1",
        "description": "Opening May 29, 2025! We're Open DAILY 12 to 5 pm. Tastings are $15 per guest and are waived with purchase. 6 guests per group maximum Reservations are ~45 mins Pet-friendly Entry on Gawne Road"
    }
]
2025-06-18 14:56:21 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 14:56:21 [root] INFO: def clean_up_address(): Processing location 'Foxtrot Vineyards, 1201 Gawne Road, Naramata, BC, V0H 1N1' (event_id: None)
2025-06-18 14:56:21 [root] INFO: def clean_up_address(): Updated event None with address_id 8536 using DB match
2025-06-18 14:56:21 [root] INFO: write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 14:56:21 [root] INFO: write_url_to_db(): appended URL 'https://www.foxtrotwine.com/visit/'
2025-06-18 14:56:21 [root] INFO: def process_llm_response: URL https://www.foxtrotwine.com/visit/ marked as relevant with events written to the database.
2025-06-18 14:56:21 [root] INFO: write_url_to_db(): appended URL 'https://www.foxtrotwine.com/visit/'
2025-06-18 14:56:21 [root] INFO: def parse(): URL https://www.foxtrotwine.com/visit/ marked as relevant (LLM positive).
2025-06-18 14:56:21 [root] INFO: def parse(): Found 10 links on https://www.foxtrotwine.com/visit/
2025-06-18 14:56:21 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/wp-content/uploads/2023/05/Screen-Shot-2023-05-05-at-12.26.20-PM-min.png was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:56:21 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/wp-content/uploads/2023/05/Screen-Shot-2023-05-05-at-12.26.20-PM-min.png was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:56:21 [root] INFO: write_url_to_db(): appended URL 'https://www.foxtrotwine.com/wp-content/uploads/2023/05/Screen-Shot-2023-05-05-at-12.26.20-PM-min.png'
2025-06-18 14:56:21 [root] INFO: def parse(): Crawling next URL: https://www.foxtrotwine.com/wp-content/uploads/2023/05/Screen-Shot-2023-05-05-at-12.26.20-PM-min.png
2025-06-18 14:56:21 [root] INFO: def parse(): Found keywords for URL https://www.foxtrotwine.com/category/uncategorized/: ['foxtrot']
2025-06-18 14:56:21 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.foxtrotwine.com/category/uncategorized/
2025-06-18 14:56:21 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:56:21 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:56:21 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:56:24 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:56:24 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 14:56:24 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 14:56:24 [root] INFO: write_url_to_db(): appended URL 'https://www.foxtrotwine.com/category/uncategorized/'
2025-06-18 14:56:24 [root] INFO: def parse(): URL https://www.foxtrotwine.com/category/uncategorized/ marked as irrelevant (LLM negative).
2025-06-18 14:56:24 [root] INFO: def parse(): Found 10 links on https://www.foxtrotwine.com/category/uncategorized/
2025-06-18 14:56:24 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/western-living-magazine-the-pinot-chronicles-pt-2-foxtrot-vineyards-the-winery-that-kicked-off-the-pinot-frenzy/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:24 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/western-living-magazine-the-pinot-chronicles-pt-2-foxtrot-vineyards-the-winery-that-kicked-off-the-pinot-frenzy/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:24 [root] INFO: write_url_to_db(): appended URL 'https://www.foxtrotwine.com/western-living-magazine-the-pinot-chronicles-pt-2-foxtrot-vineyards-the-winery-that-kicked-off-the-pinot-frenzy/'
2025-06-18 14:56:24 [root] INFO: def parse(): Crawling next URL: https://www.foxtrotwine.com/western-living-magazine-the-pinot-chronicles-pt-2-foxtrot-vineyards-the-winery-that-kicked-off-the-pinot-frenzy/
2025-06-18 14:56:24 [root] INFO: def parse(): Found keywords for URL https://calendly.com/tastingexperience/tasting-reservation: ['foxtrot']
2025-06-18 14:56:24 [root] INFO: def generate_prompt(): Generating prompt for URL: https://calendly.com/tastingexperience/tasting-reservation
2025-06-18 14:56:24 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:56:24 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:56:24 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:56:25 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:56:25 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 14:56:25 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 14:56:25 [root] INFO: write_url_to_db(): appended URL 'https://calendly.com/tastingexperience/tasting-reservation'
2025-06-18 14:56:25 [root] INFO: def parse(): URL https://calendly.com/tastingexperience/tasting-reservation marked as irrelevant (LLM negative).
2025-06-18 14:56:25 [root] INFO: def parse(): Found 0 links on https://calendly.com/tastingexperience/tasting-reservation
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://calendly.com/tastingexperience/tasting-reservation was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/organizer/features/event-marketing-platform/'
2025-06-18 14:56:25 [root] INFO: def parse(): URL https://www.eventbrite.com/organizer/features/event-marketing-platform/ marked as irrelevant (no keywords).
2025-06-18 14:56:25 [root] INFO: def parse(): Found 10 links on https://www.eventbrite.com/organizer/features/event-marketing-platform/
2025-06-18 14:56:25 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ, URL: https://www.eventbrite.com/organizer/features/event-marketing-platform/, source: Argentine tango classes & related events | Eventbrite, keywords: argentine tango
2025-06-18 14:56:25 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 14:56:25 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ
2025-06-18 14:56:25 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ, URL: https://www.eventbrite.com/organizer/features/event-marketing-platform/, source: Argentine tango classes & related events | Eventbrite, keywords: argentine tango
2025-06-18 14:56:25 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 14:56:25 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ
2025-06-18 14:56:25 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ'
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/signup/?referrer=%2Fmanage%2Fevents%2Fcreate%2F was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/signup/?referrer=%2Fmanage%2Fevents%2Fcreate%2F was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/signin/signup/?referrer=%2Fmanage%2Fevents%2Fcreate%2F'
2025-06-18 14:56:25 [root] INFO: def parse(): Crawling next URL: https://www.eventbrite.com/signin/signup/?referrer=%2Fmanage%2Fevents%2Fcreate%2F
2025-06-18 14:56:25 [scrapy.extensions.logstats] INFO: Crawled 165 pages (at 26 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.eventbrite.com/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/sell-tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/event-marketing-platform/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/event-payment/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/signup/?referrer=/manage/events/create/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/signup/?referrer=/manage/events/create/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/signin/signup/?referrer=/manage/events/create/'
2025-06-18 14:56:25 [root] INFO: def parse(): Crawling next URL: https://www.eventbrite.com/signin/signup/?referrer=/manage/events/create/
2025-06-18 14:56:25 [root] INFO: should_process_url: URL http://www.cryoutcreations.eu was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL http://www.cryoutcreations.eu was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: write_url_to_db(): appended URL 'http://www.cryoutcreations.eu'
2025-06-18 14:56:25 [root] INFO: def parse(): Crawling next URL: http://www.cryoutcreations.eu
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/our-philosophy/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/the-story-behind-the-label/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/contact-us/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/category/uncategorized/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/club/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/visit/ was last seen as relevant, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.eventbrite.com/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/signup/?referrer=%2Fmytickets was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/sell-tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/event-marketing-platform/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/?referrer=%2Fmanage%2Fevents%2Fcreate%2F was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/?referrer=%2Fmanage%2Fevents%2Fcreate%2F was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/signin/?referrer=%2Fmanage%2Fevents%2Fcreate%2F'
2025-06-18 14:56:25 [root] INFO: def parse(): Crawling next URL: https://www.eventbrite.com/signin/?referrer=%2Fmanage%2Fevents%2Fcreate%2F
2025-06-18 14:56:25 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/organizer/features/event-payment/'
2025-06-18 14:56:25 [root] INFO: def parse(): URL https://www.eventbrite.com/organizer/features/event-payment/ marked as irrelevant (no keywords).
2025-06-18 14:56:25 [root] INFO: def parse(): Found 10 links on https://www.eventbrite.com/organizer/features/event-payment/
2025-06-18 14:56:25 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ, URL: https://www.eventbrite.com/organizer/features/event-payment/, source: Argentine tango classes & related events | Eventbrite, keywords: argentine tango
2025-06-18 14:56:25 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 14:56:25 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ
2025-06-18 14:56:25 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ, URL: https://www.eventbrite.com/organizer/features/event-payment/, source: Argentine tango classes & related events | Eventbrite, keywords: argentine tango
2025-06-18 14:56:25 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 14:56:25 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ
2025-06-18 14:56:25 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ'
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/?referrer=/manage/events/create/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.eventbrite.com/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/sell-tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/event-marketing-platform/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/event-payment/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/signup/?referrer=/manage/events/create/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.eventbrite.com/d/local/events/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/eventbrite-ads/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.eventbrite.com/d/local/events/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/eventbrite-ads/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/our-philosophy/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/the-story-behind-the-label/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:25 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/contact-us/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:26 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/club/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:26 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/category/uncategorized/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:26 [root] INFO: should_process_url: URL https://calendly.com/tastingexperience/tasting-reservation was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:26 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/visit/ was last seen as relevant, processing it.
2025-06-18 14:56:26 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/event-payment/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:26 [root] INFO: should_process_url: URL https://www.eventbrite.com/d/local/events/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:26 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/eventbrite-ads/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:26 [root] INFO: def parse(): Found keywords for URL https://tangofestivals.net/location/United-States/: ['argentine tango', 'milonga', 'swing', 'tango']
2025-06-18 14:56:26 [root] INFO: def generate_prompt(): Generating prompt for URL: https://tangofestivals.net/location/United-States/
2025-06-18 14:56:26 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:56:26 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:56:26 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:56:47 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:56:47 [root] INFO: query_llm(): Mistral response received: <!--Cache served by breeze CACHE - Last modified: Wed, 18 Jun 2025 21:22:12 GMT -->

<!-- plugin=object-cache-pro client=phpredis metric#hits=4541 metric#misses=33 metric#hit-ratio=99.3 metric#bytes=7135623 metric#prefetches=0 metric#store-reads=137 metric#store-writes=27 metric#store-hits=165 metric#store-misses=24 metric#sql-queries=50 metric#ms-total=3991.96 metric#ms-cache=505.20 metric#ms-cache-avg=3.0994 metric#ms-cache-ratio=12.7 -->
2025-06-18 14:56:47 [root] ERROR: def extract_and_parse_json(): couldn't isolate JSON blob in result from https://tangofestivals.net/location/United-States/
2025-06-18 14:56:47 [root] INFO: write_url_to_db(): appended URL 'https://tangofestivals.net/location/United-States/'
2025-06-18 14:56:47 [root] INFO: def parse(): URL https://tangofestivals.net/location/United-States/ marked as irrelevant (LLM negative).
2025-06-18 14:56:47 [root] INFO: def parse(): Found 10 links on https://tangofestivals.net/location/United-States/
2025-06-18 14:56:47 [root] INFO: should_process_url: URL https://tangofestivals.net/location/ has never been seen before, processing it.
2025-06-18 14:56:47 [root] INFO: should_process_url: URL https://tangofestivals.net/ has never been seen before, processing it.
2025-06-18 14:56:47 [root] INFO: should_process_url: URL https://tangofestivals.net/category/festival-experiences/ has never been seen before, processing it.
2025-06-18 14:56:47 [root] INFO: should_process_url: URL https://tangofestivals.net/category/festival-locations/ has never been seen before, processing it.
2025-06-18 14:56:47 [root] INFO: should_process_url: URL https://tangofestivals.net/location/Argentina/ has never been seen before, processing it.
2025-06-18 14:56:47 [root] INFO: should_process_url: URL https://tangofestivals.net/blog/ has never been seen before, processing it.
2025-06-18 14:56:47 [root] INFO: should_process_url: URL https://tangofestivals.net/location/United-States/ has never been seen before, processing it.
2025-06-18 14:56:47 [root] INFO: should_process_url: URL https://tangofestivals.net/category/festival-guides/ has never been seen before, processing it.
2025-06-18 14:56:47 [root] INFO: def parse(): Found keywords for URL https://www.eventbrite.com/signin/?referrer=%2Fd%2Fcanada--victoria%2Fsalsa%2F: ['salsa']
2025-06-18 14:56:47 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.eventbrite.com/signin/?referrer=%2Fd%2Fcanada--victoria%2Fsalsa%2F
2025-06-18 14:56:47 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:56:47 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:56:47 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:56:50 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:56:50 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 14:56:50 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 14:56:50 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/signin/?referrer=%2Fd%2Fcanada--victoria%2Fsalsa%2F'
2025-06-18 14:56:50 [root] INFO: def parse(): URL https://www.eventbrite.com/signin/?referrer=%2Fd%2Fcanada--victoria%2Fsalsa%2F marked as irrelevant (LLM negative).
2025-06-18 14:56:50 [root] INFO: def parse(): Found 0 links on https://www.eventbrite.com/signin/?referrer=%2Fd%2Fcanada--victoria%2Fsalsa%2F
2025-06-18 14:56:50 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ, URL: https://www.eventbrite.com/signin/?referrer=%2Fd%2Fcanada--victoria%2Fsalsa%2F, source: Discover Salsa Events & Activities in Victoria, Canada | Eventbrite, keywords: bachata
2025-06-18 14:56:50 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 14:56:50 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ
2025-06-18 14:56:50 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ'
2025-06-18 14:56:50 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/?referrer=%2Fd%2Fcanada--victoria%2Fsalsa%2F was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:56:50 [root] INFO: def parse(): Found keywords for URL https://www.eventbrite.com/signin/signup/?referrer=%2Fd%2Fcanada--victoria%2Fsalsa%2F: ['salsa']
2025-06-18 14:56:50 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.eventbrite.com/signin/signup/?referrer=%2Fd%2Fcanada--victoria%2Fsalsa%2F
2025-06-18 14:56:50 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:56:50 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:56:50 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:56:52 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:56:52 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 14:56:52 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 14:56:52 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/signin/signup/?referrer=%2Fd%2Fcanada--victoria%2Fsalsa%2F'
2025-06-18 14:56:52 [root] INFO: def parse(): URL https://www.eventbrite.com/signin/signup/?referrer=%2Fd%2Fcanada--victoria%2Fsalsa%2F marked as irrelevant (LLM negative).
2025-06-18 14:56:52 [root] INFO: def parse(): Found 0 links on https://www.eventbrite.com/signin/signup/?referrer=%2Fd%2Fcanada--victoria%2Fsalsa%2F
2025-06-18 14:56:52 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ, URL: https://www.eventbrite.com/signin/signup/?referrer=%2Fd%2Fcanada--victoria%2Fsalsa%2F, source: Discover Salsa Events & Activities in Victoria, Canada | Eventbrite, keywords: bachata
2025-06-18 14:56:52 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 14:56:52 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ
2025-06-18 14:56:52 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ'
2025-06-18 14:56:52 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/signup/?referrer=%2Fd%2Fcanada--victoria%2Fsalsa%2F was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:56:52 [root] INFO: def parse(): Found keywords for URL https://www.foxtrotwine.com/club/: ['foxtrot']
2025-06-18 14:56:52 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.foxtrotwine.com/club/
2025-06-18 14:56:52 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:56:52 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:56:52 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:56:55 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:56:55 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 14:56:55 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 14:56:55 [root] INFO: write_url_to_db(): appended URL 'https://www.foxtrotwine.com/club/'
2025-06-18 14:56:55 [root] INFO: def parse(): URL https://www.foxtrotwine.com/club/ marked as irrelevant (LLM negative).
2025-06-18 14:56:55 [root] INFO: def parse(): Found 10 links on https://www.foxtrotwine.com/club/
2025-06-18 14:56:55 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/pages/Foxtrot-Vineyards/213635918034'
2025-06-18 14:56:55 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/pages/Foxtrot-Vineyards/213635918034
2025-06-18 14:56:55 [root] INFO: should_process_url: URL http://www.cryoutcreations.eu was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:55 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/our-philosophy/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:55 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 14:56:55 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/the-story-behind-the-label/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:55 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/contact-us/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:55 [root] INFO: parse: Skipping blacklisted URL http://wordpress.org/.
2025-06-18 14:56:55 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/club/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:55 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/category/uncategorized/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:55 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/visit/ was last seen as relevant, processing it.
2025-06-18 14:56:55 [root] INFO: def parse(): Found keywords for URL https://www.foxtrotwine.com/contact-us/: ['foxtrot']
2025-06-18 14:56:55 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.foxtrotwine.com/contact-us/
2025-06-18 14:56:55 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:56:55 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:56:55 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:56:59 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:56:59 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 14:56:59 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 14:56:59 [root] INFO: write_url_to_db(): appended URL 'https://www.foxtrotwine.com/contact-us/'
2025-06-18 14:56:59 [root] INFO: def parse(): URL https://www.foxtrotwine.com/contact-us/ marked as irrelevant (LLM negative).
2025-06-18 14:56:59 [root] INFO: def parse(): Found 10 links on https://www.foxtrotwine.com/contact-us/
2025-06-18 14:56:59 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/pages/Foxtrot-Vineyards/213635918034'
2025-06-18 14:56:59 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/pages/Foxtrot-Vineyards/213635918034
2025-06-18 14:56:59 [root] INFO: should_process_url: URL http://www.cryoutcreations.eu was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:59 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/our-philosophy/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:59 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 14:56:59 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/the-story-behind-the-label/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:59 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/contact-us/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:59 [root] INFO: parse: Skipping blacklisted URL http://wordpress.org/.
2025-06-18 14:56:59 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/club/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:59 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/category/uncategorized/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:56:59 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/visit/ was last seen as relevant, processing it.
2025-06-18 14:56:59 [root] INFO: def parse(): Found keywords for URL https://www.foxtrotwine.com/the-story-behind-the-label/: ['dance', 'foxtrot']
2025-06-18 14:56:59 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.foxtrotwine.com/the-story-behind-the-label/
2025-06-18 14:56:59 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:56:59 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:56:59 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:57:03 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:57:03 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 14:57:03 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 14:57:03 [root] INFO: write_url_to_db(): appended URL 'https://www.foxtrotwine.com/the-story-behind-the-label/'
2025-06-18 14:57:03 [root] INFO: def parse(): URL https://www.foxtrotwine.com/the-story-behind-the-label/ marked as irrelevant (LLM negative).
2025-06-18 14:57:03 [root] INFO: def parse(): Found 10 links on https://www.foxtrotwine.com/the-story-behind-the-label/
2025-06-18 14:57:03 [root] INFO: should_process_url: URL http://www.cryoutcreations.eu was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:57:03 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/the-story-behind-the-label/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:57:03 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/our-philosophy/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:57:03 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 14:57:03 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/contact-us/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:57:03 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/wp-content/uploads/2019/12/foxtrot-1024x595.jpg was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:57:03 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/wp-content/uploads/2019/12/foxtrot-1024x595.jpg was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:57:03 [root] INFO: write_url_to_db(): appended URL 'https://www.foxtrotwine.com/wp-content/uploads/2019/12/foxtrot-1024x595.jpg'
2025-06-18 14:57:03 [root] INFO: def parse(): Crawling next URL: https://www.foxtrotwine.com/wp-content/uploads/2019/12/foxtrot-1024x595.jpg
2025-06-18 14:57:03 [root] INFO: def parse(): Found keywords for URL https://www.foxtrotwine.com/our-philosophy/: ['foxtrot']
2025-06-18 14:57:03 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.foxtrotwine.com/our-philosophy/
2025-06-18 14:57:03 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:57:03 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:57:03 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:57:36 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:57:36 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "https://www.foxtrotwine.com/our-philosophy/",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Foxtrot Vineyards Philosophy",
        "day_of_week": "",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "1201 Gawne Road, Naramata, BC, V0H 1N1",
        "description": "We believe that a wine should be an expression of its place, of the particular soils and microclimate from which it comes, the vines and grapes that give it life, and the weather conditions that shape it, all animated by the sensibility of the individuals who make it. Great wine is not replicable from place to place nor the same from year to year. Foxtrot is fortunate to make its home on the Naramata Bench, whose unique terroir we seek to express in complex, elegant, and age-worthy Pinot Noirs."
    }
]
2025-06-18 14:57:36 [root] INFO: def extract_and_parse_json(): for url https://www.foxtrotwine.com/our-philosophy/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "https://www.foxtrotwine.com/our-philosophy/",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Foxtrot Vineyards Philosophy",
        "day_of_week": "",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "1201 Gawne Road, Naramata, BC, V0H 1N1",
        "description": "We believe that a wine should be an expression of its place, of the particular soils and microclimate from which it comes, the vines and grapes that give it life, and the weather conditions that shape it, all animated by the sensibility of the individuals who make it. Great wine is not replicable from place to place nor the same from year to year. Foxtrot is fortunate to make its home on the Naramata Bench, whose unique terroir we seek to express in complex, elegant, and age-worthy Pinot Noirs."
    }
]
2025-06-18 14:57:36 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 14:57:36 [root] INFO: def clean_up_address(): Processing location '1201 Gawne Road, Naramata, BC, V0H 1N1' (event_id: None)
2025-06-18 14:57:36 [root] INFO: def clean_up_address(): Updated event None with address_id 8536 using DB match
2025-06-18 14:57:36 [root] INFO: write_events_to_db: Number of events to write: 1
2025-06-18 14:57:36 [root] INFO: write_url_to_db(): appended URL 'https://www.foxtrotwine.com/our-philosophy/'
2025-06-18 14:57:36 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 14:57:36 [root] INFO: def process_llm_response: URL https://www.foxtrotwine.com/our-philosophy/ marked as relevant with events written to the database.
2025-06-18 14:57:36 [root] INFO: write_url_to_db(): appended URL 'https://www.foxtrotwine.com/our-philosophy/'
2025-06-18 14:57:36 [root] INFO: def parse(): URL https://www.foxtrotwine.com/our-philosophy/ marked as relevant (LLM positive).
2025-06-18 14:57:36 [root] INFO: def parse(): Found 10 links on https://www.foxtrotwine.com/our-philosophy/
2025-06-18 14:57:36 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/pages/Foxtrot-Vineyards/213635918034'
2025-06-18 14:57:36 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/pages/Foxtrot-Vineyards/213635918034
2025-06-18 14:57:36 [root] INFO: should_process_url: URL http://www.cryoutcreations.eu was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:57:36 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/our-philosophy/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:57:36 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 14:57:36 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/the-story-behind-the-label/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:57:36 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/contact-us/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:57:36 [root] INFO: parse: Skipping blacklisted URL http://wordpress.org/.
2025-06-18 14:57:36 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/club/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:57:36 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/category/uncategorized/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:57:36 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/visit/ was last seen as relevant, processing it.
2025-06-18 14:57:36 [root] INFO: def parse(): Found keywords for URL https://www.eventbrite.com/: ['music festivals']
2025-06-18 14:57:36 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.eventbrite.com/
2025-06-18 14:57:36 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:57:36 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:57:36 [root] INFO: query_llm(): Querying Mistral
2025-06-18 14:58:29 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 14:58:29 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "Eventbrite - Discover the Best Local Events &amp; Things to Do",
        "dance_style": "salsa, bachata, kizomba, lindy hop, merengue, samba, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Thursday Night Salsa",
        "day_of_week": "Thursday",
        "start_date": "2025-06-19",
        "end_date": "2025-06-19",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "The Dance Studio, 1234 Dance Street, Anytown, USA",
        "description": "Join us for a night of salsa dancing! All levels welcome. DJ playing the best salsa music all night long. Admission is $10 at the door. Doors open at 7:30 PM. Lessons start at 8:00 PM."
    },
    {
        "source": "Eventbrite - Discover the Best Local Events &amp; Things to Do",
        "dance_style": "salsa",
        "url": "",
        "event_type": "social dance",
        "event_name": "Saturday Salsa Night",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "20:00",
        "end_time": "00:00",
        "price": "",
        "location": "The Dance Studio, 1234 Dance Street, Anytown, USA",
        "description": "Join us for a night of salsa dancing! All levels welcome. DJ playing the best salsa music all night long. Admission is $10 at the door. Doors open at 7:30 PM. Lessons start at 8:00 PM."
    }
]
2025-06-18 14:58:29 [root] INFO: def extract_and_parse_json(): for url https://www.eventbrite.com/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Eventbrite - Discover the Best Local Events &amp; Things to Do",
        "dance_style": "salsa, bachata, kizomba, lindy hop, merengue, samba, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Thursday Night Salsa",
        "day_of_week": "Thursday",
        "start_date": "2025-06-19",
        "end_date": "2025-06-19",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "The Dance Studio, 1234 Dance Street, Anytown, USA",
        "description": "Join us for a night of salsa dancing! All levels welcome. DJ playing the best salsa music all night long. Admission is $10 at the door. Doors open at 7:30 PM. Lessons start at 8:00 PM."
    },
    {
        "source": "Eventbrite - Discover the Best Local Events &amp; Things to Do",
        "dance_style": "salsa",
        "url": "",
        "event_type": "social dance",
        "event_name": "Saturday Salsa Night",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "20:00",
        "end_time": "00:00",
        "price": "",
        "location": "The Dance Studio, 1234 Dance Street, Anytown, USA",
        "description": "Join us for a night of salsa dancing! All levels welcome. DJ playing the best salsa music all night long. Admission is $10 at the door. Doors open at 7:30 PM. Lessons start at 8:00 PM."
    }
]
2025-06-18 14:58:29 [root] INFO: def clean_up_address(): Starting with events_df shape: (2, 14)
2025-06-18 14:58:29 [root] INFO: def clean_up_address(): Processing location 'The Dance Studio, 1234 Dance Street, Anytown, USA' (event_id: None)
2025-06-18 14:58:29 [root] INFO: def clean_up_address(): Processing location 'The Dance Studio, 1234 Dance Street, Anytown, USA' (event_id: None)
2025-06-18 14:58:29 [root] INFO: write_events_to_db: Number of events to write: 2
2025-06-18 14:58:29 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/'
2025-06-18 14:58:29 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 14:58:29 [root] INFO: def process_llm_response: URL https://www.eventbrite.com/ marked as relevant with events written to the database.
2025-06-18 14:58:29 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/'
2025-06-18 14:58:29 [root] INFO: def parse(): URL https://www.eventbrite.com/ marked as relevant (LLM positive).
2025-06-18 14:58:29 [root] INFO: def parse(): Found 10 links on https://www.eventbrite.com/
2025-06-18 14:58:29 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ, URL: https://www.eventbrite.com/, source: Argentine tango classes & related events | Eventbrite, keywords: argentine tango
2025-06-18 14:58:29 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 14:58:29 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ
2025-06-18 14:58:29 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ'
2025-06-18 14:58:29 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/?referrer=%2F was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:58:29 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/?referrer=%2F was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:58:29 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/signin/?referrer=%2F'
2025-06-18 14:58:29 [root] INFO: def parse(): Crawling next URL: https://www.eventbrite.com/signin/?referrer=%2F
2025-06-18 14:58:29 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/organizer/features/eventbrite-ads/'
2025-06-18 14:58:29 [root] INFO: def parse(): URL https://www.eventbrite.com/organizer/features/eventbrite-ads/ marked as irrelevant (no keywords).
2025-06-18 14:58:29 [root] INFO: def parse(): Found 10 links on https://www.eventbrite.com/organizer/features/eventbrite-ads/
2025-06-18 14:58:29 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ, URL: https://www.eventbrite.com/organizer/features/eventbrite-ads/, source: Argentine tango classes & related events | Eventbrite, keywords: argentine tango
2025-06-18 14:58:29 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 14:58:29 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ
2025-06-18 14:58:29 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ, URL: https://www.eventbrite.com/organizer/features/eventbrite-ads/, source: Argentine tango classes & related events | Eventbrite, keywords: argentine tango
2025-06-18 14:58:29 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 14:58:29 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ
2025-06-18 14:58:29 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ'
2025-06-18 14:58:29 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/signup/?referrer=%2Fmanage%2Fevents%2Fcreate%2F was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:58:29 [root] INFO: should_process_url: URL https://www.eventbrite.com/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:58:29 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/signup/?referrer=%2Fmytickets was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:58:29 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/sell-tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:58:29 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/?referrer=%2Fmanage%2Fevents%2Fcreate%2F was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 14:58:29 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/event-marketing-platform/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:58:29 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/event-payment/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:58:29 [root] INFO: should_process_url: URL https://www.eventbrite.com/d/local/events/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:58:29 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/eventbrite-ads/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 14:58:29 [root] INFO: def parse(): Found keywords for URL https://tangofestivals.net/blog/: ['dance', 'milonga', 'swing', 'tango']
2025-06-18 14:58:29 [root] INFO: def generate_prompt(): Generating prompt for URL: https://tangofestivals.net/blog/
2025-06-18 14:58:29 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 14:58:29 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 14:58:29 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:00:01 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:00:01 [root] INFO: query_llm(): Mistral response received: The extracted text contains several events, here are the details in the requested JSON format:

```json
[
    {
        "source": "<The original source of information for this event>",
        "dance_style": "tango",
        "url": "",
        "event_type": "social dance",
        "event_name": "10 Festivals in European Capitals",
        "day_of_week": "Sunday",
        "start_date": "2025-07-01",
        "end_date": "2025-07-01",
        "start_time": "04:14",
        "end_time": "null",
        "price": "",
        "location": "https://tangofestivals.net/festivals-in-european-capitals/",
        "description": "Berlin, Paris, Rome: Some of the famous Tango events with the longest trajectories are Festivals in European Capitals. Are they worth it? Or is it just an overcrowded hassle? Let´s find out! Tango Festivals can be intense experiences, for some dancers, the immersion is so complete that"
    },
    {
        "source": "<The original source of information for this event>",
        "dance_style": "tango",
        "url": "",
        "event_type": "class",
        "event_name": "Improve your dancing at Tango Festivals",
        "day_of_week": "Wednesday",
        "start_date": "2025-07-04",
        "end_date": "2025-07-04",
        "start_time": "",
        "end_time": "null",
        "price": "",
        "location": "https://tangofestivals.net/learn-tango-at-festivals/",
        "description": "Should you try to learn Tango at Festivals? Have you ever wondered whether a Tango Festival is a good place to improve your dancing skills? Is it worth your time and money to sign up for the festival´s workshops and classes ‐ or is it better to just enjoy the milongas and balls? Well, we"
    },
    {
        "source": "<The original source of information for this event>",
        "dance_style": "tango",
        "url": "",
        "event_type": "other",
        "event_name": "Pack your bags and visit the next Tango Festival",
        "day_of_week": "Wednesday",
        "start_date": "2025-07-04",
        "end_date": "2025-07-04",
        "start_time": "",
        "end_time": "null",
        "price": "",
        "location": "https://tangofestivals.net/packing-list/",
        "description": "Packing Panic when you think of the upcoming Tango Festival? We´ll guide you through the stuff you can leave a home and the items you absolutely want to have with you, your personal packing list. Do you really need that much? Tango Festivals can be an intense experience. Many veteran dancers describe their first festival"
    },
    {
        "source": "<The original source of information for this event>",
        "dance_style": "tango",
        "url": "",
        "event_type": "other",
        "event_name": "Festival, Vacation or Marathon – You decide!",
        "day_of_week": "Wednesday",
        "start_date": "2025-07-04",
        "end_date": "2025-07-04",
        "start_time": "03:06",
        "end_time": "null",
        "price": "",
        "location": "https://tangofestivals.net/festival-or-marathon/",
        "description": "Festivals, Festivalitos or Fests? Vacations or Holidays? Encuentros, Tango Weeks, Tango Meets, Workshops, Seminars, Tango Retreats, Tango Experiences… Are you getting confused about all these tango event labels? First, it´s good to understand the main categories: Tango Festival or Marathon ‐ and then we deal with vacation, the hybrids, crossovers, and fusions. Tango Festival or"
    }
]
```
2025-06-18 15:00:01 [root] INFO: def extract_and_parse_json(): for url https://tangofestivals.net/blog/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "<The original source of information for this event>",
        "dance_style": "tango",
        "url": "",
        "event_type": "social dance",
        "event_name": "10 Festivals in European Capitals",
        "day_of_week": "Sunday",
        "start_date": "2025-07-01",
        "end_date": "2025-07-01",
        "start_time": "04:14",
        "end_time": "null",
        "price": "",
        "location": "https://tangofestivals.net/festivals-in-european-capitals/",
        "description": "Berlin, Paris, Rome: Some of the famous Tango events with the longest trajectories are Festivals in European Capitals. Are they worth it? Or is it just an overcrowded hassle? Let´s find out! Tango Festivals can be intense experiences, for some dancers, the immersion is so complete that"
    },
    {
        "source": "<The original source of information for this event>",
        "dance_style": "tango",
        "url": "",
        "event_type": "class",
        "event_name": "Improve your dancing at Tango Festivals",
        "day_of_week": "Wednesday",
        "start_date": "2025-07-04",
        "end_date": "2025-07-04",
        "start_time": "",
        "end_time": "null",
        "price": "",
        "location": "https://tangofestivals.net/learn-tango-at-festivals/",
        "description": "Should you try to learn Tango at Festivals? Have you ever wondered whether a Tango Festival is a good place to improve your dancing skills? Is it worth your time and money to sign up for the festival´s workshops and classes ‐ or is it better to just enjoy the milongas and balls? Well, we"
    },
    {
        "source": "<The original source of information for this event>",
        "dance_style": "tango",
        "url": "",
        "event_type": "other",
        "event_name": "Pack your bags and visit the next Tango Festival",
        "day_of_week": "Wednesday",
        "start_date": "2025-07-04",
        "end_date": "2025-07-04",
        "start_time": "",
        "end_time": "null",
        "price": "",
        "location": "https://tangofestivals.net/packing-list/",
        "description": "Packing Panic when you think of the upcoming Tango Festival? We´ll guide you through the stuff you can leave a home and the items you absolutely want to have with you, your personal packing list. Do you really need that much? Tango Festivals can be an intense experience. Many veteran dancers describe their first festival"
    },
    {
        "source": "<The original source of information for this event>",
        "dance_style": "tango",
        "url": "",
        "event_type": "other",
        "event_name": "Festival, Vacation or Marathon – You decide!",
        "day_of_week": "Wednesday",
        "start_date": "2025-07-04",
        "end_date": "2025-07-04",
        "start_time": "03:06",
        "end_time": "null",
        "price": "",
        "location": "https://tangofestivals.net/festival-or-marathon/",
        "description": "Festivals, Festivalitos or Fests? Vacations or Holidays? Encuentros, Tango Weeks, Tango Meets, Workshops, Seminars, Tango Retreats, Tango Experiences… Are you getting confused about all these tango event labels? First, it´s good to understand the main categories: Tango Festival or Marathon ‐ and then we deal with vacation, the hybrids, crossovers, and fusions. Tango Festival or"
    }
]
2025-06-18 15:00:01 [root] INFO: def clean_up_address(): Starting with events_df shape: (4, 14)
2025-06-18 15:00:02 [root] INFO: def clean_up_address(): Processing location 'https://tangofestivals.net/festivals-in-european-capitals/' (event_id: None)
2025-06-18 15:00:02 [root] INFO: def clean_up_address(): Processing location 'https://tangofestivals.net/learn-tango-at-festivals/' (event_id: None)
2025-06-18 15:00:02 [root] INFO: def clean_up_address(): Processing location 'https://tangofestivals.net/packing-list/' (event_id: None)
2025-06-18 15:00:02 [root] INFO: def clean_up_address(): Processing location 'https://tangofestivals.net/festival-or-marathon/' (event_id: None)
2025-06-18 15:00:02 [root] INFO: write_events_to_db: Number of events to write: 4
2025-06-18 15:00:02 [root] INFO: write_url_to_db(): appended URL 'https://tangofestivals.net/blog/'
2025-06-18 15:00:02 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 15:00:02 [root] INFO: def process_llm_response: URL https://tangofestivals.net/blog/ marked as relevant with events written to the database.
2025-06-18 15:00:02 [root] INFO: write_url_to_db(): appended URL 'https://tangofestivals.net/blog/'
2025-06-18 15:00:02 [root] INFO: def parse(): URL https://tangofestivals.net/blog/ marked as relevant (LLM positive).
2025-06-18 15:00:02 [root] INFO: def parse(): Found 10 links on https://tangofestivals.net/blog/
2025-06-18 15:00:02 [root] INFO: should_process_url: URL https://tangofestivals.net/location/ has never been seen before, processing it.
2025-06-18 15:00:02 [root] INFO: should_process_url: URL https://tangofestivals.net/ has never been seen before, processing it.
2025-06-18 15:00:02 [root] INFO: should_process_url: URL https://tangofestivals.net/category/festival-experiences/ has never been seen before, processing it.
2025-06-18 15:00:02 [root] INFO: should_process_url: URL https://tangofestivals.net/category/festival-locations/ has never been seen before, processing it.
2025-06-18 15:00:02 [root] INFO: should_process_url: URL https://tangofestivals.net/location/Argentina/ has never been seen before, processing it.
2025-06-18 15:00:02 [root] INFO: should_process_url: URL https://tangofestivals.net/blog/ has never been seen before, processing it.
2025-06-18 15:00:02 [root] INFO: should_process_url: URL https://tangofestivals.net/location/United-States/ has never been seen before, processing it.
2025-06-18 15:00:02 [root] INFO: should_process_url: URL https://tangofestivals.net/category/festival-guides/ has never been seen before, processing it.
2025-06-18 15:00:02 [root] INFO: def parse(): Found keywords for URL https://tangofestivals.net/category/festival-experiences/: ['dance', 'milonga', 'swing', 'tango']
2025-06-18 15:00:02 [root] INFO: def generate_prompt(): Generating prompt for URL: https://tangofestivals.net/category/festival-experiences/
2025-06-18 15:00:02 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:00:02 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:00:02 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:00:23 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:00:23 [root] INFO: query_llm(): Mistral response received: <metaname="generator" content="WordPress 6.8.1">
<meta name="generator" content="WooCommerce 8.2.1">
<link rel="icon" href="https://tangofestivals.net/wp-content/uploads/2023/06/cropped-cropped-LogoCoupleDancing-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://tangofestivals.net/wp-content/uploads/2023/06/cropped-cropped-LogoCoupleDancing-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://tangofestivals.net/wp-content/uploads/2023/06/cropped-cropped-LogoCoupleDancing-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://tangofestivals.net/wp-content/uploads/2023/06/cropped-cropped-LogoCoupleDancing-1-270x270.png" />
2025-06-18 15:00:23 [root] ERROR: def extract_and_parse_json(): couldn't isolate JSON blob in result from https://tangofestivals.net/category/festival-experiences/
2025-06-18 15:00:23 [root] INFO: write_url_to_db(): appended URL 'https://tangofestivals.net/category/festival-experiences/'
2025-06-18 15:00:23 [root] INFO: def parse(): URL https://tangofestivals.net/category/festival-experiences/ marked as irrelevant (LLM negative).
2025-06-18 15:00:23 [root] INFO: def parse(): Found 10 links on https://tangofestivals.net/category/festival-experiences/
2025-06-18 15:00:23 [root] INFO: should_process_url: URL https://tangofestivals.net/location/ has never been seen before, processing it.
2025-06-18 15:00:23 [root] INFO: should_process_url: URL https://tangofestivals.net/ has never been seen before, processing it.
2025-06-18 15:00:23 [root] INFO: should_process_url: URL https://tangofestivals.net/category/festival-experiences/ has never been seen before, processing it.
2025-06-18 15:00:23 [root] INFO: should_process_url: URL https://tangofestivals.net/category/festival-locations/ has never been seen before, processing it.
2025-06-18 15:00:24 [root] INFO: should_process_url: URL https://tangofestivals.net/location/Argentina/ has never been seen before, processing it.
2025-06-18 15:00:24 [root] INFO: should_process_url: URL https://tangofestivals.net/blog/ has never been seen before, processing it.
2025-06-18 15:00:24 [root] INFO: should_process_url: URL https://tangofestivals.net/location/United-States/ has never been seen before, processing it.
2025-06-18 15:00:24 [root] INFO: should_process_url: URL https://tangofestivals.net/category/festival-guides/ has never been seen before, processing it.
2025-06-18 15:00:24 [root] INFO: def parse(): Found keywords for URL https://tangofestivals.net/location/Argentina/: ['milonga', 'swing', 'tango']
2025-06-18 15:00:24 [root] INFO: def generate_prompt(): Generating prompt for URL: https://tangofestivals.net/location/Argentina/
2025-06-18 15:00:24 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:00:24 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:00:24 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:01:22 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:01:22 [root] INFO: query_llm(): Mistral response received: 		<linkrel='stylesheet' id='wp-block-library-css' href='https://tangofestivals.net/wp-includes/css/dist/block-library/style.min.css?ver=6.8.1' media='all' />
<link rel='stylesheet' id='wp-block-library-theme-css' href='https://tangofestivals.net/wp-includes/css/dist/block-library/theme.min.css?ver=6.8.1' media='all' />
<link rel='stylesheet' id='global-styles-inline-css' href='https://tangofestivals.net/wp-content/themes/generatepress/style-20230508.css?ver=3.5.1' media='all' />
<link rel='stylesheet' id='generateblocks-inline-css' href='https://tangofestivals.net/wp-content/uploads/2023/06/generateblocks-dynamic-css-1686066756.min.css?ver=3.5.1' media='all' />
<link rel='stylesheet' id='generatepress-fonts-css' href='https://fonts.googleapis.com/css?family=Limelight%3Aregular&#038;display=auto&#038;ver=3.5.1' media='all' />
<link rel='stylesheet' id='akismet-widget-style-inline-css' href='https://tangofestivals.net/wp-content/plugins/akismet/css/akismet-widget.min.css?ver=5.1.0' media='all' />
<link rel='stylesheet' id='font-awesome-css' href='https://use.fontawesome.com/releases/v6.7.2/css/all.css?ver=3.5.1' media='all' />
<link rel='stylesheet' id='ayecode-ui-inline-css' href='https://tangofestivals.net/wp-content/plugins/geodirectory/vendor/ayecode/wp-ayecode-ui/assets/css/ayecode-ui-compatibility.css?ver=0.2.37' media='all' />
<link rel='stylesheet' id='generate-google-fonts-css' href='https://fonts.googleapis.com/css?family=Limelight%3Aregular&#038;display=auto&#038;ver=3.5.1' media='all' />
<link rel='stylesheet' id='flatpickr-css' href='https://tangofestivals.net/wp-content/plugins/geodirectory/vendor/ayecode/wp-ayecode-ui/assets/css/flatpickr.min.css?ver=0.2.37' media='all' />
2025-06-18 15:01:22 [root] ERROR: def extract_and_parse_json(): couldn't isolate JSON blob in result from https://tangofestivals.net/location/Argentina/
2025-06-18 15:01:22 [root] INFO: write_url_to_db(): appended URL 'https://tangofestivals.net/location/Argentina/'
2025-06-18 15:01:22 [root] INFO: def parse(): URL https://tangofestivals.net/location/Argentina/ marked as irrelevant (LLM negative).
2025-06-18 15:01:22 [root] INFO: def parse(): Found 10 links on https://tangofestivals.net/location/Argentina/
2025-06-18 15:01:22 [root] INFO: should_process_url: URL https://tangofestivals.net/location/ has never been seen before, processing it.
2025-06-18 15:01:22 [root] INFO: should_process_url: URL https://tangofestivals.net/ has never been seen before, processing it.
2025-06-18 15:01:22 [root] INFO: should_process_url: URL https://tangofestivals.net/category/festival-experiences/ has never been seen before, processing it.
2025-06-18 15:01:22 [root] INFO: should_process_url: URL https://tangofestivals.net/category/festival-locations/ has never been seen before, processing it.
2025-06-18 15:01:22 [root] INFO: should_process_url: URL https://tangofestivals.net/location/Argentina/ has never been seen before, processing it.
2025-06-18 15:01:22 [root] INFO: should_process_url: URL https://tangofestivals.net/blog/ has never been seen before, processing it.
2025-06-18 15:01:22 [root] INFO: should_process_url: URL https://tangofestivals.net/location/United-States/ has never been seen before, processing it.
2025-06-18 15:01:22 [root] INFO: should_process_url: URL https://tangofestivals.net/category/festival-guides/ has never been seen before, processing it.
2025-06-18 15:01:22 [root] INFO: def parse(): Found keywords for URL https://tangofestivals.net/location/: ['argentine tango', 'dance', 'milonga', 'swing', 'tango']
2025-06-18 15:01:22 [root] INFO: def generate_prompt(): Generating prompt for URL: https://tangofestivals.net/location/
2025-06-18 15:01:22 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:01:22 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:01:22 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:16:23 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 504 Gateway Timeout"
2025-06-18 15:16:23 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 504
{
  "message":"The upstream server is timing out",
  "request_id":"00cdc4574d464174a2d56a798eb50a31"
}
2025-06-18 15:16:23 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 15:17:45 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:17:45 [root] INFO: query_llm(): OpenAI response received: [{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"social dance","event_name":"Fethiye Tango Marathon","day_of_week":"Thursday","start_date":"2025-06-19","end_date":"2025-06-22","start_time":"","end_time":"","price":"","location":"Fethiye, Turkey","description":"Fethiye Tango Marathon Are you ready to say hello to summer for the third time in our little paradise Fethiye…"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"social dance","event_name":"El Yeite Tango Fiesta 2025 Marathon Party","day_of_week":"Thursday","start_date":"2025-06-19","end_date":"2025-06-22","start_time":"","end_time":"","price":"","location":"Budapest, Hungary","description":"El Yeite Tango Fiesta 2025 Marathon Party June 19–22,2025 Dj Octavio Fernandez, Balazs, Andres Molina, Yanina Erramosupe, Dusika"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"social dance","event_name":"Color Cielo Festival","day_of_week":"Thursday","start_date":"2025-06-19","end_date":"2025-06-22","start_time":"","end_time":"","price":"","location":"Girona, Spain","description":"Color Cielo Festival Program THURSDAY, JUNE 19 ​20:30 – REGISTRATION 20:45 – Mauro and Joanna Class 22:00-03:00 – Milonga Show Welcome – Ronda"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"social dance","event_name":"Select Tango Weekend at The Art Museum Hotel","day_of_week":"Thursday","start_date":"2025-06-19","end_date":"2025-06-22","start_time":"","end_time":"","price":"","location":"Beijing, China","description":"Select Tango Weekend at The Art Museum Hotel Experience the magic of Argentine tango at the Select Tango Weekend, June"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"workshop","event_name":"Tango Focus del Alma with Guille “El Peque” Barrionuevo and Sol Cerquides","day_of_week":"Thursday","start_date":"2025-06-19","end_date":"2025-06-22","start_time":"","end_time":"","price":"","location":"Timișoara, Romania","description":"Tango Focus del Alma with Guille “El Peque” Barrionuevo and Sol Cerquides Tango Focus by Tango del Alma, 2025, 7th"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"social dance","event_name":"Strawberry Tango Marathon","day_of_week":"Friday","start_date":"2025-06-20","end_date":"2025-06-22","start_time":"","end_time":"","price":"","location":"Lodz, Poland","description":"Strawberry Tango Marathon This year, we invite all of you who want to dance tango and meet again with friends"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"social dance","event_name":"Zaragoza Milonguera","day_of_week":"Friday","start_date":"2025-06-20","end_date":"2025-06-22","start_time":"","end_time":"","price":"","location":"Zaragoza, Spain","description":"Zaragoza Milonguera We are pleased to announce a tango event that will celebrate the passion and art of milonguero in"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"class","event_name":"Warsaw Tango Meeting 2025","day_of_week":"Friday","start_date":"2025-06-20","end_date":"2025-06-22","start_time":"","end_time":"","price":"","location":"Warsaw, Poland","description":"Warsaw Tango Meeting 2025 Warsaw Tango Meeting 2025 with Jonathan Saavedra and Clarisa Aragn 20-22 June 2025 , Warsaw ,"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"social dance","event_name":"Festivalito Ty Tango","day_of_week":"Friday","start_date":"2025-06-20","end_date":"2025-06-22","start_time":"","end_time":"","price":"","location":"Séné, France","description":"Festivalito Ty Tango June 20–22, 2025 Music: Sonder tango DJs: Martin Lionti, Brahim, Yuliya, El Doble"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"social dance","event_name":"Summer Tango Feast","day_of_week":"Friday","start_date":"2025-06-20","end_date":"2025-06-22","start_time":"","end_time":"","price":"","location":"Devon, United Kingdom","description":"Summer Tango Feast 3 days of total tango immersion At the Victoria Hotel on The English Riviera Everything happens in"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"social dance","event_name":"Garúa Milonguero Craícfest","day_of_week":"Thursday","start_date":"2025-06-26","end_date":"2025-06-30","start_time":"","end_time":"","price":"","location":"Kildare, Ireland","description":"Garúa Milonguero Craícfest Craicfest is a word that dates back into the mists of ancient Irish history; in other words"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"workshop","event_name":"Catania Summer Tango Week","day_of_week":"Thursday","start_date":"2025-06-26","end_date":"2025-06-29","start_time":"","end_time":"","price":"","location":"Catania, Italy","description":"Catania Summer Tango Week THE SUMMER TANGO WEEK IS A CULTURAL NON-PROFIT EVENT,  RESERVED FOR TANGOSTUDIOCATANIA MEMBERS YOU CAN FIND ALL"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"workshop","event_name":"Cyprus Tango Camp","day_of_week":"Thursday","start_date":"2025-06-26","end_date":"2025-06-29","start_time":"","end_time":"","price":"","location":"Nicosia, Cyprus","description":"Cyprus Tango Camp June 26–29, 2025"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"social dance","event_name":"Tango Festival Alegria en Brzeg","day_of_week":"Thursday","start_date":"2025-06-26","end_date":"2025-06-29","start_time":"","end_time":"","price":"","location":"Brzeg, Poland","description":"Tango Festival Alegria en Brzeg June 26–29,2025"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"social dance","event_name":"Tangopostale International Tango Festival","day_of_week":"Friday","start_date":"2025-06-27","end_date":"2025-07-06","start_time":"","end_time":"","price":"","location":"Toulouse, France","description":"Tangopostale International Tango Festival June 27 – July 6, 2025"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"social dance","event_name":"BIG FISH Tango Marathon","day_of_week":"Friday","start_date":"2025-06-27","end_date":"2025-06-29","start_time":"","end_time":"","price":"","location":"Sète, France","description":"BIG FISH Tango Marathon Welcome to the Big Fish Tango Marathon 2025, a colorful event ! On June 27/28/29, we’re taking"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"social dance","event_name":"Tango Beach Holiday","day_of_week":"Saturday","start_date":"2025-06-28","end_date":"2025-07-05","start_time":"","end_time":"","price":"","location":"Myrthianos Plakias, Greece","description":"Tango Beach Holiday June 28 – July 5 Maestros: Matías Iriarte & Susanne Mühlhaus"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"workshop","event_name":"Tango Yoga Retreat with Roxana Suarez","day_of_week":"Monday","start_date":"2025-06-30","end_date":"2025-07-05","start_time":"","end_time":"","price":"","location":"Crespin, France","description":"Tango Yoga Retreat with Roxana Suarez June 30 – July 5 Maestros: Roxana Suarez"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"social dance","event_name":"Mediterranean Summer Tango Festival","day_of_week":"Wednesday","start_date":"2025-07-02","end_date":"2025-07-07","start_time":"","end_time":"","price":"","location":"Brulo, Croatia","description":"Mediterranean Summer Tango Festival For over a decade, countless cherished memories have been created on many of its dance floors."},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"social dance","event_name":"Benia Tango Fest Asturias","day_of_week":"Thursday","start_date":"2025-07-03","end_date":"2025-07-06","start_time":"","end_time":"","price":"","location":"Benia de Onís, Spain","description":"Benia Tango Fest Asturias In this second edition of BTF, we invite you to enjoy tango in a beautiful setting"}]
2025-06-18 15:17:45 [root] INFO: def extract_and_parse_json(): for url https://tangofestivals.net/location/, 
Cleaned JSON ready for parsing:
[{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"social dance","event_name":"Fethiye Tango Marathon","day_of_week":"Thursday","start_date":"2025-06-19","end_date":"2025-06-22","start_time":"","end_time":"","price":"","location":"Fethiye, Turkey","description":"Fethiye Tango Marathon Are you ready to say hello to summer for the third time in our little paradise Fethiye…"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"social dance","event_name":"El Yeite Tango Fiesta 2025 Marathon Party","day_of_week":"Thursday","start_date":"2025-06-19","end_date":"2025-06-22","start_time":"","end_time":"","price":"","location":"Budapest, Hungary","description":"El Yeite Tango Fiesta 2025 Marathon Party June 19–22,2025 Dj Octavio Fernandez, Balazs, Andres Molina, Yanina Erramosupe, Dusika"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"social dance","event_name":"Color Cielo Festival","day_of_week":"Thursday","start_date":"2025-06-19","end_date":"2025-06-22","start_time":"","end_time":"","price":"","location":"Girona, Spain","description":"Color Cielo Festival Program THURSDAY, JUNE 19 ​20:30 – REGISTRATION 20:45 – Mauro and Joanna Class 22:00-03:00 – Milonga Show Welcome – Ronda"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"social dance","event_name":"Select Tango Weekend at The Art Museum Hotel","day_of_week":"Thursday","start_date":"2025-06-19","end_date":"2025-06-22","start_time":"","end_time":"","price":"","location":"Beijing, China","description":"Select Tango Weekend at The Art Museum Hotel Experience the magic of Argentine tango at the Select Tango Weekend, June"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"workshop","event_name":"Tango Focus del Alma with Guille “El Peque” Barrionuevo and Sol Cerquides","day_of_week":"Thursday","start_date":"2025-06-19","end_date":"2025-06-22","start_time":"","end_time":"","price":"","location":"Timișoara, Romania","description":"Tango Focus del Alma with Guille “El Peque” Barrionuevo and Sol Cerquides Tango Focus by Tango del Alma, 2025, 7th"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"social dance","event_name":"Strawberry Tango Marathon","day_of_week":"Friday","start_date":"2025-06-20","end_date":"2025-06-22","start_time":"","end_time":"","price":"","location":"Lodz, Poland","description":"Strawberry Tango Marathon This year, we invite all of you who want to dance tango and meet again with friends"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"social dance","event_name":"Zaragoza Milonguera","day_of_week":"Friday","start_date":"2025-06-20","end_date":"2025-06-22","start_time":"","end_time":"","price":"","location":"Zaragoza, Spain","description":"Zaragoza Milonguera We are pleased to announce a tango event that will celebrate the passion and art of milonguero in"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"class","event_name":"Warsaw Tango Meeting 2025","day_of_week":"Friday","start_date":"2025-06-20","end_date":"2025-06-22","start_time":"","end_time":"","price":"","location":"Warsaw, Poland","description":"Warsaw Tango Meeting 2025 Warsaw Tango Meeting 2025 with Jonathan Saavedra and Clarisa Aragn 20-22 June 2025 , Warsaw ,"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"social dance","event_name":"Festivalito Ty Tango","day_of_week":"Friday","start_date":"2025-06-20","end_date":"2025-06-22","start_time":"","end_time":"","price":"","location":"Séné, France","description":"Festivalito Ty Tango June 20–22, 2025 Music: Sonder tango DJs: Martin Lionti, Brahim, Yuliya, El Doble"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"social dance","event_name":"Summer Tango Feast","day_of_week":"Friday","start_date":"2025-06-20","end_date":"2025-06-22","start_time":"","end_time":"","price":"","location":"Devon, United Kingdom","description":"Summer Tango Feast 3 days of total tango immersion At the Victoria Hotel on The English Riviera Everything happens in"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"social dance","event_name":"Garúa Milonguero Craícfest","day_of_week":"Thursday","start_date":"2025-06-26","end_date":"2025-06-30","start_time":"","end_time":"","price":"","location":"Kildare, Ireland","description":"Garúa Milonguero Craícfest Craicfest is a word that dates back into the mists of ancient Irish history; in other words"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"workshop","event_name":"Catania Summer Tango Week","day_of_week":"Thursday","start_date":"2025-06-26","end_date":"2025-06-29","start_time":"","end_time":"","price":"","location":"Catania, Italy","description":"Catania Summer Tango Week THE SUMMER TANGO WEEK IS A CULTURAL NON-PROFIT EVENT,  RESERVED FOR TANGOSTUDIOCATANIA MEMBERS YOU CAN FIND ALL"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"workshop","event_name":"Cyprus Tango Camp","day_of_week":"Thursday","start_date":"2025-06-26","end_date":"2025-06-29","start_time":"","end_time":"","price":"","location":"Nicosia, Cyprus","description":"Cyprus Tango Camp June 26–29, 2025"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"social dance","event_name":"Tango Festival Alegria en Brzeg","day_of_week":"Thursday","start_date":"2025-06-26","end_date":"2025-06-29","start_time":"","end_time":"","price":"","location":"Brzeg, Poland","description":"Tango Festival Alegria en Brzeg June 26–29,2025"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"social dance","event_name":"Tangopostale International Tango Festival","day_of_week":"Friday","start_date":"2025-06-27","end_date":"2025-07-06","start_time":"","end_time":"","price":"","location":"Toulouse, France","description":"Tangopostale International Tango Festival June 27 – July 6, 2025"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"social dance","event_name":"BIG FISH Tango Marathon","day_of_week":"Friday","start_date":"2025-06-27","end_date":"2025-06-29","start_time":"","end_time":"","price":"","location":"Sète, France","description":"BIG FISH Tango Marathon Welcome to the Big Fish Tango Marathon 2025, a colorful event ! On June 27/28/29, we’re taking"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"social dance","event_name":"Tango Beach Holiday","day_of_week":"Saturday","start_date":"2025-06-28","end_date":"2025-07-05","start_time":"","end_time":"","price":"","location":"Myrthianos Plakias, Greece","description":"Tango Beach Holiday June 28 – July 5 Maestros: Matías Iriarte & Susanne Mühlhaus"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"workshop","event_name":"Tango Yoga Retreat with Roxana Suarez","day_of_week":"Monday","start_date":"2025-06-30","end_date":"2025-07-05","start_time":"","end_time":"","price":"","location":"Crespin, France","description":"Tango Yoga Retreat with Roxana Suarez June 30 – July 5 Maestros: Roxana Suarez"},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"social dance","event_name":"Mediterranean Summer Tango Festival","day_of_week":"Wednesday","start_date":"2025-07-02","end_date":"2025-07-07","start_time":"","end_time":"","price":"","location":"Brulo, Croatia","description":"Mediterranean Summer Tango Festival For over a decade, countless cherished memories have been created on many of its dance floors."},{"source":"TangoFestivals","dance_style":"tango","url":"","event_type":"social dance","event_name":"Benia Tango Fest Asturias","day_of_week":"Thursday","start_date":"2025-07-03","end_date":"2025-07-06","start_time":"","end_time":"","price":"","location":"Benia de Onís, Spain","description":"Benia Tango Fest Asturias In this second edition of BTF, we invite you to enjoy tango in a beautiful setting"}]
2025-06-18 15:17:45 [root] INFO: def clean_up_address(): Starting with events_df shape: (20, 14)
2025-06-18 15:17:45 [root] INFO: def clean_up_address(): Processing location 'Fethiye, Turkey' (event_id: None)
2025-06-18 15:17:45 [root] INFO: def clean_up_address(): Processing location 'Budapest, Hungary' (event_id: None)
2025-06-18 15:17:45 [root] INFO: def clean_up_address(): Processing location 'Girona, Spain' (event_id: None)
2025-06-18 15:17:45 [root] INFO: def clean_up_address(): Processing location 'Beijing, China' (event_id: None)
2025-06-18 15:17:45 [root] INFO: def clean_up_address(): Processing location 'Timișoara, Romania' (event_id: None)
2025-06-18 15:17:45 [root] INFO: def clean_up_address(): Processing location 'Lodz, Poland' (event_id: None)
2025-06-18 15:17:45 [root] INFO: def clean_up_address(): Processing location 'Zaragoza, Spain' (event_id: None)
2025-06-18 15:17:45 [root] INFO: def clean_up_address(): Processing location 'Warsaw, Poland' (event_id: None)
2025-06-18 15:17:45 [root] INFO: def clean_up_address(): Processing location 'Séné, France' (event_id: None)
2025-06-18 15:17:45 [root] INFO: def clean_up_address(): Processing location 'Devon, United Kingdom' (event_id: None)
2025-06-18 15:17:45 [root] INFO: def clean_up_address(): Processing location 'Kildare, Ireland' (event_id: None)
2025-06-18 15:17:45 [root] INFO: def clean_up_address(): Processing location 'Catania, Italy' (event_id: None)
2025-06-18 15:17:45 [root] INFO: def clean_up_address(): Processing location 'Nicosia, Cyprus' (event_id: None)
2025-06-18 15:17:45 [root] INFO: def clean_up_address(): Processing location 'Brzeg, Poland' (event_id: None)
2025-06-18 15:17:45 [root] INFO: def clean_up_address(): Processing location 'Toulouse, France' (event_id: None)
2025-06-18 15:17:45 [root] INFO: def clean_up_address(): Processing location 'Sète, France' (event_id: None)
2025-06-18 15:17:45 [root] INFO: def clean_up_address(): Processing location 'Myrthianos Plakias, Greece' (event_id: None)
2025-06-18 15:17:45 [root] INFO: def clean_up_address(): Processing location 'Crespin, France' (event_id: None)
2025-06-18 15:17:45 [root] INFO: def clean_up_address(): Processing location 'Brulo, Croatia' (event_id: None)
2025-06-18 15:17:45 [root] INFO: def clean_up_address(): Processing location 'Benia de Onís, Spain' (event_id: None)
2025-06-18 15:17:45 [root] INFO: write_events_to_db: Number of events to write: 20
2025-06-18 15:17:45 [root] INFO: write_url_to_db(): appended URL 'https://tangofestivals.net/location/'
2025-06-18 15:17:45 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 15:17:45 [root] INFO: def process_llm_response: URL https://tangofestivals.net/location/ marked as relevant with events written to the database.
2025-06-18 15:17:45 [root] INFO: write_url_to_db(): appended URL 'https://tangofestivals.net/location/'
2025-06-18 15:17:45 [root] INFO: def parse(): URL https://tangofestivals.net/location/ marked as relevant (LLM positive).
2025-06-18 15:17:45 [root] INFO: def parse(): Found 10 links on https://tangofestivals.net/location/
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://tangofestivals.net/location/ has never been seen before, processing it.
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://tangofestivals.net/ has never been seen before, processing it.
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://tangofestivals.net/category/festival-experiences/ has never been seen before, processing it.
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://tangofestivals.net/category/festival-locations/ has never been seen before, processing it.
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://tangofestivals.net/location/Argentina/ has never been seen before, processing it.
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://tangofestivals.net/blog/ has never been seen before, processing it.
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://tangofestivals.net/location/United-States/ has never been seen before, processing it.
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://tangofestivals.net/category/festival-guides/ has never been seen before, processing it.
2025-06-18 15:17:45 [twisted] CRITICAL: 
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/protocols/tls.py", line 247, in _checkHandshakeStatus
    self._tlsConnection.do_handshake()
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/OpenSSL/SSL.py", line 2361, in do_handshake
    self._raise_ssl_error(self._ssl, result)
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/OpenSSL/SSL.py", line 1951, in _raise_ssl_error
    raise ZeroReturnError()
OpenSSL.SSL.ZeroReturnError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/asyncioreactor.py", line 138, in _readOrWrite
    why = method()
          ^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/tcp.py", line 250, in doRead
    return self._dataReceived(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/tcp.py", line 255, in _dataReceived
    rval = self.protocol.dataReceived(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/endpoints.py", line 156, in dataReceived
    return self._wrappedProtocol.dataReceived(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/protocols/tls.py", line 324, in dataReceived
    self._checkHandshakeStatus()
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/protocols/tls.py", line 251, in _checkHandshakeStatus
    self._tlsShutdownFinished(Failure())
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/protocols/tls.py", line 377, in _tlsShutdownFinished
    if _representsEOF(reason.value):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/protocols/tls.py", line 121, in _representsEOF
    errorQueue = exceptionObject.args[0]
                 ~~~~~~~~~~~~~~~~~~~~^^^
IndexError: tuple index out of range
2025-06-18 15:17:45 [root] INFO: parse: Skipping blacklisted URL http://wordpress.org/.
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/club/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/category/uncategorized/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/visit/ was last seen as relevant, processing it.
2025-06-18 15:17:45 [scrapy.extensions.logstats] INFO: Crawled 165 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://www.eventbrite.com/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/signup/?referrer=%2Fmytickets was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/sell-tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/signup/?referrer=%2F was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/signup/?referrer=%2F was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:17:45 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/signin/signup/?referrer=%2F'
2025-06-18 15:17:45 [root] INFO: def parse(): Crawling next URL: https://www.eventbrite.com/signin/signup/?referrer=%2F
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/event-marketing-platform/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/event-payment/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://www.eventbrite.com/d/local/events/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/eventbrite-ads/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:17:45 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <403 https://www.yelp.ca/search?find_desc=Line+Dancing&find_loc=Victoria%2C+BC>: HTTP status code is not handled or not allowed
2025-06-18 15:17:45 [root] INFO: write_url_to_db(): appended URL 'https://rifflandia.com/'
2025-06-18 15:17:45 [root] INFO: def parse(): URL https://rifflandia.com/ marked as irrelevant (no keywords).
2025-06-18 15:17:45 [root] INFO: def parse(): Found 10 links on https://rifflandia.com/
2025-06-18 15:17:45 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-M3T3SQ6, URL: https://rifflandia.com/, source: Rifflandia Festival, keywords: music festivals
2025-06-18 15:17:45 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 15:17:45 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-M3T3SQ6
2025-06-18 15:17:45 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-M3T3SQ6'
2025-06-18 15:17:45 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/rifflandia'
2025-06-18 15:17:45 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/rifflandia
2025-06-18 15:17:45 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/RIFFLANDIA/'
2025-06-18 15:17:45 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/RIFFLANDIA/
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://rifflandia.com/customer_authentication/redirect?locale=en&region_country=CA was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://rifflandia.com/customer_authentication/redirect?locale=en&region_country=CA was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:17:45 [root] INFO: write_url_to_db(): appended URL 'https://rifflandia.com/customer_authentication/redirect?locale=en&region_country=CA'
2025-06-18 15:17:45 [root] INFO: def parse(): Crawling next URL: https://rifflandia.com/customer_authentication/redirect?locale=en&region_country=CA
2025-06-18 15:17:45 [root] INFO: parse: Skipping blacklisted URL https://www.tourismvictoria.com/.
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://westwoodrecordings.com/ was last seen as relevant, processing it.
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://westwoodrecordings.com/ was last seen as relevant, processing it.
2025-06-18 15:17:45 [root] INFO: write_url_to_db(): appended URL 'https://westwoodrecordings.com/'
2025-06-18 15:17:45 [root] INFO: def parse(): Crawling next URL: https://westwoodrecordings.com/
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://www.songheesdevco.com/economic-initiatives/business-partnerships/matullia-holdings-lp was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://www.songheesdevco.com/economic-initiatives/business-partnerships/matullia-holdings-lp was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:17:45 [root] INFO: write_url_to_db(): appended URL 'https://www.songheesdevco.com/economic-initiatives/business-partnerships/matullia-holdings-lp'
2025-06-18 15:17:45 [root] INFO: def parse(): Crawling next URL: https://www.songheesdevco.com/economic-initiatives/business-partnerships/matullia-holdings-lp
2025-06-18 15:17:45 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/channel/UCKxJ1I3kQFaf_ybbQC0VX8g.
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://musicbc.org/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://musicbc.org/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:17:45 [root] INFO: write_url_to_db(): appended URL 'https://musicbc.org/'
2025-06-18 15:17:45 [root] INFO: def parse(): Crawling next URL: https://musicbc.org/
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://rifflandia.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://rifflandia.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:17:45 [root] INFO: write_url_to_db(): appended URL 'https://rifflandia.com/'
2025-06-18 15:17:45 [root] INFO: def parse(): Crawling next URL: https://rifflandia.com/
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://creativebc.com/ has never been seen before, processing it.
2025-06-18 15:17:45 [root] INFO: should_process_url: URL https://creativebc.com/ has never been seen before, processing it.
2025-06-18 15:17:45 [root] INFO: write_url_to_db(): appended URL 'https://creativebc.com/'
2025-06-18 15:17:45 [root] INFO: def parse(): Crawling next URL: https://creativebc.com/
2025-06-18 15:17:45 [root] INFO: def parse(): Found keywords for URL https://pubmed.ncbi.nlm.nih.gov/31605958/: ['dance', 'music festivals']
2025-06-18 15:17:45 [root] INFO: def generate_prompt(): Generating prompt for URL: https://pubmed.ncbi.nlm.nih.gov/31605958/
2025-06-18 15:17:45 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:17:45 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:17:45 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:17:47 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:17:47 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 15:17:47 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 15:17:47 [root] INFO: write_url_to_db(): appended URL 'https://pubmed.ncbi.nlm.nih.gov/31605958/'
2025-06-18 15:17:47 [root] INFO: def parse(): URL https://pubmed.ncbi.nlm.nih.gov/31605958/ marked as irrelevant (LLM negative).
2025-06-18 15:17:47 [root] INFO: def parse(): Found 2 links on https://pubmed.ncbi.nlm.nih.gov/31605958/
2025-06-18 15:17:47 [root] INFO: should_process_url: URL https://doi.org/10.1016/j.drugalcdep.2019.107589 has never been seen before, processing it.
2025-06-18 15:17:47 [root] INFO: should_process_url: URL https://doi.org/10.1016/j.drugalcdep.2019.107589 has never been seen before, processing it.
2025-06-18 15:17:47 [root] INFO: write_url_to_db(): appended URL 'https://doi.org/10.1016/j.drugalcdep.2019.107589'
2025-06-18 15:17:47 [root] INFO: def parse(): Crawling next URL: https://doi.org/10.1016/j.drugalcdep.2019.107589
2025-06-18 15:17:47 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/signin/?referrer=%2F'
2025-06-18 15:17:47 [root] INFO: def parse(): URL https://www.eventbrite.com/signin/?referrer=%2F marked as irrelevant (no keywords).
2025-06-18 15:17:47 [root] INFO: def parse(): Found 0 links on https://www.eventbrite.com/signin/?referrer=%2F
2025-06-18 15:17:47 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ, URL: https://www.eventbrite.com/signin/?referrer=%2F, source: Argentine tango classes & related events | Eventbrite, keywords: argentine tango
2025-06-18 15:17:47 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 15:17:47 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ
2025-06-18 15:17:47 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ'
2025-06-18 15:17:47 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/?referrer=%2F was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:17:47 [root] INFO: def parse(): Found keywords for URL https://www.festivalseekers.com/story/20-plus-bc-summer-music-festivals-2024: ['dance', 'live music', 'music festivals', 'zouk']
2025-06-18 15:17:47 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.festivalseekers.com/story/20-plus-bc-summer-music-festivals-2024
2025-06-18 15:17:47 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:17:47 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:17:47 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:20:18 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:20:18 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Cowichan Valley Bluegrass Festival / Duncan BC",
        "day_of_week": "Friday",
        "start_date": "2025-06-14",
        "end_date": "2025-06-15",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Duncan BC",
        "description": "Mainstage, workshops and jam sessions, all about bluegrass on Vancouver Island."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "PRISMA Festival / Powell River BC",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-16",
        "end_date": "2025-06-28",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Powell River BC",
        "description": "Two weeks of orchestral music on the Sunshine Coast."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Victoria Ska Fest / Victoria British Columbia",
        "day_of_week": "Thursday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-22",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Victoria British Columbia",
        "description": "Coastal skankin' at its best."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "TD Victoria International Jazz Festival / Victoria BC",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-29",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Victoria BC",
        "description": "The port city comes alive with jazz as Madeleine Peyroux, Alex Cuba, Eliane Elias, and Richard Bona Asanté Trio headline the 2025 festival!"
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Vancouver International Jazz Festival / Vancouver BC",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-29",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Vancouver BC",
        "description": "The city of Vancouver will be grooving and bopping with the sound of jazz for 10 whole days!"
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Funtastic Sport and Music Festival / Vernon BC",
        "day_of_week": "Thursday",
        "start_date": "2025-06-28",
        "end_date": "2025-06-29",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Vernon BC",
        "description": "Slo-pitch and rock'n'roll go hand in hand, no?"
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Funtastic Alberni / Port Alberni BC",
        "day_of_week": "Friday",
        "start_date": "2025-06-28",
        "end_date": "2025-06-30",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Port Alberni BC",
        "description": "It's such a good party, they had it twice! Enjoy three days of slo-pitch and live music."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Kathaumixw / Powell River BC",
        "day_of_week": "Monday",
        "start_date": "2025-07-01",
        "end_date": "2025-07-05",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Powell River BC",
        "description": "A five-day choral fest with concerts, competitions, workshops and socials."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Smithers Midsummer Music Festival / Smithers BC",
        "day_of_week": "Friday",
        "start_date": "2025-07-04",
        "end_date": "2025-07-06",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Smithers BC",
        "description": "This chill northern BC town is a great place to dance like no one's watching."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Atlin Arts and Music Festival / Atlin BC",
        "day_of_week": "Thursday",
        "start_date": "2025-07-11",
        "end_date": "2025-07-13",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Atlin BC",
        "description": "The tiny town of Atlin (pop. 450) overflows with two days of music and fun."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Bass Coast / Merrit BC",
        "day_of_week": "Thursday",
        "start_date": "2025-07-11",
        "end_date": "2025-07-14",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Merrit BC",
        "description": "A thoughtfully curated boutique music and art festival featuring new electronic artists."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Salmon Arm Roots & Blues Festival / Salmon Arm BC",
        "day_of_week": "Friday",
        "start_date": "2025-07-25",
        "end_date": "2025-07-27",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Salmon Arm BC",
        "description": "One of the summer's biggest tickets in the heart of the Shuswap."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Shambhala Music Fest / Salmo BC",
        "day_of_week": "Friday",
        "start_date": "2025-07-25",
        "end_date": "2025-07-28",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Salmo BC",
        "description": "IYKYK: it's been named the best music festival in North America by DJ Mag (2019)."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Filberg Festival / Comox BC",
        "day_of_week": "Friday",
        "start_date": "2025-08-01",
        "end_date": "2025-08-03",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Comox BC",
        "description": "Arts, crafts and live music in Comox."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Texada Roots & Blues Festival / Texada Island BC",
        "day_of_week": "Saturday",
        "start_date": "2025-08-02",
        "end_date": "2025-08-03",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Texada Island BC",
        "description": "Island grooves dominate Texada."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Nanaimo Blues Festival / Nanaimo BC",
        "day_of_week": "Thursday",
        "start_date": "2025-08-08",
        "end_date": "2025-08-10",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Nanaimo BC",
        "description": "The annual festival is back again in 2025 with some great blues for the summer."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Wapiti Music Festival / Fernie BC",
        "day_of_week": "Thursday",
        "start_date": "2025-08-08",
        "end_date": "2025-08-09",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Fernie BC",
        "description": "Fernie's big summer music fest."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Five Acre Shaker / Port Alberni, BC",
        "day_of_week": "Thursday",
        "start_date": "2025-08-08",
        "end_date": "2025-08-09",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Port Alberni, BC",
        "description": "An epic coastal shaker full of groove and good vibes."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Robson Valley Music Festival / Dunster BC",
        "day_of_week": "Thursday",
        "start_date": "2025-08-29",
        "end_date": "2025-08-31",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Dunster BC",
        "description": "A fest with a loyal following, for its friendly, funky, fun community and great shows."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Rifflandia 2025 / Victoria BC",
        "day_of_week": "Thursday",
        "start_date": "2025-09-12",
        "end_date": "2025-09-14",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Victoria BC",
        "description": "This fall fest brings some of music's biggest names to wrap up the summer."
    }
]
2025-06-18 15:20:18 [root] INFO: def extract_and_parse_json(): for url https://www.festivalseekers.com/story/20-plus-bc-summer-music-festivals-2024, 
Cleaned JSON ready for parsing:
[
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Cowichan Valley Bluegrass Festival / Duncan BC",
        "day_of_week": "Friday",
        "start_date": "2025-06-14",
        "end_date": "2025-06-15",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Duncan BC",
        "description": "Mainstage, workshops and jam sessions, all about bluegrass on Vancouver Island."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "PRISMA Festival / Powell River BC",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-16",
        "end_date": "2025-06-28",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Powell River BC",
        "description": "Two weeks of orchestral music on the Sunshine Coast."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Victoria Ska Fest / Victoria British Columbia",
        "day_of_week": "Thursday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-22",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Victoria British Columbia",
        "description": "Coastal skankin' at its best."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "TD Victoria International Jazz Festival / Victoria BC",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-29",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Victoria BC",
        "description": "The port city comes alive with jazz as Madeleine Peyroux, Alex Cuba, Eliane Elias, and Richard Bona Asanté Trio headline the 2025 festival!"
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Vancouver International Jazz Festival / Vancouver BC",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-29",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Vancouver BC",
        "description": "The city of Vancouver will be grooving and bopping with the sound of jazz for 10 whole days!"
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Funtastic Sport and Music Festival / Vernon BC",
        "day_of_week": "Thursday",
        "start_date": "2025-06-28",
        "end_date": "2025-06-29",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Vernon BC",
        "description": "Slo-pitch and rock'n'roll go hand in hand, no?"
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Funtastic Alberni / Port Alberni BC",
        "day_of_week": "Friday",
        "start_date": "2025-06-28",
        "end_date": "2025-06-30",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Port Alberni BC",
        "description": "It's such a good party, they had it twice! Enjoy three days of slo-pitch and live music."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Kathaumixw / Powell River BC",
        "day_of_week": "Monday",
        "start_date": "2025-07-01",
        "end_date": "2025-07-05",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Powell River BC",
        "description": "A five-day choral fest with concerts, competitions, workshops and socials."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Smithers Midsummer Music Festival / Smithers BC",
        "day_of_week": "Friday",
        "start_date": "2025-07-04",
        "end_date": "2025-07-06",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Smithers BC",
        "description": "This chill northern BC town is a great place to dance like no one's watching."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Atlin Arts and Music Festival / Atlin BC",
        "day_of_week": "Thursday",
        "start_date": "2025-07-11",
        "end_date": "2025-07-13",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Atlin BC",
        "description": "The tiny town of Atlin (pop. 450) overflows with two days of music and fun."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Bass Coast / Merrit BC",
        "day_of_week": "Thursday",
        "start_date": "2025-07-11",
        "end_date": "2025-07-14",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Merrit BC",
        "description": "A thoughtfully curated boutique music and art festival featuring new electronic artists."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Salmon Arm Roots & Blues Festival / Salmon Arm BC",
        "day_of_week": "Friday",
        "start_date": "2025-07-25",
        "end_date": "2025-07-27",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Salmon Arm BC",
        "description": "One of the summer's biggest tickets in the heart of the Shuswap."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Shambhala Music Fest / Salmo BC",
        "day_of_week": "Friday",
        "start_date": "2025-07-25",
        "end_date": "2025-07-28",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Salmo BC",
        "description": "IYKYK: it's been named the best music festival in North America by DJ Mag (2019)."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Filberg Festival / Comox BC",
        "day_of_week": "Friday",
        "start_date": "2025-08-01",
        "end_date": "2025-08-03",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Comox BC",
        "description": "Arts, crafts and live music in Comox."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Texada Roots & Blues Festival / Texada Island BC",
        "day_of_week": "Saturday",
        "start_date": "2025-08-02",
        "end_date": "2025-08-03",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Texada Island BC",
        "description": "Island grooves dominate Texada."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Nanaimo Blues Festival / Nanaimo BC",
        "day_of_week": "Thursday",
        "start_date": "2025-08-08",
        "end_date": "2025-08-10",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Nanaimo BC",
        "description": "The annual festival is back again in 2025 with some great blues for the summer."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Wapiti Music Festival / Fernie BC",
        "day_of_week": "Thursday",
        "start_date": "2025-08-08",
        "end_date": "2025-08-09",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Fernie BC",
        "description": "Fernie's big summer music fest."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Five Acre Shaker / Port Alberni, BC",
        "day_of_week": "Thursday",
        "start_date": "2025-08-08",
        "end_date": "2025-08-09",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Port Alberni, BC",
        "description": "An epic coastal shaker full of groove and good vibes."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Robson Valley Music Festival / Dunster BC",
        "day_of_week": "Thursday",
        "start_date": "2025-08-29",
        "end_date": "2025-08-31",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Dunster BC",
        "description": "A fest with a loyal following, for its friendly, funky, fun community and great shows."
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Rifflandia 2025 / Victoria BC",
        "day_of_week": "Thursday",
        "start_date": "2025-09-12",
        "end_date": "2025-09-14",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Victoria BC",
        "description": "This fall fest brings some of music's biggest names to wrap up the summer."
    }
]
2025-06-18 15:20:18 [root] INFO: def clean_up_address(): Starting with events_df shape: (20, 14)
2025-06-18 15:20:18 [root] INFO: def clean_up_address(): Processing location 'Duncan BC' (event_id: None)
2025-06-18 15:20:18 [root] INFO: def clean_up_address(): Processing location 'Powell River BC' (event_id: None)
2025-06-18 15:20:18 [root] INFO: def clean_up_address(): Processing location 'Victoria British Columbia' (event_id: None)
2025-06-18 15:20:18 [root] INFO: def clean_up_address(): Processing location 'Victoria BC' (event_id: None)
2025-06-18 15:20:18 [root] INFO: def clean_up_address(): Processing location 'Vancouver BC' (event_id: None)
2025-06-18 15:20:18 [root] INFO: def clean_up_address(): Processing location 'Vernon BC' (event_id: None)
2025-06-18 15:20:18 [root] INFO: def clean_up_address(): Processing location 'Port Alberni BC' (event_id: None)
2025-06-18 15:20:18 [root] INFO: def clean_up_address(): Processing location 'Powell River BC' (event_id: None)
2025-06-18 15:20:18 [root] INFO: def clean_up_address(): Processing location 'Smithers BC' (event_id: None)
2025-06-18 15:20:18 [root] INFO: def clean_up_address(): Processing location 'Atlin BC' (event_id: None)
2025-06-18 15:20:18 [root] INFO: def clean_up_address(): Processing location 'Merrit BC' (event_id: None)
2025-06-18 15:20:18 [root] INFO: def clean_up_address(): Processing location 'Salmon Arm BC' (event_id: None)
2025-06-18 15:20:18 [root] INFO: def clean_up_address(): Processing location 'Salmo BC' (event_id: None)
2025-06-18 15:20:18 [root] INFO: def clean_up_address(): Processing location 'Comox BC' (event_id: None)
2025-06-18 15:20:18 [root] INFO: def clean_up_address(): Processing location 'Texada Island BC' (event_id: None)
2025-06-18 15:20:18 [root] INFO: def clean_up_address(): Processing location 'Nanaimo BC' (event_id: None)
2025-06-18 15:20:18 [root] INFO: def clean_up_address(): Processing location 'Fernie BC' (event_id: None)
2025-06-18 15:20:18 [root] INFO: def clean_up_address(): Processing location 'Port Alberni, BC' (event_id: None)
2025-06-18 15:20:18 [root] INFO: def clean_up_address(): Processing location 'Dunster BC' (event_id: None)
2025-06-18 15:20:18 [root] INFO: def clean_up_address(): Processing location 'Victoria BC' (event_id: None)
2025-06-18 15:20:18 [root] INFO: write_events_to_db: Number of events to write: 20
2025-06-18 15:20:18 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/story/20-plus-bc-summer-music-festivals-2024'
2025-06-18 15:20:18 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 15:20:18 [root] INFO: def process_llm_response: URL https://www.festivalseekers.com/story/20-plus-bc-summer-music-festivals-2024 marked as relevant with events written to the database.
2025-06-18 15:20:18 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/story/20-plus-bc-summer-music-festivals-2024'
2025-06-18 15:20:18 [root] INFO: def parse(): URL https://www.festivalseekers.com/story/20-plus-bc-summer-music-festivals-2024 marked as relevant (LLM positive).
2025-06-18 15:20:18 [root] INFO: def parse(): Found 10 links on https://www.festivalseekers.com/story/20-plus-bc-summer-music-festivals-2024
2025-06-18 15:20:18 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N, URL: https://www.festivalseekers.com/story/20-plus-bc-summer-music-festivals-2024, source: 20+ BC summer 2025 music festivals all about good vibes ..., keywords: music festivals
2025-06-18 15:20:18 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 15:20:18 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N
2025-06-18 15:20:18 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N'
2025-06-18 15:20:18 [root] INFO: should_process_url: URL https://www.festivalseekers.com/festival/funtastic-sport-and-music-festival was last seen as relevant, processing it.
2025-06-18 15:20:18 [root] INFO: should_process_url: URL https://www.festivalseekers.com/festival/funtastic-sport-and-music-festival was last seen as relevant, processing it.
2025-06-18 15:20:18 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/festival/funtastic-sport-and-music-festival'
2025-06-18 15:20:18 [root] INFO: def parse(): Crawling next URL: https://www.festivalseekers.com/festival/funtastic-sport-and-music-festival
2025-06-18 15:20:18 [root] INFO: should_process_url: URL https://pubmed.ncbi.nlm.nih.gov/31605958/ has never been seen before, processing it.
2025-06-18 15:20:18 [root] INFO: should_process_url: URL https://pubmed.ncbi.nlm.nih.gov/31605958/ has never been seen before, processing it.
2025-06-18 15:20:18 [root] INFO: write_url_to_db(): appended URL 'https://pubmed.ncbi.nlm.nih.gov/31605958/'
2025-06-18 15:20:18 [root] INFO: def parse(): Crawling next URL: https://pubmed.ncbi.nlm.nih.gov/31605958/
2025-06-18 15:20:18 [scrapy.extensions.logstats] INFO: Crawled 177 pages (at 12 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 15:20:18 [root] INFO: should_process_url: URL https://www.festivalseekers.com/festival/cowichan-valley-bluegrass-festival was last seen as relevant, processing it.
2025-06-18 15:20:18 [root] INFO: should_process_url: URL https://www.festivalseekers.com/festival/cowichan-valley-bluegrass-festival was last seen as relevant, processing it.
2025-06-18 15:20:18 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/festival/cowichan-valley-bluegrass-festival'
2025-06-18 15:20:18 [root] INFO: def parse(): Crawling next URL: https://www.festivalseekers.com/festival/cowichan-valley-bluegrass-festival
2025-06-18 15:20:18 [root] INFO: should_process_url: URL https://www.festivalseekers.com/festival/funtastic-alberni was last seen as relevant, processing it.
2025-06-18 15:20:18 [root] INFO: should_process_url: URL https://www.festivalseekers.com/festival/funtastic-alberni was last seen as relevant, processing it.
2025-06-18 15:20:18 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/festival/funtastic-alberni'
2025-06-18 15:20:18 [root] INFO: def parse(): Crawling next URL: https://www.festivalseekers.com/festival/funtastic-alberni
2025-06-18 15:20:18 [root] INFO: should_process_url: URL https://www.festivalseekers.com/festival/kathaumixw was last seen as relevant, processing it.
2025-06-18 15:20:18 [root] INFO: should_process_url: URL https://www.festivalseekers.com/festival/kathaumixw was last seen as relevant, processing it.
2025-06-18 15:20:18 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/festival/kathaumixw'
2025-06-18 15:20:18 [root] INFO: def parse(): Crawling next URL: https://www.festivalseekers.com/festival/kathaumixw
2025-06-18 15:20:18 [root] INFO: should_process_url: URL https://www.festivalseekers.com/festival/td-victoria-international-jazz-festival was last seen as relevant, processing it.
2025-06-18 15:20:18 [root] INFO: should_process_url: URL https://www.festivalseekers.com/festival/td-victoria-international-jazz-festival was last seen as relevant, processing it.
2025-06-18 15:20:18 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/festival/td-victoria-international-jazz-festival'
2025-06-18 15:20:18 [root] INFO: def parse(): Crawling next URL: https://www.festivalseekers.com/festival/td-victoria-international-jazz-festival
2025-06-18 15:20:18 [root] INFO: should_process_url: URL https://www.festivalseekers.com/festival/vancouver-international-jazz-festival was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:20:18 [root] INFO: should_process_url: URL https://www.festivalseekers.com/festival/vancouver-international-jazz-festival was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:20:18 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/festival/vancouver-international-jazz-festival'
2025-06-18 15:20:18 [root] INFO: def parse(): Crawling next URL: https://www.festivalseekers.com/festival/vancouver-international-jazz-festival
2025-06-18 15:20:18 [root] INFO: should_process_url: URL https://youtu.be/x4luGJ-7og8 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:20:18 [root] INFO: should_process_url: URL https://youtu.be/x4luGJ-7og8 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:20:18 [root] INFO: write_url_to_db(): appended URL 'https://youtu.be/x4luGJ-7og8'
2025-06-18 15:20:18 [root] INFO: def parse(): Crawling next URL: https://youtu.be/x4luGJ-7og8
2025-06-18 15:20:18 [root] INFO: should_process_url: URL https://www.festivalseekers.com/festival/prisma was last seen as relevant, processing it.
2025-06-18 15:20:18 [root] INFO: should_process_url: URL https://www.festivalseekers.com/festival/prisma was last seen as relevant, processing it.
2025-06-18 15:20:18 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/festival/prisma'
2025-06-18 15:20:18 [root] INFO: def parse(): Crawling next URL: https://www.festivalseekers.com/festival/prisma
2025-06-18 15:20:18 [root] INFO: should_process_url: URL https://www.festivalseekers.com/story/20-plus-bc-summer-music-festivals-2024 was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 15:20:18 [root] INFO: should_process_url: URL https://www.festivalseekers.com/story/20-plus-bc-summer-music-festivals-2024 was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 15:20:18 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/story/20-plus-bc-summer-music-festivals-2024'
2025-06-18 15:20:18 [root] INFO: def parse(): Crawling next URL: https://www.festivalseekers.com/story/20-plus-bc-summer-music-festivals-2024
2025-06-18 15:20:18 [root] INFO: should_process_url: URL https://www.festivalseekers.com/festival/smithers-midsummer-music-festival was last seen as relevant, processing it.
2025-06-18 15:20:18 [root] INFO: should_process_url: URL https://www.festivalseekers.com/festival/smithers-midsummer-music-festival was last seen as relevant, processing it.
2025-06-18 15:20:18 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/festival/smithers-midsummer-music-festival'
2025-06-18 15:20:18 [root] INFO: def parse(): Crawling next URL: https://www.festivalseekers.com/festival/smithers-midsummer-music-festival
2025-06-18 15:20:18 [root] INFO: should_process_url: URL https://www.festivalseekers.com/festival/victoria-ska-fest was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:20:18 [root] INFO: should_process_url: URL https://www.festivalseekers.com/festival/victoria-ska-fest was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:20:18 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/festival/victoria-ska-fest'
2025-06-18 15:20:18 [root] INFO: def parse(): Crawling next URL: https://www.festivalseekers.com/festival/victoria-ska-fest
2025-06-18 15:20:18 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <403 https://harvestmoonlinedancefestival.ca/>: HTTP status code is not handled or not allowed
2025-06-18 15:20:19 [root] INFO: def parse(): Found keywords for URL https://www.irishtimespub.ca/: ['live music', 'samba', 'wcs']
2025-06-18 15:20:19 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.irishtimespub.ca/
2025-06-18 15:20:19 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:20:19 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:20:19 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:20:21 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 15:20:21 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 360653 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 15:20:21 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 15:20:22 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 15:20:22 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 272131 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 15:20:22 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 15:20:22 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://www.irishtimespub.ca/
2025-06-18 15:20:22 [root] INFO: write_url_to_db(): appended URL 'https://www.irishtimespub.ca/'
2025-06-18 15:20:22 [root] INFO: def parse(): URL https://www.irishtimespub.ca/ marked as irrelevant (LLM negative).
2025-06-18 15:20:22 [root] INFO: def parse(): Found 10 links on https://www.irishtimespub.ca/
2025-06-18 15:20:22 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/pg/irishtimespubbc/about/?ref=page_internal'
2025-06-18 15:20:22 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/pg/irishtimespubbc/about/?ref=page_internal
2025-06-18 15:20:22 [root] INFO: write_url_to_db(): appended URL 'https://instagram.com/irishtimespub'
2025-06-18 15:20:22 [root] INFO: def parse(): Recorded unwanted URL: https://instagram.com/irishtimespub
2025-06-18 15:20:22 [root] INFO: should_process_url: URL https://www.tripadvisor.ca/Restaurant_Review-g154945-d785052-Reviews-Irish_Times_Pub-Victoria_Victoria_Capital_Regional_District_Vancouver_Island_Briti.html was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:20:22 [root] INFO: should_process_url: URL https://www.tripadvisor.ca/Restaurant_Review-g154945-d785052-Reviews-Irish_Times_Pub-Victoria_Victoria_Capital_Regional_District_Vancouver_Island_Briti.html was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:20:22 [root] INFO: write_url_to_db(): appended URL 'https://www.tripadvisor.ca/Restaurant_Review-g154945-d785052-Reviews-Irish_Times_Pub-Victoria_Victoria_Capital_Regional_District_Vancouver_Island_Briti.html'
2025-06-18 15:20:22 [root] INFO: def parse(): Crawling next URL: https://www.tripadvisor.ca/Restaurant_Review-g154945-d785052-Reviews-Irish_Times_Pub-Victoria_Victoria_Capital_Regional_District_Vancouver_Island_Briti.html
2025-06-18 15:20:22 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/signin/signup/?referrer=%2F'
2025-06-18 15:20:22 [root] INFO: def parse(): URL https://www.eventbrite.com/signin/signup/?referrer=%2F marked as irrelevant (no keywords).
2025-06-18 15:20:22 [root] INFO: def parse(): Found 0 links on https://www.eventbrite.com/signin/signup/?referrer=%2F
2025-06-18 15:20:22 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ, URL: https://www.eventbrite.com/signin/signup/?referrer=%2F, source: Argentine tango classes & related events | Eventbrite, keywords: argentine tango
2025-06-18 15:20:22 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 15:20:22 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ
2025-06-18 15:20:22 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ'
2025-06-18 15:20:22 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/signup/?referrer=%2F was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:20:22 [root] INFO: write_url_to_db(): appended URL 'https://thedukesaloon.com/'
2025-06-18 15:20:22 [root] INFO: def parse(): URL https://thedukesaloon.com/ marked as irrelevant (no keywords).
2025-06-18 15:20:22 [root] INFO: def parse(): Found 10 links on https://thedukesaloon.com/
2025-06-18 15:20:22 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/thedukesaloon/'
2025-06-18 15:20:22 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/thedukesaloon/
2025-06-18 15:20:22 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/TheDukeVictoria/'
2025-06-18 15:20:22 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/TheDukeVictoria/
2025-06-18 15:20:22 [root] INFO: should_process_url: URL https://thedukesaloon.com/block-party/ was last seen as relevant, processing it.
2025-06-18 15:20:22 [root] INFO: should_process_url: URL https://thedukesaloon.com/block-party/ was last seen as relevant, processing it.
2025-06-18 15:20:22 [root] INFO: write_url_to_db(): appended URL 'https://thedukesaloon.com/block-party/'
2025-06-18 15:20:22 [root] INFO: def parse(): Crawling next URL: https://thedukesaloon.com/block-party/
2025-06-18 15:20:22 [root] INFO: def parse(): Found keywords for URL https://northernwilds.com/breaking-tradition-with-christmas-away-2/: ['merengue', 'salsa']
2025-06-18 15:20:22 [root] INFO: def generate_prompt(): Generating prompt for URL: https://northernwilds.com/breaking-tradition-with-christmas-away-2/
2025-06-18 15:20:22 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:20:22 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:20:22 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:20:42 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:20:42 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 15:20:42 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 15:20:42 [root] INFO: write_url_to_db(): appended URL 'https://northernwilds.com/breaking-tradition-with-christmas-away-2/'
2025-06-18 15:20:42 [root] INFO: def parse(): URL https://northernwilds.com/breaking-tradition-with-christmas-away-2/ marked as irrelevant (LLM negative).
2025-06-18 15:20:42 [root] INFO: def parse(): Found 10 links on https://northernwilds.com/breaking-tradition-with-christmas-away-2/
2025-06-18 15:20:42 [root] INFO: should_process_url: URL https://statcounter.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:20:42 [root] INFO: should_process_url: URL https://statcounter.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:20:42 [root] INFO: write_url_to_db(): appended URL 'https://statcounter.com/'
2025-06-18 15:20:42 [root] INFO: def parse(): Crawling next URL: https://statcounter.com/
2025-06-18 15:20:42 [root] INFO: def parse(): Found keywords for URL https://livevictoria.com/: ['dance', 'live music', 'swing']
2025-06-18 15:20:42 [root] INFO: def generate_prompt(): Generating prompt for URL: https://livevictoria.com/
2025-06-18 15:20:42 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:20:42 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:20:42 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:23:27 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:23:27 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "LiveVictoria",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Louise Rose | Alone Together",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "19:00",
        "end_time": "21:00",
        "price": "$20",
        "location": "Hermann's Jazz Club",
        "description": "Louise Rose is a living Canadian treasure. She studied classical voice in Pennsy..."
    },
    {
        "source": "LiveVictoria",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Wednesday Night Jam",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "18:00",
        "end_time": "",
        "price": "Free",
        "location": "The Loft (Victoria)",
        "description": "MUSIC JAM with host Brooke Cooper. 6-9PM. Victoria's musicians are invited to ta..."
    },
    {
        "source": "LiveVictoria",
        "dance_style": "ska, reggae",
        "url": "",
        "event_type": "live music",
        "event_name": "Victoria Ska & Reggae Festival Kick-Off Show feat. Waahli, Hezron, The Resignato...",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "16:00",
        "end_time": "22:00",
        "price": "Free",
        "location": "Ship Point (Inner Harbour)",
        "description": "It’s the kick off party for Victoria’s 26th Annual Ska & Reggae Festival!"
    },
    {
        "source": "LiveVictoria",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Karaoke",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "20:00",
        "end_time": "01:00",
        "price": "",
        "location": "View Street Social",
        "description": "All welcome. The best free Karaoke night in the city!"
    },
    {
        "source": "LiveVictoria",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Sarah Kramer's Vintage Magic",
        "day_of_week": "Thursday",
        "start_date": "2025-05-01",
        "end_date": "2025-07-31",
        "start_time": "",
        "end_time": "",
        "price": "Free",
        "location": "My Mother's Eye Treasures and Vintage",
        "description": "Sarah's Vintage Gifted to My Mother's Eye (to sell) for time off/medical leave"
    },
    {
        "source": "LiveVictoria",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Alfie Zappacosta",
        "day_of_week": "Thursday",
        "start_date": "2025-06-19",
        "end_date": "2025-06-19",
        "start_time": "19:00",
        "end_time": "21:00",
        "price": "$35",
        "location": "Hermann's Jazz Club",
        "description": "Featuring Andrew Glover on keys. \n\nTwo time Juno award winner singer songwrite..."
    },
    {
        "source": "LiveVictoria",
        "dance_style": "",
        "url": "",
        "event_type": "workshop",
        "event_name": "Explore Your Voice; Embody Your Potential",
        "day_of_week": "Thursday",
        "start_date": "2025-06-19",
        "end_date": "2025-06-19",
        "start_time": "",
        "end_time": "",
        "price": "$799",
        "location": "Kaleidoscope Arts Centre",
        "description": "A Four-Day Interactive Workshop for Singers and Speakers"
    },
    {
        "source": "LiveVictoria",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Rhythm Train",
        "day_of_week": "Thursday",
        "start_date": "2025-06-19",
        "end_date": "2025-06-19",
        "start_time": "18:00",
        "end_time": "",
        "price": "Free",
        "location": "The Loft (Victoria)",
        "description": "RHYTHM TRAIN is a top-notch line-up of musicians offering up a great mix of blue..."
    },
    {
        "source": "LiveVictoria",
        "dance_style": "ska, reggae",
        "url": "",
        "event_type": "live music",
        "event_name": "Victoria Ska & Reggae Fest Day Two: Free Show feat. Turbulence, La Severa Matace...",
        "day_of_week": "Thursday",
        "start_date": "2025-06-19",
        "end_date": "2025-06-19",
        "start_time": "16:00",
        "end_time": "22:00",
        "price": "Free",
        "location": "Ship Point (Inner Harbour)",
        "description": "Victoria’s 26th Ska & Reggae Festival rolls on with another awesome free show."
    },
    {
        "source": "LiveVictoria",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Karaoke",
        "day_of_week": "Thursday",
        "start_date": "2025-06-19",
        "end_date": "2025-06-19",
        "start_time": "20:00",
        "end_time": "01:00",
        "price": "",
        "location": "View Street Social",
        "description": "All welcome. The best free Karaoke night in the city!"
    },
    {
        "source": "LiveVictoria",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Audio Osmosis presents Psychic Pollution & Mnemonic Pulse",
        "day_of_week": "Thursday",
        "start_date": "2025-06-19",
        "end_date": "2025-06-19",
        "start_time": "20:00",
        "end_time": "",
        "price": "$15",
        "location": "Wheelies Motorcyles",
        "description": "Audio Osmosis presents\n\nPsychic Pollution (VIC)\n-electronic/ambient/beat driv..."
    },
    {
        "source": "LiveVictoria",
        "dance_style": "ska, reggae",
        "url": "",
        "event_type": "live music",
        "event_name": "Victoria Ska & Reggae Fest Day Two: All Island Ska/Punk Showcase feat. SweetLeaf...",
        "day_of_week": "Thursday",
        "start_date": "2025-06-19",
        "end_date": "2025-06-19",
        "start_time": "19:00",
        "end_time": "",
        "price": "$22.50-$29.95",
        "location": "The Wicket Hall",
        "description": "Thursday, June 19 at Wicket Hall\nTicketed: 19 yrs w/ID $22.50 - $29.95 advance ..."
    },
    {
        "source": "LiveVictoria",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Best Coast Big Band Concert",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "18:00",
        "end_time": "20:00",
        "price": "",
        "location": "2625 Arbutus Rd",
        "description": "Join us for a night of great music, dancing and fun for all ages!"
    },
    {
        "source": "LiveVictoria",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Fridays at The Station",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "16:00",
        "end_time": "21:00",
        "price": "Free",
        "location": "720 Station Ave",
        "description": "Fridays at The Station is a vibrant summer market series in Langford!"
    },
    {
        "source": "LiveVictoria",
        "dance_style": "country, honky tonk",
        "url": "",
        "event_type": "live music",
        "event_name": "The Seaside Music Festival Country and Honky Tonk Night",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "",
        "end_time": "",
        "price": "$28.41",
        "location": "Army Navy & Airforce Unit 302",
        "description": "Bundle and Save!\nUse promo code \"IBUNDLED\" to get $5 off this show at checkout...."
    },
    {
        "source": "LiveVictoria",
        "dance_style": "jazz",
        "url": "",
        "event_type": "live music",
        "event_name": "Td Victoria International Jazzfest’25 Presents Kneebody",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "21:30",
        "end_time": "",
        "price": "$48.50",
        "location": "The Coda",
        "description": "“There isn’t a handy term or genre for the music that Kneebody creates. It…"
    },
    {
        "source": "LiveVictoria",
        "dance_style": "country",
        "url": "",
        "event_type": "live music",
        "event_name": "BACKCOUNTRY FRIDAYS",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "21:00",
        "end_time": "",
        "price": "$10",
        "location": "The Duke Saloon",
        "description": "Kickstart your weekend with a bang at Victoria’s favorite country bar. Whiskey..."
    },
    {
        "source": "LiveVictoria",
        "dance_style": "jazz",
        "url": "",
        "event_type": "live music",
        "event_name": "Lorraine Desmarais Trio Tribute to Bill Evans",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "19:00",
        "end_time": "21:00",
        "price": "$42",
        "location": "Hermann's Jazz Club",
        "description": "TD Victoria International JazzFest 2025"
    },
    {
        "source": "LiveVictoria",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Summer Solstice Concert",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "19:30",
        "end_time": "20:45",
        "price": "By Donation",
        "location": "James Bay United Church",
        "description": "An evening of love songs featuring Johannes Brahms’ Neue Liebeslieder-Walzer"
    },
    {
        "source": "LiveVictoria",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Bill Johnson Quartet",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "19:00",
        "end_time": "",
        "price": "By Donation",
        "location": "The Loft (Victoria)",
        "description": "The Bill Johnson Band plays white hot Blues straight out of the furnace…Victor..."
    }
]
2025-06-18 15:23:27 [root] INFO: def extract_and_parse_json(): for url https://livevictoria.com/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "LiveVictoria",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Louise Rose | Alone Together",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "19:00",
        "end_time": "21:00",
        "price": "$20",
        "location": "Hermann's Jazz Club",
        "description": "Louise Rose is a living Canadian treasure. She studied classical voice in Pennsy"
    },
    {
        "source": "LiveVictoria",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Wednesday Night Jam",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "18:00",
        "end_time": "",
        "price": "Free",
        "location": "The Loft (Victoria)",
        "description": "MUSIC JAM with host Brooke Cooper. 6-9PM. Victoria's musicians are invited to ta"
    },
    {
        "source": "LiveVictoria",
        "dance_style": "ska, reggae",
        "url": "",
        "event_type": "live music",
        "event_name": "Victoria Ska & Reggae Festival Kick-Off Show feat. Waahli, Hezron, The Resignato",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "16:00",
        "end_time": "22:00",
        "price": "Free",
        "location": "Ship Point (Inner Harbour)",
        "description": "It’s the kick off party for Victoria’s 26th Annual Ska & Reggae Festival!"
    },
    {
        "source": "LiveVictoria",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Karaoke",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "20:00",
        "end_time": "01:00",
        "price": "",
        "location": "View Street Social",
        "description": "All welcome. The best free Karaoke night in the city!"
    },
    {
        "source": "LiveVictoria",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Sarah Kramer's Vintage Magic",
        "day_of_week": "Thursday",
        "start_date": "2025-05-01",
        "end_date": "2025-07-31",
        "start_time": "",
        "end_time": "",
        "price": "Free",
        "location": "My Mother's Eye Treasures and Vintage",
        "description": "Sarah's Vintage Gifted to My Mother's Eye (to sell) for time off/medical leave"
    },
    {
        "source": "LiveVictoria",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Alfie Zappacosta",
        "day_of_week": "Thursday",
        "start_date": "2025-06-19",
        "end_date": "2025-06-19",
        "start_time": "19:00",
        "end_time": "21:00",
        "price": "$35",
        "location": "Hermann's Jazz Club",
        "description": "Featuring Andrew Glover on keys. \n\nTwo time Juno award winner singer songwrite"
    },
    {
        "source": "LiveVictoria",
        "dance_style": "",
        "url": "",
        "event_type": "workshop",
        "event_name": "Explore Your Voice; Embody Your Potential",
        "day_of_week": "Thursday",
        "start_date": "2025-06-19",
        "end_date": "2025-06-19",
        "start_time": "",
        "end_time": "",
        "price": "$799",
        "location": "Kaleidoscope Arts Centre",
        "description": "A Four-Day Interactive Workshop for Singers and Speakers"
    },
    {
        "source": "LiveVictoria",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Rhythm Train",
        "day_of_week": "Thursday",
        "start_date": "2025-06-19",
        "end_date": "2025-06-19",
        "start_time": "18:00",
        "end_time": "",
        "price": "Free",
        "location": "The Loft (Victoria)",
        "description": "RHYTHM TRAIN is a top-notch line-up of musicians offering up a great mix of blue"
    },
    {
        "source": "LiveVictoria",
        "dance_style": "ska, reggae",
        "url": "",
        "event_type": "live music",
        "event_name": "Victoria Ska & Reggae Fest Day Two: Free Show feat. Turbulence, La Severa Matace",
        "day_of_week": "Thursday",
        "start_date": "2025-06-19",
        "end_date": "2025-06-19",
        "start_time": "16:00",
        "end_time": "22:00",
        "price": "Free",
        "location": "Ship Point (Inner Harbour)",
        "description": "Victoria’s 26th Ska & Reggae Festival rolls on with another awesome free show."
    },
    {
        "source": "LiveVictoria",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Karaoke",
        "day_of_week": "Thursday",
        "start_date": "2025-06-19",
        "end_date": "2025-06-19",
        "start_time": "20:00",
        "end_time": "01:00",
        "price": "",
        "location": "View Street Social",
        "description": "All welcome. The best free Karaoke night in the city!"
    },
    {
        "source": "LiveVictoria",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Audio Osmosis presents Psychic Pollution & Mnemonic Pulse",
        "day_of_week": "Thursday",
        "start_date": "2025-06-19",
        "end_date": "2025-06-19",
        "start_time": "20:00",
        "end_time": "",
        "price": "$15",
        "location": "Wheelies Motorcyles",
        "description": "Audio Osmosis presents\n\nPsychic Pollution (VIC)\n-electronic/ambient/beat driv"
    },
    {
        "source": "LiveVictoria",
        "dance_style": "ska, reggae",
        "url": "",
        "event_type": "live music",
        "event_name": "Victoria Ska & Reggae Fest Day Two: All Island Ska/Punk Showcase feat. SweetLeaf",
        "day_of_week": "Thursday",
        "start_date": "2025-06-19",
        "end_date": "2025-06-19",
        "start_time": "19:00",
        "end_time": "",
        "price": "$22.50-$29.95",
        "location": "The Wicket Hall",
        "description": "Thursday, June 19 at Wicket Hall\nTicketed: 19 yrs w/ID $22.50 - $29.95 advance "
    },
    {
        "source": "LiveVictoria",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Best Coast Big Band Concert",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "18:00",
        "end_time": "20:00",
        "price": "",
        "location": "2625 Arbutus Rd",
        "description": "Join us for a night of great music, dancing and fun for all ages!"
    },
    {
        "source": "LiveVictoria",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Fridays at The Station",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "16:00",
        "end_time": "21:00",
        "price": "Free",
        "location": "720 Station Ave",
        "description": "Fridays at The Station is a vibrant summer market series in Langford!"
    },
    {
        "source": "LiveVictoria",
        "dance_style": "country, honky tonk",
        "url": "",
        "event_type": "live music",
        "event_name": "The Seaside Music Festival Country and Honky Tonk Night",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "",
        "end_time": "",
        "price": "$28.41",
        "location": "Army Navy & Airforce Unit 302",
        "description": "Bundle and Save!\nUse promo code \"IBUNDLED\" to get $5 off this show at checkout."
    },
    {
        "source": "LiveVictoria",
        "dance_style": "jazz",
        "url": "",
        "event_type": "live music",
        "event_name": "Td Victoria International Jazzfest’25 Presents Kneebody",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "21:30",
        "end_time": "",
        "price": "$48.50",
        "location": "The Coda",
        "description": "“There isn’t a handy term or genre for the music that Kneebody creates. It…"
    },
    {
        "source": "LiveVictoria",
        "dance_style": "country",
        "url": "",
        "event_type": "live music",
        "event_name": "BACKCOUNTRY FRIDAYS",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "21:00",
        "end_time": "",
        "price": "$10",
        "location": "The Duke Saloon",
        "description": "Kickstart your weekend with a bang at Victoria’s favorite country bar. Whiskey"
    },
    {
        "source": "LiveVictoria",
        "dance_style": "jazz",
        "url": "",
        "event_type": "live music",
        "event_name": "Lorraine Desmarais Trio Tribute to Bill Evans",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "19:00",
        "end_time": "21:00",
        "price": "$42",
        "location": "Hermann's Jazz Club",
        "description": "TD Victoria International JazzFest 2025"
    },
    {
        "source": "LiveVictoria",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Summer Solstice Concert",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "19:30",
        "end_time": "20:45",
        "price": "By Donation",
        "location": "James Bay United Church",
        "description": "An evening of love songs featuring Johannes Brahms’ Neue Liebeslieder-Walzer"
    },
    {
        "source": "LiveVictoria",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Bill Johnson Quartet",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "19:00",
        "end_time": "",
        "price": "By Donation",
        "location": "The Loft (Victoria)",
        "description": "The Bill Johnson Band plays white hot Blues straight out of the furnace…Victor"
    }
]
2025-06-18 15:23:27 [root] INFO: def clean_up_address(): Starting with events_df shape: (20, 14)
2025-06-18 15:23:27 [root] INFO: def clean_up_address(): Processing location 'Hermann's Jazz Club' (event_id: None)
2025-06-18 15:23:27 [root] INFO: def clean_up_address(): Processing location 'The Loft (Victoria)' (event_id: None)
2025-06-18 15:23:27 [root] INFO: def clean_up_address(): Processing location 'Ship Point (Inner Harbour)' (event_id: None)
2025-06-18 15:23:27 [root] INFO: def clean_up_address(): Processing location 'View Street Social' (event_id: None)
2025-06-18 15:23:27 [root] INFO: def clean_up_address(): Processing location 'My Mother's Eye Treasures and Vintage' (event_id: None)
2025-06-18 15:23:27 [root] INFO: def clean_up_address(): Processing location 'Hermann's Jazz Club' (event_id: None)
2025-06-18 15:23:27 [root] INFO: def clean_up_address(): Processing location 'Kaleidoscope Arts Centre' (event_id: None)
2025-06-18 15:23:27 [root] INFO: def clean_up_address(): Processing location 'The Loft (Victoria)' (event_id: None)
2025-06-18 15:23:27 [root] INFO: def clean_up_address(): Processing location 'Ship Point (Inner Harbour)' (event_id: None)
2025-06-18 15:23:27 [root] INFO: def clean_up_address(): Processing location 'View Street Social' (event_id: None)
2025-06-18 15:23:27 [root] INFO: def clean_up_address(): Processing location 'Wheelies Motorcyles' (event_id: None)
2025-06-18 15:23:27 [root] INFO: def clean_up_address(): Processing location 'The Wicket Hall' (event_id: None)
2025-06-18 15:23:27 [root] INFO: def clean_up_address(): Processing location '2625 Arbutus Rd' (event_id: None)
2025-06-18 15:23:27 [root] INFO: def clean_up_address(): Processing location '720 Station Ave' (event_id: None)
2025-06-18 15:23:27 [root] INFO: def clean_up_address(): Processing location 'Army Navy & Airforce Unit 302' (event_id: None)
2025-06-18 15:23:27 [root] INFO: def clean_up_address(): Processing location 'The Coda' (event_id: None)
2025-06-18 15:23:27 [root] INFO: def clean_up_address(): Processing location 'The Duke Saloon' (event_id: None)
2025-06-18 15:23:27 [root] INFO: def clean_up_address(): Processing location 'Hermann's Jazz Club' (event_id: None)
2025-06-18 15:23:27 [root] INFO: def clean_up_address(): Processing location 'James Bay United Church' (event_id: None)
2025-06-18 15:23:27 [root] INFO: def clean_up_address(): Processing location 'The Loft (Victoria)' (event_id: None)
2025-06-18 15:23:27 [root] INFO: write_events_to_db: Number of events to write: 20
2025-06-18 15:23:27 [root] INFO: write_url_to_db(): appended URL 'https://livevictoria.com/'
2025-06-18 15:23:27 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 15:23:27 [root] INFO: def process_llm_response: URL https://livevictoria.com/ marked as relevant with events written to the database.
2025-06-18 15:23:27 [root] INFO: write_url_to_db(): appended URL 'https://livevictoria.com/'
2025-06-18 15:23:27 [root] INFO: def parse(): URL https://livevictoria.com/ marked as relevant (LLM positive).
2025-06-18 15:23:27 [root] INFO: def parse(): Found 10 links on https://livevictoria.com/
2025-06-18 15:23:27 [root] INFO: should_process_url: URL https://indivision-images.s3.filebase.com/4583823.jpg was last seen as relevant, processing it.
2025-06-18 15:23:27 [root] INFO: should_process_url: URL https://indivision-images.s3.filebase.com/4583823.jpg was last seen as relevant, processing it.
2025-06-18 15:23:27 [root] INFO: write_url_to_db(): appended URL 'https://indivision-images.s3.filebase.com/4583823.jpg'
2025-06-18 15:23:27 [root] INFO: def parse(): Crawling next URL: https://indivision-images.s3.filebase.com/4583823.jpg
2025-06-18 15:23:27 [root] INFO: def parse(): Found keywords for URL https://www.facebook.com/groups/meanwhileinsooke/posts/2454654144912925/: ['dance', 'line dance', 'wcs']
2025-06-18 15:23:27 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.facebook.com/groups/meanwhileinsooke/posts/2454654144912925/
2025-06-18 15:23:27 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:23:27 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:23:27 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:23:30 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 15:23:30 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 373829 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 15:23:30 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 15:23:31 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 15:23:31 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 278200 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 15:23:31 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 15:23:31 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://www.facebook.com/groups/meanwhileinsooke/posts/2454654144912925/
2025-06-18 15:23:32 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/meanwhileinsooke/posts/2454654144912925/'
2025-06-18 15:23:32 [root] INFO: def parse(): URL https://www.facebook.com/groups/meanwhileinsooke/posts/2454654144912925/ marked as irrelevant (LLM negative).
2025-06-18 15:23:32 [root] INFO: def parse(): Found 0 links on https://www.facebook.com/groups/meanwhileinsooke/posts/2454654144912925/
2025-06-18 15:23:32 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/meanwhileinsooke/posts/2454654144912925/'
2025-06-18 15:23:32 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/groups/meanwhileinsooke/posts/2454654144912925/
2025-06-18 15:23:32 [scrapy.extensions.logstats] INFO: Crawled 185 pages (at 8 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 15:23:32 [root] INFO: should_process_url: URL https://www.opentable.ca/r/irish-times-pub-reservations-victoria?restref=37471&lang=en-CA&ot_source=Restaurant%20website was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:23:32 [root] INFO: should_process_url: URL https://www.opentable.ca/r/irish-times-pub-reservations-victoria?restref=37471&lang=en-CA&ot_source=Restaurant%20website was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:23:32 [root] INFO: write_url_to_db(): appended URL 'https://www.opentable.ca/r/irish-times-pub-reservations-victoria?restref=37471&lang=en-CA&ot_source=Restaurant%20website'
2025-06-18 15:23:32 [root] INFO: def parse(): Crawling next URL: https://www.opentable.ca/r/irish-times-pub-reservations-victoria?restref=37471&lang=en-CA&ot_source=Restaurant%20website
2025-06-18 15:23:32 [root] INFO: should_process_url: URL https://thedukesaloon.com/us/ was last seen as not relevant but hit_ratio (0.33) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 15:23:32 [root] INFO: should_process_url: URL https://thedukesaloon.com/us/ was last seen as not relevant but hit_ratio (0.33) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 15:23:32 [root] INFO: write_url_to_db(): appended URL 'https://thedukesaloon.com/us/'
2025-06-18 15:23:32 [root] INFO: def parse(): Crawling next URL: https://thedukesaloon.com/us/
2025-06-18 15:23:32 [root] INFO: should_process_url: URL https://northernwilds.com/category/arts/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:23:32 [root] INFO: should_process_url: URL https://northernwilds.com/category/arts/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:23:32 [root] INFO: write_url_to_db(): appended URL 'https://northernwilds.com/category/arts/'
2025-06-18 15:23:32 [root] INFO: def parse(): Crawling next URL: https://northernwilds.com/category/arts/
2025-06-18 15:23:32 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.eventbrite.com/d/ny--new-york/events/> (failed 3 times): User timeout caused connection failure: Getting https://www.eventbrite.com/d/ny--new-york/events/ took longer than 180.0 seconds..
2025-06-18 15:23:32 [root] INFO: should_process_url: URL https://indivision-images.s3.filebase.com/4591909.jpg was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:23:32 [root] INFO: should_process_url: URL https://indivision-images.s3.filebase.com/4591909.jpg was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:23:32 [root] INFO: write_url_to_db(): appended URL 'https://indivision-images.s3.filebase.com/4591909.jpg'
2025-06-18 15:23:32 [root] INFO: def parse(): Crawling next URL: https://indivision-images.s3.filebase.com/4591909.jpg
2025-06-18 15:23:32 [root] INFO: should_process_url: URL https://www.irishtimespub.ca/about-us was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:23:32 [root] INFO: should_process_url: URL https://www.irishtimespub.ca/about-us was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:23:32 [root] INFO: write_url_to_db(): appended URL 'https://www.irishtimespub.ca/about-us'
2025-06-18 15:23:32 [root] INFO: def parse(): Crawling next URL: https://www.irishtimespub.ca/about-us
2025-06-18 15:23:32 [root] INFO: should_process_url: URL https://thedukesaloon.com/fundraising/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:23:32 [root] INFO: should_process_url: URL https://thedukesaloon.com/fundraising/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:23:32 [root] INFO: write_url_to_db(): appended URL 'https://thedukesaloon.com/fundraising/'
2025-06-18 15:23:32 [root] INFO: def parse(): Crawling next URL: https://thedukesaloon.com/fundraising/
2025-06-18 15:23:32 [root] INFO: should_process_url: URL https://northernwilds.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:23:32 [root] INFO: should_process_url: URL https://northernwilds.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:23:32 [root] INFO: write_url_to_db(): appended URL 'https://northernwilds.com'
2025-06-18 15:23:32 [root] INFO: def parse(): Crawling next URL: https://northernwilds.com
2025-06-18 15:23:32 [root] INFO: should_process_url: URL https://indivision-images.s3.filebase.com/4180544.jpg was last seen as relevant, processing it.
2025-06-18 15:23:32 [root] INFO: should_process_url: URL https://indivision-images.s3.filebase.com/4180544.jpg was last seen as relevant, processing it.
2025-06-18 15:23:32 [root] INFO: write_url_to_db(): appended URL 'https://indivision-images.s3.filebase.com/4180544.jpg'
2025-06-18 15:23:32 [root] INFO: def parse(): Crawling next URL: https://indivision-images.s3.filebase.com/4180544.jpg
2025-06-18 15:23:32 [root] INFO: def parse(): Found keywords for URL https://www.facebook.com/groups/Barsnbandsyyj/: ['dance', 'live music', 'wcs']
2025-06-18 15:23:32 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.facebook.com/groups/Barsnbandsyyj/
2025-06-18 15:23:32 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:23:32 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:23:32 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:23:34 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 15:23:34 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 564041 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 15:23:34 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 15:23:36 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 15:23:36 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 423607 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 15:23:36 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 15:23:36 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://www.facebook.com/groups/Barsnbandsyyj/
2025-06-18 15:23:36 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/Barsnbandsyyj/'
2025-06-18 15:23:36 [root] INFO: def parse(): URL https://www.facebook.com/groups/Barsnbandsyyj/ marked as irrelevant (LLM negative).
2025-06-18 15:23:36 [root] INFO: def parse(): Found 0 links on https://www.facebook.com/groups/Barsnbandsyyj/
2025-06-18 15:23:36 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/Barsnbandsyyj/'
2025-06-18 15:23:36 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/groups/Barsnbandsyyj/
2025-06-18 15:23:36 [root] INFO: parse: Skipping blacklisted URL https://www.google.com/maps/place/1200+Government+St,+Victoria,+BC+V8W+1Y3/@48.4258565,-123.3701391,17z/data=!3m1!4b1!4m5!3m4!1s0x548f749adb714eff:0x803f326e036f01c4!8m2!3d48.4258565!4d-123.3679504.
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://www.irishtimespub.ca/drinkmenu was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://www.irishtimespub.ca/drinkmenu was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:23:36 [root] INFO: write_url_to_db(): appended URL 'https://www.irishtimespub.ca/drinkmenu'
2025-06-18 15:23:36 [root] INFO: def parse(): Crawling next URL: https://www.irishtimespub.ca/drinkmenu
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://thedukesaloon.com/events/ was last seen as relevant, processing it.
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://thedukesaloon.com/events/ was last seen as relevant, processing it.
2025-06-18 15:23:36 [root] INFO: write_url_to_db(): appended URL 'https://thedukesaloon.com/events/'
2025-06-18 15:23:36 [root] INFO: def parse(): Crawling next URL: https://thedukesaloon.com/events/
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://northernwilds.com/category/features/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://northernwilds.com/category/features/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:23:36 [root] INFO: write_url_to_db(): appended URL 'https://northernwilds.com/category/features/'
2025-06-18 15:23:36 [root] INFO: def parse(): Crawling next URL: https://northernwilds.com/category/features/
2025-06-18 15:23:36 [root] INFO: should_process_url: URL http:// was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:23:36 [root] INFO: should_process_url: URL http:// was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:23:36 [root] INFO: write_url_to_db(): appended URL 'http://'
2025-06-18 15:23:36 [root] INFO: def parse(): Crawling next URL: http://
2025-06-18 15:23:36 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.eventbrite.com/d/ny--new-york/events/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://www.eventbrite.com/d/ny--new-york/events/ took longer than 180.0 seconds..
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://www.irishtimespub.ca/food was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://www.irishtimespub.ca/food was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:23:36 [root] INFO: write_url_to_db(): appended URL 'https://www.irishtimespub.ca/food'
2025-06-18 15:23:36 [root] INFO: def parse(): Crawling next URL: https://www.irishtimespub.ca/food
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://thedukesaloon.com/ was last seen as relevant, processing it.
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://thedukesaloon.com/ was last seen as relevant, processing it.
2025-06-18 15:23:36 [root] INFO: write_url_to_db(): appended URL 'https://thedukesaloon.com/'
2025-06-18 15:23:36 [root] INFO: def parse(): Crawling next URL: https://thedukesaloon.com/
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://northernwilds.com/breaking-tradition-with-christmas-away-2/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://northernwilds.com/breaking-tradition-with-christmas-away-2/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:23:36 [root] INFO: write_url_to_db(): appended URL 'https://northernwilds.com/breaking-tradition-with-christmas-away-2/'
2025-06-18 15:23:36 [root] INFO: def parse(): Crawling next URL: https://northernwilds.com/breaking-tradition-with-christmas-away-2/
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://indivision-images.s3.filebase.com/4562822.jpg was last seen as relevant, processing it.
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://indivision-images.s3.filebase.com/4562822.jpg was last seen as relevant, processing it.
2025-06-18 15:23:36 [root] INFO: write_url_to_db(): appended URL 'https://indivision-images.s3.filebase.com/4562822.jpg'
2025-06-18 15:23:36 [root] INFO: def parse(): Crawling next URL: https://indivision-images.s3.filebase.com/4562822.jpg
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://livevictoria.com/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://livevictoria.com/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 15:23:36 [root] INFO: write_url_to_db(): appended URL 'https://livevictoria.com/'
2025-06-18 15:23:36 [root] INFO: def parse(): Crawling next URL: https://livevictoria.com/
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://www.irishtimespub.ca was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://www.irishtimespub.ca was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:23:36 [root] INFO: write_url_to_db(): appended URL 'https://www.irishtimespub.ca'
2025-06-18 15:23:36 [root] INFO: def parse(): Crawling next URL: https://www.irishtimespub.ca
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://www.google.ca/maps/dir/''/The+Duke+Saloon/@48.4319416,-123.4380883,12z/data=!3m1!4b1!4m8!4m7!1m0!1m5!1m1!1s0x548f748257cd657d:0x7b34826b02413603!2m2!1d-123.369422!2d48.431962 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://www.google.ca/maps/dir/''/The+Duke+Saloon/@48.4319416,-123.4380883,12z/data=!3m1!4b1!4m8!4m7!1m0!1m5!1m1!1s0x548f748257cd657d:0x7b34826b02413603!2m2!1d-123.369422!2d48.431962 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:23:36 [root] INFO: write_url_to_db(): appended URL 'https://www.google.ca/maps/dir/''/The+Duke+Saloon/@48.4319416,-123.4380883,12z/data=!3m1!4b1!4m8!4m7!1m0!1m5!1m1!1s0x548f748257cd657d:0x7b34826b02413603!2m2!1d-123.369422!2d48.431962'
2025-06-18 15:23:36 [root] INFO: def parse(): Crawling next URL: https://www.google.ca/maps/dir/''/The+Duke+Saloon/@48.4319416,-123.4380883,12z/data=!3m1!4b1!4m8!4m7!1m0!1m5!1m1!1s0x548f748257cd657d:0x7b34826b02413603!2m2!1d-123.369422!2d48.431962
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://northernwilds.com/current-issue/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://northernwilds.com/current-issue/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:23:36 [root] INFO: write_url_to_db(): appended URL 'https://northernwilds.com/current-issue/'
2025-06-18 15:23:36 [root] INFO: def parse(): Crawling next URL: https://northernwilds.com/current-issue/
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://indivision-images.s3.filebase.com/5229818.jpg was last seen as relevant, processing it.
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://indivision-images.s3.filebase.com/5229818.jpg was last seen as relevant, processing it.
2025-06-18 15:23:36 [root] INFO: write_url_to_db(): appended URL 'https://indivision-images.s3.filebase.com/5229818.jpg'
2025-06-18 15:23:36 [root] INFO: def parse(): Crawling next URL: https://indivision-images.s3.filebase.com/5229818.jpg
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://www.irishtimespub.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://www.irishtimespub.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:23:36 [root] INFO: write_url_to_db(): appended URL 'https://www.irishtimespub.ca/'
2025-06-18 15:23:36 [root] INFO: def parse(): Crawling next URL: https://www.irishtimespub.ca/
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://thedukesaloon.com/weekly/ was last seen as relevant, processing it.
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://thedukesaloon.com/weekly/ was last seen as relevant, processing it.
2025-06-18 15:23:36 [root] INFO: write_url_to_db(): appended URL 'https://thedukesaloon.com/weekly/'
2025-06-18 15:23:36 [root] INFO: def parse(): Crawling next URL: https://thedukesaloon.com/weekly/
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://northernwilds.com/along-the-shore/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://northernwilds.com/along-the-shore/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:23:36 [root] INFO: write_url_to_db(): appended URL 'https://northernwilds.com/along-the-shore/'
2025-06-18 15:23:36 [root] INFO: def parse(): Crawling next URL: https://northernwilds.com/along-the-shore/
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://indivision-images.s3.filebase.com/4141645.jpg was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:23:36 [root] INFO: should_process_url: URL https://indivision-images.s3.filebase.com/4141645.jpg was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:23:36 [root] INFO: write_url_to_db(): appended URL 'https://indivision-images.s3.filebase.com/4141645.jpg'
2025-06-18 15:23:36 [root] INFO: def parse(): Crawling next URL: https://indivision-images.s3.filebase.com/4141645.jpg
2025-06-18 15:23:37 [root] INFO: def parse(): Found keywords for URL https://www.festivalseekers.com/festival/funtastic-sport-and-music-festival: ['live music', 'music festivals', 'swing']
2025-06-18 15:23:37 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.festivalseekers.com/festival/funtastic-sport-and-music-festival
2025-06-18 15:23:37 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:23:37 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:23:37 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:23:46 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:23:46 [root] INFO: query_llm(): Mistral response received: ```json
[
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Funtastic Sport and Music Festival",
        "day_of_week": "Saturday",
        "start_date": "2025-06-28",
        "end_date": "2025-06-29",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "DND Army Camp, Vernon, British Columbia",
        "description": "Spend the day swinging bats and throwing pitches in the largest slo-pitch tournament in North America, and in the night rock out to live classic rock bands."
    }
]
```
2025-06-18 15:23:46 [root] INFO: def extract_and_parse_json(): for url https://www.festivalseekers.com/festival/funtastic-sport-and-music-festival, 
Cleaned JSON ready for parsing:
[
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Funtastic Sport and Music Festival",
        "day_of_week": "Saturday",
        "start_date": "2025-06-28",
        "end_date": "2025-06-29",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "DND Army Camp, Vernon, British Columbia",
        "description": "Spend the day swinging bats and throwing pitches in the largest slo-pitch tournament in North America, and in the night rock out to live classic rock bands."
    }
]
2025-06-18 15:23:46 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 15:23:46 [root] INFO: def clean_up_address(): Processing location 'DND Army Camp, Vernon, British Columbia' (event_id: None)
2025-06-18 15:23:46 [root] INFO: write_events_to_db: Number of events to write: 1
2025-06-18 15:23:46 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/festival/funtastic-sport-and-music-festival'
2025-06-18 15:23:46 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 15:23:46 [root] INFO: def process_llm_response: URL https://www.festivalseekers.com/festival/funtastic-sport-and-music-festival marked as relevant with events written to the database.
2025-06-18 15:23:46 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/festival/funtastic-sport-and-music-festival'
2025-06-18 15:23:46 [root] INFO: def parse(): URL https://www.festivalseekers.com/festival/funtastic-sport-and-music-festival marked as relevant (LLM positive).
2025-06-18 15:23:46 [root] INFO: def parse(): Found 10 links on https://www.festivalseekers.com/festival/funtastic-sport-and-music-festival
2025-06-18 15:23:46 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N, URL: https://www.festivalseekers.com/festival/funtastic-sport-and-music-festival, source: 20+ BC summer 2025 music festivals all about good vibes ..., keywords: music festivals
2025-06-18 15:23:46 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 15:23:46 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N
2025-06-18 15:23:46 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N'
2025-06-18 15:23:46 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/FuntasticSportsSociety'
2025-06-18 15:23:46 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/FuntasticSportsSociety
2025-06-18 15:23:46 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/festivalseekers/'
2025-06-18 15:23:46 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/festivalseekers/
2025-06-18 15:23:46 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/festivalseekers/'
2025-06-18 15:23:46 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/festivalseekers/
2025-06-18 15:23:46 [root] INFO: should_process_url: URL https://www.festivalseekers.com/festival/funtastic-sport-and-music-festival was last seen as relevant, processing it.
2025-06-18 15:23:46 [root] INFO: should_process_url: URL https://funtasticsports.ca/slo-pitch-tournament/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:23:46 [root] INFO: should_process_url: URL https://funtasticsports.ca/slo-pitch-tournament/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:23:46 [root] INFO: write_url_to_db(): appended URL 'https://funtasticsports.ca/slo-pitch-tournament/'
2025-06-18 15:23:46 [root] INFO: def parse(): Crawling next URL: https://funtasticsports.ca/slo-pitch-tournament/
2025-06-18 15:23:46 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <406 https://victoriatangomarathon.com/>: HTTP status code is not handled or not allowed
2025-06-18 15:23:46 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <403 https://do250.com/p/99-days>: HTTP status code is not handled or not allowed
2025-06-18 15:23:46 [root] INFO: should_process_url: URL https://thedukesaloon.com/gallery/ does not meet criteria for processing, skipping it.
2025-06-18 15:23:46 [root] INFO: def eventbrite_search(): Skipping URL https://thedukesaloon.com/gallery/ based on historical relevancy.
2025-06-18 15:23:46 [root] INFO: should_process_url: URL https://northernwilds.com/food-drink/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:23:46 [root] INFO: should_process_url: URL https://northernwilds.com/food-drink/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:23:46 [root] INFO: write_url_to_db(): appended URL 'https://northernwilds.com/food-drink/'
2025-06-18 15:23:46 [root] INFO: def parse(): Crawling next URL: https://northernwilds.com/food-drink/
2025-06-18 15:23:46 [root] INFO: should_process_url: URL https://indivision-images.s3.filebase.com/5248525.jpg has never been seen before, processing it.
2025-06-18 15:23:46 [root] INFO: should_process_url: URL https://indivision-images.s3.filebase.com/5248525.jpg has never been seen before, processing it.
2025-06-18 15:23:46 [root] INFO: write_url_to_db(): appended URL 'https://indivision-images.s3.filebase.com/5248525.jpg'
2025-06-18 15:23:46 [root] INFO: def parse(): Crawling next URL: https://indivision-images.s3.filebase.com/5248525.jpg
2025-06-18 15:23:46 [root] INFO: should_process_url: URL https://indivision-images.s3.filebase.com/4125140.jpg was last seen as relevant, processing it.
2025-06-18 15:23:46 [root] INFO: should_process_url: URL https://indivision-images.s3.filebase.com/4125140.jpg was last seen as relevant, processing it.
2025-06-18 15:23:46 [root] INFO: write_url_to_db(): appended URL 'https://indivision-images.s3.filebase.com/4125140.jpg'
2025-06-18 15:23:46 [root] INFO: def parse(): Crawling next URL: https://indivision-images.s3.filebase.com/4125140.jpg
2025-06-18 15:23:46 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/user/FestivalSeekers.
2025-06-18 15:23:46 [root] INFO: should_process_url: URL https://www.zenseekers.com/expedition/explorevernon was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:23:46 [root] INFO: should_process_url: URL https://www.zenseekers.com/expedition/explorevernon was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:23:46 [root] INFO: write_url_to_db(): appended URL 'https://www.zenseekers.com/expedition/explorevernon'
2025-06-18 15:23:46 [root] INFO: def parse(): Crawling next URL: https://www.zenseekers.com/expedition/explorevernon
2025-06-18 15:23:47 [scrapy.core.scraper] ERROR: Error downloading <GET http://>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: invalid hostname: 
2025-06-18 15:23:47 [root] INFO: should_process_url: URL https://northernwilds.com/advertise-in-northern-minnesota/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:23:47 [root] INFO: should_process_url: URL https://northernwilds.com/advertise-in-northern-minnesota/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:23:47 [root] INFO: write_url_to_db(): appended URL 'https://northernwilds.com/advertise-in-northern-minnesota/'
2025-06-18 15:23:47 [root] INFO: def parse(): Crawling next URL: https://northernwilds.com/advertise-in-northern-minnesota/
2025-06-18 15:23:47 [root] INFO: should_process_url: URL https://www.tourismvernon.com/en/index.aspx was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:23:47 [root] INFO: should_process_url: URL https://www.tourismvernon.com/en/index.aspx was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:23:47 [root] INFO: write_url_to_db(): appended URL 'https://www.tourismvernon.com/en/index.aspx'
2025-06-18 15:23:47 [root] INFO: def parse(): Crawling next URL: https://www.tourismvernon.com/en/index.aspx
2025-06-18 15:23:47 [root] INFO: should_process_url: URL https://northernwilds.com/about-us/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:23:47 [root] INFO: should_process_url: URL https://northernwilds.com/about-us/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:23:47 [root] INFO: write_url_to_db(): appended URL 'https://northernwilds.com/about-us/contact/'
2025-06-18 15:23:47 [root] INFO: def parse(): Crawling next URL: https://northernwilds.com/about-us/contact/
2025-06-18 15:23:47 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/funtasticsports.
2025-06-18 15:23:47 [root] INFO: should_process_url: URL https://www.snowseekers.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:23:47 [root] INFO: should_process_url: URL https://www.snowseekers.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:23:47 [root] INFO: write_url_to_db(): appended URL 'https://www.snowseekers.ca/'
2025-06-18 15:23:47 [root] INFO: def parse(): Crawling next URL: https://www.snowseekers.ca/
2025-06-18 15:23:47 [root] INFO: should_process_url: URL https://northernwilds.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:23:47 [root] INFO: should_process_url: URL https://northernwilds.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:23:47 [root] INFO: write_url_to_db(): appended URL 'https://northernwilds.com/'
2025-06-18 15:23:47 [root] INFO: def parse(): Crawling next URL: https://northernwilds.com/
2025-06-18 15:23:47 [root] INFO: should_process_url: URL https://www.zenseekers.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:23:47 [root] INFO: should_process_url: URL https://www.zenseekers.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:23:47 [root] INFO: write_url_to_db(): appended URL 'https://www.zenseekers.com/'
2025-06-18 15:23:47 [root] INFO: def parse(): Crawling next URL: https://www.zenseekers.com/
2025-06-18 15:23:47 [root] INFO: def parse(): Found keywords for URL https://www.festivalseekers.com/festival/funtastic-alberni: ['live music', 'music festivals']
2025-06-18 15:23:47 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.festivalseekers.com/festival/funtastic-alberni
2025-06-18 15:23:47 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:23:47 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:23:47 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:24:05 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:24:05 [root] INFO: query_llm(): Mistral response received: [
  {
    "source": "FestivalSeekers",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Funtastic Alberni",
    "day_of_week": "Saturday",
    "start_date": "2025-06-28",
    "end_date": "2025-06-28",
    "start_time": "17:00",
    "end_time": null,
    "price": "",
    "location": "Port Alberni, British Columbia",
    "description": "Head to Funtastic Alberni for 3 days of slo-pitch and live music."
  },
  {
    "source": "FestivalSeekers",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Funtastic Alberni",
    "day_of_week": "Sunday",
    "start_date": "2025-06-29",
    "end_date": "2025-06-29",
    "start_time": "",
    "end_time": null,
    "price": "",
    "location": "Port Alberni, British Columbia",
    "description": "Head to Funtastic Alberni for 3 days of slo-pitch and live music."
  },
  {
    "source": "FestivalSeekers",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Funtastic Alberni",
    "day_of_week": "Monday",
    "start_date": "2025-06-30",
    "end_date": "2025-06-30",
    "start_time": "",
    "end_time": "05:00",
    "price": "",
    "location": "Port Alberni, British Columbia",
    "description": "Head to Funtastic Alberni for 3 days of slo-pitch and live music."
  }
]
2025-06-18 15:24:05 [root] INFO: def extract_and_parse_json(): for url https://www.festivalseekers.com/festival/funtastic-alberni, 
Cleaned JSON ready for parsing:
[
  {
    "source": "FestivalSeekers",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Funtastic Alberni",
    "day_of_week": "Saturday",
    "start_date": "2025-06-28",
    "end_date": "2025-06-28",
    "start_time": "17:00",
    "end_time": null,
    "price": "",
    "location": "Port Alberni, British Columbia",
    "description": "Head to Funtastic Alberni for 3 days of slo-pitch and live music."
  },
  {
    "source": "FestivalSeekers",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Funtastic Alberni",
    "day_of_week": "Sunday",
    "start_date": "2025-06-29",
    "end_date": "2025-06-29",
    "start_time": "",
    "end_time": null,
    "price": "",
    "location": "Port Alberni, British Columbia",
    "description": "Head to Funtastic Alberni for 3 days of slo-pitch and live music."
  },
  {
    "source": "FestivalSeekers",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Funtastic Alberni",
    "day_of_week": "Monday",
    "start_date": "2025-06-30",
    "end_date": "2025-06-30",
    "start_time": "",
    "end_time": "05:00",
    "price": "",
    "location": "Port Alberni, British Columbia",
    "description": "Head to Funtastic Alberni for 3 days of slo-pitch and live music."
  }
]
2025-06-18 15:24:05 [root] INFO: def clean_up_address(): Starting with events_df shape: (3, 14)
2025-06-18 15:24:05 [root] INFO: def clean_up_address(): Processing location 'Port Alberni, British Columbia' (event_id: None)
2025-06-18 15:24:05 [root] INFO: def clean_up_address(): Processing location 'Port Alberni, British Columbia' (event_id: None)
2025-06-18 15:24:05 [root] INFO: def clean_up_address(): Processing location 'Port Alberni, British Columbia' (event_id: None)
2025-06-18 15:24:05 [root] INFO: write_events_to_db: Number of events to write: 3
2025-06-18 15:24:05 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/festival/funtastic-alberni'
2025-06-18 15:24:05 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 15:24:05 [root] INFO: def process_llm_response: URL https://www.festivalseekers.com/festival/funtastic-alberni marked as relevant with events written to the database.
2025-06-18 15:24:05 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/festival/funtastic-alberni'
2025-06-18 15:24:05 [root] INFO: def parse(): URL https://www.festivalseekers.com/festival/funtastic-alberni marked as relevant (LLM positive).
2025-06-18 15:24:05 [root] INFO: def parse(): Found 10 links on https://www.festivalseekers.com/festival/funtastic-alberni
2025-06-18 15:24:05 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N, URL: https://www.festivalseekers.com/festival/funtastic-alberni, source: 20+ BC summer 2025 music festivals all about good vibes ..., keywords: music festivals
2025-06-18 15:24:05 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 15:24:05 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N
2025-06-18 15:24:05 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N'
2025-06-18 15:24:05 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/festivalseekers/'
2025-06-18 15:24:05 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/festivalseekers/
2025-06-18 15:24:05 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/festivalseekers/'
2025-06-18 15:24:05 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/festivalseekers/
2025-06-18 15:24:05 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/484640918245917'
2025-06-18 15:24:05 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/groups/484640918245917
2025-06-18 15:24:05 [root] INFO: should_process_url: URL https://www.funtasticalberni.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:24:05 [root] INFO: should_process_url: URL https://www.funtasticalberni.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:24:05 [root] INFO: write_url_to_db(): appended URL 'https://www.funtasticalberni.com/'
2025-06-18 15:24:05 [root] INFO: def parse(): Crawling next URL: https://www.funtasticalberni.com/
2025-06-18 15:24:05 [root] INFO: def parse(): Found keywords for URL https://www.festivalseekers.com/festival/smithers-midsummer-music-festival: ['live music', 'music festivals']
2025-06-18 15:24:05 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.festivalseekers.com/festival/smithers-midsummer-music-festival
2025-06-18 15:24:05 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:24:05 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:24:05 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:24:19 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:24:19 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "FestivalSeekers",
        "dance_style": "live music",
        "url": "",
        "event_type": "live music",
        "event_name": "Smithers Midsummer Music Festival",
        "day_of_week": "Friday",
        "start_date": "2025-07-04",
        "end_date": "2025-07-06",
        "start_time": "09:00",
        "end_time": "22:00",
        "price": "family* $210, adult (19+) $90, youth (13-18) $60, seniors (65+) by donation, children (12 & under) = Free",
        "location": "Smithers, British Columbia",
        "description": "A family-friendly festival bringing all kinds of music genres to the serene Bulkley Valley for a three-day weekend. There will be food and craft vendors on the festival grounds. There is also a kids area with crafts, tickle trunk tents for dress-up, face painting, t-shirt painting, a playground and more."
    }
]
2025-06-18 15:24:19 [root] INFO: def extract_and_parse_json(): for url https://www.festivalseekers.com/festival/smithers-midsummer-music-festival, 
Cleaned JSON ready for parsing:
[
    {
        "source": "FestivalSeekers",
        "dance_style": "live music",
        "url": "",
        "event_type": "live music",
        "event_name": "Smithers Midsummer Music Festival",
        "day_of_week": "Friday",
        "start_date": "2025-07-04",
        "end_date": "2025-07-06",
        "start_time": "09:00",
        "end_time": "22:00",
        "price": "family* $210, adult (19+) $90, youth (13-18) $60, seniors (65+) by donation, children (12 & under) = Free",
        "location": "Smithers, British Columbia",
        "description": "A family-friendly festival bringing all kinds of music genres to the serene Bulkley Valley for a three-day weekend. There will be food and craft vendors on the festival grounds. There is also a kids area with crafts, tickle trunk tents for dress-up, face painting, t-shirt painting, a playground and more."
    }
]
2025-06-18 15:24:19 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 15:24:19 [root] INFO: def clean_up_address(): Processing location 'Smithers, British Columbia' (event_id: None)
2025-06-18 15:24:19 [root] INFO: write_events_to_db: Number of events to write: 1
2025-06-18 15:24:19 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/festival/smithers-midsummer-music-festival'
2025-06-18 15:24:19 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 15:24:19 [root] INFO: def process_llm_response: URL https://www.festivalseekers.com/festival/smithers-midsummer-music-festival marked as relevant with events written to the database.
2025-06-18 15:24:19 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/festival/smithers-midsummer-music-festival'
2025-06-18 15:24:19 [root] INFO: def parse(): URL https://www.festivalseekers.com/festival/smithers-midsummer-music-festival marked as relevant (LLM positive).
2025-06-18 15:24:19 [root] INFO: def parse(): Found 10 links on https://www.festivalseekers.com/festival/smithers-midsummer-music-festival
2025-06-18 15:24:19 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N, URL: https://www.festivalseekers.com/festival/smithers-midsummer-music-festival, source: 20+ BC summer 2025 music festivals all about good vibes ..., keywords: music festivals
2025-06-18 15:24:19 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 15:24:19 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N
2025-06-18 15:24:19 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N'
2025-06-18 15:24:19 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/festivalseekers/'
2025-06-18 15:24:19 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/festivalseekers/
2025-06-18 15:24:19 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/festivalseekers/'
2025-06-18 15:24:19 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/festivalseekers/
2025-06-18 15:24:19 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/user/FestivalSeekers.
2025-06-18 15:24:19 [root] INFO: should_process_url: URL https://www.festivalseekers.com/festival/smithers-midsummer-music-festival was last seen as relevant, processing it.
2025-06-18 15:24:19 [root] INFO: should_process_url: URL https://smithersmusicfest.com/volunteer/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:24:19 [root] INFO: should_process_url: URL https://smithersmusicfest.com/volunteer/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:24:19 [root] INFO: write_url_to_db(): appended URL 'https://smithersmusicfest.com/volunteer/'
2025-06-18 15:24:19 [root] INFO: def parse(): Crawling next URL: https://smithersmusicfest.com/volunteer/
2025-06-18 15:24:19 [root] INFO: def parse(): Found keywords for URL https://www.festivalseekers.com/festival/cowichan-valley-bluegrass-festival: ['live music', 'music festivals']
2025-06-18 15:24:19 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.festivalseekers.com/festival/cowichan-valley-bluegrass-festival
2025-06-18 15:24:19 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:24:19 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:24:19 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:24:37 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:24:37 [root] INFO: query_llm(): Mistral response received: [
  {
    "source": "FestivalSeekers",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Cowichan Valley Bluegrass Festival",
    "day_of_week": "Saturday",
    "start_date": "2025-06-14",
    "end_date": "2025-06-15",
    "start_time": "15:00",
    "end_time": "03:00",
    "price": "Weekend pass $160 +tax, Friday $65 +tax, Saturday $100 +tax, Sunday $30 +tax, Under 17 free",
    "location": "Lake Cowichan, British Columbia",
    "description": "The annual Cowichan Valley Bluegrass Festival is a foot-stomping weekend that will kick off the summer music festival and camping season!"
  }
]
2025-06-18 15:24:37 [root] INFO: def extract_and_parse_json(): for url https://www.festivalseekers.com/festival/cowichan-valley-bluegrass-festival, 
Cleaned JSON ready for parsing:
[
  {
    "source": "FestivalSeekers",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Cowichan Valley Bluegrass Festival",
    "day_of_week": "Saturday",
    "start_date": "2025-06-14",
    "end_date": "2025-06-15",
    "start_time": "15:00",
    "end_time": "03:00",
    "price": "Weekend pass $160 +tax, Friday $65 +tax, Saturday $100 +tax, Sunday $30 +tax, Under 17 free",
    "location": "Lake Cowichan, British Columbia",
    "description": "The annual Cowichan Valley Bluegrass Festival is a foot-stomping weekend that will kick off the summer music festival and camping season!"
  }
]
2025-06-18 15:24:37 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 15:24:37 [root] INFO: def clean_up_address(): Processing location 'Lake Cowichan, British Columbia' (event_id: None)
2025-06-18 15:24:37 [root] INFO: write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 15:24:37 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/festival/cowichan-valley-bluegrass-festival'
2025-06-18 15:24:37 [root] INFO: def process_llm_response: URL https://www.festivalseekers.com/festival/cowichan-valley-bluegrass-festival marked as relevant with events written to the database.
2025-06-18 15:24:37 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/festival/cowichan-valley-bluegrass-festival'
2025-06-18 15:24:37 [root] INFO: def parse(): URL https://www.festivalseekers.com/festival/cowichan-valley-bluegrass-festival marked as relevant (LLM positive).
2025-06-18 15:24:37 [root] INFO: def parse(): Found 10 links on https://www.festivalseekers.com/festival/cowichan-valley-bluegrass-festival
2025-06-18 15:24:37 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N, URL: https://www.festivalseekers.com/festival/cowichan-valley-bluegrass-festival, source: 20+ BC summer 2025 music festivals all about good vibes ..., keywords: music festivals
2025-06-18 15:24:37 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 15:24:37 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N
2025-06-18 15:24:37 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N'
2025-06-18 15:24:37 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/CowichanBluegrass/'
2025-06-18 15:24:37 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/CowichanBluegrass/
2025-06-18 15:24:37 [root] INFO: should_process_url: URL https://www.festivalseekers.com/festival/cowichan-valley-bluegrass-festival was last seen as relevant, processing it.
2025-06-18 15:24:37 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/CowichanF.
2025-06-18 15:24:37 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:24:37 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:24:37 [root] INFO: write_url_to_db(): appended URL 'https://cowichanbluegrass.com/'
2025-06-18 15:24:37 [root] INFO: def parse(): Crawling next URL: https://cowichanbluegrass.com/
2025-06-18 15:24:37 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <403 https://shopify.com/authentication/65860075773/oauth/authorize?client_id=8e679c15-f39a-40dc-8660-1dc8fca4b8be&locale=en&nonce=5c618732-595b-48aa-95cb-058f20562639&redirect_uri=https%3A%2F%2Fshopify.com%2F65860075773%2Faccount%2Fcallback%3Fsource%3Dcore&response_type=code&scope=openid+email+customer-account-api%3Afull&state=01JY2J1X6X4B96AAY1JB48KB3G>: HTTP status code is not handled or not allowed
2025-06-18 15:24:37 [root] INFO: should_process_url: URL https://www.festivalseekers.com/festival/funtastic-alberni was last seen as relevant, processing it.
2025-06-18 15:24:37 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/user/FestivalSeekers.
2025-06-18 15:24:37 [root] INFO: should_process_url: URL https://funtasticalberni.com/home.html was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:24:37 [root] INFO: should_process_url: URL https://funtasticalberni.com/home.html was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:24:37 [root] INFO: write_url_to_db(): appended URL 'https://funtasticalberni.com/home.html'
2025-06-18 15:24:37 [root] INFO: def parse(): Crawling next URL: https://funtasticalberni.com/home.html
2025-06-18 15:24:37 [root] INFO: should_process_url: URL https://smithersmusicfest.com/tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:24:37 [root] INFO: should_process_url: URL https://smithersmusicfest.com/tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:24:37 [root] INFO: write_url_to_db(): appended URL 'https://smithersmusicfest.com/tickets/'
2025-06-18 15:24:37 [root] INFO: def parse(): Crawling next URL: https://smithersmusicfest.com/tickets/
2025-06-18 15:24:37 [scrapy.extensions.logstats] INFO: Crawled 199 pages (at 14 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 15:24:37 [root] INFO: should_process_url: URL https://www.hellobc.com/places-to-go/vancouver-island/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:24:37 [root] INFO: should_process_url: URL https://www.hellobc.com/places-to-go/vancouver-island/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:24:37 [root] INFO: write_url_to_db(): appended URL 'https://www.hellobc.com/places-to-go/vancouver-island/'
2025-06-18 15:24:37 [root] INFO: def parse(): Crawling next URL: https://www.hellobc.com/places-to-go/vancouver-island/
2025-06-18 15:24:37 [root] INFO: should_process_url: URL https://albernivalleytourism.com/business-directory/?business_category=accommodations was last seen as relevant, processing it.
2025-06-18 15:24:37 [root] INFO: should_process_url: URL https://albernivalleytourism.com/business-directory/?business_category=accommodations was last seen as relevant, processing it.
2025-06-18 15:24:37 [root] INFO: write_url_to_db(): appended URL 'https://albernivalleytourism.com/business-directory/?business_category=accommodations'
2025-06-18 15:24:37 [root] INFO: def parse(): Crawling next URL: https://albernivalleytourism.com/business-directory/?business_category=accommodations
2025-06-18 15:24:37 [root] INFO: should_process_url: URL https://smithersmusicfest.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:24:37 [root] INFO: should_process_url: URL https://smithersmusicfest.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:24:37 [root] INFO: write_url_to_db(): appended URL 'https://smithersmusicfest.com/'
2025-06-18 15:24:37 [root] INFO: def parse(): Crawling next URL: https://smithersmusicfest.com/
2025-06-18 15:24:37 [root] INFO: should_process_url: URL https://www.festivalseekers.com/region/vancouver-sea-sky was last seen as relevant, processing it.
2025-06-18 15:24:37 [root] INFO: should_process_url: URL https://www.festivalseekers.com/region/vancouver-sea-sky was last seen as relevant, processing it.
2025-06-18 15:24:37 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/region/vancouver-sea-sky'
2025-06-18 15:24:37 [root] INFO: def parse(): Crawling next URL: https://www.festivalseekers.com/region/vancouver-sea-sky
2025-06-18 15:24:37 [root] INFO: should_process_url: URL https://www.zenseekers.com/story/port-alberni-easy-vancouver-island-getaway-youre-looking was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:24:37 [root] INFO: should_process_url: URL https://www.zenseekers.com/story/port-alberni-easy-vancouver-island-getaway-youre-looking was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:24:37 [root] INFO: write_url_to_db(): appended URL 'https://www.zenseekers.com/story/port-alberni-easy-vancouver-island-getaway-youre-looking'
2025-06-18 15:24:37 [root] INFO: def parse(): Crawling next URL: https://www.zenseekers.com/story/port-alberni-easy-vancouver-island-getaway-youre-looking
2025-06-18 15:24:37 [root] INFO: should_process_url: URL https://smithersmusicfest.com/festival/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:24:37 [root] INFO: should_process_url: URL https://smithersmusicfest.com/festival/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:24:37 [root] INFO: write_url_to_db(): appended URL 'https://smithersmusicfest.com/festival/'
2025-06-18 15:24:37 [root] INFO: def parse(): Crawling next URL: https://smithersmusicfest.com/festival/
2025-06-18 15:24:37 [root] INFO: should_process_url: URL https://www.festivalseekers.com/festival/td-victoria-international-jazz-festival was last seen as relevant, processing it.
2025-06-18 15:24:37 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:24:37 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:24:37 [root] INFO: write_url_to_db(): appended URL 'https://cowichanbluegrass.com/tickets/'
2025-06-18 15:24:37 [root] INFO: def parse(): Crawling next URL: https://cowichanbluegrass.com/tickets/
2025-06-18 15:24:37 [root] INFO: should_process_url: URL https://www.zenseekers.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:24:37 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/watch?v=vKX1Q1A-Xqg.
2025-06-18 15:24:37 [root] INFO: def parse(): Found keywords for URL https://www.festivalseekers.com/festival/vancouver-international-jazz-festival: ['live music', 'music festivals']
2025-06-18 15:24:37 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.festivalseekers.com/festival/vancouver-international-jazz-festival
2025-06-18 15:24:37 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:24:37 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:24:37 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:25:52 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:25:53 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Vancouver International Jazz Festival",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "06:00",
        "end_time": "null",
        "price": "",
        "location": "Vancouver, British Columbia",
        "description": "Get into the coastal groove with jazz and blues across Vancouver's Lower Mainland and North Shore"
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Vancouver International Jazz Festival",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "",
        "end_time": "null",
        "price": "",
        "location": "Vancouver, British Columbia",
        "description": "Get into the coastal groove with jazz and blues across Vancouver's Lower Mainland and North Shore"
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Vancouver International Jazz Festival",
        "day_of_week": "Sunday",
        "start_date": "2025-06-22",
        "end_date": "2025-06-22",
        "start_time": "",
        "end_time": "null",
        "price": "",
        "location": "Vancouver, British Columbia",
        "description": "Get into the coastal groove with jazz and blues across Vancouver's Lower Mainland and North Shore"
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Vancouver International Jazz Festival",
        "day_of_week": "Monday",
        "start_date": "2025-06-23",
        "end_date": "2025-06-23",
        "start_time": "",
        "end_time": "null",
        "price": "",
        "location": "Vancouver, British Columbia",
        "description": "Get into the coastal groove with jazz and blues across Vancouver's Lower Mainland and North Shore"
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Vancouver International Jazz Festival",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-24",
        "end_date": "2025-06-24",
        "start_time": "",
        "end_time": "null",
        "price": "",
        "location": "Vancouver, British Columbia",
        "description": "Get into the coastal groove with jazz and blues across Vancouver's Lower Mainland and North Shore"
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Vancouver International Jazz Festival",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-25",
        "end_date": "2025-06-25",
        "start_time": "",
        "end_time": "null",
        "price": "",
        "location": "Vancouver, British Columbia",
        "description": "Get into the coastal groove with jazz and blues across Vancouver's Lower Mainland and North Shore"
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Vancouver International Jazz Festival",
        "day_of_week": "Thursday",
        "start_date": "2025-06-26",
        "end_date": "2025-06-26",
        "start_time": "",
        "end_time": "null",
        "price": "",
        "location": "Vancouver, British Columbia",
        "description": "Get into the coastal groove with jazz and blues across Vancouver's Lower Mainland and North Shore"
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Vancouver International Jazz Festival",
        "day_of_week": "Friday",
        "start_date": "2025-06-27",
        "end_date": "2025-06-27",
        "start_time": "",
        "end_time": "null",
        "price": "",
        "location": "Vancouver, British Columbia",
        "description": "Get into the coastal groove with jazz and blues across Vancouver's Lower Mainland and North Shore"
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Vancouver International Jazz Festival",
        "day_of_week": "Saturday",
        "start_date": "2025-06-28",
        "end_date": "2025-06-28",
        "start_time": "",
        "end_time": "null",
        "price": "",
        "location": "Vancouver, British Columbia",
        "description": "Get into the coastal groove with jazz and blues across Vancouver's Lower Mainland and North Shore"
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Vancouver International Jazz Festival",
        "day_of_week": "Sunday",
        "start_date": "2025-06-29",
        "end_date": "2025-06-29",
        "start_time": "",
        "end_time": "18:00",
        "price": "",
        "location": "Vancouver, British Columbia",
        "description": "Get into the coastal groove with jazz and blues across Vancouver's Lower Mainland and North Shore"
    }
]
2025-06-18 15:25:53 [root] INFO: def extract_and_parse_json(): for url https://www.festivalseekers.com/festival/vancouver-international-jazz-festival, 
Cleaned JSON ready for parsing:
[
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Vancouver International Jazz Festival",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "06:00",
        "end_time": "null",
        "price": "",
        "location": "Vancouver, British Columbia",
        "description": "Get into the coastal groove with jazz and blues across Vancouver's Lower Mainland and North Shore"
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Vancouver International Jazz Festival",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "",
        "end_time": "null",
        "price": "",
        "location": "Vancouver, British Columbia",
        "description": "Get into the coastal groove with jazz and blues across Vancouver's Lower Mainland and North Shore"
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Vancouver International Jazz Festival",
        "day_of_week": "Sunday",
        "start_date": "2025-06-22",
        "end_date": "2025-06-22",
        "start_time": "",
        "end_time": "null",
        "price": "",
        "location": "Vancouver, British Columbia",
        "description": "Get into the coastal groove with jazz and blues across Vancouver's Lower Mainland and North Shore"
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Vancouver International Jazz Festival",
        "day_of_week": "Monday",
        "start_date": "2025-06-23",
        "end_date": "2025-06-23",
        "start_time": "",
        "end_time": "null",
        "price": "",
        "location": "Vancouver, British Columbia",
        "description": "Get into the coastal groove with jazz and blues across Vancouver's Lower Mainland and North Shore"
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Vancouver International Jazz Festival",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-24",
        "end_date": "2025-06-24",
        "start_time": "",
        "end_time": "null",
        "price": "",
        "location": "Vancouver, British Columbia",
        "description": "Get into the coastal groove with jazz and blues across Vancouver's Lower Mainland and North Shore"
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Vancouver International Jazz Festival",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-25",
        "end_date": "2025-06-25",
        "start_time": "",
        "end_time": "null",
        "price": "",
        "location": "Vancouver, British Columbia",
        "description": "Get into the coastal groove with jazz and blues across Vancouver's Lower Mainland and North Shore"
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Vancouver International Jazz Festival",
        "day_of_week": "Thursday",
        "start_date": "2025-06-26",
        "end_date": "2025-06-26",
        "start_time": "",
        "end_time": "null",
        "price": "",
        "location": "Vancouver, British Columbia",
        "description": "Get into the coastal groove with jazz and blues across Vancouver's Lower Mainland and North Shore"
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Vancouver International Jazz Festival",
        "day_of_week": "Friday",
        "start_date": "2025-06-27",
        "end_date": "2025-06-27",
        "start_time": "",
        "end_time": "null",
        "price": "",
        "location": "Vancouver, British Columbia",
        "description": "Get into the coastal groove with jazz and blues across Vancouver's Lower Mainland and North Shore"
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Vancouver International Jazz Festival",
        "day_of_week": "Saturday",
        "start_date": "2025-06-28",
        "end_date": "2025-06-28",
        "start_time": "",
        "end_time": "null",
        "price": "",
        "location": "Vancouver, British Columbia",
        "description": "Get into the coastal groove with jazz and blues across Vancouver's Lower Mainland and North Shore"
    },
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Vancouver International Jazz Festival",
        "day_of_week": "Sunday",
        "start_date": "2025-06-29",
        "end_date": "2025-06-29",
        "start_time": "",
        "end_time": "18:00",
        "price": "",
        "location": "Vancouver, British Columbia",
        "description": "Get into the coastal groove with jazz and blues across Vancouver's Lower Mainland and North Shore"
    }
]
2025-06-18 15:25:53 [root] INFO: def clean_up_address(): Starting with events_df shape: (10, 14)
2025-06-18 15:25:53 [root] INFO: def clean_up_address(): Processing location 'Vancouver, British Columbia' (event_id: None)
2025-06-18 15:25:53 [root] INFO: def clean_up_address(): Processing location 'Vancouver, British Columbia' (event_id: None)
2025-06-18 15:25:53 [root] INFO: def clean_up_address(): Processing location 'Vancouver, British Columbia' (event_id: None)
2025-06-18 15:25:53 [root] INFO: def clean_up_address(): Processing location 'Vancouver, British Columbia' (event_id: None)
2025-06-18 15:25:53 [root] INFO: def clean_up_address(): Processing location 'Vancouver, British Columbia' (event_id: None)
2025-06-18 15:25:53 [root] INFO: def clean_up_address(): Processing location 'Vancouver, British Columbia' (event_id: None)
2025-06-18 15:25:53 [root] INFO: def clean_up_address(): Processing location 'Vancouver, British Columbia' (event_id: None)
2025-06-18 15:25:53 [root] INFO: def clean_up_address(): Processing location 'Vancouver, British Columbia' (event_id: None)
2025-06-18 15:25:53 [root] INFO: def clean_up_address(): Processing location 'Vancouver, British Columbia' (event_id: None)
2025-06-18 15:25:53 [root] INFO: def clean_up_address(): Processing location 'Vancouver, British Columbia' (event_id: None)
2025-06-18 15:25:53 [root] INFO: write_events_to_db: Number of events to write: 10
2025-06-18 15:25:53 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/festival/vancouver-international-jazz-festival'
2025-06-18 15:25:53 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 15:25:53 [root] INFO: def process_llm_response: URL https://www.festivalseekers.com/festival/vancouver-international-jazz-festival marked as relevant with events written to the database.
2025-06-18 15:25:53 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/festival/vancouver-international-jazz-festival'
2025-06-18 15:25:53 [root] INFO: def parse(): URL https://www.festivalseekers.com/festival/vancouver-international-jazz-festival marked as relevant (LLM positive).
2025-06-18 15:25:53 [root] INFO: def parse(): Found 10 links on https://www.festivalseekers.com/festival/vancouver-international-jazz-festival
2025-06-18 15:25:53 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N, URL: https://www.festivalseekers.com/festival/vancouver-international-jazz-festival, source: 20+ BC summer 2025 music festivals all about good vibes ..., keywords: music festivals
2025-06-18 15:25:53 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 15:25:53 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N
2025-06-18 15:25:53 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N'
2025-06-18 15:25:53 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/coastaljazz/'
2025-06-18 15:25:53 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/coastaljazz/
2025-06-18 15:25:53 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/coastaljazz'
2025-06-18 15:25:53 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/coastaljazz
2025-06-18 15:25:53 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/channel/UC4c_p0--Ca7PoIR9-B-lWwA.
2025-06-18 15:25:53 [root] INFO: should_process_url: URL https://www.festivalseekers.com/festival/td-victoria-international-jazz-festival was last seen as relevant, processing it.
2025-06-18 15:25:53 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/coastaljazz.
2025-06-18 15:25:53 [root] INFO: should_process_url: URL https://www.festivalseekers.com/festival/vancouver-international-jazz-festival was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:25:53 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/festival-ticket-info/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:25:53 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/festival-ticket-info/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:25:53 [root] INFO: write_url_to_db(): appended URL 'https://www.coastaljazz.ca/festival/festival-ticket-info/'
2025-06-18 15:25:53 [root] INFO: def parse(): Crawling next URL: https://www.coastaljazz.ca/festival/festival-ticket-info/
2025-06-18 15:25:53 [root] INFO: def parse(): Found keywords for URL https://www.festivalseekers.com/festival/prisma: ['live music', 'music festivals']
2025-06-18 15:25:53 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.festivalseekers.com/festival/prisma
2025-06-18 15:25:53 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:25:53 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:25:53 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:26:12 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:26:12 [root] INFO: query_llm(): Mistral response received: [
  {
    "source": "FestivalSeekers",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "PRISMA Festival",
    "day_of_week": "Monday",
    "start_date": "2025-06-16",
    "end_date": "2025-06-28",
    "start_time": "",
    "end_time": null,
    "price": "",
    "location": "Powell River, British Columbia",
    "description": "PRISMA spreads the orchestral musical love around Powell River, showcasing the talents of young musicians at different venues across the city."
  }
]
2025-06-18 15:26:12 [root] INFO: def extract_and_parse_json(): for url https://www.festivalseekers.com/festival/prisma, 
Cleaned JSON ready for parsing:
[
  {
    "source": "FestivalSeekers",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "PRISMA Festival",
    "day_of_week": "Monday",
    "start_date": "2025-06-16",
    "end_date": "2025-06-28",
    "start_time": "",
    "end_time": null,
    "price": "",
    "location": "Powell River, British Columbia",
    "description": "PRISMA spreads the orchestral musical love around Powell River, showcasing the talents of young musicians at different venues across the city."
  }
]
2025-06-18 15:26:12 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 15:26:12 [root] INFO: def clean_up_address(): Processing location 'Powell River, British Columbia' (event_id: None)
2025-06-18 15:26:12 [root] INFO: write_events_to_db: Number of events to write: 1
2025-06-18 15:26:12 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/festival/prisma'
2025-06-18 15:26:12 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 15:26:12 [root] INFO: def process_llm_response: URL https://www.festivalseekers.com/festival/prisma marked as relevant with events written to the database.
2025-06-18 15:26:12 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/festival/prisma'
2025-06-18 15:26:12 [root] INFO: def parse(): URL https://www.festivalseekers.com/festival/prisma marked as relevant (LLM positive).
2025-06-18 15:26:12 [root] INFO: def parse(): Found 10 links on https://www.festivalseekers.com/festival/prisma
2025-06-18 15:26:12 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N, URL: https://www.festivalseekers.com/festival/prisma, source: 20+ BC summer 2025 music festivals all about good vibes ..., keywords: music festivals
2025-06-18 15:26:12 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 15:26:12 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N
2025-06-18 15:26:12 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N'
2025-06-18 15:26:12 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/SunshineCoastTourismBC/'
2025-06-18 15:26:12 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/SunshineCoastTourismBC/
2025-06-18 15:26:12 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/festivalseekers/'
2025-06-18 15:26:12 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/festivalseekers/
2025-06-18 15:26:12 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/festivalseekers/'
2025-06-18 15:26:12 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/festivalseekers/
2025-06-18 15:26:12 [root] INFO: should_process_url: URL https://sunshinecoastcanada.com/?utm_source=FestivalSeekers&utm_medium=Referral&utm_campaign=FestivalSeekers was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:26:12 [root] INFO: should_process_url: URL https://sunshinecoastcanada.com/?utm_source=FestivalSeekers&utm_medium=Referral&utm_campaign=FestivalSeekers was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:26:12 [root] INFO: write_url_to_db(): appended URL 'https://sunshinecoastcanada.com/?utm_source=FestivalSeekers&utm_medium=Referral&utm_campaign=FestivalSeekers'
2025-06-18 15:26:12 [root] INFO: def parse(): Crawling next URL: https://sunshinecoastcanada.com/?utm_source=FestivalSeekers&utm_medium=Referral&utm_campaign=FestivalSeekers
2025-06-18 15:26:12 [scrapy.extensions.logstats] INFO: Crawled 206 pages (at 7 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 15:26:12 [root] INFO: should_process_url: URL http://www.coastaljazz.ca/ticket_information was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:26:12 [root] INFO: should_process_url: URL http://www.coastaljazz.ca/ticket_information was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:26:12 [root] INFO: write_url_to_db(): appended URL 'http://www.coastaljazz.ca/ticket_information'
2025-06-18 15:26:12 [root] INFO: def parse(): Crawling next URL: http://www.coastaljazz.ca/ticket_information
2025-06-18 15:26:12 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/user/FestivalSeekers.
2025-06-18 15:26:12 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/search?q=%40sunshinecoastca&src=typd.
2025-06-18 15:26:12 [root] INFO: should_process_url: URL https://prismafestival.com/tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:26:12 [root] INFO: should_process_url: URL https://prismafestival.com/tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:26:12 [root] INFO: write_url_to_db(): appended URL 'https://prismafestival.com/tickets/'
2025-06-18 15:26:12 [root] INFO: def parse(): Crawling next URL: https://prismafestival.com/tickets/
2025-06-18 15:26:12 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <403 https://statcounter.com/>: HTTP status code is not handled or not allowed
2025-06-18 15:26:12 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/ was last seen as relevant, processing it.
2025-06-18 15:26:12 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/ was last seen as relevant, processing it.
2025-06-18 15:26:12 [root] INFO: write_url_to_db(): appended URL 'https://www.coastaljazz.ca/'
2025-06-18 15:26:12 [root] INFO: def parse(): Crawling next URL: https://www.coastaljazz.ca/
2025-06-18 15:26:12 [root] INFO: should_process_url: URL https://www.festivalseekers.com/festival/prisma was last seen as relevant, processing it.
2025-06-18 15:26:12 [root] INFO: should_process_url: URL https://prismafestival.com/festival/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:26:12 [root] INFO: should_process_url: URL https://prismafestival.com/festival/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:26:12 [root] INFO: write_url_to_db(): appended URL 'https://prismafestival.com/festival/'
2025-06-18 15:26:12 [root] INFO: def parse(): Crawling next URL: https://prismafestival.com/festival/
2025-06-18 15:26:12 [root] INFO: write_url_to_db(): appended URL 'http://eepurl.com/hRLq6H'
2025-06-18 15:26:12 [root] INFO: def parse(): URL http://eepurl.com/hRLq6H marked as irrelevant (no keywords).
2025-06-18 15:26:12 [root] INFO: def parse(): Found 10 links on https://mailchimp.com/solutions/email-marketing-platform/?utm_source=freemium_newsletter&utm_medium=email&utm_campaign=referral_marketing&aid=3ed3b9af192a11082908769d6&afl=1
2025-06-18 15:26:12 [root] INFO: should_process_url: URL https://www.creditkarma.com/ has never been seen before, processing it.
2025-06-18 15:26:12 [root] INFO: should_process_url: URL https://www.creditkarma.com/ has never been seen before, processing it.
2025-06-18 15:26:12 [root] INFO: write_url_to_db(): appended URL 'https://www.creditkarma.com/'
2025-06-18 15:26:12 [root] INFO: def parse(): Crawling next URL: https://www.creditkarma.com/
2025-06-18 15:26:12 [root] INFO: def parse(): Found keywords for URL https://www.festivalseekers.com/festival/td-victoria-international-jazz-festival: ['live music', 'music festivals']
2025-06-18 15:26:12 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.festivalseekers.com/festival/td-victoria-international-jazz-festival
2025-06-18 15:26:12 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:26:12 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:26:12 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:26:23 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:26:23 [root] INFO: query_llm(): Mistral response received: [
  {
    "source": "FestivalSeekers",
    "dance_style": "jazz, blues, worldbeat",
    "url": "",
    "event_type": "live music",
    "event_name": "TD Victoria International Jazz Festival",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-29",
    "start_time": "",
    "end_time": null,
    "price": "",
    "location": "Victoria, British Columbia",
    "description": "Over 300 musicians bring all genres of jazz, blues and worldbeat music to the city of Victoria."
  }
]
2025-06-18 15:26:23 [root] INFO: def extract_and_parse_json(): for url https://www.festivalseekers.com/festival/td-victoria-international-jazz-festival, 
Cleaned JSON ready for parsing:
[
  {
    "source": "FestivalSeekers",
    "dance_style": "jazz, blues, worldbeat",
    "url": "",
    "event_type": "live music",
    "event_name": "TD Victoria International Jazz Festival",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-29",
    "start_time": "",
    "end_time": null,
    "price": "",
    "location": "Victoria, British Columbia",
    "description": "Over 300 musicians bring all genres of jazz, blues and worldbeat music to the city of Victoria."
  }
]
2025-06-18 15:26:23 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 15:26:23 [root] INFO: def clean_up_address(): Processing location 'Victoria, British Columbia' (event_id: None)
2025-06-18 15:26:23 [root] INFO: write_events_to_db: Number of events to write: 1
2025-06-18 15:26:23 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/festival/td-victoria-international-jazz-festival'
2025-06-18 15:26:23 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 15:26:23 [root] INFO: def process_llm_response: URL https://www.festivalseekers.com/festival/td-victoria-international-jazz-festival marked as relevant with events written to the database.
2025-06-18 15:26:23 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/festival/td-victoria-international-jazz-festival'
2025-06-18 15:26:23 [root] INFO: def parse(): URL https://www.festivalseekers.com/festival/td-victoria-international-jazz-festival marked as relevant (LLM positive).
2025-06-18 15:26:23 [root] INFO: def parse(): Found 10 links on https://www.festivalseekers.com/festival/td-victoria-international-jazz-festival
2025-06-18 15:26:23 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N, URL: https://www.festivalseekers.com/festival/td-victoria-international-jazz-festival, source: 20+ BC summer 2025 music festivals all about good vibes ..., keywords: music festivals
2025-06-18 15:26:23 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 15:26:23 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N
2025-06-18 15:26:23 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N'
2025-06-18 15:26:23 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/festivalseekers/'
2025-06-18 15:26:23 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/festivalseekers/
2025-06-18 15:26:23 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/VicJazzSociety'
2025-06-18 15:26:23 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/VicJazzSociety
2025-06-18 15:26:23 [root] INFO: should_process_url: URL https://jazzvictoria.ca/jazzfest-home/jazzfest-line-up/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:26:23 [root] INFO: should_process_url: URL https://jazzvictoria.ca/jazzfest-home/jazzfest-line-up/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:26:23 [root] INFO: write_url_to_db(): appended URL 'https://jazzvictoria.ca/jazzfest-home/jazzfest-line-up/'
2025-06-18 15:26:23 [root] INFO: def parse(): Crawling next URL: https://jazzvictoria.ca/jazzfest-home/jazzfest-line-up/
2025-06-18 15:26:23 [root] INFO: def parse(): Found keywords for URL https://www.festivalseekers.com/festival/kathaumixw: ['live music', 'music festivals']
2025-06-18 15:26:23 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.festivalseekers.com/festival/kathaumixw
2025-06-18 15:26:23 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:26:23 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:26:23 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:26:38 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:26:38 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "Kathaumixw",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Kathaumixw",
        "day_of_week": "Tuesday",
        "start_date": "2025-07-01",
        "end_date": "2025-07-05",
        "start_time": "15:00",
        "end_time": "03:00",
        "price": "",
        "location": "Powell River, British Columbia",
        "description": "The International Choral Kathaumixw is a 5-day choral festival. Enjoy concerts, learn from peers and from world renowned choral artists, watch competitions and connect during social events."
    }
]
2025-06-18 15:26:38 [root] INFO: def extract_and_parse_json(): for url https://www.festivalseekers.com/festival/kathaumixw, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Kathaumixw",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Kathaumixw",
        "day_of_week": "Tuesday",
        "start_date": "2025-07-01",
        "end_date": "2025-07-05",
        "start_time": "15:00",
        "end_time": "03:00",
        "price": "",
        "location": "Powell River, British Columbia",
        "description": "The International Choral Kathaumixw is a 5-day choral festival. Enjoy concerts, learn from peers and from world renowned choral artists, watch competitions and connect during social events."
    }
]
2025-06-18 15:26:38 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 15:26:38 [root] INFO: def clean_up_address(): Processing location 'Powell River, British Columbia' (event_id: None)
2025-06-18 15:26:38 [root] INFO: write_events_to_db: Number of events to write: 1
2025-06-18 15:26:38 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/festival/kathaumixw'
2025-06-18 15:26:38 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 15:26:38 [root] INFO: def process_llm_response: URL https://www.festivalseekers.com/festival/kathaumixw marked as relevant with events written to the database.
2025-06-18 15:26:38 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/festival/kathaumixw'
2025-06-18 15:26:38 [root] INFO: def parse(): URL https://www.festivalseekers.com/festival/kathaumixw marked as relevant (LLM positive).
2025-06-18 15:26:38 [root] INFO: def parse(): Found 10 links on https://www.festivalseekers.com/festival/kathaumixw
2025-06-18 15:26:38 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N, URL: https://www.festivalseekers.com/festival/kathaumixw, source: 20+ BC summer 2025 music festivals all about good vibes ..., keywords: music festivals
2025-06-18 15:26:38 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 15:26:38 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N
2025-06-18 15:26:38 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N'
2025-06-18 15:26:38 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/festivalseekers/'
2025-06-18 15:26:38 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/festivalseekers/
2025-06-18 15:26:38 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/Kathaumixw'
2025-06-18 15:26:39 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/Kathaumixw
2025-06-18 15:26:39 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/kathaumixw/'
2025-06-18 15:26:39 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/kathaumixw/
2025-06-18 15:26:39 [root] INFO: should_process_url: URL http://www.sunshinecoastcanada.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:26:39 [root] INFO: should_process_url: URL http://www.sunshinecoastcanada.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:26:39 [root] INFO: write_url_to_db(): appended URL 'http://www.sunshinecoastcanada.com/'
2025-06-18 15:26:39 [root] INFO: def parse(): Crawling next URL: http://www.sunshinecoastcanada.com/
2025-06-18 15:26:39 [root] INFO: def parse(): Found keywords for URL https://www.festivalseekers.com/festival/victoria-ska-fest: ['dance', 'live music', 'music festivals']
2025-06-18 15:26:39 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.festivalseekers.com/festival/victoria-ska-fest
2025-06-18 15:26:39 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:26:39 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:26:39 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:26:50 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:26:50 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Victoria Ska & Reggae Fest",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-22",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Victoria, British Columbia",
        "description": "Celebrate 26 years of Victoria's Ska & Reggae Festival, a diverse music showcase featuring the best reggae, ska, dub, jazz, dancehall, and punk from across the globe. A family-friendly event, it's the largest and longest running event of its kind in North America."
    }
]
2025-06-18 15:26:50 [root] INFO: def extract_and_parse_json(): for url https://www.festivalseekers.com/festival/victoria-ska-fest, 
Cleaned JSON ready for parsing:
[
    {
        "source": "FestivalSeekers",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Victoria Ska & Reggae Fest",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-22",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Victoria, British Columbia",
        "description": "Celebrate 26 years of Victoria's Ska & Reggae Festival, a diverse music showcase featuring the best reggae, ska, dub, jazz, dancehall, and punk from across the globe. A family-friendly event, it's the largest and longest running event of its kind in North America."
    }
]
2025-06-18 15:26:50 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 15:26:50 [root] INFO: def clean_up_address(): Processing location 'Victoria, British Columbia' (event_id: None)
2025-06-18 15:26:50 [root] INFO: write_events_to_db: Number of events to write: 1
2025-06-18 15:26:50 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/festival/victoria-ska-fest'
2025-06-18 15:26:50 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 15:26:50 [root] INFO: def process_llm_response: URL https://www.festivalseekers.com/festival/victoria-ska-fest marked as relevant with events written to the database.
2025-06-18 15:26:50 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/festival/victoria-ska-fest'
2025-06-18 15:26:50 [root] INFO: def parse(): URL https://www.festivalseekers.com/festival/victoria-ska-fest marked as relevant (LLM positive).
2025-06-18 15:26:50 [root] INFO: def parse(): Found 10 links on https://www.festivalseekers.com/festival/victoria-ska-reggae-fest
2025-06-18 15:26:50 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N, URL: https://www.festivalseekers.com/festival/victoria-ska-fest, source: 20+ BC summer 2025 music festivals all about good vibes ..., keywords: music festivals
2025-06-18 15:26:50 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 15:26:50 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N
2025-06-18 15:26:50 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N'
2025-06-18 15:26:50 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/victoria.ska.fest/'
2025-06-18 15:26:50 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/victoria.ska.fest/
2025-06-18 15:26:50 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/victoria.ska.fest'
2025-06-18 15:26:50 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/victoria.ska.fest
2025-06-18 15:26:50 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/reel/C0NAtYoMrjv/?utm_source=ig_embed&utm_campaign=loading'
2025-06-18 15:26:50 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/reel/C0NAtYoMrjv/?utm_source=ig_embed&utm_campaign=loading
2025-06-18 15:26:50 [root] INFO: should_process_url: URL http://victoriaskafest.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:26:50 [root] INFO: should_process_url: URL http://victoriaskafest.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:26:50 [root] INFO: write_url_to_db(): appended URL 'http://victoriaskafest.ca/'
2025-06-18 15:26:50 [root] INFO: def parse(): Crawling next URL: http://victoriaskafest.ca/
2025-06-18 15:26:50 [root] INFO: write_url_to_db(): appended URL 'https://thedukesaloon.com/block-party/'
2025-06-18 15:26:50 [root] INFO: def parse(): URL https://thedukesaloon.com/block-party/ marked as irrelevant (no keywords).
2025-06-18 15:26:50 [root] INFO: def parse(): Found 10 links on https://thedukesaloon.com/block-party/
2025-06-18 15:26:50 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/thedukesaloon/'
2025-06-18 15:26:50 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/thedukesaloon/
2025-06-18 15:26:50 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/TheDukeVictoria/'
2025-06-18 15:26:50 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/TheDukeVictoria/
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://thedukesaloon.com/block-party/ was last seen as relevant, processing it.
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://thedukesaloon.com/us/ was last seen as not relevant but hit_ratio (0.33) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://thedukesaloon.com/fundraising/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://thedukesaloon.com/events/ was last seen as relevant, processing it.
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://thedukesaloon.com/ was last seen as relevant, processing it.
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://www.google.ca/maps/dir/''/The+Duke+Saloon/@48.4319416,-123.4380883,12z/data=!3m1!4b1!4m8!4m7!1m0!1m5!1m1!1s0x548f748257cd657d:0x7b34826b02413603!2m2!1d-123.369422!2d48.431962 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://thedukesaloon.com/weekly/ was last seen as relevant, processing it.
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://thedukesaloon.com/gallery/ does not meet criteria for processing, skipping it.
2025-06-18 15:26:50 [root] INFO: def eventbrite_search(): Skipping URL https://thedukesaloon.com/gallery/ based on historical relevancy.
2025-06-18 15:26:50 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <403 https://www.tripadvisor.ca/Restaurant_Review-g154945-d785052-Reviews-Irish_Times_Pub-Victoria_Victoria_Capital_Regional_District_Vancouver_Island_Briti.html>: HTTP status code is not handled or not allowed
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://mailchimp.com/integrations/?categories=Analytics has never been seen before, processing it.
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://mailchimp.com/integrations/?categories=Analytics has never been seen before, processing it.
2025-06-18 15:26:50 [root] INFO: write_url_to_db(): appended URL 'https://mailchimp.com/integrations/?categories=Analytics'
2025-06-18 15:26:50 [root] INFO: def parse(): Crawling next URL: https://mailchimp.com/integrations/?categories=Analytics
2025-06-18 15:26:50 [scrapy.extensions.logstats] INFO: Crawled 207 pages (at 1 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://jazzvictoria.ca/jazzfest-home/workshops/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://jazzvictoria.ca/jazzfest-home/workshops/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:26:50 [root] INFO: write_url_to_db(): appended URL 'https://jazzvictoria.ca/jazzfest-home/workshops/'
2025-06-18 15:26:50 [root] INFO: def parse(): Crawling next URL: https://jazzvictoria.ca/jazzfest-home/workshops/
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://www.kathaumixw.org/tickets.shtml was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://www.kathaumixw.org/tickets.shtml was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:26:50 [root] INFO: write_url_to_db(): appended URL 'https://www.kathaumixw.org/tickets.shtml'
2025-06-18 15:26:50 [root] INFO: def parse(): Crawling next URL: https://www.kathaumixw.org/tickets.shtml
2025-06-18 15:26:50 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/Victoriaskafest.
2025-06-18 15:26:50 [root] INFO: should_process_url: URL http://victoriaskafest.ca/#/tickets was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:26:50 [root] INFO: should_process_url: URL http://victoriaskafest.ca/#/tickets was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:26:50 [root] INFO: write_url_to_db(): appended URL 'http://victoriaskafest.ca/#/tickets'
2025-06-18 15:26:50 [root] INFO: def parse(): Crawling next URL: http://victoriaskafest.ca/#/tickets
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://mailchimp.com/developer/ has never been seen before, processing it.
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://mailchimp.com/developer/ has never been seen before, processing it.
2025-06-18 15:26:50 [root] INFO: write_url_to_db(): appended URL 'https://mailchimp.com/developer/'
2025-06-18 15:26:50 [root] INFO: def parse(): Crawling next URL: https://mailchimp.com/developer/
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://mailchimp.com/integrations/?categories=E-commerce has never been seen before, processing it.
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://mailchimp.com/integrations/?categories=E-commerce has never been seen before, processing it.
2025-06-18 15:26:50 [root] INFO: write_url_to_db(): appended URL 'https://mailchimp.com/integrations/?categories=E-commerce'
2025-06-18 15:26:50 [root] INFO: def parse(): Crawling next URL: https://mailchimp.com/integrations/?categories=E-commerce
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://www.festivalseekers.com/festival/td-victoria-international-jazz-festival was last seen as relevant, processing it.
2025-06-18 15:26:50 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/VicJazzSociety.
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://jazzvictoria.ca/home/tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://jazzvictoria.ca/home/tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:26:50 [root] INFO: write_url_to_db(): appended URL 'https://jazzvictoria.ca/home/tickets/'
2025-06-18 15:26:50 [root] INFO: def parse(): Crawling next URL: https://jazzvictoria.ca/home/tickets/
2025-06-18 15:26:50 [root] INFO: should_process_url: URL http://www.sunshinecoastcanada.com/hidden-gems/powell-forest-canoe-route was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:26:50 [root] INFO: should_process_url: URL http://www.sunshinecoastcanada.com/hidden-gems/powell-forest-canoe-route was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:26:50 [root] INFO: write_url_to_db(): appended URL 'http://www.sunshinecoastcanada.com/hidden-gems/powell-forest-canoe-route'
2025-06-18 15:26:50 [root] INFO: def parse(): Crawling next URL: http://www.sunshinecoastcanada.com/hidden-gems/powell-forest-canoe-route
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://victoriaskafest.ca/#/tickets was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://victoriaskafest.ca/#/tickets was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:26:50 [root] INFO: write_url_to_db(): appended URL 'https://victoriaskafest.ca/#/tickets'
2025-06-18 15:26:50 [root] INFO: def parse(): Crawling next URL: https://victoriaskafest.ca/#/tickets
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://mailchimp.com/ has never been seen before, processing it.
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://mailchimp.com/ has never been seen before, processing it.
2025-06-18 15:26:50 [root] INFO: write_url_to_db(): appended URL 'https://mailchimp.com/'
2025-06-18 15:26:50 [root] INFO: def parse(): Crawling next URL: https://mailchimp.com/
2025-06-18 15:26:50 [root] INFO: should_process_url: URL http://jazzvictoria.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:26:50 [root] INFO: should_process_url: URL http://jazzvictoria.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:26:50 [root] INFO: write_url_to_db(): appended URL 'http://jazzvictoria.ca/'
2025-06-18 15:26:50 [root] INFO: def parse(): Crawling next URL: http://jazzvictoria.ca/
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://www.festivalseekers.com/festival/kathaumixw was last seen as relevant, processing it.
2025-06-18 15:26:50 [root] INFO: should_process_url: URL http://www.kathaumixw.org/calendar.shtml was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:26:50 [root] INFO: should_process_url: URL http://www.kathaumixw.org/calendar.shtml was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:26:50 [root] INFO: write_url_to_db(): appended URL 'http://www.kathaumixw.org/calendar.shtml'
2025-06-18 15:26:50 [root] INFO: def parse(): Crawling next URL: http://www.kathaumixw.org/calendar.shtml
2025-06-18 15:26:50 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/channel/UCoqdQu00hHb4F-oLo_WLoBg.
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://www.victoriaskafest.ca/home was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://www.victoriaskafest.ca/home was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:26:50 [root] INFO: write_url_to_db(): appended URL 'https://www.victoriaskafest.ca/home'
2025-06-18 15:26:50 [root] INFO: def parse(): Crawling next URL: https://www.victoriaskafest.ca/home
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://www.intuit.com/ has never been seen before, processing it.
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://www.intuit.com/ has never been seen before, processing it.
2025-06-18 15:26:50 [root] INFO: write_url_to_db(): appended URL 'https://www.intuit.com/'
2025-06-18 15:26:50 [root] INFO: def parse(): Crawling next URL: https://www.intuit.com/
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://jazzvictoria.ca/jazzfest-home/ was last seen as relevant, processing it.
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://jazzvictoria.ca/jazzfest-home/ was last seen as relevant, processing it.
2025-06-18 15:26:50 [root] INFO: write_url_to_db(): appended URL 'https://jazzvictoria.ca/jazzfest-home/'
2025-06-18 15:26:50 [root] INFO: def parse(): Crawling next URL: https://jazzvictoria.ca/jazzfest-home/
2025-06-18 15:26:50 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/Kathaumixw.
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://www.kathaumixw.org/schedule.shtml was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://www.kathaumixw.org/schedule.shtml was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:26:50 [root] INFO: write_url_to_db(): appended URL 'https://www.kathaumixw.org/schedule.shtml'
2025-06-18 15:26:50 [root] INFO: def parse(): Crawling next URL: https://www.kathaumixw.org/schedule.shtml
2025-06-18 15:26:50 [root] INFO: should_process_url: URL https://www.festivalseekers.com/festival/victoria-ska-fest was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:26:50 [root] INFO: def parse(): Found keywords for URL https://sipmagazine.com/grazers-part-and-parcel-victoria/: ['dance', 'live music', 'rumba']
2025-06-18 15:26:50 [root] INFO: def generate_prompt(): Generating prompt for URL: https://sipmagazine.com/grazers-part-and-parcel-victoria/
2025-06-18 15:26:50 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:26:50 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:26:50 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:26:52 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 15:26:52 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 197724 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 15:26:52 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 15:28:05 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:28:05 [root] INFO: query_llm(): OpenAI response received: [{"source":"Sip Magazine","dance_style":"","url":"","event_type":"live music","event_name":"Summer Terrace Series","day_of_week":"Monday","start_date":"2025-06-16","end_date":"2025-06-16","start_time":"16:00","end_time":"19:00","price":"Free","location":"Fielding Hills Winery, 565 S Lakeshore DR, Chelan, WA 98816","description":"Every Saturday in July and August from 4 - 7pm, spend a relaxing evening listening to talented local musicians on our terrace. Evenings will include a menu of glass pours, …"},{"source":"Sip Magazine","dance_style":"","url":"","event_type":"other","event_name":"Celebrate Walla Walla Summer Supper","day_of_week":"Friday","start_date":"2025-06-20","end_date":"2025-06-20","start_time":"17:30","end_time":"20:00","price":"$100","location":"Echolands, 3281 Mill Creek Rd, Walla Walla, WA 99362","description":"Enjoy a BBQ-inspired summer menu, paired with approachable wines, and community vibes at this relaxed vineyard dinner. Station-style dining and a wide range of wines highlight the Valley’s versatility. Includes …"},{"source":"Sip Magazine","dance_style":"","url":"","event_type":"other","event_name":"Pizza Pop Up at Dineen Vineyards","day_of_week":"Saturday","start_date":"2025-06-21","end_date":"2025-06-21","start_time":"12:00","end_time":"17:00","price":"","location":"Dineen Vineyards, 2980 Gilbert Road, Zillah, WA 98953","description":"Join us for Pizza Days at Dineen Vineyards On selected weekends, Chef Jacob will be on site making hand-thrown pizzas crafted with the freshest local ingredients! A perfect opportunity to …"},{"source":"Sip Magazine","dance_style":"","url":"","event_type":"other","event_name":"Celebrate Walla Walla Block Party","day_of_week":"Saturday","start_date":"2025-06-21","end_date":"2025-06-21","start_time":"14:00","end_time":"17:00","price":"","location":"The Motor Co., 64 E. Rose Street, Walla Walla, WA 99362","description":"Experience the Valley’s energy downtown! This vibrant event includes tastings from 50+ wineries, local cuisine, live music, and a bottle shop so you can take your favorites home. VIP early …"},{"source":"Sip Magazine","dance_style":"","url":"","event_type":"other","event_name":"Wines in the Vines Vineyard Tour at Dineen Vineyards","day_of_week":"Saturday","start_date":"2025-06-21","end_date":"2025-06-21","start_time":"14:00","end_time":"16:00","price":"$60","location":"Dineen Vineyards, 2980 Gilbert Road, Zillah, WA 98953","description":"Join Dineen Vineyards for a “Wines in the Vines” Experience! Every year we select different wines and choose a new path through the vineyard to share with our guests. Saturday, …"}]
2025-06-18 15:28:05 [root] INFO: def extract_and_parse_json(): for url https://sipmagazine.com/grazers-part-and-parcel-victoria/, 
Cleaned JSON ready for parsing:
[{"source":"Sip Magazine","dance_style":"","url":"","event_type":"live music","event_name":"Summer Terrace Series","day_of_week":"Monday","start_date":"2025-06-16","end_date":"2025-06-16","start_time":"16:00","end_time":"19:00","price":"Free","location":"Fielding Hills Winery, 565 S Lakeshore DR, Chelan, WA 98816","description":"Every Saturday in July and August from 4 - 7pm, spend a relaxing evening listening to talented local musicians on our terrace. Evenings will include a menu of glass pours, …"},{"source":"Sip Magazine","dance_style":"","url":"","event_type":"other","event_name":"Celebrate Walla Walla Summer Supper","day_of_week":"Friday","start_date":"2025-06-20","end_date":"2025-06-20","start_time":"17:30","end_time":"20:00","price":"$100","location":"Echolands, 3281 Mill Creek Rd, Walla Walla, WA 99362","description":"Enjoy a BBQ-inspired summer menu, paired with approachable wines, and community vibes at this relaxed vineyard dinner. Station-style dining and a wide range of wines highlight the Valley’s versatility. Includes …"},{"source":"Sip Magazine","dance_style":"","url":"","event_type":"other","event_name":"Pizza Pop Up at Dineen Vineyards","day_of_week":"Saturday","start_date":"2025-06-21","end_date":"2025-06-21","start_time":"12:00","end_time":"17:00","price":"","location":"Dineen Vineyards, 2980 Gilbert Road, Zillah, WA 98953","description":"Join us for Pizza Days at Dineen Vineyards On selected weekends, Chef Jacob will be on site making hand-thrown pizzas crafted with the freshest local ingredients! A perfect opportunity to …"},{"source":"Sip Magazine","dance_style":"","url":"","event_type":"other","event_name":"Celebrate Walla Walla Block Party","day_of_week":"Saturday","start_date":"2025-06-21","end_date":"2025-06-21","start_time":"14:00","end_time":"17:00","price":"","location":"The Motor Co., 64 E. Rose Street, Walla Walla, WA 99362","description":"Experience the Valley’s energy downtown! This vibrant event includes tastings from 50+ wineries, local cuisine, live music, and a bottle shop so you can take your favorites home. VIP early …"},{"source":"Sip Magazine","dance_style":"","url":"","event_type":"other","event_name":"Wines in the Vines Vineyard Tour at Dineen Vineyards","day_of_week":"Saturday","start_date":"2025-06-21","end_date":"2025-06-21","start_time":"14:00","end_time":"16:00","price":"$60","location":"Dineen Vineyards, 2980 Gilbert Road, Zillah, WA 98953","description":"Join Dineen Vineyards for a “Wines in the Vines” Experience! Every year we select different wines and choose a new path through the vineyard to share with our guests. Saturday, …"}]
2025-06-18 15:28:05 [root] INFO: def clean_up_address(): Starting with events_df shape: (5, 14)
2025-06-18 15:28:05 [root] INFO: def clean_up_address(): Processing location 'Fielding Hills Winery, 565 S Lakeshore DR, Chelan, WA 98816' (event_id: None)
2025-06-18 15:28:05 [root] INFO: def clean_up_address(): Processing location 'Echolands, 3281 Mill Creek Rd, Walla Walla, WA 99362' (event_id: None)
2025-06-18 15:28:05 [root] INFO: def clean_up_address(): Processing location 'Dineen Vineyards, 2980 Gilbert Road, Zillah, WA 98953' (event_id: None)
2025-06-18 15:28:05 [root] INFO: def clean_up_address(): Processing location 'The Motor Co., 64 E. Rose Street, Walla Walla, WA 99362' (event_id: None)
2025-06-18 15:28:05 [root] INFO: def clean_up_address(): Processing location 'Dineen Vineyards, 2980 Gilbert Road, Zillah, WA 98953' (event_id: None)
2025-06-18 15:28:05 [root] INFO: write_events_to_db: Number of events to write: 5
2025-06-18 15:28:05 [root] INFO: write_url_to_db(): appended URL 'https://sipmagazine.com/grazers-part-and-parcel-victoria/'
2025-06-18 15:28:05 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 15:28:05 [root] INFO: def process_llm_response: URL https://sipmagazine.com/grazers-part-and-parcel-victoria/ marked as relevant with events written to the database.
2025-06-18 15:28:05 [root] INFO: write_url_to_db(): appended URL 'https://sipmagazine.com/grazers-part-and-parcel-victoria/'
2025-06-18 15:28:05 [root] INFO: def parse(): URL https://sipmagazine.com/grazers-part-and-parcel-victoria/ marked as relevant (LLM positive).
2025-06-18 15:28:05 [root] INFO: def parse(): Found 10 links on https://sipmagazine.com/grazers-part-and-parcel-victoria/
2025-06-18 15:28:05 [root] INFO: should_process_url: URL https://sipmagazine.com/travel/ has never been seen before, processing it.
2025-06-18 15:28:05 [root] INFO: should_process_url: URL https://sipmagazine.com/travel/ has never been seen before, processing it.
2025-06-18 15:28:05 [root] INFO: write_url_to_db(): appended URL 'https://sipmagazine.com/travel/'
2025-06-18 15:28:05 [root] INFO: def parse(): Crawling next URL: https://sipmagazine.com/travel/
2025-06-18 15:28:05 [root] INFO: def parse(): Found keywords for URL https://www.last.fm/festival/3914293+Rumba/lineup: ['dance', 'rumba']
2025-06-18 15:28:05 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.last.fm/festival/3914293+Rumba/lineup
2025-06-18 15:28:05 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:28:05 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:28:05 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:29:43 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:29:43 [root] INFO: query_llm(): Mistral response received: ```json
[
    {
        "source": "https://www.last.fm/festival/3914293+Rumba/lineup",
        "dance_style": "social dance",
        "url": "",
        "event_type": "live music",
        "event_name": "Human Nature",
        "day_of_week": "Saturday",
        "start_date": "2001-11-17",
        "end_date": "2001-11-17",
        "start_time": "00:00",
        "end_time": "null",
        "price": "57,109 listeners",
        "location": "Colonial Stadium, Melbourne, Australia",
        "description": "Human Nature was an Australian female pop group which formed in 1999 on the original Australian reality television series of Popstars. Aired in early 2000, …"
    },
    {
        "source": "https://www.last.fm/festival/3914293+Rumba/lineup",
        "dance_style": "social dance",
        "url": "",
        "event_type": "live music",
        "event_name": "Invertigo",
        "day_of_week": "Saturday",
        "start_date": "2001-11-17",
        "end_date": "2001-11-17",
        "start_time": "00:00",
        "end_time": "null",
        "price": "2,020 listeners",
        "location": "Colonial Stadium, Melbourne, Australia",
        "description": "There are two artist named Invertigo: 1. Invertigo were an australian four-piece pop/rock group 2. InVertigo is a progressive rock band from …"
    },
    {
        "source": "https://www.last.fm/festival/3914293+Rumba/lineup",
        "dance_style": "social dance",
        "url": "",
        "event_type": "live music",
        "event_name": "Joanne",
        "day_of_week": "Saturday",
        "start_date": "2001-11-17",
        "end_date": "2001-11-17",
        "start_time": "00:00",
        "end_time": "null",
        "price": "9,400 listeners",
        "location": "Colonial Stadium, Melbourne, Australia",
        "description": "There is more than one artist with this name. 1) Joanne is a Caribbean singer. Joanne burst into the music spotlight with her gospel debut single …"
    },
    {
        "source": "https://www.last.fm/festival/3914293+Rumba/lineup",
        "dance_style": "social dance",
        "url": "",
        "event_type": "live music",
        "event_name": "Killing Heidi",
        "day_of_week": "Saturday",
        "start_date": "2001-11-17",
        "end_date": "2001-11-17",
        "start_time": "00:00",
        "end_time": "null",
        "price": "57,109 listeners",
        "location": "Colonial Stadium, Melbourne, Australia",
        "description": "Killing Heidi is an Australian rock band from Violet Town, Victoria. The band, which went on hiatus in 2006, is most widely known for its multi-platinum …"
    },
    {
        "source": "https://www.last.fm/festival/3914293+Rumba/lineup",
        "dance_style": "social dance",
        "url": "",
        "event_type": "live music",
        "event_name": "Lash",
        "day_of_week": "Saturday",
        "start_date": "2001-11-17",
        "end_date": "2001-11-17",
        "start_time": "00:00",
        "end_time": "null",
        "price": "90,723 listeners",
        "location": "Colonial Stadium, Melbourne, Australia",
        "description": "There is more than one artist with this name. 1) Lash is a Belgian Dance-Hit Group with producer Kristof Vermeir and female singer Elisa Dhondt.…"
    },
    {
        "source": "https://www.last.fm/festival/3914293+Rumba/lineup",
        "dance_style": "social dance",
        "url": "",
        "event_type": "live music",
        "event_name": "Leah Haywood",
        "day_of_week": "Saturday",
        "start_date": "2001-11-17",
        "end_date": "2001-11-17",
        "start_time": "00:00",
        "end_time": "null",
        "price": "1,955 listeners",
        "location": "Colonial Stadium, Melbourne, Australia",
        "description": "Leah Haywood is an female Aussie pop singer. Her 2001 single \"We Think It's Love\" was a Top 10 hit in Australia. Leah's tune \"Summer of Love\" was …"
    },
    {
        "source": "https://www.last.fm/festival/3914293+Rumba/lineup",
        "dance_style": "social dance",
        "url": "",
        "event_type": "live music",
        "event_name": "Madison Avenue",
        "day_of_week": "Saturday",
        "start_date": "2001-11-17",
        "end_date": "2001-11-17",
        "start_time": "00:00",
        "end_time": "null",
        "price": "206,540 listeners",
        "location": "Colonial Stadium, Melbourne, Australia",
        "description": "Madison Avenue was an Australian dance music and pop duo best known for the song Don't Call Me Baby, which went to the top of the Australian …"
    },
    {
        "source": "https://www.last.fm/festival/3914293+Rumba/lineup",
        "dance_style": "social dance",
        "url": "",
        "event_type": "live music",
        "event_name": "Mandy Moore",
        "day_of_week": "Saturday",
        "start_date": "2001-11-17",
        "end_date": "2001-11-17",
        "start_time": "00:00",
        "end_time": "null",
        "price": "1,104,484 listeners",
        "location": "Colonial Stadium, Melbourne, Australia",
        "description": "Mandy Moore (born Amanda Leigh Moore on April 10, 1984) is an American singer and actress. Moore grew up in Florida, United States and came to …"
    },
    {
        "source": "https://www.last.fm/festival/3914293+Rumba/lineup",
        "dance_style": "social dance",
        "url": "",
        "event_type": "live music",
        "event_name": "Nelly Furtado",
        "day_of_week": "Saturday",
        "start_date": "2001-11-17",
        "end_date": "2001-11-17",
        "start_time": "00:00",
        "end_time": "null",
        "price": "4,140,143 listeners",
        "location": "Colonial Stadium, Melbourne, Australia",
        "description": "Nelly Kim Furtado (born December 2, 1978 in Victoria, British Columbia) is a Canadian singer and songwriter. Furtado has sold over 40 million records …"
    },
    {
        "source": "https://www.last.fm/festival/3914293+Rumba/lineup",
        "dance_style": "social dance",
        "url": "",
        "event_type": "live music",
        "event_name": "Paul Mac",
        "day_of_week": "Saturday",
        "start_date": "2001-11-17",
        "end_date": "2001-11-17",
        "start_time": "00:00",
        "end_time": "null",
        "price": "16,180 listeners",
        "location": "Colonial Stadium, Melbourne, Australia",
        "description": "Paul Mac is the name of two artists: 1. An Australian electronica producer musician, born Paul McDermott. 2. A UK techno DJ aka Paul Souter. 1.…"
    }
]
```
2025-06-18 15:29:43 [root] INFO: def extract_and_parse_json(): for url https://www.last.fm/festival/3914293+Rumba/lineup, 
Cleaned JSON ready for parsing:
[
    {
        "source": "https://www.last.fm/festival/3914293+Rumba/lineup",
        "dance_style": "social dance",
        "url": "",
        "event_type": "live music",
        "event_name": "Human Nature",
        "day_of_week": "Saturday",
        "start_date": "2001-11-17",
        "end_date": "2001-11-17",
        "start_time": "00:00",
        "end_time": "null",
        "price": "57,109 listeners",
        "location": "Colonial Stadium, Melbourne, Australia",
        "description": "Human Nature was an Australian female pop group which formed in 1999 on the original Australian reality television series of Popstars. Aired in early 2000, …"
    },
    {
        "source": "https://www.last.fm/festival/3914293+Rumba/lineup",
        "dance_style": "social dance",
        "url": "",
        "event_type": "live music",
        "event_name": "Invertigo",
        "day_of_week": "Saturday",
        "start_date": "2001-11-17",
        "end_date": "2001-11-17",
        "start_time": "00:00",
        "end_time": "null",
        "price": "2,020 listeners",
        "location": "Colonial Stadium, Melbourne, Australia",
        "description": "There are two artist named Invertigo: 1. Invertigo were an australian four-piece pop/rock group 2. InVertigo is a progressive rock band from …"
    },
    {
        "source": "https://www.last.fm/festival/3914293+Rumba/lineup",
        "dance_style": "social dance",
        "url": "",
        "event_type": "live music",
        "event_name": "Joanne",
        "day_of_week": "Saturday",
        "start_date": "2001-11-17",
        "end_date": "2001-11-17",
        "start_time": "00:00",
        "end_time": "null",
        "price": "9,400 listeners",
        "location": "Colonial Stadium, Melbourne, Australia",
        "description": "There is more than one artist with this name. 1) Joanne is a Caribbean singer. Joanne burst into the music spotlight with her gospel debut single …"
    },
    {
        "source": "https://www.last.fm/festival/3914293+Rumba/lineup",
        "dance_style": "social dance",
        "url": "",
        "event_type": "live music",
        "event_name": "Killing Heidi",
        "day_of_week": "Saturday",
        "start_date": "2001-11-17",
        "end_date": "2001-11-17",
        "start_time": "00:00",
        "end_time": "null",
        "price": "57,109 listeners",
        "location": "Colonial Stadium, Melbourne, Australia",
        "description": "Killing Heidi is an Australian rock band from Violet Town, Victoria. The band, which went on hiatus in 2006, is most widely known for its multi-platinum …"
    },
    {
        "source": "https://www.last.fm/festival/3914293+Rumba/lineup",
        "dance_style": "social dance",
        "url": "",
        "event_type": "live music",
        "event_name": "Lash",
        "day_of_week": "Saturday",
        "start_date": "2001-11-17",
        "end_date": "2001-11-17",
        "start_time": "00:00",
        "end_time": "null",
        "price": "90,723 listeners",
        "location": "Colonial Stadium, Melbourne, Australia",
        "description": "There is more than one artist with this name. 1) Lash is a Belgian Dance-Hit Group with producer Kristof Vermeir and female singer Elisa Dhondt.…"
    },
    {
        "source": "https://www.last.fm/festival/3914293+Rumba/lineup",
        "dance_style": "social dance",
        "url": "",
        "event_type": "live music",
        "event_name": "Leah Haywood",
        "day_of_week": "Saturday",
        "start_date": "2001-11-17",
        "end_date": "2001-11-17",
        "start_time": "00:00",
        "end_time": "null",
        "price": "1,955 listeners",
        "location": "Colonial Stadium, Melbourne, Australia",
        "description": "Leah Haywood is an female Aussie pop singer. Her 2001 single \"We Think It's Love\" was a Top 10 hit in Australia. Leah's tune \"Summer of Love\" was …"
    },
    {
        "source": "https://www.last.fm/festival/3914293+Rumba/lineup",
        "dance_style": "social dance",
        "url": "",
        "event_type": "live music",
        "event_name": "Madison Avenue",
        "day_of_week": "Saturday",
        "start_date": "2001-11-17",
        "end_date": "2001-11-17",
        "start_time": "00:00",
        "end_time": "null",
        "price": "206,540 listeners",
        "location": "Colonial Stadium, Melbourne, Australia",
        "description": "Madison Avenue was an Australian dance music and pop duo best known for the song Don't Call Me Baby, which went to the top of the Australian …"
    },
    {
        "source": "https://www.last.fm/festival/3914293+Rumba/lineup",
        "dance_style": "social dance",
        "url": "",
        "event_type": "live music",
        "event_name": "Mandy Moore",
        "day_of_week": "Saturday",
        "start_date": "2001-11-17",
        "end_date": "2001-11-17",
        "start_time": "00:00",
        "end_time": "null",
        "price": "1,104,484 listeners",
        "location": "Colonial Stadium, Melbourne, Australia",
        "description": "Mandy Moore (born Amanda Leigh Moore on April 10, 1984) is an American singer and actress. Moore grew up in Florida, United States and came to …"
    },
    {
        "source": "https://www.last.fm/festival/3914293+Rumba/lineup",
        "dance_style": "social dance",
        "url": "",
        "event_type": "live music",
        "event_name": "Nelly Furtado",
        "day_of_week": "Saturday",
        "start_date": "2001-11-17",
        "end_date": "2001-11-17",
        "start_time": "00:00",
        "end_time": "null",
        "price": "4,140,143 listeners",
        "location": "Colonial Stadium, Melbourne, Australia",
        "description": "Nelly Kim Furtado (born December 2, 1978 in Victoria, British Columbia) is a Canadian singer and songwriter. Furtado has sold over 40 million records …"
    },
    {
        "source": "https://www.last.fm/festival/3914293+Rumba/lineup",
        "dance_style": "social dance",
        "url": "",
        "event_type": "live music",
        "event_name": "Paul Mac",
        "day_of_week": "Saturday",
        "start_date": "2001-11-17",
        "end_date": "2001-11-17",
        "start_time": "00:00",
        "end_time": "null",
        "price": "16,180 listeners",
        "location": "Colonial Stadium, Melbourne, Australia",
        "description": "Paul Mac is the name of two artists: 1. An Australian electronica producer musician, born Paul McDermott. 2. A UK techno DJ aka Paul Souter. 1.…"
    }
]
2025-06-18 15:29:43 [root] INFO: def clean_up_address(): Starting with events_df shape: (10, 14)
2025-06-18 15:29:43 [root] INFO: def clean_up_address(): Processing location 'Colonial Stadium, Melbourne, Australia' (event_id: None)
2025-06-18 15:29:43 [root] INFO: def clean_up_address(): Processing location 'Colonial Stadium, Melbourne, Australia' (event_id: None)
2025-06-18 15:29:43 [root] INFO: def clean_up_address(): Processing location 'Colonial Stadium, Melbourne, Australia' (event_id: None)
2025-06-18 15:29:43 [root] INFO: def clean_up_address(): Processing location 'Colonial Stadium, Melbourne, Australia' (event_id: None)
2025-06-18 15:29:43 [root] INFO: def clean_up_address(): Processing location 'Colonial Stadium, Melbourne, Australia' (event_id: None)
2025-06-18 15:29:43 [root] INFO: def clean_up_address(): Processing location 'Colonial Stadium, Melbourne, Australia' (event_id: None)
2025-06-18 15:29:43 [root] INFO: def clean_up_address(): Processing location 'Colonial Stadium, Melbourne, Australia' (event_id: None)
2025-06-18 15:29:43 [root] INFO: def clean_up_address(): Processing location 'Colonial Stadium, Melbourne, Australia' (event_id: None)
2025-06-18 15:29:43 [root] INFO: def clean_up_address(): Processing location 'Colonial Stadium, Melbourne, Australia' (event_id: None)
2025-06-18 15:29:43 [root] INFO: def clean_up_address(): Processing location 'Colonial Stadium, Melbourne, Australia' (event_id: None)
2025-06-18 15:29:43 [root] INFO: write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 15:29:43 [root] INFO: write_url_to_db(): appended URL 'https://www.last.fm/festival/3914293+Rumba/lineup'
2025-06-18 15:29:43 [root] INFO: def process_llm_response: URL https://www.last.fm/festival/3914293+Rumba/lineup marked as relevant with events written to the database.
2025-06-18 15:29:43 [root] INFO: write_url_to_db(): appended URL 'https://www.last.fm/festival/3914293+Rumba/lineup'
2025-06-18 15:29:43 [root] INFO: def parse(): URL https://www.last.fm/festival/3914293+Rumba/lineup marked as relevant (LLM positive).
2025-06-18 15:29:43 [root] INFO: def parse(): Found 10 links on https://www.last.fm/festival/3914293+Rumba/lineup
2025-06-18 15:29:43 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/last_fm'
2025-06-18 15:29:43 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/last_fm
2025-06-18 15:29:43 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/lastfm'
2025-06-18 15:29:43 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/lastfm
2025-06-18 15:29:43 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/sharer/sharer.php?ref=facebooklink&u=https://www.last.fm/festival/3914293%2BRumba/lineup'
2025-06-18 15:29:43 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/sharer/sharer.php?ref=facebooklink&u=https://www.last.fm/festival/3914293%2BRumba/lineup
2025-06-18 15:29:43 [root] INFO: should_process_url: URL https://store.last.fm has never been seen before, processing it.
2025-06-18 15:29:43 [root] INFO: should_process_url: URL https://store.last.fm has never been seen before, processing it.
2025-06-18 15:29:43 [root] INFO: write_url_to_db(): appended URL 'https://store.last.fm'
2025-06-18 15:29:43 [root] INFO: def parse(): Crawling next URL: https://store.last.fm
2025-06-18 15:29:43 [root] INFO: write_url_to_db(): appended URL 'https://thedukesaloon.com/weekly/'
2025-06-18 15:29:43 [root] INFO: def parse(): URL https://thedukesaloon.com/weekly/ marked as irrelevant (no keywords).
2025-06-18 15:29:43 [root] INFO: def parse(): Found 10 links on https://thedukesaloon.com/weekly/
2025-06-18 15:29:43 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/thedukesaloon/'
2025-06-18 15:29:43 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/thedukesaloon/
2025-06-18 15:29:43 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/TheDukeVictoria/'
2025-06-18 15:29:43 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/TheDukeVictoria/
2025-06-18 15:29:43 [root] INFO: should_process_url: URL https://thedukesaloon.com/block-party/ was last seen as relevant, processing it.
2025-06-18 15:29:43 [root] INFO: should_process_url: URL https://thedukesaloon.com/us/ was last seen as not relevant but hit_ratio (0.33) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 15:29:43 [root] INFO: should_process_url: URL https://thedukesaloon.com/fundraising/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:29:43 [root] INFO: should_process_url: URL https://thedukesaloon.com/events/ was last seen as relevant, processing it.
2025-06-18 15:29:43 [root] INFO: should_process_url: URL https://thedukesaloon.com/ was last seen as relevant, processing it.
2025-06-18 15:29:43 [root] INFO: should_process_url: URL https://www.google.ca/maps/dir/''/The+Duke+Saloon/@48.4319416,-123.4380883,12z/data=!3m1!4b1!4m8!4m7!1m0!1m5!1m1!1s0x548f748257cd657d:0x7b34826b02413603!2m2!1d-123.369422!2d48.431962 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:29:43 [root] INFO: should_process_url: URL https://thedukesaloon.com/weekly/ was last seen as relevant, processing it.
2025-06-18 15:29:43 [root] INFO: should_process_url: URL https://thedukesaloon.com/gallery/ does not meet criteria for processing, skipping it.
2025-06-18 15:29:43 [root] INFO: def eventbrite_search(): Skipping URL https://thedukesaloon.com/gallery/ based on historical relevancy.
2025-06-18 15:29:43 [root] INFO: def parse(): Found keywords for URL https://northernwilds.com/category/features/: ['salsa']
2025-06-18 15:29:43 [root] INFO: def generate_prompt(): Generating prompt for URL: https://northernwilds.com/category/features/
2025-06-18 15:29:43 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:29:43 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:29:43 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:31:51 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:31:51 [root] INFO: query_llm(): Mistral response received: The webpage text contains several events. Let's extract them into a JSON array following the given instructions:

```json
[
    {
        "source": "Northern Wilds Magazine",
        "dance_style": "social dance, live music",
        "url": "",
        "event_type": "social dance",
        "event_name": "Lounge Around: Leisurely Exploring the North Shore of Lake Superior",
        "day_of_week": "Thursday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "North Shore of Lake Superior",
        "description": "The North Shore of Lake Superior is known for its scenic landscapes and outdoor adventure. While there are plenty of hiking trails, state parks, lakes..."
    },
    {
        "source": "Northern Wilds Magazine",
        "dance_style": "social dance, live music",
        "url": "",
        "event_type": "social dance",
        "event_name": "Duluth Monarch Buddies: Helping Monarchs One Waystation at a Time",
        "day_of_week": "Thursday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Duluth",
        "description": "For many of us, when we think of butterflies, monarchs come to mind. Their vibrant-orange wings divided by thin black lines resemble tiny stained-glass windows..."
    },
    {
        "source": "Northern Wilds Magazine",
        "dance_style": "social dance, live music",
        "url": "",
        "event_type": "social dance",
        "event_name": "Gardening in the Northwoods: A Guide to Growth",
        "day_of_week": "Friday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Northwoods",
        "description": "The last patches of snow are melting into the soil as the northland warms with the sun, finally waking up to the quiet hum of..."
    },
    {
        "source": "Northern Wilds Magazine",
        "dance_style": "social dance, live music",
        "url": "",
        "event_type": "social dance",
        "event_name": "A Beaver’s Tale: How Beavers Build a More Resilient Ecosystem",
        "day_of_week": "Saturday",
        "start_date": "2025-06-22",
        "end_date": "2025-06-22",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Ecosystem",
        "description": "On a quiet evening, the slap of a beaver’s tail hitting the water is familiar to many of us, though often the sound does what..."
    },
    {
        "source": "Northern Wilds Magazine",
        "dance_style": "social dance, live music",
        "url": "",
        "event_type": "social dance",
        "event_name": "Balancing Body and Mind: Healing Spas and Wellness Centers",
        "day_of_week": "Sunday",
        "start_date": "2025-06-23",
        "end_date": "2025-06-23",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Healing Spas and Wellness Centers",
        "description": "The world today is buzzing with chaotic energy, and the need for relaxation and self-care has never been more critical. As life becomes increasingly busy..."
    },
    {
        "source": "Northern Wilds Magazine",
        "dance_style": "social dance, live music",
        "url": "",
        "event_type": "social dance",
        "event_name": "EcoSuperior: Having a Positive Environmental Impact",
        "day_of_week": "Monday",
        "start_date": "2025-06-24",
        "end_date": "2025-06-24",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Environmental Impact",
        "description": "EcoSuperior is an environmental non-profit organization based in Thunder Bay. Their mission is to build a healthy future for people and the planet. Sound inspiring?..."
    },
    {
        "source": "Northern Wilds Magazine",
        "dance_style": "social dance, live music",
        "url": "",
        "event_type": "social dance",
        "event_name": "Cabin Life and the Soda Straw Principle",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-25",
        "end_date": "2025-06-25",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Cabin Life",
        "description": "As anyone who has been in a canoe in the Arrowhead knows, there is not much in the way of infrastructure. All you pretty much..."
    },
    {
        "source": "Northern Wilds Magazine",
        "dance_style": "social dance, live music",
        "url": "",
        "event_type": "social dance",
        "event_name": "Snow Day Memories: Part Two",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-26",
        "end_date": "2025-06-26",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Snow Day",
        "description": "Snow Day in Palestine By Peter Fergus-Moore In December of 2013, my wife Joyce and I boarded a chartered bus in Jerusalem for what we..."
    }
]
```
2025-06-18 15:31:51 [root] INFO: def extract_and_parse_json(): for url https://northernwilds.com/category/features/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Northern Wilds Magazine",
        "dance_style": "social dance, live music",
        "url": "",
        "event_type": "social dance",
        "event_name": "Lounge Around: Leisurely Exploring the North Shore of Lake Superior",
        "day_of_week": "Thursday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "North Shore of Lake Superior",
        "description": "The North Shore of Lake Superior is known for its scenic landscapes and outdoor adventure. While there are plenty of hiking trails, state parks, lakes"
    },
    {
        "source": "Northern Wilds Magazine",
        "dance_style": "social dance, live music",
        "url": "",
        "event_type": "social dance",
        "event_name": "Duluth Monarch Buddies: Helping Monarchs One Waystation at a Time",
        "day_of_week": "Thursday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Duluth",
        "description": "For many of us, when we think of butterflies, monarchs come to mind. Their vibrant-orange wings divided by thin black lines resemble tiny stained-glass windows"
    },
    {
        "source": "Northern Wilds Magazine",
        "dance_style": "social dance, live music",
        "url": "",
        "event_type": "social dance",
        "event_name": "Gardening in the Northwoods: A Guide to Growth",
        "day_of_week": "Friday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Northwoods",
        "description": "The last patches of snow are melting into the soil as the northland warms with the sun, finally waking up to the quiet hum of"
    },
    {
        "source": "Northern Wilds Magazine",
        "dance_style": "social dance, live music",
        "url": "",
        "event_type": "social dance",
        "event_name": "A Beaver’s Tale: How Beavers Build a More Resilient Ecosystem",
        "day_of_week": "Saturday",
        "start_date": "2025-06-22",
        "end_date": "2025-06-22",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Ecosystem",
        "description": "On a quiet evening, the slap of a beaver’s tail hitting the water is familiar to many of us, though often the sound does what"
    },
    {
        "source": "Northern Wilds Magazine",
        "dance_style": "social dance, live music",
        "url": "",
        "event_type": "social dance",
        "event_name": "Balancing Body and Mind: Healing Spas and Wellness Centers",
        "day_of_week": "Sunday",
        "start_date": "2025-06-23",
        "end_date": "2025-06-23",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Healing Spas and Wellness Centers",
        "description": "The world today is buzzing with chaotic energy, and the need for relaxation and self-care has never been more critical. As life becomes increasingly busy"
    },
    {
        "source": "Northern Wilds Magazine",
        "dance_style": "social dance, live music",
        "url": "",
        "event_type": "social dance",
        "event_name": "EcoSuperior: Having a Positive Environmental Impact",
        "day_of_week": "Monday",
        "start_date": "2025-06-24",
        "end_date": "2025-06-24",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Environmental Impact",
        "description": "EcoSuperior is an environmental non-profit organization based in Thunder Bay. Their mission is to build a healthy future for people and the planet. Sound inspiring?"
    },
    {
        "source": "Northern Wilds Magazine",
        "dance_style": "social dance, live music",
        "url": "",
        "event_type": "social dance",
        "event_name": "Cabin Life and the Soda Straw Principle",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-25",
        "end_date": "2025-06-25",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Cabin Life",
        "description": "As anyone who has been in a canoe in the Arrowhead knows, there is not much in the way of infrastructure. All you pretty much"
    },
    {
        "source": "Northern Wilds Magazine",
        "dance_style": "social dance, live music",
        "url": "",
        "event_type": "social dance",
        "event_name": "Snow Day Memories: Part Two",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-26",
        "end_date": "2025-06-26",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Snow Day",
        "description": "Snow Day in Palestine By Peter Fergus-Moore In December of 2013, my wife Joyce and I boarded a chartered bus in Jerusalem for what we"
    }
]
2025-06-18 15:31:51 [root] INFO: def clean_up_address(): Starting with events_df shape: (8, 14)
2025-06-18 15:31:51 [root] INFO: def clean_up_address(): Processing location 'North Shore of Lake Superior' (event_id: None)
2025-06-18 15:31:51 [root] INFO: def clean_up_address(): Processing location 'Duluth' (event_id: None)
2025-06-18 15:31:51 [root] INFO: def clean_up_address(): Processing location 'Northwoods' (event_id: None)
2025-06-18 15:31:51 [root] INFO: def clean_up_address(): Processing location 'Ecosystem' (event_id: None)
2025-06-18 15:31:51 [root] INFO: def clean_up_address(): Processing location 'Healing Spas and Wellness Centers' (event_id: None)
2025-06-18 15:31:51 [root] INFO: def clean_up_address(): Processing location 'Environmental Impact' (event_id: None)
2025-06-18 15:31:51 [root] INFO: def clean_up_address(): Processing location 'Cabin Life' (event_id: None)
2025-06-18 15:31:51 [root] INFO: def clean_up_address(): Processing location 'Snow Day' (event_id: None)
2025-06-18 15:31:52 [root] INFO: write_events_to_db: Number of events to write: 8
2025-06-18 15:31:52 [root] INFO: write_url_to_db(): appended URL 'https://northernwilds.com/category/features/'
2025-06-18 15:31:52 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 15:31:52 [root] INFO: def process_llm_response: URL https://northernwilds.com/category/features/ marked as relevant with events written to the database.
2025-06-18 15:31:52 [root] INFO: write_url_to_db(): appended URL 'https://northernwilds.com/category/features/'
2025-06-18 15:31:52 [root] INFO: def parse(): URL https://northernwilds.com/category/features/ marked as relevant (LLM positive).
2025-06-18 15:31:52 [root] INFO: def parse(): Found 10 links on https://northernwilds.com/category/features/
2025-06-18 15:31:52 [root] INFO: should_process_url: URL https://statcounter.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:31:52 [root] INFO: should_process_url: URL https://northernwilds.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:31:52 [root] INFO: should_process_url: URL https://northernwilds.com/category/features/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:31:52 [root] INFO: should_process_url: URL https://northernwilds.com/current-issue/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:31:52 [root] INFO: should_process_url: URL https://northernwilds.com/category/arts/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:31:52 [root] INFO: should_process_url: URL https://northernwilds.com/along-the-shore/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:31:52 [root] INFO: should_process_url: URL https://northernwilds.com/food-drink/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:31:52 [root] INFO: should_process_url: URL https://northernwilds.com/advertise-in-northern-minnesota/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:31:52 [root] INFO: should_process_url: URL https://northernwilds.com/about-us/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:31:52 [root] INFO: should_process_url: URL https://northernwilds.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:31:52 [root] INFO: def parse(): Found keywords for URL https://www.irishtimespub.ca/food: ['samba', 'wcs']
2025-06-18 15:31:52 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.irishtimespub.ca/food
2025-06-18 15:31:52 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:31:52 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:31:52 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:31:54 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 15:31:54 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 353371 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 15:31:54 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 15:31:55 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 15:31:55 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 264983 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 15:31:55 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 15:31:55 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://www.irishtimespub.ca/food
2025-06-18 15:31:55 [root] INFO: write_url_to_db(): appended URL 'https://www.irishtimespub.ca/food'
2025-06-18 15:31:55 [root] INFO: def parse(): URL https://www.irishtimespub.ca/food marked as irrelevant (LLM negative).
2025-06-18 15:31:55 [root] INFO: def parse(): Found 10 links on https://www.irishtimespub.ca/food
2025-06-18 15:31:55 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/pg/irishtimespubbc/about/?ref=page_internal'
2025-06-18 15:31:55 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/pg/irishtimespubbc/about/?ref=page_internal
2025-06-18 15:31:55 [root] INFO: write_url_to_db(): appended URL 'https://instagram.com/irishtimespub'
2025-06-18 15:31:55 [root] INFO: def parse(): Recorded unwanted URL: https://instagram.com/irishtimespub
2025-06-18 15:31:55 [root] INFO: should_process_url: URL https://www.tripadvisor.ca/Restaurant_Review-g154945-d785052-Reviews-Irish_Times_Pub-Victoria_Victoria_Capital_Regional_District_Vancouver_Island_Briti.html was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:31:55 [root] INFO: should_process_url: URL https://www.opentable.ca/r/irish-times-pub-reservations-victoria?restref=37471&lang=en-CA&ot_source=Restaurant%20website was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:31:55 [root] INFO: should_process_url: URL https://www.irishtimespub.ca/about-us was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:31:55 [root] INFO: parse: Skipping blacklisted URL https://www.google.com/maps/place/1200+Government+St,+Victoria,+BC+V8W+1Y3/@48.4258565,-123.3701391,17z/data=!3m1!4b1!4m5!3m4!1s0x548f749adb714eff:0x803f326e036f01c4!8m2!3d48.4258565!4d-123.3679504.
2025-06-18 15:31:55 [root] INFO: should_process_url: URL https://www.irishtimespub.ca/drinkmenu was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:31:55 [root] INFO: should_process_url: URL https://www.irishtimespub.ca/food was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:31:55 [root] INFO: should_process_url: URL https://www.irishtimespub.ca was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:31:55 [root] INFO: def parse(): Found keywords for URL https://www.salsagonzales.com/: ['salsa']
2025-06-18 15:31:55 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.salsagonzales.com/
2025-06-18 15:31:55 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:31:55 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:31:55 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:31:57 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 15:31:57 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 242885 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 15:31:57 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 15:32:09 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:32:09 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 15:32:09 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 15:32:09 [root] INFO: write_url_to_db(): appended URL 'https://www.salsagonzales.com/'
2025-06-18 15:32:09 [root] INFO: def parse(): URL https://www.salsagonzales.com/ marked as irrelevant (LLM negative).
2025-06-18 15:32:09 [root] INFO: def parse(): Found 2 links on https://www.salsagonzales.com/
2025-06-18 15:32:09 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5FBTLHLM, URL: https://www.salsagonzales.com/, source: Salsa Gonzales - salsa, hot sauce, and spicy pickles for sale online, keywords: salsa
2025-06-18 15:32:09 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 15:32:09 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5FBTLHLM
2025-06-18 15:32:09 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-5FBTLHLM'
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://www.salsagonzales.com/pages/about-us was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://www.salsagonzales.com/pages/about-us was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:32:09 [root] INFO: write_url_to_db(): appended URL 'https://www.salsagonzales.com/pages/about-us'
2025-06-18 15:32:09 [root] INFO: def parse(): Crawling next URL: https://www.salsagonzales.com/pages/about-us
2025-06-18 15:32:09 [root] INFO: should_process_url: URL http://eepurl.com/hRLq6H was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://mailchimp.com/integrations/?categories=Loyalty has never been seen before, processing it.
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://mailchimp.com/integrations/?categories=Loyalty has never been seen before, processing it.
2025-06-18 15:32:09 [root] INFO: write_url_to_db(): appended URL 'https://mailchimp.com/integrations/?categories=Loyalty'
2025-06-18 15:32:09 [root] INFO: def parse(): Crawling next URL: https://mailchimp.com/integrations/?categories=Loyalty
2025-06-18 15:32:09 [scrapy.extensions.logstats] INFO: Crawled 209 pages (at 2 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://sipmagazine.com/spirits/ has never been seen before, processing it.
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://sipmagazine.com/spirits/ has never been seen before, processing it.
2025-06-18 15:32:09 [root] INFO: write_url_to_db(): appended URL 'https://sipmagazine.com/spirits/'
2025-06-18 15:32:09 [root] INFO: def parse(): Crawling next URL: https://sipmagazine.com/spirits/
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://x.com/lastfm has never been seen before, processing it.
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://x.com/lastfm has never been seen before, processing it.
2025-06-18 15:32:09 [root] INFO: write_url_to_db(): appended URL 'https://x.com/lastfm'
2025-06-18 15:32:09 [root] INFO: def parse(): Crawling next URL: https://x.com/lastfm
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://www.shopify.com?utm_campaign=poweredby&utm_medium=shopify&utm_source=onlinestore was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://www.shopify.com?utm_campaign=poweredby&utm_medium=shopify&utm_source=onlinestore was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:32:09 [root] INFO: write_url_to_db(): appended URL 'https://www.shopify.com?utm_campaign=poweredby&utm_medium=shopify&utm_source=onlinestore'
2025-06-18 15:32:09 [root] INFO: def parse(): Crawling next URL: https://www.shopify.com?utm_campaign=poweredby&utm_medium=shopify&utm_source=onlinestore
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://mailchimp.com/integrations/?categories=Booking+%26+Scheduling has never been seen before, processing it.
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://mailchimp.com/integrations/?categories=Booking+%26+Scheduling has never been seen before, processing it.
2025-06-18 15:32:09 [root] INFO: write_url_to_db(): appended URL 'https://mailchimp.com/integrations/?categories=Booking+%26+Scheduling'
2025-06-18 15:32:09 [root] INFO: def parse(): Crawling next URL: https://mailchimp.com/integrations/?categories=Booking+%26+Scheduling
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://sipmagazine.com/shopping/ has never been seen before, processing it.
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://sipmagazine.com/shopping/ has never been seen before, processing it.
2025-06-18 15:32:09 [root] INFO: write_url_to_db(): appended URL 'https://sipmagazine.com/shopping/'
2025-06-18 15:32:09 [root] INFO: def parse(): Crawling next URL: https://sipmagazine.com/shopping/
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://bsky.app/profile/last.fm has never been seen before, processing it.
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://bsky.app/profile/last.fm has never been seen before, processing it.
2025-06-18 15:32:09 [root] INFO: write_url_to_db(): appended URL 'https://bsky.app/profile/last.fm'
2025-06-18 15:32:09 [root] INFO: def parse(): Crawling next URL: https://bsky.app/profile/last.fm
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://www.last.fm/festival/3914293+Rumba/lineup has never been seen before, processing it.
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://www.last.fm/festival/3914293+Rumba/lineup has never been seen before, processing it.
2025-06-18 15:32:09 [root] INFO: write_url_to_db(): appended URL 'https://www.last.fm/festival/3914293+Rumba/lineup'
2025-06-18 15:32:09 [root] INFO: def parse(): Crawling next URL: https://www.last.fm/festival/3914293+Rumba/lineup
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://www.salsagonzales.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://www.salsagonzales.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:32:09 [root] INFO: write_url_to_db(): appended URL 'https://www.salsagonzales.com/'
2025-06-18 15:32:09 [root] INFO: def parse(): Crawling next URL: https://www.salsagonzales.com/
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://turbotax.intuit.com/ has never been seen before, processing it.
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://turbotax.intuit.com/ has never been seen before, processing it.
2025-06-18 15:32:09 [root] INFO: write_url_to_db(): appended URL 'https://turbotax.intuit.com/'
2025-06-18 15:32:09 [root] INFO: def parse(): Crawling next URL: https://turbotax.intuit.com/
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://sipmagazine.com/events/ has never been seen before, processing it.
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://sipmagazine.com/events/ has never been seen before, processing it.
2025-06-18 15:32:09 [root] INFO: write_url_to_db(): appended URL 'https://sipmagazine.com/events/'
2025-06-18 15:32:09 [root] INFO: def parse(): Crawling next URL: https://sipmagazine.com/events/
2025-06-18 15:32:09 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/intent/tweet?url=https://www.last.fm/festival/3914293%2BRumba/lineup&via=lastfm&lang=en&text=Check+out+Rumba+%E2%80%93+Colonial+Stadium.
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://support.last.fm/ has never been seen before, processing it.
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://support.last.fm/ has never been seen before, processing it.
2025-06-18 15:32:09 [root] INFO: write_url_to_db(): appended URL 'https://support.last.fm/'
2025-06-18 15:32:09 [root] INFO: def parse(): Crawling next URL: https://support.last.fm/
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://quickbooks.intuit.com/ has never been seen before, processing it.
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://quickbooks.intuit.com/ has never been seen before, processing it.
2025-06-18 15:32:09 [root] INFO: write_url_to_db(): appended URL 'https://quickbooks.intuit.com/'
2025-06-18 15:32:09 [root] INFO: def parse(): Crawling next URL: https://quickbooks.intuit.com/
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://sipmagazine.com/cider/ has never been seen before, processing it.
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://sipmagazine.com/cider/ has never been seen before, processing it.
2025-06-18 15:32:09 [root] INFO: write_url_to_db(): appended URL 'https://sipmagazine.com/cider/'
2025-06-18 15:32:09 [root] INFO: def parse(): Crawling next URL: https://sipmagazine.com/cider/
2025-06-18 15:32:09 [root] INFO: write_url_to_db(): appended URL 'https://funtasticsports.ca/slo-pitch-tournament/'
2025-06-18 15:32:09 [root] INFO: def parse(): URL https://funtasticsports.ca/slo-pitch-tournament/ marked as irrelevant (no keywords).
2025-06-18 15:32:09 [root] INFO: def parse(): Found 10 links on https://funtasticsports.ca/slo-pitch-tournament/
2025-06-18 15:32:09 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/enderbyfuntastic/'
2025-06-18 15:32:09 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/enderbyfuntastic/
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://funtasticsports.ca/slo-pitch-tournament/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://funtasticsports.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://funtasticsports.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:32:09 [root] INFO: write_url_to_db(): appended URL 'https://funtasticsports.ca/'
2025-06-18 15:32:09 [root] INFO: def parse(): Crawling next URL: https://funtasticsports.ca/
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://funtasticsports.ca/about/community-impact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://funtasticsports.ca/about/community-impact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:32:09 [root] INFO: write_url_to_db(): appended URL 'https://funtasticsports.ca/about/community-impact/'
2025-06-18 15:32:09 [root] INFO: def parse(): Crawling next URL: https://funtasticsports.ca/about/community-impact/
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://funtasticsports.ca/about/community-grant/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://funtasticsports.ca/about/community-grant/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:32:09 [root] INFO: write_url_to_db(): appended URL 'https://funtasticsports.ca/about/community-grant/'
2025-06-18 15:32:09 [root] INFO: def parse(): Crawling next URL: https://funtasticsports.ca/about/community-grant/
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://funtasticsports.ca/event-info/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://funtasticsports.ca/event-info/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:32:09 [root] INFO: write_url_to_db(): appended URL 'https://funtasticsports.ca/event-info/'
2025-06-18 15:32:09 [root] INFO: def parse(): Crawling next URL: https://funtasticsports.ca/event-info/
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://funtasticsports.ca/about/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://funtasticsports.ca/about/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:32:09 [root] INFO: write_url_to_db(): appended URL 'https://funtasticsports.ca/about/'
2025-06-18 15:32:09 [root] INFO: def parse(): Crawling next URL: https://funtasticsports.ca/about/
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://funtasticsports.ca/skills-competition/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://funtasticsports.ca/skills-competition/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:32:09 [root] INFO: write_url_to_db(): appended URL 'https://funtasticsports.ca/skills-competition/'
2025-06-18 15:32:09 [root] INFO: def parse(): Crawling next URL: https://funtasticsports.ca/skills-competition/
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://funtasticsports.ca/about/site-maps/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:32:09 [root] INFO: should_process_url: URL https://funtasticsports.ca/about/site-maps/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:32:09 [root] INFO: write_url_to_db(): appended URL 'https://funtasticsports.ca/about/site-maps/'
2025-06-18 15:32:09 [root] INFO: def parse(): Crawling next URL: https://funtasticsports.ca/about/site-maps/
2025-06-18 15:32:09 [root] INFO: def parse(): Found keywords for URL https://northernwilds.com/about-us/contact/: ['salsa']
2025-06-18 15:32:09 [root] INFO: def generate_prompt(): Generating prompt for URL: https://northernwilds.com/about-us/contact/
2025-06-18 15:32:09 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:32:09 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:32:09 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:33:55 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:33:55 [root] INFO: query_llm(): Mistral response received: The provided extracted_text contains multiple events. Here are the extracted and transformed JSON objects:

```json
[
    {
        "source": "https://northernwilds.com/about-us/contact/",
        "dance_style": "social dance",
        "url": "",
        "event_type": "social dance",
        "event_name": "Saturday Night Dance",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "19:00",
        "end_time": "22:00",
        "price": "$10",
        "location": "Northern Wilds Magazine, 1708 W. Highway 61, Grand Marais, MN 55604",
        "description": "Every Saturday Night Dance. 7–10 pm, $10 per person. Location: 1708 W. Highway 61, Grand Marais."
    },
    {
        "source": "https://northernwilds.com/about-us/contact/",
        "dance_style": "kizomba",
        "url": "",
        "event_type": "live music",
        "event_name": "Dog Days",
        "day_of_week": "Friday",
        "start_date": "2025-06-28",
        "end_date": "2025-06-28",
        "start_time": "19:00",
        "end_time": "21:00",
        "price": "",
        "location": "Northern Wilds Magazine, 1708 W. Highway 61, Grand Marais, MN 55604",
        "description": "Dog Days: Live music from Dog Days on Fridays from 7-9 pm at Northern Wilds Magazine, 1708 W. Highway 61, Grand Marais."
    },
    {
        "source": "https://northernwilds.com/about-us/contact/",
        "dance_style": "bachata, balboa, douceur, east coast swing, lindy hop, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
        "url": "",
        "event_type": "live music",
        "event_name": "Live Music",
        "day_of_week": "Thursday",
        "start_date": "2025-06-14",
        "end_date": "2025-06-14",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Northern Wilds Magazine, 1708 W. Highway 61, Grand Marais, MN 55604",
        "description": "Thursdays in June: Live music from various artists. Location: Northern Wilds Magazine, 1708 W. Highway 61, Grand Marais."
    },
    {
        "source": "https://northernwilds.com/about-us/contact/",
        "dance_style": "bachata, balboa, douceur, east coast swing, lindy hop, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
        "url": "",
        "event_type": "live music",
        "event_name": "Live Music",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Northern Wilds Magazine, 1708 W. Highway 61, Grand Marais, MN 55604",
        "description": "Wednesdays in June: Live music from various artists. Location: Northern Wilds Magazine, 1708 W. Highway 61, Grand Marais."
    },
    {
        "source": "https://northernwilds.com/about-us/contact/",
        "dance_style": "bachata, balboa, douceur, east coast swing, lindy hop, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
        "url": "",
        "event_type": "live music",
        "event_name": "Live Music",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Northern Wilds Magazine, 1708 W. Highway 61, Grand Marais, MN 55604",
        "description": "Tuesdays in June: Live music from various artists. Location: Northern Wilds Magazine, 1708 W. Highway 61, Grand Marais."
    },
    {
        "source": "https://northernwilds.com/about-us/contact/",
        "dance_style": "bachata, balboa, douceur, east coast swing, lindy hop, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
        "url": "",
        "event_type": "live music",
        "event_name": "Live Music",
        "day_of_week": "Monday",
        "start_date": "2025-06-19",
        "end_date": "2025-06-19",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Northern Wilds Magazine, 1708 W. Highway 61, Grand Marais, MN 55604",
        "description": "Mondays in June: Live music from various artists. Location: Northern Wilds Magazine, 1708 W. Highway 61, Grand Marais."
    }
]
```
2025-06-18 15:33:55 [root] INFO: def extract_and_parse_json(): for url https://northernwilds.com/about-us/contact/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "https://northernwilds.com/about-us/contact/",
        "dance_style": "social dance",
        "url": "",
        "event_type": "social dance",
        "event_name": "Saturday Night Dance",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "19:00",
        "end_time": "22:00",
        "price": "$10",
        "location": "Northern Wilds Magazine, 1708 W. Highway 61, Grand Marais, MN 55604",
        "description": "Every Saturday Night Dance. 7–10 pm, $10 per person. Location: 1708 W. Highway 61, Grand Marais."
    },
    {
        "source": "https://northernwilds.com/about-us/contact/",
        "dance_style": "kizomba",
        "url": "",
        "event_type": "live music",
        "event_name": "Dog Days",
        "day_of_week": "Friday",
        "start_date": "2025-06-28",
        "end_date": "2025-06-28",
        "start_time": "19:00",
        "end_time": "21:00",
        "price": "",
        "location": "Northern Wilds Magazine, 1708 W. Highway 61, Grand Marais, MN 55604",
        "description": "Dog Days: Live music from Dog Days on Fridays from 7-9 pm at Northern Wilds Magazine, 1708 W. Highway 61, Grand Marais."
    },
    {
        "source": "https://northernwilds.com/about-us/contact/",
        "dance_style": "bachata, balboa, douceur, east coast swing, lindy hop, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
        "url": "",
        "event_type": "live music",
        "event_name": "Live Music",
        "day_of_week": "Thursday",
        "start_date": "2025-06-14",
        "end_date": "2025-06-14",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Northern Wilds Magazine, 1708 W. Highway 61, Grand Marais, MN 55604",
        "description": "Thursdays in June: Live music from various artists. Location: Northern Wilds Magazine, 1708 W. Highway 61, Grand Marais."
    },
    {
        "source": "https://northernwilds.com/about-us/contact/",
        "dance_style": "bachata, balboa, douceur, east coast swing, lindy hop, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
        "url": "",
        "event_type": "live music",
        "event_name": "Live Music",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Northern Wilds Magazine, 1708 W. Highway 61, Grand Marais, MN 55604",
        "description": "Wednesdays in June: Live music from various artists. Location: Northern Wilds Magazine, 1708 W. Highway 61, Grand Marais."
    },
    {
        "source": "https://northernwilds.com/about-us/contact/",
        "dance_style": "bachata, balboa, douceur, east coast swing, lindy hop, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
        "url": "",
        "event_type": "live music",
        "event_name": "Live Music",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Northern Wilds Magazine, 1708 W. Highway 61, Grand Marais, MN 55604",
        "description": "Tuesdays in June: Live music from various artists. Location: Northern Wilds Magazine, 1708 W. Highway 61, Grand Marais."
    },
    {
        "source": "https://northernwilds.com/about-us/contact/",
        "dance_style": "bachata, balboa, douceur, east coast swing, lindy hop, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
        "url": "",
        "event_type": "live music",
        "event_name": "Live Music",
        "day_of_week": "Monday",
        "start_date": "2025-06-19",
        "end_date": "2025-06-19",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "",
        "location": "Northern Wilds Magazine, 1708 W. Highway 61, Grand Marais, MN 55604",
        "description": "Mondays in June: Live music from various artists. Location: Northern Wilds Magazine, 1708 W. Highway 61, Grand Marais."
    }
]
2025-06-18 15:33:55 [root] INFO: def clean_up_address(): Starting with events_df shape: (6, 14)
2025-06-18 15:33:56 [root] INFO: def clean_up_address(): Processing location 'Northern Wilds Magazine, 1708 W. Highway 61, Grand Marais, MN 55604' (event_id: None)
2025-06-18 15:33:56 [root] INFO: def clean_up_address(): Processing location 'Northern Wilds Magazine, 1708 W. Highway 61, Grand Marais, MN 55604' (event_id: None)
2025-06-18 15:33:56 [root] INFO: def clean_up_address(): Processing location 'Northern Wilds Magazine, 1708 W. Highway 61, Grand Marais, MN 55604' (event_id: None)
2025-06-18 15:33:56 [root] INFO: def clean_up_address(): Processing location 'Northern Wilds Magazine, 1708 W. Highway 61, Grand Marais, MN 55604' (event_id: None)
2025-06-18 15:33:56 [root] INFO: def clean_up_address(): Processing location 'Northern Wilds Magazine, 1708 W. Highway 61, Grand Marais, MN 55604' (event_id: None)
2025-06-18 15:33:56 [root] INFO: def clean_up_address(): Processing location 'Northern Wilds Magazine, 1708 W. Highway 61, Grand Marais, MN 55604' (event_id: None)
2025-06-18 15:33:56 [root] INFO: write_events_to_db: Number of events to write: 6
2025-06-18 15:33:56 [root] INFO: write_url_to_db(): appended URL 'https://northernwilds.com/about-us/contact/'
2025-06-18 15:33:56 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 15:33:56 [root] INFO: def process_llm_response: URL https://northernwilds.com/about-us/contact/ marked as relevant with events written to the database.
2025-06-18 15:33:56 [root] INFO: write_url_to_db(): appended URL 'https://northernwilds.com/about-us/contact/'
2025-06-18 15:33:56 [root] INFO: def parse(): URL https://northernwilds.com/about-us/contact/ marked as relevant (LLM positive).
2025-06-18 15:33:56 [root] INFO: def parse(): Found 10 links on https://northernwilds.com/about-us/contact/
2025-06-18 15:33:56 [root] INFO: should_process_url: URL https://statcounter.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:33:56 [root] INFO: should_process_url: URL https://northernwilds.com/food-drink/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:33:56 [root] INFO: should_process_url: URL https://northernwilds.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:33:56 [root] INFO: should_process_url: URL https://northernwilds.com/category/features/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:33:56 [root] INFO: should_process_url: URL https://northernwilds.com/current-issue/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:33:56 [root] INFO: should_process_url: URL https://northernwilds.com/category/arts/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:33:56 [root] INFO: should_process_url: URL https://northernwilds.com/along-the-shore/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:33:56 [root] INFO: should_process_url: URL https://northernwilds.com/about-us/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:33:56 [root] INFO: should_process_url: URL https://northernwilds.com/advertise-in-northern-minnesota/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:33:56 [root] INFO: should_process_url: URL https://northernwilds.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:33:56 [root] INFO: should_process_url: URL https://sipmagazine.com/ has never been seen before, processing it.
2025-06-18 15:33:56 [root] INFO: should_process_url: URL https://sipmagazine.com/ has never been seen before, processing it.
2025-06-18 15:33:56 [root] INFO: write_url_to_db(): appended URL 'https://sipmagazine.com/'
2025-06-18 15:33:56 [root] INFO: def parse(): Crawling next URL: https://sipmagazine.com/
2025-06-18 15:33:56 [scrapy.extensions.logstats] INFO: Crawled 209 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 15:33:56 [root] INFO: should_process_url: URL https://sipmagazine.com/news/ has never been seen before, processing it.
2025-06-18 15:33:56 [root] INFO: should_process_url: URL https://sipmagazine.com/news/ has never been seen before, processing it.
2025-06-18 15:33:56 [root] INFO: write_url_to_db(): appended URL 'https://sipmagazine.com/news/'
2025-06-18 15:33:56 [root] INFO: def parse(): Crawling next URL: https://sipmagazine.com/news/
2025-06-18 15:33:56 [root] INFO: should_process_url: URL https://sipmagazine.com/grazers-part-and-parcel-victoria/ has never been seen before, processing it.
2025-06-18 15:33:56 [root] INFO: should_process_url: URL https://sipmagazine.com/grazers-part-and-parcel-victoria/ has never been seen before, processing it.
2025-06-18 15:33:56 [root] INFO: write_url_to_db(): appended URL 'https://sipmagazine.com/grazers-part-and-parcel-victoria/'
2025-06-18 15:33:56 [root] INFO: def parse(): Crawling next URL: https://sipmagazine.com/grazers-part-and-parcel-victoria/
2025-06-18 15:33:56 [root] INFO: def parse(): Found keywords for URL https://www.festivalseekers.com/region/vancouver-sea-sky: ['live music', 'music festivals']
2025-06-18 15:33:56 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.festivalseekers.com/region/vancouver-sea-sky
2025-06-18 15:33:56 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:33:56 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:33:56 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:35:39 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:35:39 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "Festivalseekers",
        "dance_style": "",
        "url": "",
        "event_type": "festival",
        "event_name": "Whistler Cornucopia",
        "day_of_week": "Thursday",
        "start_date": "2025-11-06",
        "end_date": "2025-11-16",
        "start_time": "16:00",
        "end_time": "00:00",
        "price": "",
        "location": "Whistler, British Columbia, Canada",
        "description": "Whistler brings out a Cornucopia of the finest in British Columbia cuisine and wine. Local and regional restaurants, breweries, distilleries, wineries, chefs and producers are featured in the premier..."
    },
    {
        "source": "Festivalseekers",
        "dance_style": "",
        "url": "",
        "event_type": "festival",
        "event_name": "Sunshine Coast Art Crawl",
        "day_of_week": "Friday",
        "start_date": "2025-10-17",
        "end_date": "2025-10-19",
        "start_time": "16:00",
        "end_time": "23:00",
        "price": "",
        "location": "Sunshine Coast, British Columbia, Canada",
        "description": "The name says “crawl” but you better put on some comfy walking shoes for the Sunshine Coast Art Crawl. This event presented by the Coast Cultural Alliance, links the artists, studios and art stores..."
    },
    {
        "source": "Festivalseekers",
        "dance_style": "",
        "url": "",
        "event_type": "festival",
        "event_name": "Whistler Village Beer Festival",
        "day_of_week": "Saturday",
        "start_date": "2025-09-13",
        "end_date": "2025-09-13",
        "start_time": "06:00",
        "end_time": "18:00",
        "price": "",
        "location": "Whistler Village, Whistler, British Columbia, Canada",
        "description": "Whistler Village is pouring pints from nearly 30 different breweries in one single day, so don't miss this chance to sample hundreds of brews, just please drink responsibly."
    },
    {
        "source": "Festivalseekers",
        "dance_style": "",
        "url": "",
        "event_type": "festival",
        "event_name": "Sunshine Music Festival",
        "day_of_week": "Saturday",
        "start_date": "2025-08-30",
        "end_date": "2025-08-31",
        "start_time": "16:00",
        "end_time": "00:00",
        "price": "",
        "location": "Powell River, British Columbia, Canada",
        "description": "Head to Powell River for two days of terrific music, coastal views, food and special events."
    },
    {
        "source": "Festivalseekers",
        "dance_style": "",
        "url": "",
        "event_type": "festival",
        "event_name": "Sunshine Coast Festival of the Written Arts",
        "day_of_week": "Thursday",
        "start_date": "2025-08-14",
        "end_date": "2025-08-17",
        "start_time": "15:00",
        "end_time": "23:00",
        "price": "",
        "location": "Sunshine Coast, British Columbia, Canada",
        "description": "Just a quick ferry ride from Horseshoe Bay, the Sunshine Coast offers stunning views of the Strait of Georgia and a friendly, relaxed atmosphere. As one of the staples in the community, the festival’s..."
    },
    {
        "source": "Festivalseekers",
        "dance_style": "",
        "url": "",
        "event_type": "festival",
        "event_name": "Burnaby Blues and Roots Festival",
        "day_of_week": "Saturday",
        "start_date": "2025-08-09",
        "end_date": "2025-08-09",
        "start_time": "18:00",
        "end_time": "00:00",
        "price": "",
        "location": "Deer Lake Park, Burnaby, British Columbia, Canada",
        "description": "The Burnaby Blues and Roots Festival has attracted festival-goers of all ages for its soulful lineup of music by some exceptional artists. The one-day festival happens in the beautiful Deer Lake Park..."
    },
    {
        "source": "Festivalseekers",
        "dance_style": "",
        "url": "",
        "event_type": "festival",
        "event_name": "Texada Roots & Blues Festival",
        "day_of_week": "Saturday",
        "start_date": "2025-08-02",
        "end_date": "2025-08-03",
        "start_time": "15:00",
        "end_time": "03:00",
        "price": "",
        "location": "Texada Island, British Columbia, Canada",
        "description": "Texada Island is rich in history, from First Nations to Spanish exploration and ore mining. But in the last few years, the island has also become rich in roots and blues music. Impressively, the..."
    },
    {
        "source": "Festivalseekers",
        "dance_style": "",
        "url": "",
        "event_type": "festival",
        "event_name": "Vancouver Craft Beer & Music Festival",
        "day_of_week": "Saturday",
        "start_date": "2025-07-12",
        "end_date": "2025-07-12",
        "start_time": "15:00",
        "end_time": "05:00",
        "price": "",
        "location": "Vancouver, British Columbia, Canada",
        "description": "Enjoy over 150 carefully crafted beers and ciders. Immerse yourself in a vibrant atmosphere with food trucks plus live music and art. Connect with beer enthusiasts, brewmasters, and artists."
    },
    {
        "source": "Festivalseekers",
        "dance_style": "",
        "url": "",
        "event_type": "festival",
        "event_name": "Kathaumixw",
        "day_of_week": "Tuesday",
        "start_date": "2025-07-01",
        "end_date": "2025-07-05",
        "start_time": "15:00",
        "end_time": "03:00",
        "price": "",
        "location": "Powell River, British Columbia, Canada",
        "description": "The International Choral Kathaumixw is a 5 day choral festival filled with concerts, common song singing, choral & vocal solo competitions."
    },
    {
        "source": "Festivalseekers",
        "dance_style": "",
        "url": "",
        "event_type": "festival",
        "event_name": "Vancouver Symphony Orchestra in Whistler",
        "day_of_week": "Monday",
        "start_date": "2025-06-30",
        "end_date": "2025-06-30",
        "start_time": "21:00",
        "end_time": "05:00",
        "price": "",
        "location": "Whistler Olympic Plaza, Whistler, British Columbia, Canada",
        "description": "The VSO comes back to Whistler Olympic Plaza to perform in the open mountain air for free. Sit on the grass surrounded by trees and mountains and listen to the classical compositions of Beethoven..."
    },
    {
        "source": "Festivalseekers",
        "dance_style": "",
        "url": "",
        "event_type": "festival",
        "event_name": "Canada Day Long Weekend at Whistler",
        "day_of_week": "Saturday",
        "start_date": "2025-06-28",
        "end_date": "2025-07-01",
        "start_time": "15:00",
        "end_time": "03:00",
        "price": "",
        "location": "Whistler, British Columbia, Canada",
        "description": "There is no official way to celebrate Canada Day. Many stay in their backyards with friends and have barbecues, and many celebrate with crowds and music, face-painting, fireworks and flags.&nbsp;Whistler..."
    },
    {
        "source": "Festivalseekers",
        "dance_style": "",
        "url": "",
        "event_type": "festival",
        "event_name": "Squamish Beer Festival",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "19:00",
        "end_time": "00:00",
        "price": "",
        "location": "Squamish, British Columbia, Canada",
        "description": "One day.&nbsp;55+ Breweries. 120-plus craft beers and add in local music and food in a beautiful setting. What more could you want?"
    }
]
2025-06-18 15:35:39 [root] INFO: def extract_and_parse_json(): for url https://www.festivalseekers.com/region/vancouver-sea-sky, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Festivalseekers",
        "dance_style": "",
        "url": "",
        "event_type": "festival",
        "event_name": "Whistler Cornucopia",
        "day_of_week": "Thursday",
        "start_date": "2025-11-06",
        "end_date": "2025-11-16",
        "start_time": "16:00",
        "end_time": "00:00",
        "price": "",
        "location": "Whistler, British Columbia, Canada",
        "description": "Whistler brings out a Cornucopia of the finest in British Columbia cuisine and wine. Local and regional restaurants, breweries, distilleries, wineries, chefs and producers are featured in the premier"
    },
    {
        "source": "Festivalseekers",
        "dance_style": "",
        "url": "",
        "event_type": "festival",
        "event_name": "Sunshine Coast Art Crawl",
        "day_of_week": "Friday",
        "start_date": "2025-10-17",
        "end_date": "2025-10-19",
        "start_time": "16:00",
        "end_time": "23:00",
        "price": "",
        "location": "Sunshine Coast, British Columbia, Canada",
        "description": "The name says “crawl” but you better put on some comfy walking shoes for the Sunshine Coast Art Crawl. This event presented by the Coast Cultural Alliance, links the artists, studios and art stores"
    },
    {
        "source": "Festivalseekers",
        "dance_style": "",
        "url": "",
        "event_type": "festival",
        "event_name": "Whistler Village Beer Festival",
        "day_of_week": "Saturday",
        "start_date": "2025-09-13",
        "end_date": "2025-09-13",
        "start_time": "06:00",
        "end_time": "18:00",
        "price": "",
        "location": "Whistler Village, Whistler, British Columbia, Canada",
        "description": "Whistler Village is pouring pints from nearly 30 different breweries in one single day, so don't miss this chance to sample hundreds of brews, just please drink responsibly."
    },
    {
        "source": "Festivalseekers",
        "dance_style": "",
        "url": "",
        "event_type": "festival",
        "event_name": "Sunshine Music Festival",
        "day_of_week": "Saturday",
        "start_date": "2025-08-30",
        "end_date": "2025-08-31",
        "start_time": "16:00",
        "end_time": "00:00",
        "price": "",
        "location": "Powell River, British Columbia, Canada",
        "description": "Head to Powell River for two days of terrific music, coastal views, food and special events."
    },
    {
        "source": "Festivalseekers",
        "dance_style": "",
        "url": "",
        "event_type": "festival",
        "event_name": "Sunshine Coast Festival of the Written Arts",
        "day_of_week": "Thursday",
        "start_date": "2025-08-14",
        "end_date": "2025-08-17",
        "start_time": "15:00",
        "end_time": "23:00",
        "price": "",
        "location": "Sunshine Coast, British Columbia, Canada",
        "description": "Just a quick ferry ride from Horseshoe Bay, the Sunshine Coast offers stunning views of the Strait of Georgia and a friendly, relaxed atmosphere. As one of the staples in the community, the festival’s"
    },
    {
        "source": "Festivalseekers",
        "dance_style": "",
        "url": "",
        "event_type": "festival",
        "event_name": "Burnaby Blues and Roots Festival",
        "day_of_week": "Saturday",
        "start_date": "2025-08-09",
        "end_date": "2025-08-09",
        "start_time": "18:00",
        "end_time": "00:00",
        "price": "",
        "location": "Deer Lake Park, Burnaby, British Columbia, Canada",
        "description": "The Burnaby Blues and Roots Festival has attracted festival-goers of all ages for its soulful lineup of music by some exceptional artists. The one-day festival happens in the beautiful Deer Lake Park"
    },
    {
        "source": "Festivalseekers",
        "dance_style": "",
        "url": "",
        "event_type": "festival",
        "event_name": "Texada Roots & Blues Festival",
        "day_of_week": "Saturday",
        "start_date": "2025-08-02",
        "end_date": "2025-08-03",
        "start_time": "15:00",
        "end_time": "03:00",
        "price": "",
        "location": "Texada Island, British Columbia, Canada",
        "description": "Texada Island is rich in history, from First Nations to Spanish exploration and ore mining. But in the last few years, the island has also become rich in roots and blues music. Impressively, the"
    },
    {
        "source": "Festivalseekers",
        "dance_style": "",
        "url": "",
        "event_type": "festival",
        "event_name": "Vancouver Craft Beer & Music Festival",
        "day_of_week": "Saturday",
        "start_date": "2025-07-12",
        "end_date": "2025-07-12",
        "start_time": "15:00",
        "end_time": "05:00",
        "price": "",
        "location": "Vancouver, British Columbia, Canada",
        "description": "Enjoy over 150 carefully crafted beers and ciders. Immerse yourself in a vibrant atmosphere with food trucks plus live music and art. Connect with beer enthusiasts, brewmasters, and artists."
    },
    {
        "source": "Festivalseekers",
        "dance_style": "",
        "url": "",
        "event_type": "festival",
        "event_name": "Kathaumixw",
        "day_of_week": "Tuesday",
        "start_date": "2025-07-01",
        "end_date": "2025-07-05",
        "start_time": "15:00",
        "end_time": "03:00",
        "price": "",
        "location": "Powell River, British Columbia, Canada",
        "description": "The International Choral Kathaumixw is a 5 day choral festival filled with concerts, common song singing, choral & vocal solo competitions."
    },
    {
        "source": "Festivalseekers",
        "dance_style": "",
        "url": "",
        "event_type": "festival",
        "event_name": "Vancouver Symphony Orchestra in Whistler",
        "day_of_week": "Monday",
        "start_date": "2025-06-30",
        "end_date": "2025-06-30",
        "start_time": "21:00",
        "end_time": "05:00",
        "price": "",
        "location": "Whistler Olympic Plaza, Whistler, British Columbia, Canada",
        "description": "The VSO comes back to Whistler Olympic Plaza to perform in the open mountain air for free. Sit on the grass surrounded by trees and mountains and listen to the classical compositions of Beethoven"
    },
    {
        "source": "Festivalseekers",
        "dance_style": "",
        "url": "",
        "event_type": "festival",
        "event_name": "Canada Day Long Weekend at Whistler",
        "day_of_week": "Saturday",
        "start_date": "2025-06-28",
        "end_date": "2025-07-01",
        "start_time": "15:00",
        "end_time": "03:00",
        "price": "",
        "location": "Whistler, British Columbia, Canada",
        "description": "There is no official way to celebrate Canada Day. Many stay in their backyards with friends and have barbecues, and many celebrate with crowds and music, face-painting, fireworks and flags.&nbsp;Whistler"
    },
    {
        "source": "Festivalseekers",
        "dance_style": "",
        "url": "",
        "event_type": "festival",
        "event_name": "Squamish Beer Festival",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "19:00",
        "end_time": "00:00",
        "price": "",
        "location": "Squamish, British Columbia, Canada",
        "description": "One day.&nbsp;55+ Breweries. 120-plus craft beers and add in local music and food in a beautiful setting. What more could you want?"
    }
]
2025-06-18 15:35:39 [root] INFO: def clean_up_address(): Starting with events_df shape: (12, 14)
2025-06-18 15:35:39 [root] INFO: def clean_up_address(): Processing location 'Whistler, British Columbia, Canada' (event_id: None)
2025-06-18 15:35:39 [root] INFO: def clean_up_address(): Processing location 'Sunshine Coast, British Columbia, Canada' (event_id: None)
2025-06-18 15:35:39 [root] INFO: def clean_up_address(): Processing location 'Whistler Village, Whistler, British Columbia, Canada' (event_id: None)
2025-06-18 15:35:39 [root] INFO: def clean_up_address(): Processing location 'Powell River, British Columbia, Canada' (event_id: None)
2025-06-18 15:35:39 [root] INFO: def clean_up_address(): Processing location 'Sunshine Coast, British Columbia, Canada' (event_id: None)
2025-06-18 15:35:39 [root] INFO: def clean_up_address(): Processing location 'Deer Lake Park, Burnaby, British Columbia, Canada' (event_id: None)
2025-06-18 15:35:39 [root] INFO: def clean_up_address(): Processing location 'Texada Island, British Columbia, Canada' (event_id: None)
2025-06-18 15:35:39 [root] INFO: def clean_up_address(): Processing location 'Vancouver, British Columbia, Canada' (event_id: None)
2025-06-18 15:35:39 [root] INFO: def clean_up_address(): Processing location 'Powell River, British Columbia, Canada' (event_id: None)
2025-06-18 15:35:39 [root] INFO: def clean_up_address(): Processing location 'Whistler Olympic Plaza, Whistler, British Columbia, Canada' (event_id: None)
2025-06-18 15:35:39 [root] INFO: def clean_up_address(): Processing location 'Whistler, British Columbia, Canada' (event_id: None)
2025-06-18 15:35:39 [root] INFO: def clean_up_address(): Processing location 'Squamish, British Columbia, Canada' (event_id: None)
2025-06-18 15:35:39 [root] INFO: write_events_to_db: Number of events to write: 12
2025-06-18 15:35:39 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/region/vancouver-sea-sky'
2025-06-18 15:35:39 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 15:35:39 [root] INFO: def process_llm_response: URL https://www.festivalseekers.com/region/vancouver-sea-sky marked as relevant with events written to the database.
2025-06-18 15:35:39 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/region/vancouver-sea-sky'
2025-06-18 15:35:39 [root] INFO: def parse(): URL https://www.festivalseekers.com/region/vancouver-sea-sky marked as relevant (LLM positive).
2025-06-18 15:35:39 [root] INFO: def parse(): Found 5 links on https://www.festivalseekers.com/region/vancouver-sea-sky
2025-06-18 15:35:39 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N, URL: https://www.festivalseekers.com/region/vancouver-sea-sky, source: 20+ BC summer 2025 music festivals all about good vibes ..., keywords: music festivals
2025-06-18 15:35:39 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 15:35:39 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N
2025-06-18 15:35:39 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-MJ9L5N'
2025-06-18 15:35:39 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/festivalseekers/'
2025-06-18 15:35:39 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/festivalseekers/
2025-06-18 15:35:39 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/festivalseekers/'
2025-06-18 15:35:39 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/festivalseekers/
2025-06-18 15:35:39 [root] INFO: should_process_url: URL https://www.festivalseekers.com/region/vancouver-sea-sky was last seen as relevant, processing it.
2025-06-18 15:35:39 [root] INFO: should_process_url: URL https://www.zenseekers.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:35:39 [root] INFO: should_process_url: URL https://www.snowseekers.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:35:39 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/user/FestivalSeekers.
2025-06-18 15:35:39 [root] INFO: should_process_url: URL https://sipmagazine.com/wine/ has never been seen before, processing it.
2025-06-18 15:35:39 [root] INFO: should_process_url: URL https://sipmagazine.com/wine/ has never been seen before, processing it.
2025-06-18 15:35:39 [root] INFO: write_url_to_db(): appended URL 'https://sipmagazine.com/wine/'
2025-06-18 15:35:39 [root] INFO: def parse(): Crawling next URL: https://sipmagazine.com/wine/
2025-06-18 15:35:39 [scrapy.extensions.logstats] INFO: Crawled 209 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 15:35:39 [root] INFO: should_process_url: URL https://sipmagazine.com/beer/ has never been seen before, processing it.
2025-06-18 15:35:39 [root] INFO: should_process_url: URL https://sipmagazine.com/beer/ has never been seen before, processing it.
2025-06-18 15:35:39 [root] INFO: write_url_to_db(): appended URL 'https://sipmagazine.com/beer/'
2025-06-18 15:35:39 [root] INFO: def parse(): Crawling next URL: https://sipmagazine.com/beer/
2025-06-18 15:35:39 [root] INFO: should_process_url: URL https://sipmagazine.com/recipes/ has never been seen before, processing it.
2025-06-18 15:35:39 [root] INFO: should_process_url: URL https://sipmagazine.com/recipes/ has never been seen before, processing it.
2025-06-18 15:35:39 [root] INFO: write_url_to_db(): appended URL 'https://sipmagazine.com/recipes/'
2025-06-18 15:35:39 [root] INFO: def parse(): Crawling next URL: https://sipmagazine.com/recipes/
2025-06-18 15:35:39 [root] INFO: def parse(): Found keywords for URL https://cowichanbluegrass.com/: ['dance']
2025-06-18 15:35:39 [root] INFO: def generate_prompt(): Generating prompt for URL: https://cowichanbluegrass.com/
2025-06-18 15:35:39 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:35:39 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:35:39 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:36:16 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:36:16 [root] INFO: query_llm(): Mistral response received: **Source**: Cowichan Valley Bluegrass Festival | Father's Day Weekend at Laketown Ranch
**Dance Style**:
**URL**: ''
**Event Type**: live music
**Event Name**: Father's Day Weekend
**Day of Week**: Friday
**Start Date**: 2025-06-21
**End Date**: 2025-06-21
**Start Time**: 10:00
**End Time**: 22:00
**Price**: '$150 for a weekend pass'
**Location**: 'Laketown Ranch Music Park, 8811 Youbou Road Lake Cowichan, BC'
**Description**: 'Join us for the 2025 Father\'s Day Weekend at Laketown Ranch!'

**Source**: Cowichan Valley Bluegrass Festival | Father's Day Weekend at Laketown Ranch
**Dance Style**:
**URL**: ''
**Event Type**: live music
**Event Name**: Father's Day Weekend
**Day of Week**: Saturday
**Start Date**: 2025-06-22
**End Date**: 2025-06-22
**Start Time**: 10:00
**End Time**: 22:00
**Price**: '$150 for a weekend pass'
**Location**: 'Laketown Ranch Music Park, 8811 Youbou Road Lake Cowichan, BC'
**Description**: 'Join us for the 2025 Father\'s Day Weekend at Laketown Ranch!'

**Source**: Cowichan Valley Bluegrass Festival | Father's Day Weekend at Laketown Ranch
**Dance Style**:
**URL**: ''
**Event Type**: live music
**Event Name**: Father's Day Weekend
**Day of Week**: Sunday
**Start Date**: 2025-06-23
**End Date**: 2025-06-23
**Start Time**: 10:00
**End Time**: 22:00
**Price**: '$150 for a weekend pass'
**Location**: 'Laketown Ranch Music Park, 8811 Youbou Road Lake Cowichan, BC'
**Description**: 'Join us for the 2025 Father\'s Day Weekend at Laketown Ranch!'
2025-06-18 15:36:16 [root] ERROR: def extract_and_parse_json(): couldn't isolate JSON blob in result from https://cowichanbluegrass.com/
2025-06-18 15:36:16 [root] INFO: write_url_to_db(): appended URL 'https://cowichanbluegrass.com/'
2025-06-18 15:36:16 [root] INFO: def parse(): URL https://cowichanbluegrass.com/ marked as irrelevant (LLM negative).
2025-06-18 15:36:16 [root] INFO: def parse(): Found 10 links on https://cowichanbluegrass.com/
2025-06-18 15:36:16 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/school-workshops/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:36:16 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/school-workshops/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:36:16 [root] INFO: write_url_to_db(): appended URL 'https://cowichanbluegrass.com/school-workshops/'
2025-06-18 15:36:16 [root] INFO: def parse(): Crawling next URL: https://cowichanbluegrass.com/school-workshops/
2025-06-18 15:36:16 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/lineup/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:36:16 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/lineup/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:36:16 [root] INFO: write_url_to_db(): appended URL 'https://cowichanbluegrass.com/lineup/'
2025-06-18 15:36:16 [root] INFO: def parse(): Crawling next URL: https://cowichanbluegrass.com/lineup/
2025-06-18 15:36:16 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:36:16 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/schedule/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:36:16 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/schedule/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:36:16 [root] INFO: write_url_to_db(): appended URL 'https://cowichanbluegrass.com/schedule/'
2025-06-18 15:36:16 [root] INFO: def parse(): Crawling next URL: https://cowichanbluegrass.com/schedule/
2025-06-18 15:36:16 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/about/faqs/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:36:16 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/about/faqs/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:36:16 [root] INFO: write_url_to_db(): appended URL 'https://cowichanbluegrass.com/about/faqs/'
2025-06-18 15:36:16 [root] INFO: def parse(): Crawling next URL: https://cowichanbluegrass.com/about/faqs/
2025-06-18 15:36:16 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/john-hartford-fiddle-tunes-workshop/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:36:16 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/john-hartford-fiddle-tunes-workshop/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:36:16 [root] INFO: write_url_to_db(): appended URL 'https://cowichanbluegrass.com/john-hartford-fiddle-tunes-workshop/'
2025-06-18 15:36:16 [root] INFO: def parse(): Crawling next URL: https://cowichanbluegrass.com/john-hartford-fiddle-tunes-workshop/
2025-06-18 15:36:16 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:36:16 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/about/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:36:16 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/about/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:36:16 [root] INFO: write_url_to_db(): appended URL 'https://cowichanbluegrass.com/about/'
2025-06-18 15:36:16 [root] INFO: def parse(): Crawling next URL: https://cowichanbluegrass.com/about/
2025-06-18 15:36:16 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/stay/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:36:16 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/stay/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:36:16 [root] INFO: write_url_to_db(): appended URL 'https://cowichanbluegrass.com/stay/'
2025-06-18 15:36:16 [root] INFO: def parse(): Crawling next URL: https://cowichanbluegrass.com/stay/
2025-06-18 15:36:16 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/about/visit/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:36:16 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/about/visit/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:36:16 [root] INFO: write_url_to_db(): appended URL 'https://cowichanbluegrass.com/about/visit/'
2025-06-18 15:36:16 [root] INFO: def parse(): Crawling next URL: https://cowichanbluegrass.com/about/visit/
2025-06-18 15:36:16 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.sciencedirect.com/science/article/pii/S0376871619303667?via%3Dihub> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 15:36:16 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.sciencedirect.com/science/article/pii/S0376871619303667?via%3Dihub>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 15:36:16 [root] INFO: write_url_to_db(): appended URL 'https://support.last.fm/'
2025-06-18 15:36:16 [root] INFO: def parse(): URL https://support.last.fm/ marked as irrelevant (no keywords).
2025-06-18 15:36:16 [root] INFO: def parse(): Found 10 links on https://support.last.fm/
2025-06-18 15:36:16 [root] INFO: should_process_url: URL https://support.last.fm/u/system has never been seen before, processing it.
2025-06-18 15:36:16 [root] INFO: should_process_url: URL https://support.last.fm/u/system has never been seen before, processing it.
2025-06-18 15:36:16 [root] INFO: write_url_to_db(): appended URL 'https://support.last.fm/u/system'
2025-06-18 15:36:16 [root] INFO: def parse(): Crawling next URL: https://support.last.fm/u/system
2025-06-18 15:36:16 [root] INFO: should_process_url: URL https://support.last.fm/u/hjbardenhagen has never been seen before, processing it.
2025-06-18 15:36:16 [root] INFO: should_process_url: URL https://support.last.fm/u/hjbardenhagen has never been seen before, processing it.
2025-06-18 15:36:16 [root] INFO: write_url_to_db(): appended URL 'https://support.last.fm/u/hjbardenhagen'
2025-06-18 15:36:16 [root] INFO: def parse(): Crawling next URL: https://support.last.fm/u/hjbardenhagen
2025-06-18 15:36:16 [root] INFO: should_process_url: URL https://support.last.fm/t/welcome-to-the-last-fm-support-forums/7 has never been seen before, processing it.
2025-06-18 15:36:16 [root] INFO: should_process_url: URL https://support.last.fm/t/welcome-to-the-last-fm-support-forums/7 has never been seen before, processing it.
2025-06-18 15:36:16 [root] INFO: write_url_to_db(): appended URL 'https://support.last.fm/t/welcome-to-the-last-fm-support-forums/7'
2025-06-18 15:36:16 [root] INFO: def parse(): Crawling next URL: https://support.last.fm/t/welcome-to-the-last-fm-support-forums/7
2025-06-18 15:36:16 [root] INFO: parse: Skipping blacklisted URL https://support.last.fm/t/spotify-has-stopped-scrobbling-what-can-i-do/3184.
2025-06-18 15:36:16 [root] INFO: should_process_url: URL https://support.last.fm/t/unrelated-scrobbles-of-now-streaming-on-disney-appearing-randomly-on-my-overview-page/112811 has never been seen before, processing it.
2025-06-18 15:36:16 [root] INFO: should_process_url: URL https://support.last.fm/t/unrelated-scrobbles-of-now-streaming-on-disney-appearing-randomly-on-my-overview-page/112811 has never been seen before, processing it.
2025-06-18 15:36:16 [root] INFO: write_url_to_db(): appended URL 'https://support.last.fm/t/unrelated-scrobbles-of-now-streaming-on-disney-appearing-randomly-on-my-overview-page/112811'
2025-06-18 15:36:16 [root] INFO: def parse(): Crawling next URL: https://support.last.fm/t/unrelated-scrobbles-of-now-streaming-on-disney-appearing-randomly-on-my-overview-page/112811
2025-06-18 15:36:16 [root] INFO: parse: Skipping blacklisted URL https://support.last.fm/tag/spotify.
2025-06-18 15:36:16 [root] INFO: should_process_url: URL https://support.last.fm/u/LAST.HQ has never been seen before, processing it.
2025-06-18 15:36:16 [root] INFO: should_process_url: URL https://support.last.fm/u/LAST.HQ has never been seen before, processing it.
2025-06-18 15:36:16 [root] INFO: write_url_to_db(): appended URL 'https://support.last.fm/u/LAST.HQ'
2025-06-18 15:36:16 [root] INFO: def parse(): Crawling next URL: https://support.last.fm/u/LAST.HQ
2025-06-18 15:36:16 [root] INFO: should_process_url: URL https://support.last.fm/u/Kingu_Platypus has never been seen before, processing it.
2025-06-18 15:36:16 [root] INFO: should_process_url: URL https://support.last.fm/u/Kingu_Platypus has never been seen before, processing it.
2025-06-18 15:36:16 [root] INFO: write_url_to_db(): appended URL 'https://support.last.fm/u/Kingu_Platypus'
2025-06-18 15:36:16 [root] INFO: def parse(): Crawling next URL: https://support.last.fm/u/Kingu_Platypus
2025-06-18 15:36:16 [root] INFO: def parse(): Found keywords for URL https://sipmagazine.com/news/: ['dance', 'live music', 'rumba']
2025-06-18 15:36:16 [root] INFO: def generate_prompt(): Generating prompt for URL: https://sipmagazine.com/news/
2025-06-18 15:36:16 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:36:16 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:36:16 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:36:19 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 15:36:19 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 229136 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 15:36:19 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 15:37:29 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:37:29 [root] INFO: query_llm(): OpenAI response received: [{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Summer Terrace Series",
    "day_of_week": "Monday",
    "start_date": "2025-06-16",
    "end_date": "2025-06-16",
    "start_time": "16:00",
    "end_time": "19:00",
    "price": "Free",
    "location": "Fielding Hills Winery, 565 S Lakeshore DR, Chelan, WA 98816",
    "description": "Every Saturday in July and August from 4 - 7pm, spend a relaxing evening listening to talented local musicians on our terrace. "
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Celebrate Walla Walla Summer Supper",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-20",
    "start_time": "17:30",
    "end_time": "20:00",
    "price": "$100",
    "location": "Echolands, 3281 Mill Creek Rd, Walla Walla, WA 99362",
    "description": "Enjoy a BBQ-inspired summer menu, paired with approachable wines, and community vibes at this relaxed vineyard dinner."
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Pizza Pop Up at Dineen Vineyards",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "12:00",
    "end_time": "17:00",
    "price": "",
    "location": "Dineen Vineyards, 2980 Gilbert Road, Zillah, WA 98953",
    "description": "Join us for Pizza Days at Dineen Vineyards. Selected weekends will feature hand-thrown pizzas crafted with the freshest local ingredients."
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Celebrate Walla Walla Block Party",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "14:00",
    "end_time": "17:00",
    "price": "",
    "location": "The Motor Co., 64 E. Rose Street, Walla Walla, WA 99362",
    "description": "Experience the Valley’s energy downtown with tastings from 50+ wineries, local cuisine, live music, and a bottle shop."
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Wines in the Vines Vineyard Tour at Dineen Vineyards",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "14:00",
    "end_time": "16:00",
    "price": "$60",
    "location": "Dineen Vineyards, 2980 Gilbert Road, Zillah, WA 98953",
    "description": "Join Dineen Vineyards for a Wines in the Vines experience, exploring the vineyard while tasting selected wines."
}]
2025-06-18 15:37:29 [root] INFO: def extract_and_parse_json(): for url https://sipmagazine.com/news/, 
Cleaned JSON ready for parsing:
[{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Summer Terrace Series",
    "day_of_week": "Monday",
    "start_date": "2025-06-16",
    "end_date": "2025-06-16",
    "start_time": "16:00",
    "end_time": "19:00",
    "price": "Free",
    "location": "Fielding Hills Winery, 565 S Lakeshore DR, Chelan, WA 98816",
    "description": "Every Saturday in July and August from 4 - 7pm, spend a relaxing evening listening to talented local musicians on our terrace. "
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Celebrate Walla Walla Summer Supper",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-20",
    "start_time": "17:30",
    "end_time": "20:00",
    "price": "$100",
    "location": "Echolands, 3281 Mill Creek Rd, Walla Walla, WA 99362",
    "description": "Enjoy a BBQ-inspired summer menu, paired with approachable wines, and community vibes at this relaxed vineyard dinner."
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Pizza Pop Up at Dineen Vineyards",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "12:00",
    "end_time": "17:00",
    "price": "",
    "location": "Dineen Vineyards, 2980 Gilbert Road, Zillah, WA 98953",
    "description": "Join us for Pizza Days at Dineen Vineyards. Selected weekends will feature hand-thrown pizzas crafted with the freshest local ingredients."
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Celebrate Walla Walla Block Party",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "14:00",
    "end_time": "17:00",
    "price": "",
    "location": "The Motor Co., 64 E. Rose Street, Walla Walla, WA 99362",
    "description": "Experience the Valley’s energy downtown with tastings from 50+ wineries, local cuisine, live music, and a bottle shop."
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Wines in the Vines Vineyard Tour at Dineen Vineyards",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "14:00",
    "end_time": "16:00",
    "price": "$60",
    "location": "Dineen Vineyards, 2980 Gilbert Road, Zillah, WA 98953",
    "description": "Join Dineen Vineyards for a Wines in the Vines experience, exploring the vineyard while tasting selected wines."
}]
2025-06-18 15:37:29 [root] INFO: def clean_up_address(): Starting with events_df shape: (5, 14)
2025-06-18 15:37:29 [root] INFO: def clean_up_address(): Processing location 'Fielding Hills Winery, 565 S Lakeshore DR, Chelan, WA 98816' (event_id: None)
2025-06-18 15:37:29 [root] INFO: def clean_up_address(): Processing location 'Echolands, 3281 Mill Creek Rd, Walla Walla, WA 99362' (event_id: None)
2025-06-18 15:37:29 [root] INFO: def clean_up_address(): Processing location 'Dineen Vineyards, 2980 Gilbert Road, Zillah, WA 98953' (event_id: None)
2025-06-18 15:37:29 [root] INFO: def clean_up_address(): Processing location 'The Motor Co., 64 E. Rose Street, Walla Walla, WA 99362' (event_id: None)
2025-06-18 15:37:29 [root] INFO: def clean_up_address(): Processing location 'Dineen Vineyards, 2980 Gilbert Road, Zillah, WA 98953' (event_id: None)
2025-06-18 15:37:29 [root] INFO: write_events_to_db: Number of events to write: 5
2025-06-18 15:37:29 [root] INFO: write_url_to_db(): appended URL 'https://sipmagazine.com/news/'
2025-06-18 15:37:29 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 15:37:29 [root] INFO: def process_llm_response: URL https://sipmagazine.com/news/ marked as relevant with events written to the database.
2025-06-18 15:37:29 [root] INFO: write_url_to_db(): appended URL 'https://sipmagazine.com/news/'
2025-06-18 15:37:29 [root] INFO: def parse(): URL https://sipmagazine.com/news/ marked as relevant (LLM positive).
2025-06-18 15:37:29 [root] INFO: def parse(): Found 10 links on https://sipmagazine.com/news/
2025-06-18 15:37:29 [root] INFO: should_process_url: URL https://sipmagazine.com/travel/ has never been seen before, processing it.
2025-06-18 15:37:29 [root] INFO: should_process_url: URL https://sipmagazine.com/spirits/ has never been seen before, processing it.
2025-06-18 15:37:29 [root] INFO: should_process_url: URL https://sipmagazine.com/shopping/ has never been seen before, processing it.
2025-06-18 15:37:29 [root] INFO: should_process_url: URL https://sipmagazine.com/events/ has never been seen before, processing it.
2025-06-18 15:37:29 [root] INFO: should_process_url: URL https://sipmagazine.com/cider/ has never been seen before, processing it.
2025-06-18 15:37:29 [root] INFO: should_process_url: URL https://sipmagazine.com/news/ has never been seen before, processing it.
2025-06-18 15:37:29 [root] INFO: should_process_url: URL https://sipmagazine.com/ has never been seen before, processing it.
2025-06-18 15:37:29 [root] INFO: should_process_url: URL https://sipmagazine.com/wine/ has never been seen before, processing it.
2025-06-18 15:37:29 [root] INFO: should_process_url: URL https://sipmagazine.com/beer/ has never been seen before, processing it.
2025-06-18 15:37:29 [root] INFO: should_process_url: URL https://sipmagazine.com/recipes/ has never been seen before, processing it.
2025-06-18 15:37:29 [root] INFO: def parse(): Found keywords for URL https://www.google.ca/maps/dir/''/The+Duke+Saloon/@48.4319416,-123.4380883,12z/data=!3m1!4b1!4m8!4m7!1m0!1m5!1m1!1s0x548f748257cd657d:0x7b34826b02413603!2m2!1d-123.369422!2d48.431962: ['wcs']
2025-06-18 15:37:29 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.google.ca/maps/dir/''/The+Duke+Saloon/@48.4319416,-123.4380883,12z/data=!3m1!4b1!4m8!4m7!1m0!1m5!1m1!1s0x548f748257cd657d:0x7b34826b02413603!2m2!1d-123.369422!2d48.431962
2025-06-18 15:37:29 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:37:29 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:37:29 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:37:30 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 15:37:30 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 164375 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 15:37:30 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 15:37:41 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:37:41 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 15:37:41 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 15:37:41 [root] INFO: write_url_to_db(): appended URL 'https://www.google.ca/maps/dir/''/The+Duke+Saloon/@48.4319416,-123.4380883,12z/data=!3m1!4b1!4m8!4m7!1m0!1m5!1m1!1s0x548f748257cd657d:0x7b34826b02413603!2m2!1d-123.369422!2d48.431962'
2025-06-18 15:37:41 [root] INFO: def parse(): URL https://www.google.ca/maps/dir/''/The+Duke+Saloon/@48.4319416,-123.4380883,12z/data=!3m1!4b1!4m8!4m7!1m0!1m5!1m1!1s0x548f748257cd657d:0x7b34826b02413603!2m2!1d-123.369422!2d48.431962 marked as irrelevant (LLM negative).
2025-06-18 15:37:41 [root] INFO: def parse(): Found 1 links on https://www.google.ca/maps/dir/''/The+Duke+Saloon/@48.4319416,-123.4380883,12z/data=!3m1!4b1!4m8!4m7!1m0!1m5!1m1!1s0x548f748257cd657d:0x7b34826b02413603!2m2!1d-123.369422!2d48.431962
2025-06-18 15:37:41 [root] INFO: should_process_url: URL https://www.google.ca/maps/dir/''/The+Duke+Saloon/@48.4319416,-123.4380883,12z/data=!3m1!4b1!4m8!4m7!1m0!1m5!1m1!1s0x548f748257cd657d:0x7b34826b02413603!2m2!1d-123.369422!2d48.431962 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:37:41 [root] INFO: parse: Skipping blacklisted URL https://support.google.com/maps/?hl=en&authuser=0&p=no_javascript.
2025-06-18 15:37:41 [root] INFO: should_process_url: URL https://support.last.fm/u/Maddieman has never been seen before, processing it.
2025-06-18 15:37:41 [root] INFO: should_process_url: URL https://support.last.fm/u/Maddieman has never been seen before, processing it.
2025-06-18 15:37:41 [root] INFO: write_url_to_db(): appended URL 'https://support.last.fm/u/Maddieman'
2025-06-18 15:37:41 [root] INFO: def parse(): Crawling next URL: https://support.last.fm/u/Maddieman
2025-06-18 15:37:41 [scrapy.extensions.logstats] INFO: Crawled 226 pages (at 17 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 15:37:41 [root] INFO: should_process_url: URL https://support.last.fm/ has never been seen before, processing it.
2025-06-18 15:37:41 [root] INFO: should_process_url: URL https://support.last.fm/tag/scrobbling has never been seen before, processing it.
2025-06-18 15:37:41 [root] INFO: should_process_url: URL https://support.last.fm/tag/scrobbling has never been seen before, processing it.
2025-06-18 15:37:41 [root] INFO: write_url_to_db(): appended URL 'https://support.last.fm/tag/scrobbling'
2025-06-18 15:37:41 [root] INFO: def parse(): Crawling next URL: https://support.last.fm/tag/scrobbling
2025-06-18 15:37:41 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <403 https://prismafestival.com/festival/>: HTTP status code is not handled or not allowed
2025-06-18 15:37:41 [root] INFO: def parse(): Found keywords for URL https://jazzvictoria.ca/jazzfest-home/jazzfest-line-up/: ['live music']
2025-06-18 15:37:41 [root] INFO: def generate_prompt(): Generating prompt for URL: https://jazzvictoria.ca/jazzfest-home/jazzfest-line-up/
2025-06-18 15:37:41 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:37:41 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:37:41 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:37:43 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 15:37:43 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 208619 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 15:37:43 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 15:38:21 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:38:21 [root] INFO: query_llm(): OpenAI response received: [{
    "source": "Victoria Jazz Society",
    "dance_style": "other",
    "url": "",
    "event_type": "live music",
    "event_name": "TD Victoria International JazzFest",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-29",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Various venues across Victoria, BC",
    "description": "Friday, June 20 - Sunday, June 29, 2025"
}]
2025-06-18 15:38:21 [root] INFO: def extract_and_parse_json(): for url https://jazzvictoria.ca/jazzfest-home/jazzfest-line-up/, 
Cleaned JSON ready for parsing:
[{
    "source": "Victoria Jazz Society",
    "dance_style": "other",
    "url": "",
    "event_type": "live music",
    "event_name": "TD Victoria International JazzFest",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-29",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Various venues across Victoria, BC",
    "description": "Friday, June 20 - Sunday, June 29, 2025"
}]
2025-06-18 15:38:21 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 15:38:21 [root] INFO: def clean_up_address(): Processing location 'Various venues across Victoria, BC' (event_id: None)
2025-06-18 15:38:21 [root] INFO: write_events_to_db: Number of events to write: 1
2025-06-18 15:38:21 [root] INFO: write_url_to_db(): appended URL 'https://jazzvictoria.ca/jazzfest-home/jazzfest-line-up/'
2025-06-18 15:38:21 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 15:38:21 [root] INFO: def process_llm_response: URL https://jazzvictoria.ca/jazzfest-home/jazzfest-line-up/ marked as relevant with events written to the database.
2025-06-18 15:38:21 [root] INFO: write_url_to_db(): appended URL 'https://jazzvictoria.ca/jazzfest-home/jazzfest-line-up/'
2025-06-18 15:38:21 [root] INFO: def parse(): URL https://jazzvictoria.ca/jazzfest-home/jazzfest-line-up/ marked as relevant (LLM positive).
2025-06-18 15:38:21 [root] INFO: def parse(): Found 10 links on https://jazzvictoria.ca/jazzfest-home/jazzfest-line-up/
2025-06-18 15:38:21 [root] INFO: should_process_url: URL https://jazzvictoria.ca/outreach-workshops/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:38:21 [root] INFO: should_process_url: URL https://jazzvictoria.ca/outreach-workshops/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:38:21 [root] INFO: write_url_to_db(): appended URL 'https://jazzvictoria.ca/outreach-workshops/'
2025-06-18 15:38:21 [root] INFO: def parse(): Crawling next URL: https://jazzvictoria.ca/outreach-workshops/
2025-06-18 15:38:21 [root] INFO: should_process_url: URL https://jazzvictoria.ca/jazzfest-home/jazzfest-line-up/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:38:21 [root] INFO: should_process_url: URL https://jazzvictoria.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:38:22 [root] INFO: should_process_url: URL https://jazzvictoria.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:38:22 [root] INFO: write_url_to_db(): appended URL 'https://jazzvictoria.ca/'
2025-06-18 15:38:22 [root] INFO: def parse(): Crawling next URL: https://jazzvictoria.ca/
2025-06-18 15:38:22 [root] INFO: should_process_url: URL https://jazzvictoria.ca/calendar/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:38:22 [root] INFO: should_process_url: URL https://jazzvictoria.ca/calendar/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:38:22 [root] INFO: write_url_to_db(): appended URL 'https://jazzvictoria.ca/calendar/'
2025-06-18 15:38:22 [root] INFO: def parse(): Crawling next URL: https://jazzvictoria.ca/calendar/
2025-06-18 15:38:22 [root] INFO: should_process_url: URL https://jazzvictoria.ca/home/about/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:38:22 [root] INFO: should_process_url: URL https://jazzvictoria.ca/home/about/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:38:22 [root] INFO: write_url_to_db(): appended URL 'https://jazzvictoria.ca/home/about/'
2025-06-18 15:38:22 [root] INFO: def parse(): Crawling next URL: https://jazzvictoria.ca/home/about/
2025-06-18 15:38:22 [root] INFO: should_process_url: URL https://jazzvictoria.ca was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:38:22 [root] INFO: should_process_url: URL https://jazzvictoria.ca was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:38:22 [root] INFO: write_url_to_db(): appended URL 'https://jazzvictoria.ca'
2025-06-18 15:38:22 [root] INFO: def parse(): Crawling next URL: https://jazzvictoria.ca
2025-06-18 15:38:22 [root] INFO: should_process_url: URL https://jazzvictoria.ca/home/volunteer/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:38:22 [root] INFO: should_process_url: URL https://jazzvictoria.ca/home/volunteer/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:38:22 [root] INFO: write_url_to_db(): appended URL 'https://jazzvictoria.ca/home/volunteer/'
2025-06-18 15:38:22 [root] INFO: def parse(): Crawling next URL: https://jazzvictoria.ca/home/volunteer/
2025-06-18 15:38:22 [root] INFO: should_process_url: URL https://jazzvictoria.ca/home/tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:38:22 [root] INFO: should_process_url: URL https://jazzvictoria.ca/home/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:38:22 [root] INFO: should_process_url: URL https://jazzvictoria.ca/home/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:38:22 [root] INFO: write_url_to_db(): appended URL 'https://jazzvictoria.ca/home/contact/'
2025-06-18 15:38:22 [root] INFO: def parse(): Crawling next URL: https://jazzvictoria.ca/home/contact/
2025-06-18 15:38:22 [root] INFO: should_process_url: URL https://jazzvictoria.ca/jazzfest-home/ was last seen as relevant, processing it.
2025-06-18 15:38:22 [root] INFO: write_url_to_db(): appended URL 'https://www.creditkarma.com/'
2025-06-18 15:38:22 [root] INFO: def parse(): URL https://www.creditkarma.com/ marked as irrelevant (no keywords).
2025-06-18 15:38:22 [root] INFO: def parse(): Found 10 links on https://www.creditkarma.com/
2025-06-18 15:38:22 [root] INFO: should_process_url: URL https://www.creditkarma.com/ has never been seen before, processing it.
2025-06-18 15:38:22 [root] INFO: should_process_url: URL https://turbotax.intuit.com has never been seen before, processing it.
2025-06-18 15:38:22 [root] INFO: should_process_url: URL https://turbotax.intuit.com has never been seen before, processing it.
2025-06-18 15:38:22 [root] INFO: write_url_to_db(): appended URL 'https://turbotax.intuit.com'
2025-06-18 15:38:22 [root] INFO: def parse(): Crawling next URL: https://turbotax.intuit.com
2025-06-18 15:38:22 [root] INFO: should_process_url: URL https://www.intuit.com has never been seen before, processing it.
2025-06-18 15:38:22 [root] INFO: should_process_url: URL https://www.intuit.com has never been seen before, processing it.
2025-06-18 15:38:22 [root] INFO: write_url_to_db(): appended URL 'https://www.intuit.com'
2025-06-18 15:38:22 [root] INFO: def parse(): Crawling next URL: https://www.intuit.com
2025-06-18 15:38:22 [root] INFO: should_process_url: URL https://mailchimp.com/ has never been seen before, processing it.
2025-06-18 15:38:22 [root] INFO: should_process_url: URL https://www.creditkarma.com has never been seen before, processing it.
2025-06-18 15:38:22 [root] INFO: should_process_url: URL https://www.creditkarma.com has never been seen before, processing it.
2025-06-18 15:38:22 [root] INFO: write_url_to_db(): appended URL 'https://www.creditkarma.com'
2025-06-18 15:38:22 [root] INFO: def parse(): Crawling next URL: https://www.creditkarma.com
2025-06-18 15:38:22 [root] INFO: should_process_url: URL https://quickbooks.intuit.com/ has never been seen before, processing it.
2025-06-18 15:38:22 [scrapy.extensions.logstats] INFO: Crawled 227 pages (at 1 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 15:38:22 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <403 https://boards.cruisecritic.com/topic/2418703-dance-lessons/>: HTTP status code is not handled or not allowed
2025-06-18 15:38:22 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <403 https://support.last.fm/u/system>: HTTP status code is not handled or not allowed
2025-06-18 15:38:22 [root] INFO: def parse(): Found keywords for URL https://victoriaarthurmurray.com/: ['argentine tango', 'cha cha', 'dance', 'rumba', 'salsa', 'swing', 'tango', 'waltz']
2025-06-18 15:38:22 [root] INFO: def generate_prompt(): Generating prompt for URL: https://victoriaarthurmurray.com/
2025-06-18 15:38:22 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:38:22 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:38:22 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:39:00 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:39:00 [root] INFO: query_llm(): Mistral response received: [
  {
    "source": "Arthur Murray Dance Studio Victoria",
    "dance_style": "salsa, swing, waltz, cha cha, tango, two-step",
    "url": "",
    "event_type": "class",
    "event_name": "Singles Dance Lessons",
    "day_of_week": "",
    "start_date": "",
    "end_date": "",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Arthur Murray Dance Studio Victoria, 3567 Ravine Way, Victoria, BC V8X 4Z1",
    "description": "Have the time of your life. Looking for a fun night out? A new hobby? Join a community that's full of love, laughter, and lots of dancing!"
  },
  {
    "source": "Arthur Murray Dance Studio Victoria",
    "dance_style": "salsa, swing, waltz, cha cha, tango, two-step",
    "url": "",
    "event_type": "class",
    "event_name": "Couples Dance Lessons",
    "day_of_week": "",
    "start_date": "",
    "end_date": "",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Arthur Murray Dance Studio Victoria, 3567 Ravine Way, Victoria, BC V8X 4Z1",
    "description": "Make date night fun again. Couples that dance together, stay together! Enjoy a new date night and get to know each other all over again."
  },
  {
    "source": "Arthur Murray Dance Studio Victoria",
    "dance_style": "salsa, swing, waltz, cha cha, tango, two-step",
    "url": "",
    "event_type": "class",
    "event_name": "Wedding Dance Lessons",
    "day_of_week": "",
    "start_date": "",
    "end_date": "",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Arthur Murray Dance Studio Victoria, 3567 Ravine Way, Victoria, BC V8X 4Z1",
    "description": "A First dance of your dreams. Want a wedding that's one-of-a-kind? Have a planned dance and make your big day special."
  },
  {
    "source": "Arthur Murray Dance Studio Victoria",
    "dance_style": "salsa, swing, waltz, cha cha, tango, two-step",
    "url": "",
    "event_type": "social dance",
    "event_name": "Friday Group Lesson and Party",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-20",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Arthur Murray Dance Studio Victoria, 3567 Ravine Way, Victoria, BC V8X 4Z1",
    "description": "Friday group lesson (rumba) and party to follow. It is a really great studio with friendly staff, good music and a great dance floor (ballroom)."
  }
]
2025-06-18 15:39:00 [root] INFO: def extract_and_parse_json(): for url https://victoriaarthurmurray.com/, 
Cleaned JSON ready for parsing:
[
  {
    "source": "Arthur Murray Dance Studio Victoria",
    "dance_style": "salsa, swing, waltz, cha cha, tango, two-step",
    "url": "",
    "event_type": "class",
    "event_name": "Singles Dance Lessons",
    "day_of_week": "",
    "start_date": "",
    "end_date": "",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Arthur Murray Dance Studio Victoria, 3567 Ravine Way, Victoria, BC V8X 4Z1",
    "description": "Have the time of your life. Looking for a fun night out? A new hobby? Join a community that's full of love, laughter, and lots of dancing!"
  },
  {
    "source": "Arthur Murray Dance Studio Victoria",
    "dance_style": "salsa, swing, waltz, cha cha, tango, two-step",
    "url": "",
    "event_type": "class",
    "event_name": "Couples Dance Lessons",
    "day_of_week": "",
    "start_date": "",
    "end_date": "",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Arthur Murray Dance Studio Victoria, 3567 Ravine Way, Victoria, BC V8X 4Z1",
    "description": "Make date night fun again. Couples that dance together, stay together! Enjoy a new date night and get to know each other all over again."
  },
  {
    "source": "Arthur Murray Dance Studio Victoria",
    "dance_style": "salsa, swing, waltz, cha cha, tango, two-step",
    "url": "",
    "event_type": "class",
    "event_name": "Wedding Dance Lessons",
    "day_of_week": "",
    "start_date": "",
    "end_date": "",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Arthur Murray Dance Studio Victoria, 3567 Ravine Way, Victoria, BC V8X 4Z1",
    "description": "A First dance of your dreams. Want a wedding that's one-of-a-kind? Have a planned dance and make your big day special."
  },
  {
    "source": "Arthur Murray Dance Studio Victoria",
    "dance_style": "salsa, swing, waltz, cha cha, tango, two-step",
    "url": "",
    "event_type": "social dance",
    "event_name": "Friday Group Lesson and Party",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-20",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Arthur Murray Dance Studio Victoria, 3567 Ravine Way, Victoria, BC V8X 4Z1",
    "description": "Friday group lesson (rumba) and party to follow. It is a really great studio with friendly staff, good music and a great dance floor (ballroom)."
  }
]
2025-06-18 15:39:00 [root] INFO: def clean_up_address(): Starting with events_df shape: (4, 14)
2025-06-18 15:39:00 [root] INFO: def clean_up_address(): Processing location 'Arthur Murray Dance Studio Victoria, 3567 Ravine Way, Victoria, BC V8X 4Z1' (event_id: None)
2025-06-18 15:39:00 [root] INFO: get_address_id: Inserted or updated address_id 3319 for address '3501 Ravine WAY, VICTORIA, BC, V8X4Z1, CA'.
2025-06-18 15:39:00 [root] INFO: Populated from DB for postal code 'V8X4Z1': '3501 Ravine WAY, VICTORIA, BC, V8X4Z1, CA'
2025-06-18 15:39:00 [root] INFO: def clean_up_address(): Processing location 'Arthur Murray Dance Studio Victoria, 3567 Ravine Way, Victoria, BC V8X 4Z1' (event_id: None)
2025-06-18 15:39:00 [root] INFO: get_address_id: Inserted or updated address_id 3319 for address '3501 Ravine WAY, VICTORIA, BC, V8X4Z1, CA'.
2025-06-18 15:39:00 [root] INFO: Populated from DB for postal code 'V8X4Z1': '3501 Ravine WAY, VICTORIA, BC, V8X4Z1, CA'
2025-06-18 15:39:00 [root] INFO: def clean_up_address(): Processing location 'Arthur Murray Dance Studio Victoria, 3567 Ravine Way, Victoria, BC V8X 4Z1' (event_id: None)
2025-06-18 15:39:00 [root] INFO: get_address_id: Inserted or updated address_id 3319 for address '3501 Ravine WAY, VICTORIA, BC, V8X4Z1, CA'.
2025-06-18 15:39:00 [root] INFO: Populated from DB for postal code 'V8X4Z1': '3501 Ravine WAY, VICTORIA, BC, V8X4Z1, CA'
2025-06-18 15:39:00 [root] INFO: def clean_up_address(): Processing location 'Arthur Murray Dance Studio Victoria, 3567 Ravine Way, Victoria, BC V8X 4Z1' (event_id: None)
2025-06-18 15:39:00 [root] INFO: get_address_id: Inserted or updated address_id 3319 for address '3501 Ravine WAY, VICTORIA, BC, V8X4Z1, CA'.
2025-06-18 15:39:00 [root] INFO: Populated from DB for postal code 'V8X4Z1': '3501 Ravine WAY, VICTORIA, BC, V8X4Z1, CA'
2025-06-18 15:39:00 [root] INFO: write_events_to_db: Number of events to write: 4
2025-06-18 15:39:00 [root] INFO: write_url_to_db(): appended URL 'https://victoriaarthurmurray.com/'
2025-06-18 15:39:00 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 15:39:00 [root] INFO: def process_llm_response: URL https://victoriaarthurmurray.com/ marked as relevant with events written to the database.
2025-06-18 15:39:00 [root] INFO: write_url_to_db(): appended URL 'https://victoriaarthurmurray.com/'
2025-06-18 15:39:00 [root] INFO: def parse(): URL https://victoriaarthurmurray.com/ marked as relevant (LLM positive).
2025-06-18 15:39:00 [root] INFO: def parse(): Found 10 links on https://victoriaarthurmurray.com/
2025-06-18 15:39:00 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://player.vimeo.com/video/913795651?badge=0&autopause=0&player_id=0&app_id=58479, URL: https://victoriaarthurmurray.com/, source: Arthur Murray Victoria: Ballroom Dance Lessons, keywords: quickstep
2025-06-18 15:39:00 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: VzoרwzVv
2025-06-18 15:39:00 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://player.vimeo.com/video/913795651?badge=0&autopause=0&player_id=0&app_id=58479
2025-06-18 15:39:00 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://player.vimeo.com/video/913795761?badge=0&autopause=0&player_id=0&app_id=58479, URL: https://victoriaarthurmurray.com/, source: Arthur Murray Victoria: Ballroom Dance Lessons, keywords: quickstep
2025-06-18 15:39:00 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: Vzoרw{Vv
2025-06-18 15:39:00 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://player.vimeo.com/video/913795761?badge=0&autopause=0&player_id=0&app_id=58479
2025-06-18 15:39:00 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://player.vimeo.com/video/913795877?badge=0&autopause=0&player_id=0&app_id=58479, URL: https://victoriaarthurmurray.com/, source: Arthur Murray Victoria: Ballroom Dance Lessons, keywords: quickstep
2025-06-18 15:39:00 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: Vzoרw|v
2025-06-18 15:39:00 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://player.vimeo.com/video/913795877?badge=0&autopause=0&player_id=0&app_id=58479
2025-06-18 15:39:00 [root] INFO: write_url_to_db(): appended URL 'https://player.vimeo.com/video/913795877?badge=0&autopause=0&player_id=0&app_id=58479'
2025-06-18 15:39:00 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/arthurmurrayvictoria/'
2025-06-18 15:39:00 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/arthurmurrayvictoria/
2025-06-18 15:39:00 [root] INFO: parse: Skipping blacklisted URL https://www.google.com/maps/contrib/115303975566642667515/reviews.
2025-06-18 15:39:00 [root] INFO: should_process_url: URL https://maps.app.goo.gl/viwHWokwUQAMvWjv8 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:39:00 [root] INFO: should_process_url: URL https://maps.app.goo.gl/viwHWokwUQAMvWjv8 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:39:00 [root] INFO: write_url_to_db(): appended URL 'https://maps.app.goo.gl/viwHWokwUQAMvWjv8'
2025-06-18 15:39:00 [root] INFO: def parse(): Crawling next URL: https://maps.app.goo.gl/viwHWokwUQAMvWjv8
2025-06-18 15:39:00 [root] INFO: write_url_to_db(): appended URL 'https://www.opentable.ca/r/irish-times-pub-reservations-victoria?restref=37471&lang=en-CA&ot_source=Restaurant%20website'
2025-06-18 15:39:00 [root] INFO: def parse(): URL https://www.opentable.ca/r/irish-times-pub-reservations-victoria?restref=37471&lang=en-CA&ot_source=Restaurant%20website marked as irrelevant (no keywords).
2025-06-18 15:39:00 [root] INFO: def parse(): Found 0 links on https://www.opentable.ca/r/irish-times-pub-reservations-victoria?restref=37471&lang=en-CA&ot_source=Restaurant%20website
2025-06-18 15:39:00 [root] INFO: should_process_url: URL https://www.opentable.ca/r/irish-times-pub-reservations-victoria?restref=37471&lang=en-CA&ot_source=Restaurant%20website was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:39:00 [root] INFO: def parse(): Found keywords for URL https://www.cohoferry.com/articles/summer-festivals-in-victoria-bc: ['live music']
2025-06-18 15:39:00 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.cohoferry.com/articles/summer-festivals-in-victoria-bc
2025-06-18 15:39:00 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:39:00 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:39:00 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:40:08 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:40:08 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "Summer Festivals in Victoria, BC | Black Ball Ferry Line",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "TD Victoria Jazz Festival",
        "day_of_week": "",
        "start_date": "2025-06-20",
        "end_date": "2025-06-29",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Victoria, BC",
        "description": "Immerse yourself in the dynamic world of jazz at the TD Victoria International JazzFest, a captivating ten-day event showcasing a combination of jazz, blues, and world music performed by a lineup of talented local, Canadian, and international artists, including the legendary 2-time Grammy winner Eliane Elias. Experience the festival's vibrant atmosphere featuring an array of live shows, insightful workshops, and collaborative panels that celebrate the diversity and creativity of jazz music."
    },
    {
        "source": "Summer Festivals in Victoria, BC | Black Ball Ferry Line",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "The Butchart Gardens Firework Display",
        "day_of_week": "Saturday",
        "start_date": "2025-07-05",
        "end_date": "2025-08-31",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "The Butchart Gardens, Victoria, BC",
        "description": "Step beyond the 55 acres of breathtaking floral displays at The Butchart Gardens and experience a world-class firework show, taking place every Saturday throughout the summer. These captivating displays, choreographed to music, are a highlight not to be missed. Enjoy unforgettable evenings of enchantment and entertainment beneath the stars."
    },
    {
        "source": "Summer Festivals in Victoria, BC | Black Ball Ferry Line",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Tilt! At The Phillips Backyard",
        "day_of_week": "",
        "start_date": "2025-07-04",
        "end_date": "2025-07-06",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Phillips Brewery, Victoria, BC",
        "description": "Phillips Backyard Festival Series hosted by Phillips Brewing & Malting Co and The Zone @91.3 is returning for a weekend this summer! The festival features an outstanding lineup of headliners, including Cold War Kids, Unknown Mortal Orchestra, G-EAZY, and takes place in the outdoor space of Phillips Brewery, creating an intimate and energetic atmosphere."
    },
    {
        "source": "Summer Festivals in Victoria, BC | Black Ball Ferry Line",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Victoria Pride Parade",
        "day_of_week": "Wednesday",
        "start_date": "2025-07-06",
        "end_date": "2025-07-06",
        "start_time": "11:00",
        "end_time": "",
        "price": "",
        "location": "Inner Harbour, Victoria, BC",
        "description": "This annual colorful parade will take place in the Inner Harbour starting at 11:00am. Led by the Esquimalt Songhees Nation, this event is free and welcomes all ages and walks of life! Following the parade, there will be a festival at Macdonald Park where there will be more than 150 vendors along with food and drinks. Additionally, there will be a main stage and a kid's zone; something for everyone to enjoy!"
    },
    {
        "source": "Summer Festivals in Victoria, BC | Black Ball Ferry Line",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Oak Bay Collector Car Festival",
        "day_of_week": "Sunday",
        "start_date": "2025-07-13",
        "end_date": "2025-07-13",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Oak Bay Avenue, Victoria, BC",
        "description": "Rev your engines and cruise into the Oak Bay Car Collector Festival, a paradise for car enthusiasts and vintage vehicle admirers! Held on Oak Bay Avenue, this festival showcases an array of classic cars, hot rods, and unique vehicles from various eras. Explore the craftsmanship and history behind each automobile, chat with passionate collectors, and enjoy live music and entertainment. Many local businesses and restaurants will be open especially for the event. There will also be a variety of food trucks to choose from. There will be ribbons awarded in a variety of categories, and great entertainment as well. Don't miss this opportunity to marvel at automotive artistry and celebrate the timeless allure of classic cars!"
    },
    {
        "source": "Summer Festivals in Victoria, BC | Black Ball Ferry Line",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Saanich Fair",
        "day_of_week": "Friday",
        "start_date": "2025-08-30",
        "end_date": "2025-09-01",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Saanich Fair Grounds, Saanichton, BC",
        "description": "Explore the excitement of the Saanich Fair, where thrilling rides and games meet captivating livestock displays and competitions. As one of British Columbia's oldest and largest agricultural fairs, the Saanich Fair guarantees a delightful experience for all ages. Treat yourself to delicious food, discover local arts and crafts, and enjoy live music and performances."
    },
    {
        "source": "Summer Festivals in Victoria, BC | Black Ball Ferry Line",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Victoria Fringe Festival",
        "day_of_week": "",
        "start_date": "2025-08-20",
        "end_date": "2025-08-31",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Victoria, BC",
        "description": "Spend a day in a world of creativity and explore some amazing art pieces at the Victoria Fringe Festival this summer. Known for its welcoming and interactive atmosphere, attendees will see a wide range of local and international works of art. The Victoria Fringe Festival gives people a rare opportunity to witness the convergence of diverse artistic styles, techniques, and narratives."
    },
    {
        "source": "Summer Festivals in Victoria, BC | Black Ball Ferry Line",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Harbour Blues 'n Roots Festival",
        "day_of_week": "",
        "start_date": "2025-08-22",
        "end_date": "2025-08-24",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Victoria's Inner Harbour, Victoria, BC",
        "description": "Listen to the heartfelt sounds of the BC Harbour Blues 'n Roots Festival this August, located on the outdoor stage in Victoria's Inner Harbour. If you enjoy infectious rhythms of blues and the fusion of various genres, this is the place for you. The three-day festival has free performances each day and ticketed evening performances throughout the weekend. Beyond the performances, the festival offers a range of artisan vendors, food stalls and beverages to enjoy."
    },
    {
        "source": "Summer Festivals in Victoria, BC | Black Ball Ferry Line",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Dragon Boat Festival",
        "day_of_week": "",
        "start_date": "2025-08-08",
        "end_date": "2025-08-09",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Victoria's Inner Harbour, Victoria, BC",
        "description": "Experience the dynamic fusion of Chinese and local cultures at Victoria's Inner Harbour on August 8th and 9th, where festivities commence around exhilarating dragon boat races. Witness thrilling competitions, cultural showcases, and captivating performances by local artists. Beyond the excitement of the races, indulge in international foods, enjoy stage performances, and explore family-friendly amusements. This festival embodies the essence of sport, culture, diversity, and community, offering a welcoming atmosphere for all ages and backgrounds. Don't miss the chance to witness the spectacular sight of dragon boats flying across the water!"
    },
    {
        "source": "Summer Festivals in Victoria, BC | Black Ball Ferry Line",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Esquimalt RibFest",
        "day_of_week": "",
        "start_date": "2025-09-05",
        "end_date": "2025-09-07",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Bullen Park, Victoria, BC",
        "description": "Enjoy ribs, drinks, and entertainment at this year's annual Ribfest in Bullen Park (located just outside of downtown Victoria). Along with six rib teams competing for the coveted title of the best ribs, is live music, vendors, local arts, and kids' crafts; the perfect event for the whole family to enjoy! Come hungry, bring your friends and family, and prepare to feast your way through an unforgettable weekend of flavors and good times! The festival has free entry, but donations are accepted for local charities and the Firefighters Charitable Foundation."
    },
    {
        "source": "Summer Festivals in Victoria, BC | Black Ball Ferry Line",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Rifflandia",
        "day_of_week": "",
        "start_date": "2025-09-11",
        "end_date": "2025-09-14",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Victoria, BC",
        "description": "Enjoy the vibrant energy of Rifflandia Festival, one of Western Canada's longest-running large-scale music and arts festivals. Drawing tens of thousands of music lovers to Victoria, BC, Rifflandia goes beyond music, celebrating the city's diverse culture and creativity. From top international acts to emerging artists, the festival promises unforgettable moments against the backdrop of Victoria's stunning landscapes."
    }
]
2025-06-18 15:40:08 [root] INFO: def extract_and_parse_json(): for url https://www.cohoferry.com/articles/summer-festivals-in-victoria-bc, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Summer Festivals in Victoria, BC | Black Ball Ferry Line",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "TD Victoria Jazz Festival",
        "day_of_week": "",
        "start_date": "2025-06-20",
        "end_date": "2025-06-29",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Victoria, BC",
        "description": "Immerse yourself in the dynamic world of jazz at the TD Victoria International JazzFest, a captivating ten-day event showcasing a combination of jazz, blues, and world music performed by a lineup of talented local, Canadian, and international artists, including the legendary 2-time Grammy winner Eliane Elias. Experience the festival's vibrant atmosphere featuring an array of live shows, insightful workshops, and collaborative panels that celebrate the diversity and creativity of jazz music."
    },
    {
        "source": "Summer Festivals in Victoria, BC | Black Ball Ferry Line",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "The Butchart Gardens Firework Display",
        "day_of_week": "Saturday",
        "start_date": "2025-07-05",
        "end_date": "2025-08-31",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "The Butchart Gardens, Victoria, BC",
        "description": "Step beyond the 55 acres of breathtaking floral displays at The Butchart Gardens and experience a world-class firework show, taking place every Saturday throughout the summer. These captivating displays, choreographed to music, are a highlight not to be missed. Enjoy unforgettable evenings of enchantment and entertainment beneath the stars."
    },
    {
        "source": "Summer Festivals in Victoria, BC | Black Ball Ferry Line",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Tilt! At The Phillips Backyard",
        "day_of_week": "",
        "start_date": "2025-07-04",
        "end_date": "2025-07-06",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Phillips Brewery, Victoria, BC",
        "description": "Phillips Backyard Festival Series hosted by Phillips Brewing & Malting Co and The Zone @91.3 is returning for a weekend this summer! The festival features an outstanding lineup of headliners, including Cold War Kids, Unknown Mortal Orchestra, G-EAZY, and takes place in the outdoor space of Phillips Brewery, creating an intimate and energetic atmosphere."
    },
    {
        "source": "Summer Festivals in Victoria, BC | Black Ball Ferry Line",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Victoria Pride Parade",
        "day_of_week": "Wednesday",
        "start_date": "2025-07-06",
        "end_date": "2025-07-06",
        "start_time": "11:00",
        "end_time": "",
        "price": "",
        "location": "Inner Harbour, Victoria, BC",
        "description": "This annual colorful parade will take place in the Inner Harbour starting at 11:00am. Led by the Esquimalt Songhees Nation, this event is free and welcomes all ages and walks of life! Following the parade, there will be a festival at Macdonald Park where there will be more than 150 vendors along with food and drinks. Additionally, there will be a main stage and a kid's zone; something for everyone to enjoy!"
    },
    {
        "source": "Summer Festivals in Victoria, BC | Black Ball Ferry Line",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Oak Bay Collector Car Festival",
        "day_of_week": "Sunday",
        "start_date": "2025-07-13",
        "end_date": "2025-07-13",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Oak Bay Avenue, Victoria, BC",
        "description": "Rev your engines and cruise into the Oak Bay Car Collector Festival, a paradise for car enthusiasts and vintage vehicle admirers! Held on Oak Bay Avenue, this festival showcases an array of classic cars, hot rods, and unique vehicles from various eras. Explore the craftsmanship and history behind each automobile, chat with passionate collectors, and enjoy live music and entertainment. Many local businesses and restaurants will be open especially for the event. There will also be a variety of food trucks to choose from. There will be ribbons awarded in a variety of categories, and great entertainment as well. Don't miss this opportunity to marvel at automotive artistry and celebrate the timeless allure of classic cars!"
    },
    {
        "source": "Summer Festivals in Victoria, BC | Black Ball Ferry Line",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Saanich Fair",
        "day_of_week": "Friday",
        "start_date": "2025-08-30",
        "end_date": "2025-09-01",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Saanich Fair Grounds, Saanichton, BC",
        "description": "Explore the excitement of the Saanich Fair, where thrilling rides and games meet captivating livestock displays and competitions. As one of British Columbia's oldest and largest agricultural fairs, the Saanich Fair guarantees a delightful experience for all ages. Treat yourself to delicious food, discover local arts and crafts, and enjoy live music and performances."
    },
    {
        "source": "Summer Festivals in Victoria, BC | Black Ball Ferry Line",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Victoria Fringe Festival",
        "day_of_week": "",
        "start_date": "2025-08-20",
        "end_date": "2025-08-31",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Victoria, BC",
        "description": "Spend a day in a world of creativity and explore some amazing art pieces at the Victoria Fringe Festival this summer. Known for its welcoming and interactive atmosphere, attendees will see a wide range of local and international works of art. The Victoria Fringe Festival gives people a rare opportunity to witness the convergence of diverse artistic styles, techniques, and narratives."
    },
    {
        "source": "Summer Festivals in Victoria, BC | Black Ball Ferry Line",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Harbour Blues 'n Roots Festival",
        "day_of_week": "",
        "start_date": "2025-08-22",
        "end_date": "2025-08-24",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Victoria's Inner Harbour, Victoria, BC",
        "description": "Listen to the heartfelt sounds of the BC Harbour Blues 'n Roots Festival this August, located on the outdoor stage in Victoria's Inner Harbour. If you enjoy infectious rhythms of blues and the fusion of various genres, this is the place for you. The three-day festival has free performances each day and ticketed evening performances throughout the weekend. Beyond the performances, the festival offers a range of artisan vendors, food stalls and beverages to enjoy."
    },
    {
        "source": "Summer Festivals in Victoria, BC | Black Ball Ferry Line",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Dragon Boat Festival",
        "day_of_week": "",
        "start_date": "2025-08-08",
        "end_date": "2025-08-09",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Victoria's Inner Harbour, Victoria, BC",
        "description": "Experience the dynamic fusion of Chinese and local cultures at Victoria's Inner Harbour on August 8th and 9th, where festivities commence around exhilarating dragon boat races. Witness thrilling competitions, cultural showcases, and captivating performances by local artists. Beyond the excitement of the races, indulge in international foods, enjoy stage performances, and explore family-friendly amusements. This festival embodies the essence of sport, culture, diversity, and community, offering a welcoming atmosphere for all ages and backgrounds. Don't miss the chance to witness the spectacular sight of dragon boats flying across the water!"
    },
    {
        "source": "Summer Festivals in Victoria, BC | Black Ball Ferry Line",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Esquimalt RibFest",
        "day_of_week": "",
        "start_date": "2025-09-05",
        "end_date": "2025-09-07",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Bullen Park, Victoria, BC",
        "description": "Enjoy ribs, drinks, and entertainment at this year's annual Ribfest in Bullen Park (located just outside of downtown Victoria). Along with six rib teams competing for the coveted title of the best ribs, is live music, vendors, local arts, and kids' crafts; the perfect event for the whole family to enjoy! Come hungry, bring your friends and family, and prepare to feast your way through an unforgettable weekend of flavors and good times! The festival has free entry, but donations are accepted for local charities and the Firefighters Charitable Foundation."
    },
    {
        "source": "Summer Festivals in Victoria, BC | Black Ball Ferry Line",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Rifflandia",
        "day_of_week": "",
        "start_date": "2025-09-11",
        "end_date": "2025-09-14",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Victoria, BC",
        "description": "Enjoy the vibrant energy of Rifflandia Festival, one of Western Canada's longest-running large-scale music and arts festivals. Drawing tens of thousands of music lovers to Victoria, BC, Rifflandia goes beyond music, celebrating the city's diverse culture and creativity. From top international acts to emerging artists, the festival promises unforgettable moments against the backdrop of Victoria's stunning landscapes."
    }
]
2025-06-18 15:40:08 [root] INFO: def clean_up_address(): Starting with events_df shape: (11, 14)
2025-06-18 15:40:08 [root] INFO: def clean_up_address(): Processing location 'Victoria, BC' (event_id: None)
2025-06-18 15:40:08 [root] INFO: def clean_up_address(): Processing location 'The Butchart Gardens, Victoria, BC' (event_id: None)
2025-06-18 15:40:08 [root] INFO: def clean_up_address(): Processing location 'Phillips Brewery, Victoria, BC' (event_id: None)
2025-06-18 15:40:08 [root] INFO: def clean_up_address(): Processing location 'Inner Harbour, Victoria, BC' (event_id: None)
2025-06-18 15:40:08 [root] INFO: def clean_up_address(): Processing location 'Oak Bay Avenue, Victoria, BC' (event_id: None)
2025-06-18 15:40:08 [root] INFO: def clean_up_address(): Processing location 'Saanich Fair Grounds, Saanichton, BC' (event_id: None)
2025-06-18 15:40:08 [root] INFO: def clean_up_address(): Processing location 'Victoria, BC' (event_id: None)
2025-06-18 15:40:08 [root] INFO: def clean_up_address(): Processing location 'Victoria's Inner Harbour, Victoria, BC' (event_id: None)
2025-06-18 15:40:08 [root] INFO: def clean_up_address(): Processing location 'Victoria's Inner Harbour, Victoria, BC' (event_id: None)
2025-06-18 15:40:08 [root] INFO: def clean_up_address(): Processing location 'Bullen Park, Victoria, BC' (event_id: None)
2025-06-18 15:40:08 [root] INFO: def clean_up_address(): Processing location 'Victoria, BC' (event_id: None)
2025-06-18 15:40:08 [root] INFO: write_events_to_db: Number of events to write: 11
2025-06-18 15:40:08 [root] INFO: write_url_to_db(): appended URL 'https://www.cohoferry.com/articles/summer-festivals-in-victoria-bc'
2025-06-18 15:40:08 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 15:40:08 [root] INFO: def process_llm_response: URL https://www.cohoferry.com/articles/summer-festivals-in-victoria-bc marked as relevant with events written to the database.
2025-06-18 15:40:08 [root] INFO: write_url_to_db(): appended URL 'https://www.cohoferry.com/articles/summer-festivals-in-victoria-bc'
2025-06-18 15:40:08 [root] INFO: def parse(): URL https://www.cohoferry.com/articles/summer-festivals-in-victoria-bc marked as relevant (LLM positive).
2025-06-18 15:40:08 [root] INFO: def parse(): Found 10 links on https://www.cohoferry.com/articles/summer-festivals-in-victoria-bc
2025-06-18 15:40:08 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-NBB6WGX, URL: https://www.cohoferry.com/articles/summer-festivals-in-victoria-bc, source: Summer Festivals in Victoria, BC | Black Ball Ferry Line, keywords: music festivals
2025-06-18 15:40:08 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 15:40:08 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-NBB6WGX
2025-06-18 15:40:08 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-NBB6WGX'
2025-06-18 15:40:08 [root] INFO: should_process_url: URL https://victoriapridesociety.org/pride-2025/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:40:08 [root] INFO: should_process_url: URL https://victoriapridesociety.org/pride-2025/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:40:08 [root] INFO: write_url_to_db(): appended URL 'https://victoriapridesociety.org/pride-2025/'
2025-06-18 15:40:08 [root] INFO: def parse(): Crawling next URL: https://victoriapridesociety.org/pride-2025/
2025-06-18 15:40:08 [root] INFO: write_url_to_db(): appended URL 'https://thedukesaloon.com/us/'
2025-06-18 15:40:08 [root] INFO: def parse(): URL https://thedukesaloon.com/us/ marked as irrelevant (no keywords).
2025-06-18 15:40:08 [root] INFO: def parse(): Found 10 links on https://thedukesaloon.com/us/
2025-06-18 15:40:08 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/thedukesaloon/'
2025-06-18 15:40:08 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/thedukesaloon/
2025-06-18 15:40:08 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/TheDukeVictoria/'
2025-06-18 15:40:08 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/TheDukeVictoria/
2025-06-18 15:40:08 [root] INFO: should_process_url: URL https://thedukesaloon.com/block-party/ was last seen as relevant, processing it.
2025-06-18 15:40:08 [root] INFO: should_process_url: URL https://thedukesaloon.com/us/ was last seen as not relevant but hit_ratio (0.33) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 15:40:08 [root] INFO: should_process_url: URL https://thedukesaloon.com/fundraising/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:40:08 [root] INFO: should_process_url: URL https://thedukesaloon.com/events/ was last seen as relevant, processing it.
2025-06-18 15:40:08 [root] INFO: should_process_url: URL https://thedukesaloon.com/ was last seen as relevant, processing it.
2025-06-18 15:40:08 [root] INFO: should_process_url: URL https://www.google.ca/maps/dir/''/The+Duke+Saloon/@48.4319416,-123.4380883,12z/data=!3m1!4b1!4m8!4m7!1m0!1m5!1m1!1s0x548f748257cd657d:0x7b34826b02413603!2m2!1d-123.369422!2d48.431962 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:40:08 [root] INFO: should_process_url: URL https://thedukesaloon.com/weekly/ was last seen as relevant, processing it.
2025-06-18 15:40:08 [root] INFO: should_process_url: URL https://thedukesaloon.com/gallery/ does not meet criteria for processing, skipping it.
2025-06-18 15:40:08 [root] INFO: def eventbrite_search(): Skipping URL https://thedukesaloon.com/gallery/ based on historical relevancy.
2025-06-18 15:40:08 [root] INFO: write_url_to_db(): appended URL 'https://thedukesaloon.com/fundraising/'
2025-06-18 15:40:08 [root] INFO: def parse(): URL https://thedukesaloon.com/fundraising/ marked as irrelevant (no keywords).
2025-06-18 15:40:08 [root] INFO: def parse(): Found 10 links on https://thedukesaloon.com/fundraising/
2025-06-18 15:40:08 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/thedukesaloon/'
2025-06-18 15:40:08 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/thedukesaloon/
2025-06-18 15:40:08 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/TheDukeVictoria/'
2025-06-18 15:40:08 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/TheDukeVictoria/
2025-06-18 15:40:08 [root] INFO: should_process_url: URL https://thedukesaloon.com/block-party/ was last seen as relevant, processing it.
2025-06-18 15:40:08 [root] INFO: should_process_url: URL https://thedukesaloon.com/us/ was last seen as not relevant but hit_ratio (0.33) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 15:40:08 [root] INFO: should_process_url: URL https://thedukesaloon.com/fundraising/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:40:08 [root] INFO: should_process_url: URL https://thedukesaloon.com/events/ was last seen as relevant, processing it.
2025-06-18 15:40:08 [root] INFO: should_process_url: URL https://thedukesaloon.com/ was last seen as relevant, processing it.
2025-06-18 15:40:08 [root] INFO: should_process_url: URL https://www.google.ca/maps/dir/''/The+Duke+Saloon/@48.4319416,-123.4380883,12z/data=!3m1!4b1!4m8!4m7!1m0!1m5!1m1!1s0x548f748257cd657d:0x7b34826b02413603!2m2!1d-123.369422!2d48.431962 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:40:08 [root] INFO: should_process_url: URL https://thedukesaloon.com/weekly/ was last seen as relevant, processing it.
2025-06-18 15:40:08 [root] INFO: should_process_url: URL https://thedukesaloon.com/gallery/ does not meet criteria for processing, skipping it.
2025-06-18 15:40:08 [root] INFO: def eventbrite_search(): Skipping URL https://thedukesaloon.com/gallery/ based on historical relevancy.
2025-06-18 15:40:08 [root] INFO: def parse(): Found keywords for URL https://northernwilds.com/category/arts/: ['salsa']
2025-06-18 15:40:08 [root] INFO: def generate_prompt(): Generating prompt for URL: https://northernwilds.com/category/arts/
2025-06-18 15:40:08 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:40:08 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:40:08 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:48:50 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:48:50 [root] INFO: query_llm(): Mistral response received: <style>
		a.custom-button.pencisc-button:hover {
			background: #D3347B;
			color: #fff;
			border: 2px solid #D3347B;
		}
		a.custom-button.pencisc-button.pencisc-small:hover {
			background: #D3347B;
			color: #fff;
			border: 2px solid #D3347B;
		}
		a.custom-button.pencisc-button.pencisc-large:hover {
			background: #D3347B;
			color: #fff;
			border: 2px solid #D3347B;
		}
	</style>
2025-06-18 15:48:50 [root] INFO: def extract_and_parse_json(): for url https://northernwilds.com/category/arts/, 
Cleaned JSON ready for parsing:
[{
			background: #D3347B;
			color: #fff;
			border: 2px solid #D3347B;
		}
		a.custom-button.pencisc-button.pencisc-small:hover {
			background: #D3347B;
			color: #fff;
			border: 2px solid #D3347B;
		}
		a.custom-button.pencisc-button.pencisc-large:hover {
			background: #D3347B;
			color: #fff;
			border: 2px solid #D3347B;
		}]
2025-06-18 15:48:50 [root] ERROR: def extract_and_parse_json(): Error parsing JSON: Expecting property name enclosed in double quotes: line 2 column 4 (char 6)
2025-06-18 15:48:50 [root] INFO: write_url_to_db(): appended URL 'https://northernwilds.com/category/arts/'
2025-06-18 15:48:50 [root] INFO: def parse(): URL https://northernwilds.com/category/arts/ marked as irrelevant (LLM negative).
2025-06-18 15:48:50 [root] INFO: def parse(): Found 10 links on https://northernwilds.com/category/arts/
2025-06-18 15:48:50 [root] INFO: should_process_url: URL https://statcounter.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:48:50 [root] INFO: should_process_url: URL https://northernwilds.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:48:50 [root] INFO: should_process_url: URL https://northernwilds.com/category/features/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:48:50 [root] INFO: should_process_url: URL https://northernwilds.com/current-issue/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:48:50 [root] INFO: should_process_url: URL https://northernwilds.com/category/arts/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:48:50 [root] INFO: should_process_url: URL https://northernwilds.com/along-the-shore/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:48:50 [root] INFO: should_process_url: URL https://northernwilds.com/food-drink/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:48:50 [root] INFO: should_process_url: URL https://northernwilds.com/advertise-in-northern-minnesota/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:48:50 [root] INFO: should_process_url: URL https://northernwilds.com/about-us/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:48:50 [root] INFO: should_process_url: URL https://northernwilds.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:48:50 [root] INFO: def parse(): Found keywords for URL https://thedancestudiofinder.com/dance-studios/categories/paso-doble/: ['argentine tango', 'bachata', 'balboa', 'cha cha', 'dance', 'east coast swing', 'foxtrot', 'kizomba', 'lindy hop', 'line dance', 'merengue', 'milonga', 'quickstep', 'rumba', 'salsa', 'samba', 'swing', 'tango', 'two step', 'waltz', 'west coast swing', 'zouk']
2025-06-18 15:48:50 [root] INFO: def generate_prompt(): Generating prompt for URL: https://thedancestudiofinder.com/dance-studios/categories/paso-doble/
2025-06-18 15:48:50 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:48:50 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:48:50 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:57:33 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:57:33 [root] INFO: query_llm(): Mistral response received: [No events found.]
2025-06-18 15:57:33 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 15:57:33 [root] INFO: write_url_to_db(): appended URL 'https://thedancestudiofinder.com/dance-studios/categories/paso-doble/'
2025-06-18 15:57:33 [root] INFO: def parse(): URL https://thedancestudiofinder.com/dance-studios/categories/paso-doble/ marked as irrelevant (LLM negative).
2025-06-18 15:57:33 [root] INFO: def parse(): Found 10 links on https://thedancestudiofinder.com/dance-studios/categories/paso-doble/
2025-06-18 15:57:33 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/dance-studios/categories/paso-doble/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:57:33 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/dance-studios/categories/paso-doble/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:57:33 [root] INFO: write_url_to_db(): appended URL 'https://thedancestudiofinder.com/dance-studios/categories/paso-doble/'
2025-06-18 15:57:33 [root] INFO: def parse(): Crawling next URL: https://thedancestudiofinder.com/dance-studios/categories/paso-doble/
2025-06-18 15:57:33 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.sunshinecoastcanada.com/> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 15:57:33 [root] INFO: should_process_url: URL https://victoriaarthurmurray.com/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 15:57:33 [root] INFO: should_process_url: URL https://victoriaarthurmurray.com/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 15:57:33 [root] INFO: write_url_to_db(): appended URL 'https://victoriaarthurmurray.com/'
2025-06-18 15:57:33 [root] INFO: def parse(): Crawling next URL: https://victoriaarthurmurray.com/
2025-06-18 15:57:33 [scrapy.extensions.logstats] INFO: Crawled 229 pages (at 2 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 15:57:33 [root] INFO: should_process_url: URL https://www.cohoferry.com/articles/summer-festivals-in-victoria-bc was last seen as not relevant but hit_ratio (3.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 15:57:33 [root] INFO: should_process_url: URL https://www.cohoferry.com/articles/summer-festivals-in-victoria-bc was last seen as not relevant but hit_ratio (3.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 15:57:33 [root] INFO: write_url_to_db(): appended URL 'https://www.cohoferry.com/articles/summer-festivals-in-victoria-bc'
2025-06-18 15:57:33 [root] INFO: def parse(): Crawling next URL: https://www.cohoferry.com/articles/summer-festivals-in-victoria-bc
2025-06-18 15:57:33 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/contact-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:57:33 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/blog/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:57:33 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/my-account/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:57:33 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/join/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:57:33 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:57:33 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/about-us/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:57:33 [root] INFO: should_process_url: URL https://thedancestudiofinder.com/dance-studios/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:57:33 [root] INFO: parse: Skipping blacklisted URL https://www.google.com/maps/contrib/107978521488695775188/reviews.
2025-06-18 15:57:33 [root] INFO: should_process_url: URL https://maps.app.goo.gl/4isdFVGzsJz4UMHX8 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:57:33 [root] INFO: should_process_url: URL https://maps.app.goo.gl/4isdFVGzsJz4UMHX8 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:57:33 [root] INFO: write_url_to_db(): appended URL 'https://maps.app.goo.gl/4isdFVGzsJz4UMHX8'
2025-06-18 15:57:33 [root] INFO: def parse(): Crawling next URL: https://maps.app.goo.gl/4isdFVGzsJz4UMHX8
2025-06-18 15:57:33 [root] INFO: should_process_url: URL https://shop.blackball.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:57:33 [root] INFO: should_process_url: URL https://shop.blackball.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:57:33 [root] INFO: write_url_to_db(): appended URL 'https://shop.blackball.com/'
2025-06-18 15:57:33 [root] INFO: def parse(): Crawling next URL: https://shop.blackball.com/
2025-06-18 15:57:33 [root] INFO: parse: Skipping blacklisted URL https://www.google.com/maps/contrib/108704950907933319905/reviews.
2025-06-18 15:57:33 [root] INFO: should_process_url: URL https://maps.app.goo.gl/opqbJrqLAZXuaKBG6 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:57:33 [root] INFO: should_process_url: URL https://maps.app.goo.gl/opqbJrqLAZXuaKBG6 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:57:33 [root] INFO: write_url_to_db(): appended URL 'https://maps.app.goo.gl/opqbJrqLAZXuaKBG6'
2025-06-18 15:57:33 [root] INFO: def parse(): Crawling next URL: https://maps.app.goo.gl/opqbJrqLAZXuaKBG6
2025-06-18 15:57:33 [root] INFO: should_process_url: URL https://www.oakbay.ca/event/oak-bay-collector-car-festival-2025/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:57:33 [root] INFO: should_process_url: URL https://www.oakbay.ca/event/oak-bay-collector-car-festival-2025/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:57:33 [root] INFO: write_url_to_db(): appended URL 'https://www.oakbay.ca/event/oak-bay-collector-car-festival-2025/'
2025-06-18 15:57:33 [root] INFO: def parse(): Crawling next URL: https://www.oakbay.ca/event/oak-bay-collector-car-festival-2025/
2025-06-18 15:57:33 [root] INFO: should_process_url: URL https://www.phillipsbackyard.com/line-up#tilt-lineup was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:57:33 [root] INFO: should_process_url: URL https://www.phillipsbackyard.com/line-up#tilt-lineup was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:57:33 [root] INFO: write_url_to_db(): appended URL 'https://www.phillipsbackyard.com/line-up#tilt-lineup'
2025-06-18 15:57:33 [root] INFO: def parse(): Crawling next URL: https://www.phillipsbackyard.com/line-up#tilt-lineup
2025-06-18 15:57:33 [root] INFO: should_process_url: URL https://jazzvictoria.ca/jazzfest-home/ was last seen as relevant, processing it.
2025-06-18 15:57:33 [root] INFO: should_process_url: URL https://www.butchartgardens.com/summer-firework-saturdays/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:57:33 [root] INFO: should_process_url: URL https://www.butchartgardens.com/summer-firework-saturdays/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:57:33 [root] INFO: write_url_to_db(): appended URL 'https://www.butchartgardens.com/summer-firework-saturdays/'
2025-06-18 15:57:33 [root] INFO: def parse(): Crawling next URL: https://www.butchartgardens.com/summer-firework-saturdays/
2025-06-18 15:57:33 [root] INFO: should_process_url: URL https://victoriapridesociety.org/pride-2024/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:57:33 [root] INFO: should_process_url: URL https://victoriapridesociety.org/pride-2024/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:57:33 [root] INFO: write_url_to_db(): appended URL 'https://victoriapridesociety.org/pride-2024/'
2025-06-18 15:57:33 [root] INFO: def parse(): Crawling next URL: https://victoriapridesociety.org/pride-2024/
2025-06-18 15:57:34 [root] INFO: def parse(): Found keywords for URL https://www.irishtimespub.ca/about-us: ['samba', 'wcs']
2025-06-18 15:57:34 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.irishtimespub.ca/about-us
2025-06-18 15:57:34 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:57:34 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:57:34 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:57:36 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 15:57:36 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 335867 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 15:57:36 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 15:57:37 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 15:57:37 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 252950 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 15:57:37 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 15:57:37 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://www.irishtimespub.ca/about-us
2025-06-18 15:57:37 [root] INFO: write_url_to_db(): appended URL 'https://www.irishtimespub.ca/about-us'
2025-06-18 15:57:37 [root] INFO: def parse(): URL https://www.irishtimespub.ca/about-us marked as irrelevant (LLM negative).
2025-06-18 15:57:37 [root] INFO: def parse(): Found 10 links on https://www.irishtimespub.ca/about-us
2025-06-18 15:57:37 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/pg/irishtimespubbc/about/?ref=page_internal'
2025-06-18 15:57:37 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/pg/irishtimespubbc/about/?ref=page_internal
2025-06-18 15:57:37 [root] INFO: write_url_to_db(): appended URL 'https://instagram.com/irishtimespub'
2025-06-18 15:57:37 [root] INFO: def parse(): Recorded unwanted URL: https://instagram.com/irishtimespub
2025-06-18 15:57:37 [root] INFO: should_process_url: URL https://www.tripadvisor.ca/Restaurant_Review-g154945-d785052-Reviews-Irish_Times_Pub-Victoria_Victoria_Capital_Regional_District_Vancouver_Island_Briti.html was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:57:37 [root] INFO: should_process_url: URL https://www.opentable.ca/r/irish-times-pub-reservations-victoria?restref=37471&lang=en-CA&ot_source=Restaurant%20website was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:57:37 [root] INFO: should_process_url: URL https://www.irishtimespub.ca/about-us was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:57:37 [root] INFO: parse: Skipping blacklisted URL https://www.google.com/maps/place/1200+Government+St,+Victoria,+BC+V8W+1Y3/@48.4258565,-123.3701391,17z/data=!3m1!4b1!4m5!3m4!1s0x548f749adb714eff:0x803f326e036f01c4!8m2!3d48.4258565!4d-123.3679504.
2025-06-18 15:57:37 [root] INFO: should_process_url: URL https://www.irishtimespub.ca/drinkmenu was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:57:37 [root] INFO: should_process_url: URL https://www.irishtimespub.ca/food was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:57:37 [root] INFO: should_process_url: URL https://www.irishtimespub.ca was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:57:37 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.sunshinecoastcanada.com/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 15:57:37 [root] INFO: should_process_url: URL https://www.cohoferry.com/packages/victoria/the-butchart-gardens-admission-with-ferry was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:57:37 [root] INFO: should_process_url: URL https://www.cohoferry.com/packages/victoria/the-butchart-gardens-admission-with-ferry was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:57:37 [root] INFO: write_url_to_db(): appended URL 'https://www.cohoferry.com/packages/victoria/the-butchart-gardens-admission-with-ferry'
2025-06-18 15:57:37 [root] INFO: def parse(): Crawling next URL: https://www.cohoferry.com/packages/victoria/the-butchart-gardens-admission-with-ferry
2025-06-18 15:57:37 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <403 https://support.last.fm/u/LAST.HQ>: HTTP status code is not handled or not allowed
2025-06-18 15:57:37 [root] INFO: write_url_to_db(): appended URL 'https://support.last.fm/t/unrelated-scrobbles-of-now-streaming-on-disney-appearing-randomly-on-my-overview-page/112811'
2025-06-18 15:57:37 [root] INFO: def parse(): URL https://support.last.fm/t/unrelated-scrobbles-of-now-streaming-on-disney-appearing-randomly-on-my-overview-page/112811 marked as irrelevant (no keywords).
2025-06-18 15:57:37 [root] INFO: def parse(): Found 3 links on https://support.last.fm/t/unrelated-scrobbles-of-now-streaming-on-disney-appearing-randomly-on-my-overview-page/112811
2025-06-18 15:57:37 [root] INFO: should_process_url: URL https://www.discourse.org has never been seen before, processing it.
2025-06-18 15:57:37 [root] INFO: should_process_url: URL https://www.discourse.org has never been seen before, processing it.
2025-06-18 15:57:37 [root] INFO: write_url_to_db(): appended URL 'https://www.discourse.org'
2025-06-18 15:57:37 [root] INFO: def parse(): Crawling next URL: https://www.discourse.org
2025-06-18 15:57:37 [root] INFO: should_process_url: URL https://support.last.fm/t/unrelated-scrobbles-of-now-streaming-on-disney-appearing-randomly-on-my-overview-page/112811 has never been seen before, processing it.
2025-06-18 15:57:37 [root] INFO: should_process_url: URL https://us1.discourse-cdn.com/flex021/uploads/lastfm/original/3X/2/a/2ae562f36c2c27c35caf926f94ce3c4db53ced68.png has never been seen before, processing it.
2025-06-18 15:57:37 [root] INFO: should_process_url: URL https://us1.discourse-cdn.com/flex021/uploads/lastfm/original/3X/2/a/2ae562f36c2c27c35caf926f94ce3c4db53ced68.png has never been seen before, processing it.
2025-06-18 15:57:37 [root] INFO: write_url_to_db(): appended URL 'https://us1.discourse-cdn.com/flex021/uploads/lastfm/original/3X/2/a/2ae562f36c2c27c35caf926f94ce3c4db53ced68.png'
2025-06-18 15:57:37 [root] INFO: def parse(): Crawling next URL: https://us1.discourse-cdn.com/flex021/uploads/lastfm/original/3X/2/a/2ae562f36c2c27c35caf926f94ce3c4db53ced68.png
2025-06-18 15:57:37 [root] INFO: should_process_url: URL https://support.last.fm/u/Kingu_Platypus has never been seen before, processing it.
2025-06-18 15:57:37 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <403 https://support.last.fm/u/Kingu_Platypus>: HTTP status code is not handled or not allowed
2025-06-18 15:57:37 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <403 https://support.last.fm/u/hjbardenhagen>: HTTP status code is not handled or not allowed
2025-06-18 15:57:38 [root] INFO: write_url_to_db(): appended URL 'https://support.last.fm/t/welcome-to-the-last-fm-support-forums/7'
2025-06-18 15:57:38 [root] INFO: def parse(): URL https://support.last.fm/t/welcome-to-the-last-fm-support-forums/7 marked as irrelevant (no keywords).
2025-06-18 15:57:38 [root] INFO: def parse(): Found 10 links on https://support.last.fm/t/welcome-to-the-last-fm-support-forums/7
2025-06-18 15:57:38 [root] INFO: should_process_url: URL https://support.last.fm/categories has never been seen before, processing it.
2025-06-18 15:57:38 [root] INFO: should_process_url: URL https://support.last.fm/categories has never been seen before, processing it.
2025-06-18 15:57:38 [root] INFO: write_url_to_db(): appended URL 'https://support.last.fm/categories'
2025-06-18 15:57:38 [root] INFO: def parse(): Crawling next URL: https://support.last.fm/categories
2025-06-18 15:57:38 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/lastfmstatus.
2025-06-18 15:57:38 [root] INFO: should_process_url: URL https://support.last.fm/u/system has never been seen before, processing it.
2025-06-18 15:57:38 [root] INFO: should_process_url: URL https://www.last.fm/about/trackmymusic has never been seen before, processing it.
2025-06-18 15:57:38 [root] INFO: should_process_url: URL https://www.last.fm/about/trackmymusic has never been seen before, processing it.
2025-06-18 15:57:38 [root] INFO: write_url_to_db(): appended URL 'https://www.last.fm/about/trackmymusic'
2025-06-18 15:57:38 [root] INFO: def parse(): Crawling next URL: https://www.last.fm/about/trackmymusic
2025-06-18 15:57:38 [root] INFO: should_process_url: URL https://support.last.fm/t/welcome-to-the-last-fm-support-forums/7 has never been seen before, processing it.
2025-06-18 15:57:38 [root] INFO: should_process_url: URL https://support.last.fm/c/support/faqs has never been seen before, processing it.
2025-06-18 15:57:38 [root] INFO: should_process_url: URL https://support.last.fm/c/support/faqs has never been seen before, processing it.
2025-06-18 15:57:38 [root] INFO: write_url_to_db(): appended URL 'https://support.last.fm/c/support/faqs'
2025-06-18 15:57:38 [root] INFO: def parse(): Crawling next URL: https://support.last.fm/c/support/faqs
2025-06-18 15:57:38 [root] INFO: should_process_url: URL https://support.last.fm/tag/incident has never been seen before, processing it.
2025-06-18 15:57:38 [root] INFO: should_process_url: URL https://support.last.fm/tag/incident has never been seen before, processing it.
2025-06-18 15:57:38 [root] INFO: write_url_to_db(): appended URL 'https://support.last.fm/tag/incident'
2025-06-18 15:57:38 [root] INFO: def parse(): Crawling next URL: https://support.last.fm/tag/incident
2025-06-18 15:57:38 [root] INFO: should_process_url: URL http://bit.ly/1Q3Yo3I has never been seen before, processing it.
2025-06-18 15:57:38 [root] INFO: should_process_url: URL http://bit.ly/1Q3Yo3I has never been seen before, processing it.
2025-06-18 15:57:38 [root] INFO: write_url_to_db(): appended URL 'http://bit.ly/1Q3Yo3I'
2025-06-18 15:57:38 [root] INFO: def parse(): Crawling next URL: http://bit.ly/1Q3Yo3I
2025-06-18 15:57:38 [root] INFO: should_process_url: URL https://support.last.fm/t/more-ways-to-scrobble/192 has never been seen before, processing it.
2025-06-18 15:57:38 [root] INFO: should_process_url: URL https://support.last.fm/t/more-ways-to-scrobble/192 has never been seen before, processing it.
2025-06-18 15:57:38 [root] INFO: write_url_to_db(): appended URL 'https://support.last.fm/t/more-ways-to-scrobble/192'
2025-06-18 15:57:38 [root] INFO: def parse(): Crawling next URL: https://support.last.fm/t/more-ways-to-scrobble/192
2025-06-18 15:57:38 [root] INFO: should_process_url: URL http://bit.ly/1HxSLYX has never been seen before, processing it.
2025-06-18 15:57:38 [root] INFO: should_process_url: URL http://bit.ly/1HxSLYX has never been seen before, processing it.
2025-06-18 15:57:38 [root] INFO: write_url_to_db(): appended URL 'http://bit.ly/1HxSLYX'
2025-06-18 15:57:38 [root] INFO: def parse(): Crawling next URL: http://bit.ly/1HxSLYX
2025-06-18 15:57:38 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <403 https://support.last.fm/u/Maddieman>: HTTP status code is not handled or not allowed
2025-06-18 15:57:38 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <406 https://victoriapridesociety.org/pride-2025/>: HTTP status code is not handled or not allowed
2025-06-18 15:57:38 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <403 https://www.oakbay.ca/event/oak-bay-collector-car-festival-2025/>: HTTP status code is not handled or not allowed
2025-06-18 15:57:38 [root] INFO: write_url_to_db(): appended URL 'https://support.last.fm/tag/scrobbling'
2025-06-18 15:57:38 [root] INFO: def parse(): URL https://support.last.fm/tag/scrobbling marked as irrelevant (no keywords).
2025-06-18 15:57:38 [root] INFO: def parse(): Found 10 links on https://support.last.fm/tag/scrobbling
2025-06-18 15:57:38 [root] INFO: should_process_url: URL https://support.last.fm/t/same-album-listed-three-times/108838 has never been seen before, processing it.
2025-06-18 15:57:38 [root] INFO: should_process_url: URL https://support.last.fm/t/same-album-listed-three-times/108838 has never been seen before, processing it.
2025-06-18 15:57:38 [root] INFO: write_url_to_db(): appended URL 'https://support.last.fm/t/same-album-listed-three-times/108838'
2025-06-18 15:57:38 [root] INFO: def parse(): Crawling next URL: https://support.last.fm/t/same-album-listed-three-times/108838
2025-06-18 15:57:38 [root] INFO: should_process_url: URL https://support.last.fm/u/hjbardenhagen has never been seen before, processing it.
2025-06-18 15:57:38 [root] INFO: parse: Skipping blacklisted URL https://support.last.fm/t/spotify-has-stopped-scrobbling-what-can-i-do/3184.
2025-06-18 15:57:38 [root] INFO: should_process_url: URL https://support.last.fm/u/Everorchid has never been seen before, processing it.
2025-06-18 15:57:38 [root] INFO: should_process_url: URL https://support.last.fm/u/Everorchid has never been seen before, processing it.
2025-06-18 15:57:38 [root] INFO: write_url_to_db(): appended URL 'https://support.last.fm/u/Everorchid'
2025-06-18 15:57:38 [root] INFO: def parse(): Crawling next URL: https://support.last.fm/u/Everorchid
2025-06-18 15:57:38 [root] INFO: parse: Skipping blacklisted URL https://support.last.fm/tag/spotify.
2025-06-18 15:57:38 [root] INFO: should_process_url: URL https://support.last.fm/u/LAST.HQ has never been seen before, processing it.
2025-06-18 15:57:38 [root] INFO: should_process_url: URL https://support.last.fm/u/Maddieman has never been seen before, processing it.
2025-06-18 15:57:38 [root] INFO: should_process_url: URL https://support.last.fm/tag/scrobbling has never been seen before, processing it.
2025-06-18 15:57:38 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <406 https://victoriapridesociety.org/pride-2024/>: HTTP status code is not handled or not allowed
2025-06-18 15:57:38 [root] INFO: def parse(): Found keywords for URL https://latindancecalendar.com/festivals/style/zouk/: ['bachata', 'balboa', 'dance', 'kizomba', 'live music', 'merengue', 'milonga', 'rumba', 'salsa', 'samba', 'semba', 'swing', 'tango', 'urban kiz', 'zouk']
2025-06-18 15:57:38 [root] INFO: def generate_prompt(): Generating prompt for URL: https://latindancecalendar.com/festivals/style/zouk/
2025-06-18 15:57:38 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:57:38 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:57:38 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:57:40 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 15:57:40 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 263048 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 15:57:40 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 15:57:41 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 15:57:41 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 204487 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 15:57:41 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 15:57:41 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://latindancecalendar.com/festivals/style/zouk/
2025-06-18 15:57:41 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/festivals/style/zouk/'
2025-06-18 15:57:41 [root] INFO: def parse(): URL https://latindancecalendar.com/festivals/style/zouk/ marked as irrelevant (LLM negative).
2025-06-18 15:57:41 [root] INFO: def parse(): Found 10 links on https://latindancecalendar.com/festivals/style/zouk/
2025-06-18 15:57:41 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/dialog/send?app_id=321366148277289&link=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fstyle%2Fzouk%2F%3Futm_source%3Dweb_share_fbmessenger&redirect_uri=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fstyle%2Fzouk%2F%3Futm_source%3Dweb_share_fbmessenger'
2025-06-18 15:57:41 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/dialog/send?app_id=321366148277289&link=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fstyle%2Fzouk%2F%3Futm_source%3Dweb_share_fbmessenger&redirect_uri=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fstyle%2Fzouk%2F%3Futm_source%3Dweb_share_fbmessenger
2025-06-18 15:57:41 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fstyle%2Fzouk%2F%3Futm_source%3Dweb_share_fb'
2025-06-18 15:57:41 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fstyle%2Fzouk%2F%3Futm_source%3Dweb_share_fb
2025-06-18 15:57:41 [root] INFO: should_process_url: URL https://latindancecalendar.com/festivals/san-franciscos-hello-bachata-fest/ has never been seen before, processing it.
2025-06-18 15:57:41 [root] INFO: should_process_url: URL https://latindancecalendar.com/festivals/san-franciscos-hello-bachata-fest/ has never been seen before, processing it.
2025-06-18 15:57:41 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/festivals/san-franciscos-hello-bachata-fest/'
2025-06-18 15:57:41 [root] INFO: def parse(): Crawling next URL: https://latindancecalendar.com/festivals/san-franciscos-hello-bachata-fest/
2025-06-18 15:57:41 [root] INFO: should_process_url: URL https://latindancecalendar.com/ was last seen as relevant, processing it.
2025-06-18 15:57:41 [root] INFO: should_process_url: URL https://latindancecalendar.com/ was last seen as relevant, processing it.
2025-06-18 15:57:41 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/'
2025-06-18 15:57:41 [root] INFO: def parse(): Crawling next URL: https://latindancecalendar.com/
2025-06-18 15:57:41 [root] INFO: should_process_url: URL https://closestays.com was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:57:41 [root] INFO: should_process_url: URL https://closestays.com was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:57:41 [root] INFO: write_url_to_db(): appended URL 'https://closestays.com'
2025-06-18 15:57:41 [root] INFO: def parse(): Crawling next URL: https://closestays.com
2025-06-18 15:57:41 [root] INFO: should_process_url: URL https://latindancecalendar.com/festivals/?show=map was last seen as relevant, processing it.
2025-06-18 15:57:41 [root] INFO: should_process_url: URL https://latindancecalendar.com/festivals/?show=map was last seen as relevant, processing it.
2025-06-18 15:57:41 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/festivals/?show=map'
2025-06-18 15:57:41 [root] INFO: def parse(): Crawling next URL: https://latindancecalendar.com/festivals/?show=map
2025-06-18 15:57:41 [root] INFO: should_process_url: URL https://latindancecalendar.com/festivals/style/zouk/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:57:41 [root] INFO: should_process_url: URL https://latindancecalendar.com/festivals/style/zouk/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:57:41 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/festivals/style/zouk/'
2025-06-18 15:57:41 [root] INFO: def parse(): Crawling next URL: https://latindancecalendar.com/festivals/style/zouk/
2025-06-18 15:57:41 [root] INFO: should_process_url: URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fstyle%2Fzouk%2F was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:57:41 [root] INFO: should_process_url: URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fstyle%2Fzouk%2F was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:57:41 [root] INFO: write_url_to_db(): appended URL 'https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fstyle%2Fzouk%2F'
2025-06-18 15:57:41 [root] INFO: def parse(): Crawling next URL: https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fstyle%2Fzouk%2F
2025-06-18 15:57:41 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/home?status=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fstyle%2Fzouk%2F.
2025-06-18 15:57:41 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <404 https://butchartgardens.com/summer-firework-saturdays/>: HTTP status code is not handled or not allowed
2025-06-18 15:57:41 [root] INFO: def parse(): Found keywords for URL https://www.coastaljazz.ca/: ['swing']
2025-06-18 15:57:41 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.coastaljazz.ca/
2025-06-18 15:57:41 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:57:41 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:57:41 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:59:31 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:59:31 [root] INFO: query_llm(): Mistral response received: ```json
[
    {
        "source": "https://www.coastaljazz.ca/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "John Gross Trio",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "18:00",
        "end_time": "null",
        "price": "FREE",
        "location": "",
        "description": "John Gross Trio playing on a boat."
    },
    {
        "source": "https://www.coastaljazz.ca/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Immanuel Wilkins & Lutosławski Quartet",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "19:00",
        "end_time": "null",
        "price": "SOLD OUT",
        "location": "Western Front",
        "description": "Immanuel Wilkins & Lutosławski Quartet live music event."
    },
    {
        "source": "https://www.coastaljazz.ca/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Second Show: Immanuel Wilkins & Lutosławski Quartet",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "21:00",
        "end_time": "null",
        "price": "SOLD OUT",
        "location": "Western Front",
        "description": "Second Show: Immanuel Wilkins & Lutosławski Quartet live music event."
    },
    {
        "source": "https://www.coastaljazz.ca/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Star System Plays Sun Ra",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "20:30",
        "end_time": "null",
        "price": "$15 (At the door)",
        "location": "Ocean Artworks",
        "description": "Star System Plays Sun Ra live music event."
    },
    {
        "source": "https://www.coastaljazz.ca/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Jimi James Fraser Sextet",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "21:30",
        "end_time": "null",
        "price": "$18 advance, $20 at the door",
        "location": "Tyrant Studios",
        "description": "Jimi James Fraser Sextet live music event."
    },
    {
        "source": "https://www.coastaljazz.ca/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "5 Nights in Paradise: Dandelion Records DJ set",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "22:30",
        "end_time": "null",
        "price": "PWYC",
        "location": "Ocean Artworks",
        "description": "5 Nights in Paradise: Dandelion Records DJ set live music event."
    },
    {
        "source": "https://www.coastaljazz.ca/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Open Jazz Jams",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "22:45",
        "end_time": "null",
        "price": "$10 for public, PWYC for jamming musicians",
        "location": "Tyrant Studios",
        "description": "Open Jazz Jams live music event."
    },
    {
        "source": "https://www.coastaljazz.ca/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Amphibioux",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "13:30",
        "end_time": "null",
        "price": "FREE",
        "location": "Downtown – Georgia Street Stage",
        "description": "Amphibioux live music event."
    },
    {
        "source": "https://www.coastaljazz.ca/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Niña Mendoza",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "14:30",
        "end_time": "null",
        "price": "FREE",
        "location": "Downtown – Georgia Street Stage",
        "description": "Niña Mendoza live music event."
    },
    {
        "source": "https://www.coastaljazz.ca/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Feven Kidane Sextet",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "15:15",
        "end_time": "null",
        "price": "FREE",
        "location": "Downtown – Georgia Street Stage",
        "description": "Feven Kidane Sextet live music event."
    },
    {
        "source": "https://www.coastaljazz.ca/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Richard Bona Asante Trio",
        "day_of_week": "Monday",
        "start_date": "2025-06-23",
        "end_date": "2025-06-23",
        "start_time": "19:30",
        "end_time": "null",
        "price": "$50-$75",
        "location": "Vancouver Playhouse",
        "description": "Richard Bona Asante Trio live music event."
    },
    {
        "source": "https://www.coastaljazz.ca/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Marquis Hill: Composers Collective",
        "day_of_week": "Friday",
        "start_date": "2025-06-27",
        "end_date": "2025-06-27",
        "start_time": "19:30",
        "end_time": "null",
        "price": "$44 plus fees",
        "location": "Performance Works",
        "description": "Marquis Hill: Composers Collective live music event."
    },
    {
        "source": "https://www.coastaljazz.ca/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Christine Jensen Quartet",
        "day_of_week": "Sunday",
        "start_date": "2025-06-29",
        "end_date": "2025-06-29",
        "start_time": "19:30",
        "end_time": "null",
        "price": "$34 plus fees",
        "location": "Performance Works",
        "description": "Christine Jensen Quartet live music event."
    }
]
```
2025-06-18 15:59:31 [root] INFO: def extract_and_parse_json(): for url https://www.coastaljazz.ca/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "https://www.coastaljazz.ca/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "John Gross Trio",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "18:00",
        "end_time": "null",
        "price": "FREE",
        "location": "",
        "description": "John Gross Trio playing on a boat."
    },
    {
        "source": "https://www.coastaljazz.ca/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Immanuel Wilkins & Lutosławski Quartet",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "19:00",
        "end_time": "null",
        "price": "SOLD OUT",
        "location": "Western Front",
        "description": "Immanuel Wilkins & Lutosławski Quartet live music event."
    },
    {
        "source": "https://www.coastaljazz.ca/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Second Show: Immanuel Wilkins & Lutosławski Quartet",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "21:00",
        "end_time": "null",
        "price": "SOLD OUT",
        "location": "Western Front",
        "description": "Second Show: Immanuel Wilkins & Lutosławski Quartet live music event."
    },
    {
        "source": "https://www.coastaljazz.ca/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Star System Plays Sun Ra",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "20:30",
        "end_time": "null",
        "price": "$15 (At the door)",
        "location": "Ocean Artworks",
        "description": "Star System Plays Sun Ra live music event."
    },
    {
        "source": "https://www.coastaljazz.ca/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Jimi James Fraser Sextet",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "21:30",
        "end_time": "null",
        "price": "$18 advance, $20 at the door",
        "location": "Tyrant Studios",
        "description": "Jimi James Fraser Sextet live music event."
    },
    {
        "source": "https://www.coastaljazz.ca/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "5 Nights in Paradise: Dandelion Records DJ set",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "22:30",
        "end_time": "null",
        "price": "PWYC",
        "location": "Ocean Artworks",
        "description": "5 Nights in Paradise: Dandelion Records DJ set live music event."
    },
    {
        "source": "https://www.coastaljazz.ca/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Open Jazz Jams",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "22:45",
        "end_time": "null",
        "price": "$10 for public, PWYC for jamming musicians",
        "location": "Tyrant Studios",
        "description": "Open Jazz Jams live music event."
    },
    {
        "source": "https://www.coastaljazz.ca/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Amphibioux",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "13:30",
        "end_time": "null",
        "price": "FREE",
        "location": "Downtown – Georgia Street Stage",
        "description": "Amphibioux live music event."
    },
    {
        "source": "https://www.coastaljazz.ca/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Niña Mendoza",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "14:30",
        "end_time": "null",
        "price": "FREE",
        "location": "Downtown – Georgia Street Stage",
        "description": "Niña Mendoza live music event."
    },
    {
        "source": "https://www.coastaljazz.ca/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Feven Kidane Sextet",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "15:15",
        "end_time": "null",
        "price": "FREE",
        "location": "Downtown – Georgia Street Stage",
        "description": "Feven Kidane Sextet live music event."
    },
    {
        "source": "https://www.coastaljazz.ca/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Richard Bona Asante Trio",
        "day_of_week": "Monday",
        "start_date": "2025-06-23",
        "end_date": "2025-06-23",
        "start_time": "19:30",
        "end_time": "null",
        "price": "$50-$75",
        "location": "Vancouver Playhouse",
        "description": "Richard Bona Asante Trio live music event."
    },
    {
        "source": "https://www.coastaljazz.ca/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Marquis Hill: Composers Collective",
        "day_of_week": "Friday",
        "start_date": "2025-06-27",
        "end_date": "2025-06-27",
        "start_time": "19:30",
        "end_time": "null",
        "price": "$44 plus fees",
        "location": "Performance Works",
        "description": "Marquis Hill: Composers Collective live music event."
    },
    {
        "source": "https://www.coastaljazz.ca/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Christine Jensen Quartet",
        "day_of_week": "Sunday",
        "start_date": "2025-06-29",
        "end_date": "2025-06-29",
        "start_time": "19:30",
        "end_time": "null",
        "price": "$34 plus fees",
        "location": "Performance Works",
        "description": "Christine Jensen Quartet live music event."
    }
]
2025-06-18 15:59:31 [root] INFO: def clean_up_address(): Starting with events_df shape: (13, 14)
2025-06-18 15:59:31 [root] INFO: def clean_up_address(): Processing location 'Western Front' (event_id: None)
2025-06-18 15:59:31 [root] INFO: def clean_up_address(): Processing location 'Western Front' (event_id: None)
2025-06-18 15:59:31 [root] INFO: def clean_up_address(): Processing location 'Ocean Artworks' (event_id: None)
2025-06-18 15:59:31 [root] INFO: def clean_up_address(): Processing location 'Tyrant Studios' (event_id: None)
2025-06-18 15:59:31 [root] INFO: def clean_up_address(): Processing location 'Ocean Artworks' (event_id: None)
2025-06-18 15:59:31 [root] INFO: def clean_up_address(): Processing location 'Tyrant Studios' (event_id: None)
2025-06-18 15:59:31 [root] INFO: def clean_up_address(): Processing location 'Downtown – Georgia Street Stage' (event_id: None)
2025-06-18 15:59:31 [root] INFO: def clean_up_address(): Processing location 'Downtown – Georgia Street Stage' (event_id: None)
2025-06-18 15:59:31 [root] INFO: def clean_up_address(): Processing location 'Downtown – Georgia Street Stage' (event_id: None)
2025-06-18 15:59:31 [root] INFO: def clean_up_address(): Processing location 'Vancouver Playhouse' (event_id: None)
2025-06-18 15:59:31 [root] INFO: def clean_up_address(): Processing location 'Performance Works' (event_id: None)
2025-06-18 15:59:31 [root] INFO: def clean_up_address(): Processing location 'Performance Works' (event_id: None)
2025-06-18 15:59:31 [root] INFO: write_events_to_db: Number of events to write: 13
2025-06-18 15:59:31 [root] INFO: write_url_to_db(): appended URL 'https://www.coastaljazz.ca/'
2025-06-18 15:59:31 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 15:59:31 [root] INFO: def process_llm_response: URL https://www.coastaljazz.ca/ marked as relevant with events written to the database.
2025-06-18 15:59:31 [root] INFO: write_url_to_db(): appended URL 'https://www.coastaljazz.ca/'
2025-06-18 15:59:31 [root] INFO: def parse(): URL https://www.coastaljazz.ca/ marked as relevant (LLM positive).
2025-06-18 15:59:31 [root] INFO: def parse(): Found 10 links on https://www.coastaljazz.ca/
2025-06-18 15:59:31 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/education/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:59:31 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/education/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:59:31 [root] INFO: write_url_to_db(): appended URL 'https://www.coastaljazz.ca/festival/education/'
2025-06-18 15:59:31 [root] INFO: def parse(): Crawling next URL: https://www.coastaljazz.ca/festival/education/
2025-06-18 15:59:31 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/ was last seen as relevant, processing it.
2025-06-18 15:59:31 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/artist-submissions/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:59:31 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/artist-submissions/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:59:31 [root] INFO: write_url_to_db(): appended URL 'https://www.coastaljazz.ca/festival/artist-submissions/'
2025-06-18 15:59:31 [root] INFO: def parse(): Crawling next URL: https://www.coastaljazz.ca/festival/artist-submissions/
2025-06-18 15:59:31 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/festival-guide/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:59:31 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/festival-guide/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:59:31 [root] INFO: write_url_to_db(): appended URL 'https://www.coastaljazz.ca/festival/festival-guide/'
2025-06-18 15:59:31 [root] INFO: def parse(): Crawling next URL: https://www.coastaljazz.ca/festival/festival-guide/
2025-06-18 15:59:31 [root] INFO: should_process_url: URL https://www.coastaljazz.ca was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:59:31 [root] INFO: should_process_url: URL https://www.coastaljazz.ca was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:59:31 [root] INFO: write_url_to_db(): appended URL 'https://www.coastaljazz.ca'
2025-06-18 15:59:31 [root] INFO: def parse(): Crawling next URL: https://www.coastaljazz.ca
2025-06-18 15:59:31 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/ticket-info/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:59:31 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/ticket-info/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:59:31 [root] INFO: write_url_to_db(): appended URL 'https://www.coastaljazz.ca/festival/ticket-info/'
2025-06-18 15:59:31 [root] INFO: def parse(): Crawling next URL: https://www.coastaljazz.ca/festival/ticket-info/
2025-06-18 15:59:31 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/visitor-info/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:59:31 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/visitor-info/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:59:31 [root] INFO: write_url_to_db(): appended URL 'https://www.coastaljazz.ca/festival/visitor-info/'
2025-06-18 15:59:31 [root] INFO: def parse(): Crawling next URL: https://www.coastaljazz.ca/festival/visitor-info/
2025-06-18 15:59:31 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/volunteers/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:59:31 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/volunteers/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:59:31 [root] INFO: write_url_to_db(): appended URL 'https://www.coastaljazz.ca/festival/volunteers/'
2025-06-18 15:59:31 [root] INFO: def parse(): Crawling next URL: https://www.coastaljazz.ca/festival/volunteers/
2025-06-18 15:59:31 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/artist-residency/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:59:31 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/artist-residency/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:59:31 [root] INFO: write_url_to_db(): appended URL 'https://www.coastaljazz.ca/festival/artist-residency/'
2025-06-18 15:59:31 [root] INFO: def parse(): Crawling next URL: https://www.coastaljazz.ca/festival/artist-residency/
2025-06-18 15:59:31 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/partners/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:59:31 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/partners/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:59:31 [root] INFO: write_url_to_db(): appended URL 'https://www.coastaljazz.ca/partners/'
2025-06-18 15:59:31 [root] INFO: def parse(): Crawling next URL: https://www.coastaljazz.ca/partners/
2025-06-18 15:59:31 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/partners/corporate-giving/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:59:31 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/partners/corporate-giving/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 15:59:31 [root] INFO: write_url_to_db(): appended URL 'https://www.coastaljazz.ca/partners/corporate-giving/'
2025-06-18 15:59:31 [root] INFO: def parse(): Crawling next URL: https://www.coastaljazz.ca/partners/corporate-giving/
2025-06-18 15:59:31 [root] INFO: write_url_to_db(): appended URL 'https://www.phillipsbackyard.com/line-up#tilt-lineup'
2025-06-18 15:59:31 [root] INFO: def parse(): URL https://www.phillipsbackyard.com/line-up#tilt-lineup marked as irrelevant (no keywords).
2025-06-18 15:59:31 [root] INFO: def parse(): Found 10 links on https://www.phillipsbackyard.com/line-up
2025-06-18 15:59:31 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-W7ZVB3V, URL: https://www.phillipsbackyard.com/line-up#tilt-lineup, source: Summer Festivals in Victoria, BC | Black Ball Ferry Line, keywords: music festivals
2025-06-18 15:59:31 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 15:59:31 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-W7ZVB3V
2025-06-18 15:59:31 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-W7ZVB3V'
2025-06-18 15:59:31 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/phillips.backyard/'
2025-06-18 15:59:31 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/phillips.backyard/
2025-06-18 15:59:31 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/bandofskullsofficial/'
2025-06-18 15:59:31 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/bandofskullsofficial/
2025-06-18 15:59:31 [root] INFO: write_url_to_db(): appended URL 'http://instagram.com/coldwarkids'
2025-06-18 15:59:31 [root] INFO: def parse(): Recorded unwanted URL: http://instagram.com/coldwarkids
2025-06-18 15:59:31 [root] INFO: should_process_url: URL https://www.coldwarkids.com/ has never been seen before, processing it.
2025-06-18 15:59:31 [root] INFO: should_process_url: URL https://www.coldwarkids.com/ has never been seen before, processing it.
2025-06-18 15:59:31 [root] INFO: write_url_to_db(): appended URL 'https://www.coldwarkids.com/'
2025-06-18 15:59:31 [root] INFO: def parse(): Crawling next URL: https://www.coldwarkids.com/
2025-06-18 15:59:31 [root] INFO: def parse(): Found keywords for URL https://maps.app.goo.gl/viwHWokwUQAMvWjv8: ['dance', 'wcs']
2025-06-18 15:59:31 [root] INFO: def generate_prompt(): Generating prompt for URL: https://maps.app.goo.gl/viwHWokwUQAMvWjv8
2025-06-18 15:59:31 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:59:31 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:59:31 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:59:32 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 15:59:32 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 161358 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 15:59:32 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 15:59:41 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:59:41 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 15:59:41 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 15:59:41 [root] INFO: write_url_to_db(): appended URL 'https://maps.app.goo.gl/viwHWokwUQAMvWjv8'
2025-06-18 15:59:41 [root] INFO: def parse(): URL https://maps.app.goo.gl/viwHWokwUQAMvWjv8 marked as irrelevant (LLM negative).
2025-06-18 15:59:41 [root] INFO: def parse(): Found 1 links on https://www.google.com/maps/reviews/data=!4m8!14m7!1m6!2m5!1sChdDSUhNMG9nS0VJQ0FnSUNsaTQtSzR3RRAB!2m1!1s0x0:0xe37b8863316af9b0!3m1!1s2@1:CIHM0ogKEICAgICli4-K4wE%7CCgwI2PqPqwYQiPLJhgE%7C?hl=en&entry=tts&g_ep=EgoyMDI0MDUxNC4wKgBIAVAD
2025-06-18 15:59:41 [root] INFO: should_process_url: URL https://maps.app.goo.gl/viwHWokwUQAMvWjv8 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:59:41 [root] INFO: parse: Skipping blacklisted URL https://support.google.com/maps/?hl=en&authuser=0&p=no_javascript.
2025-06-18 15:59:41 [root] INFO: write_url_to_db(): appended URL 'https://www.cohoferry.com/packages/victoria/the-butchart-gardens-admission-with-ferry'
2025-06-18 15:59:41 [root] INFO: def parse(): URL https://www.cohoferry.com/packages/victoria/the-butchart-gardens-admission-with-ferry marked as irrelevant (no keywords).
2025-06-18 15:59:41 [root] INFO: def parse(): Found 10 links on https://www.cohoferry.com/packages/victoria/the-butchart-gardens-admission-with-ferry
2025-06-18 15:59:41 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-NBB6WGX, URL: https://www.cohoferry.com/packages/victoria/the-butchart-gardens-admission-with-ferry, source: Summer Festivals in Victoria, BC | Black Ball Ferry Line, keywords: music festivals
2025-06-18 15:59:41 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 15:59:41 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-NBB6WGX
2025-06-18 15:59:41 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-NBB6WGX'
2025-06-18 15:59:41 [root] INFO: write_url_to_db(): appended URL 'http://www.facebook.com/mvcoho'
2025-06-18 15:59:41 [root] INFO: def parse(): Recorded unwanted URL: http://www.facebook.com/mvcoho
2025-06-18 15:59:41 [root] INFO: should_process_url: URL https://shop.blackball.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:59:41 [root] INFO: should_process_url: URL https://www.cohoferry.com/attractions/victoria/afternoon-tea-at-the-butchart-gardens was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:59:41 [root] INFO: should_process_url: URL https://www.cohoferry.com/attractions/victoria/afternoon-tea-at-the-butchart-gardens was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 15:59:41 [root] INFO: write_url_to_db(): appended URL 'https://www.cohoferry.com/attractions/victoria/afternoon-tea-at-the-butchart-gardens'
2025-06-18 15:59:41 [root] INFO: def parse(): Crawling next URL: https://www.cohoferry.com/attractions/victoria/afternoon-tea-at-the-butchart-gardens
2025-06-18 15:59:41 [root] INFO: def parse(): Found keywords for URL https://maps.app.goo.gl/4isdFVGzsJz4UMHX8: ['dance', 'wcs']
2025-06-18 15:59:41 [root] INFO: def generate_prompt(): Generating prompt for URL: https://maps.app.goo.gl/4isdFVGzsJz4UMHX8
2025-06-18 15:59:41 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:59:41 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:59:41 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:59:43 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 15:59:43 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 161539 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 15:59:43 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 15:59:55 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 15:59:55 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 15:59:55 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 15:59:55 [root] INFO: write_url_to_db(): appended URL 'https://maps.app.goo.gl/4isdFVGzsJz4UMHX8'
2025-06-18 15:59:55 [root] INFO: def parse(): URL https://maps.app.goo.gl/4isdFVGzsJz4UMHX8 marked as irrelevant (LLM negative).
2025-06-18 15:59:55 [root] INFO: def parse(): Found 1 links on https://www.google.com/maps/reviews/data=!4m8!14m7!1m6!2m5!1sChdDSUhNMG9nS0VJQ0FnSUNsdlA3c2l3RRAB!2m1!1s0x0:0xe37b8863316af9b0!3m1!1s2@1:CIHM0ogKEICAgIClvP7siwE%7CCgwI5ozPqgYQ-ND6xAE%7C?hl=en&entry=tts&g_ep=EgoyMDI0MDUxNC4wKgBIAVAD
2025-06-18 15:59:55 [root] INFO: parse: Skipping blacklisted URL https://support.google.com/maps/?hl=en&authuser=0&p=no_javascript.
2025-06-18 15:59:55 [root] INFO: should_process_url: URL https://maps.app.goo.gl/4isdFVGzsJz4UMHX8 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 15:59:55 [root] INFO: def parse(): Found keywords for URL https://maps.app.goo.gl/opqbJrqLAZXuaKBG6: ['dance', 'rumba', 'wcs']
2025-06-18 15:59:55 [root] INFO: def generate_prompt(): Generating prompt for URL: https://maps.app.goo.gl/opqbJrqLAZXuaKBG6
2025-06-18 15:59:55 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 15:59:55 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 15:59:55 [root] INFO: query_llm(): Querying Mistral
2025-06-18 15:59:56 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 15:59:56 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 161483 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 15:59:56 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:00:07 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:00:07 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 16:00:07 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 16:00:07 [root] INFO: write_url_to_db(): appended URL 'https://maps.app.goo.gl/opqbJrqLAZXuaKBG6'
2025-06-18 16:00:07 [root] INFO: def parse(): URL https://maps.app.goo.gl/opqbJrqLAZXuaKBG6 marked as irrelevant (LLM negative).
2025-06-18 16:00:07 [root] INFO: def parse(): Found 1 links on https://www.google.com/maps/reviews/data=!4m8!14m7!1m6!2m5!1sChZDSUhNMG9nS0VJQ0FnSUNaN3FhLUlBEAE!2m1!1s0x0:0xe37b8863316af9b0!3m1!1s2@1:CIHM0ogKEICAgICZ7qa-IA%7CCgwI1pj5pwYQ2IuLiQI%7C?hl=en&entry=tts&g_ep=EgoyMDI0MDUxNC4wKgBIAVAD
2025-06-18 16:00:07 [root] INFO: parse: Skipping blacklisted URL https://support.google.com/maps/?hl=en&authuser=0&p=no_javascript.
2025-06-18 16:00:07 [root] INFO: should_process_url: URL https://maps.app.goo.gl/opqbJrqLAZXuaKBG6 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:00:08 [root] INFO: def parse(): Found keywords for URL https://vbds.org/dances/west-coast-swing/: ['cha cha', 'dance', 'foxtrot', 'line dance', 'quickstep', 'rumba', 'samba', 'swing', 'tango', 'waltz', 'west coast swing']
2025-06-18 16:00:08 [root] INFO: def generate_prompt(): Generating prompt for URL: https://vbds.org/dances/west-coast-swing/
2025-06-18 16:00:08 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:00:08 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:00:08 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:00:35 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:00:35 [root] INFO: query_llm(): Mistral response received: [{"source": "html_output", "id": "1", "name": "extract_and_parse_and_validate_json"}]
2025-06-18 16:00:35 [root] INFO: def extract_and_parse_json(): No valid events found in result.
2025-06-18 16:00:35 [root] INFO: write_url_to_db(): appended URL 'https://vbds.org/dances/west-coast-swing/'
2025-06-18 16:00:35 [root] INFO: def parse(): URL https://vbds.org/dances/west-coast-swing/ marked as irrelevant (LLM negative).
2025-06-18 16:00:35 [root] INFO: def parse(): Found 10 links on https://vbds.org/dances/west-coast-swing/
2025-06-18 16:00:35 [root] INFO: should_process_url: URL https://vbds.org/login/ was last seen as relevant, processing it.
2025-06-18 16:00:35 [root] INFO: should_process_url: URL https://vbds.org/login/ was last seen as relevant, processing it.
2025-06-18 16:00:35 [root] INFO: write_url_to_db(): appended URL 'https://vbds.org/login/'
2025-06-18 16:00:35 [root] INFO: def parse(): Crawling next URL: https://vbds.org/login/
2025-06-18 16:00:35 [root] INFO: write_url_to_db(): appended URL 'https://shop.blackball.com/'
2025-06-18 16:00:35 [root] INFO: def parse(): URL https://shop.blackball.com/ marked as irrelevant (no keywords).
2025-06-18 16:00:35 [root] INFO: def parse(): Found 7 links on https://shop.blackball.com/
2025-06-18 16:00:35 [root] INFO: should_process_url: URL https://goo.gl/maps/6sfzmTCG2vLCSHb8A was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:00:35 [root] INFO: should_process_url: URL https://goo.gl/maps/6sfzmTCG2vLCSHb8A was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:00:35 [root] INFO: write_url_to_db(): appended URL 'https://goo.gl/maps/6sfzmTCG2vLCSHb8A'
2025-06-18 16:00:35 [root] INFO: def parse(): Crawling next URL: https://goo.gl/maps/6sfzmTCG2vLCSHb8A
2025-06-18 16:00:35 [root] INFO: def parse(): Found keywords for URL https://northernwilds.com: ['salsa']
2025-06-18 16:00:35 [root] INFO: def generate_prompt(): Generating prompt for URL: https://northernwilds.com
2025-06-18 16:00:35 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:00:35 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:00:35 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:01:12 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:01:12 [root] INFO: query_llm(): Mistral response received: 
<scripttype="text/javascript">
																																																																																																																																																																																																								
2025-06-18 16:01:12 [root] ERROR: def extract_and_parse_json(): couldn't isolate JSON blob in result from https://northernwilds.com
2025-06-18 16:01:12 [root] INFO: write_url_to_db(): appended URL 'https://northernwilds.com'
2025-06-18 16:01:12 [root] INFO: def parse(): URL https://northernwilds.com marked as irrelevant (LLM negative).
2025-06-18 16:01:12 [root] INFO: def parse(): Found 10 links on https://northernwilds.com
2025-06-18 16:01:12 [root] INFO: should_process_url: URL https://statcounter.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:01:12 [root] INFO: should_process_url: URL https://northernwilds.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:01:12 [root] INFO: should_process_url: URL https://northernwilds.com/category/features/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:01:12 [root] INFO: should_process_url: URL https://northernwilds.com/current-issue/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:01:12 [root] INFO: should_process_url: URL https://northernwilds.com/category/arts/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:01:12 [root] INFO: should_process_url: URL https://northernwilds.com/along-the-shore/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:01:12 [root] INFO: should_process_url: URL https://northernwilds.com/food-drink/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:01:12 [root] INFO: should_process_url: URL https://northernwilds.com/advertise-in-northern-minnesota/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:01:12 [root] INFO: should_process_url: URL https://northernwilds.com/about-us/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:01:12 [root] INFO: should_process_url: URL https://northernwilds.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:01:12 [root] INFO: def parse(): Found keywords for URL https://thedukesaloon.com/events/: ['dance']
2025-06-18 16:01:12 [root] INFO: def generate_prompt(): Generating prompt for URL: https://thedukesaloon.com/events/
2025-06-18 16:01:12 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:01:12 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:01:12 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:01:14 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:01:14 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 138548 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 16:01:14 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:02:42 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:02:42 [root] INFO: query_llm(): OpenAI response received: [{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"THROW DOWN THURSDAY VOLUME X","day_of_week":"Thursday","start_date":"2025-05-29","end_date":"2025-05-29","start_time":"19:00","end_time":"23:30","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"THE DUKE SALOON PRESENTS THROW DOWN THURSDAY VOLUME X FEATURING [...]"},{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"BACKCOUNTRY FRIDAYS","day_of_week":"Friday","start_date":"2025-05-30","end_date":"2025-05-31","start_time":"21:00","end_time":"02:00","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"Backcountry Fridays Featuring Whiskey Business Every Friday Doors: 9PM Close:  [...]"},{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"OUTLAW SATURDAYS","day_of_week":"Saturday","start_date":"2025-05-31","end_date":"2025-06-01","start_time":"21:00","end_time":"02:00","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"Outlaw Saturdays Featuring The Tumblin' Dice Every Saturday Doors: 9PM  [...]"},{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"AARON WYLDER","day_of_week":"Friday","start_date":"2025-06-06","end_date":"2025-06-06","start_time":"19:00","end_time":"22:00","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"THE DUKE SALOON & THROWDOWN PRESENT AARON WYLDER WITH THE  [...]"},{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"BACKCOUNTRY FRIDAYS","day_of_week":"Friday","start_date":"2025-06-06","end_date":"2025-06-07","start_time":"21:00","end_time":"02:00","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"Backcountry Fridays Featuring Whiskey Business Every Friday Doors: 9PM Close:  [...]"},{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"OUTLAW SATURDAYS","day_of_week":"Saturday","start_date":"2025-06-07","end_date":"2025-06-08","start_time":"21:00","end_time":"02:00","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"Outlaw Saturdays Featuring The Tumblin' Dice Every Saturday Doors: 9PM  [...]"},{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"BACKCOUNTRY FRIDAYS","day_of_week":"Friday","start_date":"2025-06-13","end_date":"2025-06-14","start_time":"21:00","end_time":"02:00","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"Backcountry Fridays Featuring Whiskey Business Every Friday Doors: 9PM Close:  [...]"},{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"OUTLAW SATURDAYS","day_of_week":"Saturday","start_date":"2025-06-14","end_date":"2025-06-15","start_time":"21:00","end_time":"02:00","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"Outlaw Saturdays Featuring The Tumblin' Dice Every Saturday Doors: 9PM  [...]"},{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"BACKCOUNTRY FRIDAYS","day_of_week":"Friday","start_date":"2025-06-20","end_date":"2025-06-21","start_time":"21:00","end_time":"02:00","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"Backcountry Fridays Featuring Whiskey Business Every Friday Doors: 9PM Close:  [...]"},{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"OUTLAW SATURDAYS","day_of_week":"Saturday","start_date":"2025-06-21","end_date":"2025-06-22","start_time":"21:00","end_time":"02:00","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"Outlaw Saturdays Featuring The Tumblin' Dice Every Saturday Doors: 9PM  [...]"},{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"RUBBER TIRE PEEP SHOW","day_of_week":"Wednesday","start_date":"2025-06-25","end_date":"2025-06-25","start_time":"19:00","end_time":"23:00","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"THE DUKE SALOON PRESENTS RUBBER TIRE PEEP SHOW Wednesday, June  [...]"},{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"BACKCOUNTRY FRIDAYS","day_of_week":"Friday","start_date":"2025-06-27","end_date":"2025-06-28","start_time":"21:00","end_time":"02:00","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"Backcountry Fridays Featuring Whiskey Business Every Friday Doors: 9PM Close:  [...]"},{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"THE HEELS!","day_of_week":"Friday","start_date":"2025-06-27","end_date":"2025-06-28","start_time":"21:00","end_time":"00:00","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"THE DUKE SALOON PRESENTS THE HEELS! Friday, June 27th, 2025  [...]"},{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"OUTLAW SATURDAYS","day_of_week":"Saturday","start_date":"2025-06-28","end_date":"2025-06-29","start_time":"21:00","end_time":"02:00","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"Outlaw Saturdays Featuring The Tumblin' Dice Every Saturday Doors: 9PM  [...]"},{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"BACKCOUNTRY FRIDAYS","day_of_week":"Friday","start_date":"2025-07-04","end_date":"2025-07-05","start_time":"21:00","end_time":"02:00","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"Backcountry Fridays Featuring Whiskey Business Every Friday Doors: 9PM Close:  [...]"},{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"OUTLAW SATURDAYS","day_of_week":"Saturday","start_date":"2025-07-05","end_date":"2025-07-06","start_time":"21:00","end_time":"02:00","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"Outlaw Saturdays Featuring The Tumblin' Dice Every Saturday Doors: 9PM  [...]"}]
2025-06-18 16:02:42 [root] INFO: def extract_and_parse_json(): for url https://thedukesaloon.com/events/, 
Cleaned JSON ready for parsing:
[{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"THROW DOWN THURSDAY VOLUME X","day_of_week":"Thursday","start_date":"2025-05-29","end_date":"2025-05-29","start_time":"19:00","end_time":"23:30","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"THE DUKE SALOON PRESENTS THROW DOWN THURSDAY VOLUME X FEATURING []"},{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"BACKCOUNTRY FRIDAYS","day_of_week":"Friday","start_date":"2025-05-30","end_date":"2025-05-31","start_time":"21:00","end_time":"02:00","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"Backcountry Fridays Featuring Whiskey Business Every Friday Doors: 9PM Close:  []"},{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"OUTLAW SATURDAYS","day_of_week":"Saturday","start_date":"2025-05-31","end_date":"2025-06-01","start_time":"21:00","end_time":"02:00","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"Outlaw Saturdays Featuring The Tumblin' Dice Every Saturday Doors: 9PM  []"},{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"AARON WYLDER","day_of_week":"Friday","start_date":"2025-06-06","end_date":"2025-06-06","start_time":"19:00","end_time":"22:00","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"THE DUKE SALOON & THROWDOWN PRESENT AARON WYLDER WITH THE  []"},{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"BACKCOUNTRY FRIDAYS","day_of_week":"Friday","start_date":"2025-06-06","end_date":"2025-06-07","start_time":"21:00","end_time":"02:00","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"Backcountry Fridays Featuring Whiskey Business Every Friday Doors: 9PM Close:  []"},{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"OUTLAW SATURDAYS","day_of_week":"Saturday","start_date":"2025-06-07","end_date":"2025-06-08","start_time":"21:00","end_time":"02:00","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"Outlaw Saturdays Featuring The Tumblin' Dice Every Saturday Doors: 9PM  []"},{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"BACKCOUNTRY FRIDAYS","day_of_week":"Friday","start_date":"2025-06-13","end_date":"2025-06-14","start_time":"21:00","end_time":"02:00","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"Backcountry Fridays Featuring Whiskey Business Every Friday Doors: 9PM Close:  []"},{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"OUTLAW SATURDAYS","day_of_week":"Saturday","start_date":"2025-06-14","end_date":"2025-06-15","start_time":"21:00","end_time":"02:00","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"Outlaw Saturdays Featuring The Tumblin' Dice Every Saturday Doors: 9PM  []"},{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"BACKCOUNTRY FRIDAYS","day_of_week":"Friday","start_date":"2025-06-20","end_date":"2025-06-21","start_time":"21:00","end_time":"02:00","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"Backcountry Fridays Featuring Whiskey Business Every Friday Doors: 9PM Close:  []"},{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"OUTLAW SATURDAYS","day_of_week":"Saturday","start_date":"2025-06-21","end_date":"2025-06-22","start_time":"21:00","end_time":"02:00","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"Outlaw Saturdays Featuring The Tumblin' Dice Every Saturday Doors: 9PM  []"},{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"RUBBER TIRE PEEP SHOW","day_of_week":"Wednesday","start_date":"2025-06-25","end_date":"2025-06-25","start_time":"19:00","end_time":"23:00","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"THE DUKE SALOON PRESENTS RUBBER TIRE PEEP SHOW Wednesday, June  []"},{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"BACKCOUNTRY FRIDAYS","day_of_week":"Friday","start_date":"2025-06-27","end_date":"2025-06-28","start_time":"21:00","end_time":"02:00","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"Backcountry Fridays Featuring Whiskey Business Every Friday Doors: 9PM Close:  []"},{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"THE HEELS!","day_of_week":"Friday","start_date":"2025-06-27","end_date":"2025-06-28","start_time":"21:00","end_time":"00:00","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"THE DUKE SALOON PRESENTS THE HEELS! Friday, June 27th, 2025  []"},{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"OUTLAW SATURDAYS","day_of_week":"Saturday","start_date":"2025-06-28","end_date":"2025-06-29","start_time":"21:00","end_time":"02:00","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"Outlaw Saturdays Featuring The Tumblin' Dice Every Saturday Doors: 9PM  []"},{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"BACKCOUNTRY FRIDAYS","day_of_week":"Friday","start_date":"2025-07-04","end_date":"2025-07-05","start_time":"21:00","end_time":"02:00","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"Backcountry Fridays Featuring Whiskey Business Every Friday Doors: 9PM Close:  []"},{"source":"thedukesaloon.com","dance_style":"","url":"","event_type":"live music","event_name":"OUTLAW SATURDAYS","day_of_week":"Saturday","start_date":"2025-07-05","end_date":"2025-07-06","start_time":"21:00","end_time":"02:00","price":"","location":"The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8","description":"Outlaw Saturdays Featuring The Tumblin' Dice Every Saturday Doors: 9PM  []"}]
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Starting with events_df shape: (16, 14)
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Processing location 'The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8' (event_id: None)
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Updated event None with address_id 2116 using DB match
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Processing location 'The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8' (event_id: None)
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Updated event None with address_id 2116 using DB match
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Processing location 'The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8' (event_id: None)
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Updated event None with address_id 2116 using DB match
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Processing location 'The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8' (event_id: None)
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Updated event None with address_id 2116 using DB match
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Processing location 'The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8' (event_id: None)
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Updated event None with address_id 2116 using DB match
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Processing location 'The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8' (event_id: None)
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Updated event None with address_id 2116 using DB match
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Processing location 'The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8' (event_id: None)
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Updated event None with address_id 2116 using DB match
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Processing location 'The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8' (event_id: None)
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Updated event None with address_id 2116 using DB match
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Processing location 'The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8' (event_id: None)
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Updated event None with address_id 2116 using DB match
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Processing location 'The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8' (event_id: None)
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Updated event None with address_id 2116 using DB match
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Processing location 'The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8' (event_id: None)
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Updated event None with address_id 2116 using DB match
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Processing location 'The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8' (event_id: None)
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Updated event None with address_id 2116 using DB match
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Processing location 'The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8' (event_id: None)
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Updated event None with address_id 2116 using DB match
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Processing location 'The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8' (event_id: None)
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Updated event None with address_id 2116 using DB match
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Processing location 'The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8' (event_id: None)
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Updated event None with address_id 2116 using DB match
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Processing location 'The Duke Saloon, 502 Discovery Street, Victoria BC V8T 1G8' (event_id: None)
2025-06-18 16:02:42 [root] INFO: def clean_up_address(): Updated event None with address_id 2116 using DB match
2025-06-18 16:02:42 [root] INFO: write_events_to_db: Number of events to write: 16
2025-06-18 16:02:42 [root] INFO: write_url_to_db(): appended URL 'https://thedukesaloon.com/events/'
2025-06-18 16:02:42 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 16:02:42 [root] INFO: def process_llm_response: URL https://thedukesaloon.com/events/ marked as relevant with events written to the database.
2025-06-18 16:02:42 [root] INFO: write_url_to_db(): appended URL 'https://thedukesaloon.com/events/'
2025-06-18 16:02:42 [root] INFO: def parse(): URL https://thedukesaloon.com/events/ marked as relevant (LLM positive).
2025-06-18 16:02:42 [root] INFO: def parse(): Found 10 links on https://thedukesaloon.com/events/
2025-06-18 16:02:42 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/thedukesaloon/'
2025-06-18 16:02:42 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/thedukesaloon/
2025-06-18 16:02:42 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/TheDukeVictoria/'
2025-06-18 16:02:42 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/TheDukeVictoria/
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://thedukesaloon.com/block-party/ was last seen as relevant, processing it.
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://thedukesaloon.com/us/ was last seen as not relevant but hit_ratio (0.33) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://thedukesaloon.com/fundraising/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://thedukesaloon.com/events/ was last seen as relevant, processing it.
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://thedukesaloon.com/ was last seen as relevant, processing it.
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://www.google.ca/maps/dir/''/The+Duke+Saloon/@48.4319416,-123.4380883,12z/data=!3m1!4b1!4m8!4m7!1m0!1m5!1m1!1s0x548f748257cd657d:0x7b34826b02413603!2m2!1d-123.369422!2d48.431962 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://thedukesaloon.com/weekly/ was last seen as relevant, processing it.
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://thedukesaloon.com/gallery/ does not meet criteria for processing, skipping it.
2025-06-18 16:02:42 [root] INFO: def eventbrite_search(): Skipping URL https://thedukesaloon.com/gallery/ based on historical relevancy.
2025-06-18 16:02:42 [scrapy.extensions.logstats] INFO: Crawled 259 pages (at 30 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 16:02:42 [root] INFO: parse: Skipping blacklisted URL https://www.showpass.com/o/phillips-brewery/.
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://www.phillipsbackyard.com/line-up#tilt-lineup was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:02:42 [root] INFO: parse: Skipping blacklisted URL https://open.spotify.com/playlist/0GcfccdHZSUPuand9RudOb?si=9027c6eb21df4352.
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://bandofskulls.shop/ has never been seen before, processing it.
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://bandofskulls.shop/ has never been seen before, processing it.
2025-06-18 16:02:42 [root] INFO: write_url_to_db(): appended URL 'https://bandofskulls.shop/'
2025-06-18 16:02:42 [root] INFO: def parse(): Crawling next URL: https://bandofskulls.shop/
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://www.cohoferry.com/packages/victoria/hotel-grand-pacific-with-ferry was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://www.cohoferry.com/packages/victoria/hotel-grand-pacific-with-ferry was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:02:42 [root] INFO: write_url_to_db(): appended URL 'https://www.cohoferry.com/packages/victoria/hotel-grand-pacific-with-ferry'
2025-06-18 16:02:42 [root] INFO: def parse(): Crawling next URL: https://www.cohoferry.com/packages/victoria/hotel-grand-pacific-with-ferry
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://vbds.org/vbds-practices/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://vbds.org/vbds-practices/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:02:42 [root] INFO: write_url_to_db(): appended URL 'https://vbds.org/vbds-practices/'
2025-06-18 16:02:42 [root] INFO: def parse(): Crawling next URL: https://vbds.org/vbds-practices/
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://shop.blackball.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://goo.gl/maps/JfDSiXsnyoJSJ65s6 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://goo.gl/maps/JfDSiXsnyoJSJ65s6 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:02:42 [root] INFO: write_url_to_db(): appended URL 'https://goo.gl/maps/JfDSiXsnyoJSJ65s6'
2025-06-18 16:02:42 [root] INFO: def parse(): Crawling next URL: https://goo.gl/maps/JfDSiXsnyoJSJ65s6
2025-06-18 16:02:42 [root] INFO: parse: Skipping blacklisted URL https://open.spotify.com/artist/4ddt8PPvmWrI9mJQy1VrIG?si=LBbThIVXR4S62gFBxYzo7g.
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://tickets.butchartgardens.com/webstore/shop/viewItems.aspx?cg=magicxmas&c=xmasadm was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://tickets.butchartgardens.com/webstore/shop/viewItems.aspx?cg=magicxmas&c=xmasadm was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:02:42 [root] INFO: write_url_to_db(): appended URL 'https://tickets.butchartgardens.com/webstore/shop/viewItems.aspx?cg=magicxmas&c=xmasadm'
2025-06-18 16:02:42 [root] INFO: def parse(): Crawling next URL: https://tickets.butchartgardens.com/webstore/shop/viewItems.aspx?cg=magicxmas&c=xmasadm
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://vbds.org/ was last seen as relevant, processing it.
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://vbds.org/ was last seen as relevant, processing it.
2025-06-18 16:02:42 [root] INFO: write_url_to_db(): appended URL 'https://vbds.org/'
2025-06-18 16:02:42 [root] INFO: def parse(): Crawling next URL: https://vbds.org/
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://www.shopify.com?utm_campaign=poweredby&utm_medium=shopify&utm_source=onlinestore was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://shop.blackball.com/collections/collectibles/products/2025-mv-coho-calendar was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://shop.blackball.com/collections/collectibles/products/2025-mv-coho-calendar was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:02:42 [root] INFO: write_url_to_db(): appended URL 'https://shop.blackball.com/collections/collectibles/products/2025-mv-coho-calendar'
2025-06-18 16:02:42 [root] INFO: def parse(): Crawling next URL: https://shop.blackball.com/collections/collectibles/products/2025-mv-coho-calendar
2025-06-18 16:02:42 [root] INFO: should_process_url: URL http://www.thebluefoxcafe.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:02:42 [root] INFO: should_process_url: URL http://www.thebluefoxcafe.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:02:42 [root] INFO: write_url_to_db(): appended URL 'http://www.thebluefoxcafe.com/'
2025-06-18 16:02:42 [root] INFO: def parse(): Crawling next URL: http://www.thebluefoxcafe.com/
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://vbds.org/upcoming-classes-workshops/ was last seen as relevant, processing it.
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://vbds.org/upcoming-classes-workshops/ was last seen as relevant, processing it.
2025-06-18 16:02:42 [root] INFO: write_url_to_db(): appended URL 'https://vbds.org/upcoming-classes-workshops/'
2025-06-18 16:02:42 [root] INFO: def parse(): Crawling next URL: https://vbds.org/upcoming-classes-workshops/
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://www.cohoferry.com/about-us was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://www.cohoferry.com/about-us was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:02:42 [root] INFO: write_url_to_db(): appended URL 'https://www.cohoferry.com/about-us'
2025-06-18 16:02:42 [root] INFO: def parse(): Crawling next URL: https://www.cohoferry.com/about-us
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://app.e2ma.net/app2/audience/signup/2008664/1726574/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://app.e2ma.net/app2/audience/signup/2008664/1726574/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:02:42 [root] INFO: write_url_to_db(): appended URL 'https://app.e2ma.net/app2/audience/signup/2008664/1726574/'
2025-06-18 16:02:42 [root] INFO: def parse(): Crawling next URL: https://app.e2ma.net/app2/audience/signup/2008664/1726574/
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://vbds.org/calendar/ was last seen as relevant, processing it.
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://vbds.org/calendar/ was last seen as relevant, processing it.
2025-06-18 16:02:42 [root] INFO: write_url_to_db(): appended URL 'https://vbds.org/calendar/'
2025-06-18 16:02:42 [root] INFO: def parse(): Crawling next URL: https://vbds.org/calendar/
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://www.cohoferry.com/packages/victoria/macaloneys-island-distillery-and-twa-dogs-brewery-with-ferry was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://www.cohoferry.com/packages/victoria/macaloneys-island-distillery-and-twa-dogs-brewery-with-ferry was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:02:42 [root] INFO: write_url_to_db(): appended URL 'https://www.cohoferry.com/packages/victoria/macaloneys-island-distillery-and-twa-dogs-brewery-with-ferry'
2025-06-18 16:02:42 [root] INFO: def parse(): Crawling next URL: https://www.cohoferry.com/packages/victoria/macaloneys-island-distillery-and-twa-dogs-brewery-with-ferry
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://vbds.org/dances/west-coast-swing/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://vbds.org/dances/west-coast-swing/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:02:42 [root] INFO: write_url_to_db(): appended URL 'https://vbds.org/dances/west-coast-swing/'
2025-06-18 16:02:42 [root] INFO: def parse(): Crawling next URL: https://vbds.org/dances/west-coast-swing/
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://www.butchartgardens.com/pet-policy/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://www.butchartgardens.com/pet-policy/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:02:42 [root] INFO: write_url_to_db(): appended URL 'https://www.butchartgardens.com/pet-policy/'
2025-06-18 16:02:42 [root] INFO: def parse(): Crawling next URL: https://www.butchartgardens.com/pet-policy/
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://vbds.org/members/ was last seen as relevant, processing it.
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://vbds.org/members/ was last seen as relevant, processing it.
2025-06-18 16:02:42 [root] INFO: write_url_to_db(): appended URL 'https://vbds.org/members/'
2025-06-18 16:02:42 [root] INFO: def parse(): Crawling next URL: https://vbds.org/members/
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://vbds.org/introduction-to-ballroom-dancing/ was last seen as relevant, processing it.
2025-06-18 16:02:42 [root] INFO: should_process_url: URL https://vbds.org/introduction-to-ballroom-dancing/ was last seen as relevant, processing it.
2025-06-18 16:02:42 [root] INFO: write_url_to_db(): appended URL 'https://vbds.org/introduction-to-ballroom-dancing/'
2025-06-18 16:02:42 [root] INFO: def parse(): Crawling next URL: https://vbds.org/introduction-to-ballroom-dancing/
2025-06-18 16:02:43 [root] INFO: def parse(): Found keywords for URL https://www.facebook.com/groups/victoriawesties/: ['dance', 'swing', 'wcs', 'west coast swing']
2025-06-18 16:02:43 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.facebook.com/groups/victoriawesties/
2025-06-18 16:02:43 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:02:43 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:02:43 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:02:46 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:02:46 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 595202 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 16:02:46 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:02:47 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:02:47 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 448035 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 16:02:47 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 16:02:47 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://www.facebook.com/groups/victoriawesties/
2025-06-18 16:02:47 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/victoriawesties/'
2025-06-18 16:02:47 [root] INFO: def parse(): URL https://www.facebook.com/groups/victoriawesties/ marked as irrelevant (LLM negative).
2025-06-18 16:02:47 [root] INFO: def parse(): Found 0 links on https://www.facebook.com/groups/victoriawesties/
2025-06-18 16:02:47 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/victoriawesties/'
2025-06-18 16:02:47 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/groups/victoriawesties/
2025-06-18 16:02:47 [root] INFO: def parse(): Found keywords for URL https://sipmagazine.com/beer/: ['dance', 'live music', 'rumba']
2025-06-18 16:02:47 [root] INFO: def generate_prompt(): Generating prompt for URL: https://sipmagazine.com/beer/
2025-06-18 16:02:47 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:02:47 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:02:47 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:02:49 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:02:49 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 227708 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 16:02:49 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:04:00 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:04:00 [root] INFO: query_llm(): OpenAI response received: [{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Summer Terrace Series",
    "day_of_week": "Monday",
    "start_date": "2025-06-16",
    "end_date": "2025-06-16",
    "start_time": "16:00",
    "end_time": "19:00",
    "price": "Free",
    "location": "Fielding Hills Winery, 565 S Lakeshore DR, Chelan, WA 98816",
    "description": "Every Saturday in July and August from 4 - 7pm, spend a relaxing evening listening to talented local musicians on our terrace. Evenings will include a menu of glass pours, ..."
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Celebrate Walla Walla Summer Supper",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-20",
    "start_time": "17:30",
    "end_time": "20:00",
    "price": "$100",
    "location": "Echolands, 3281 Mill Creek Rd, Walla Walla, WA 99362",
    "description": "Enjoy a BBQ-inspired summer menu, paired with approachable wines, and community vibes at this relaxed vineyard dinner. Station-style dining and a wide range of wines highlight the Valley’s versatility."
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Pizza Pop Up at Dineen Vineyards",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "12:00",
    "end_time": "17:00",
    "price": "",
    "location": "Dineen Vineyards, 2980 Gilbert Road, Zillah, WA 98953",
    "description": "Join us for Pizza Days at Dineen Vineyards. On selected weekends, Chef Jacob will be on site making hand-thrown pizzas crafted with the freshest local ingredients!"
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Celebrate Walla Walla Block Party",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "14:00",
    "end_time": "17:00",
    "price": "",
    "location": "The Motor Co., 64 E. Rose Street, Walla Walla, WA 99362",
    "description": "Experience the Valley’s energy downtown! This vibrant event includes tastings from 50+ wineries, local cuisine, live music, and a bottle shop so you can take your favorites home."
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Wines in the Vines Vineyard Tour at Dineen Vineyards",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "14:00",
    "end_time": "16:00",
    "price": "$60",
    "location": "Dineen Vineyards, 2980 Gilbert Road, Zillah, WA 98953",
    "description": "Join Dineen Vineyards for a “Wines in the Vines” experience! Every year we select different wines and choose a new path through the vineyard to share with our guests."
}]
2025-06-18 16:04:00 [root] INFO: def extract_and_parse_json(): for url https://sipmagazine.com/beer/, 
Cleaned JSON ready for parsing:
[{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Summer Terrace Series",
    "day_of_week": "Monday",
    "start_date": "2025-06-16",
    "end_date": "2025-06-16",
    "start_time": "16:00",
    "end_time": "19:00",
    "price": "Free",
    "location": "Fielding Hills Winery, 565 S Lakeshore DR, Chelan, WA 98816",
    "description": "Every Saturday in July and August from 4 - 7pm, spend a relaxing evening listening to talented local musicians on our terrace. Evenings will include a menu of glass pours, "
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Celebrate Walla Walla Summer Supper",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-20",
    "start_time": "17:30",
    "end_time": "20:00",
    "price": "$100",
    "location": "Echolands, 3281 Mill Creek Rd, Walla Walla, WA 99362",
    "description": "Enjoy a BBQ-inspired summer menu, paired with approachable wines, and community vibes at this relaxed vineyard dinner. Station-style dining and a wide range of wines highlight the Valley’s versatility."
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Pizza Pop Up at Dineen Vineyards",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "12:00",
    "end_time": "17:00",
    "price": "",
    "location": "Dineen Vineyards, 2980 Gilbert Road, Zillah, WA 98953",
    "description": "Join us for Pizza Days at Dineen Vineyards. On selected weekends, Chef Jacob will be on site making hand-thrown pizzas crafted with the freshest local ingredients!"
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Celebrate Walla Walla Block Party",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "14:00",
    "end_time": "17:00",
    "price": "",
    "location": "The Motor Co., 64 E. Rose Street, Walla Walla, WA 99362",
    "description": "Experience the Valley’s energy downtown! This vibrant event includes tastings from 50+ wineries, local cuisine, live music, and a bottle shop so you can take your favorites home."
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Wines in the Vines Vineyard Tour at Dineen Vineyards",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "14:00",
    "end_time": "16:00",
    "price": "$60",
    "location": "Dineen Vineyards, 2980 Gilbert Road, Zillah, WA 98953",
    "description": "Join Dineen Vineyards for a “Wines in the Vines” experience! Every year we select different wines and choose a new path through the vineyard to share with our guests."
}]
2025-06-18 16:04:00 [root] INFO: def clean_up_address(): Starting with events_df shape: (5, 14)
2025-06-18 16:04:00 [root] INFO: def clean_up_address(): Processing location 'Fielding Hills Winery, 565 S Lakeshore DR, Chelan, WA 98816' (event_id: None)
2025-06-18 16:04:00 [root] INFO: def clean_up_address(): Processing location 'Echolands, 3281 Mill Creek Rd, Walla Walla, WA 99362' (event_id: None)
2025-06-18 16:04:00 [root] INFO: def clean_up_address(): Processing location 'Dineen Vineyards, 2980 Gilbert Road, Zillah, WA 98953' (event_id: None)
2025-06-18 16:04:00 [root] INFO: def clean_up_address(): Processing location 'The Motor Co., 64 E. Rose Street, Walla Walla, WA 99362' (event_id: None)
2025-06-18 16:04:00 [root] INFO: def clean_up_address(): Processing location 'Dineen Vineyards, 2980 Gilbert Road, Zillah, WA 98953' (event_id: None)
2025-06-18 16:04:00 [root] INFO: write_events_to_db: Number of events to write: 5
2025-06-18 16:04:00 [root] INFO: write_url_to_db(): appended URL 'https://sipmagazine.com/beer/'
2025-06-18 16:04:00 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 16:04:00 [root] INFO: def process_llm_response: URL https://sipmagazine.com/beer/ marked as relevant with events written to the database.
2025-06-18 16:04:00 [root] INFO: write_url_to_db(): appended URL 'https://sipmagazine.com/beer/'
2025-06-18 16:04:00 [root] INFO: def parse(): URL https://sipmagazine.com/beer/ marked as relevant (LLM positive).
2025-06-18 16:04:00 [root] INFO: def parse(): Found 10 links on https://sipmagazine.com/beer/
2025-06-18 16:04:00 [root] INFO: should_process_url: URL https://sipmagazine.com/travel/ has never been seen before, processing it.
2025-06-18 16:04:00 [root] INFO: should_process_url: URL https://sipmagazine.com/spirits/ has never been seen before, processing it.
2025-06-18 16:04:00 [root] INFO: should_process_url: URL https://sipmagazine.com/shopping/ has never been seen before, processing it.
2025-06-18 16:04:00 [root] INFO: should_process_url: URL https://sipmagazine.com/beer/ has never been seen before, processing it.
2025-06-18 16:04:00 [root] INFO: should_process_url: URL https://sipmagazine.com/events/ has never been seen before, processing it.
2025-06-18 16:04:00 [root] INFO: should_process_url: URL https://sipmagazine.com/cider/ has never been seen before, processing it.
2025-06-18 16:04:00 [root] INFO: should_process_url: URL https://sipmagazine.com/ has never been seen before, processing it.
2025-06-18 16:04:00 [root] INFO: should_process_url: URL https://sipmagazine.com/news/ has never been seen before, processing it.
2025-06-18 16:04:00 [root] INFO: should_process_url: URL https://sipmagazine.com/wine/ has never been seen before, processing it.
2025-06-18 16:04:00 [root] INFO: should_process_url: URL https://sipmagazine.com/recipes/ has never been seen before, processing it.
2025-06-18 16:04:00 [root] INFO: def parse(): Found keywords for URL https://www.irishtimespub.ca/drinkmenu: ['samba', 'wcs']
2025-06-18 16:04:00 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.irishtimespub.ca/drinkmenu
2025-06-18 16:04:00 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:04:00 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:04:00 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:04:03 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:04:03 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 342220 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 16:04:03 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:04:04 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:04:04 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 257611 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 16:04:04 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 16:04:04 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://www.irishtimespub.ca/drinkmenu
2025-06-18 16:04:04 [root] INFO: write_url_to_db(): appended URL 'https://www.irishtimespub.ca/drinkmenu'
2025-06-18 16:04:04 [root] INFO: def parse(): URL https://www.irishtimespub.ca/drinkmenu marked as irrelevant (LLM negative).
2025-06-18 16:04:04 [root] INFO: def parse(): Found 10 links on https://www.irishtimespub.ca/drinkmenu
2025-06-18 16:04:04 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/pg/irishtimespubbc/about/?ref=page_internal'
2025-06-18 16:04:04 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/pg/irishtimespubbc/about/?ref=page_internal
2025-06-18 16:04:04 [root] INFO: write_url_to_db(): appended URL 'https://instagram.com/irishtimespub'
2025-06-18 16:04:04 [root] INFO: def parse(): Recorded unwanted URL: https://instagram.com/irishtimespub
2025-06-18 16:04:04 [root] INFO: should_process_url: URL https://www.tripadvisor.ca/Restaurant_Review-g154945-d785052-Reviews-Irish_Times_Pub-Victoria_Victoria_Capital_Regional_District_Vancouver_Island_Briti.html was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:04:04 [root] INFO: should_process_url: URL https://www.opentable.ca/r/irish-times-pub-reservations-victoria?restref=37471&lang=en-CA&ot_source=Restaurant%20website was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:04:04 [root] INFO: should_process_url: URL https://www.irishtimespub.ca/about-us was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:04:04 [root] INFO: parse: Skipping blacklisted URL https://www.google.com/maps/place/1200+Government+St,+Victoria,+BC+V8W+1Y3/@48.4258565,-123.3701391,17z/data=!3m1!4b1!4m5!3m4!1s0x548f749adb714eff:0x803f326e036f01c4!8m2!3d48.4258565!4d-123.3679504.
2025-06-18 16:04:04 [root] INFO: should_process_url: URL https://www.irishtimespub.ca/drinkmenu was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:04:04 [root] INFO: should_process_url: URL https://www.irishtimespub.ca/food was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:04:04 [root] INFO: should_process_url: URL https://www.irishtimespub.ca was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:04:05 [root] INFO: write_url_to_db(): appended URL 'https://sipmagazine.com/'
2025-06-18 16:04:05 [root] INFO: def parse(): URL https://sipmagazine.com/ marked as irrelevant (no keywords).
2025-06-18 16:04:05 [root] INFO: def parse(): Found 10 links on https://sipmagazine.com/
2025-06-18 16:04:05 [root] INFO: should_process_url: URL https://sipmagazine.com/travel/ has never been seen before, processing it.
2025-06-18 16:04:05 [root] INFO: should_process_url: URL https://sipmagazine.com/spirits/ has never been seen before, processing it.
2025-06-18 16:04:05 [root] INFO: should_process_url: URL https://sipmagazine.com/shopping/ has never been seen before, processing it.
2025-06-18 16:04:05 [root] INFO: should_process_url: URL https://sipmagazine.com/events/ has never been seen before, processing it.
2025-06-18 16:04:05 [root] INFO: should_process_url: URL https://sipmagazine.com/cider/ has never been seen before, processing it.
2025-06-18 16:04:05 [root] INFO: should_process_url: URL https://sipmagazine.com/ has never been seen before, processing it.
2025-06-18 16:04:05 [root] INFO: should_process_url: URL https://sipmagazine.com/news/ has never been seen before, processing it.
2025-06-18 16:04:05 [root] INFO: should_process_url: URL https://sipmagazine.com/wine/ has never been seen before, processing it.
2025-06-18 16:04:05 [root] INFO: should_process_url: URL https://sipmagazine.com/beer/ has never been seen before, processing it.
2025-06-18 16:04:05 [root] INFO: should_process_url: URL https://sipmagazine.com/recipes/ has never been seen before, processing it.
2025-06-18 16:04:05 [root] INFO: def parse(): Found keywords for URL https://www.pgmusic.com/addons.styles.php: ['bachata', 'dance', 'foxtrot', 'line dance', 'merengue', 'rumba', 'salsa', 'samba', 'swing', 'tango', 'waltz', 'zouk']
2025-06-18 16:04:05 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.pgmusic.com/addons.styles.php
2025-06-18 16:04:05 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:04:05 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:04:05 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:04:06 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:04:06 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 149178 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 16:04:06 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:04:15 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:04:15 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 16:04:15 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 16:04:15 [root] INFO: write_url_to_db(): appended URL 'https://www.pgmusic.com/addons.styles.php'
2025-06-18 16:04:15 [root] INFO: def parse(): URL https://www.pgmusic.com/addons.styles.php marked as irrelevant (LLM negative).
2025-06-18 16:04:15 [root] INFO: def parse(): Found 6 links on https://www.pgmusic.com/addons.styles.php
2025-06-18 16:04:15 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/pages/Band-in-a-Box-by-PG-Music/99580673800'
2025-06-18 16:04:15 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/pages/Band-in-a-Box-by-PG-Music/99580673800
2025-06-18 16:04:15 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/bandinabox_pg_music/'
2025-06-18 16:04:15 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/bandinabox_pg_music/
2025-06-18 16:04:15 [root] INFO: should_process_url: URL https://www.pgmusic.com/bbwin.packages.htm was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:04:15 [root] INFO: should_process_url: URL https://www.pgmusic.com/bbwin.packages.htm was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:04:15 [root] INFO: write_url_to_db(): appended URL 'https://www.pgmusic.com/bbwin.packages.htm'
2025-06-18 16:04:15 [root] INFO: def parse(): Crawling next URL: https://www.pgmusic.com/bbwin.packages.htm
2025-06-18 16:04:15 [root] INFO: def parse(): Found keywords for URL https://www.eventbrite.com/d/wa--bellingham/arts--events--today/: ['dance']
2025-06-18 16:04:15 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.eventbrite.com/d/wa--bellingham/arts--events--today/
2025-06-18 16:04:15 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:04:15 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:04:15 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:04:17 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:04:17 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 174614 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 16:04:17 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:04:32 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:04:32 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 16:04:32 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 16:04:32 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/d/wa--bellingham/arts--events--today/'
2025-06-18 16:04:32 [root] INFO: def parse(): URL https://www.eventbrite.com/d/wa--bellingham/arts--events--today/ marked as irrelevant (LLM negative).
2025-06-18 16:04:32 [root] INFO: def parse(): Found 10 links on https://www.eventbrite.com/d/wa--bellingham/arts--events--today/
2025-06-18 16:04:32 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ, URL: https://www.eventbrite.com/d/wa--bellingham/arts--events--today/, source: Best Arts Events Today in Bellingham, WA | Eventbrite, keywords: zouk
2025-06-18 16:04:32 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 16:04:32 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ
2025-06-18 16:04:32 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ'
2025-06-18 16:04:32 [root] INFO: should_process_url: URL https://www.eventbrite.com/d/wa--bellingham/arts--events--today/ has never been seen before, processing it.
2025-06-18 16:04:32 [root] INFO: should_process_url: URL https://www.eventbrite.com/d/wa--bellingham/arts--events--today/ has never been seen before, processing it.
2025-06-18 16:04:32 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/d/wa--bellingham/arts--events--today/'
2025-06-18 16:04:32 [root] INFO: def parse(): Crawling next URL: https://www.eventbrite.com/d/wa--bellingham/arts--events--today/
2025-06-18 16:04:32 [root] INFO: should_process_url: URL https://www.cohoferry.com/packages/victoria/the-butchart-gardens-admission-with-ferry was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:04:32 [scrapy.extensions.logstats] INFO: Crawled 259 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 16:04:32 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/user/pgmusicinc.
2025-06-18 16:04:32 [root] INFO: should_process_url: URL https://www.pgmusic.com/addons.styles.php was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:04:32 [root] INFO: should_process_url: URL https://www.pgmusic.com/addons.styles.php was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:04:32 [root] INFO: write_url_to_db(): appended URL 'https://www.pgmusic.com/addons.styles.php'
2025-06-18 16:04:32 [root] INFO: def parse(): Crawling next URL: https://www.pgmusic.com/addons.styles.php
2025-06-18 16:04:32 [root] INFO: should_process_url: URL https://www.eventbrite.com/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:04:32 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/signup/?referrer=%2Fmytickets was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:04:32 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/sell-tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:04:32 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/event-marketing-platform/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:04:32 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/event-payment/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:04:32 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/signup/?referrer=%2Fd%2Fwa--bellingham%2Farts--events--today%2F has never been seen before, processing it.
2025-06-18 16:04:32 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/signup/?referrer=%2Fd%2Fwa--bellingham%2Farts--events--today%2F has never been seen before, processing it.
2025-06-18 16:04:32 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/signin/signup/?referrer=%2Fd%2Fwa--bellingham%2Farts--events--today%2F'
2025-06-18 16:04:32 [root] INFO: def parse(): Crawling next URL: https://www.eventbrite.com/signin/signup/?referrer=%2Fd%2Fwa--bellingham%2Farts--events--today%2F
2025-06-18 16:04:32 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <400 https://x.com/lastfm>: HTTP status code is not handled or not allowed
2025-06-18 16:04:32 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/BandinaBox.
2025-06-18 16:04:32 [root] INFO: should_process_url: URL https://www.pgmusic.com/ has never been seen before, processing it.
2025-06-18 16:04:32 [root] INFO: should_process_url: URL https://www.pgmusic.com/ has never been seen before, processing it.
2025-06-18 16:04:32 [root] INFO: write_url_to_db(): appended URL 'https://www.pgmusic.com/'
2025-06-18 16:04:32 [root] INFO: def parse(): Crawling next URL: https://www.pgmusic.com/
2025-06-18 16:04:32 [root] INFO: should_process_url: URL https://www.eventbrite.com/d/local/events/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:04:32 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/?referrer=%2Fd%2Fwa--bellingham%2Farts--events--today%2F has never been seen before, processing it.
2025-06-18 16:04:32 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/?referrer=%2Fd%2Fwa--bellingham%2Farts--events--today%2F has never been seen before, processing it.
2025-06-18 16:04:32 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/signin/?referrer=%2Fd%2Fwa--bellingham%2Farts--events--today%2F'
2025-06-18 16:04:32 [root] INFO: def parse(): Crawling next URL: https://www.eventbrite.com/signin/?referrer=%2Fd%2Fwa--bellingham%2Farts--events--today%2F
2025-06-18 16:04:32 [root] INFO: should_process_url: URL https://www.eventbrite.com/organizer/features/eventbrite-ads/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:04:32 [root] INFO: def parse(): Found keywords for URL https://latindancecalendar.com/festivals/san-franciscos-hello-bachata-fest/: ['bachata', 'dance', 'kizomba', 'salsa', 'zouk']
2025-06-18 16:04:32 [root] INFO: def generate_prompt(): Generating prompt for URL: https://latindancecalendar.com/festivals/san-franciscos-hello-bachata-fest/
2025-06-18 16:04:32 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:04:32 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:04:32 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:04:34 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:04:34 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 145376 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 16:04:34 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:04:58 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:04:58 [root] INFO: query_llm(): OpenAI response received: [{"source":"Latin Dance Calendar","dance_style":"bachata, salsa, zouk, kizomba","url":"","event_type":"other","event_name":"San Francisco’s Hello! Bachata/Salsa/Zouk/Kizomba Dance Festival","day_of_week":"Friday","start_date":"2025-07-25","end_date":"2025-07-25","start_time":"","end_time":"","price":"","location":"San Francisco, USA","description":"Hello Bachata & Kizomba are bringing the best Bachata artists to dancers to the beautiful city of San Francisco."}]
2025-06-18 16:04:58 [root] INFO: def extract_and_parse_json(): for url https://latindancecalendar.com/festivals/san-franciscos-hello-bachata-fest/, 
Cleaned JSON ready for parsing:
[{"source":"Latin Dance Calendar","dance_style":"bachata, salsa, zouk, kizomba","url":"","event_type":"other","event_name":"San Francisco’s Hello! Bachata/Salsa/Zouk/Kizomba Dance Festival","day_of_week":"Friday","start_date":"2025-07-25","end_date":"2025-07-25","start_time":"","end_time":"","price":"","location":"San Francisco, USA","description":"Hello Bachata & Kizomba are bringing the best Bachata artists to dancers to the beautiful city of San Francisco."}]
2025-06-18 16:04:58 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 16:04:58 [root] INFO: def clean_up_address(): Processing location 'San Francisco, USA' (event_id: None)
2025-06-18 16:04:58 [root] INFO: write_events_to_db: Number of events to write: 1
2025-06-18 16:04:58 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/festivals/san-franciscos-hello-bachata-fest/'
2025-06-18 16:04:58 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 16:04:58 [root] INFO: def process_llm_response: URL https://latindancecalendar.com/festivals/san-franciscos-hello-bachata-fest/ marked as relevant with events written to the database.
2025-06-18 16:04:58 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/festivals/san-franciscos-hello-bachata-fest/'
2025-06-18 16:04:58 [root] INFO: def parse(): URL https://latindancecalendar.com/festivals/san-franciscos-hello-bachata-fest/ marked as relevant (LLM positive).
2025-06-18 16:04:58 [root] INFO: def parse(): Found 10 links on https://latindancecalendar.com/festivals/san-franciscos-hello-bachata-fest/
2025-06-18 16:04:58 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.stay22.com/embed/gm?aid=latindancecalendar&maincolor=FFFFFF&adults=1&showothers=true&checkin=2025-07-25&checkout=2025-07-26&markerimage=https%3A%2F%2Flatindancecalendar.com%2Fdancecal%2Fwp-content%2Fuploads%2Fhttps___cdn.evbuc_.com_images_799991839_1505498763703_1_original-350x350.jpeg&lat=37.59399&lng=-122.36442&campaign=festival116240&campaign=festivalPageGPS, URL: https://latindancecalendar.com/festivals/san-franciscos-hello-bachata-fest/, source: Zouk Dancing Festivals Worldwide (Updated 2025), keywords: zouk
2025-06-18 16:04:58 [root] WARNING: def decode_calendar_id(): Exception for https://www.stay22.com/embed/gm?aid=latindancecalendar&maincolor=FFFFFF&adults=1&showothers=true&checkin=2025-07-25&checkout=2025-07-26&markerimage=https%3A%2F%2Flatindancecalendar.com%2Fdancecal%2Fwp-content%2Fuploads%2Fhttps___cdn.evbuc_.com_images_799991839_1505498763703_1_original-350x350.jpeg&lat=37.59399&lng=-122.36442&campaign=festival116240&campaign=festivalPageGPS - Incorrect padding
2025-06-18 16:04:58 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.stay22.com/embed/gm?aid=latindancecalendar&maincolor=FFFFFF&adults=1&showothers=true&checkin=2025-07-25&checkout=2025-07-26&markerimage=https%3A%2F%2Flatindancecalendar.com%2Fdancecal%2Fwp-content%2Fuploads%2Fhttps___cdn.evbuc_.com_images_799991839_1505498763703_1_original-350x350.jpeg&lat=37.59399&lng=-122.36442&campaign=festival116240&campaign=festivalPageGPS
2025-06-18 16:04:58 [root] INFO: write_url_to_db(): appended URL 'https://www.stay22.com/embed/gm?aid=latindancecalendar&maincolor=FFFFFF&adults=1&showothers=true&checkin=2025-07-25&checkout=2025-07-26&markerimage=https%3A%2F%2Flatindancecalendar.com%2Fdancecal%2Fwp-content%2Fuploads%2Fhttps___cdn.evbuc_.com_images_799991839_1505498763703_1_original-350x350.jpeg&lat=37.59399&lng=-122.36442&campaign=festival116240&campaign=festivalPageGPS'
2025-06-18 16:04:58 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/dialog/send?app_id=321366148277289&link=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fsan-franciscos-hello-bachata-fest%2F%3Futm_source%3Dweb_share_fbmessenger&redirect_uri=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fsan-franciscos-hello-bachata-fest%2F%3Futm_source%3Dweb_share_fbmessenger'
2025-06-18 16:04:58 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/dialog/send?app_id=321366148277289&link=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fsan-franciscos-hello-bachata-fest%2F%3Futm_source%3Dweb_share_fbmessenger&redirect_uri=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fsan-franciscos-hello-bachata-fest%2F%3Futm_source%3Dweb_share_fbmessenger
2025-06-18 16:04:58 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fsan-franciscos-hello-bachata-fest%2F%3Futm_source%3Dweb_share_fb'
2025-06-18 16:04:58 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fsan-franciscos-hello-bachata-fest%2F%3Futm_source%3Dweb_share_fb
2025-06-18 16:04:58 [root] INFO: should_process_url: URL https://latindancecalendar.com/festivals/san-franciscos-hello-bachata-fest/ has never been seen before, processing it.
2025-06-18 16:04:58 [root] INFO: should_process_url: URL https://latindancecalendar.com/ was last seen as relevant, processing it.
2025-06-18 16:04:58 [root] INFO: should_process_url: URL https://closestays.com was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:04:58 [root] INFO: should_process_url: URL https://latindancecalendar.com/hello-bachata-festival/ has never been seen before, processing it.
2025-06-18 16:04:58 [root] INFO: should_process_url: URL https://latindancecalendar.com/hello-bachata-festival/ has never been seen before, processing it.
2025-06-18 16:04:58 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/hello-bachata-festival/'
2025-06-18 16:04:58 [root] INFO: def parse(): Crawling next URL: https://latindancecalendar.com/hello-bachata-festival/
2025-06-18 16:04:58 [root] INFO: def parse(): Found keywords for URL https://latindancecalendar.com/: ['bachata', 'dance', 'kizomba', 'salsa', 'zouk']
2025-06-18 16:04:58 [root] INFO: def generate_prompt(): Generating prompt for URL: https://latindancecalendar.com/
2025-06-18 16:04:58 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:04:58 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:04:58 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:04:59 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:04:59 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 162065 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 16:04:59 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:05:28 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:05:28 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 16:05:28 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 16:05:28 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/'
2025-06-18 16:05:28 [root] INFO: def parse(): URL https://latindancecalendar.com/ marked as irrelevant (LLM negative).
2025-06-18 16:05:28 [root] INFO: def parse(): Found 10 links on https://latindancecalendar.com/
2025-06-18 16:05:28 [root] INFO: should_process_url: URL https://latindancecalendar.com/festivals/xlb-festival/ has never been seen before, processing it.
2025-06-18 16:05:28 [root] INFO: should_process_url: URL https://latindancecalendar.com/festivals/xlb-festival/ has never been seen before, processing it.
2025-06-18 16:05:28 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/festivals/xlb-festival/'
2025-06-18 16:05:28 [root] INFO: def parse(): Crawling next URL: https://latindancecalendar.com/festivals/xlb-festival/
2025-06-18 16:05:28 [root] INFO: def parse(): Found keywords for URL https://northernwilds.com/food-drink/: ['salsa']
2025-06-18 16:05:28 [root] INFO: def generate_prompt(): Generating prompt for URL: https://northernwilds.com/food-drink/
2025-06-18 16:05:28 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:05:28 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:05:28 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:05:52 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:05:52 [root] INFO: query_llm(): Mistral response received: 
Noevents found.
2025-06-18 16:05:52 [root] INFO: def extract_and_parse_json(): No valid events found in result.
2025-06-18 16:05:52 [root] INFO: write_url_to_db(): appended URL 'https://northernwilds.com/food-drink/'
2025-06-18 16:05:52 [root] INFO: def parse(): URL https://northernwilds.com/food-drink/ marked as irrelevant (LLM negative).
2025-06-18 16:05:52 [root] INFO: def parse(): Found 10 links on https://northernwilds.com/food-drink/
2025-06-18 16:05:52 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://e.issuu.com/embed.html?d=dining_guide22-issuu&hideIssuuLogo=true&u=amberpr, URL: https://northernwilds.com/food-drink/, source: Breaking Tradition with Christmas “Away” - Northern Wilds Magazine, keywords: merengue
2025-06-18 16:05:52 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: z+,(mai]v).׶+,
2025-06-18 16:05:52 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://e.issuu.com/embed.html?d=dining_guide22-issuu&hideIssuuLogo=true&u=amberpr
2025-06-18 16:05:52 [root] INFO: write_url_to_db(): appended URL 'https://e.issuu.com/embed.html?d=dining_guide22-issuu&hideIssuuLogo=true&u=amberpr'
2025-06-18 16:05:52 [root] INFO: should_process_url: URL https://statcounter.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:05:52 [root] INFO: should_process_url: URL https://northernwilds.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:05:52 [root] INFO: should_process_url: URL https://northernwilds.com/category/features/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:05:52 [root] INFO: should_process_url: URL https://northernwilds.com/current-issue/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:05:52 [root] INFO: should_process_url: URL https://northernwilds.com/category/arts/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:05:52 [root] INFO: should_process_url: URL https://northernwilds.com/along-the-shore/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:05:52 [root] INFO: should_process_url: URL https://northernwilds.com/food-drink/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:05:52 [root] INFO: should_process_url: URL https://northernwilds.com/advertise-in-northern-minnesota/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:05:52 [root] INFO: should_process_url: URL https://northernwilds.com/about-us/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:05:52 [root] INFO: should_process_url: URL https://northernwilds.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:05:52 [root] INFO: should_process_url: URL https://hellobachatafestival.com/ has never been seen before, processing it.
2025-06-18 16:05:52 [root] INFO: should_process_url: URL https://hellobachatafestival.com/ has never been seen before, processing it.
2025-06-18 16:05:52 [root] INFO: write_url_to_db(): appended URL 'https://hellobachatafestival.com/'
2025-06-18 16:05:52 [root] INFO: def parse(): Crawling next URL: https://hellobachatafestival.com/
2025-06-18 16:05:52 [scrapy.extensions.logstats] INFO: Crawled 259 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 16:05:52 [root] INFO: should_process_url: URL https://closestays.com was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:05:52 [root] INFO: should_process_url: URL https://latindancecalendar.com/ was last seen as relevant, processing it.
2025-06-18 16:05:52 [root] INFO: should_process_url: URL https://latindancecalendar.com/festivals/afrolatin-holidays-egypt/ has never been seen before, processing it.
2025-06-18 16:05:52 [root] INFO: should_process_url: URL https://latindancecalendar.com/festivals/afrolatin-holidays-egypt/ has never been seen before, processing it.
2025-06-18 16:05:52 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/festivals/afrolatin-holidays-egypt/'
2025-06-18 16:05:52 [root] INFO: def parse(): Crawling next URL: https://latindancecalendar.com/festivals/afrolatin-holidays-egypt/
2025-06-18 16:05:52 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/home?status=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fsan-franciscos-hello-bachata-fest%2F.
2025-06-18 16:05:52 [root] INFO: should_process_url: URL https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fsan-franciscos-hello-bachata-fest%2F has never been seen before, processing it.
2025-06-18 16:05:52 [root] INFO: should_process_url: URL https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fsan-franciscos-hello-bachata-fest%2F has never been seen before, processing it.
2025-06-18 16:05:52 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fsan-franciscos-hello-bachata-fest%2F'
2025-06-18 16:05:52 [root] INFO: def parse(): Crawling next URL: https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fsan-franciscos-hello-bachata-fest%2F
2025-06-18 16:05:52 [root] INFO: should_process_url: URL https://latindancecalendar.com/festivals/viva-kizomba-congress-amsterdam/ has never been seen before, processing it.
2025-06-18 16:05:52 [root] INFO: should_process_url: URL https://latindancecalendar.com/festivals/viva-kizomba-congress-amsterdam/ has never been seen before, processing it.
2025-06-18 16:05:52 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/festivals/viva-kizomba-congress-amsterdam/'
2025-06-18 16:05:52 [root] INFO: def parse(): Crawling next URL: https://latindancecalendar.com/festivals/viva-kizomba-congress-amsterdam/
2025-06-18 16:05:52 [root] INFO: should_process_url: URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fsan-franciscos-hello-bachata-fest%2F has never been seen before, processing it.
2025-06-18 16:05:52 [root] INFO: should_process_url: URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fsan-franciscos-hello-bachata-fest%2F has never been seen before, processing it.
2025-06-18 16:05:52 [root] INFO: write_url_to_db(): appended URL 'https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fsan-franciscos-hello-bachata-fest%2F'
2025-06-18 16:05:52 [root] INFO: def parse(): Crawling next URL: https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fsan-franciscos-hello-bachata-fest%2F
2025-06-18 16:05:52 [root] INFO: should_process_url: URL https://latindancecalendar.com/festivals/berlin-salsacongress/ has never been seen before, processing it.
2025-06-18 16:05:52 [root] INFO: should_process_url: URL https://latindancecalendar.com/festivals/berlin-salsacongress/ has never been seen before, processing it.
2025-06-18 16:05:52 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/festivals/berlin-salsacongress/'
2025-06-18 16:05:52 [root] INFO: def parse(): Crawling next URL: https://latindancecalendar.com/festivals/berlin-salsacongress/
2025-06-18 16:05:52 [root] INFO: should_process_url: URL https://latindancecalendar.com/festivals/ab-international-congress-madrid/ has never been seen before, processing it.
2025-06-18 16:05:52 [root] INFO: should_process_url: URL https://latindancecalendar.com/festivals/ab-international-congress-madrid/ has never been seen before, processing it.
2025-06-18 16:05:52 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/festivals/ab-international-congress-madrid/'
2025-06-18 16:05:52 [root] INFO: def parse(): Crawling next URL: https://latindancecalendar.com/festivals/ab-international-congress-madrid/
2025-06-18 16:05:52 [root] INFO: should_process_url: URL https://closestays.com/stays/?address=1333+Bayshore+Highway%2C+Burlingame%2C+CA+94403 has never been seen before, processing it.
2025-06-18 16:05:52 [root] INFO: should_process_url: URL https://closestays.com/stays/?address=1333+Bayshore+Highway%2C+Burlingame%2C+CA+94403 has never been seen before, processing it.
2025-06-18 16:05:52 [root] INFO: write_url_to_db(): appended URL 'https://closestays.com/stays/?address=1333+Bayshore+Highway%2C+Burlingame%2C+CA+94403'
2025-06-18 16:05:52 [root] INFO: def parse(): Crawling next URL: https://closestays.com/stays/?address=1333+Bayshore+Highway%2C+Burlingame%2C+CA+94403
2025-06-18 16:05:52 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <406 https://hellobachatafestival.com/>: HTTP status code is not handled or not allowed
2025-06-18 16:05:52 [root] INFO: def parse(): Found keywords for URL https://latindancecalendar.com/festivals/afrolatin-holidays-egypt/: ['bachata', 'dance', 'kizomba', 'salsa', 'zouk']
2025-06-18 16:05:52 [root] INFO: def generate_prompt(): Generating prompt for URL: https://latindancecalendar.com/festivals/afrolatin-holidays-egypt/
2025-06-18 16:05:52 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:05:52 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:05:52 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:08:07 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:08:07 [root] INFO: query_llm(): Mistral response received: No-cache<!--Start of JSON output -->
[
  {
    "source": "https://latindancecalendar.com/dancecal/wp-content/uploads/Cover_Final_2_3_4_1_2_3_2_4_3_3_3-1.jpg",
    "url": "https://latindancecalendar.com/festivals/afrolatin-holidays-egypt/",
    "title": "13th AfroLatin Holidays \u2111 Egypt",
    "date": "2025-10-02",
    "day_of_week": "Tuesday",
    "start_time": "18:00",
    "end_time": "23:00",
    "price": "",
    "currency": "",
    "location": "Cairo, Egypt",
    "organizer_name": "AfroLatin Egypt",
    "description": "13th year! The Real Dance Vacation, not a regular festival
🆒 Highlights:
 🌍 Dancers from around the world!
 💃 Crazy parties; Beach, Pool, Boat, Foam, Outdoors & more!
 💯 100% social: You feel among family from day 1!
 🎧 Salsa, Kizomba/UrbanKiz, Bachata, Zouk & more!
 ⭐ Guest Artists & Dancers!",
    "latitude": "28.1515,",
    "longitude": "31.2324,",
    "image": "https://latindancecalendar.com/dancecal/wp-content/uploads/Cover_Final_2_3_4_1_2_3_3_3_2-1.jpg",
    "all_day": false,
    "recurrence": "daily",
    "event_type": "festival",
    "dance_style": "social dance",
    "dance_types": "salsa,bachata,kizomba,zouk",
    "source": "AfroLatin Egypt",
    "promo_code": "LDC123",
    "discount_description": "",
    "url": "https://latindancecalendar.com/festivals/afrolatin-holidays-egypt/",
    "all_day": false,
    "recurrence": "daily",
    "event_type": "festival",
    "dance_style": "social dance",
    "dance_types": "salsa,bachata,kizomba,zouk",
    "source": "AfroLatin Egypt",
    "promo_code": "LDC123",
    "discount_description": "",
    "url": "https://latindancecalendar.com/festivals/afrolatin-holidays-egypt/",
    "all_day": false,
    "recurrence": "daily",
    "event_type": "festival",
    "dance_style": "social dance",
    "dance_types": "salsa,bachata,kizomba,zouk",
    "source": "AfroLatin Egypt",
    "promo_code": "LDC123",
    "discount_description": "",
    "url": "https://latindancecalendar.com/festivals/afrolatin-holidays-egypt/",
    "all_day": false,
    "recurrence": "daily",
    "event_type": "festival",
    "dance_style": "social dance",
    "dance_types": "salsa,bachata,kizomba,zouk",
    "source": "AfroLatin Egypt",
    "promo_code": "LDC123",
    "discount_description": "",
    "url": "https://latindancecalendar.com/festivals/afrolatin-holidays-egypt/",
    "all_day": false,
    "recurrence": "daily",
    "event_type": "festival",
    "dance_style": "social dance",
    "dance_types": "salsa,bachata,kizomba,zouk",
    "source": "AfroLatin Egypt",
    "promo_code": "LDC123",
    "discount_description": "",
    "url": "https://latindancecalendar.com/festivals/afrolatin-holidays-egypt/",
    "all_day": false,
    "recurrence": "daily",
    "event_type": "festival",
    "dance_style": "social dance",
    "dance_types": "salsa,bachata,kizomba,zouk",
    "source": "AfroLatin Egypt",
    "promo_code": "LDC123",
    "discount_description": "",
    "url": "https://latindancecalendar.com/festivals/afrolatin-holidays-egypt/",
    "all_day": false,
    "recurrence": "daily",
    "event_type": "festival",
    "dance_style": "social dance",
    "dance_types": "salsa,bachata,kizomba,zouk",
    "source": "AfroLatin Egypt",
    "promo_code": "LDC123",
    "discount_description": "",
    "url": "https://latindancecalendar.com/festivals/afrolatin-holidays-egypt/",
    "all_day": false,
    "recurrence": "daily",
    "event_type": "festival",
    "dance_style": "social dance",
    "dance_types": "salsa,bachata,kizomba,zouk",
    "source": "AfroLatin Egypt",
    "promo_
2025-06-18 16:08:07 [root] ERROR: def extract_and_parse_json(): couldn't isolate JSON blob in result from https://latindancecalendar.com/festivals/afrolatin-holidays-egypt/
2025-06-18 16:08:07 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/festivals/afrolatin-holidays-egypt/'
2025-06-18 16:08:07 [root] INFO: def parse(): URL https://latindancecalendar.com/festivals/afrolatin-holidays-egypt/ marked as irrelevant (LLM negative).
2025-06-18 16:08:07 [root] INFO: def parse(): Found 10 links on https://latindancecalendar.com/festivals/afrolatin-holidays-egypt/
2025-06-18 16:08:07 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.stay22.com/embed/gm?aid=latindancecalendar&maincolor=FFFFFF&adults=1&showothers=true&checkin=2025-10-02&checkout=2025-10-03&address=Cairo%2C+Egypt&isnear=false&campaign=festival117719&campaign=festivalPageRegion, URL: https://latindancecalendar.com/festivals/afrolatin-holidays-egypt/, source: Zouk Dancing Festivals Worldwide (Updated 2025), keywords: zouk
2025-06-18 16:08:07 [root] WARNING: def decode_calendar_id(): Exception for https://www.stay22.com/embed/gm?aid=latindancecalendar&maincolor=FFFFFF&adults=1&showothers=true&checkin=2025-10-02&checkout=2025-10-03&address=Cairo%2C+Egypt&isnear=false&campaign=festival117719&campaign=festivalPageRegion - Incorrect padding
2025-06-18 16:08:07 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.stay22.com/embed/gm?aid=latindancecalendar&maincolor=FFFFFF&adults=1&showothers=true&checkin=2025-10-02&checkout=2025-10-03&address=Cairo%2C+Egypt&isnear=false&campaign=festival117719&campaign=festivalPageRegion
2025-06-18 16:08:07 [root] INFO: write_url_to_db(): appended URL 'https://www.stay22.com/embed/gm?aid=latindancecalendar&maincolor=FFFFFF&adults=1&showothers=true&checkin=2025-10-02&checkout=2025-10-03&address=Cairo%2C+Egypt&isnear=false&campaign=festival117719&campaign=festivalPageRegion'
2025-06-18 16:08:07 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/dialog/send?app_id=321366148277289&link=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fafrolatin-holidays-egypt%2F%3Futm_source%3Dweb_share_fbmessenger&redirect_uri=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fafrolatin-holidays-egypt%2F%3Futm_source%3Dweb_share_fbmessenger'
2025-06-18 16:08:07 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/dialog/send?app_id=321366148277289&link=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fafrolatin-holidays-egypt%2F%3Futm_source%3Dweb_share_fbmessenger&redirect_uri=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fafrolatin-holidays-egypt%2F%3Futm_source%3Dweb_share_fbmessenger
2025-06-18 16:08:07 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fafrolatin-holidays-egypt%2F%3Futm_source%3Dweb_share_fb'
2025-06-18 16:08:07 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fafrolatin-holidays-egypt%2F%3Futm_source%3Dweb_share_fb
2025-06-18 16:08:07 [root] INFO: should_process_url: URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fafrolatin-holidays-egypt%2F has never been seen before, processing it.
2025-06-18 16:08:07 [root] INFO: should_process_url: URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fafrolatin-holidays-egypt%2F has never been seen before, processing it.
2025-06-18 16:08:07 [root] INFO: write_url_to_db(): appended URL 'https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fafrolatin-holidays-egypt%2F'
2025-06-18 16:08:07 [root] INFO: def parse(): Crawling next URL: https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fafrolatin-holidays-egypt%2F
2025-06-18 16:08:07 [root] INFO: should_process_url: URL https://latindancecalendar.com/ was last seen as relevant, processing it.
2025-06-18 16:08:07 [root] INFO: should_process_url: URL https://closestays.com was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:08:07 [root] INFO: should_process_url: URL https://latindancecalendar.com/festivals/afrolatin-holidays-egypt/ has never been seen before, processing it.
2025-06-18 16:08:07 [root] INFO: should_process_url: URL https://latindancecalendar.com/afrolatin-egypt/ has never been seen before, processing it.
2025-06-18 16:08:07 [root] INFO: should_process_url: URL https://latindancecalendar.com/afrolatin-egypt/ has never been seen before, processing it.
2025-06-18 16:08:07 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/afrolatin-egypt/'
2025-06-18 16:08:07 [root] INFO: def parse(): Crawling next URL: https://latindancecalendar.com/afrolatin-egypt/
2025-06-18 16:08:07 [root] INFO: should_process_url: URL https://www.goandance.com/en/event/8186/13th-afrolatin-holidays-egypt-oct-2025?promoter=LDC123 has never been seen before, processing it.
2025-06-18 16:08:07 [root] INFO: should_process_url: URL https://www.goandance.com/en/event/8186/13th-afrolatin-holidays-egypt-oct-2025?promoter=LDC123 has never been seen before, processing it.
2025-06-18 16:08:07 [root] INFO: write_url_to_db(): appended URL 'https://www.goandance.com/en/event/8186/13th-afrolatin-holidays-egypt-oct-2025?promoter=LDC123'
2025-06-18 16:08:07 [root] INFO: def parse(): Crawling next URL: https://www.goandance.com/en/event/8186/13th-afrolatin-holidays-egypt-oct-2025?promoter=LDC123
2025-06-18 16:08:07 [root] INFO: should_process_url: URL https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fafrolatin-holidays-egypt%2F has never been seen before, processing it.
2025-06-18 16:08:07 [root] INFO: should_process_url: URL https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fafrolatin-holidays-egypt%2F has never been seen before, processing it.
2025-06-18 16:08:07 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fafrolatin-holidays-egypt%2F'
2025-06-18 16:08:07 [root] INFO: def parse(): Crawling next URL: https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fafrolatin-holidays-egypt%2F
2025-06-18 16:08:07 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/home?status=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fafrolatin-holidays-egypt%2F.
2025-06-18 16:08:07 [scrapy.extensions.logstats] INFO: Crawled 276 pages (at 17 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 16:08:07 [root] INFO: def parse(): Found keywords for URL https://latindancecalendar.com/festivals/xlb-festival/: ['bachata', 'dance', 'kizomba', 'salsa', 'zouk']
2025-06-18 16:08:07 [root] INFO: def generate_prompt(): Generating prompt for URL: https://latindancecalendar.com/festivals/xlb-festival/
2025-06-18 16:08:07 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:08:07 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:08:07 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:08:09 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:08:09 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 146302 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 16:08:09 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:08:34 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:08:34 [root] INFO: query_llm(): OpenAI response received: [{
    "source": "Latin Dance Calendar",
    "dance_style": "bachata",
    "url": "",
    "event_type": "other",
    "event_name": "XLB FESTIVAL 2025",
    "day_of_week": "Friday",
    "start_date": "2025-08-08",
    "end_date": "2025-08-08",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "France",
    "description": "There is no description available. Please check the link for more information."
}]
2025-06-18 16:08:34 [root] INFO: def extract_and_parse_json(): for url https://latindancecalendar.com/festivals/xlb-festival/, 
Cleaned JSON ready for parsing:
[{
    "source": "Latin Dance Calendar",
    "dance_style": "bachata",
    "url": "",
    "event_type": "other",
    "event_name": "XLB FESTIVAL 2025",
    "day_of_week": "Friday",
    "start_date": "2025-08-08",
    "end_date": "2025-08-08",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "France",
    "description": "There is no description available. Please check the link for more information."
}]
2025-06-18 16:08:34 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 16:08:34 [root] INFO: def clean_up_address(): Processing location 'France' (event_id: None)
2025-06-18 16:08:34 [root] INFO: write_events_to_db: Number of events to write: 1
2025-06-18 16:08:34 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/festivals/xlb-festival/'
2025-06-18 16:08:34 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 16:08:34 [root] INFO: def process_llm_response: URL https://latindancecalendar.com/festivals/xlb-festival/ marked as relevant with events written to the database.
2025-06-18 16:08:34 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/festivals/xlb-festival/'
2025-06-18 16:08:34 [root] INFO: def parse(): URL https://latindancecalendar.com/festivals/xlb-festival/ marked as relevant (LLM positive).
2025-06-18 16:08:34 [root] INFO: def parse(): Found 10 links on https://latindancecalendar.com/festivals/xlb-festival/
2025-06-18 16:08:34 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.stay22.com/embed/gm?aid=latindancecalendar&maincolor=FFFFFF&adults=1&showothers=true&checkin=2025-08-08&checkout=2025-08-09&markerimage=https%3A%2F%2Fres.cloudinary.com%2Flatindancecalendar%2Fimage%2Ffetch%2Fw_350%2Ch_350%2Fhttps%253A%252F%252Flatindancecalendar.com%252Fdancecal%252Fwp-content%252Fuploads%252F7546-xlb-festival-2025-20241109211804_2.jpg&lat=45.688812&lng=5.913202&campaign=festival117017&campaign=festivalPageGPS, URL: https://latindancecalendar.com/festivals/xlb-festival/, source: Zouk Dancing Festivals Worldwide (Updated 2025), keywords: zouk
2025-06-18 16:08:34 [root] WARNING: def decode_calendar_id(): Exception for https://www.stay22.com/embed/gm?aid=latindancecalendar&maincolor=FFFFFF&adults=1&showothers=true&checkin=2025-08-08&checkout=2025-08-09&markerimage=https%3A%2F%2Fres.cloudinary.com%2Flatindancecalendar%2Fimage%2Ffetch%2Fw_350%2Ch_350%2Fhttps%253A%252F%252Flatindancecalendar.com%252Fdancecal%252Fwp-content%252Fuploads%252F7546-xlb-festival-2025-20241109211804_2.jpg&lat=45.688812&lng=5.913202&campaign=festival117017&campaign=festivalPageGPS - Incorrect padding
2025-06-18 16:08:34 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.stay22.com/embed/gm?aid=latindancecalendar&maincolor=FFFFFF&adults=1&showothers=true&checkin=2025-08-08&checkout=2025-08-09&markerimage=https%3A%2F%2Fres.cloudinary.com%2Flatindancecalendar%2Fimage%2Ffetch%2Fw_350%2Ch_350%2Fhttps%253A%252F%252Flatindancecalendar.com%252Fdancecal%252Fwp-content%252Fuploads%252F7546-xlb-festival-2025-20241109211804_2.jpg&lat=45.688812&lng=5.913202&campaign=festival117017&campaign=festivalPageGPS
2025-06-18 16:08:34 [root] INFO: write_url_to_db(): appended URL 'https://www.stay22.com/embed/gm?aid=latindancecalendar&maincolor=FFFFFF&adults=1&showothers=true&checkin=2025-08-08&checkout=2025-08-09&markerimage=https%3A%2F%2Fres.cloudinary.com%2Flatindancecalendar%2Fimage%2Ffetch%2Fw_350%2Ch_350%2Fhttps%253A%252F%252Flatindancecalendar.com%252Fdancecal%252Fwp-content%252Fuploads%252F7546-xlb-festival-2025-20241109211804_2.jpg&lat=45.688812&lng=5.913202&campaign=festival117017&campaign=festivalPageGPS'
2025-06-18 16:08:34 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fxlb-festival%2F%3Futm_source%3Dweb_share_fb'
2025-06-18 16:08:34 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fxlb-festival%2F%3Futm_source%3Dweb_share_fb
2025-06-18 16:08:34 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/dialog/send?app_id=321366148277289&link=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fxlb-festival%2F%3Futm_source%3Dweb_share_fbmessenger&redirect_uri=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fxlb-festival%2F%3Futm_source%3Dweb_share_fbmessenger'
2025-06-18 16:08:34 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/dialog/send?app_id=321366148277289&link=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fxlb-festival%2F%3Futm_source%3Dweb_share_fbmessenger&redirect_uri=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fxlb-festival%2F%3Futm_source%3Dweb_share_fbmessenger
2025-06-18 16:08:34 [root] INFO: should_process_url: URL https://latindancecalendar.com/festivals/xlb-festival/ has never been seen before, processing it.
2025-06-18 16:08:34 [root] INFO: should_process_url: URL https://www.goandance.com/en/events/7546-xlb-festival-2025?promoter=LDC123 has never been seen before, processing it.
2025-06-18 16:08:34 [root] INFO: should_process_url: URL https://www.goandance.com/en/events/7546-xlb-festival-2025?promoter=LDC123 has never been seen before, processing it.
2025-06-18 16:08:34 [root] INFO: write_url_to_db(): appended URL 'https://www.goandance.com/en/events/7546-xlb-festival-2025?promoter=LDC123'
2025-06-18 16:08:34 [root] INFO: def parse(): Crawling next URL: https://www.goandance.com/en/events/7546-xlb-festival-2025?promoter=LDC123
2025-06-18 16:08:34 [root] INFO: should_process_url: URL https://latindancecalendar.com/ was last seen as relevant, processing it.
2025-06-18 16:08:34 [root] INFO: should_process_url: URL https://closestays.com was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:08:34 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/home?status=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fxlb-festival%2F.
2025-06-18 16:08:34 [root] INFO: should_process_url: URL https://latindancecalendar.com/festival-de-bachata-xl/ has never been seen before, processing it.
2025-06-18 16:08:34 [root] INFO: should_process_url: URL https://latindancecalendar.com/festival-de-bachata-xl/ has never been seen before, processing it.
2025-06-18 16:08:34 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/festival-de-bachata-xl/'
2025-06-18 16:08:34 [root] INFO: def parse(): Crawling next URL: https://latindancecalendar.com/festival-de-bachata-xl/
2025-06-18 16:08:34 [root] INFO: should_process_url: URL https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fxlb-festival%2F has never been seen before, processing it.
2025-06-18 16:08:34 [root] INFO: should_process_url: URL https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fxlb-festival%2F has never been seen before, processing it.
2025-06-18 16:08:34 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fxlb-festival%2F'
2025-06-18 16:08:34 [root] INFO: def parse(): Crawling next URL: https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fxlb-festival%2F
2025-06-18 16:08:34 [root] INFO: should_process_url: URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fxlb-festival%2F has never been seen before, processing it.
2025-06-18 16:08:34 [root] INFO: should_process_url: URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fxlb-festival%2F has never been seen before, processing it.
2025-06-18 16:08:34 [root] INFO: write_url_to_db(): appended URL 'https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fxlb-festival%2F'
2025-06-18 16:08:34 [root] INFO: def parse(): Crawling next URL: https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fxlb-festival%2F
2025-06-18 16:08:34 [root] INFO: write_url_to_db(): appended URL 'https://www.pgmusic.com/'
2025-06-18 16:08:34 [root] INFO: def parse(): URL https://www.pgmusic.com/ marked as irrelevant (no keywords).
2025-06-18 16:08:34 [root] INFO: def parse(): Found 10 links on https://www.pgmusic.com/
2025-06-18 16:08:34 [root] INFO: should_process_url: URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=849054&page=1 has never been seen before, processing it.
2025-06-18 16:08:34 [root] INFO: should_process_url: URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=849054&page=1 has never been seen before, processing it.
2025-06-18 16:08:34 [root] INFO: write_url_to_db(): appended URL 'http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=849054&page=1'
2025-06-18 16:08:34 [root] INFO: def parse(): Crawling next URL: http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=849054&page=1
2025-06-18 16:08:34 [root] INFO: def parse(): Found keywords for URL https://www.pgmusic.com/bbwin.packages.htm: ['country waltz', 'dance', 'waltz']
2025-06-18 16:08:34 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.pgmusic.com/bbwin.packages.htm
2025-06-18 16:08:34 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:08:34 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:08:34 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:08:40 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:08:40 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 16:08:40 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 16:08:40 [root] INFO: write_url_to_db(): appended URL 'https://www.pgmusic.com/bbwin.packages.htm'
2025-06-18 16:08:40 [root] INFO: def parse(): URL https://www.pgmusic.com/bbwin.packages.htm marked as irrelevant (LLM negative).
2025-06-18 16:08:40 [root] INFO: def parse(): Found 6 links on https://www.pgmusic.com/bbwin.packages.htm
2025-06-18 16:08:40 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/pages/Band-in-a-Box-by-PG-Music/99580673800'
2025-06-18 16:08:40 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/pages/Band-in-a-Box-by-PG-Music/99580673800
2025-06-18 16:08:40 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/bandinabox_pg_music/'
2025-06-18 16:08:40 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/bandinabox_pg_music/
2025-06-18 16:08:40 [root] INFO: should_process_url: URL https://www.pgmusic.com/bbwin.packages.htm was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:08:40 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/user/pgmusicinc.
2025-06-18 16:08:40 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/BandinaBox.
2025-06-18 16:08:40 [root] INFO: should_process_url: URL https://www.pgmusic.com/ has never been seen before, processing it.
2025-06-18 16:08:40 [scrapy.extensions.logstats] INFO: Crawled 280 pages (at 4 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 16:08:40 [root] INFO: should_process_url: URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=843433&page=1 has never been seen before, processing it.
2025-06-18 16:08:40 [root] INFO: should_process_url: URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=843433&page=1 has never been seen before, processing it.
2025-06-18 16:08:40 [root] INFO: write_url_to_db(): appended URL 'http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=843433&page=1'
2025-06-18 16:08:40 [root] INFO: def parse(): Crawling next URL: http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=843433&page=1
2025-06-18 16:08:41 [root] INFO: should_process_url: URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=845929&page=1 has never been seen before, processing it.
2025-06-18 16:08:41 [root] INFO: should_process_url: URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=845929&page=1 has never been seen before, processing it.
2025-06-18 16:08:41 [root] INFO: write_url_to_db(): appended URL 'http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=845929&page=1'
2025-06-18 16:08:41 [root] INFO: def parse(): Crawling next URL: http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=845929&page=1
2025-06-18 16:08:41 [root] INFO: should_process_url: URL https://www.pgmusic.com/bbwin.packages.htm was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:08:41 [root] INFO: should_process_url: URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=846900&page=1 has never been seen before, processing it.
2025-06-18 16:08:41 [root] INFO: should_process_url: URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=846900&page=1 has never been seen before, processing it.
2025-06-18 16:08:41 [root] INFO: write_url_to_db(): appended URL 'http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=846900&page=1'
2025-06-18 16:08:41 [root] INFO: def parse(): Crawling next URL: http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=846900&page=1
2025-06-18 16:08:41 [root] INFO: should_process_url: URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=835013&page=1 has never been seen before, processing it.
2025-06-18 16:08:41 [root] INFO: should_process_url: URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=835013&page=1 has never been seen before, processing it.
2025-06-18 16:08:41 [root] INFO: write_url_to_db(): appended URL 'http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=835013&page=1'
2025-06-18 16:08:41 [root] INFO: def parse(): Crawling next URL: http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=835013&page=1
2025-06-18 16:08:41 [root] INFO: should_process_url: URL https://www.pgmusic.com/news.htm has never been seen before, processing it.
2025-06-18 16:08:41 [root] INFO: should_process_url: URL https://www.pgmusic.com/news.htm has never been seen before, processing it.
2025-06-18 16:08:41 [root] INFO: write_url_to_db(): appended URL 'https://www.pgmusic.com/news.htm'
2025-06-18 16:08:41 [root] INFO: def parse(): Crawling next URL: https://www.pgmusic.com/news.htm
2025-06-18 16:08:41 [root] INFO: should_process_url: URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=849429&page=1 has never been seen before, processing it.
2025-06-18 16:08:41 [root] INFO: should_process_url: URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=849429&page=1 has never been seen before, processing it.
2025-06-18 16:08:41 [root] INFO: write_url_to_db(): appended URL 'http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=849429&page=1'
2025-06-18 16:08:41 [root] INFO: def parse(): Crawling next URL: http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=849429&page=1
2025-06-18 16:08:41 [root] INFO: write_url_to_db(): appended URL 'https://www.cohoferry.com/attractions/victoria/afternoon-tea-at-the-butchart-gardens'
2025-06-18 16:08:41 [root] INFO: def parse(): URL https://www.cohoferry.com/attractions/victoria/afternoon-tea-at-the-butchart-gardens marked as irrelevant (no keywords).
2025-06-18 16:08:41 [root] INFO: def parse(): Found 7 links on https://www.cohoferry.com/attractions/victoria/afternoon-tea-at-the-butchart-gardens
2025-06-18 16:08:41 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-NBB6WGX, URL: https://www.cohoferry.com/attractions/victoria/afternoon-tea-at-the-butchart-gardens, source: Summer Festivals in Victoria, BC | Black Ball Ferry Line, keywords: music festivals
2025-06-18 16:08:41 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 16:08:41 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-NBB6WGX
2025-06-18 16:08:41 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-NBB6WGX'
2025-06-18 16:08:41 [root] INFO: write_url_to_db(): appended URL 'http://instagram.com/mvcoho'
2025-06-18 16:08:41 [root] INFO: def parse(): Recorded unwanted URL: http://instagram.com/mvcoho
2025-06-18 16:08:41 [root] INFO: write_url_to_db(): appended URL 'http://www.facebook.com/mvcoho'
2025-06-18 16:08:41 [root] INFO: def parse(): Recorded unwanted URL: http://www.facebook.com/mvcoho
2025-06-18 16:08:41 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/channel/UCPcP9gdC3HYp6KzQrMfptiA.
2025-06-18 16:08:41 [root] INFO: should_process_url: URL https://shop.blackball.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:08:41 [root] INFO: should_process_url: URL https://www.cohoferry.com/attractions/victoria/afternoon-tea-at-the-butchart-gardens was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:08:41 [root] INFO: parse: Skipping blacklisted URL http://www.twitter.com/mvcoho.
2025-06-18 16:08:41 [root] INFO: should_process_url: URL https://app.e2ma.net/app2/audience/signup/2008664/1726574/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:08:41 [root] INFO: write_url_to_db(): appended URL 'https://www.coldwarkids.com/'
2025-06-18 16:08:41 [root] INFO: def parse(): URL https://www.coldwarkids.com/ marked as irrelevant (no keywords).
2025-06-18 16:08:41 [root] INFO: def parse(): Found 10 links on https://www.coldwarkids.com/
2025-06-18 16:08:41 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-WRZRQJP, URL: https://www.coldwarkids.com/, source: Summer Festivals in Victoria, BC | Black Ball Ferry Line, keywords: music festivals
2025-06-18 16:08:41 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 16:08:41 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-WRZRQJP
2025-06-18 16:08:41 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-WRZRQJP'
2025-06-18 16:08:41 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/ColdWarKids/'
2025-06-18 16:08:41 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/ColdWarKids/
2025-06-18 16:08:41 [root] INFO: write_url_to_db(): appended URL 'http://instagram.com/coldwarkids'
2025-06-18 16:08:41 [root] INFO: def parse(): Recorded unwanted URL: http://instagram.com/coldwarkids
2025-06-18 16:08:41 [root] INFO: parse: Skipping blacklisted URL http://twitter.com/coldwarkids.
2025-06-18 16:08:41 [root] INFO: should_process_url: URL https://www.tiktok.com/@coldwarkidsofficial has never been seen before, processing it.
2025-06-18 16:08:41 [root] INFO: should_process_url: URL https://www.tiktok.com/@coldwarkidsofficial has never been seen before, processing it.
2025-06-18 16:08:41 [root] INFO: write_url_to_db(): appended URL 'https://www.tiktok.com/@coldwarkidsofficial'
2025-06-18 16:08:41 [root] INFO: def parse(): Crawling next URL: https://www.tiktok.com/@coldwarkidsofficial
2025-06-18 16:08:41 [root] INFO: should_process_url: URL https://www.coldwarkids.com/ has never been seen before, processing it.
2025-06-18 16:08:41 [root] INFO: should_process_url: URL https://ffm.bio/coldwarkids has never been seen before, processing it.
2025-06-18 16:08:41 [root] INFO: should_process_url: URL https://ffm.bio/coldwarkids has never been seen before, processing it.
2025-06-18 16:08:41 [root] INFO: write_url_to_db(): appended URL 'https://ffm.bio/coldwarkids'
2025-06-18 16:08:41 [root] INFO: def parse(): Crawling next URL: https://ffm.bio/coldwarkids
2025-06-18 16:08:41 [root] INFO: should_process_url: URL https://itunes.apple.com/us/artist/cold-war-kids/196319371 has never been seen before, processing it.
2025-06-18 16:08:41 [root] INFO: should_process_url: URL https://itunes.apple.com/us/artist/cold-war-kids/196319371 has never been seen before, processing it.
2025-06-18 16:08:41 [root] INFO: write_url_to_db(): appended URL 'https://itunes.apple.com/us/artist/cold-war-kids/196319371'
2025-06-18 16:08:41 [root] INFO: def parse(): Crawling next URL: https://itunes.apple.com/us/artist/cold-war-kids/196319371
2025-06-18 16:08:41 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/channel/UC_IXh7aDGgEHqWrtpZjIOQw.
2025-06-18 16:08:41 [root] INFO: should_process_url: URL https://coldwarkids.merchmadeeasy.com has never been seen before, processing it.
2025-06-18 16:08:41 [root] INFO: should_process_url: URL https://coldwarkids.merchmadeeasy.com has never been seen before, processing it.
2025-06-18 16:08:41 [root] INFO: write_url_to_db(): appended URL 'https://coldwarkids.merchmadeeasy.com'
2025-06-18 16:08:41 [root] INFO: def parse(): Crawling next URL: https://coldwarkids.merchmadeeasy.com
2025-06-18 16:08:41 [root] INFO: def parse(): Found keywords for URL https://latindancecalendar.com/festivals/ab-international-congress-madrid/: ['bachata', 'dance', 'kizomba', 'salsa', 'zouk']
2025-06-18 16:08:41 [root] INFO: def generate_prompt(): Generating prompt for URL: https://latindancecalendar.com/festivals/ab-international-congress-madrid/
2025-06-18 16:08:41 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:08:41 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:08:41 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:08:42 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:08:42 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 146335 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 16:08:42 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:09:04 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:09:04 [root] INFO: query_llm(): OpenAI response received: [{
    "source": "Latin Dance Calendar",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "AB International Congress [Madrid] + €5 OFF Promo Code",
    "day_of_week": "Friday",
    "start_date": "2026-03-27",
    "end_date": "2026-03-30",
    "start_time": "16:00",
    "end_time": "05:00",
    "price": "",
    "location": "Madrid, Spain",
    "description": "AB International Congress is a Latin dance festival in Madrid with workshops, socials, competitions and themed parties from 27 to 30 March 2026."
}]
2025-06-18 16:09:04 [root] INFO: def extract_and_parse_json(): for url https://latindancecalendar.com/festivals/ab-international-congress-madrid/, 
Cleaned JSON ready for parsing:
[{
    "source": "Latin Dance Calendar",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "AB International Congress [Madrid] + €5 OFF Promo Code",
    "day_of_week": "Friday",
    "start_date": "2026-03-27",
    "end_date": "2026-03-30",
    "start_time": "16:00",
    "end_time": "05:00",
    "price": "",
    "location": "Madrid, Spain",
    "description": "AB International Congress is a Latin dance festival in Madrid with workshops, socials, competitions and themed parties from 27 to 30 March 2026."
}]
2025-06-18 16:09:04 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 16:09:04 [root] INFO: def clean_up_address(): Processing location 'Madrid, Spain' (event_id: None)
2025-06-18 16:09:04 [root] INFO: write_events_to_db: Number of events to write: 1
2025-06-18 16:09:04 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/festivals/ab-international-congress-madrid/'
2025-06-18 16:09:04 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 16:09:04 [root] INFO: def process_llm_response: URL https://latindancecalendar.com/festivals/ab-international-congress-madrid/ marked as relevant with events written to the database.
2025-06-18 16:09:04 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/festivals/ab-international-congress-madrid/'
2025-06-18 16:09:04 [root] INFO: def parse(): URL https://latindancecalendar.com/festivals/ab-international-congress-madrid/ marked as relevant (LLM positive).
2025-06-18 16:09:04 [root] INFO: def parse(): Found 10 links on https://latindancecalendar.com/festivals/ab-international-congress-madrid/
2025-06-18 16:09:04 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.stay22.com/embed/gm?aid=latindancecalendar&maincolor=FFFFFF&adults=1&showothers=true&checkin=2026-03-27&checkout=2026-03-28&address=Madrid%2C+Spain&isnear=false&campaign=festival117718&campaign=festivalPageRegion, URL: https://latindancecalendar.com/festivals/ab-international-congress-madrid/, source: Zouk Dancing Festivals Worldwide (Updated 2025), keywords: zouk
2025-06-18 16:09:04 [root] WARNING: def decode_calendar_id(): Exception for https://www.stay22.com/embed/gm?aid=latindancecalendar&maincolor=FFFFFF&adults=1&showothers=true&checkin=2026-03-27&checkout=2026-03-28&address=Madrid%2C+Spain&isnear=false&campaign=festival117718&campaign=festivalPageRegion - Incorrect padding
2025-06-18 16:09:04 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.stay22.com/embed/gm?aid=latindancecalendar&maincolor=FFFFFF&adults=1&showothers=true&checkin=2026-03-27&checkout=2026-03-28&address=Madrid%2C+Spain&isnear=false&campaign=festival117718&campaign=festivalPageRegion
2025-06-18 16:09:04 [root] INFO: write_url_to_db(): appended URL 'https://www.stay22.com/embed/gm?aid=latindancecalendar&maincolor=FFFFFF&adults=1&showothers=true&checkin=2026-03-27&checkout=2026-03-28&address=Madrid%2C+Spain&isnear=false&campaign=festival117718&campaign=festivalPageRegion'
2025-06-18 16:09:04 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/dialog/send?app_id=321366148277289&link=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fab-international-congress-madrid%2F%3Futm_source%3Dweb_share_fbmessenger&redirect_uri=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fab-international-congress-madrid%2F%3Futm_source%3Dweb_share_fbmessenger'
2025-06-18 16:09:04 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/dialog/send?app_id=321366148277289&link=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fab-international-congress-madrid%2F%3Futm_source%3Dweb_share_fbmessenger&redirect_uri=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fab-international-congress-madrid%2F%3Futm_source%3Dweb_share_fbmessenger
2025-06-18 16:09:04 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fab-international-congress-madrid%2F%3Futm_source%3Dweb_share_fb'
2025-06-18 16:09:04 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fab-international-congress-madrid%2F%3Futm_source%3Dweb_share_fb
2025-06-18 16:09:04 [root] INFO: should_process_url: URL https://latindancecalendar.com/ was last seen as relevant, processing it.
2025-06-18 16:09:04 [root] INFO: should_process_url: URL https://closestays.com was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:09:04 [root] INFO: should_process_url: URL https://www.goandance.com/en/event/8142/ab-international-congress-madrid-by-sensual-madness?promoter=LDC123 has never been seen before, processing it.
2025-06-18 16:09:04 [root] INFO: should_process_url: URL https://www.goandance.com/en/event/8142/ab-international-congress-madrid-by-sensual-madness?promoter=LDC123 has never been seen before, processing it.
2025-06-18 16:09:04 [root] INFO: write_url_to_db(): appended URL 'https://www.goandance.com/en/event/8142/ab-international-congress-madrid-by-sensual-madness?promoter=LDC123'
2025-06-18 16:09:04 [root] INFO: def parse(): Crawling next URL: https://www.goandance.com/en/event/8142/ab-international-congress-madrid-by-sensual-madness?promoter=LDC123
2025-06-18 16:09:04 [root] INFO: should_process_url: URL https://latindancecalendar.com/festivals/ab-international-congress-madrid/ has never been seen before, processing it.
2025-06-18 16:09:04 [root] INFO: should_process_url: URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fab-international-congress-madrid%2F has never been seen before, processing it.
2025-06-18 16:09:04 [root] INFO: should_process_url: URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fab-international-congress-madrid%2F has never been seen before, processing it.
2025-06-18 16:09:04 [root] INFO: write_url_to_db(): appended URL 'https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fab-international-congress-madrid%2F'
2025-06-18 16:09:04 [root] INFO: def parse(): Crawling next URL: https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fab-international-congress-madrid%2F
2025-06-18 16:09:04 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/home?status=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fab-international-congress-madrid%2F.
2025-06-18 16:09:04 [root] INFO: should_process_url: URL https://latindancecalendar.com/ab-international-congress-madrid/ has never been seen before, processing it.
2025-06-18 16:09:04 [root] INFO: should_process_url: URL https://latindancecalendar.com/ab-international-congress-madrid/ has never been seen before, processing it.
2025-06-18 16:09:04 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/ab-international-congress-madrid/'
2025-06-18 16:09:04 [root] INFO: def parse(): Crawling next URL: https://latindancecalendar.com/ab-international-congress-madrid/
2025-06-18 16:09:04 [root] INFO: should_process_url: URL https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fab-international-congress-madrid%2F has never been seen before, processing it.
2025-06-18 16:09:04 [root] INFO: should_process_url: URL https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fab-international-congress-madrid%2F has never been seen before, processing it.
2025-06-18 16:09:04 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fab-international-congress-madrid%2F'
2025-06-18 16:09:04 [root] INFO: def parse(): Crawling next URL: https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fab-international-congress-madrid%2F
2025-06-18 16:09:04 [root] INFO: write_url_to_db(): appended URL 'https://bandofskulls.shop/'
2025-06-18 16:09:04 [root] INFO: def parse(): URL https://bandofskulls.shop/ marked as irrelevant (no keywords).
2025-06-18 16:09:04 [root] INFO: def parse(): Found 8 links on https://bandofskulls.shop/
2025-06-18 16:09:04 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO2sHzrb?utm_source=generator, URL: https://bandofskulls.shop/, source: Summer Festivals in Victoria, BC | Black Ball Ferry Line, keywords: music festivals
2025-06-18 16:09:04 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: -oޙZXPd]CgN:ۺ٬zz
2025-06-18 16:09:04 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO2sHzrb?utm_source=generator
2025-06-18 16:09:04 [root] INFO: write_url_to_db(): appended URL 'https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO2sHzrb?utm_source=generator'
2025-06-18 16:09:04 [root] INFO: should_process_url: URL https://www.bandsintown.com/a/268629-band-of-skulls?came_from=251&utm_medium=web&utm_source=artist_page&utm_campaign=search_bar has never been seen before, processing it.
2025-06-18 16:09:04 [root] INFO: should_process_url: URL https://www.bandsintown.com/a/268629-band-of-skulls?came_from=251&utm_medium=web&utm_source=artist_page&utm_campaign=search_bar has never been seen before, processing it.
2025-06-18 16:09:04 [root] INFO: write_url_to_db(): appended URL 'https://www.bandsintown.com/a/268629-band-of-skulls?came_from=251&utm_medium=web&utm_source=artist_page&utm_campaign=search_bar'
2025-06-18 16:09:04 [root] INFO: def parse(): Crawling next URL: https://www.bandsintown.com/a/268629-band-of-skulls?came_from=251&utm_medium=web&utm_source=artist_page&utm_campaign=search_bar
2025-06-18 16:09:04 [root] INFO: should_process_url: URL https://www.shopify.com?utm_campaign=poweredby&utm_medium=shopify&utm_source=onlinestore was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:09:04 [root] INFO: should_process_url: URL https://privacy-policy.sandbagheadquarters.com/ has never been seen before, processing it.
2025-06-18 16:09:04 [root] INFO: should_process_url: URL https://privacy-policy.sandbagheadquarters.com/ has never been seen before, processing it.
2025-06-18 16:09:04 [root] INFO: write_url_to_db(): appended URL 'https://privacy-policy.sandbagheadquarters.com/'
2025-06-18 16:09:04 [root] INFO: def parse(): Crawling next URL: https://privacy-policy.sandbagheadquarters.com/
2025-06-18 16:09:04 [root] INFO: should_process_url: URL https://contact-us.sandbag-helpdesk.com/support/home has never been seen before, processing it.
2025-06-18 16:09:04 [root] INFO: should_process_url: URL https://contact-us.sandbag-helpdesk.com/support/home has never been seen before, processing it.
2025-06-18 16:09:04 [root] INFO: write_url_to_db(): appended URL 'https://contact-us.sandbag-helpdesk.com/support/home'
2025-06-18 16:09:04 [root] INFO: def parse(): Crawling next URL: https://contact-us.sandbag-helpdesk.com/support/home
2025-06-18 16:09:04 [root] INFO: should_process_url: URL https://bandofskulls.shop/ has never been seen before, processing it.
2025-06-18 16:09:04 [root] INFO: should_process_url: URL https://privacy-policy.sandbagheadquarters.com/terms-conditions-uk/ has never been seen before, processing it.
2025-06-18 16:09:04 [root] INFO: should_process_url: URL https://privacy-policy.sandbagheadquarters.com/terms-conditions-uk/ has never been seen before, processing it.
2025-06-18 16:09:04 [root] INFO: write_url_to_db(): appended URL 'https://privacy-policy.sandbagheadquarters.com/terms-conditions-uk/'
2025-06-18 16:09:04 [root] INFO: def parse(): Crawling next URL: https://privacy-policy.sandbagheadquarters.com/terms-conditions-uk/
2025-06-18 16:09:04 [root] INFO: def parse(): Found keywords for URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fstyle%2Fzouk%2F: ['dance', 'zouk']
2025-06-18 16:09:04 [root] INFO: def generate_prompt(): Generating prompt for URL: https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fstyle%2Fzouk%2F
2025-06-18 16:09:04 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:09:04 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:09:04 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:09:06 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:09:06 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 16:09:06 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 16:09:06 [root] INFO: write_url_to_db(): appended URL 'https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fstyle%2Fzouk%2F'
2025-06-18 16:09:06 [root] INFO: def parse(): URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fstyle%2Fzouk%2F marked as irrelevant (LLM negative).
2025-06-18 16:09:06 [root] INFO: def parse(): Found 0 links on https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fstyle%2Fzouk%2F
2025-06-18 16:09:06 [root] INFO: should_process_url: URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fstyle%2Fzouk%2F was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:09:06 [root] INFO: def parse(): Found keywords for URL https://goo.gl/maps/6sfzmTCG2vLCSHb8A: ['wcs']
2025-06-18 16:09:06 [root] INFO: def generate_prompt(): Generating prompt for URL: https://goo.gl/maps/6sfzmTCG2vLCSHb8A
2025-06-18 16:09:06 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:09:06 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:09:06 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:09:07 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:09:07 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 177547 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 16:09:07 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:09:18 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:09:18 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 16:09:18 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 16:09:18 [root] INFO: write_url_to_db(): appended URL 'https://goo.gl/maps/6sfzmTCG2vLCSHb8A'
2025-06-18 16:09:18 [root] INFO: def parse(): URL https://goo.gl/maps/6sfzmTCG2vLCSHb8A marked as irrelevant (LLM negative).
2025-06-18 16:09:18 [root] INFO: def parse(): Found 1 links on https://www.google.com/maps/place/101+E+Railroad+Ave,+Port+Angeles,+WA+98362/@48.1214622,-123.4333542,17z/data=!3m1!4b1!4m5!3m4!1s0x548fb1b79781f729:0x3ff7b6a76ebefbcc!8m2!3d48.1214586!4d-123.4311655?shorturl=1
2025-06-18 16:09:18 [root] INFO: parse: Skipping blacklisted URL https://support.google.com/maps/?hl=en&authuser=0&p=no_javascript.
2025-06-18 16:09:18 [root] INFO: should_process_url: URL https://goo.gl/maps/6sfzmTCG2vLCSHb8A was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:09:18 [root] INFO: def parse(): Found keywords for URL https://latindancecalendar.com/hello-bachata-festival/: ['bachata', 'dance', 'kizomba', 'salsa', 'zouk']
2025-06-18 16:09:18 [root] INFO: def generate_prompt(): Generating prompt for URL: https://latindancecalendar.com/hello-bachata-festival/
2025-06-18 16:09:18 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:09:18 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:09:18 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:24:19 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 504 Gateway Timeout"
2025-06-18 16:24:19 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 504
{
  "message":"The upstream server is timing out",
  "request_id":"905a7e08ec1f290249dd0a34007c6627"
}
2025-06-18 16:24:19 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:24:41 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:24:41 [root] INFO: query_llm(): OpenAI response received: [{
    "source": "Latin Dance Calendar",
    "dance_style": "bachata, salsa, kizomba",
    "url": "",
    "event_type": "other",
    "event_name": "San Francisco’s Hello! Bachata/Salsa/Zouk/Kizomba Dance Festival",
    "day_of_week": "Friday",
    "start_date": "2025-07-25",
    "end_date": "2025-07-25",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "San Francisco, USA",
    "description": "Dance festival featuring bachata, salsa, kizomba with 10% off available"
}]
2025-06-18 16:24:41 [root] INFO: def extract_and_parse_json(): for url https://latindancecalendar.com/hello-bachata-festival/, 
Cleaned JSON ready for parsing:
[{
    "source": "Latin Dance Calendar",
    "dance_style": "bachata, salsa, kizomba",
    "url": "",
    "event_type": "other",
    "event_name": "San Francisco’s Hello! Bachata/Salsa/Zouk/Kizomba Dance Festival",
    "day_of_week": "Friday",
    "start_date": "2025-07-25",
    "end_date": "2025-07-25",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "San Francisco, USA",
    "description": "Dance festival featuring bachata, salsa, kizomba with 10% off available"
}]
2025-06-18 16:24:41 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 16:24:41 [root] INFO: def clean_up_address(): Processing location 'San Francisco, USA' (event_id: None)
2025-06-18 16:24:41 [root] INFO: write_events_to_db: Number of events to write: 1
2025-06-18 16:24:41 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/hello-bachata-festival/'
2025-06-18 16:24:41 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 16:24:41 [root] INFO: def process_llm_response: URL https://latindancecalendar.com/hello-bachata-festival/ marked as relevant with events written to the database.
2025-06-18 16:24:41 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/hello-bachata-festival/'
2025-06-18 16:24:41 [root] INFO: def parse(): URL https://latindancecalendar.com/hello-bachata-festival/ marked as relevant (LLM positive).
2025-06-18 16:24:41 [root] INFO: def parse(): Found 10 links on https://latindancecalendar.com/hello-bachata-festival/
2025-06-18 16:24:41 [root] INFO: write_url_to_db(): appended URL 'https://facebook.com/HelloBachataFestival/'
2025-06-18 16:24:41 [root] INFO: def parse(): Recorded unwanted URL: https://facebook.com/HelloBachataFestival/
2025-06-18 16:24:41 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/dialog/send?app_id=321366148277289&link=https%3A%2F%2Flatindancecalendar.com%2Fhello-bachata-festival%2F%3Futm_source%3Dweb_share_fbmessenger&redirect_uri=https%3A%2F%2Flatindancecalendar.com%2Fhello-bachata-festival%2F%3Futm_source%3Dweb_share_fbmessenger'
2025-06-18 16:24:41 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/dialog/send?app_id=321366148277289&link=https%3A%2F%2Flatindancecalendar.com%2Fhello-bachata-festival%2F%3Futm_source%3Dweb_share_fbmessenger&redirect_uri=https%3A%2F%2Flatindancecalendar.com%2Fhello-bachata-festival%2F%3Futm_source%3Dweb_share_fbmessenger
2025-06-18 16:24:41 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flatindancecalendar.com%2Fhello-bachata-festival%2F%3Futm_source%3Dweb_share_fb'
2025-06-18 16:24:41 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flatindancecalendar.com%2Fhello-bachata-festival%2F%3Futm_source%3Dweb_share_fb
2025-06-18 16:24:41 [root] INFO: should_process_url: URL https://latindancecalendar.com/festivals/san-franciscos-hello-bachata-fest/ has never been seen before, processing it.
2025-06-18 16:24:41 [root] INFO: should_process_url: URL https://latindancecalendar.com/ was last seen as relevant, processing it.
2025-06-18 16:24:41 [root] INFO: should_process_url: URL https://closestays.com was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:24:41 [root] INFO: should_process_url: URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Fhello-bachata-festival%2F has never been seen before, processing it.
2025-06-18 16:24:41 [root] INFO: should_process_url: URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Fhello-bachata-festival%2F has never been seen before, processing it.
2025-06-18 16:24:41 [root] INFO: write_url_to_db(): appended URL 'https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Fhello-bachata-festival%2F'
2025-06-18 16:24:41 [root] INFO: def parse(): Crawling next URL: https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Fhello-bachata-festival%2F
2025-06-18 16:24:41 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/home?status=https%3A%2F%2Flatindancecalendar.com%2Fhello-bachata-festival%2F.
2025-06-18 16:24:41 [root] INFO: should_process_url: URL https://latindancecalendar.com/hello-bachata-festival/ has never been seen before, processing it.
2025-06-18 16:24:41 [root] INFO: should_process_url: URL https://hellobachatafestival.com/ has never been seen before, processing it.
2025-06-18 16:24:41 [root] INFO: def parse(): Found keywords for URL https://www.cohoferry.com/packages/victoria/hotel-grand-pacific-with-ferry: ['live music']
2025-06-18 16:24:41 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.cohoferry.com/packages/victoria/hotel-grand-pacific-with-ferry
2025-06-18 16:24:41 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:24:41 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:24:41 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:24:44 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:24:44 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 16:24:44 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 16:24:44 [root] INFO: write_url_to_db(): appended URL 'https://www.cohoferry.com/packages/victoria/hotel-grand-pacific-with-ferry'
2025-06-18 16:24:44 [root] INFO: def parse(): URL https://www.cohoferry.com/packages/victoria/hotel-grand-pacific-with-ferry marked as irrelevant (LLM negative).
2025-06-18 16:24:44 [root] INFO: def parse(): Found 10 links on https://www.cohoferry.com/packages/victoria/hotel-grand-pacific-with-ferry
2025-06-18 16:24:44 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-NBB6WGX, URL: https://www.cohoferry.com/packages/victoria/hotel-grand-pacific-with-ferry, source: Summer Festivals in Victoria, BC | Black Ball Ferry Line, keywords: music festivals
2025-06-18 16:24:44 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 16:24:44 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-NBB6WGX
2025-06-18 16:24:44 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-NBB6WGX'
2025-06-18 16:24:44 [root] INFO: write_url_to_db(): appended URL 'http://instagram.com/mvcoho'
2025-06-18 16:24:44 [root] INFO: def parse(): Recorded unwanted URL: http://instagram.com/mvcoho
2025-06-18 16:24:44 [root] INFO: write_url_to_db(): appended URL 'http://www.facebook.com/mvcoho'
2025-06-18 16:24:44 [root] INFO: def parse(): Recorded unwanted URL: http://www.facebook.com/mvcoho
2025-06-18 16:24:44 [root] INFO: should_process_url: URL https://shop.blackball.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:24:44 [root] INFO: should_process_url: URL https://www.heronrockbistro.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:24:44 [root] INFO: should_process_url: URL https://www.heronrockbistro.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:24:44 [root] INFO: write_url_to_db(): appended URL 'https://www.heronrockbistro.ca/'
2025-06-18 16:24:44 [root] INFO: def parse(): Crawling next URL: https://www.heronrockbistro.ca/
2025-06-18 16:24:44 [root] INFO: should_process_url: URL https://www.cohoferry.com/packages/victoria/victoria-carriage-tours-with-ferry was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:24:44 [root] INFO: should_process_url: URL https://www.cohoferry.com/packages/victoria/victoria-carriage-tours-with-ferry was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:24:44 [root] INFO: write_url_to_db(): appended URL 'https://www.cohoferry.com/packages/victoria/victoria-carriage-tours-with-ferry'
2025-06-18 16:24:44 [root] INFO: def parse(): Crawling next URL: https://www.cohoferry.com/packages/victoria/victoria-carriage-tours-with-ferry
2025-06-18 16:24:44 [root] INFO: should_process_url: URL https://www.cohoferry.com/packages/victoria/hotel-grand-pacific-with-ferry was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:24:44 [root] INFO: parse: Skipping blacklisted URL http://www.twitter.com/mvcoho.
2025-06-18 16:24:44 [root] INFO: should_process_url: URL https://app.e2ma.net/app2/audience/signup/2008664/1726574/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:24:44 [root] INFO: should_process_url: URL https://www.cohoferry.com/packages/victoria/afternoon-tea-at-the-pendray-tea-house-with-ferry was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:24:44 [root] INFO: should_process_url: URL https://www.cohoferry.com/packages/victoria/afternoon-tea-at-the-pendray-tea-house-with-ferry was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:24:44 [root] INFO: write_url_to_db(): appended URL 'https://www.cohoferry.com/packages/victoria/afternoon-tea-at-the-pendray-tea-house-with-ferry'
2025-06-18 16:24:44 [root] INFO: def parse(): Crawling next URL: https://www.cohoferry.com/packages/victoria/afternoon-tea-at-the-pendray-tea-house-with-ferry
2025-06-18 16:24:44 [root] INFO: should_process_url: URL https://thecourtneyroom.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:24:44 [root] INFO: should_process_url: URL https://thecourtneyroom.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:24:44 [root] INFO: write_url_to_db(): appended URL 'https://thecourtneyroom.com/'
2025-06-18 16:24:44 [root] INFO: def parse(): Crawling next URL: https://thecourtneyroom.com/
2025-06-18 16:24:44 [root] INFO: def parse(): Found keywords for URL https://latindancecalendar.com/festivals/berlin-salsacongress/: ['bachata', 'dance', 'kizomba', 'salsa', 'zouk']
2025-06-18 16:24:44 [root] INFO: def generate_prompt(): Generating prompt for URL: https://latindancecalendar.com/festivals/berlin-salsacongress/
2025-06-18 16:24:44 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:24:44 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:24:44 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:24:46 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:24:46 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 146484 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 16:24:46 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:25:12 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:25:12 [root] INFO: query_llm(): OpenAI response received: [{
    "source": "Latin Dance Calendar",
    "dance_style": "salsa",
    "url": "",
    "event_type": "other",
    "event_name": "Berlin Salsacongress 2025",
    "day_of_week": "Thursday",
    "start_date": "2025-08-28",
    "end_date": "2025-08-28",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Tempodrom Berlin, Möckernstraße 10, 10963 Berlin",
    "description": "25 years of making history together!"
}]
2025-06-18 16:25:12 [root] INFO: def extract_and_parse_json(): for url https://latindancecalendar.com/festivals/berlin-salsacongress/, 
Cleaned JSON ready for parsing:
[{
    "source": "Latin Dance Calendar",
    "dance_style": "salsa",
    "url": "",
    "event_type": "other",
    "event_name": "Berlin Salsacongress 2025",
    "day_of_week": "Thursday",
    "start_date": "2025-08-28",
    "end_date": "2025-08-28",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Tempodrom Berlin, Möckernstraße 10, 10963 Berlin",
    "description": "25 years of making history together!"
}]
2025-06-18 16:25:12 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 16:25:12 [root] INFO: def clean_up_address(): Processing location 'Tempodrom Berlin, Möckernstraße 10, 10963 Berlin' (event_id: None)
2025-06-18 16:25:12 [root] INFO: write_events_to_db: Number of events to write: 1
2025-06-18 16:25:12 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/festivals/berlin-salsacongress/'
2025-06-18 16:25:12 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 16:25:12 [root] INFO: def process_llm_response: URL https://latindancecalendar.com/festivals/berlin-salsacongress/ marked as relevant with events written to the database.
2025-06-18 16:25:12 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/festivals/berlin-salsacongress/'
2025-06-18 16:25:12 [root] INFO: def parse(): URL https://latindancecalendar.com/festivals/berlin-salsacongress/ marked as relevant (LLM positive).
2025-06-18 16:25:12 [root] INFO: def parse(): Found 10 links on https://latindancecalendar.com/festivals/berlin-salsacongress/
2025-06-18 16:25:12 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.stay22.com/embed/gm?aid=latindancecalendar&maincolor=FFFFFF&adults=1&showothers=true&checkin=2025-08-28&checkout=2025-08-29&markerimage=https%3A%2F%2Flatindancecalendar.com%2Fdancecal%2Fwp-content%2Fuploads%2F810236179_222841940230_1-1-350x350.jpeg&lat=52.50162599999999&lng=13.381228&campaign=festival116712&campaign=festivalPageGPS, URL: https://latindancecalendar.com/festivals/berlin-salsacongress/, source: Zouk Dancing Festivals Worldwide (Updated 2025), keywords: zouk
2025-06-18 16:25:12 [root] WARNING: def decode_calendar_id(): Exception for https://www.stay22.com/embed/gm?aid=latindancecalendar&maincolor=FFFFFF&adults=1&showothers=true&checkin=2025-08-28&checkout=2025-08-29&markerimage=https%3A%2F%2Flatindancecalendar.com%2Fdancecal%2Fwp-content%2Fuploads%2F810236179_222841940230_1-1-350x350.jpeg&lat=52.50162599999999&lng=13.381228&campaign=festival116712&campaign=festivalPageGPS - Incorrect padding
2025-06-18 16:25:12 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.stay22.com/embed/gm?aid=latindancecalendar&maincolor=FFFFFF&adults=1&showothers=true&checkin=2025-08-28&checkout=2025-08-29&markerimage=https%3A%2F%2Flatindancecalendar.com%2Fdancecal%2Fwp-content%2Fuploads%2F810236179_222841940230_1-1-350x350.jpeg&lat=52.50162599999999&lng=13.381228&campaign=festival116712&campaign=festivalPageGPS
2025-06-18 16:25:12 [root] INFO: write_url_to_db(): appended URL 'https://www.stay22.com/embed/gm?aid=latindancecalendar&maincolor=FFFFFF&adults=1&showothers=true&checkin=2025-08-28&checkout=2025-08-29&markerimage=https%3A%2F%2Flatindancecalendar.com%2Fdancecal%2Fwp-content%2Fuploads%2F810236179_222841940230_1-1-350x350.jpeg&lat=52.50162599999999&lng=13.381228&campaign=festival116712&campaign=festivalPageGPS'
2025-06-18 16:25:12 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fberlin-salsacongress%2F%3Futm_source%3Dweb_share_fb'
2025-06-18 16:25:12 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fberlin-salsacongress%2F%3Futm_source%3Dweb_share_fb
2025-06-18 16:25:12 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/dialog/send?app_id=321366148277289&link=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fberlin-salsacongress%2F%3Futm_source%3Dweb_share_fbmessenger&redirect_uri=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fberlin-salsacongress%2F%3Futm_source%3Dweb_share_fbmessenger'
2025-06-18 16:25:12 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/dialog/send?app_id=321366148277289&link=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fberlin-salsacongress%2F%3Futm_source%3Dweb_share_fbmessenger&redirect_uri=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fberlin-salsacongress%2F%3Futm_source%3Dweb_share_fbmessenger
2025-06-18 16:25:12 [root] INFO: should_process_url: URL https://latindancecalendar.com/ was last seen as relevant, processing it.
2025-06-18 16:25:12 [root] INFO: should_process_url: URL https://closestays.com was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:25:12 [root] INFO: should_process_url: URL https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fberlin-salsacongress%2F has never been seen before, processing it.
2025-06-18 16:25:12 [root] INFO: should_process_url: URL https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fberlin-salsacongress%2F has never been seen before, processing it.
2025-06-18 16:25:12 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fberlin-salsacongress%2F'
2025-06-18 16:25:12 [root] INFO: def parse(): Crawling next URL: https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fberlin-salsacongress%2F
2025-06-18 16:25:12 [root] INFO: should_process_url: URL https://latindancecalendar.com/festivals/berlin-salsacongress/ has never been seen before, processing it.
2025-06-18 16:25:12 [root] INFO: should_process_url: URL https://closestays.com/stays/?address=M%C3%B6ckernstra%C3%9Fe+10%2C+10963+Berlin has never been seen before, processing it.
2025-06-18 16:25:12 [root] INFO: should_process_url: URL https://closestays.com/stays/?address=M%C3%B6ckernstra%C3%9Fe+10%2C+10963+Berlin has never been seen before, processing it.
2025-06-18 16:25:12 [root] INFO: write_url_to_db(): appended URL 'https://closestays.com/stays/?address=M%C3%B6ckernstra%C3%9Fe+10%2C+10963+Berlin'
2025-06-18 16:25:12 [root] INFO: def parse(): Crawling next URL: https://closestays.com/stays/?address=M%C3%B6ckernstra%C3%9Fe+10%2C+10963+Berlin
2025-06-18 16:25:12 [root] INFO: should_process_url: URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fberlin-salsacongress%2F has never been seen before, processing it.
2025-06-18 16:25:12 [root] INFO: should_process_url: URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fberlin-salsacongress%2F has never been seen before, processing it.
2025-06-18 16:25:12 [root] INFO: write_url_to_db(): appended URL 'https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fberlin-salsacongress%2F'
2025-06-18 16:25:12 [root] INFO: def parse(): Crawling next URL: https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fberlin-salsacongress%2F
2025-06-18 16:25:12 [root] INFO: should_process_url: URL https://latindancecalendar.com/berlin-salsacongress/ has never been seen before, processing it.
2025-06-18 16:25:12 [root] INFO: should_process_url: URL https://latindancecalendar.com/berlin-salsacongress/ has never been seen before, processing it.
2025-06-18 16:25:12 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/berlin-salsacongress/'
2025-06-18 16:25:12 [root] INFO: def parse(): Crawling next URL: https://latindancecalendar.com/berlin-salsacongress/
2025-06-18 16:25:12 [root] INFO: should_process_url: URL https://www.berlinsalsacongress.co has never been seen before, processing it.
2025-06-18 16:25:12 [root] INFO: should_process_url: URL https://www.berlinsalsacongress.co has never been seen before, processing it.
2025-06-18 16:25:12 [root] INFO: write_url_to_db(): appended URL 'https://www.berlinsalsacongress.co'
2025-06-18 16:25:12 [root] INFO: def parse(): Crawling next URL: https://www.berlinsalsacongress.co
2025-06-18 16:25:12 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/home?status=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fberlin-salsacongress%2F.
2025-06-18 16:25:12 [root] INFO: def parse(): Found keywords for URL https://latindancecalendar.com/festivals/?show=map: ['bachata', 'dance', 'kizomba', 'merengue', 'rumba', 'salsa', 'samba', 'semba', 'tango', 'urban kiz', 'zouk']
2025-06-18 16:25:12 [root] INFO: def generate_prompt(): Generating prompt for URL: https://latindancecalendar.com/festivals/?show=map
2025-06-18 16:25:12 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:25:12 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:25:12 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:26:34 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:26:34 [root] INFO: query_llm(): Mistral response received: <linkhref="https://latindancecalendar.com/dancecal/wp-admin/admin-ajax.php" id="wp-admin-bar-reorder-posts" class="hidden" title="Reorder posts page 1">
	<link href="https://latindancecalendar.com/dancecal/wp-admin/admin-ajax.php" id="wp-admin-bar-reorder-terms" class="hidden" title="Reorder categories page 1">
	<link href="https://latindancecalendar.com/dancecal/wp-admin/admin-ajax.php" id="wp-admin-bar-reorder-media" class="hidden" title="Reorder media page 1">
	<link href="https://latindancecalendar.com/dancecal/wp-admin/admin-ajax.php" id="wp-admin-bar-reorder-links" class="hidden" title="Reorder links menu items page 1">
	<link href="https://latindancecalendar.com/dancecal/wp-admin/admin-ajax.php" id="wp-admin-bar-reorder-widgets" class="hidden" title="Reorder widgets page 1">
	<link href="https://latindancecalendar.com/dancecal/wp-admin/admin-ajax.php" id="wp-admin-bar-reorder-sidebars" class="hidden" title="Reorder sidebars page 1">
	<link href="https://latindancecalendar.com/dancecal/wp-admin/admin-ajax.php" id="wp-admin-bar-reorder-dashboard" class="hidden" title="Reorder dashboard widgets page 1">
	<link href="https://latindancecalendar.com/dancecal/wp-admin/admin-ajax.php" id="wp-admin-bar-reorder-menus" class="hidden" title="Reorder admin menu page 1">
	<link href="https://latindancecalendar.com/dancecal/wp-admin/admin-ajax.php" id="wp-admin-bar-reorder-link-categories" class="hidden" title="Reorder link categories page 1">
	<link href="https://latindancecalendar.com/dancecal/wp-admin/admin-ajax.php" id="wp-admin-bar-reorder-meta-boxes" class="hidden" title="Reorder meta boxes page 1">
2025-06-18 16:26:34 [root] ERROR: def extract_and_parse_json(): couldn't isolate JSON blob in result from https://latindancecalendar.com/festivals/?show=map
2025-06-18 16:26:34 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/festivals/?show=map'
2025-06-18 16:26:34 [root] INFO: def parse(): URL https://latindancecalendar.com/festivals/?show=map marked as irrelevant (LLM negative).
2025-06-18 16:26:34 [root] INFO: def parse(): Found 10 links on https://latindancecalendar.com/festivals/?show=map
2025-06-18 16:26:34 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/dialog/send?app_id=321366148277289&link=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2F%3Fshow%3Dmap%26utm_source%3Dweb_share_fbmessenger&redirect_uri=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2F%3Fshow%3Dmap%26utm_source%3Dweb_share_fbmessenger'
2025-06-18 16:26:34 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/dialog/send?app_id=321366148277289&link=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2F%3Fshow%3Dmap%26utm_source%3Dweb_share_fbmessenger&redirect_uri=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2F%3Fshow%3Dmap%26utm_source%3Dweb_share_fbmessenger
2025-06-18 16:26:34 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2F%3Fshow%3Dmap%26utm_source%3Dweb_share_fb'
2025-06-18 16:26:34 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2F%3Fshow%3Dmap%26utm_source%3Dweb_share_fb
2025-06-18 16:26:34 [root] INFO: should_process_url: URL https://latindancecalendar.com/ was last seen as relevant, processing it.
2025-06-18 16:26:34 [root] INFO: should_process_url: URL https://closestays.com was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:26:34 [root] INFO: should_process_url: URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2F%3Fshow%3Dmap was last seen as relevant, processing it.
2025-06-18 16:26:34 [root] INFO: should_process_url: URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2F%3Fshow%3Dmap was last seen as relevant, processing it.
2025-06-18 16:26:34 [root] INFO: write_url_to_db(): appended URL 'https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2F%3Fshow%3Dmap'
2025-06-18 16:26:34 [root] INFO: def parse(): Crawling next URL: https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2F%3Fshow%3Dmap
2025-06-18 16:26:34 [root] INFO: def parse(): Found keywords for URL https://vbds.org/vbds-practices/: ['cha cha', 'dance', 'foxtrot', 'line dance', 'quickstep', 'rumba', 'samba', 'swing', 'tango', 'waltz', 'west coast swing']
2025-06-18 16:26:34 [root] INFO: def generate_prompt(): Generating prompt for URL: https://vbds.org/vbds-practices/
2025-06-18 16:26:34 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:26:34 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:26:34 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:29:44 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:29:44 [root] INFO: query_llm(): Mistral response received: <script type="text/javascript">
/* <![CDATA[ */
/* Validate */
var extractedData = [];
var error = null;
try {
	const jsonString = `
		[
			{
				"source": "extracted text/javascript",
				"events": [
					{
						"url": "https://vbds.org/events/dance-practice-silver-and-above-copy-copy-copy-2-copy-2025-06-01/",
						"type": "social dance",
						"start_time": "2025-06-01T11:30:00",
						"end_time": "2025-06-01T12:30:00",
						"recurrence": "weekly",
						"price": "$0.00",
						"categories": "vbds events",
						"description": "Practice - Silver and above When: Sundays 11:30 am - 1:00 pm Where: Les Passmore Centre This practice is restricted to those dancing at ...",
						"day_of_week": "Sunday",
						"start_time": "11:30 AM",
						"end_time": "1:00 PM",
						"all_day": false,
						"location": {
							"name": "Les Passmore Centre",
							"address": "650 Pear St, Victoria, BC V8V 2K5, Canada",
							"url": "https://maps.google.com/maps?q=650%20Pear%20St,%20Victoria,%20BC%20V8V%202K5,%20Canada&z=5",
								"geometry": {
								"type": "Point",
								"coordinates": [
										-48.4555963,
										-123.364493
									]
								},
							"organizer": {
								"organizer_name": "Victoria Ballroom Dance Society",
								"organizer_contact_info": {
									"contact_type": "web page",
									"url": "https://vbds.org/locations/les-passmore-centre/",
									"email": ""
								}
							}
					},
					"image": "https://maps.google.com/maps?q=650%20Pear%20St,%20Victoria,%20BC%20V8V%202K5,%20Canada&z=5&output=embed",
					"event_url": "https://vbds.org/events/dance-practice-silver-and-above-copy-copy-copy-2-copy-2025-06-01/"
			},
				{
					"source": "extracted text/javascript",
					"events": [
						{
							"url": "https://vbds.org/events/dance-practice-silver-and-above-copy-copy-copy-2-copy-2025-06-01/",
							"type": "social dance",
							"start_time": "2025-06-01T11:30:00",
							"end_time": "2025-06-01T12:30:00",
							"recurrence": "weekly",
							"price": "$0.00",
							"categories": "vbds events",
								"description": "Practice - Silver and above When: Sundays 11:30 am - 1:00 pm Where: Les Passmore Centre This practice is restricted to
2025-06-18 16:29:44 [root] INFO: def extract_and_parse_json(): for url https://vbds.org/vbds-practices/, 
Cleaned JSON ready for parsing:
[{
	const jsonString = `
		[
			{
				"source": "extracted text/javascript",
				"events": [
					{
						"url": "https://vbds.org/events/dance-practice-silver-and-above-copy-copy-copy-2-copy-2025-06-01/",
						"type": "social dance",
						"start_time": "2025-06-01T11:30:00",
						"end_time": "2025-06-01T12:30:00",
						"recurrence": "weekly",
						"price": "$0.00",
						"categories": "vbds events",
						"description": "Practice - Silver and above When: Sundays 11:30 am - 1:00 pm Where: Les Passmore Centre This practice is restricted to those dancing at ",
						"day_of_week": "Sunday",
						"start_time": "11:30 AM",
						"end_time": "1:00 PM",
						"all_day": false,
						"location": {
							"name": "Les Passmore Centre",
							"address": "650 Pear St, Victoria, BC V8V 2K5, Canada",
							"url": "https://maps.google.com/maps?q=650%20Pear%20St,%20Victoria,%20BC%20V8V%202K5,%20Canada&z=5",
								"geometry": {
								"type": "Point",
								"coordinates": [
										-48.4555963,
										-123.364493
									]
								},
							"organizer": {
								"organizer_name": "Victoria Ballroom Dance Society",
								"organizer_contact_info": {
									"contact_type": "web page",
									"url": "https://vbds.org/locations/les-passmore-centre/",
									"email": ""
								}
							}
					},
					"image": "https://maps.google.com/maps?q=650%20Pear%20St,%20Victoria,%20BC%20V8V%202K5,%20Canada&z=5&output=embed",
					"event_url": "https://vbds.org/events/dance-practice-silver-and-above-copy-copy-copy-2-copy-2025-06-01/"
			}]
2025-06-18 16:29:44 [root] ERROR: def extract_and_parse_json(): Error parsing JSON: Expecting property name enclosed in double quotes: line 2 column 2 (char 4)
2025-06-18 16:29:44 [root] INFO: write_url_to_db(): appended URL 'https://vbds.org/vbds-practices/'
2025-06-18 16:29:44 [root] INFO: def parse(): URL https://vbds.org/vbds-practices/ marked as irrelevant (LLM negative).
2025-06-18 16:29:44 [root] INFO: def parse(): Found 10 links on https://vbds.org/vbds-practices/
2025-06-18 16:29:44 [root] INFO: should_process_url: URL https://vbds.org/login/ was last seen as relevant, processing it.
2025-06-18 16:29:44 [root] INFO: should_process_url: URL https://vbds.org/vbds-practices/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:29:44 [root] INFO: should_process_url: URL https://vbds.org/ was last seen as relevant, processing it.
2025-06-18 16:29:44 [root] INFO: should_process_url: URL https://vbds.org/upcoming-classes-workshops/ was last seen as relevant, processing it.
2025-06-18 16:29:44 [root] INFO: should_process_url: URL https://vbds.org/calendar/ was last seen as relevant, processing it.
2025-06-18 16:29:44 [root] INFO: should_process_url: URL https://vbds.org/members/ was last seen as relevant, processing it.
2025-06-18 16:29:44 [root] INFO: should_process_url: URL https://vbds.org/introduction-to-ballroom-dancing/ was last seen as relevant, processing it.
2025-06-18 16:29:44 [root] INFO: def parse(): Found keywords for URL https://vbds.org/login/: ['cha cha', 'dance', 'foxtrot', 'line dance', 'quickstep', 'rumba', 'samba', 'swing', 'tango', 'waltz', 'west coast swing']
2025-06-18 16:29:44 [root] INFO: def generate_prompt(): Generating prompt for URL: https://vbds.org/login/
2025-06-18 16:29:44 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:29:44 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:29:44 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:30:09 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:30:09 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 16:30:09 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 16:30:09 [root] INFO: write_url_to_db(): appended URL 'https://vbds.org/login/'
2025-06-18 16:30:09 [root] INFO: def parse(): URL https://vbds.org/login/ marked as irrelevant (LLM negative).
2025-06-18 16:30:09 [root] INFO: def parse(): Found 10 links on https://vbds.org/login/
2025-06-18 16:30:09 [root] INFO: should_process_url: URL https://vbds.org/login/ was last seen as relevant, processing it.
2025-06-18 16:30:09 [root] INFO: should_process_url: URL https://vbds.org/vbds-practices/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:30:09 [root] INFO: should_process_url: URL https://vbds.org/ was last seen as relevant, processing it.
2025-06-18 16:30:09 [root] INFO: should_process_url: URL https://vbds.org/upcoming-classes-workshops/ was last seen as relevant, processing it.
2025-06-18 16:30:09 [root] INFO: should_process_url: URL https://vbds.org/calendar/ was last seen as relevant, processing it.
2025-06-18 16:30:09 [root] INFO: should_process_url: URL https://vbds.org/members/ was last seen as relevant, processing it.
2025-06-18 16:30:09 [root] INFO: should_process_url: URL https://vbds.org/introduction-to-ballroom-dancing/ was last seen as relevant, processing it.
2025-06-18 16:30:09 [root] INFO: def parse(): Found keywords for URL https://goo.gl/maps/JfDSiXsnyoJSJ65s6: ['semba', 'wcs']
2025-06-18 16:30:09 [root] INFO: def generate_prompt(): Generating prompt for URL: https://goo.gl/maps/JfDSiXsnyoJSJ65s6
2025-06-18 16:30:09 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:30:09 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:30:09 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:30:11 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:30:11 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 263570 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 16:30:11 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:30:28 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:30:28 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 16:30:28 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 16:30:28 [root] INFO: write_url_to_db(): appended URL 'https://goo.gl/maps/JfDSiXsnyoJSJ65s6'
2025-06-18 16:30:28 [root] INFO: def parse(): URL https://goo.gl/maps/JfDSiXsnyoJSJ65s6 marked as irrelevant (LLM negative).
2025-06-18 16:30:28 [root] INFO: def parse(): Found 1 links on https://www.google.com/maps/place/Black+Ball+Ferry+Line/@48.4213007,-123.3742394,17z/data=!3m1!4b1!4m5!3m4!1s0x548f74975bb61f8f:0x88e8da815d0a4eb9!8m2!3d48.4212972!4d-123.3720507?shorturl=1
2025-06-18 16:30:28 [root] INFO: parse: Skipping blacklisted URL https://support.google.com/maps/?hl=en&authuser=0&p=no_javascript.
2025-06-18 16:30:28 [root] INFO: should_process_url: URL https://goo.gl/maps/JfDSiXsnyoJSJ65s6 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:30:28 [root] INFO: should_process_url: URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=849631&page=1 has never been seen before, processing it.
2025-06-18 16:30:28 [root] INFO: should_process_url: URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=849631&page=1 has never been seen before, processing it.
2025-06-18 16:30:28 [root] INFO: write_url_to_db(): appended URL 'http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=849631&page=1'
2025-06-18 16:30:28 [root] INFO: def parse(): Crawling next URL: http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=849631&page=1
2025-06-18 16:30:28 [scrapy.extensions.logstats] INFO: Crawled 281 pages (at 1 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 16:30:28 [root] INFO: should_process_url: URL https://latindancecalendar.com/add/?type=festival&referer=feed was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:30:28 [root] INFO: should_process_url: URL https://latindancecalendar.com/add/?type=festival&referer=feed was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:30:28 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/add/?type=festival&referer=feed'
2025-06-18 16:30:28 [root] INFO: def parse(): Crawling next URL: https://latindancecalendar.com/add/?type=festival&referer=feed
2025-06-18 16:30:28 [root] INFO: should_process_url: URL https://www.pgmusic.com/bbmac.packages.htm has never been seen before, processing it.
2025-06-18 16:30:28 [root] INFO: should_process_url: URL https://www.pgmusic.com/bbmac.packages.htm has never been seen before, processing it.
2025-06-18 16:30:28 [root] INFO: write_url_to_db(): appended URL 'https://www.pgmusic.com/bbmac.packages.htm'
2025-06-18 16:30:28 [root] INFO: def parse(): Crawling next URL: https://www.pgmusic.com/bbmac.packages.htm
2025-06-18 16:30:28 [root] INFO: should_process_url: URL https://latindancecalendar.com/festivals/?show=map was last seen as relevant, processing it.
2025-06-18 16:30:28 [root] INFO: should_process_url: URL https://latindancecalendar.com/festivals/portland-salsa-congress/ has never been seen before, processing it.
2025-06-18 16:30:28 [root] INFO: should_process_url: URL https://latindancecalendar.com/festivals/portland-salsa-congress/ has never been seen before, processing it.
2025-06-18 16:30:28 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/festivals/portland-salsa-congress/'
2025-06-18 16:30:28 [root] INFO: def parse(): Crawling next URL: https://latindancecalendar.com/festivals/portland-salsa-congress/
2025-06-18 16:30:28 [root] INFO: should_process_url: URL https://www.pgmusic.com/ has never been seen before, processing it.
2025-06-18 16:30:28 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/home?status=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2F%3Fshow%3Dmap.
2025-06-18 16:30:28 [root] INFO: def parse(): Found keywords for URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fsan-franciscos-hello-bachata-fest%2F: ['bachata', 'dance']
2025-06-18 16:30:28 [root] INFO: def generate_prompt(): Generating prompt for URL: https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fsan-franciscos-hello-bachata-fest%2F
2025-06-18 16:30:28 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:30:28 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:30:28 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:30:30 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:30:30 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 16:30:30 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 16:30:30 [root] INFO: write_url_to_db(): appended URL 'https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fsan-franciscos-hello-bachata-fest%2F'
2025-06-18 16:30:30 [root] INFO: def parse(): URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fsan-franciscos-hello-bachata-fest%2F marked as irrelevant (LLM negative).
2025-06-18 16:30:30 [root] INFO: def parse(): Found 0 links on https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fsan-franciscos-hello-bachata-fest%2F
2025-06-18 16:30:30 [root] INFO: should_process_url: URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fsan-franciscos-hello-bachata-fest%2F has never been seen before, processing it.
2025-06-18 16:30:30 [root] INFO: def parse(): Found keywords for URL https://latindancecalendar.com/festivals/viva-kizomba-congress-amsterdam/: ['bachata', 'dance', 'kizomba', 'salsa', 'zouk']
2025-06-18 16:30:30 [root] INFO: def generate_prompt(): Generating prompt for URL: https://latindancecalendar.com/festivals/viva-kizomba-congress-amsterdam/
2025-06-18 16:30:30 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:30:30 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:30:30 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:30:31 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:30:31 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 144404 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 16:30:31 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:30:55 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:30:55 [root] INFO: query_llm(): OpenAI response received: [{
    "source": "Latin Dance Calendar",
    "dance_style": "kizomba",
    "url": "",
    "event_type": "other",
    "event_name": "VIVA KIZOMBA CONGRESS AMSTERDAM 2025 – EDITION 8",
    "day_of_week": "Wednesday",
    "start_date": "2025-07-30",
    "end_date": "2025-07-30",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Amsterdam, Netherlands",
    "description": "There is no description available. Please check the link for more information."
}]
2025-06-18 16:30:55 [root] INFO: def extract_and_parse_json(): for url https://latindancecalendar.com/festivals/viva-kizomba-congress-amsterdam/, 
Cleaned JSON ready for parsing:
[{
    "source": "Latin Dance Calendar",
    "dance_style": "kizomba",
    "url": "",
    "event_type": "other",
    "event_name": "VIVA KIZOMBA CONGRESS AMSTERDAM 2025 – EDITION 8",
    "day_of_week": "Wednesday",
    "start_date": "2025-07-30",
    "end_date": "2025-07-30",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Amsterdam, Netherlands",
    "description": "There is no description available. Please check the link for more information."
}]
2025-06-18 16:30:55 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 16:30:55 [root] INFO: def clean_up_address(): Processing location 'Amsterdam, Netherlands' (event_id: None)
2025-06-18 16:30:55 [root] INFO: write_events_to_db: Number of events to write: 1
2025-06-18 16:30:55 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/festivals/viva-kizomba-congress-amsterdam/'
2025-06-18 16:30:55 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 16:30:55 [root] INFO: def process_llm_response: URL https://latindancecalendar.com/festivals/viva-kizomba-congress-amsterdam/ marked as relevant with events written to the database.
2025-06-18 16:30:55 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/festivals/viva-kizomba-congress-amsterdam/'
2025-06-18 16:30:55 [root] INFO: def parse(): URL https://latindancecalendar.com/festivals/viva-kizomba-congress-amsterdam/ marked as relevant (LLM positive).
2025-06-18 16:30:55 [root] INFO: def parse(): Found 10 links on https://latindancecalendar.com/festivals/viva-kizomba-congress-amsterdam/
2025-06-18 16:30:55 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.stay22.com/embed/gm?aid=latindancecalendar&maincolor=FFFFFF&adults=1&showothers=true&checkin=2025-07-30&checkout=2025-07-31&address=Amsterdam%2C+Netherlands&isnear=false&campaign=festival116747&campaign=festivalPageRegion, URL: https://latindancecalendar.com/festivals/viva-kizomba-congress-amsterdam/, source: Zouk Dancing Festivals Worldwide (Updated 2025), keywords: zouk
2025-06-18 16:30:55 [root] WARNING: def decode_calendar_id(): Exception for https://www.stay22.com/embed/gm?aid=latindancecalendar&maincolor=FFFFFF&adults=1&showothers=true&checkin=2025-07-30&checkout=2025-07-31&address=Amsterdam%2C+Netherlands&isnear=false&campaign=festival116747&campaign=festivalPageRegion - Incorrect padding
2025-06-18 16:30:55 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.stay22.com/embed/gm?aid=latindancecalendar&maincolor=FFFFFF&adults=1&showothers=true&checkin=2025-07-30&checkout=2025-07-31&address=Amsterdam%2C+Netherlands&isnear=false&campaign=festival116747&campaign=festivalPageRegion
2025-06-18 16:30:55 [root] INFO: write_url_to_db(): appended URL 'https://www.stay22.com/embed/gm?aid=latindancecalendar&maincolor=FFFFFF&adults=1&showothers=true&checkin=2025-07-30&checkout=2025-07-31&address=Amsterdam%2C+Netherlands&isnear=false&campaign=festival116747&campaign=festivalPageRegion'
2025-06-18 16:30:55 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/dialog/send?app_id=321366148277289&link=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fviva-kizomba-congress-amsterdam%2F%3Futm_source%3Dweb_share_fbmessenger&redirect_uri=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fviva-kizomba-congress-amsterdam%2F%3Futm_source%3Dweb_share_fbmessenger'
2025-06-18 16:30:55 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/dialog/send?app_id=321366148277289&link=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fviva-kizomba-congress-amsterdam%2F%3Futm_source%3Dweb_share_fbmessenger&redirect_uri=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fviva-kizomba-congress-amsterdam%2F%3Futm_source%3Dweb_share_fbmessenger
2025-06-18 16:30:55 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fviva-kizomba-congress-amsterdam%2F%3Futm_source%3Dweb_share_fb'
2025-06-18 16:30:55 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fviva-kizomba-congress-amsterdam%2F%3Futm_source%3Dweb_share_fb
2025-06-18 16:30:55 [root] INFO: should_process_url: URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fviva-kizomba-congress-amsterdam%2F has never been seen before, processing it.
2025-06-18 16:30:55 [root] INFO: should_process_url: URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fviva-kizomba-congress-amsterdam%2F has never been seen before, processing it.
2025-06-18 16:30:55 [root] INFO: write_url_to_db(): appended URL 'https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fviva-kizomba-congress-amsterdam%2F'
2025-06-18 16:30:55 [root] INFO: def parse(): Crawling next URL: https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fviva-kizomba-congress-amsterdam%2F
2025-06-18 16:30:55 [root] INFO: should_process_url: URL https://latindancecalendar.com/ was last seen as relevant, processing it.
2025-06-18 16:30:55 [root] INFO: should_process_url: URL https://closestays.com was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:30:55 [root] INFO: should_process_url: URL https://latindancecalendar.com/viva-kizomba-congress-amsterdam/ has never been seen before, processing it.
2025-06-18 16:30:55 [root] INFO: should_process_url: URL https://latindancecalendar.com/viva-kizomba-congress-amsterdam/ has never been seen before, processing it.
2025-06-18 16:30:55 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/viva-kizomba-congress-amsterdam/'
2025-06-18 16:30:55 [root] INFO: def parse(): Crawling next URL: https://latindancecalendar.com/viva-kizomba-congress-amsterdam/
2025-06-18 16:30:55 [root] INFO: should_process_url: URL https://latindancecalendar.com/festivals/viva-kizomba-congress-amsterdam/ has never been seen before, processing it.
2025-06-18 16:30:55 [root] INFO: should_process_url: URL https://www.goandance.com/en/event/8029/viva-latin-summer-2025-bachata-sensual-kizomba-8th-edition?promoter=LDC123 has never been seen before, processing it.
2025-06-18 16:30:55 [root] INFO: should_process_url: URL https://www.goandance.com/en/event/8029/viva-latin-summer-2025-bachata-sensual-kizomba-8th-edition?promoter=LDC123 has never been seen before, processing it.
2025-06-18 16:30:55 [root] INFO: write_url_to_db(): appended URL 'https://www.goandance.com/en/event/8029/viva-latin-summer-2025-bachata-sensual-kizomba-8th-edition?promoter=LDC123'
2025-06-18 16:30:55 [root] INFO: def parse(): Crawling next URL: https://www.goandance.com/en/event/8029/viva-latin-summer-2025-bachata-sensual-kizomba-8th-edition?promoter=LDC123
2025-06-18 16:30:55 [root] INFO: should_process_url: URL https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fviva-kizomba-congress-amsterdam%2F has never been seen before, processing it.
2025-06-18 16:30:55 [root] INFO: should_process_url: URL https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fviva-kizomba-congress-amsterdam%2F has never been seen before, processing it.
2025-06-18 16:30:55 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fviva-kizomba-congress-amsterdam%2F'
2025-06-18 16:30:55 [root] INFO: def parse(): Crawling next URL: https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fviva-kizomba-congress-amsterdam%2F
2025-06-18 16:30:55 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/home?status=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fviva-kizomba-congress-amsterdam%2F.
2025-06-18 16:30:55 [root] INFO: def parse(): Found keywords for URL https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fsan-franciscos-hello-bachata-fest%2F: ['bachata', 'dance', 'kizomba', 'salsa', 'zouk']
2025-06-18 16:30:56 [root] INFO: def generate_prompt(): Generating prompt for URL: https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fsan-franciscos-hello-bachata-fest%2F
2025-06-18 16:30:56 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:30:56 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:30:56 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:30:59 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:30:59 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 16:30:59 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 16:30:59 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fsan-franciscos-hello-bachata-fest%2F'
2025-06-18 16:30:59 [root] INFO: def parse(): URL https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fsan-franciscos-hello-bachata-fest%2F marked as irrelevant (LLM negative).
2025-06-18 16:30:59 [root] INFO: def parse(): Found 10 links on https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fsan-franciscos-hello-bachata-fest%2F
2025-06-18 16:30:59 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flatindancecalendar.com%2Freport-a-listing%2F%3Flisting-url%3Dhttps%253A%252F%252Flatindancecalendar.com%252Ffestivals%252Fsan-franciscos-hello-bachata-fest%252F%26utm_source%3Dweb_share_fb'
2025-06-18 16:30:59 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flatindancecalendar.com%2Freport-a-listing%2F%3Flisting-url%3Dhttps%253A%252F%252Flatindancecalendar.com%252Ffestivals%252Fsan-franciscos-hello-bachata-fest%252F%26utm_source%3Dweb_share_fb
2025-06-18 16:30:59 [root] INFO: write_url_to_db(): appended URL 'https://facebook.com/latindancecalendar'
2025-06-18 16:30:59 [root] INFO: def parse(): Recorded unwanted URL: https://facebook.com/latindancecalendar
2025-06-18 16:30:59 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/dialog/send?app_id=321366148277289&link=https%3A%2F%2Flatindancecalendar.com%2Freport-a-listing%2F%3Flisting-url%3Dhttps%253A%252F%252Flatindancecalendar.com%252Ffestivals%252Fsan-franciscos-hello-bachata-fest%252F%26utm_source%3Dweb_share_fbmessenger&redirect_uri=https%3A%2F%2Flatindancecalendar.com%2Freport-a-listing%2F%3Flisting-url%3Dhttps%253A%252F%252Flatindancecalendar.com%252Ffestivals%252Fsan-franciscos-hello-bachata-fest%252F%26utm_source%3Dweb_share_fbmessenger'
2025-06-18 16:30:59 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/dialog/send?app_id=321366148277289&link=https%3A%2F%2Flatindancecalendar.com%2Freport-a-listing%2F%3Flisting-url%3Dhttps%253A%252F%252Flatindancecalendar.com%252Ffestivals%252Fsan-franciscos-hello-bachata-fest%252F%26utm_source%3Dweb_share_fbmessenger&redirect_uri=https%3A%2F%2Flatindancecalendar.com%2Freport-a-listing%2F%3Flisting-url%3Dhttps%253A%252F%252Flatindancecalendar.com%252Ffestivals%252Fsan-franciscos-hello-bachata-fest%252F%26utm_source%3Dweb_share_fbmessenger
2025-06-18 16:30:59 [root] INFO: should_process_url: URL https://latindancecalendar.com/ was last seen as relevant, processing it.
2025-06-18 16:30:59 [root] INFO: should_process_url: URL https://closestays.com was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:30:59 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/LDCalendar.
2025-06-18 16:30:59 [root] INFO: should_process_url: URL https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fsan-franciscos-hello-bachata-fest%2F has never been seen before, processing it.
2025-06-18 16:30:59 [root] INFO: should_process_url: URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Freport-a-listing%2F%3Flisting-url%3Dhttps%253A%252F%252Flatindancecalendar.com%252Ffestivals%252Fsan-franciscos-hello-bachata-fest%252F has never been seen before, processing it.
2025-06-18 16:30:59 [root] INFO: should_process_url: URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Freport-a-listing%2F%3Flisting-url%3Dhttps%253A%252F%252Flatindancecalendar.com%252Ffestivals%252Fsan-franciscos-hello-bachata-fest%252F has never been seen before, processing it.
2025-06-18 16:30:59 [root] INFO: write_url_to_db(): appended URL 'https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Freport-a-listing%2F%3Flisting-url%3Dhttps%253A%252F%252Flatindancecalendar.com%252Ffestivals%252Fsan-franciscos-hello-bachata-fest%252F'
2025-06-18 16:30:59 [root] INFO: def parse(): Crawling next URL: https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Freport-a-listing%2F%3Flisting-url%3Dhttps%253A%252F%252Flatindancecalendar.com%252Ffestivals%252Fsan-franciscos-hello-bachata-fest%252F
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://plus.google.com/+Latindancecalendar was last seen as relevant, processing it.
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://plus.google.com/+Latindancecalendar was last seen as relevant, processing it.
2025-06-18 16:31:00 [root] INFO: write_url_to_db(): appended URL 'https://plus.google.com/+Latindancecalendar'
2025-06-18 16:31:00 [root] INFO: def parse(): Crawling next URL: https://plus.google.com/+Latindancecalendar
2025-06-18 16:31:00 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/home?status=https%3A%2F%2Flatindancecalendar.com%2Freport-a-listing%2F%3Flisting-url%3Dhttps%253A%252F%252Flatindancecalendar.com%252Ffestivals%252Fsan-franciscos-hello-bachata-fest%252F.
2025-06-18 16:31:00 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/signin/?referrer=%2Fd%2Fwa--bellingham%2Farts--events--today%2F'
2025-06-18 16:31:00 [root] INFO: def parse(): URL https://www.eventbrite.com/signin/?referrer=%2Fd%2Fwa--bellingham%2Farts--events--today%2F marked as irrelevant (no keywords).
2025-06-18 16:31:00 [root] INFO: def parse(): Found 0 links on https://www.eventbrite.com/signin/?referrer=%2Fd%2Fwa--bellingham%2Farts--events--today%2F
2025-06-18 16:31:00 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ, URL: https://www.eventbrite.com/signin/?referrer=%2Fd%2Fwa--bellingham%2Farts--events--today%2F, source: Best Arts Events Today in Bellingham, WA | Eventbrite, keywords: zouk
2025-06-18 16:31:00 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 16:31:00 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ
2025-06-18 16:31:00 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ'
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/?referrer=%2Fd%2Fwa--bellingham%2Farts--events--today%2F has never been seen before, processing it.
2025-06-18 16:31:00 [root] INFO: write_url_to_db(): appended URL 'https://www.butchartgardens.com/pet-policy/'
2025-06-18 16:31:00 [root] INFO: def parse(): URL https://www.butchartgardens.com/pet-policy/ marked as irrelevant (no keywords).
2025-06-18 16:31:00 [root] INFO: def parse(): Found 10 links on https://butchartgardens.com/pet-policy/
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/mediterranean-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/sunken-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://www.butchartgardens.com/pet-policy/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/italian-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/rose-garden/ was last seen as relevant, processing it.
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://butchartgardens.com/how-to-get-here/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/japanese-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://tickets.butchartgardens.com/WebStore/shop/viewItems.aspx?cg=tt&c=DAtt was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://butchartgardens.com/hours-rates/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://butchartgardens.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:31:00 [root] INFO: write_url_to_db(): appended URL 'https://www.intuit.com/'
2025-06-18 16:31:00 [root] INFO: def parse(): URL https://www.intuit.com/ marked as irrelevant (no keywords).
2025-06-18 16:31:00 [root] INFO: def parse(): Found 10 links on https://www.intuit.com/ca/
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://www.creditkarma.ca/ has never been seen before, processing it.
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://www.creditkarma.ca/ has never been seen before, processing it.
2025-06-18 16:31:00 [root] INFO: write_url_to_db(): appended URL 'https://www.creditkarma.ca/'
2025-06-18 16:31:00 [root] INFO: def parse(): Crawling next URL: https://www.creditkarma.ca/
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://quickbooks.intuit.com/ca/accountants/ has never been seen before, processing it.
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://quickbooks.intuit.com/ca/accountants/ has never been seen before, processing it.
2025-06-18 16:31:00 [root] INFO: write_url_to_db(): appended URL 'https://quickbooks.intuit.com/ca/accountants/'
2025-06-18 16:31:00 [root] INFO: def parse(): Crawling next URL: https://quickbooks.intuit.com/ca/accountants/
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://turbotax.intuit.ca/tax-software/index.jsp has never been seen before, processing it.
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://turbotax.intuit.ca/tax-software/index.jsp has never been seen before, processing it.
2025-06-18 16:31:00 [root] INFO: write_url_to_db(): appended URL 'https://turbotax.intuit.ca/tax-software/index.jsp'
2025-06-18 16:31:00 [root] INFO: def parse(): Crawling next URL: https://turbotax.intuit.ca/tax-software/index.jsp
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://profile.intuit.ca/ has never been seen before, processing it.
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://profile.intuit.ca/ has never been seen before, processing it.
2025-06-18 16:31:00 [root] INFO: write_url_to_db(): appended URL 'https://profile.intuit.ca/'
2025-06-18 16:31:00 [root] INFO: def parse(): Crawling next URL: https://profile.intuit.ca/
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://quickbooks.intuit.ca/self-employed/?sc=seq_intuit_qbse_ca_click_nav has never been seen before, processing it.
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://quickbooks.intuit.ca/self-employed/?sc=seq_intuit_qbse_ca_click_nav has never been seen before, processing it.
2025-06-18 16:31:00 [root] INFO: write_url_to_db(): appended URL 'https://quickbooks.intuit.ca/self-employed/?sc=seq_intuit_qbse_ca_click_nav'
2025-06-18 16:31:00 [root] INFO: def parse(): Crawling next URL: https://quickbooks.intuit.ca/self-employed/?sc=seq_intuit_qbse_ca_click_nav
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://www.intuit.com/ has never been seen before, processing it.
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://quickbooks.intuit.com/ca/?sc=seq_intuit_qb_ca_click_nav has never been seen before, processing it.
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://quickbooks.intuit.com/ca/?sc=seq_intuit_qb_ca_click_nav has never been seen before, processing it.
2025-06-18 16:31:00 [root] INFO: write_url_to_db(): appended URL 'https://quickbooks.intuit.com/ca/?sc=seq_intuit_qb_ca_click_nav'
2025-06-18 16:31:00 [root] INFO: def parse(): Crawling next URL: https://quickbooks.intuit.com/ca/?sc=seq_intuit_qb_ca_click_nav
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://quickbooks.intuit.ca/payments/?sc=seq_intuit_qb_payments_ca_click_nav has never been seen before, processing it.
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://quickbooks.intuit.ca/payments/?sc=seq_intuit_qb_payments_ca_click_nav has never been seen before, processing it.
2025-06-18 16:31:00 [root] INFO: write_url_to_db(): appended URL 'https://quickbooks.intuit.ca/payments/?sc=seq_intuit_qb_payments_ca_click_nav'
2025-06-18 16:31:00 [root] INFO: def parse(): Crawling next URL: https://quickbooks.intuit.ca/payments/?sc=seq_intuit_qb_payments_ca_click_nav
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://www.intuit.com/ca/ has never been seen before, processing it.
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://www.intuit.com/ca/ has never been seen before, processing it.
2025-06-18 16:31:00 [root] INFO: write_url_to_db(): appended URL 'https://www.intuit.com/ca/'
2025-06-18 16:31:00 [root] INFO: def parse(): Crawling next URL: https://www.intuit.com/ca/
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://www.intuit.com/ca/sign-in/ has never been seen before, processing it.
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://www.intuit.com/ca/sign-in/ has never been seen before, processing it.
2025-06-18 16:31:00 [root] INFO: write_url_to_db(): appended URL 'https://www.intuit.com/ca/sign-in/'
2025-06-18 16:31:00 [root] INFO: def parse(): Crawling next URL: https://www.intuit.com/ca/sign-in/
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://quickbooks.intuit.ca/accounting-software/quickbooks-cheques-stationery/?sc=seq_intuit_qb_ca_click_nav has never been seen before, processing it.
2025-06-18 16:31:00 [root] INFO: should_process_url: URL https://quickbooks.intuit.ca/accounting-software/quickbooks-cheques-stationery/?sc=seq_intuit_qb_ca_click_nav has never been seen before, processing it.
2025-06-18 16:31:00 [root] INFO: write_url_to_db(): appended URL 'https://quickbooks.intuit.ca/accounting-software/quickbooks-cheques-stationery/?sc=seq_intuit_qb_ca_click_nav'
2025-06-18 16:31:00 [root] INFO: def parse(): Crawling next URL: https://quickbooks.intuit.ca/accounting-software/quickbooks-cheques-stationery/?sc=seq_intuit_qb_ca_click_nav
2025-06-18 16:31:00 [root] INFO: def parse(): Found keywords for URL https://latindancecalendar.com/festivals/portland-salsa-congress/: ['bachata', 'dance', 'kizomba', 'salsa', 'zouk']
2025-06-18 16:31:00 [root] INFO: def generate_prompt(): Generating prompt for URL: https://latindancecalendar.com/festivals/portland-salsa-congress/
2025-06-18 16:31:00 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:31:00 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:31:00 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:31:02 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:31:02 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 135718 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 16:31:02 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:31:56 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:31:56 [root] INFO: query_llm(): OpenAI response received: [{
    "source": "Latin Dance Calendar",
    "dance_style": "salsa, bachata",
    "url": "",
    "event_type": "other",
    "event_name": "Portland Salsa Bachata Congress 2025",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-20",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Portland, USA",
    "description": "There is no description available. Please check the link for more information."
}]
2025-06-18 16:31:56 [root] INFO: def extract_and_parse_json(): for url https://latindancecalendar.com/festivals/portland-salsa-congress/, 
Cleaned JSON ready for parsing:
[{
    "source": "Latin Dance Calendar",
    "dance_style": "salsa, bachata",
    "url": "",
    "event_type": "other",
    "event_name": "Portland Salsa Bachata Congress 2025",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-20",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Portland, USA",
    "description": "There is no description available. Please check the link for more information."
}]
2025-06-18 16:31:56 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 16:31:56 [root] INFO: def clean_up_address(): Processing location 'Portland, USA' (event_id: None)
2025-06-18 16:31:56 [root] INFO: write_events_to_db: Number of events to write: 1
2025-06-18 16:31:56 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/festivals/portland-salsa-congress/'
2025-06-18 16:31:56 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 16:31:56 [root] INFO: def process_llm_response: URL https://latindancecalendar.com/festivals/portland-salsa-congress/ marked as relevant with events written to the database.
2025-06-18 16:31:56 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/festivals/portland-salsa-congress/'
2025-06-18 16:31:56 [root] INFO: def parse(): URL https://latindancecalendar.com/festivals/portland-salsa-congress/ marked as relevant (LLM positive).
2025-06-18 16:31:56 [root] INFO: def parse(): Found 10 links on https://latindancecalendar.com/festivals/portland-salsa-congress/
2025-06-18 16:31:56 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.stay22.com/embed/gm?aid=latindancecalendar&maincolor=FFFFFF&adults=1&showothers=true&checkin=2025-06-20&checkout=2025-06-21&address=Portland%2C+USA&isnear=false&campaign=festival116195&campaign=festivalPageRegion, URL: https://latindancecalendar.com/festivals/portland-salsa-congress/, source: Zouk Dancing Festivals Worldwide (Updated 2025), keywords: zouk
2025-06-18 16:31:56 [root] WARNING: def decode_calendar_id(): Exception for https://www.stay22.com/embed/gm?aid=latindancecalendar&maincolor=FFFFFF&adults=1&showothers=true&checkin=2025-06-20&checkout=2025-06-21&address=Portland%2C+USA&isnear=false&campaign=festival116195&campaign=festivalPageRegion - Incorrect padding
2025-06-18 16:31:56 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.stay22.com/embed/gm?aid=latindancecalendar&maincolor=FFFFFF&adults=1&showothers=true&checkin=2025-06-20&checkout=2025-06-21&address=Portland%2C+USA&isnear=false&campaign=festival116195&campaign=festivalPageRegion
2025-06-18 16:31:56 [root] INFO: write_url_to_db(): appended URL 'https://www.stay22.com/embed/gm?aid=latindancecalendar&maincolor=FFFFFF&adults=1&showothers=true&checkin=2025-06-20&checkout=2025-06-21&address=Portland%2C+USA&isnear=false&campaign=festival116195&campaign=festivalPageRegion'
2025-06-18 16:31:56 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/dialog/send?app_id=321366148277289&link=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fportland-salsa-congress%2F%3Futm_source%3Dweb_share_fbmessenger&redirect_uri=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fportland-salsa-congress%2F%3Futm_source%3Dweb_share_fbmessenger'
2025-06-18 16:31:56 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/dialog/send?app_id=321366148277289&link=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fportland-salsa-congress%2F%3Futm_source%3Dweb_share_fbmessenger&redirect_uri=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fportland-salsa-congress%2F%3Futm_source%3Dweb_share_fbmessenger
2025-06-18 16:31:56 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fportland-salsa-congress%2F%3Futm_source%3Dweb_share_fb'
2025-06-18 16:31:56 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fportland-salsa-congress%2F%3Futm_source%3Dweb_share_fb
2025-06-18 16:31:56 [root] INFO: should_process_url: URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fportland-salsa-congress%2F has never been seen before, processing it.
2025-06-18 16:31:56 [root] INFO: should_process_url: URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fportland-salsa-congress%2F has never been seen before, processing it.
2025-06-18 16:31:56 [root] INFO: write_url_to_db(): appended URL 'https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fportland-salsa-congress%2F'
2025-06-18 16:31:56 [root] INFO: def parse(): Crawling next URL: https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fportland-salsa-congress%2F
2025-06-18 16:31:56 [root] INFO: should_process_url: URL https://latindancecalendar.com/ was last seen as relevant, processing it.
2025-06-18 16:31:56 [root] INFO: should_process_url: URL https://closestays.com was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:31:56 [root] INFO: should_process_url: URL https://latindancecalendar.com/portland-salsa-congress/ has never been seen before, processing it.
2025-06-18 16:31:56 [root] INFO: should_process_url: URL https://latindancecalendar.com/portland-salsa-congress/ has never been seen before, processing it.
2025-06-18 16:31:56 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/portland-salsa-congress/'
2025-06-18 16:31:56 [root] INFO: def parse(): Crawling next URL: https://latindancecalendar.com/portland-salsa-congress/
2025-06-18 16:31:56 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/home?status=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fportland-salsa-congress%2F.
2025-06-18 16:31:56 [root] INFO: should_process_url: URL https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fportland-salsa-congress%2F has never been seen before, processing it.
2025-06-18 16:31:56 [root] INFO: should_process_url: URL https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fportland-salsa-congress%2F has never been seen before, processing it.
2025-06-18 16:31:56 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fportland-salsa-congress%2F'
2025-06-18 16:31:56 [root] INFO: def parse(): Crawling next URL: https://latindancecalendar.com/report-a-listing/?listing-url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2Fportland-salsa-congress%2F
2025-06-18 16:31:56 [root] INFO: should_process_url: URL https://latindancecalendar.com/festivals/portland-salsa-congress/ has never been seen before, processing it.
2025-06-18 16:31:56 [root] INFO: should_process_url: URL https://square.link/u/2DkYSAHf has never been seen before, processing it.
2025-06-18 16:31:56 [root] INFO: should_process_url: URL https://square.link/u/2DkYSAHf has never been seen before, processing it.
2025-06-18 16:31:56 [root] INFO: write_url_to_db(): appended URL 'https://square.link/u/2DkYSAHf'
2025-06-18 16:31:56 [root] INFO: def parse(): Crawling next URL: https://square.link/u/2DkYSAHf
2025-06-18 16:31:56 [scrapy.extensions.logstats] INFO: Crawled 298 pages (at 17 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 16:31:56 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <404 https://www.sunshinecoastcanada.com/hidden-gems/powell-forest-canoe-route/>: HTTP status code is not handled or not allowed
2025-06-18 16:31:56 [root] INFO: def parse(): Found keywords for URL https://www.pgmusic.com/news.htm: ['country waltz', 'dance', 'waltz']
2025-06-18 16:31:56 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.pgmusic.com/news.htm
2025-06-18 16:31:56 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:31:56 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:31:56 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:32:11 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:32:11 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 16:32:11 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 16:32:11 [root] INFO: write_url_to_db(): appended URL 'https://www.pgmusic.com/news.htm'
2025-06-18 16:32:11 [root] INFO: def parse(): URL https://www.pgmusic.com/news.htm marked as irrelevant (LLM negative).
2025-06-18 16:32:11 [root] INFO: def parse(): Found 10 links on https://www.pgmusic.com/news.htm
2025-06-18 16:32:11 [root] INFO: should_process_url: URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=849054&page=1 has never been seen before, processing it.
2025-06-18 16:32:11 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/deutsch2025.exe has never been seen before, processing it.
2025-06-18 16:32:11 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/deutsch2025.exe has never been seen before, processing it.
2025-06-18 16:32:11 [root] INFO: write_url_to_db(): appended URL 'https://nn.pgmusic.com/pgfiles/languagesupport/deutsch2025.exe'
2025-06-18 16:32:11 [root] INFO: def parse(): Crawling next URL: https://nn.pgmusic.com/pgfiles/languagesupport/deutsch2025.exe
2025-06-18 16:32:11 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/francais2025.exe has never been seen before, processing it.
2025-06-18 16:32:11 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/francais2025.exe has never been seen before, processing it.
2025-06-18 16:32:11 [root] INFO: write_url_to_db(): appended URL 'https://nn.pgmusic.com/pgfiles/languagesupport/francais2025.exe'
2025-06-18 16:32:11 [root] INFO: def parse(): Crawling next URL: https://nn.pgmusic.com/pgfiles/languagesupport/francais2025.exe
2025-06-18 16:32:11 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/italiano2025.exe has never been seen before, processing it.
2025-06-18 16:32:11 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/italiano2025.exe has never been seen before, processing it.
2025-06-18 16:32:11 [root] INFO: write_url_to_db(): appended URL 'https://nn.pgmusic.com/pgfiles/languagesupport/italiano2025.exe'
2025-06-18 16:32:11 [root] INFO: def parse(): Crawling next URL: https://nn.pgmusic.com/pgfiles/languagesupport/italiano2025.exe
2025-06-18 16:32:11 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/italiano2025RB.exe has never been seen before, processing it.
2025-06-18 16:32:11 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/italiano2025RB.exe has never been seen before, processing it.
2025-06-18 16:32:11 [root] INFO: write_url_to_db(): appended URL 'https://nn.pgmusic.com/pgfiles/languagesupport/italiano2025RB.exe'
2025-06-18 16:32:11 [root] INFO: def parse(): Crawling next URL: https://nn.pgmusic.com/pgfiles/languagesupport/italiano2025RB.exe
2025-06-18 16:32:11 [root] INFO: should_process_url: URL https://www.pgmusic.com/news.htm has never been seen before, processing it.
2025-06-18 16:32:11 [root] INFO: should_process_url: URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=849429&page=1 has never been seen before, processing it.
2025-06-18 16:32:11 [root] INFO: should_process_url: URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=849631&page=1 has never been seen before, processing it.
2025-06-18 16:32:11 [root] INFO: should_process_url: URL https://www.bandinabox.com/bb.php?os=win&lang=de has never been seen before, processing it.
2025-06-18 16:32:11 [root] INFO: should_process_url: URL https://www.bandinabox.com/bb.php?os=win&lang=de has never been seen before, processing it.
2025-06-18 16:32:11 [root] INFO: write_url_to_db(): appended URL 'https://www.bandinabox.com/bb.php?os=win&lang=de'
2025-06-18 16:32:11 [root] INFO: def parse(): Crawling next URL: https://www.bandinabox.com/bb.php?os=win&lang=de
2025-06-18 16:32:11 [root] INFO: should_process_url: URL https://www.bandinabox.com/bb.php?os=win&lang=it has never been seen before, processing it.
2025-06-18 16:32:11 [root] INFO: should_process_url: URL https://www.bandinabox.com/bb.php?os=win&lang=it has never been seen before, processing it.
2025-06-18 16:32:11 [root] INFO: write_url_to_db(): appended URL 'https://www.bandinabox.com/bb.php?os=win&lang=it'
2025-06-18 16:32:11 [root] INFO: def parse(): Crawling next URL: https://www.bandinabox.com/bb.php?os=win&lang=it
2025-06-18 16:32:11 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/francais2025RB.exe has never been seen before, processing it.
2025-06-18 16:32:11 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/francais2025RB.exe has never been seen before, processing it.
2025-06-18 16:32:11 [root] INFO: write_url_to_db(): appended URL 'https://nn.pgmusic.com/pgfiles/languagesupport/francais2025RB.exe'
2025-06-18 16:32:11 [root] INFO: def parse(): Crawling next URL: https://nn.pgmusic.com/pgfiles/languagesupport/francais2025RB.exe
2025-06-18 16:32:11 [root] INFO: def parse(): Found keywords for URL https://closestays.com: ['dance']
2025-06-18 16:32:11 [root] INFO: def generate_prompt(): Generating prompt for URL: https://closestays.com
2025-06-18 16:32:11 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:32:11 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:32:11 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:33:49 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:33:49 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "CloseStays",
        "dance_style": "bachata, balboa, douceur, east coast swing, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Dance Night",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "19:00",
        "end_time": "21:00",
        "price": "$15",
        "location": "CanDance Studios, Amsterdam, Netherlands",
        "description": "Join us for a night of social dancing at CanDance Studios. Enjoy a variety of dance styles and meet fellow dancers."
    },
    {
        "source": "CloseStays",
        "dance_style": "bachata, balboa, douceur, east coast swing, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
        "url": "",
        "event_type": "class",
        "event_name": "Salsa Class",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-25",
        "end_date": "2025-06-25",
        "start_time": "18:00",
        "end_time": "19:30",
        "price": "$10",
        "location": "CanDance Studios, Amsterdam, Netherlands",
        "description": "Learn the basics of salsa dancing in a fun and supportive environment. No partner required."
    },
    {
        "source": "CloseStays",
        "dance_style": "bachata, balboa, douceur, east coast swing, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
        "url": "",
        "event_type": "workshop",
        "event_name": "Advanced Bachata Workshop",
        "day_of_week": "Saturday",
        "start_date": "2025-07-05",
        "end_date": "2025-07-05",
        "start_time": "14:00",
        "end_time": "16:00",
        "price": "$25",
        "location": "CanDance Studios, Amsterdam, Netherlands",
        "description": "Dive deep into advanced bachata techniques and improve your skills with our expert instructors."
    },
    {
        "source": "CloseStays",
        "dance_style": "bachata, balboa, douceur, east coast swing, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
        "url": "",
        "event_type": "live music",
        "event_name": "Live Salsa Band",
        "day_of_week": "Friday",
        "start_date": "2025-07-11",
        "end_date": "2025-07-11",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "$20",
        "location": "CanDance Studios, Amsterdam, Netherlands",
        "description": "Enjoy live salsa music and dance the night away with fellow salsa enthusiasts."
    },
    {
        "source": "CloseStays",
        "dance_style": "bachata, balboa, douceur, east coast swing, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Latin Dance Party",
        "day_of_week": "Saturday",
        "start_date": "2025-07-19",
        "end_date": "2025-07-19",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "$15",
        "location": "CanDance Studios, Amsterdam, Netherlands",
        "description": "Join us for a night of Latin dance music and social dancing. All levels welcome."
    },
    {
        "source": "CloseStays",
        "dance_style": "bachata, balboa, douceur, east coast swing, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
        "url": "",
        "event_type": "class",
        "event_name": "Beginner Tango Class",
        "day_of_week": "Thursday",
        "start_date": "2025-07-24",
        "end_date": "2025-07-24",
        "start_time": "19:00",
        "end_time": "20:30",
        "price": "$10",
        "location": "CanDance Studios, Amsterdam, Netherlands",
        "description": "Learn the basics of tango in a fun and supportive environment. No partner required."
    },
    {
        "source": "CloseStays",
        "dance_style": "bachata, balboa, douceur, east coast swing, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
        "url": "",
        "event_type": "workshop",
        "event_name": "Intermediate Salsa Workshop",
        "day_of_week": "Saturday",
        "start_date": "2025-08-02",
        "end_date": "2025-08-02",
        "start_time": "14:00",
        "end_time": "16:00",
        "price": "$20",
        "location": "CanDance Studios, Amsterdam, Netherlands",
        "description": "Improve your salsa skills with this intermediate workshop focused on technique and partnering."
    },
    {
        "source": "CloseStays",
        "dance_style": "bachata, balboa, douceur, east coast swing, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Salsa Social Night",
        "day_of_week": "Friday",
        "start_date": "2025-08-08",
        "end_date": "2025-08-08",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "$15",
        "location": "CanDance Studios, Amsterdam, Netherlands",
        "description": "Join us for a night of salsa social dancing. All levels welcome."
    },
    {
        "source": "CloseStays",
        "dance_style": "bachata, balboa, douceur, east coast swing, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
        "url": "",
        "event_type": "class",
        "event_name": "Kizomba Class",
        "day_of_week": "Wednesday",
        "start_date": "2025-08-13",
        "end_date": "2025-08-13",
        "start_time": "19:00",
        "end_time": "20:30",
        "price": "$10",
        "location": "CanDance Studios, Amsterdam, Netherlands",
        "description": "Learn the basics of kizomba in a fun and supportive environment. No partner required."
    },
    {
        "source": "CloseStays",
        "dance_style": "bachata, balboa, douceur, east coast swing, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
        "url": "",
        "event_type": "workshop",
        "event_name": "Advanced Tango Workshop",
        "day_of_week": "Saturday",
        "start_date": "2025-08-16",
        "end_date": "2025-08-16",
        "start_time": "14:00",
        "end_time": "16:00",
        "price": "$25",
        "location": "CanDance Studios, Amsterdam, Netherlands",
        "description": "Dive deep into advanced tango techniques and improve your skills with our expert instructors."
    }
]
2025-06-18 16:33:49 [root] INFO: def extract_and_parse_json(): for url https://closestays.com, 
Cleaned JSON ready for parsing:
[
    {
        "source": "CloseStays",
        "dance_style": "bachata, balboa, douceur, east coast swing, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Dance Night",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "19:00",
        "end_time": "21:00",
        "price": "$15",
        "location": "CanDance Studios, Amsterdam, Netherlands",
        "description": "Join us for a night of social dancing at CanDance Studios. Enjoy a variety of dance styles and meet fellow dancers."
    },
    {
        "source": "CloseStays",
        "dance_style": "bachata, balboa, douceur, east coast swing, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
        "url": "",
        "event_type": "class",
        "event_name": "Salsa Class",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-25",
        "end_date": "2025-06-25",
        "start_time": "18:00",
        "end_time": "19:30",
        "price": "$10",
        "location": "CanDance Studios, Amsterdam, Netherlands",
        "description": "Learn the basics of salsa dancing in a fun and supportive environment. No partner required."
    },
    {
        "source": "CloseStays",
        "dance_style": "bachata, balboa, douceur, east coast swing, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
        "url": "",
        "event_type": "workshop",
        "event_name": "Advanced Bachata Workshop",
        "day_of_week": "Saturday",
        "start_date": "2025-07-05",
        "end_date": "2025-07-05",
        "start_time": "14:00",
        "end_time": "16:00",
        "price": "$25",
        "location": "CanDance Studios, Amsterdam, Netherlands",
        "description": "Dive deep into advanced bachata techniques and improve your skills with our expert instructors."
    },
    {
        "source": "CloseStays",
        "dance_style": "bachata, balboa, douceur, east coast swing, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
        "url": "",
        "event_type": "live music",
        "event_name": "Live Salsa Band",
        "day_of_week": "Friday",
        "start_date": "2025-07-11",
        "end_date": "2025-07-11",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "$20",
        "location": "CanDance Studios, Amsterdam, Netherlands",
        "description": "Enjoy live salsa music and dance the night away with fellow salsa enthusiasts."
    },
    {
        "source": "CloseStays",
        "dance_style": "bachata, balboa, douceur, east coast swing, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Latin Dance Party",
        "day_of_week": "Saturday",
        "start_date": "2025-07-19",
        "end_date": "2025-07-19",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "$15",
        "location": "CanDance Studios, Amsterdam, Netherlands",
        "description": "Join us for a night of Latin dance music and social dancing. All levels welcome."
    },
    {
        "source": "CloseStays",
        "dance_style": "bachata, balboa, douceur, east coast swing, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
        "url": "",
        "event_type": "class",
        "event_name": "Beginner Tango Class",
        "day_of_week": "Thursday",
        "start_date": "2025-07-24",
        "end_date": "2025-07-24",
        "start_time": "19:00",
        "end_time": "20:30",
        "price": "$10",
        "location": "CanDance Studios, Amsterdam, Netherlands",
        "description": "Learn the basics of tango in a fun and supportive environment. No partner required."
    },
    {
        "source": "CloseStays",
        "dance_style": "bachata, balboa, douceur, east coast swing, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
        "url": "",
        "event_type": "workshop",
        "event_name": "Intermediate Salsa Workshop",
        "day_of_week": "Saturday",
        "start_date": "2025-08-02",
        "end_date": "2025-08-02",
        "start_time": "14:00",
        "end_time": "16:00",
        "price": "$20",
        "location": "CanDance Studios, Amsterdam, Netherlands",
        "description": "Improve your salsa skills with this intermediate workshop focused on technique and partnering."
    },
    {
        "source": "CloseStays",
        "dance_style": "bachata, balboa, douceur, east coast swing, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Salsa Social Night",
        "day_of_week": "Friday",
        "start_date": "2025-08-08",
        "end_date": "2025-08-08",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "$15",
        "location": "CanDance Studios, Amsterdam, Netherlands",
        "description": "Join us for a night of salsa social dancing. All levels welcome."
    },
    {
        "source": "CloseStays",
        "dance_style": "bachata, balboa, douceur, east coast swing, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
        "url": "",
        "event_type": "class",
        "event_name": "Kizomba Class",
        "day_of_week": "Wednesday",
        "start_date": "2025-08-13",
        "end_date": "2025-08-13",
        "start_time": "19:00",
        "end_time": "20:30",
        "price": "$10",
        "location": "CanDance Studios, Amsterdam, Netherlands",
        "description": "Learn the basics of kizomba in a fun and supportive environment. No partner required."
    },
    {
        "source": "CloseStays",
        "dance_style": "bachata, balboa, douceur, east coast swing, kizomba, lindy hop, merengue, salsa, semba, swing, tango, tarraxo, tarraxa, tarraxinha, urban kiz, west coast swing, wcs",
        "url": "",
        "event_type": "workshop",
        "event_name": "Advanced Tango Workshop",
        "day_of_week": "Saturday",
        "start_date": "2025-08-16",
        "end_date": "2025-08-16",
        "start_time": "14:00",
        "end_time": "16:00",
        "price": "$25",
        "location": "CanDance Studios, Amsterdam, Netherlands",
        "description": "Dive deep into advanced tango techniques and improve your skills with our expert instructors."
    }
]
2025-06-18 16:33:49 [root] INFO: def clean_up_address(): Starting with events_df shape: (10, 14)
2025-06-18 16:33:49 [root] INFO: def clean_up_address(): Processing location 'CanDance Studios, Amsterdam, Netherlands' (event_id: None)
2025-06-18 16:33:49 [root] INFO: def clean_up_address(): Processing location 'CanDance Studios, Amsterdam, Netherlands' (event_id: None)
2025-06-18 16:33:49 [root] INFO: def clean_up_address(): Processing location 'CanDance Studios, Amsterdam, Netherlands' (event_id: None)
2025-06-18 16:33:49 [root] INFO: def clean_up_address(): Processing location 'CanDance Studios, Amsterdam, Netherlands' (event_id: None)
2025-06-18 16:33:49 [root] INFO: def clean_up_address(): Processing location 'CanDance Studios, Amsterdam, Netherlands' (event_id: None)
2025-06-18 16:33:49 [root] INFO: def clean_up_address(): Processing location 'CanDance Studios, Amsterdam, Netherlands' (event_id: None)
2025-06-18 16:33:49 [root] INFO: def clean_up_address(): Processing location 'CanDance Studios, Amsterdam, Netherlands' (event_id: None)
2025-06-18 16:33:49 [root] INFO: def clean_up_address(): Processing location 'CanDance Studios, Amsterdam, Netherlands' (event_id: None)
2025-06-18 16:33:49 [root] INFO: def clean_up_address(): Processing location 'CanDance Studios, Amsterdam, Netherlands' (event_id: None)
2025-06-18 16:33:49 [root] INFO: def clean_up_address(): Processing location 'CanDance Studios, Amsterdam, Netherlands' (event_id: None)
2025-06-18 16:33:49 [root] INFO: write_events_to_db: Number of events to write: 10
2025-06-18 16:33:49 [root] INFO: write_url_to_db(): appended URL 'https://closestays.com'
2025-06-18 16:33:49 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 16:33:49 [root] INFO: def process_llm_response: URL https://closestays.com marked as relevant with events written to the database.
2025-06-18 16:33:49 [root] INFO: write_url_to_db(): appended URL 'https://closestays.com'
2025-06-18 16:33:49 [root] INFO: def parse(): URL https://closestays.com marked as relevant (LLM positive).
2025-06-18 16:33:49 [root] INFO: def parse(): Found 6 links on https://closestays.com
2025-06-18 16:33:49 [root] INFO: should_process_url: URL https://closestays.com was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:33:49 [root] INFO: should_process_url: URL https://www.stay22.com/allez/trivago?campaign=closestays-trivago-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Ftrivago.com has never been seen before, processing it.
2025-06-18 16:33:49 [root] INFO: should_process_url: URL https://www.stay22.com/allez/trivago?campaign=closestays-trivago-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Ftrivago.com has never been seen before, processing it.
2025-06-18 16:33:49 [root] INFO: write_url_to_db(): appended URL 'https://www.stay22.com/allez/trivago?campaign=closestays-trivago-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Ftrivago.com'
2025-06-18 16:33:49 [root] INFO: def parse(): Crawling next URL: https://www.stay22.com/allez/trivago?campaign=closestays-trivago-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Ftrivago.com
2025-06-18 16:33:49 [root] INFO: def parse(): Found keywords for URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2F%3Fshow%3Dmap: ['dance']
2025-06-18 16:33:49 [root] INFO: def generate_prompt(): Generating prompt for URL: https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2F%3Fshow%3Dmap
2025-06-18 16:33:49 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:33:49 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:33:49 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:33:50 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:33:50 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 16:33:50 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 16:33:50 [root] INFO: write_url_to_db(): appended URL 'https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2F%3Fshow%3Dmap'
2025-06-18 16:33:50 [root] INFO: def parse(): URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2F%3Fshow%3Dmap marked as irrelevant (LLM negative).
2025-06-18 16:33:50 [root] INFO: def parse(): Found 0 links on https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2F%3Fshow%3Dmap
2025-06-18 16:33:50 [root] INFO: should_process_url: URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Ffestivals%2F%3Fshow%3Dmap was last seen as relevant, processing it.
2025-06-18 16:33:50 [root] INFO: write_url_to_db(): appended URL 'http://www.kathaumixw.org/calendar.shtml'
2025-06-18 16:33:50 [root] INFO: def parse(): URL http://www.kathaumixw.org/calendar.shtml marked as irrelevant (no keywords).
2025-06-18 16:33:50 [root] INFO: def parse(): Found 1 links on https://www.kathaumixw.org/calendar.shtml
2025-06-18 16:33:50 [root] INFO: should_process_url: URL http://www.kathaumixw.org/calendar.shtml was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:33:50 [root] INFO: should_process_url: URL http://www.powellriveracademy.org has never been seen before, processing it.
2025-06-18 16:33:50 [root] INFO: should_process_url: URL http://www.powellriveracademy.org has never been seen before, processing it.
2025-06-18 16:33:50 [root] INFO: write_url_to_db(): appended URL 'http://www.powellriveracademy.org'
2025-06-18 16:33:50 [root] INFO: def parse(): Crawling next URL: http://www.powellriveracademy.org
2025-06-18 16:33:51 [root] INFO: def parse(): Found keywords for URL https://www.pgmusic.com/bbmac.packages.htm: ['waltz']
2025-06-18 16:33:51 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.pgmusic.com/bbmac.packages.htm
2025-06-18 16:33:51 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:33:51 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:33:51 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:34:31 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:34:31 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "PG Music",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Band-in-a-Box 2024 for Mac Video",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Over 50 New Features and Enhancements!"
    },
    {
        "source": "PG Music",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Band-in-a-Box 2024 Video",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Everything you need to know in less than 8 minutes!"
    },
    {
        "source": "PG Music",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Band-in-a-Box 2024 Video",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Boot Camp: Working with the Newest Features!"
    },
    {
        "source": "PG Music",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Band-in-a-Box 2024 Video",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "DAW Plugin Version 6 New Features"
    },
    {
        "source": "PG Music",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Band-in-a-Box 2024 Video",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "DAW Plugin Version 6 New Features for Reaper"
    },
    {
        "source": "PG Music",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Band-in-a-Box 2024 Video",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "The New Tracks Window."
    },
    {
        "source": "PG Music",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Band-in-a-Box 2024 Video",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "222 New RealTracks!"
    },
    {
        "source": "PG Music",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Band-in-a-Box 2024 Video",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "49-PAK"
    }
]
2025-06-18 16:34:31 [root] INFO: def extract_and_parse_json(): for url https://www.pgmusic.com/bbmac.packages.htm, 
Cleaned JSON ready for parsing:
[
    {
        "source": "PG Music",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Band-in-a-Box 2024 for Mac Video",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Over 50 New Features and Enhancements!"
    },
    {
        "source": "PG Music",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Band-in-a-Box 2024 Video",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Everything you need to know in less than 8 minutes!"
    },
    {
        "source": "PG Music",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Band-in-a-Box 2024 Video",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Boot Camp: Working with the Newest Features!"
    },
    {
        "source": "PG Music",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Band-in-a-Box 2024 Video",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "DAW Plugin Version 6 New Features"
    },
    {
        "source": "PG Music",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Band-in-a-Box 2024 Video",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "DAW Plugin Version 6 New Features for Reaper"
    },
    {
        "source": "PG Music",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Band-in-a-Box 2024 Video",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "The New Tracks Window."
    },
    {
        "source": "PG Music",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Band-in-a-Box 2024 Video",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "222 New RealTracks!"
    },
    {
        "source": "PG Music",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Band-in-a-Box 2024 Video",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "49-PAK"
    }
]
2025-06-18 16:34:31 [root] INFO: def clean_up_address(): Starting with events_df shape: (8, 14)
2025-06-18 16:34:31 [root] INFO: write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 16:34:31 [root] INFO: write_url_to_db(): appended URL 'https://www.pgmusic.com/bbmac.packages.htm'
2025-06-18 16:34:31 [root] INFO: def process_llm_response: URL https://www.pgmusic.com/bbmac.packages.htm marked as relevant with events written to the database.
2025-06-18 16:34:31 [root] INFO: write_url_to_db(): appended URL 'https://www.pgmusic.com/bbmac.packages.htm'
2025-06-18 16:34:31 [root] INFO: def parse(): URL https://www.pgmusic.com/bbmac.packages.htm marked as relevant (LLM positive).
2025-06-18 16:34:31 [root] INFO: def parse(): Found 7 links on https://www.pgmusic.com/bbmac.packages.htm
2025-06-18 16:34:31 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/pages/Band-in-a-Box-by-PG-Music/99580673800'
2025-06-18 16:34:31 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/pages/Band-in-a-Box-by-PG-Music/99580673800
2025-06-18 16:34:31 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/bandinabox_pg_music/'
2025-06-18 16:34:31 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/bandinabox_pg_music/
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.pgmusic.com/videos.bbmac.htm has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.pgmusic.com/videos.bbmac.htm has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: write_url_to_db(): appended URL 'https://www.pgmusic.com/videos.bbmac.htm'
2025-06-18 16:34:31 [root] INFO: def parse(): Crawling next URL: https://www.pgmusic.com/videos.bbmac.htm
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.pgmusic.com/bbmac.new.htm has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.pgmusic.com/bbmac.new.htm has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: write_url_to_db(): appended URL 'https://www.pgmusic.com/bbmac.new.htm'
2025-06-18 16:34:31 [root] INFO: def parse(): Crawling next URL: https://www.pgmusic.com/bbmac.new.htm
2025-06-18 16:34:31 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/user/pgmusicinc.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.pgmusic.com/bbmac.packages.htm has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/BandinaBox.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.pgmusic.com/ has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: write_url_to_db(): appended URL 'http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=849429&page=1'
2025-06-18 16:34:31 [root] INFO: def parse(): URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=849429&page=1 marked as irrelevant (no keywords).
2025-06-18 16:34:31 [root] INFO: def parse(): Found 10 links on https://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=849429&page=1
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/francais2025.exe has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.pgmusic.com has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.pgmusic.com has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: write_url_to_db(): appended URL 'https://www.pgmusic.com'
2025-06-18 16:34:31 [root] INFO: def parse(): Crawling next URL: https://www.pgmusic.com
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/italiano2025.exe has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.pgmusic.com/forums/ubbthreads.php?ubb=login&ocu=%2F%2Fwww.pgmusic.com%2Fforums%2Fubbthreads.php%3Fubb%3Dshowflat%26Number%3D849429%26page%3D1 has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.pgmusic.com/forums/ubbthreads.php?ubb=login&ocu=%2F%2Fwww.pgmusic.com%2Fforums%2Fubbthreads.php%3Fubb%3Dshowflat%26Number%3D849429%26page%3D1 has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: write_url_to_db(): appended URL 'https://www.pgmusic.com/forums/ubbthreads.php?ubb=login&ocu=%2F%2Fwww.pgmusic.com%2Fforums%2Fubbthreads.php%3Fubb%3Dshowflat%26Number%3D849429%26page%3D1'
2025-06-18 16:34:31 [root] INFO: def parse(): Crawling next URL: https://www.pgmusic.com/forums/ubbthreads.php?ubb=login&ocu=%2F%2Fwww.pgmusic.com%2Fforums%2Fubbthreads.php%3Fubb%3Dshowflat%26Number%3D849429%26page%3D1
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/italiano2025RB.exe has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=849429&page=1 has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.bandinabox.com/bb.php?os=win&lang=it has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://maps.google.com/maps?q=Brittany+%28FRANCE%29 has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://maps.google.com/maps?q=Brittany+%28FRANCE%29 has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: write_url_to_db(): appended URL 'https://maps.google.com/maps?q=Brittany+%28FRANCE%29'
2025-06-18 16:34:31 [root] INFO: def parse(): Crawling next URL: https://maps.google.com/maps?q=Brittany+%28FRANCE%29
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/francais2025RB.exe has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.pgmusic.com/ has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: write_url_to_db(): appended URL 'http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=843433&page=1'
2025-06-18 16:34:31 [root] INFO: def parse(): URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=843433&page=1 marked as irrelevant (no keywords).
2025-06-18 16:34:31 [root] INFO: def parse(): Found 10 links on https://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=843433&page=1
2025-06-18 16:34:31 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.youtube.com/embed/emhUHQTEi7o?wmode=opaque, URL: http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=843433&page=1, source: Band-in-a-Box for Windows - MIDI Styles Sets - PG Music, keywords: zouk
2025-06-18 16:34:31 [root] WARNING: def decode_calendar_id(): Exception for https://www.youtube.com/embed/emhUHQTEi7o?wmode=opaque - Incorrect padding
2025-06-18 16:34:31 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.youtube.com/embed/emhUHQTEi7o?wmode=opaque
2025-06-18 16:34:31 [root] INFO: write_url_to_db(): appended URL 'https://www.youtube.com/embed/emhUHQTEi7o?wmode=opaque'
2025-06-18 16:34:31 [root] INFO: should_process_url: URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=843433&page=1 has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.pgmusic.com/forums/ubbthreads.php?ubb=login&ocu=%2F%2Fwww.pgmusic.com%2Fforums%2Fubbthreads.php%3Fubb%3Dshowflat%26Number%3D843433%26page%3D1 has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.pgmusic.com/forums/ubbthreads.php?ubb=login&ocu=%2F%2Fwww.pgmusic.com%2Fforums%2Fubbthreads.php%3Fubb%3Dshowflat%26Number%3D843433%26page%3D1 has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: write_url_to_db(): appended URL 'https://www.pgmusic.com/forums/ubbthreads.php?ubb=login&ocu=%2F%2Fwww.pgmusic.com%2Fforums%2Fubbthreads.php%3Fubb%3Dshowflat%26Number%3D843433%26page%3D1'
2025-06-18 16:34:31 [root] INFO: def parse(): Crawling next URL: https://www.pgmusic.com/forums/ubbthreads.php?ubb=login&ocu=%2F%2Fwww.pgmusic.com%2Fforums%2Fubbthreads.php%3Fubb%3Dshowflat%26Number%3D843433%26page%3D1
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/deutsch2025.exe has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/francais2025.exe has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.pgmusic.com has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/italiano2025.exe has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.pgmusic.com/support.ios.htm has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.pgmusic.com/support.ios.htm has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: write_url_to_db(): appended URL 'https://www.pgmusic.com/support.ios.htm'
2025-06-18 16:34:31 [root] INFO: def parse(): Crawling next URL: https://www.pgmusic.com/support.ios.htm
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/italiano2025RB.exe has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.bandinabox.com/bb.php?os=win&lang=it has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.bandinabox.com/bb.php?os=win&lang=de has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/francais2025RB.exe has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: write_url_to_db(): appended URL 'http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=835013&page=1'
2025-06-18 16:34:31 [root] INFO: def parse(): URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=835013&page=1 marked as irrelevant (no keywords).
2025-06-18 16:34:31 [root] INFO: def parse(): Found 10 links on https://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=835013&page=1
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.pgmusic.com/forums/ubbthreads.php?ubb=login&ocu=%2F%2Fwww.pgmusic.com%2Fforums%2Fubbthreads.php%3Fubb%3Dshowflat%26Number%3D835013%26page%3D1 has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.pgmusic.com/forums/ubbthreads.php?ubb=login&ocu=%2F%2Fwww.pgmusic.com%2Fforums%2Fubbthreads.php%3Fubb%3Dshowflat%26Number%3D835013%26page%3D1 has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: write_url_to_db(): appended URL 'https://www.pgmusic.com/forums/ubbthreads.php?ubb=login&ocu=%2F%2Fwww.pgmusic.com%2Fforums%2Fubbthreads.php%3Fubb%3Dshowflat%26Number%3D835013%26page%3D1'
2025-06-18 16:34:31 [root] INFO: def parse(): Crawling next URL: https://www.pgmusic.com/forums/ubbthreads.php?ubb=login&ocu=%2F%2Fwww.pgmusic.com%2Fforums%2Fubbthreads.php%3Fubb%3Dshowflat%26Number%3D835013%26page%3D1
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/deutsch2025.exe has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/francais2025.exe has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.pgmusic.com/support_windowsupdates.htm#1124 has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.pgmusic.com/support_windowsupdates.htm#1124 has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: write_url_to_db(): appended URL 'https://www.pgmusic.com/support_windowsupdates.htm#1124'
2025-06-18 16:34:31 [root] INFO: def parse(): Crawling next URL: https://www.pgmusic.com/support_windowsupdates.htm#1124
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.pgmusic.com has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/italiano2025.exe has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=835013&page=1 has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/italiano2025RB.exe has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.bandinabox.com/bb.php?os=win&lang=it has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.bandinabox.com/bb.php?os=win&lang=de has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/francais2025RB.exe has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: write_url_to_db(): appended URL 'http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=845929&page=1'
2025-06-18 16:34:31 [root] INFO: def parse(): URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=845929&page=1 marked as irrelevant (no keywords).
2025-06-18 16:34:31 [root] INFO: def parse(): Found 10 links on https://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=845929&page=1
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.pgmusic.com/forums/ubbthreads.php?ubb=login&ocu=%2F%2Fwww.pgmusic.com%2Fforums%2Fubbthreads.php%3Fubb%3Dshowflat%26Number%3D845929%26page%3D1 has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.pgmusic.com/forums/ubbthreads.php?ubb=login&ocu=%2F%2Fwww.pgmusic.com%2Fforums%2Fubbthreads.php%3Fubb%3Dshowflat%26Number%3D845929%26page%3D1 has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: write_url_to_db(): appended URL 'https://www.pgmusic.com/forums/ubbthreads.php?ubb=login&ocu=%2F%2Fwww.pgmusic.com%2Fforums%2Fubbthreads.php%3Fubb%3Dshowflat%26Number%3D845929%26page%3D1'
2025-06-18 16:34:31 [root] INFO: def parse(): Crawling next URL: https://www.pgmusic.com/forums/ubbthreads.php?ubb=login&ocu=%2F%2Fwww.pgmusic.com%2Fforums%2Fubbthreads.php%3Fubb%3Dshowflat%26Number%3D845929%26page%3D1
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/deutsch2025.exe has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/francais2025.exe has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=845929&page=1 has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.pgmusic.com has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://apps.apple.com/app/band-in-a-box/id397173717  has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://apps.apple.com/app/band-in-a-box/id397173717  has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: write_url_to_db(): appended URL 'https://apps.apple.com/app/band-in-a-box/id397173717 '
2025-06-18 16:34:31 [root] INFO: def parse(): Crawling next URL: https://apps.apple.com/app/band-in-a-box/id397173717 
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/italiano2025.exe has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/italiano2025RB.exe has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.bandinabox.com/bb.php?os=win&lang=it has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://www.bandinabox.com/bb.php?os=win&lang=de has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/francais2025RB.exe has never been seen before, processing it.
2025-06-18 16:34:31 [root] INFO: def parse(): Found keywords for URL https://latindancecalendar.com/add/?type=festival&referer=feed: ['bachata', 'dance', 'kizomba', 'merengue', 'salsa', 'samba', 'tango', 'zouk']
2025-06-18 16:34:31 [root] INFO: def generate_prompt(): Generating prompt for URL: https://latindancecalendar.com/add/?type=festival&referer=feed
2025-06-18 16:34:31 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:34:31 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:34:31 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:34:42 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:34:42 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 16:34:42 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 16:34:42 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/add/?type=festival&referer=feed'
2025-06-18 16:34:42 [root] INFO: def parse(): URL https://latindancecalendar.com/add/?type=festival&referer=feed marked as irrelevant (LLM negative).
2025-06-18 16:34:42 [root] INFO: def parse(): Found 10 links on https://latindancecalendar.com/add/?type=festival&referer=feed
2025-06-18 16:34:42 [root] INFO: write_url_to_db(): appended URL 'https://facebook.com/latindancecalendar'
2025-06-18 16:34:42 [root] INFO: def parse(): Recorded unwanted URL: https://facebook.com/latindancecalendar
2025-06-18 16:34:42 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flatindancecalendar.com%2Fadd%2F%3Ftype%3Dfestival%26referer%3Dfeed%26utm_source%3Dweb_share_fb'
2025-06-18 16:34:42 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flatindancecalendar.com%2Fadd%2F%3Ftype%3Dfestival%26referer%3Dfeed%26utm_source%3Dweb_share_fb
2025-06-18 16:34:42 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/dialog/send?app_id=321366148277289&link=https%3A%2F%2Flatindancecalendar.com%2Fadd%2F%3Ftype%3Dfestival%26referer%3Dfeed%26utm_source%3Dweb_share_fbmessenger&redirect_uri=https%3A%2F%2Flatindancecalendar.com%2Fadd%2F%3Ftype%3Dfestival%26referer%3Dfeed%26utm_source%3Dweb_share_fbmessenger'
2025-06-18 16:34:42 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/dialog/send?app_id=321366148277289&link=https%3A%2F%2Flatindancecalendar.com%2Fadd%2F%3Ftype%3Dfestival%26referer%3Dfeed%26utm_source%3Dweb_share_fbmessenger&redirect_uri=https%3A%2F%2Flatindancecalendar.com%2Fadd%2F%3Ftype%3Dfestival%26referer%3Dfeed%26utm_source%3Dweb_share_fbmessenger
2025-06-18 16:34:42 [root] INFO: should_process_url: URL https://latindancecalendar.com/ was last seen as relevant, processing it.
2025-06-18 16:34:42 [root] INFO: should_process_url: URL https://closestays.com was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:34:42 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/home?status=https%3A%2F%2Flatindancecalendar.com%2Fadd%2F%3Ftype%3Dfestival%26referer%3Dfeed.
2025-06-18 16:34:42 [root] INFO: should_process_url: URL https://latindancecalendar.com/add/?type=festival&referer=feed was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:34:42 [root] INFO: should_process_url: URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Fadd%2F%3Ftype%3Dfestival%26referer%3Dfeed was last seen as relevant, processing it.
2025-06-18 16:34:42 [root] INFO: should_process_url: URL https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Fadd%2F%3Ftype%3Dfestival%26referer%3Dfeed was last seen as relevant, processing it.
2025-06-18 16:34:42 [root] INFO: write_url_to_db(): appended URL 'https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Fadd%2F%3Ftype%3Dfestival%26referer%3Dfeed'
2025-06-18 16:34:42 [root] INFO: def parse(): Crawling next URL: https://t.me/share/url?url=https%3A%2F%2Flatindancecalendar.com%2Fadd%2F%3Ftype%3Dfestival%26referer%3Dfeed
2025-06-18 16:34:42 [root] INFO: should_process_url: URL https://plus.google.com/+Latindancecalendar was last seen as relevant, processing it.
2025-06-18 16:34:42 [root] INFO: should_process_url: URL https://latindancecalendar.com/add/ was last seen as relevant, processing it.
2025-06-18 16:34:42 [root] INFO: should_process_url: URL https://latindancecalendar.com/add/ was last seen as relevant, processing it.
2025-06-18 16:34:42 [root] INFO: write_url_to_db(): appended URL 'https://latindancecalendar.com/add/'
2025-06-18 16:34:42 [root] INFO: def parse(): Crawling next URL: https://latindancecalendar.com/add/
2025-06-18 16:34:42 [root] INFO: def parse(): Found keywords for URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=846900&page=1: ['milonga', 'swing', 'tango', 'waltz', 'zouk']
2025-06-18 16:34:42 [root] INFO: def generate_prompt(): Generating prompt for URL: http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=846900&page=1
2025-06-18 16:34:42 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:34:42 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:34:42 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:34:54 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:34:54 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 16:34:54 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 16:34:54 [root] INFO: write_url_to_db(): appended URL 'http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=846900&page=1'
2025-06-18 16:34:54 [root] INFO: def parse(): URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=846900&page=1 marked as irrelevant (LLM negative).
2025-06-18 16:34:54 [root] INFO: def parse(): Found 10 links on https://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=846900&page=1
2025-06-18 16:34:54 [root] INFO: should_process_url: URL https://www.pgmusic.com/forums/ubbthreads.php?ubb=login&ocu=%2F%2Fwww.pgmusic.com%2Fforums%2Fubbthreads.php%3Fubb%3Dshowflat%26Number%3D846900%26page%3D1 has never been seen before, processing it.
2025-06-18 16:34:54 [root] INFO: should_process_url: URL https://www.pgmusic.com/forums/ubbthreads.php?ubb=login&ocu=%2F%2Fwww.pgmusic.com%2Fforums%2Fubbthreads.php%3Fubb%3Dshowflat%26Number%3D846900%26page%3D1 has never been seen before, processing it.
2025-06-18 16:34:54 [root] INFO: write_url_to_db(): appended URL 'https://www.pgmusic.com/forums/ubbthreads.php?ubb=login&ocu=%2F%2Fwww.pgmusic.com%2Fforums%2Fubbthreads.php%3Fubb%3Dshowflat%26Number%3D846900%26page%3D1'
2025-06-18 16:34:54 [root] INFO: def parse(): Crawling next URL: https://www.pgmusic.com/forums/ubbthreads.php?ubb=login&ocu=%2F%2Fwww.pgmusic.com%2Fforums%2Fubbthreads.php%3Fubb%3Dshowflat%26Number%3D846900%26page%3D1
2025-06-18 16:34:54 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/francais2025.exe has never been seen before, processing it.
2025-06-18 16:34:54 [root] INFO: should_process_url: URL https://www.pgmusic.com has never been seen before, processing it.
2025-06-18 16:34:54 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/italiano2025.exe has never been seen before, processing it.
2025-06-18 16:34:54 [root] INFO: should_process_url: URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=846900&page=1 has never been seen before, processing it.
2025-06-18 16:34:54 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/italiano2025RB.exe has never been seen before, processing it.
2025-06-18 16:34:54 [root] INFO: should_process_url: URL https://maps.google.com/maps?q=Victoria%2C+BC has never been seen before, processing it.
2025-06-18 16:34:54 [root] INFO: should_process_url: URL https://maps.google.com/maps?q=Victoria%2C+BC has never been seen before, processing it.
2025-06-18 16:34:54 [root] INFO: write_url_to_db(): appended URL 'https://maps.google.com/maps?q=Victoria%2C+BC'
2025-06-18 16:34:54 [root] INFO: def parse(): Crawling next URL: https://maps.google.com/maps?q=Victoria%2C+BC
2025-06-18 16:34:54 [root] INFO: should_process_url: URL https://www.bandinabox.com/bb.php?os=win&lang=it has never been seen before, processing it.
2025-06-18 16:34:54 [root] INFO: should_process_url: URL https://update.pgmusic.com/support/patch/bb2025_win_update_build1128.exe has never been seen before, processing it.
2025-06-18 16:34:54 [root] INFO: should_process_url: URL https://update.pgmusic.com/support/patch/bb2025_win_update_build1128.exe has never been seen before, processing it.
2025-06-18 16:34:54 [root] INFO: write_url_to_db(): appended URL 'https://update.pgmusic.com/support/patch/bb2025_win_update_build1128.exe'
2025-06-18 16:34:54 [root] INFO: def parse(): Crawling next URL: https://update.pgmusic.com/support/patch/bb2025_win_update_build1128.exe
2025-06-18 16:34:55 [root] INFO: def parse(): Found keywords for URL https://jazzvictoria.ca/jazzfest-home/: ['dance', 'live music', 'swing', 'two step']
2025-06-18 16:34:55 [root] INFO: def generate_prompt(): Generating prompt for URL: https://jazzvictoria.ca/jazzfest-home/
2025-06-18 16:34:55 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:34:55 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:34:55 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:34:57 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:34:57 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 281617 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 16:34:57 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:34:58 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:34:58 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 204741 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 16:34:58 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 16:34:58 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://jazzvictoria.ca/jazzfest-home/
2025-06-18 16:34:58 [root] INFO: write_url_to_db(): appended URL 'https://jazzvictoria.ca/jazzfest-home/'
2025-06-18 16:34:58 [root] INFO: def parse(): URL https://jazzvictoria.ca/jazzfest-home/ marked as irrelevant (LLM negative).
2025-06-18 16:34:58 [root] INFO: def parse(): Found 10 links on https://jazzvictoria.ca/jazzfest-home/
2025-06-18 16:34:58 [root] INFO: should_process_url: URL https://jazzvictoria.ca/outreach-workshops/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:34:58 [root] INFO: should_process_url: URL https://jazzvictoria.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:34:58 [root] INFO: should_process_url: URL https://jazzvictoria.ca/calendar/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:34:58 [root] INFO: should_process_url: URL https://jazzvictoria.ca/home/about/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:34:58 [root] INFO: should_process_url: URL https://jazzvictoria.ca was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:34:58 [root] INFO: should_process_url: URL https://jazzvictoria.ca/home/volunteer/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:34:58 [root] INFO: should_process_url: URL https://jazzvictoria.ca/home/tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:34:58 [root] INFO: should_process_url: URL https://jazzvictoria.ca/home/contact/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:34:58 [root] INFO: should_process_url: URL https://jazzvictoria.ca/jazzfest-home/ was last seen as relevant, processing it.
2025-06-18 16:34:58 [scrapy.extensions.logstats] INFO: Crawled 300 pages (at 2 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 16:34:58 [root] INFO: should_process_url: URL https://www.stay22.com/allez/vrbo?campaign=closestays-vrbo-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Fvrbo.com has never been seen before, processing it.
2025-06-18 16:34:58 [root] INFO: should_process_url: URL https://www.stay22.com/allez/vrbo?campaign=closestays-vrbo-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Fvrbo.com has never been seen before, processing it.
2025-06-18 16:34:58 [root] INFO: write_url_to_db(): appended URL 'https://www.stay22.com/allez/vrbo?campaign=closestays-vrbo-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Fvrbo.com'
2025-06-18 16:34:58 [root] INFO: def parse(): Crawling next URL: https://www.stay22.com/allez/vrbo?campaign=closestays-vrbo-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Fvrbo.com
2025-06-18 16:34:58 [root] INFO: should_process_url: URL https://www.stay22.com/allez/booking?campaign=closestays-booking-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Fbooking.com has never been seen before, processing it.
2025-06-18 16:34:58 [root] INFO: should_process_url: URL https://www.stay22.com/allez/booking?campaign=closestays-booking-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Fbooking.com has never been seen before, processing it.
2025-06-18 16:34:58 [root] INFO: write_url_to_db(): appended URL 'https://www.stay22.com/allez/booking?campaign=closestays-booking-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Fbooking.com'
2025-06-18 16:34:58 [root] INFO: def parse(): Crawling next URL: https://www.stay22.com/allez/booking?campaign=closestays-booking-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Fbooking.com
2025-06-18 16:34:58 [root] INFO: should_process_url: URL https://www.stay22.com/allez/tripadvisor?campaign=closestays-tripadvisor-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Ftripadvisor.com has never been seen before, processing it.
2025-06-18 16:34:58 [root] INFO: should_process_url: URL https://www.stay22.com/allez/tripadvisor?campaign=closestays-tripadvisor-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Ftripadvisor.com has never been seen before, processing it.
2025-06-18 16:34:58 [root] INFO: write_url_to_db(): appended URL 'https://www.stay22.com/allez/tripadvisor?campaign=closestays-tripadvisor-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Ftripadvisor.com'
2025-06-18 16:34:58 [root] INFO: def parse(): Crawling next URL: https://www.stay22.com/allez/tripadvisor?campaign=closestays-tripadvisor-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Ftripadvisor.com
2025-06-18 16:34:58 [root] INFO: should_process_url: URL https://www.stay22.com/allez/hotelscom?campaign=closestays-hotelscom-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Fhotels.com has never been seen before, processing it.
2025-06-18 16:34:58 [root] INFO: should_process_url: URL https://www.stay22.com/allez/hotelscom?campaign=closestays-hotelscom-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Fhotels.com has never been seen before, processing it.
2025-06-18 16:34:58 [root] INFO: write_url_to_db(): appended URL 'https://www.stay22.com/allez/hotelscom?campaign=closestays-hotelscom-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Fhotels.com'
2025-06-18 16:34:58 [root] INFO: def parse(): Crawling next URL: https://www.stay22.com/allez/hotelscom?campaign=closestays-hotelscom-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Fhotels.com
2025-06-18 16:34:58 [root] INFO: should_process_url: URL https://www.stay22.com/allez/expedia?campaign=closestays-expedia-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Fexpedia.com has never been seen before, processing it.
2025-06-18 16:34:58 [root] INFO: should_process_url: URL https://www.stay22.com/allez/expedia?campaign=closestays-expedia-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Fexpedia.com has never been seen before, processing it.
2025-06-18 16:34:58 [root] INFO: write_url_to_db(): appended URL 'https://www.stay22.com/allez/expedia?campaign=closestays-expedia-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Fexpedia.com'
2025-06-18 16:34:58 [root] INFO: def parse(): Crawling next URL: https://www.stay22.com/allez/expedia?campaign=closestays-expedia-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Fexpedia.com
2025-06-18 16:34:58 [root] INFO: def parse(): Found keywords for URL https://www.kathaumixw.org/schedule.shtml: ['dance']
2025-06-18 16:34:58 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.kathaumixw.org/schedule.shtml
2025-06-18 16:34:58 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:34:58 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:34:58 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:35:34 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:35:34 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "GALA OPENING CONCERT",
        "day_of_week": "Tuesday",
        "start_date": "2025-07-01",
        "end_date": "2025-07-01",
        "start_time": "19:30",
        "end_time": "",
        "price": "",
        "location": "Great Hall",
        "description": "Parade of Choirs, International Choral Spotlights, q̓at̓ᶿaymɩxʷ Festival Brass Ensemble & q̓at̓ᶿaymɩxʷ Festival Chorus"
    },
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Concert 1",
        "day_of_week": "Wednesday",
        "start_date": "2025-07-02",
        "end_date": "2025-07-02",
        "start_time": "15:00",
        "end_time": "",
        "price": "",
        "location": "Evergreen Theatre",
        "description": "Powell River Chorus (Canada), Kôr (Canada), The Squares (Canada), Coro Femenino Cantate (Costa Rica)"
    },
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Concert 2",
        "day_of_week": "Wednesday",
        "start_date": "2025-07-02",
        "end_date": "2025-07-02",
        "start_time": "15:00",
        "end_time": "",
        "price": "",
        "location": "Max Cameron Theatre",
        "description": "Komorni zbor MEGARON (Slovenia), Espiritu Vocal Ensemble (Canada), Brooks Chamber Choir (Canada), Toronto Children's Chorus (Canada)"
    },
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Concert 3",
        "day_of_week": "Wednesday",
        "start_date": "2025-07-02",
        "end_date": "2025-07-02",
        "start_time": "15:00",
        "end_time": "",
        "price": "",
        "location": "James Hall",
        "description": "Richmond Singers (Canada), Campanella Children's Choir (USA), Taipei Philharmonic Youth & Children's Choir (Taiwan)"
    },
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Concert 4",
        "day_of_week": "Wednesday",
        "start_date": "2025-07-02",
        "end_date": "2025-07-02",
        "start_time": "19:30",
        "end_time": "",
        "price": "",
        "location": "Evergreen Theatre",
        "description": "The Squares (Canada), Male ENsemble Philippines (Philippines), Toronto Children's Chorus (Canada), King's College Kappella (New Zealand)"
    },
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Concert 5",
        "day_of_week": "Wednesday",
        "start_date": "2025-07-02",
        "end_date": "2025-07-02",
        "start_time": "19:30",
        "end_time": "",
        "price": "",
        "location": "Max Cameron Theatre",
        "description": "Kôr (Canada), Richmond Singers (Canada), Yavir Ukrainian Male Chorus of Edmonton (Canada), Young People's Chorus of New York City (USA)"
    },
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Concert 6",
        "day_of_week": "Wednesday",
        "start_date": "2025-07-02",
        "end_date": "2025-07-02",
        "start_time": "19:30",
        "end_time": "",
        "price": "",
        "location": "James Hall",
        "description": "Espiritu Vocal Ensemble (Canada), Coro Femenino Cantate (Costa Rica), Komorni zbor MEGARON (Slovenia)"
    },
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Concert 7",
        "day_of_week": "Thursday",
        "start_date": "2025-07-03",
        "end_date": "2025-07-03",
        "start_time": "15:00",
        "end_time": "",
        "price": "",
        "location": "Evergreen Theatre",
        "description": "Kôr (Canada), King's College Kappella (New Zealand), Taipei Philharmonic Youth & Children's Choir (Taiwan), Young People's Chorus of New York City (USA)"
    },
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Concert 8",
        "day_of_week": "Thursday",
        "start_date": "2025-07-03",
        "end_date": "2025-07-03",
        "start_time": "15:00",
        "end_time": "",
        "price": "",
        "location": "Max Cameron Theatre",
        "description": "Campanella Children's Choir (USA), Male ENsemble Philippines (Philippines), Komorni zbor MEGARON (Slovenia), Coro Femenino Cantate (Costa Rica)"
    },
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Concert 9",
        "day_of_week": "Thursday",
        "start_date": "2025-07-03",
        "end_date": "2025-07-03",
        "start_time": "15:00",
        "end_time": "",
        "price": "",
        "location": "James Hall",
        "description": "Academy Apprentice Choir (Canada), Academy Singers (Canada), Chor Musica (Canada), Yavir Ukrainian Male Chorus of Edmonton (Canada)"
    },
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "CHORAL SHOWCASE",
        "day_of_week": "Thursday",
        "start_date": "2025-07-03",
        "end_date": "2025-07-03",
        "start_time": "19:30",
        "end_time": "",
        "price": "",
        "location": "Great Hall",
        "description": "Toronto Children's Choir (Canada), Young People's Chorus of New York City (USA), Male ENsemble Philippines (Philippines), Academy Chamber Choir (Canada)"
    },
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Concert 10",
        "day_of_week": "Friday",
        "start_date": "2025-07-04",
        "end_date": "2025-07-04",
        "start_time": "15:00",
        "end_time": "",
        "price": "",
        "location": "Evergreen Theatre",
        "description": "Richmond Singers (Canada), Male ENsemble Philippines (Philippines), Taipei Philharmonic Youth & Children's Choir (Taiwan), The Squares (Canada)"
    },
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Concert 11",
        "day_of_week": "Friday",
        "start_date": "2025-07-04",
        "end_date": "2025-07-04",
        "start_time": "15:00",
        "end_time": "",
        "price": "",
        "location": "Max Cameron Theatre",
        "description": "King's College Kappella (New Zealand), Yavir Ukrainian Male Chorus of Edmonton (Canada), Espiritu Vocal Ensemble (Canada), Campanella Children's Choir (USA)"
    },
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Concert 12",
        "day_of_week": "Friday",
        "start_date": "2025-07-04",
        "end_date": "2025-07-04",
        "start_time": "15:00",
        "end_time": "",
        "price": "",
        "location": "James Hall",
        "description": "Academy Chamber Choir (Canada), Brooks Chamber Choir (Canada), Young People's Chorus of New York City (USA)"
    },
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "AWARDS CONCERT",
        "day_of_week": "Friday",
        "start_date": "2025-07-04",
        "end_date": "2025-07-04",
        "start_time": "19:30",
        "end_time": "",
        "price": "",
        "location": "Great Hall",
        "description": "Performances by choral and solo competition winners"
    },
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "GALA CLOSING CONCERT",
        "day_of_week": "Saturday",
        "start_date": "2025-07-05",
        "end_date": "2025-07-05",
        "start_time": "19:30",
        "end_time": "",
        "price": "",
        "location": "Great Hall",
        "description": "q̓at̓ᶿaymɩxʷ Anthem, Winner of Best Performance of a Canadian Composition, q̓at̓ᶿaymɩxʷ 2025 Children's & SSA Youth Choir, Choral Spotlights, Choir of the World at q̓at̓ᶿaymɩxʷ, q̓at̓ᶿaymɩxʷ 2025 Adult Choir, q̓at̓ᶿaymɩxʷ 2025 Thousand-Voice Choir"
    }
]
2025-06-18 16:35:34 [root] INFO: def extract_and_parse_json(): for url https://www.kathaumixw.org/schedule.shtml, 
Cleaned JSON ready for parsing:
[
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "GALA OPENING CONCERT",
        "day_of_week": "Tuesday",
        "start_date": "2025-07-01",
        "end_date": "2025-07-01",
        "start_time": "19:30",
        "end_time": "",
        "price": "",
        "location": "Great Hall",
        "description": "Parade of Choirs, International Choral Spotlights, q̓at̓ᶿaymɩxʷ Festival Brass Ensemble & q̓at̓ᶿaymɩxʷ Festival Chorus"
    },
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Concert 1",
        "day_of_week": "Wednesday",
        "start_date": "2025-07-02",
        "end_date": "2025-07-02",
        "start_time": "15:00",
        "end_time": "",
        "price": "",
        "location": "Evergreen Theatre",
        "description": "Powell River Chorus (Canada), Kôr (Canada), The Squares (Canada), Coro Femenino Cantate (Costa Rica)"
    },
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Concert 2",
        "day_of_week": "Wednesday",
        "start_date": "2025-07-02",
        "end_date": "2025-07-02",
        "start_time": "15:00",
        "end_time": "",
        "price": "",
        "location": "Max Cameron Theatre",
        "description": "Komorni zbor MEGARON (Slovenia), Espiritu Vocal Ensemble (Canada), Brooks Chamber Choir (Canada), Toronto Children's Chorus (Canada)"
    },
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Concert 3",
        "day_of_week": "Wednesday",
        "start_date": "2025-07-02",
        "end_date": "2025-07-02",
        "start_time": "15:00",
        "end_time": "",
        "price": "",
        "location": "James Hall",
        "description": "Richmond Singers (Canada), Campanella Children's Choir (USA), Taipei Philharmonic Youth & Children's Choir (Taiwan)"
    },
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Concert 4",
        "day_of_week": "Wednesday",
        "start_date": "2025-07-02",
        "end_date": "2025-07-02",
        "start_time": "19:30",
        "end_time": "",
        "price": "",
        "location": "Evergreen Theatre",
        "description": "The Squares (Canada), Male ENsemble Philippines (Philippines), Toronto Children's Chorus (Canada), King's College Kappella (New Zealand)"
    },
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Concert 5",
        "day_of_week": "Wednesday",
        "start_date": "2025-07-02",
        "end_date": "2025-07-02",
        "start_time": "19:30",
        "end_time": "",
        "price": "",
        "location": "Max Cameron Theatre",
        "description": "Kôr (Canada), Richmond Singers (Canada), Yavir Ukrainian Male Chorus of Edmonton (Canada), Young People's Chorus of New York City (USA)"
    },
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Concert 6",
        "day_of_week": "Wednesday",
        "start_date": "2025-07-02",
        "end_date": "2025-07-02",
        "start_time": "19:30",
        "end_time": "",
        "price": "",
        "location": "James Hall",
        "description": "Espiritu Vocal Ensemble (Canada), Coro Femenino Cantate (Costa Rica), Komorni zbor MEGARON (Slovenia)"
    },
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Concert 7",
        "day_of_week": "Thursday",
        "start_date": "2025-07-03",
        "end_date": "2025-07-03",
        "start_time": "15:00",
        "end_time": "",
        "price": "",
        "location": "Evergreen Theatre",
        "description": "Kôr (Canada), King's College Kappella (New Zealand), Taipei Philharmonic Youth & Children's Choir (Taiwan), Young People's Chorus of New York City (USA)"
    },
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Concert 8",
        "day_of_week": "Thursday",
        "start_date": "2025-07-03",
        "end_date": "2025-07-03",
        "start_time": "15:00",
        "end_time": "",
        "price": "",
        "location": "Max Cameron Theatre",
        "description": "Campanella Children's Choir (USA), Male ENsemble Philippines (Philippines), Komorni zbor MEGARON (Slovenia), Coro Femenino Cantate (Costa Rica)"
    },
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Concert 9",
        "day_of_week": "Thursday",
        "start_date": "2025-07-03",
        "end_date": "2025-07-03",
        "start_time": "15:00",
        "end_time": "",
        "price": "",
        "location": "James Hall",
        "description": "Academy Apprentice Choir (Canada), Academy Singers (Canada), Chor Musica (Canada), Yavir Ukrainian Male Chorus of Edmonton (Canada)"
    },
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "CHORAL SHOWCASE",
        "day_of_week": "Thursday",
        "start_date": "2025-07-03",
        "end_date": "2025-07-03",
        "start_time": "19:30",
        "end_time": "",
        "price": "",
        "location": "Great Hall",
        "description": "Toronto Children's Choir (Canada), Young People's Chorus of New York City (USA), Male ENsemble Philippines (Philippines), Academy Chamber Choir (Canada)"
    },
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Concert 10",
        "day_of_week": "Friday",
        "start_date": "2025-07-04",
        "end_date": "2025-07-04",
        "start_time": "15:00",
        "end_time": "",
        "price": "",
        "location": "Evergreen Theatre",
        "description": "Richmond Singers (Canada), Male ENsemble Philippines (Philippines), Taipei Philharmonic Youth & Children's Choir (Taiwan), The Squares (Canada)"
    },
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Concert 11",
        "day_of_week": "Friday",
        "start_date": "2025-07-04",
        "end_date": "2025-07-04",
        "start_time": "15:00",
        "end_time": "",
        "price": "",
        "location": "Max Cameron Theatre",
        "description": "King's College Kappella (New Zealand), Yavir Ukrainian Male Chorus of Edmonton (Canada), Espiritu Vocal Ensemble (Canada), Campanella Children's Choir (USA)"
    },
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Concert 12",
        "day_of_week": "Friday",
        "start_date": "2025-07-04",
        "end_date": "2025-07-04",
        "start_time": "15:00",
        "end_time": "",
        "price": "",
        "location": "James Hall",
        "description": "Academy Chamber Choir (Canada), Brooks Chamber Choir (Canada), Young People's Chorus of New York City (USA)"
    },
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "AWARDS CONCERT",
        "day_of_week": "Friday",
        "start_date": "2025-07-04",
        "end_date": "2025-07-04",
        "start_time": "19:30",
        "end_time": "",
        "price": "",
        "location": "Great Hall",
        "description": "Performances by choral and solo competition winners"
    },
    {
        "source": "International Choral q̓at̓ᶿaymɩxʷ",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "GALA CLOSING CONCERT",
        "day_of_week": "Saturday",
        "start_date": "2025-07-05",
        "end_date": "2025-07-05",
        "start_time": "19:30",
        "end_time": "",
        "price": "",
        "location": "Great Hall",
        "description": "q̓at̓ᶿaymɩxʷ Anthem, Winner of Best Performance of a Canadian Composition, q̓at̓ᶿaymɩxʷ 2025 Children's & SSA Youth Choir, Choral Spotlights, Choir of the World at q̓at̓ᶿaymɩxʷ, q̓at̓ᶿaymɩxʷ 2025 Adult Choir, q̓at̓ᶿaymɩxʷ 2025 Thousand-Voice Choir"
    }
]
2025-06-18 16:35:34 [root] INFO: def clean_up_address(): Starting with events_df shape: (16, 14)
2025-06-18 16:35:34 [root] INFO: def clean_up_address(): Processing location 'Great Hall' (event_id: None)
2025-06-18 16:35:34 [root] INFO: def clean_up_address(): Processing location 'Evergreen Theatre' (event_id: None)
2025-06-18 16:35:34 [root] INFO: def clean_up_address(): Processing location 'Max Cameron Theatre' (event_id: None)
2025-06-18 16:35:34 [root] INFO: def clean_up_address(): Processing location 'James Hall' (event_id: None)
2025-06-18 16:35:34 [root] INFO: def clean_up_address(): Processing location 'Evergreen Theatre' (event_id: None)
2025-06-18 16:35:34 [root] INFO: def clean_up_address(): Processing location 'Max Cameron Theatre' (event_id: None)
2025-06-18 16:35:34 [root] INFO: def clean_up_address(): Processing location 'James Hall' (event_id: None)
2025-06-18 16:35:34 [root] INFO: def clean_up_address(): Processing location 'Evergreen Theatre' (event_id: None)
2025-06-18 16:35:34 [root] INFO: def clean_up_address(): Processing location 'Max Cameron Theatre' (event_id: None)
2025-06-18 16:35:34 [root] INFO: def clean_up_address(): Processing location 'James Hall' (event_id: None)
2025-06-18 16:35:34 [root] INFO: def clean_up_address(): Processing location 'Great Hall' (event_id: None)
2025-06-18 16:35:34 [root] INFO: def clean_up_address(): Processing location 'Evergreen Theatre' (event_id: None)
2025-06-18 16:35:34 [root] INFO: def clean_up_address(): Processing location 'Max Cameron Theatre' (event_id: None)
2025-06-18 16:35:34 [root] INFO: def clean_up_address(): Processing location 'James Hall' (event_id: None)
2025-06-18 16:35:34 [root] INFO: def clean_up_address(): Processing location 'Great Hall' (event_id: None)
2025-06-18 16:35:34 [root] INFO: def clean_up_address(): Processing location 'Great Hall' (event_id: None)
2025-06-18 16:35:34 [root] INFO: write_events_to_db: Number of events to write: 16
2025-06-18 16:35:34 [root] INFO: write_url_to_db(): appended URL 'https://www.kathaumixw.org/schedule.shtml'
2025-06-18 16:35:34 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 16:35:34 [root] INFO: def process_llm_response: URL https://www.kathaumixw.org/schedule.shtml marked as relevant with events written to the database.
2025-06-18 16:35:34 [root] INFO: write_url_to_db(): appended URL 'https://www.kathaumixw.org/schedule.shtml'
2025-06-18 16:35:34 [root] INFO: def parse(): URL https://www.kathaumixw.org/schedule.shtml marked as relevant (LLM positive).
2025-06-18 16:35:34 [root] INFO: def parse(): Found 2 links on https://www.kathaumixw.org/schedule.shtml
2025-06-18 16:35:34 [root] INFO: should_process_url: URL https://www.kathaumixw.org/schedule.shtml was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:35:34 [root] INFO: should_process_url: URL https://www.kathaumixw.org/tickets.shtml was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:35:34 [root] INFO: should_process_url: URL http://www.powellriveracademy.org has never been seen before, processing it.
2025-06-18 16:35:34 [root] INFO: write_url_to_db(): appended URL 'http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=849054&page=1'
2025-06-18 16:35:34 [root] INFO: def parse(): URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=849054&page=1 marked as irrelevant (no keywords).
2025-06-18 16:35:34 [root] INFO: def parse(): Found 10 links on https://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=849054&page=1
2025-06-18 16:35:34 [root] INFO: should_process_url: URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=849054&page=1 has never been seen before, processing it.
2025-06-18 16:35:34 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/deutsch2025.exe has never been seen before, processing it.
2025-06-18 16:35:34 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/francais2025.exe has never been seen before, processing it.
2025-06-18 16:35:34 [root] INFO: should_process_url: URL https://www.pgmusic.com has never been seen before, processing it.
2025-06-18 16:35:34 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/deutsch2025RB.exe has never been seen before, processing it.
2025-06-18 16:35:34 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/deutsch2025RB.exe has never been seen before, processing it.
2025-06-18 16:35:34 [root] INFO: write_url_to_db(): appended URL 'https://nn.pgmusic.com/pgfiles/languagesupport/deutsch2025RB.exe'
2025-06-18 16:35:34 [root] INFO: def parse(): Crawling next URL: https://nn.pgmusic.com/pgfiles/languagesupport/deutsch2025RB.exe
2025-06-18 16:35:34 [root] INFO: should_process_url: URL https://www.pgmusic.com/forums/ubbthreads.php?ubb=login&ocu=%2F%2Fwww.pgmusic.com%2Fforums%2Fubbthreads.php%3Fubb%3Dshowflat%26Number%3D849054%26page%3D1 has never been seen before, processing it.
2025-06-18 16:35:34 [root] INFO: should_process_url: URL https://www.pgmusic.com/forums/ubbthreads.php?ubb=login&ocu=%2F%2Fwww.pgmusic.com%2Fforums%2Fubbthreads.php%3Fubb%3Dshowflat%26Number%3D849054%26page%3D1 has never been seen before, processing it.
2025-06-18 16:35:34 [root] INFO: write_url_to_db(): appended URL 'https://www.pgmusic.com/forums/ubbthreads.php?ubb=login&ocu=%2F%2Fwww.pgmusic.com%2Fforums%2Fubbthreads.php%3Fubb%3Dshowflat%26Number%3D849054%26page%3D1'
2025-06-18 16:35:34 [root] INFO: def parse(): Crawling next URL: https://www.pgmusic.com/forums/ubbthreads.php?ubb=login&ocu=%2F%2Fwww.pgmusic.com%2Fforums%2Fubbthreads.php%3Fubb%3Dshowflat%26Number%3D849054%26page%3D1
2025-06-18 16:35:34 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/italiano2025.exe has never been seen before, processing it.
2025-06-18 16:35:34 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/italiano2025RB.exe has never been seen before, processing it.
2025-06-18 16:35:34 [root] INFO: should_process_url: URL https://www.bandinabox.com/bb.php?os=win&lang=it has never been seen before, processing it.
2025-06-18 16:35:34 [root] INFO: should_process_url: URL http://www.bandinabox.com/bb.php?os=win&lang=de has never been seen before, processing it.
2025-06-18 16:35:34 [root] INFO: should_process_url: URL http://www.bandinabox.com/bb.php?os=win&lang=de has never been seen before, processing it.
2025-06-18 16:35:34 [root] INFO: write_url_to_db(): appended URL 'http://www.bandinabox.com/bb.php?os=win&lang=de'
2025-06-18 16:35:34 [root] INFO: def parse(): Crawling next URL: http://www.bandinabox.com/bb.php?os=win&lang=de
2025-06-18 16:35:34 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/francais2025RB.exe has never been seen before, processing it.
2025-06-18 16:35:34 [root] INFO: write_url_to_db(): appended URL 'http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=849631&page=1'
2025-06-18 16:35:34 [root] INFO: def parse(): URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=849631&page=1 marked as irrelevant (no keywords).
2025-06-18 16:35:34 [root] INFO: def parse(): Found 10 links on https://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=849631&page=1
2025-06-18 16:35:34 [root] INFO: should_process_url: URL https://www.pgmusic.com/forums/ubbthreads.php?ubb=login&ocu=%2F%2Fwww.pgmusic.com%2Fforums%2Fubbthreads.php%3Fubb%3Dshowflat%26Number%3D849631%26page%3D1 has never been seen before, processing it.
2025-06-18 16:35:34 [root] INFO: should_process_url: URL https://www.pgmusic.com/forums/ubbthreads.php?ubb=login&ocu=%2F%2Fwww.pgmusic.com%2Fforums%2Fubbthreads.php%3Fubb%3Dshowflat%26Number%3D849631%26page%3D1 has never been seen before, processing it.
2025-06-18 16:35:34 [root] INFO: write_url_to_db(): appended URL 'https://www.pgmusic.com/forums/ubbthreads.php?ubb=login&ocu=%2F%2Fwww.pgmusic.com%2Fforums%2Fubbthreads.php%3Fubb%3Dshowflat%26Number%3D849631%26page%3D1'
2025-06-18 16:35:34 [root] INFO: def parse(): Crawling next URL: https://www.pgmusic.com/forums/ubbthreads.php?ubb=login&ocu=%2F%2Fwww.pgmusic.com%2Fforums%2Fubbthreads.php%3Fubb%3Dshowflat%26Number%3D849631%26page%3D1
2025-06-18 16:35:34 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/francais2025.exe has never been seen before, processing it.
2025-06-18 16:35:34 [root] INFO: should_process_url: URL https://www.pgmusic.com has never been seen before, processing it.
2025-06-18 16:35:34 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/italiano2025.exe has never been seen before, processing it.
2025-06-18 16:35:34 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/italiano2025RB.exe has never been seen before, processing it.
2025-06-18 16:35:34 [root] INFO: should_process_url: URL http://www.pgmusic.com/forums/ubbthreads.php?ubb=showflat&Number=849631&page=1 has never been seen before, processing it.
2025-06-18 16:35:34 [root] INFO: should_process_url: URL https://www.bandinabox.com/bb.php?os=win&lang=it has never been seen before, processing it.
2025-06-18 16:35:34 [root] INFO: should_process_url: URL https://nn.pgmusic.com/pgfiles/languagesupport/francais2025RB.exe has never been seen before, processing it.
2025-06-18 16:35:34 [scrapy.extensions.logstats] INFO: Crawled 301 pages (at 1 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 16:35:34 [root] INFO: write_url_to_db(): appended URL 'https://t.me/The_Jerusalem_Post'
2025-06-18 16:35:34 [root] INFO: def parse(): URL https://t.me/The_Jerusalem_Post marked as irrelevant (no keywords).
2025-06-18 16:35:34 [root] INFO: def parse(): Found 0 links on https://t.me/The_Jerusalem_Post
2025-06-18 16:35:34 [root] INFO: should_process_url: URL https://t.me/The_Jerusalem_Post has never been seen before, processing it.
2025-06-18 16:35:35 [root] INFO: write_url_to_db(): appended URL 'https://payments.jpost.com/paywall/paywallpersonaldetails'
2025-06-18 16:35:35 [root] INFO: def parse(): URL https://payments.jpost.com/paywall/paywallpersonaldetails marked as irrelevant (no keywords).
2025-06-18 16:35:35 [root] INFO: def parse(): Found 2 links on https://payments.jpost.com/paywall/paywallpersonaldetails
2025-06-18 16:35:35 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-T4BJGTM, URL: https://payments.jpost.com/paywall/paywallpersonaldetails, source: Jewish nomad woman | The Jerusalem Post, keywords: argentine tango
2025-06-18 16:35:35 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 16:35:35 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-T4BJGTM
2025-06-18 16:35:35 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-T4BJGTM'
2025-06-18 16:35:35 [root] INFO: should_process_url: URL https://www.jpost.com/premium has never been seen before, processing it.
2025-06-18 16:35:35 [root] INFO: should_process_url: URL https://www.jpost.com/premium has never been seen before, processing it.
2025-06-18 16:35:35 [root] INFO: write_url_to_db(): appended URL 'https://www.jpost.com/premium'
2025-06-18 16:35:35 [root] INFO: def parse(): Crawling next URL: https://www.jpost.com/premium
2025-06-18 16:35:35 [root] INFO: should_process_url: URL https://www.jpost.com has never been seen before, processing it.
2025-06-18 16:35:35 [root] INFO: should_process_url: URL https://www.jpost.com has never been seen before, processing it.
2025-06-18 16:35:35 [root] INFO: write_url_to_db(): appended URL 'https://www.jpost.com'
2025-06-18 16:35:35 [root] INFO: def parse(): Crawling next URL: https://www.jpost.com
2025-06-18 16:35:35 [root] INFO: should_process_url: URL https://payments.jpost.com/paywall/paywallpersonaldetails has never been seen before, processing it.
2025-06-18 16:35:35 [root] INFO: write_url_to_db(): appended URL 'https://www.songheesdevco.com/economic-initiatives/business-partnerships/matullia-holdings-lp'
2025-06-18 16:35:35 [root] INFO: def parse(): URL https://www.songheesdevco.com/economic-initiatives/business-partnerships/matullia-holdings-lp marked as irrelevant (no keywords).
2025-06-18 16:35:35 [root] INFO: def parse(): Found 5 links on https://www.songheesdevco.com/economic-initiatives/business-partnerships/matullia-holdings-lp
2025-06-18 16:35:35 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/SongheesNation/'
2025-06-18 16:35:35 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/SongheesNation/
2025-06-18 16:35:35 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/songheesnation/'
2025-06-18 16:35:35 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/songheesnation/
2025-06-18 16:35:35 [root] INFO: should_process_url: URL http://outdatedbrowser.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:35:35 [root] INFO: should_process_url: URL http://outdatedbrowser.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:35:35 [root] INFO: write_url_to_db(): appended URL 'http://outdatedbrowser.com/'
2025-06-18 16:35:35 [root] INFO: def parse(): Crawling next URL: http://outdatedbrowser.com/
2025-06-18 16:35:35 [root] INFO: should_process_url: URL https://www.songheesdevco.com/economic-initiatives/business-partnerships/matullia-holdings-lp was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:35:35 [root] INFO: should_process_url: URL https://enable-javascript.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:35:35 [root] INFO: should_process_url: URL https://enable-javascript.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:35:35 [root] INFO: write_url_to_db(): appended URL 'https://enable-javascript.com/'
2025-06-18 16:35:35 [root] INFO: def parse(): Crawling next URL: https://enable-javascript.com/
2025-06-18 16:35:35 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/songheesnation.
2025-06-18 16:35:35 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <400 https://x.com/Jerusalem_Post>: HTTP status code is not handled or not allowed
2025-06-18 16:35:35 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <403 https://www.tripadvisor.com/?m=67388&synclid=latindancecalendar-closestays-tripadvisor-homepage&zuc=CAD>: HTTP status code is not handled or not allowed
2025-06-18 16:35:35 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/signin/signup/?referrer=%2Fmanage%2Fevents%2Fcreate%2F'
2025-06-18 16:35:35 [root] INFO: def parse(): URL https://www.eventbrite.com/signin/signup/?referrer=%2Fmanage%2Fevents%2Fcreate%2F marked as irrelevant (no keywords).
2025-06-18 16:35:35 [root] INFO: def parse(): Found 0 links on https://www.eventbrite.com/signin/signup/?referrer=%2Fmanage%2Fevents%2Fcreate%2F
2025-06-18 16:35:35 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ, URL: https://www.eventbrite.com/signin/signup/?referrer=%2Fmanage%2Fevents%2Fcreate%2F, source: Argentine tango classes & related events | Eventbrite, keywords: argentine tango
2025-06-18 16:35:35 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 16:35:35 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ
2025-06-18 16:35:35 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ'
2025-06-18 16:35:35 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/signup/?referrer=%2Fmanage%2Fevents%2Fcreate%2F was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:35:35 [root] INFO: def parse(): Found keywords for URL https://www.eventbrite.com/signin/signup/?referrer=%2Fcc%2Fargentine-tango-classes-related-events-2881689: ['tango']
2025-06-18 16:35:35 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.eventbrite.com/signin/signup/?referrer=%2Fcc%2Fargentine-tango-classes-related-events-2881689
2025-06-18 16:35:35 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:35:35 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:35:35 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:35:37 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:35:37 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 16:35:37 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 16:35:37 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/signin/signup/?referrer=%2Fcc%2Fargentine-tango-classes-related-events-2881689'
2025-06-18 16:35:37 [root] INFO: def parse(): URL https://www.eventbrite.com/signin/signup/?referrer=%2Fcc%2Fargentine-tango-classes-related-events-2881689 marked as irrelevant (LLM negative).
2025-06-18 16:35:37 [root] INFO: def parse(): Found 0 links on https://www.eventbrite.com/signin/signup/?referrer=%2Fcc%2Fargentine-tango-classes-related-events-2881689
2025-06-18 16:35:37 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ, URL: https://www.eventbrite.com/signin/signup/?referrer=%2Fcc%2Fargentine-tango-classes-related-events-2881689, source: Argentine tango classes & related events | Eventbrite, keywords: argentine tango
2025-06-18 16:35:37 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 16:35:37 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ
2025-06-18 16:35:37 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ'
2025-06-18 16:35:37 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/signup/?referrer=%2Fcc%2Fargentine-tango-classes-related-events-2881689 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:35:37 [root] INFO: def parse(): Found keywords for URL https://creativebc.com/: ['live music']
2025-06-18 16:35:37 [root] INFO: def generate_prompt(): Generating prompt for URL: https://creativebc.com/
2025-06-18 16:35:37 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:35:37 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:35:37 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:35:41 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:35:41 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 760523 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 16:35:41 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:35:43 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:35:43 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 538771 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 16:35:43 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 16:35:43 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://creativebc.com/
2025-06-18 16:35:43 [root] INFO: write_url_to_db(): appended URL 'https://creativebc.com/'
2025-06-18 16:35:43 [root] INFO: def parse(): URL https://creativebc.com/ marked as irrelevant (LLM negative).
2025-06-18 16:35:43 [root] INFO: def parse(): Found 10 links on https://creativebc.com/
2025-06-18 16:35:43 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-M58QS7V, URL: https://creativebc.com/, source: Rifflandia Festival, keywords: music festivals
2025-06-18 16:35:43 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 16:35:43 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-M58QS7V
2025-06-18 16:35:43 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-M58QS7V'
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/register-a-production/ has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/register-a-production/ has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: write_url_to_db(): appended URL 'https://creativebc.com/bc-film-commission/register-a-production/'
2025-06-18 16:35:43 [root] INFO: def parse(): Crawling next URL: https://creativebc.com/bc-film-commission/register-a-production/
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/consults-packages-surveys/ has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/consults-packages-surveys/ has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: write_url_to_db(): appended URL 'https://creativebc.com/bc-film-commission/library-production-services/consults-packages-surveys/'
2025-06-18 16:35:43 [root] INFO: def parse(): Crawling next URL: https://creativebc.com/bc-film-commission/library-production-services/consults-packages-surveys/
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/in-production/ has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/in-production/ has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: write_url_to_db(): appended URL 'https://creativebc.com/bc-film-commission/in-production/'
2025-06-18 16:35:43 [root] INFO: def parse(): Crawling next URL: https://creativebc.com/bc-film-commission/in-production/
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/ has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/ has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: write_url_to_db(): appended URL 'https://creativebc.com/bc-film-commission/'
2025-06-18 16:35:43 [root] INFO: def parse(): Crawling next URL: https://creativebc.com/bc-film-commission/
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/code-of-conduct/ has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/code-of-conduct/ has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: write_url_to_db(): appended URL 'https://creativebc.com/bc-film-commission/library-production-services/code-of-conduct/'
2025-06-18 16:35:43 [root] INFO: def parse(): Crawling next URL: https://creativebc.com/bc-film-commission/library-production-services/code-of-conduct/
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/cross-border-services/ has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/cross-border-services/ has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: write_url_to_db(): appended URL 'https://creativebc.com/bc-film-commission/library-production-services/cross-border-services/'
2025-06-18 16:35:43 [root] INFO: def parse(): Crawling next URL: https://creativebc.com/bc-film-commission/library-production-services/cross-border-services/
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/greater-vancouver/ has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/greater-vancouver/ has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: write_url_to_db(): appended URL 'https://creativebc.com/bc-film-commission/library-production-services/greater-vancouver/'
2025-06-18 16:35:43 [root] INFO: def parse(): Crawling next URL: https://creativebc.com/bc-film-commission/library-production-services/greater-vancouver/
2025-06-18 16:35:43 [root] INFO: write_url_to_db(): appended URL 'https://store.jpost.com/'
2025-06-18 16:35:43 [root] INFO: def parse(): URL https://store.jpost.com/ marked as irrelevant (no keywords).
2025-06-18 16:35:43 [root] INFO: def parse(): Found 10 links on https://store.jpost.com/
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/4/1 has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/4/1 has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: write_url_to_db(): appended URL 'https://payments.jpost.com/jpmagazine/product/4/1'
2025-06-18 16:35:43 [root] INFO: def parse(): Crawling next URL: https://payments.jpost.com/jpmagazine/product/4/1
2025-06-18 16:35:43 [root] INFO: write_url_to_db(): appended URL 'https://www.eventbrite.com/signin/?referrer=/manage/events/create/'
2025-06-18 16:35:43 [root] INFO: def parse(): URL https://www.eventbrite.com/signin/?referrer=/manage/events/create/ marked as irrelevant (no keywords).
2025-06-18 16:35:43 [root] INFO: def parse(): Found 0 links on https://www.eventbrite.com/signin/?referrer=/manage/events/create/
2025-06-18 16:35:43 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ, URL: https://www.eventbrite.com/signin/?referrer=/manage/events/create/, source: Argentine tango classes & related events | Eventbrite, keywords: argentine tango
2025-06-18 16:35:43 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 16:35:43 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ
2025-06-18 16:35:43 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-5P8FXJ'
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://www.eventbrite.com/signin/?referrer=/manage/events/create/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/ has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/ has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: write_url_to_db(): appended URL 'https://creativebc.com/bc-film-commission/library-production-services/'
2025-06-18 16:35:43 [root] INFO: def parse(): Crawling next URL: https://creativebc.com/bc-film-commission/library-production-services/
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/15/4 has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/15/4 has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: write_url_to_db(): appended URL 'https://payments.jpost.com/jpmagazine/product/15/4'
2025-06-18 16:35:43 [root] INFO: def parse(): Crawling next URL: https://payments.jpost.com/jpmagazine/product/15/4
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://creativebc.com/ has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/production-credits/ has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/production-credits/ has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: write_url_to_db(): appended URL 'https://creativebc.com/bc-film-commission/production-credits/'
2025-06-18 16:35:43 [root] INFO: def parse(): Crawling next URL: https://creativebc.com/bc-film-commission/production-credits/
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/7/2 has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/7/2 has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: write_url_to_db(): appended URL 'https://payments.jpost.com/jpmagazine/product/7/2'
2025-06-18 16:35:43 [root] INFO: def parse(): Crawling next URL: https://payments.jpost.com/jpmagazine/product/7/2
2025-06-18 16:35:43 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <406 https://latindancecanada.com/our-family/>: HTTP status code is not handled or not allowed
2025-06-18 16:35:43 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <403 http://outdatedbrowser.com/>: HTTP status code is not handled or not allowed
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: write_url_to_db(): appended URL 'https://payments.jpost.com/jpmagazine'
2025-06-18 16:35:43 [root] INFO: def parse(): Crawling next URL: https://payments.jpost.com/jpmagazine
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://store.jpost.com/ has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/3/1 has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/3/1 has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: write_url_to_db(): appended URL 'https://payments.jpost.com/jpmagazine/product/3/1'
2025-06-18 16:35:43 [root] INFO: def parse(): Crawling next URL: https://payments.jpost.com/jpmagazine/product/3/1
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://payments.jpost.com/conference/tickettypes has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://payments.jpost.com/conference/tickettypes has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: write_url_to_db(): appended URL 'https://payments.jpost.com/conference/tickettypes'
2025-06-18 16:35:43 [root] INFO: def parse(): Crawling next URL: https://payments.jpost.com/conference/tickettypes
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/12/1 has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/12/1 has never been seen before, processing it.
2025-06-18 16:35:43 [root] INFO: write_url_to_db(): appended URL 'https://payments.jpost.com/jpmagazine/product/12/1'
2025-06-18 16:35:43 [root] INFO: def parse(): Crawling next URL: https://payments.jpost.com/jpmagazine/product/12/1
2025-06-18 16:35:43 [root] INFO: def parse(): Found keywords for URL https://alces.world/about-us/#volunteer: ['bachata', 'dance', 'kizomba', 'semba', 'urban kiz']
2025-06-18 16:35:43 [root] INFO: def generate_prompt(): Generating prompt for URL: https://alces.world/about-us/#volunteer
2025-06-18 16:35:43 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:35:43 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:35:43 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:50:44 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 504 Gateway Timeout"
2025-06-18 16:50:44 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 504
{
  "message":"The upstream server is timing out",
  "request_id":"1060f84568a359423e953858b271b911"
}
2025-06-18 16:50:44 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:50:52 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:50:52 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 16:50:52 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 16:50:52 [root] INFO: write_url_to_db(): appended URL 'https://alces.world/about-us/#volunteer'
2025-06-18 16:50:52 [root] INFO: def parse(): URL https://alces.world/about-us/#volunteer marked as irrelevant (LLM negative).
2025-06-18 16:50:52 [root] INFO: def parse(): Found 10 links on https://alces.world/about-us/
2025-06-18 16:50:52 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/events/758501768607647/?acontext=%7B%22event_action_history%22%3A%5B%7B%22surface%22%3A%22external%22%7D%2C%7B%22mechanism%22%3A%22your_upcoming_events_unit%22%2C%22surface%22%3A%22bookmark%22%7D%5D%2C%22ref_notif_type%22%3Anull%7D'
2025-06-18 16:50:52 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/events/758501768607647/?acontext=%7B%22event_action_history%22%3A%5B%7B%22surface%22%3A%22external%22%7D%2C%7B%22mechanism%22%3A%22your_upcoming_events_unit%22%2C%22surface%22%3A%22bookmark%22%7D%5D%2C%22ref_notif_type%22%3Anull%7D
2025-06-18 16:50:52 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/vic_international_kizomba_fest/'
2025-06-18 16:50:52 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/vic_international_kizomba_fest/
2025-06-18 16:50:52 [root] INFO: should_process_url: URL https://alces.world/about-us/#volunteer was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:50:52 [root] INFO: should_process_url: URL https://alces.world/about-us/ was last seen as relevant, processing it.
2025-06-18 16:50:52 [root] INFO: should_process_url: URL https://alces.world/about-us/#values was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:50:52 [root] INFO: should_process_url: URL https://alces.world/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 16:50:52 [root] INFO: should_process_url: URL https://alces.world/6th-edition/ was last seen as relevant, processing it.
2025-06-18 16:50:52 [root] INFO: def parse(): Found keywords for URL https://www.google.ca/maps/place/2514+Bridge+St,+Victoria,+BC+V8T+5H3/@48.4358314,-123.375177,17z/data=!3m1!4b1!4m5!3m4!1s0x548f737db485e64f:0x2d281917422952de!8m2!3d48.4358314!4d-123.372983?hl=en: ['wcs']
2025-06-18 16:50:52 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.google.ca/maps/place/2514+Bridge+St,+Victoria,+BC+V8T+5H3/@48.4358314,-123.375177,17z/data=!3m1!4b1!4m5!3m4!1s0x548f737db485e64f:0x2d281917422952de!8m2!3d48.4358314!4d-123.372983?hl=en
2025-06-18 16:50:52 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:50:52 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:50:52 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:50:53 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:50:53 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 171258 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 16:50:53 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:51:03 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:51:03 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 16:51:03 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 16:51:03 [root] INFO: write_url_to_db(): appended URL 'https://www.google.ca/maps/place/2514+Bridge+St,+Victoria,+BC+V8T+5H3/@48.4358314,-123.375177,17z/data=!3m1!4b1!4m5!3m4!1s0x548f737db485e64f:0x2d281917422952de!8m2!3d48.4358314!4d-123.372983?hl=en'
2025-06-18 16:51:03 [root] INFO: def parse(): URL https://www.google.ca/maps/place/2514+Bridge+St,+Victoria,+BC+V8T+5H3/@48.4358314,-123.375177,17z/data=!3m1!4b1!4m5!3m4!1s0x548f737db485e64f:0x2d281917422952de!8m2!3d48.4358314!4d-123.372983?hl=en marked as irrelevant (LLM negative).
2025-06-18 16:51:03 [root] INFO: def parse(): Found 1 links on https://www.google.ca/maps/place/2514+Bridge+St,+Victoria,+BC+V8T+5H3/@48.4358314,-123.375177,17z/data=!3m1!4b1!4m5!3m4!1s0x548f737db485e64f:0x2d281917422952de!8m2!3d48.4358314!4d-123.372983?hl=en
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://www.google.ca/maps/place/2514+Bridge+St,+Victoria,+BC+V8T+5H3/@48.4358314,-123.375177,17z/data=!3m1!4b1!4m5!3m4!1s0x548f737db485e64f:0x2d281917422952de!8m2!3d48.4358314!4d-123.372983?hl=en has never been seen before, processing it.
2025-06-18 16:51:03 [root] INFO: parse: Skipping blacklisted URL https://support.google.com/maps/?hl=en&authuser=0&p=no_javascript.
2025-06-18 16:51:03 [root] INFO: write_url_to_db(): appended URL 'https://www.jpost.com/premium'
2025-06-18 16:51:03 [root] INFO: def parse(): URL https://www.jpost.com/premium marked as irrelevant (no keywords).
2025-06-18 16:51:03 [root] INFO: def parse(): Found 10 links on https://www.jpost.com/premium
2025-06-18 16:51:03 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/thejerusalem_post/'
2025-06-18 16:51:03 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/thejerusalem_post/
2025-06-18 16:51:03 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/TheJerusalemPost'
2025-06-18 16:51:03 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/TheJerusalemPost
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://www.jpost.com/premium has never been seen before, processing it.
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://store.jpost.com/ has never been seen before, processing it.
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://x.com/Jerusalem_Post has never been seen before, processing it.
2025-06-18 16:51:03 [root] INFO: parse: Skipping blacklisted URL https://www.linkedin.com/company/jerusalem-post/.
2025-06-18 16:51:03 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/channel/UCLLLdCANnMAdMyrXdYbSlxg.
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://t.me/The_Jerusalem_Post has never been seen before, processing it.
2025-06-18 16:51:03 [root] INFO: parse: Skipping blacklisted URL https://realestate.jpost.com/.
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://payments.jpost.com/paywall/paywallpersonaldetails has never been seen before, processing it.
2025-06-18 16:51:03 [root] INFO: write_url_to_db(): appended URL 'https://www.jpost.com'
2025-06-18 16:51:03 [root] INFO: def parse(): URL https://www.jpost.com marked as irrelevant (no keywords).
2025-06-18 16:51:03 [root] INFO: def parse(): Found 10 links on https://www.jpost.com
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://store.jpost.com/ has never been seen before, processing it.
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://www.jpost.com/aliyah has never been seen before, processing it.
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://www.jpost.com/aliyah has never been seen before, processing it.
2025-06-18 16:51:03 [root] INFO: write_url_to_db(): appended URL 'https://www.jpost.com/aliyah'
2025-06-18 16:51:03 [root] INFO: def parse(): Crawling next URL: https://www.jpost.com/aliyah
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://craftresumes.co/ has never been seen before, processing it.
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://craftresumes.co/ has never been seen before, processing it.
2025-06-18 16:51:03 [root] INFO: write_url_to_db(): appended URL 'https://craftresumes.co/'
2025-06-18 16:51:03 [root] INFO: def parse(): Crawling next URL: https://craftresumes.co/
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://www.jpost.com has never been seen before, processing it.
2025-06-18 16:51:03 [root] INFO: parse: Skipping blacklisted URL https://realestate.jpost.com/.
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://payments.jpost.com/paywall/paywallpersonaldetails has never been seen before, processing it.
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://www.jpost.com/mdaheroes has never been seen before, processing it.
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://www.jpost.com/mdaheroes has never been seen before, processing it.
2025-06-18 16:51:03 [root] INFO: write_url_to_db(): appended URL 'https://www.jpost.com/mdaheroes'
2025-06-18 16:51:03 [root] INFO: def parse(): Crawling next URL: https://www.jpost.com/mdaheroes
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://www.dhgate.com/ has never been seen before, processing it.
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://www.dhgate.com/ has never been seen before, processing it.
2025-06-18 16:51:03 [root] INFO: write_url_to_db(): appended URL 'https://www.dhgate.com/'
2025-06-18 16:51:03 [root] INFO: def parse(): Crawling next URL: https://www.dhgate.com/
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://www.jpost.com/tags/ono-conversation-corner has never been seen before, processing it.
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://www.jpost.com/tags/ono-conversation-corner has never been seen before, processing it.
2025-06-18 16:51:03 [root] INFO: write_url_to_db(): appended URL 'https://www.jpost.com/tags/ono-conversation-corner'
2025-06-18 16:51:03 [root] INFO: def parse(): Crawling next URL: https://www.jpost.com/tags/ono-conversation-corner
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/2/4 has never been seen before, processing it.
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/2/4 has never been seen before, processing it.
2025-06-18 16:51:03 [root] INFO: write_url_to_db(): appended URL 'https://payments.jpost.com/jpmagazine/product/2/4'
2025-06-18 16:51:03 [root] INFO: def parse(): Crawling next URL: https://payments.jpost.com/jpmagazine/product/2/4
2025-06-18 16:51:03 [scrapy.extensions.logstats] INFO: Crawled 321 pages (at 20 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/6/2 has never been seen before, processing it.
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/6/2 has never been seen before, processing it.
2025-06-18 16:51:03 [root] INFO: write_url_to_db(): appended URL 'https://payments.jpost.com/jpmagazine/product/6/2'
2025-06-18 16:51:03 [root] INFO: def parse(): Crawling next URL: https://payments.jpost.com/jpmagazine/product/6/2
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://payments.jpost.com/miami-leaders-summit has never been seen before, processing it.
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://payments.jpost.com/miami-leaders-summit has never been seen before, processing it.
2025-06-18 16:51:03 [root] INFO: write_url_to_db(): appended URL 'https://payments.jpost.com/miami-leaders-summit'
2025-06-18 16:51:03 [root] INFO: def parse(): Crawling next URL: https://payments.jpost.com/miami-leaders-summit
2025-06-18 16:51:03 [root] INFO: write_url_to_db(): appended URL 'https://smithersmusicfest.com/volunteer/'
2025-06-18 16:51:03 [root] INFO: def parse(): URL https://smithersmusicfest.com/volunteer/ marked as irrelevant (no keywords).
2025-06-18 16:51:03 [root] INFO: def parse(): Found 10 links on https://smithersmusicfest.com/volunteer/
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://smithersmusicfest.com/about/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://smithersmusicfest.com/about/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:51:03 [root] INFO: write_url_to_db(): appended URL 'https://smithersmusicfest.com/about/'
2025-06-18 16:51:03 [root] INFO: def parse(): Crawling next URL: https://smithersmusicfest.com/about/
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://smithersmusicfest.com/merchandise/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://smithersmusicfest.com/merchandise/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:51:03 [root] INFO: write_url_to_db(): appended URL 'https://smithersmusicfest.com/merchandise/'
2025-06-18 16:51:03 [root] INFO: def parse(): Crawling next URL: https://smithersmusicfest.com/merchandise/
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://smithersmusicfest.com/camping-and-grounds/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://smithersmusicfest.com/camping-and-grounds/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:51:03 [root] INFO: write_url_to_db(): appended URL 'https://smithersmusicfest.com/camping-and-grounds/'
2025-06-18 16:51:03 [root] INFO: def parse(): Crawling next URL: https://smithersmusicfest.com/camping-and-grounds/
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://smithersmusicfest.com/2025-lineup/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://smithersmusicfest.com/2025-lineup/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:51:03 [root] INFO: write_url_to_db(): appended URL 'https://smithersmusicfest.com/2025-lineup/'
2025-06-18 16:51:03 [root] INFO: def parse(): Crawling next URL: https://smithersmusicfest.com/2025-lineup/
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://smithersmusicfest.com/admission/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://smithersmusicfest.com/admission/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:51:03 [root] INFO: write_url_to_db(): appended URL 'https://smithersmusicfest.com/admission/'
2025-06-18 16:51:03 [root] INFO: def parse(): Crawling next URL: https://smithersmusicfest.com/admission/
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://smithersmusicfest.com/volunteer/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://smithersmusicfest.com/performer-application/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://smithersmusicfest.com/performer-application/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:51:03 [root] INFO: write_url_to_db(): appended URL 'https://smithersmusicfest.com/performer-application/'
2025-06-18 16:51:03 [root] INFO: def parse(): Crawling next URL: https://smithersmusicfest.com/performer-application/
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://smithersmusicfest.com/tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://smithersmusicfest.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://www.tickettailor.com/events/bulkleyvalleyfolkmusicsociety/1670109 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://www.tickettailor.com/events/bulkleyvalleyfolkmusicsociety/1670109 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:51:03 [root] INFO: write_url_to_db(): appended URL 'https://www.tickettailor.com/events/bulkleyvalleyfolkmusicsociety/1670109'
2025-06-18 16:51:03 [root] INFO: def parse(): Crawling next URL: https://www.tickettailor.com/events/bulkleyvalleyfolkmusicsociety/1670109
2025-06-18 16:51:03 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <406 https://alivetangovictoria.ca/studio/>: HTTP status code is not handled or not allowed
2025-06-18 16:51:03 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <406 https://calientedance.com/teams/>: HTTP status code is not handled or not allowed
2025-06-18 16:51:03 [root] INFO: write_url_to_db(): appended URL 'http://www.cryoutcreations.eu'
2025-06-18 16:51:03 [root] INFO: def parse(): URL http://www.cryoutcreations.eu marked as irrelevant (no keywords).
2025-06-18 16:51:03 [root] INFO: def parse(): Found 10 links on https://www.cryoutcreations.eu/
2025-06-18 16:51:03 [root] INFO: parse: Skipping blacklisted URL https://www.cryoutcreations.eu/wordpress-themes/fluida.
2025-06-18 16:51:03 [root] INFO: parse: Skipping blacklisted URL https://www.cryoutcreations.eu/wordpress-themes/roseta.
2025-06-18 16:51:03 [root] INFO: should_process_url: URL http://www.cryoutcreations.eu was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 16:51:03 [root] INFO: parse: Skipping blacklisted URL https://www.cryoutcreations.eu/wordpress-themes/septera.
2025-06-18 16:51:03 [root] INFO: parse: Skipping blacklisted URL https://www.cryoutcreations.eu/wordpress-themes/kahuna.
2025-06-18 16:51:03 [root] INFO: parse: Skipping blacklisted URL https://www.cryoutcreations.eu/wordpress-themes/bravada.
2025-06-18 16:51:03 [root] INFO: parse: Skipping blacklisted URL https://www.cryoutcreations.eu/wordpress-themes/anima.
2025-06-18 16:51:03 [root] INFO: parse: Skipping blacklisted URL https://www.cryoutcreations.eu/wordpress-themes/esotera.
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://www.cryoutcreations.eu/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:51:03 [root] INFO: should_process_url: URL https://www.cryoutcreations.eu/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:51:03 [root] INFO: write_url_to_db(): appended URL 'https://www.cryoutcreations.eu/'
2025-06-18 16:51:03 [root] INFO: def parse(): Crawling next URL: https://www.cryoutcreations.eu/
2025-06-18 16:51:04 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <400 https://r.bttn.io?btn_ref=org-4250020ab4443b4b&btn_reach_pub=1011l45458&btn_reach_pub_name=stay22&btn_mobile_url=https%3A%2F%2Fwww.expedia.ca%2F%3Fclickref%3D1110l9u3WWw%26affcid%3DCA.DIRECT.PHG.1011l45458.0%26ref_id%3D1110l9u3WWw%26my_ad%3DAFF.CA.DIRECT.PHG.1011l45458.0%26afflid%3D1110l9u3WWw%26affdtl%3DPHG.1110l9u3WWw.&btn_network_ref=1110l9u3WWw&btn_url=https%3A%2F%2Fwww.expedia.ca%2F%3Fclickref%3D1110l9u3WWw%26affcid%3DCA.DIRECT.PHG.1011l45458.0%26ref_id%3D1110l9u3WWw%26my_ad%3DAFF.CA.DIRECT.PHG.1011l45458.0%26afflid%3D1110l9u3WWw%26affdtl%3DPHG.1110l9u3WWw.&original_destination=https://www.expedia.ca/?clickref=1110l9u3WWw&affcid=CA.DIRECT.PHG.1011l45458.0&ref_id=1110l9u3WWw&my_ad=AFF.CA.DIRECT.PHG.1011l45458.0&afflid=1110l9u3WWw&affdtl=PHG.1110l9u3WWw.>: HTTP status code is not handled or not allowed
2025-06-18 16:51:04 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <400 https://r.bttn.io?btn_ref=org-4250020ab4443b4b&btn_reach_pub=1011l45458&btn_reach_pub_name=stay22&btn_mobile_url=https%3A%2F%2Fwww.hotels.com%2F%3F%26endDate%3D%26startDate%3D%26clickref%3D1101lBrEmNBR%26rffrid%3Daff.hcom.US.038.000.1011l45458.kwrd%3D1101lBrEmNBR%26affcid%3DHCOM-US.DIRECT.PHG.1011l45458%26afflid%3D1101lBrEmNBR%26affdtl%3DPHG.1101lBrEmNBR.%26affdtl%3DPHG.1101lBrEmNBR.&btn_network_ref=1101lBrEmNBR&btn_url=https%3A%2F%2Fwww.hotels.com%2F%3F%26endDate%3D%26startDate%3D%26clickref%3D1101lBrEmNBR%26rffrid%3Daff.hcom.US.038.000.1011l45458.kwrd%3D1101lBrEmNBR%26affcid%3DHCOM-US.DIRECT.PHG.1011l45458%26afflid%3D1101lBrEmNBR%26affdtl%3DPHG.1101lBrEmNBR.%26affdtl%3DPHG.1101lBrEmNBR.&original_destination=https://www.hotels.com/?&endDate=&startDate=&clickref=1101lBrEmNBR&rffrid=aff.hcom.US.038.000.1011l45458.kwrd=1101lBrEmNBR&affcid=HCOM-US.DIRECT.PHG.1011l45458&afflid=1101lBrEmNBR&affdtl=PHG.1101lBrEmNBR.&affdtl=PHG.1101lBrEmNBR.>: HTTP status code is not handled or not allowed
2025-06-18 16:51:04 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <400 https://r.bttn.io?btn_ref=org-4250020ab4443b4b&btn_reach_pub=1011l45458&btn_reach_pub_name=stay22&btn_mobile_url=https%3A%2F%2Fwww.expedia.ca%2F%3Fclickref%3D1011lBmY2uDP%26affcid%3DCA.DIRECT.PHG.1011l45458.0%26ref_id%3D1011lBmY2uDP%26my_ad%3DAFF.CA.DIRECT.PHG.1011l45458.0%26afflid%3D1011lBmY2uDP%26affdtl%3DPHG.1011lBmY2uDP.&btn_network_ref=1011lBmY2uDP&btn_url=https%3A%2F%2Fwww.expedia.ca%2F%3Fclickref%3D1011lBmY2uDP%26affcid%3DCA.DIRECT.PHG.1011l45458.0%26ref_id%3D1011lBmY2uDP%26my_ad%3DAFF.CA.DIRECT.PHG.1011l45458.0%26afflid%3D1011lBmY2uDP%26affdtl%3DPHG.1011lBmY2uDP.&original_destination=https://www.expedia.ca/?clickref=1011lBmY2uDP&affcid=CA.DIRECT.PHG.1011l45458.0&ref_id=1011lBmY2uDP&my_ad=AFF.CA.DIRECT.PHG.1011l45458.0&afflid=1011lBmY2uDP&affdtl=PHG.1011lBmY2uDP.>: HTTP status code is not handled or not allowed
2025-06-18 16:51:04 [root] INFO: write_url_to_db(): appended URL 'https://payments.jpost.com/jpmagazine/product/3/1'
2025-06-18 16:51:04 [root] INFO: def parse(): URL https://payments.jpost.com/jpmagazine/product/3/1 marked as irrelevant (no keywords).
2025-06-18 16:51:04 [root] INFO: def parse(): Found 10 links on https://payments.jpost.com/jpmagazine/product/3/1
2025-06-18 16:51:04 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/4/1 has never been seen before, processing it.
2025-06-18 16:51:04 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/15/4 has never been seen before, processing it.
2025-06-18 16:51:04 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/7/2 has never been seen before, processing it.
2025-06-18 16:51:04 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine has never been seen before, processing it.
2025-06-18 16:51:04 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/3/1 has never been seen before, processing it.
2025-06-18 16:51:04 [root] INFO: should_process_url: URL https://payments.jpost.com/conference/tickettypes has never been seen before, processing it.
2025-06-18 16:51:04 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/12/1 has never been seen before, processing it.
2025-06-18 16:51:04 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/2/4 has never been seen before, processing it.
2025-06-18 16:51:04 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/6/2 has never been seen before, processing it.
2025-06-18 16:51:04 [root] INFO: should_process_url: URL https://payments.jpost.com/miami-leaders-summit has never been seen before, processing it.
2025-06-18 16:51:04 [root] INFO: def parse(): Found keywords for URL https://creativebc.com/bc-film-commission/library-production-services/code-of-conduct/: ['live music']
2025-06-18 16:51:04 [root] INFO: def generate_prompt(): Generating prompt for URL: https://creativebc.com/bc-film-commission/library-production-services/code-of-conduct/
2025-06-18 16:51:04 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:51:04 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:51:04 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:51:07 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:51:07 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 514086 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 16:51:07 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:51:09 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:51:09 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 364422 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 16:51:09 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 16:51:09 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://creativebc.com/bc-film-commission/library-production-services/code-of-conduct/
2025-06-18 16:51:09 [root] INFO: write_url_to_db(): appended URL 'https://creativebc.com/bc-film-commission/library-production-services/code-of-conduct/'
2025-06-18 16:51:09 [root] INFO: def parse(): URL https://creativebc.com/bc-film-commission/library-production-services/code-of-conduct/ marked as irrelevant (LLM negative).
2025-06-18 16:51:09 [root] INFO: def parse(): Found 10 links on https://creativebc.com/bc-film-commission/library-production-services/code-of-conduct/
2025-06-18 16:51:09 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-M58QS7V, URL: https://creativebc.com/bc-film-commission/library-production-services/code-of-conduct/, source: Rifflandia Festival, keywords: music festivals
2025-06-18 16:51:09 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 16:51:09 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-M58QS7V
2025-06-18 16:51:09 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-M58QS7V'
2025-06-18 16:51:09 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/register-a-production/ has never been seen before, processing it.
2025-06-18 16:51:09 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/consults-packages-surveys/ has never been seen before, processing it.
2025-06-18 16:51:09 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/in-production/ has never been seen before, processing it.
2025-06-18 16:51:09 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/ has never been seen before, processing it.
2025-06-18 16:51:09 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/code-of-conduct/ has never been seen before, processing it.
2025-06-18 16:51:09 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/cross-border-services/ has never been seen before, processing it.
2025-06-18 16:51:09 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/greater-vancouver/ has never been seen before, processing it.
2025-06-18 16:51:09 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/ has never been seen before, processing it.
2025-06-18 16:51:09 [root] INFO: should_process_url: URL https://creativebc.com/ has never been seen before, processing it.
2025-06-18 16:51:09 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/production-credits/ has never been seen before, processing it.
2025-06-18 16:51:09 [root] INFO: def parse(): Found keywords for URL https://creativebc.com/bc-film-commission/production-credits/: ['live music']
2025-06-18 16:51:09 [root] INFO: def generate_prompt(): Generating prompt for URL: https://creativebc.com/bc-film-commission/production-credits/
2025-06-18 16:51:09 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:51:09 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:51:09 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:51:12 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:51:12 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 473252 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 16:51:12 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:51:13 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:51:13 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 334948 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 16:51:13 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 16:51:13 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://creativebc.com/bc-film-commission/production-credits/
2025-06-18 16:51:13 [root] INFO: write_url_to_db(): appended URL 'https://creativebc.com/bc-film-commission/production-credits/'
2025-06-18 16:51:13 [root] INFO: def parse(): URL https://creativebc.com/bc-film-commission/production-credits/ marked as irrelevant (LLM negative).
2025-06-18 16:51:13 [root] INFO: def parse(): Found 10 links on https://creativebc.com/bc-film-commission/production-credits/
2025-06-18 16:51:13 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://creativebc.my.salesforce-sites.com/productioncredits, URL: https://creativebc.com/bc-film-commission/production-credits/, source: Rifflandia Festival, keywords: music festivals
2025-06-18 16:51:13 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: r+mɲ^+q"o鮇nrبv+l
2025-06-18 16:51:13 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://creativebc.my.salesforce-sites.com/productioncredits
2025-06-18 16:51:13 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-M58QS7V, URL: https://creativebc.com/bc-film-commission/production-credits/, source: Rifflandia Festival, keywords: music festivals
2025-06-18 16:51:13 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 16:51:13 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-M58QS7V
2025-06-18 16:51:13 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-M58QS7V'
2025-06-18 16:51:13 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/production-credits/ has never been seen before, processing it.
2025-06-18 16:51:13 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/register-a-production/ has never been seen before, processing it.
2025-06-18 16:51:13 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/consults-packages-surveys/ has never been seen before, processing it.
2025-06-18 16:51:13 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/in-production/ has never been seen before, processing it.
2025-06-18 16:51:13 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/ has never been seen before, processing it.
2025-06-18 16:51:13 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/code-of-conduct/ has never been seen before, processing it.
2025-06-18 16:51:13 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/cross-border-services/ has never been seen before, processing it.
2025-06-18 16:51:13 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/greater-vancouver/ has never been seen before, processing it.
2025-06-18 16:51:13 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/ has never been seen before, processing it.
2025-06-18 16:51:13 [root] INFO: should_process_url: URL https://creativebc.com/ has never been seen before, processing it.
2025-06-18 16:51:14 [root] INFO: def parse(): Found keywords for URL https://creativebc.com/bc-film-commission/library-production-services/: ['live music']
2025-06-18 16:51:14 [root] INFO: def generate_prompt(): Generating prompt for URL: https://creativebc.com/bc-film-commission/library-production-services/
2025-06-18 16:51:14 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:51:14 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:51:14 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:51:18 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:51:18 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 790459 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 16:51:18 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:51:20 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:51:20 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 553976 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 16:51:20 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 16:51:20 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://creativebc.com/bc-film-commission/library-production-services/
2025-06-18 16:51:20 [root] INFO: write_url_to_db(): appended URL 'https://creativebc.com/bc-film-commission/library-production-services/'
2025-06-18 16:51:20 [root] INFO: def parse(): URL https://creativebc.com/bc-film-commission/library-production-services/ marked as irrelevant (LLM negative).
2025-06-18 16:51:20 [root] INFO: def parse(): Found 10 links on https://creativebc.com/bc-film-commission/library-production-services/
2025-06-18 16:51:20 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-M58QS7V, URL: https://creativebc.com/bc-film-commission/library-production-services/, source: Rifflandia Festival, keywords: music festivals
2025-06-18 16:51:20 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 16:51:20 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-M58QS7V
2025-06-18 16:51:20 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-M58QS7V'
2025-06-18 16:51:20 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/register-a-production/ has never been seen before, processing it.
2025-06-18 16:51:20 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/consults-packages-surveys/ has never been seen before, processing it.
2025-06-18 16:51:20 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/in-production/ has never been seen before, processing it.
2025-06-18 16:51:20 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/ has never been seen before, processing it.
2025-06-18 16:51:20 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/code-of-conduct/ has never been seen before, processing it.
2025-06-18 16:51:20 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/cross-border-services/ has never been seen before, processing it.
2025-06-18 16:51:20 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/greater-vancouver/ has never been seen before, processing it.
2025-06-18 16:51:20 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/ has never been seen before, processing it.
2025-06-18 16:51:20 [root] INFO: should_process_url: URL https://creativebc.com/ has never been seen before, processing it.
2025-06-18 16:51:20 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/production-credits/ has never been seen before, processing it.
2025-06-18 16:51:20 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.vrbo.com/?&clickref=1110l9u3WNG&CID=a_ph_6&utm_source=aff_ph&utm_medium=partner&utm_campaign=stay22_1101l252&utm_content=0&k_clickid=1110l9u3WNG&affcid=VRBO-US.DIRECT.PHG.1011l45458&affdtl=PHG.1110l9u3WNG.> (failed 3 times): 429 Unknown Status
2025-06-18 16:51:21 [root] INFO: def parse(): Found keywords for URL https://creativebc.com/bc-film-commission/library-production-services/greater-vancouver/: ['dance', 'live music']
2025-06-18 16:51:21 [root] INFO: def generate_prompt(): Generating prompt for URL: https://creativebc.com/bc-film-commission/library-production-services/greater-vancouver/
2025-06-18 16:51:21 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:51:21 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:51:21 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:51:29 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:51:29 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 2192099 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 16:51:29 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:51:36 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:51:36 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 1446810 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 16:51:36 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 16:51:36 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://creativebc.com/bc-film-commission/library-production-services/greater-vancouver/
2025-06-18 16:51:36 [root] INFO: write_url_to_db(): appended URL 'https://creativebc.com/bc-film-commission/library-production-services/greater-vancouver/'
2025-06-18 16:51:36 [root] INFO: def parse(): URL https://creativebc.com/bc-film-commission/library-production-services/greater-vancouver/ marked as irrelevant (LLM negative).
2025-06-18 16:51:36 [root] INFO: def parse(): Found 10 links on https://creativebc.com/bc-film-commission/library-production-services/greater-vancouver/
2025-06-18 16:51:36 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-M58QS7V, URL: https://creativebc.com/bc-film-commission/library-production-services/greater-vancouver/, source: Rifflandia Festival, keywords: music festivals
2025-06-18 16:51:36 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 16:51:36 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-M58QS7V
2025-06-18 16:51:36 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-M58QS7V'
2025-06-18 16:51:36 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/register-a-production/ has never been seen before, processing it.
2025-06-18 16:51:36 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/consults-packages-surveys/ has never been seen before, processing it.
2025-06-18 16:51:36 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/in-production/ has never been seen before, processing it.
2025-06-18 16:51:36 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/ has never been seen before, processing it.
2025-06-18 16:51:36 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/greater-vancouver/ has never been seen before, processing it.
2025-06-18 16:51:36 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/cross-border-services/ has never been seen before, processing it.
2025-06-18 16:51:36 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/code-of-conduct/ has never been seen before, processing it.
2025-06-18 16:51:36 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/ has never been seen before, processing it.
2025-06-18 16:51:36 [root] INFO: should_process_url: URL https://creativebc.com/ has never been seen before, processing it.
2025-06-18 16:51:36 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/production-credits/ has never been seen before, processing it.
2025-06-18 16:51:36 [root] INFO: def parse(): Found keywords for URL https://creativebc.com/bc-film-commission/library-production-services/cross-border-services/: ['dance', 'live music']
2025-06-18 16:51:36 [root] INFO: def generate_prompt(): Generating prompt for URL: https://creativebc.com/bc-film-commission/library-production-services/cross-border-services/
2025-06-18 16:51:36 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:51:36 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:51:36 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:51:39 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:51:39 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 467486 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 16:51:39 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:51:40 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:51:40 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 331118 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 16:51:40 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 16:51:40 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://creativebc.com/bc-film-commission/library-production-services/cross-border-services/
2025-06-18 16:51:40 [root] INFO: write_url_to_db(): appended URL 'https://creativebc.com/bc-film-commission/library-production-services/cross-border-services/'
2025-06-18 16:51:40 [root] INFO: def parse(): URL https://creativebc.com/bc-film-commission/library-production-services/cross-border-services/ marked as irrelevant (LLM negative).
2025-06-18 16:51:40 [root] INFO: def parse(): Found 10 links on https://creativebc.com/bc-film-commission/library-production-services/cross-border-services/
2025-06-18 16:51:40 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-M58QS7V, URL: https://creativebc.com/bc-film-commission/library-production-services/cross-border-services/, source: Rifflandia Festival, keywords: music festivals
2025-06-18 16:51:40 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 16:51:40 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-M58QS7V
2025-06-18 16:51:40 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-M58QS7V'
2025-06-18 16:51:40 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/register-a-production/ has never been seen before, processing it.
2025-06-18 16:51:40 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/consults-packages-surveys/ has never been seen before, processing it.
2025-06-18 16:51:40 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/in-production/ has never been seen before, processing it.
2025-06-18 16:51:40 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/ has never been seen before, processing it.
2025-06-18 16:51:40 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/code-of-conduct/ has never been seen before, processing it.
2025-06-18 16:51:40 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/cross-border-services/ has never been seen before, processing it.
2025-06-18 16:51:40 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/greater-vancouver/ has never been seen before, processing it.
2025-06-18 16:51:40 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/ has never been seen before, processing it.
2025-06-18 16:51:40 [root] INFO: should_process_url: URL https://creativebc.com/ has never been seen before, processing it.
2025-06-18 16:51:40 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/production-credits/ has never been seen before, processing it.
2025-06-18 16:51:40 [root] INFO: write_url_to_db(): appended URL 'https://payments.jpost.com/jpmagazine/product/6/2'
2025-06-18 16:51:40 [root] INFO: def parse(): URL https://payments.jpost.com/jpmagazine/product/6/2 marked as irrelevant (no keywords).
2025-06-18 16:51:40 [root] INFO: def parse(): Found 10 links on https://payments.jpost.com/jpmagazine/product/6/2
2025-06-18 16:51:40 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/4/1 has never been seen before, processing it.
2025-06-18 16:51:40 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/15/4 has never been seen before, processing it.
2025-06-18 16:51:40 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/7/2 has never been seen before, processing it.
2025-06-18 16:51:40 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/3/1 has never been seen before, processing it.
2025-06-18 16:51:40 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine has never been seen before, processing it.
2025-06-18 16:51:40 [root] INFO: should_process_url: URL https://payments.jpost.com/conference/tickettypes has never been seen before, processing it.
2025-06-18 16:51:40 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/12/1 has never been seen before, processing it.
2025-06-18 16:51:40 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/2/4 has never been seen before, processing it.
2025-06-18 16:51:40 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/6/2 has never been seen before, processing it.
2025-06-18 16:51:40 [root] INFO: should_process_url: URL https://payments.jpost.com/miami-leaders-summit has never been seen before, processing it.
2025-06-18 16:51:41 [root] INFO: def parse(): Found keywords for URL https://creativebc.com/bc-film-commission/in-production/: ['live music']
2025-06-18 16:51:41 [root] INFO: def generate_prompt(): Generating prompt for URL: https://creativebc.com/bc-film-commission/in-production/
2025-06-18 16:51:41 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:51:41 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:51:41 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:51:43 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:51:43 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 623411 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 16:51:43 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:51:45 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:51:45 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 440069 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 16:51:45 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 16:51:45 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://creativebc.com/bc-film-commission/in-production/
2025-06-18 16:51:45 [root] INFO: write_url_to_db(): appended URL 'https://creativebc.com/bc-film-commission/in-production/'
2025-06-18 16:51:45 [root] INFO: def parse(): URL https://creativebc.com/bc-film-commission/in-production/ marked as irrelevant (LLM negative).
2025-06-18 16:51:45 [root] INFO: def parse(): Found 10 links on https://creativebc.com/bc-film-commission/in-production/
2025-06-18 16:51:45 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://industrycontacts.secure.force.com/inproduction/?foo=bar, URL: https://creativebc.com/bc-film-commission/in-production/, source: Rifflandia Festival, keywords: music festivals
2025-06-18 16:51:45 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: wnril.ǜo➚v-~
2025-06-18 16:51:45 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://industrycontacts.secure.force.com/inproduction/?foo=bar
2025-06-18 16:51:45 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-M58QS7V, URL: https://creativebc.com/bc-film-commission/in-production/, source: Rifflandia Festival, keywords: music festivals
2025-06-18 16:51:45 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 16:51:45 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-M58QS7V
2025-06-18 16:51:45 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-M58QS7V'
2025-06-18 16:51:45 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/register-a-production/ has never been seen before, processing it.
2025-06-18 16:51:45 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/consults-packages-surveys/ has never been seen before, processing it.
2025-06-18 16:51:45 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/in-production/ has never been seen before, processing it.
2025-06-18 16:51:45 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/ has never been seen before, processing it.
2025-06-18 16:51:45 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/code-of-conduct/ has never been seen before, processing it.
2025-06-18 16:51:45 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/cross-border-services/ has never been seen before, processing it.
2025-06-18 16:51:45 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/greater-vancouver/ has never been seen before, processing it.
2025-06-18 16:51:45 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/ has never been seen before, processing it.
2025-06-18 16:51:45 [root] INFO: should_process_url: URL https://creativebc.com/ has never been seen before, processing it.
2025-06-18 16:51:45 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/production-credits/ has never been seen before, processing it.
2025-06-18 16:51:46 [root] INFO: def parse(): Found keywords for URL https://creativebc.com/bc-film-commission/library-production-services/consults-packages-surveys/: ['live music']
2025-06-18 16:51:46 [root] INFO: def generate_prompt(): Generating prompt for URL: https://creativebc.com/bc-film-commission/library-production-services/consults-packages-surveys/
2025-06-18 16:51:46 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:51:46 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:51:46 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:51:48 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:51:48 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 701052 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 16:51:48 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:51:53 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:51:53 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 493085 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 16:51:53 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 16:51:53 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://creativebc.com/bc-film-commission/library-production-services/consults-packages-surveys/
2025-06-18 16:51:53 [root] INFO: write_url_to_db(): appended URL 'https://creativebc.com/bc-film-commission/library-production-services/consults-packages-surveys/'
2025-06-18 16:51:53 [root] INFO: def parse(): URL https://creativebc.com/bc-film-commission/library-production-services/consults-packages-surveys/ marked as irrelevant (LLM negative).
2025-06-18 16:51:53 [root] INFO: def parse(): Found 10 links on https://creativebc.com/bc-film-commission/library-production-services/consults-packages-surveys/
2025-06-18 16:51:53 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-M58QS7V, URL: https://creativebc.com/bc-film-commission/library-production-services/consults-packages-surveys/, source: Rifflandia Festival, keywords: music festivals
2025-06-18 16:51:53 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 16:51:53 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-M58QS7V
2025-06-18 16:51:53 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-M58QS7V'
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/register-a-production/ has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/consults-packages-surveys/ has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/in-production/ has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/ has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/code-of-conduct/ has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/cross-border-services/ has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/greater-vancouver/ has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/ has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://creativebc.com/ has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/production-credits/ has never been seen before, processing it.
2025-06-18 16:51:53 [scrapy.extensions.logstats] INFO: Crawled 344 pages (at 23 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 16:51:53 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <429 https://www.vrbo.com/?&clickref=1110l9u3WNG&CID=a_ph_6&utm_source=aff_ph&utm_medium=partner&utm_campaign=stay22_1101l252&utm_content=0&k_clickid=1110l9u3WNG&affcid=VRBO-US.DIRECT.PHG.1011l45458&affdtl=PHG.1110l9u3WNG.>: HTTP status code is not handled or not allowed
2025-06-18 16:51:53 [root] INFO: write_url_to_db(): appended URL 'https://payments.jpost.com/jpmagazine/product/2/4'
2025-06-18 16:51:53 [root] INFO: def parse(): URL https://payments.jpost.com/jpmagazine/product/2/4 marked as irrelevant (no keywords).
2025-06-18 16:51:53 [root] INFO: def parse(): Found 10 links on https://payments.jpost.com/jpmagazine/product/2/4
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/4/1 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/15/4 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/7/2 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/3/1 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/conference/tickettypes has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/12/1 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/2/4 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/6/2 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/miami-leaders-summit has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: write_url_to_db(): appended URL 'https://payments.jpost.com/conference/tickettypes'
2025-06-18 16:51:53 [root] INFO: def parse(): URL https://payments.jpost.com/conference/tickettypes marked as irrelevant (no keywords).
2025-06-18 16:51:53 [root] INFO: def parse(): Found 0 links on https://payments.jpost.com/conference/tickettypes
2025-06-18 16:51:53 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-T4BJGTM, URL: https://payments.jpost.com/conference/tickettypes, source: Jewish nomad woman | The Jerusalem Post, keywords: argentine tango
2025-06-18 16:51:53 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 16:51:53 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-T4BJGTM
2025-06-18 16:51:53 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-T4BJGTM'
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/conference/tickettypes has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: write_url_to_db(): appended URL 'https://payments.jpost.com/miami-leaders-summit'
2025-06-18 16:51:53 [root] INFO: def parse(): URL https://payments.jpost.com/miami-leaders-summit marked as irrelevant (no keywords).
2025-06-18 16:51:53 [root] INFO: def parse(): Found 0 links on https://payments.jpost.com/miami-leaders-summit
2025-06-18 16:51:53 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-T4BJGTM, URL: https://payments.jpost.com/miami-leaders-summit, source: Jewish nomad woman | The Jerusalem Post, keywords: argentine tango
2025-06-18 16:51:53 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 16:51:53 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-T4BJGTM
2025-06-18 16:51:53 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-T4BJGTM'
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/miami-leaders-summit has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: write_url_to_db(): appended URL 'https://payments.jpost.com/jpmagazine/product/15/4'
2025-06-18 16:51:53 [root] INFO: def parse(): URL https://payments.jpost.com/jpmagazine/product/15/4 marked as irrelevant (no keywords).
2025-06-18 16:51:53 [root] INFO: def parse(): Found 10 links on https://payments.jpost.com/jpmagazine/product/15/4
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/4/1 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/15/4 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/7/2 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/3/1 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/conference/tickettypes has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/12/1 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/2/4 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/6/2 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/miami-leaders-summit has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: write_url_to_db(): appended URL 'https://payments.jpost.com/jpmagazine/product/12/1'
2025-06-18 16:51:53 [root] INFO: def parse(): URL https://payments.jpost.com/jpmagazine/product/12/1 marked as irrelevant (no keywords).
2025-06-18 16:51:53 [root] INFO: def parse(): Found 10 links on https://payments.jpost.com/jpmagazine/product/12/1
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/4/1 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/15/4 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/7/2 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/3/1 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/conference/tickettypes has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/12/1 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/2/4 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/6/2 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/miami-leaders-summit has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: write_url_to_db(): appended URL 'https://payments.jpost.com/jpmagazine/product/4/1'
2025-06-18 16:51:53 [root] INFO: def parse(): URL https://payments.jpost.com/jpmagazine/product/4/1 marked as irrelevant (no keywords).
2025-06-18 16:51:53 [root] INFO: def parse(): Found 10 links on https://payments.jpost.com/jpmagazine/product/4/1
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/4/1 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/15/4 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/7/2 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/3/1 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/conference/tickettypes has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/12/1 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/2/4 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/6/2 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/miami-leaders-summit has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: write_url_to_db(): appended URL 'https://payments.jpost.com/jpmagazine/product/7/2'
2025-06-18 16:51:53 [root] INFO: def parse(): URL https://payments.jpost.com/jpmagazine/product/7/2 marked as irrelevant (no keywords).
2025-06-18 16:51:53 [root] INFO: def parse(): Found 10 links on https://payments.jpost.com/jpmagazine/product/7/2
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/4/1 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/15/4 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/7/2 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/3/1 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/conference/tickettypes has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/12/1 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/2/4 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/6/2 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/miami-leaders-summit has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: write_url_to_db(): appended URL 'https://payments.jpost.com/jpmagazine'
2025-06-18 16:51:53 [root] INFO: def parse(): URL https://payments.jpost.com/jpmagazine marked as irrelevant (no keywords).
2025-06-18 16:51:53 [root] INFO: def parse(): Found 10 links on https://payments.jpost.com/jpmagazine
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/4/1 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/15/4 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/7/2 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/3/1 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/conference/tickettypes has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/12/1 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/2/4 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/jpmagazine/product/6/2 has never been seen before, processing it.
2025-06-18 16:51:53 [root] INFO: should_process_url: URL https://payments.jpost.com/miami-leaders-summit has never been seen before, processing it.
2025-06-18 16:51:54 [root] INFO: def parse(): Found keywords for URL https://creativebc.com/bc-film-commission/: ['live music', 'wcs']
2025-06-18 16:51:54 [root] INFO: def generate_prompt(): Generating prompt for URL: https://creativebc.com/bc-film-commission/
2025-06-18 16:51:54 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:51:54 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:51:54 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:51:57 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:51:57 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 663327 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 16:51:57 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:51:59 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:51:59 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 474997 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 16:51:59 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 16:51:59 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://creativebc.com/bc-film-commission/
2025-06-18 16:51:59 [root] INFO: write_url_to_db(): appended URL 'https://creativebc.com/bc-film-commission/'
2025-06-18 16:51:59 [root] INFO: def parse(): URL https://creativebc.com/bc-film-commission/ marked as irrelevant (LLM negative).
2025-06-18 16:51:59 [root] INFO: def parse(): Found 10 links on https://creativebc.com/bc-film-commission/
2025-06-18 16:51:59 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-M58QS7V, URL: https://creativebc.com/bc-film-commission/, source: Rifflandia Festival, keywords: music festivals
2025-06-18 16:51:59 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 16:51:59 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-M58QS7V
2025-06-18 16:51:59 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-M58QS7V'
2025-06-18 16:51:59 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/register-a-production/ has never been seen before, processing it.
2025-06-18 16:51:59 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/consults-packages-surveys/ has never been seen before, processing it.
2025-06-18 16:51:59 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/in-production/ has never been seen before, processing it.
2025-06-18 16:51:59 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/ has never been seen before, processing it.
2025-06-18 16:51:59 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/code-of-conduct/ has never been seen before, processing it.
2025-06-18 16:51:59 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/cross-border-services/ has never been seen before, processing it.
2025-06-18 16:51:59 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/greater-vancouver/ has never been seen before, processing it.
2025-06-18 16:51:59 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/ has never been seen before, processing it.
2025-06-18 16:51:59 [root] INFO: should_process_url: URL https://creativebc.com/ has never been seen before, processing it.
2025-06-18 16:51:59 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/production-credits/ has never been seen before, processing it.
2025-06-18 16:51:59 [root] INFO: def parse(): Found keywords for URL https://www.stay22.com/allez/booking?campaign=closestays-booking-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Fbooking.com: ['dance']
2025-06-18 16:51:59 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.stay22.com/allez/booking?campaign=closestays-booking-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Fbooking.com
2025-06-18 16:51:59 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:51:59 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:51:59 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:52:02 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:52:02 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 368237 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 16:52:02 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:52:04 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:52:04 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 281183 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 16:52:04 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 16:52:04 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://www.stay22.com/allez/booking?campaign=closestays-booking-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Fbooking.com
2025-06-18 16:52:04 [root] INFO: write_url_to_db(): appended URL 'https://www.stay22.com/allez/booking?campaign=closestays-booking-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Fbooking.com'
2025-06-18 16:52:04 [root] INFO: def parse(): URL https://www.stay22.com/allez/booking?campaign=closestays-booking-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Fbooking.com marked as irrelevant (LLM negative).
2025-06-18 16:52:04 [root] INFO: def parse(): Found 10 links on https://www.booking.com/
2025-06-18 16:52:04 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5Q664QZ, URL: https://www.stay22.com/allez/booking?campaign=closestays-booking-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Fbooking.com, source: Zouk Dancing Festivals Worldwide (Updated 2025), keywords: zouk
2025-06-18 16:52:04 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 16:52:04 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5Q664QZ
2025-06-18 16:52:04 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-5Q664QZ'
2025-06-18 16:52:04 [root] INFO: should_process_url: URL https://join.booking.com/?utm_source=topbar has never been seen before, processing it.
2025-06-18 16:52:04 [root] INFO: should_process_url: URL https://join.booking.com/?utm_source=topbar has never been seen before, processing it.
2025-06-18 16:52:04 [root] INFO: write_url_to_db(): appended URL 'https://join.booking.com/?utm_source=topbar'
2025-06-18 16:52:04 [root] INFO: def parse(): Crawling next URL: https://join.booking.com/?utm_source=topbar
2025-06-18 16:52:04 [root] INFO: should_process_url: URL https://www.booking.com/packages.html has never been seen before, processing it.
2025-06-18 16:52:04 [root] INFO: should_process_url: URL https://www.booking.com/packages.html has never been seen before, processing it.
2025-06-18 16:52:04 [root] INFO: write_url_to_db(): appended URL 'https://www.booking.com/packages.html'
2025-06-18 16:52:04 [root] INFO: def parse(): Crawling next URL: https://www.booking.com/packages.html
2025-06-18 16:52:04 [root] INFO: should_process_url: URL https://www.stay22.com/allez/booking?campaign=closestays-booking-homepage&checkin=&checkout=&adults=&children=&aid=latindancecalendar&link=https%3A%2F%2Fbooking.com has never been seen before, processing it.
2025-06-18 16:52:04 [root] INFO: should_process_url: URL https://www.booking.com/index.html has never been seen before, processing it.
2025-06-18 16:52:04 [root] INFO: should_process_url: URL https://www.booking.com/index.html has never been seen before, processing it.
2025-06-18 16:52:04 [root] INFO: write_url_to_db(): appended URL 'https://www.booking.com/index.html'
2025-06-18 16:52:04 [root] INFO: def parse(): Crawling next URL: https://www.booking.com/index.html
2025-06-18 16:52:04 [root] INFO: should_process_url: URL https://ch.booking.com/c?st=RkxJR0hU&lt=TEFORElOR19QQUdF&target=aHR0cHM6Ly9mbGlnaHRzLmJvb2tpbmcuY29tL3B4Z28_bGFuZz1lbi11cw%3D%3D has never been seen before, processing it.
2025-06-18 16:52:04 [root] INFO: should_process_url: URL https://ch.booking.com/c?st=RkxJR0hU&lt=TEFORElOR19QQUdF&target=aHR0cHM6Ly9mbGlnaHRzLmJvb2tpbmcuY29tL3B4Z28_bGFuZz1lbi11cw%3D%3D has never been seen before, processing it.
2025-06-18 16:52:04 [root] INFO: write_url_to_db(): appended URL 'https://ch.booking.com/c?st=RkxJR0hU&lt=TEFORElOR19QQUdF&target=aHR0cHM6Ly9mbGlnaHRzLmJvb2tpbmcuY29tL3B4Z28_bGFuZz1lbi11cw%3D%3D'
2025-06-18 16:52:04 [root] INFO: def parse(): Crawling next URL: https://ch.booking.com/c?st=RkxJR0hU&lt=TEFORElOR19QQUdF&target=aHR0cHM6Ly9mbGlnaHRzLmJvb2tpbmcuY29tL3B4Z28_bGFuZz1lbi11cw%3D%3D
2025-06-18 16:52:04 [root] INFO: should_process_url: URL https://account.booking.com/auth/oauth2?client_id=vO1Kblk7xX9tUn2cpZLS&redirect_uri=https%3A%2F%2Fsecure.booking.com%2Flogin.html%3Fop%3Doauth_return&response_type=code&lang=en-us&aid=304142&bkng_action=index&prompt=signin&state=UrMBZTVEL7hZlaUj98NNQ110TNINsKsioUW20SsoSGMXGr-jMSihhwDHeK2dd_YyXRUes5eX0Y8Z_zfgplagLgk2zL7UqKGp0gepOj9YaY6bs4qR1Ab7M6JUe7G4O_20T3eYHoOe9WVESconYaNhxfNKX7xYHeXMINCdAaX8g4LDremPPGwxf8KGAsaODsxx6pLMfkmh_JLKbfbe8sysFuRkbvU89bt_KU9ya4KYe4I4j3eNc2s%3D*eyJpZCI6InRyYXZlbGxlcl9oZWFkZXIifQ%3D%3D has never been seen before, processing it.
2025-06-18 16:52:04 [root] INFO: should_process_url: URL https://account.booking.com/auth/oauth2?client_id=vO1Kblk7xX9tUn2cpZLS&redirect_uri=https%3A%2F%2Fsecure.booking.com%2Flogin.html%3Fop%3Doauth_return&response_type=code&lang=en-us&aid=304142&bkng_action=index&prompt=signin&state=UrMBZTVEL7hZlaUj98NNQ110TNINsKsioUW20SsoSGMXGr-jMSihhwDHeK2dd_YyXRUes5eX0Y8Z_zfgplagLgk2zL7UqKGp0gepOj9YaY6bs4qR1Ab7M6JUe7G4O_20T3eYHoOe9WVESconYaNhxfNKX7xYHeXMINCdAaX8g4LDremPPGwxf8KGAsaODsxx6pLMfkmh_JLKbfbe8sysFuRkbvU89bt_KU9ya4KYe4I4j3eNc2s%3D*eyJpZCI6InRyYXZlbGxlcl9oZWFkZXIifQ%3D%3D has never been seen before, processing it.
2025-06-18 16:52:04 [root] INFO: write_url_to_db(): appended URL 'https://account.booking.com/auth/oauth2?client_id=vO1Kblk7xX9tUn2cpZLS&redirect_uri=https%3A%2F%2Fsecure.booking.com%2Flogin.html%3Fop%3Doauth_return&response_type=code&lang=en-us&aid=304142&bkng_action=index&prompt=signin&state=UrMBZTVEL7hZlaUj98NNQ110TNINsKsioUW20SsoSGMXGr-jMSihhwDHeK2dd_YyXRUes5eX0Y8Z_zfgplagLgk2zL7UqKGp0gepOj9YaY6bs4qR1Ab7M6JUe7G4O_20T3eYHoOe9WVESconYaNhxfNKX7xYHeXMINCdAaX8g4LDremPPGwxf8KGAsaODsxx6pLMfkmh_JLKbfbe8sysFuRkbvU89bt_KU9ya4KYe4I4j3eNc2s%3D*eyJpZCI6InRyYXZlbGxlcl9oZWFkZXIifQ%3D%3D'
2025-06-18 16:52:04 [root] INFO: def parse(): Crawling next URL: https://account.booking.com/auth/oauth2?client_id=vO1Kblk7xX9tUn2cpZLS&redirect_uri=https%3A%2F%2Fsecure.booking.com%2Flogin.html%3Fop%3Doauth_return&response_type=code&lang=en-us&aid=304142&bkng_action=index&prompt=signin&state=UrMBZTVEL7hZlaUj98NNQ110TNINsKsioUW20SsoSGMXGr-jMSihhwDHeK2dd_YyXRUes5eX0Y8Z_zfgplagLgk2zL7UqKGp0gepOj9YaY6bs4qR1Ab7M6JUe7G4O_20T3eYHoOe9WVESconYaNhxfNKX7xYHeXMINCdAaX8g4LDremPPGwxf8KGAsaODsxx6pLMfkmh_JLKbfbe8sysFuRkbvU89bt_KU9ya4KYe4I4j3eNc2s%3D*eyJpZCI6InRyYXZlbGxlcl9oZWFkZXIifQ%3D%3D
2025-06-18 16:52:04 [root] INFO: should_process_url: URL https://ch.booking.com/c?st=Q0FS&lt=TEFORElOR19QQUdF&target=aHR0cHM6Ly93d3cuYm9va2luZy5jb20vY2Fycy9pbmRleC5lbi11cy5odG1sP3NlbGVjdGVkX2N1cnJlbmN5PVVTRA%3D%3D has never been seen before, processing it.
2025-06-18 16:52:04 [root] INFO: should_process_url: URL https://ch.booking.com/c?st=Q0FS&lt=TEFORElOR19QQUdF&target=aHR0cHM6Ly93d3cuYm9va2luZy5jb20vY2Fycy9pbmRleC5lbi11cy5odG1sP3NlbGVjdGVkX2N1cnJlbmN5PVVTRA%3D%3D has never been seen before, processing it.
2025-06-18 16:52:04 [root] INFO: write_url_to_db(): appended URL 'https://ch.booking.com/c?st=Q0FS&lt=TEFORElOR19QQUdF&target=aHR0cHM6Ly93d3cuYm9va2luZy5jb20vY2Fycy9pbmRleC5lbi11cy5odG1sP3NlbGVjdGVkX2N1cnJlbmN5PVVTRA%3D%3D'
2025-06-18 16:52:04 [root] INFO: def parse(): Crawling next URL: https://ch.booking.com/c?st=Q0FS&lt=TEFORElOR19QQUdF&target=aHR0cHM6Ly93d3cuYm9va2luZy5jb20vY2Fycy9pbmRleC5lbi11cy5odG1sP3NlbGVjdGVkX2N1cnJlbmN5PVVTRA%3D%3D
2025-06-18 16:52:04 [root] INFO: should_process_url: URL https://booking.com/pxgo?aid=304142&token=UmFuZG9tSVYkc2RlIyh9YXOod6xipXL61zJJhwJRUBkdMANl5Lw0zX4uXU1RQE8Ih6lth7Eqwt3Ru4guXo7_c03Ib1cmQBtBhIAt681KCM8UCazA1hcM-l-sQprYNtlQUxt5arTu8jO60w9nuVgtm3TqbE_p1PX_4xoni4QMD1BxI_o1d_RelzHvDKaADrVwYaOrCOeYqYyVyNg_lsYaSFzNampJDBHZ5MZTsr-WWJdPBxLk_BY93S1AQ6y6SDRYOg7aYN95YM0gpzz-0QLQ0e-Y2jikZucZJAj-uGECu06EU4FQDo-xl9IhisCxJxDX5xdLAwmmjP_m4uNSm0P4IqDugn2nzsLi8CJOupCzOr2JsYHyNaRjEHt0SD-LlwNojvqC_TesOXjjQGSpArYig5D3tjHwAsQT66nV5oqRZAW_27gLFhEbMNF-rYpfv2X4Jg-Nz1-A5zIKEA3OzsskctAvOglD8ZyYgZFbSJbSh7dKck-_GBMy5DA882stLeFCyF80Uvd78Ma5MqrI4DZnbvuhAhlMRpwJ&label=gen000rf-10CAEoggI46AdIM1gDaOwBiAEBmAEzuAEFyAEH2AED6AEB-AEBiAIBogIOY2xvc2VzdGF5cy5jb22oAgG4AuihzcIGwAIB0gIkYTcyMDg4NzMtODY2Ni00NTI4LWJiMDQtNDc5MTQzOGUyZGI02AIB4AIB&lang=en&url=https%3A%2F%2Fcruises.booking.com%2F%3Fsid%3D7f3517203f94bfdd5af4ec266e528403%26label%3Dgen000rf-10CAEoggI46AdIM1gDaOwBiAEBmAEzuAEFyAEH2AED6AEB-AEBiAIBogIOY2xvc2VzdGF5cy5jb22oAgG4AuihzcIGwAIB0gIkYTcyMDg4NzMtODY2Ni00NTI4LWJiMDQtNDc5MTQzOGUyZGI02AIB4AIB%26aid%3D304142%26uvi%3D0068534d4fced1b04900adb022aeb24d21 has never been seen before, processing it.
2025-06-18 16:52:04 [root] INFO: should_process_url: URL https://booking.com/pxgo?aid=304142&token=UmFuZG9tSVYkc2RlIyh9YXOod6xipXL61zJJhwJRUBkdMANl5Lw0zX4uXU1RQE8Ih6lth7Eqwt3Ru4guXo7_c03Ib1cmQBtBhIAt681KCM8UCazA1hcM-l-sQprYNtlQUxt5arTu8jO60w9nuVgtm3TqbE_p1PX_4xoni4QMD1BxI_o1d_RelzHvDKaADrVwYaOrCOeYqYyVyNg_lsYaSFzNampJDBHZ5MZTsr-WWJdPBxLk_BY93S1AQ6y6SDRYOg7aYN95YM0gpzz-0QLQ0e-Y2jikZucZJAj-uGECu06EU4FQDo-xl9IhisCxJxDX5xdLAwmmjP_m4uNSm0P4IqDugn2nzsLi8CJOupCzOr2JsYHyNaRjEHt0SD-LlwNojvqC_TesOXjjQGSpArYig5D3tjHwAsQT66nV5oqRZAW_27gLFhEbMNF-rYpfv2X4Jg-Nz1-A5zIKEA3OzsskctAvOglD8ZyYgZFbSJbSh7dKck-_GBMy5DA882stLeFCyF80Uvd78Ma5MqrI4DZnbvuhAhlMRpwJ&label=gen000rf-10CAEoggI46AdIM1gDaOwBiAEBmAEzuAEFyAEH2AED6AEB-AEBiAIBogIOY2xvc2VzdGF5cy5jb22oAgG4AuihzcIGwAIB0gIkYTcyMDg4NzMtODY2Ni00NTI4LWJiMDQtNDc5MTQzOGUyZGI02AIB4AIB&lang=en&url=https%3A%2F%2Fcruises.booking.com%2F%3Fsid%3D7f3517203f94bfdd5af4ec266e528403%26label%3Dgen000rf-10CAEoggI46AdIM1gDaOwBiAEBmAEzuAEFyAEH2AED6AEB-AEBiAIBogIOY2xvc2VzdGF5cy5jb22oAgG4AuihzcIGwAIB0gIkYTcyMDg4NzMtODY2Ni00NTI4LWJiMDQtNDc5MTQzOGUyZGI02AIB4AIB%26aid%3D304142%26uvi%3D0068534d4fced1b04900adb022aeb24d21 has never been seen before, processing it.
2025-06-18 16:52:04 [root] INFO: write_url_to_db(): appended URL 'https://booking.com/pxgo?aid=304142&token=UmFuZG9tSVYkc2RlIyh9YXOod6xipXL61zJJhwJRUBkdMANl5Lw0zX4uXU1RQE8Ih6lth7Eqwt3Ru4guXo7_c03Ib1cmQBtBhIAt681KCM8UCazA1hcM-l-sQprYNtlQUxt5arTu8jO60w9nuVgtm3TqbE_p1PX_4xoni4QMD1BxI_o1d_RelzHvDKaADrVwYaOrCOeYqYyVyNg_lsYaSFzNampJDBHZ5MZTsr-WWJdPBxLk_BY93S1AQ6y6SDRYOg7aYN95YM0gpzz-0QLQ0e-Y2jikZucZJAj-uGECu06EU4FQDo-xl9IhisCxJxDX5xdLAwmmjP_m4uNSm0P4IqDugn2nzsLi8CJOupCzOr2JsYHyNaRjEHt0SD-LlwNojvqC_TesOXjjQGSpArYig5D3tjHwAsQT66nV5oqRZAW_27gLFhEbMNF-rYpfv2X4Jg-Nz1-A5zIKEA3OzsskctAvOglD8ZyYgZFbSJbSh7dKck-_GBMy5DA882stLeFCyF80Uvd78Ma5MqrI4DZnbvuhAhlMRpwJ&label=gen000rf-10CAEoggI46AdIM1gDaOwBiAEBmAEzuAEFyAEH2AED6AEB-AEBiAIBogIOY2xvc2VzdGF5cy5jb22oAgG4AuihzcIGwAIB0gIkYTcyMDg4NzMtODY2Ni00NTI4LWJiMDQtNDc5MTQzOGUyZGI02AIB4AIB&lang=en&url=https%3A%2F%2Fcruises.booking.com%2F%3Fsid%3D7f3517203f94bfdd5af4ec266e528403%26label%3Dgen000rf-10CAEoggI46AdIM1gDaOwBiAEBmAEzuAEFyAEH2AED6AEB-AEBiAIBogIOY2xvc2VzdGF5cy5jb22oAgG4AuihzcIGwAIB0gIkYTcyMDg4NzMtODY2Ni00NTI4LWJiMDQtNDc5MTQzOGUyZGI02AIB4AIB%26aid%3D304142%26uvi%3D0068534d4fced1b04900adb022aeb24d21'
2025-06-18 16:52:04 [root] INFO: def parse(): Crawling next URL: https://booking.com/pxgo?aid=304142&token=UmFuZG9tSVYkc2RlIyh9YXOod6xipXL61zJJhwJRUBkdMANl5Lw0zX4uXU1RQE8Ih6lth7Eqwt3Ru4guXo7_c03Ib1cmQBtBhIAt681KCM8UCazA1hcM-l-sQprYNtlQUxt5arTu8jO60w9nuVgtm3TqbE_p1PX_4xoni4QMD1BxI_o1d_RelzHvDKaADrVwYaOrCOeYqYyVyNg_lsYaSFzNampJDBHZ5MZTsr-WWJdPBxLk_BY93S1AQ6y6SDRYOg7aYN95YM0gpzz-0QLQ0e-Y2jikZucZJAj-uGECu06EU4FQDo-xl9IhisCxJxDX5xdLAwmmjP_m4uNSm0P4IqDugn2nzsLi8CJOupCzOr2JsYHyNaRjEHt0SD-LlwNojvqC_TesOXjjQGSpArYig5D3tjHwAsQT66nV5oqRZAW_27gLFhEbMNF-rYpfv2X4Jg-Nz1-A5zIKEA3OzsskctAvOglD8ZyYgZFbSJbSh7dKck-_GBMy5DA882stLeFCyF80Uvd78Ma5MqrI4DZnbvuhAhlMRpwJ&label=gen000rf-10CAEoggI46AdIM1gDaOwBiAEBmAEzuAEFyAEH2AED6AEB-AEBiAIBogIOY2xvc2VzdGF5cy5jb22oAgG4AuihzcIGwAIB0gIkYTcyMDg4NzMtODY2Ni00NTI4LWJiMDQtNDc5MTQzOGUyZGI02AIB4AIB&lang=en&url=https%3A%2F%2Fcruises.booking.com%2F%3Fsid%3D7f3517203f94bfdd5af4ec266e528403%26label%3Dgen000rf-10CAEoggI46AdIM1gDaOwBiAEBmAEzuAEFyAEH2AED6AEB-AEBiAIBogIOY2xvc2VzdGF5cy5jb22oAgG4AuihzcIGwAIB0gIkYTcyMDg4NzMtODY2Ni00NTI4LWJiMDQtNDc5MTQzOGUyZGI02AIB4AIB%26aid%3D304142%26uvi%3D0068534d4fced1b04900adb022aeb24d21
2025-06-18 16:52:04 [root] INFO: should_process_url: URL https://secure.booking.com/help.html?source=header&src=profile_contact_cs has never been seen before, processing it.
2025-06-18 16:52:04 [root] INFO: should_process_url: URL https://secure.booking.com/help.html?source=header&src=profile_contact_cs has never been seen before, processing it.
2025-06-18 16:52:04 [root] INFO: write_url_to_db(): appended URL 'https://secure.booking.com/help.html?source=header&src=profile_contact_cs'
2025-06-18 16:52:04 [root] INFO: def parse(): Crawling next URL: https://secure.booking.com/help.html?source=header&src=profile_contact_cs
2025-06-18 16:52:04 [root] INFO: def parse(): Found keywords for URL https://www.sedadance.ca/dropin: ['dance']
2025-06-18 16:52:04 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.sedadance.ca/dropin
2025-06-18 16:52:04 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:52:04 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:52:04 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:52:39 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:52:39 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "Seda Dance - Book a Drop-in",
        "dance_style": "ballet, contemporary",
        "url": "",
        "event_type": "class",
        "event_name": "Drop-in Classes",
        "day_of_week": "Monday, Tuesday, Wednesday, Thursday, Friday, Saturday, Sunday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Seda Dance Arts., 1525 Begbie Street, Victoria, BC, V8R 1K9, Canada",
        "description": "While most courses are progressive in nature, we will always welcome a drop-in dancer, space permitting.  Drop-in dancers and Flex Pass holders may sign up for any level-appropriate class with the understanding that there may be the additional challenge of picking up some previously learned phrases and concepts.   Drop-in friendly til spring break, after spring break a portion of performance classes will be dedicated to rehearsal, drop-ins accepted as long as practical. ‘Open’ and Conditioning classes remain drop-in friendly all year long. Should you have trouble signing up for a drop-in class online, you are welcome to show up and fill out our drop-in waiver, located in the studio entry hallway on the table. Please note this option is space permitting and if a class is un-bookable online it may be full. We accept payment by Cash, E-transfer or Online Credit Card. FOR FULL YEAR REGISTRATION - CLICK HERE."
    }
]
2025-06-18 16:52:39 [root] INFO: def extract_and_parse_json(): for url https://www.sedadance.ca/dropin, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Seda Dance - Book a Drop-in",
        "dance_style": "ballet, contemporary",
        "url": "",
        "event_type": "class",
        "event_name": "Drop-in Classes",
        "day_of_week": "Monday, Tuesday, Wednesday, Thursday, Friday, Saturday, Sunday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Seda Dance Arts., 1525 Begbie Street, Victoria, BC, V8R 1K9, Canada",
        "description": "While most courses are progressive in nature, we will always welcome a drop-in dancer, space permitting.  Drop-in dancers and Flex Pass holders may sign up for any level-appropriate class with the understanding that there may be the additional challenge of picking up some previously learned phrases and concepts.   Drop-in friendly til spring break, after spring break a portion of performance classes will be dedicated to rehearsal, drop-ins accepted as long as practical. ‘Open’ and Conditioning classes remain drop-in friendly all year long. Should you have trouble signing up for a drop-in class online, you are welcome to show up and fill out our drop-in waiver, located in the studio entry hallway on the table. Please note this option is space permitting and if a class is un-bookable online it may be full. We accept payment by Cash, E-transfer or Online Credit Card. FOR FULL YEAR REGISTRATION - CLICK HERE."
    }
]
2025-06-18 16:52:39 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 16:52:39 [root] INFO: def clean_up_address(): Processing location 'Seda Dance Arts., 1525 Begbie Street, Victoria, BC, V8R 1K9, Canada' (event_id: None)
2025-06-18 16:52:39 [root] INFO: def clean_up_address(): Updated event None with address_id 12096 using DB match
2025-06-18 16:52:39 [root] INFO: write_events_to_db: Number of events to write: 1
2025-06-18 16:52:39 [root] INFO: write_url_to_db(): appended URL 'https://www.sedadance.ca/dropin'
2025-06-18 16:52:39 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 16:52:39 [root] INFO: def process_llm_response: URL https://www.sedadance.ca/dropin marked as relevant with events written to the database.
2025-06-18 16:52:39 [root] INFO: write_url_to_db(): appended URL 'https://www.sedadance.ca/dropin'
2025-06-18 16:52:39 [root] INFO: def parse(): URL https://www.sedadance.ca/dropin marked as relevant (LLM positive).
2025-06-18 16:52:39 [root] INFO: def parse(): Found 10 links on https://www.sedadance.ca/dropin
2025-06-18 16:52:39 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://app.squarespacescheduling.com/schedule.php?owner=26812023&ref=sched_block, URL: https://www.sedadance.ca/dropin, source: Seda Dance Arts: Adult Dance Classes in Victoria BC, keywords: dance
2025-06-18 16:52:39 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: jlzZqn)r^v^hwۯ5M
2025-06-18 16:52:39 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://app.squarespacescheduling.com/schedule.php?owner=26812023&ref=sched_block
2025-06-18 16:52:39 [root] INFO: write_url_to_db(): appended URL 'https://app.squarespacescheduling.com/schedule.php?owner=26812023&ref=sched_block'
2025-06-18 16:52:39 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/SEDAdance'
2025-06-18 16:52:39 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/SEDAdance
2025-06-18 16:52:39 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/sedadance_arts/'
2025-06-18 16:52:39 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/sedadance_arts/
2025-06-18 16:52:39 [root] INFO: should_process_url: URL https://www.sedadance.ca/our-studio was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:52:39 [root] INFO: should_process_url: URL https://www.sedadance.ca/dropin was last seen as relevant, processing it.
2025-06-18 16:52:39 [scrapy.extensions.logstats] INFO: Crawled 357 pages (at 13 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 16:52:39 [root] INFO: write_url_to_db(): appended URL 'https://www.lauraradwell.com/'
2025-06-18 16:52:39 [root] INFO: def parse(): URL https://www.lauraradwell.com/ marked as irrelevant (no keywords).
2025-06-18 16:52:39 [root] INFO: def parse(): Found 2 links on https://www.lauraradwell.com/
2025-06-18 16:52:39 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/laura_radwell_art/'
2025-06-18 16:52:39 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/laura_radwell_art/
2025-06-18 16:52:39 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/imaginedlandscapepaintings/'
2025-06-18 16:52:39 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/imaginedlandscapepaintings/
2025-06-18 16:52:39 [root] INFO: should_process_url: URL https://www.lauraradwell.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:52:39 [root] INFO: def parse(): Found keywords for URL https://folkalley.com/folk-alley-favorites-best-trad-of-2023/: ['dance']
2025-06-18 16:52:39 [root] INFO: def generate_prompt(): Generating prompt for URL: https://folkalley.com/folk-alley-favorites-best-trad-of-2023/
2025-06-18 16:52:39 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:52:39 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:52:39 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:52:48 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:52:48 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 16:52:48 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 16:52:49 [root] INFO: write_url_to_db(): appended URL 'https://folkalley.com/folk-alley-favorites-best-trad-of-2023/'
2025-06-18 16:52:49 [root] INFO: def parse(): URL https://folkalley.com/folk-alley-favorites-best-trad-of-2023/ marked as irrelevant (LLM negative).
2025-06-18 16:52:49 [root] INFO: def parse(): Found 10 links on https://folkalley.com/folk-alley-favorites-best-trad-of-2023/
2025-06-18 16:52:49 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.youtube.com/embed/YL-dfOT7CyU, URL: https://folkalley.com/folk-alley-favorites-best-trad-of-2023/, source: Natalie Padilla, keywords: country waltz
2025-06-18 16:52:49 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: 2nm(m`_9>
2025-06-18 16:52:49 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.youtube.com/embed/YL-dfOT7CyU
2025-06-18 16:52:49 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.youtube.com/embed/39c0U0Ph-WQ, URL: https://folkalley.com/folk-alley-favorites-best-trad-of-2023/, source: Natalie Padilla, keywords: country waltz
2025-06-18 16:52:49 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: 2nm(m4SCY
2025-06-18 16:52:49 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.youtube.com/embed/39c0U0Ph-WQ
2025-06-18 16:52:49 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.youtube.com/embed/1hMxG92KTGE, URL: https://folkalley.com/folk-alley-favorites-best-trad-of-2023/, source: Natalie Padilla, keywords: country waltz
2025-06-18 16:52:49 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: 2nm(m1݊La
2025-06-18 16:52:49 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.youtube.com/embed/1hMxG92KTGE
2025-06-18 16:52:49 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.youtube.com/embed/n91mo5cpwYk, URL: https://folkalley.com/folk-alley-favorites-best-trad-of-2023/, source: Natalie Padilla, keywords: country waltz
2025-06-18 16:52:49 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: 2nm(mf)
2025-06-18 16:52:49 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.youtube.com/embed/n91mo5cpwYk
2025-06-18 16:52:49 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.youtube.com/embed/NYG0bFpnvVc, URL: https://folkalley.com/folk-alley-favorites-best-trad-of-2023/, source: Natalie Padilla, keywords: country waltz
2025-06-18 16:52:49 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: 2nm(m5lZgW
2025-06-18 16:52:49 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.youtube.com/embed/NYG0bFpnvVc
2025-06-18 16:52:49 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.youtube.com/embed/OYSg62yxfn0, URL: https://folkalley.com/folk-alley-favorites-best-trad-of-2023/, source: Natalie Padilla, keywords: country waltz
2025-06-18 16:52:49 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: 2nm(m9l~}
2025-06-18 16:52:49 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.youtube.com/embed/OYSg62yxfn0
2025-06-18 16:52:49 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.youtube.com/embed/nKbVoSyVXXc, URL: https://folkalley.com/folk-alley-favorites-best-trad-of-2023/, source: Natalie Padilla, keywords: country waltz
2025-06-18 16:52:49 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: 2nm(mա,]w
2025-06-18 16:52:49 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.youtube.com/embed/nKbVoSyVXXc
2025-06-18 16:52:49 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.youtube.com/embed/WJOPHsQE0dE, URL: https://folkalley.com/folk-alley-favorites-best-trad-of-2023/, source: Natalie Padilla, keywords: country waltz
2025-06-18 16:52:49 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: 2nm(mX
2025-06-18 16:52:49 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.youtube.com/embed/WJOPHsQE0dE
2025-06-18 16:52:49 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.youtube.com/embed/oMNK5KhOYfo?list=OLAK5uy_kvGErAYSBGz2_awcKlAJBsVfYUWlf6CGU, URL: https://folkalley.com/folk-alley-favorites-best-trad-of-2023/, source: Natalie Padilla, keywords: country waltz
2025-06-18 16:52:49 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: 2nm(mJNa%
2025-06-18 16:52:49 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.youtube.com/embed/oMNK5KhOYfo?list=OLAK5uy_kvGErAYSBGz2_awcKlAJBsVfYUWlf6CGU
2025-06-18 16:52:49 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.youtube.com/embed/tnaqFY8Q7ZU, URL: https://folkalley.com/folk-alley-favorites-best-trad-of-2023/, source: Natalie Padilla, keywords: country waltz
2025-06-18 16:52:49 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: 2nm(mv
2025-06-18 16:52:49 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.youtube.com/embed/tnaqFY8Q7ZU
2025-06-18 16:52:49 [root] INFO: write_url_to_db(): appended URL 'https://www.youtube.com/embed/tnaqFY8Q7ZU'
2025-06-18 16:52:49 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/folkalley/'
2025-06-18 16:52:49 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/folkalley/
2025-06-18 16:52:49 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/FolkAlley/'
2025-06-18 16:52:49 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/FolkAlley/
2025-06-18 16:52:49 [root] INFO: should_process_url: URL https://folkalley.com/folk-alley-favorites-best-trad-of-2023/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:52:49 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/folkalley.
2025-06-18 16:52:49 [root] INFO: should_process_url: URL https://folkalley.com/folk-alley-radio-show/ was last seen as relevant, processing it.
2025-06-18 16:52:49 [root] INFO: should_process_url: URL https://folkalley.com/folk-alley-radio-show/ was last seen as relevant, processing it.
2025-06-18 16:52:49 [root] INFO: write_url_to_db(): appended URL 'https://folkalley.com/folk-alley-radio-show/'
2025-06-18 16:52:49 [root] INFO: def parse(): Crawling next URL: https://folkalley.com/folk-alley-radio-show/
2025-06-18 16:52:49 [root] INFO: should_process_url: URL https://folkalley.com/ was last seen as relevant, processing it.
2025-06-18 16:52:49 [root] INFO: should_process_url: URL https://folkalley.com/ was last seen as relevant, processing it.
2025-06-18 16:52:49 [root] INFO: write_url_to_db(): appended URL 'https://folkalley.com/'
2025-06-18 16:52:49 [root] INFO: def parse(): Crawling next URL: https://folkalley.com/
2025-06-18 16:52:49 [root] INFO: should_process_url: URL https://folkalley.com/stream/folk-alley/ was last seen as relevant, processing it.
2025-06-18 16:52:49 [root] INFO: should_process_url: URL https://folkalley.com/stream/folk-alley/ was last seen as relevant, processing it.
2025-06-18 16:52:49 [root] INFO: write_url_to_db(): appended URL 'https://folkalley.com/stream/folk-alley/'
2025-06-18 16:52:49 [root] INFO: def parse(): Crawling next URL: https://folkalley.com/stream/folk-alley/
2025-06-18 16:52:49 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <403 https://www.fatea-records.co.uk/magazine/reviews/NataliePadilla/>: HTTP status code is not handled or not allowed
2025-06-18 16:52:49 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/user/FolkAlleydotCom/.
2025-06-18 16:52:49 [root] INFO: should_process_url: URL https://folkalley.com/category/podcasts/ was last seen as relevant, processing it.
2025-06-18 16:52:49 [root] INFO: should_process_url: URL https://folkalley.com/category/podcasts/ was last seen as relevant, processing it.
2025-06-18 16:52:49 [root] INFO: write_url_to_db(): appended URL 'https://folkalley.com/category/podcasts/'
2025-06-18 16:52:49 [root] INFO: def parse(): Crawling next URL: https://folkalley.com/category/podcasts/
2025-06-18 16:52:49 [root] INFO: should_process_url: URL https://folkalley.com/category/specialty-hours/ was last seen as relevant, processing it.
2025-06-18 16:52:49 [root] INFO: should_process_url: URL https://folkalley.com/category/specialty-hours/ was last seen as relevant, processing it.
2025-06-18 16:52:49 [root] INFO: write_url_to_db(): appended URL 'https://folkalley.com/category/specialty-hours/'
2025-06-18 16:52:49 [root] INFO: def parse(): Crawling next URL: https://folkalley.com/category/specialty-hours/
2025-06-18 16:52:49 [root] INFO: def parse(): Found keywords for URL https://www.sedadance.ca/our-studio: ['dance']
2025-06-18 16:52:49 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.sedadance.ca/our-studio
2025-06-18 16:52:49 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:52:49 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:52:49 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:56:09 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:56:09 [root] INFO: query_llm(): Mistral response received:  <ul data-rte-list="default"><li><p class="sqsrte-large" style="white-space:pre-wrap;">Seda Dance Arts Studio is located on the unceded territory of the W̱SÁNEĆ and lək̓ʷəŋən speaking peoples.</p></li><li><p class="sqsrte-large" style="white-space:pre-wrap;">All our regular classes are held at our Fernwood studio at St Barnabas Church Hall - 1525 Begbie Street in Victoria. This large, light-filled space is centrally located with lots of free parking and bike racks, and is on a bus route.</p></li></ul>
</div>



























  
  



</div></div></div></div></div>
    </div>
  
  </div>
  
</section>

  
    
    


  
  



  
</article>


          

          
            
          
        
      </main>
      
       <footer class="footer" id="footer" data-content-field="footer">
            
          
        



  
  



<div class="sqs-slice" data-slice-type="footer" data-slice-id="footer-navigation">
  <div class="sqs-slice-wrapper">
    <div class="sqs-slice-block-wrapper">
      <div class="sqs-slice-block">
        <div class="sqs-slice-content">
          <div class="footer-links">

            <div class="footer-nav">












                    <ul class="footer-nav-list">
                      <li><a href="/about">About</a></li>
                      <li><a href="/classes">Classes</a></li>
                      <li><a href="/schedule">Schedule</a></li>
                      <li><a href="/contemporary">Contemporary</a></li>
                      <li><a href="/ballet">Ballet</a></li>
                      <li><a href="/saol">Saol (55+ Program)</a></li>
                      <li><a href="/conditioning">Conditioning Classes</a></li>
                      <li><a href="/registration">Registration</a></li>
                      <li><a href="/workshops">Workshops + Sessionals</a></li>
                      <li><a href="/choreography">Choreography</a></li>
                      <li><a href="/choreography-mentorship">Choreography Mentorship Program</a></li>
                      <li><a href="/pricing">Pricing</a></li>
                      <li><a href="/scholarships">Scholarships</a></li>
                      <li><a href="/acuityaccount">Acuity Accounts</a></li>
                      <li><a href="/gift">Gift of Dance</a></li>
                      <li><a href="/third-canvas">Third Canvas</a></li>
                      <li><a href="/gallery">Gallery</a></li>
                      <li><a href="/contact-us">Contact</a></li>
                      <li><a href="/kismet">KISMET 2025</a></li>
                      <li><a href="/summer">Summer</a></li>
                    </ul>

            </div>


          </div>
        </div>
      </div>
    </div>
  </div>
</div>







  
  


<div class="footer-social-links" data-content-field="social-links">
  <div class="footer-social-links-wrapper">
    <ul class="social-links-list">

        <li>
          <a class="social-link social-link--instagram" href="https://www.instagram.com/sedadance_arts/" target="_blank" aria-label="instagram">
            <svg class="sqs-svg-icon" viewBox="0 0 64 64">
              <use xlink:href="#instagram-unauth-icon"></use>
            </svg>
          </a>
        </li>

        <li>
          <a class="social-link social-link--facebook" href="https://www.facebook.com/SEDAdance" target="_blank" aria-label="facebook">
            <svg class="sqs-svg-icon" viewBox="0 0 64 64">
              <use xlink:href="#facebook-unauth-icon"></use>
            </svg>
          </a>
        </li>

    </ul>
  </div>
</div>

























  
  





<div class="sqs-slice" data-slice-type="footer" data-slice-id="footer-content">
  <div class="sqs-slice-wrapper">
    <div class="sqs-slice-block-wrapper">
      <div class="sqs-slice-block">
        <div class="sqs-slice-content">
          <div class="footer-content">

<div class="sqs-html-content"><p class="" style="white-space:pre-wrap;">©2023 Seda Dance Arts.  All Rights Reserved.  <a href="https://www.sedadance.ca/our-studio" style="white-space:pre-wrap;">Studio</a> | <a href="https://www.sedadance.ca/privacy" style="white-space:pre-wrap;">Privacy Policy</a> | <a href="https://www.sedadance.ca/terms" style="white-space:pre-wrap;">Terms of Service</a></p>
<p class="" style="white-space:pre-wrap;">Proudly Created with <a href="https://www.squarespace.com/?form-version=9&amp;templateId=62e0b9ba2882e21674aeba32" style="white-space:pre-wrap;">Squarespace</a>.</p>
</div>


          </div>
        </div>
      </div>
    </div>
  </div>
</div>


</footer>










































































































</html>

To validate this JSON, I considered the following rules:

1. **Date Rules**:
   - The current date is June 18, 2025 (2025-06-18).
   - If a date mentions only the month and day (no year), infer the year as follows:
     - If the date is within the past 90 days from today's date, use the current year (2025).
     - If the date is more than 90 days in the past, use the next year (2026).
   - "Today" should be interpreted as the current date.
   - If an event starts with a day_of_week (e.g. "Saturday"), and there is no start_date given, then impute the start_date and end_date to be the first day_of_week going forward that you encounter in the calendar.
     - If an event starts with Tomorrow, For example, this event "Tomorrow from 20:00-00:00 Hot Salsa " Would be interpreted as Sunday December 20, 2023 20:00-00:00, when your current date in the format YYYY-MM-DD and no date is explicitly mentioned.
   - If an event starts with Yesterday, interpret it as the day before the current date.

2. **Day of the week and start_date Consistency**:
   - Do not change the given day_of_week.
   - If your computed start_date is not that weekday, shift the date by ±1 day (whichever is closer) until it matches.
   - Adjust end_date accordingly (if single-day, set equal to start_date).

3. **JSON Format**:
   - The output should be a valid JSON array.
   - Each event should be in the following format:
     ```json
     {
       "source": "<The original source of information for this event>",
       "dance_style": "<choose one or muptiple: bachata, balboa, douceur, east coast swing, kizomba, lindy hop, salsa, swing, tango, tarraxo, tarraxinha, urban kiz, west coast swing, wcs>",
       "url": "<''>",
       "event_type": "<choose one: social dance, class, workshop, other, rehearsal, live music>",
       "event_name": "<event name>",
       "day_of_week": "<e.g., Monday, Tuesday>",
       "start_date": "<YYYY-MM-DD>",
       "end_date": "<YYYY-MM-DD or same as Start_Date if single-day>",
       "start_time": "<HH:MM>",
       "end_time": "<HH:MM or null>",
       "price": "<e.g., $15>",
       "location": "<venue name and address>",
       "description": "<short summary of event details>"
     }
     ```

4. **Output**:
   - If no events are found, output exactly:
     ```
     No events found.
     ```

Here is the extracted and parsed JSON:

```json
[
  {
    "source": "https://www.sedadance.ca/our-studio",
    "dance_style": "contemporary, ballet",
    "url": "",
    "event_type": "class",
    "event_name": "Seda Studio",
    "day_of_week": "Monday",
    "start_date": "2025-01-02",
    "end_date": "2025-01-02",
    "start_time": "10:00",
    "end_time": "11:30",
    "price": "$15",
    "location": "Seda Dance Arts Studio - 1525 Begbie St.",
    "description": "Contemporary Class with Kathy Lang"
  },
  {
    "source": "https://www.sedadance.ca/our-studio",
    "dance_style": "ballet",
    "url": "",
    "event_type": "class",
    "event_name": "Seda Studio",
    "day_of_week": "Tuesday",
    "start_date": "2025-01-07",
    "end_date": "2025-01-07",
    "start_time": "17:00",
    "end_time": "18:30",
    "price": "$15",
    "location": "Seda Dance Arts Studio - 1525 Begbie St.",
    "description": "Ballet Class with Kathy Lang"
  },
  {
    "source": "https://www.sedadance.ca/our-studio",
    "dance_style": "contemporary",
    "url": "",
    "event_type": "class",
    "event_name": "Seda Studio",
    "day_of_week": "Wednesday",
    "start_date": "2025-01-08",
    "end_date": "2025-01-08",
    "start_time": "10:00",
    "end_time": "11:30",
    "price": "$15",
    "location": "Seda Dance Arts Studio - 1525 Begbie St.",
    "description": "Contemporary Class with Kathy Lang"
  },
  {
    "source": "https://www.sedadance.ca/our-studio",
    "dance_style": "ballet",
    "url": "",
    "event_type": "class",
    "event_name": "Seda Studio",
    "day_of_week": "Saturday",
    "start_date": "2025-01-11",
    "end_date": "2025-01-11",
    "start_time": "10:00",
    "end_time": "11:30",
    "price": "$15",
    "location": "Seda Dance Arts Studio - 1525 Begbie St.",
    "description": "Ballet Class with Kathy Lang"
  },
  {
    "source": "https://www.sedadance.ca/our-studio",
    "dance_style": "contemporary, ballet",
    "url": "",
    "event_type": "class",
    "event_name": "Seda Studio",
    "day_of_week": "Saturday",
    "start_date": "2025-06-16",
    "end_date": "2025-06-16",
    "start_time": "10:00",
    "end_time": "11:30",
    "price": "",
    "location": "Seda Dance Arts Studio - 1525 Begbie St.",
    "description": "Contemporary Class with Kathy Lang (Cancelled)"
  }
]
```
2025-06-18 16:56:09 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 16:56:09 [root] INFO: write_url_to_db(): appended URL 'https://www.sedadance.ca/our-studio'
2025-06-18 16:56:09 [root] INFO: def parse(): URL https://www.sedadance.ca/our-studio marked as irrelevant (LLM negative).
2025-06-18 16:56:09 [root] INFO: def parse(): Found 10 links on https://www.sedadance.ca/our-studio
2025-06-18 16:56:09 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/SEDAdance'
2025-06-18 16:56:09 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/SEDAdance
2025-06-18 16:56:09 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/sedadance_arts/'
2025-06-18 16:56:09 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/sedadance_arts/
2025-06-18 16:56:09 [root] INFO: should_process_url: URL https://www.sedadance.ca/our-studio was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:56:09 [root] INFO: should_process_url: URL https://www.sedadance.ca/dropin was last seen as relevant, processing it.
2025-06-18 16:56:09 [root] INFO: should_process_url: URL https://www.google.com/url?sa=t&source=web&rct=j&opi=89978449&url=/maps/dir//seda%2Bdance/data%3D!4m6!4m5!1m1!4e2!1m2!1m1!1s0x548f75d7ebf254e5:0xdc92cc2da43d9826%3Fsa%3DX%26ved%3D1t:3061%26ictx%3D111 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:56:09 [root] INFO: should_process_url: URL https://www.google.com/url?sa=t&source=web&rct=j&opi=89978449&url=/maps/dir//seda%2Bdance/data%3D!4m6!4m5!1m1!4e2!1m2!1m1!1s0x548f75d7ebf254e5:0xdc92cc2da43d9826%3Fsa%3DX%26ved%3D1t:3061%26ictx%3D111 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 16:56:09 [root] INFO: write_url_to_db(): appended URL 'https://www.google.com/url?sa=t&source=web&rct=j&opi=89978449&url=/maps/dir//seda%2Bdance/data%3D!4m6!4m5!1m1!4e2!1m2!1m1!1s0x548f75d7ebf254e5:0xdc92cc2da43d9826%3Fsa%3DX%26ved%3D1t:3061%26ictx%3D111'
2025-06-18 16:56:09 [root] INFO: def parse(): Crawling next URL: https://www.google.com/url?sa=t&source=web&rct=j&opi=89978449&url=/maps/dir//seda%2Bdance/data%3D!4m6!4m5!1m1!4e2!1m2!1m1!1s0x548f75d7ebf254e5:0xdc92cc2da43d9826%3Fsa%3DX%26ved%3D1t:3061%26ictx%3D111
2025-06-18 16:56:10 [root] INFO: def parse(): Found keywords for URL https://creativebc.com/bc-film-commission/register-a-production/: ['live music']
2025-06-18 16:56:10 [root] INFO: def generate_prompt(): Generating prompt for URL: https://creativebc.com/bc-film-commission/register-a-production/
2025-06-18 16:56:10 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:56:10 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:56:10 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:56:13 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:56:13 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 647010 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 16:56:13 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:56:14 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:56:14 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 454804 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 16:56:14 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 16:56:14 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://creativebc.com/bc-film-commission/register-a-production/
2025-06-18 16:56:14 [root] INFO: write_url_to_db(): appended URL 'https://creativebc.com/bc-film-commission/register-a-production/'
2025-06-18 16:56:14 [root] INFO: def parse(): URL https://creativebc.com/bc-film-commission/register-a-production/ marked as irrelevant (LLM negative).
2025-06-18 16:56:14 [root] INFO: def parse(): Found 10 links on https://creativebc.com/bc-film-commission/register-a-production/
2025-06-18 16:56:14 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-M58QS7V, URL: https://creativebc.com/bc-film-commission/register-a-production/, source: Rifflandia Festival, keywords: music festivals
2025-06-18 16:56:14 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 16:56:14 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-M58QS7V
2025-06-18 16:56:14 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-M58QS7V'
2025-06-18 16:56:14 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/register-a-production/ has never been seen before, processing it.
2025-06-18 16:56:14 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/consults-packages-surveys/ has never been seen before, processing it.
2025-06-18 16:56:14 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/in-production/ has never been seen before, processing it.
2025-06-18 16:56:14 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/ has never been seen before, processing it.
2025-06-18 16:56:14 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/code-of-conduct/ has never been seen before, processing it.
2025-06-18 16:56:14 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/cross-border-services/ has never been seen before, processing it.
2025-06-18 16:56:14 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/greater-vancouver/ has never been seen before, processing it.
2025-06-18 16:56:14 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/library-production-services/ has never been seen before, processing it.
2025-06-18 16:56:14 [root] INFO: should_process_url: URL https://creativebc.com/ has never been seen before, processing it.
2025-06-18 16:56:14 [root] INFO: should_process_url: URL https://creativebc.com/bc-film-commission/production-credits/ has never been seen before, processing it.
2025-06-18 16:56:14 [root] INFO: def parse(): Found keywords for URL https://2traveldads.com/category/southwestern-us/: ['balboa']
2025-06-18 16:56:14 [root] INFO: def generate_prompt(): Generating prompt for URL: https://2traveldads.com/category/southwestern-us/
2025-06-18 16:56:14 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:56:14 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:56:14 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:56:16 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 16:56:16 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 160568 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 16:56:16 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 16:56:27 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:56:27 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 16:56:27 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 16:56:27 [root] INFO: write_url_to_db(): appended URL 'https://2traveldads.com/category/southwestern-us/'
2025-06-18 16:56:27 [root] INFO: def parse(): URL https://2traveldads.com/category/southwestern-us/ marked as irrelevant (LLM negative).
2025-06-18 16:56:27 [root] INFO: def parse(): Found 10 links on https://2traveldads.com/category/southwestern-us/
2025-06-18 16:56:27 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/florida/florida-keys/ has never been seen before, processing it.
2025-06-18 16:56:27 [root] INFO: should_process_url: URL https://2traveldads.com/southeast-usa/ has never been seen before, processing it.
2025-06-18 16:56:27 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/florida/ has never been seen before, processing it.
2025-06-18 16:56:27 [root] INFO: should_process_url: URL https://2traveldads.com/ has never been seen before, processing it.
2025-06-18 16:56:27 [root] INFO: should_process_url: URL https://2traveldads.com/category/southwestern-us/ has never been seen before, processing it.
2025-06-18 16:56:27 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/alabama/ has never been seen before, processing it.
2025-06-18 16:56:27 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/georgia/ has never been seen before, processing it.
2025-06-18 16:56:27 [root] INFO: should_process_url: URL https://2traveldads.com/basics-of-visiting-the-united-states/ has never been seen before, processing it.
2025-06-18 16:56:27 [root] INFO: should_process_url: URL https://2traveldads.com/all-blog-posts/ has never been seen before, processing it.
2025-06-18 16:56:27 [root] INFO: def parse(): Found keywords for URL https://2traveldads.com/category/southeastern-us/alabama/: ['balboa']
2025-06-18 16:56:27 [root] INFO: def generate_prompt(): Generating prompt for URL: https://2traveldads.com/category/southeastern-us/alabama/
2025-06-18 16:56:27 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:56:27 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:56:27 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:56:59 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:56:59 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "2traveldads.com",
        "dance_style": "social dance, class, workshop",
        "url": "",
        "event_type": "social dance",
        "event_name": "Fun Things to Do in Mobile AL from Mardi Gras to Beautiful Beaches",
        "day_of_week": "",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Mobile, Alabama is a fun, mellow alternative to New Orleans. The best things to do in Mobile, Alabama range from walking the wrought iron balcony lined streets to airboat rides to find alligators. So much to do in Mobile!"
    }
]
2025-06-18 16:56:59 [root] INFO: def extract_and_parse_json(): for url https://2traveldads.com/category/southeastern-us/alabama/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "2traveldads.com",
        "dance_style": "social dance, class, workshop",
        "url": "",
        "event_type": "social dance",
        "event_name": "Fun Things to Do in Mobile AL from Mardi Gras to Beautiful Beaches",
        "day_of_week": "",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Mobile, Alabama is a fun, mellow alternative to New Orleans. The best things to do in Mobile, Alabama range from walking the wrought iron balcony lined streets to airboat rides to find alligators. So much to do in Mobile!"
    }
]
2025-06-18 16:56:59 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 16:56:59 [root] INFO: write_events_to_db: Number of events to write: 1
2025-06-18 16:56:59 [root] INFO: write_url_to_db(): appended URL 'https://2traveldads.com/category/southeastern-us/alabama/'
2025-06-18 16:56:59 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 16:56:59 [root] INFO: def process_llm_response: URL https://2traveldads.com/category/southeastern-us/alabama/ marked as relevant with events written to the database.
2025-06-18 16:56:59 [root] INFO: write_url_to_db(): appended URL 'https://2traveldads.com/category/southeastern-us/alabama/'
2025-06-18 16:56:59 [root] INFO: def parse(): URL https://2traveldads.com/category/southeastern-us/alabama/ marked as relevant (LLM positive).
2025-06-18 16:56:59 [root] INFO: def parse(): Found 10 links on https://2traveldads.com/category/southeastern-us/alabama/
2025-06-18 16:56:59 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/florida/florida-keys/ has never been seen before, processing it.
2025-06-18 16:56:59 [root] INFO: should_process_url: URL https://2traveldads.com/southeast-usa/ has never been seen before, processing it.
2025-06-18 16:56:59 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/florida/ has never been seen before, processing it.
2025-06-18 16:56:59 [root] INFO: should_process_url: URL https://2traveldads.com/ has never been seen before, processing it.
2025-06-18 16:56:59 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/alabama/ has never been seen before, processing it.
2025-06-18 16:56:59 [root] INFO: should_process_url: URL https://2traveldads.com/category/southwestern-us/ has never been seen before, processing it.
2025-06-18 16:56:59 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/georgia/ has never been seen before, processing it.
2025-06-18 16:56:59 [root] INFO: should_process_url: URL https://2traveldads.com/basics-of-visiting-the-united-states/ has never been seen before, processing it.
2025-06-18 16:56:59 [root] INFO: should_process_url: URL https://2traveldads.com/all-blog-posts/ has never been seen before, processing it.
2025-06-18 16:56:59 [root] INFO: def parse(): Found keywords for URL https://onbeatmarketing.com: ['dance']
2025-06-18 16:56:59 [root] INFO: def generate_prompt(): Generating prompt for URL: https://onbeatmarketing.com
2025-06-18 16:56:59 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:56:59 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:56:59 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:57:36 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:57:36 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "OnBeat Marketing",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Themed Dance Night",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-19",
        "end_date": "2025-06-19",
        "start_time": "19:30",
        "end_time": "23:00",
        "price": "Donation based",
        "location": "3131 O Street, Sacramento, CA",
        "description": "Join us for a night of dancing to all your favorite songs from the 80s, 90s, and 00s. All ages welcome. Donation based entry. Proceeds go to charity."
    },
    {
        "source": "OnBeat Marketing",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Monthly Dance Social",
        "day_of_week": "Saturday",
        "start_date": "2025-07-12",
        "end_date": "2025-07-12",
        "start_time": "20:00",
        "end_time": "00:00",
        "price": "$10",
        "location": "Dance Studio, 1234 Main Street, Anytown, USA",
        "description": "Come join us for our monthly dance social. All levels welcome. Music will be a mix of all your favorite dance styles. $10 cover charge."
    },
    {
        "source": "OnBeat Marketing",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Summer Dance Festival",
        "day_of_week": "Friday",
        "start_date": "2025-08-15",
        "end_date": "2025-08-17",
        "start_time": "18:00",
        "end_time": "23:00",
        "price": "$25 per day or $60 for a weekend pass",
        "location": "City Park, Anytown, USA",
        "description": "Join us for a weekend of dance workshops, performances, and social dancing. All levels welcome. Tickets are $25 per day or $60 for a weekend pass."
    },
    {
        "source": "OnBeat Marketing",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Charity Dance-a-thon",
        "day_of_week": "Sunday",
        "start_date": "2025-09-20",
        "end_date": "2025-09-20",
        "start_time": "12:00",
        "end_time": "18:00",
        "price": "Donation based",
        "location": "Community Center, 5678 Elm Street, Anytown, USA",
        "description": "Dance for a cause! Join us for a day of non-stop dancing to raise money for charity. All levels welcome. Donation based entry."
    },
    {
        "source": "OnBeat Marketing",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Holiday Dance Party",
        "day_of_week": "Friday",
        "start_date": "2025-12-19",
        "end_date": "2025-12-19",
        "start_time": "19:00",
        "end_time": "23:00",
        "price": "$15",
        "location": "Ballroom Studio, 9101 Oak Avenue, Anytown, USA",
        "description": "Celebrate the holidays with us at our annual dance party. All levels welcome. Music will be a mix of holiday classics and dance favorites. $15 cover charge."
    }
]
2025-06-18 16:57:36 [root] INFO: def extract_and_parse_json(): for url https://onbeatmarketing.com, 
Cleaned JSON ready for parsing:
[
    {
        "source": "OnBeat Marketing",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Themed Dance Night",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-19",
        "end_date": "2025-06-19",
        "start_time": "19:30",
        "end_time": "23:00",
        "price": "Donation based",
        "location": "3131 O Street, Sacramento, CA",
        "description": "Join us for a night of dancing to all your favorite songs from the 80s, 90s, and 00s. All ages welcome. Donation based entry. Proceeds go to charity."
    },
    {
        "source": "OnBeat Marketing",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Monthly Dance Social",
        "day_of_week": "Saturday",
        "start_date": "2025-07-12",
        "end_date": "2025-07-12",
        "start_time": "20:00",
        "end_time": "00:00",
        "price": "$10",
        "location": "Dance Studio, 1234 Main Street, Anytown, USA",
        "description": "Come join us for our monthly dance social. All levels welcome. Music will be a mix of all your favorite dance styles. $10 cover charge."
    },
    {
        "source": "OnBeat Marketing",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Summer Dance Festival",
        "day_of_week": "Friday",
        "start_date": "2025-08-15",
        "end_date": "2025-08-17",
        "start_time": "18:00",
        "end_time": "23:00",
        "price": "$25 per day or $60 for a weekend pass",
        "location": "City Park, Anytown, USA",
        "description": "Join us for a weekend of dance workshops, performances, and social dancing. All levels welcome. Tickets are $25 per day or $60 for a weekend pass."
    },
    {
        "source": "OnBeat Marketing",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Charity Dance-a-thon",
        "day_of_week": "Sunday",
        "start_date": "2025-09-20",
        "end_date": "2025-09-20",
        "start_time": "12:00",
        "end_time": "18:00",
        "price": "Donation based",
        "location": "Community Center, 5678 Elm Street, Anytown, USA",
        "description": "Dance for a cause! Join us for a day of non-stop dancing to raise money for charity. All levels welcome. Donation based entry."
    },
    {
        "source": "OnBeat Marketing",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Holiday Dance Party",
        "day_of_week": "Friday",
        "start_date": "2025-12-19",
        "end_date": "2025-12-19",
        "start_time": "19:00",
        "end_time": "23:00",
        "price": "$15",
        "location": "Ballroom Studio, 9101 Oak Avenue, Anytown, USA",
        "description": "Celebrate the holidays with us at our annual dance party. All levels welcome. Music will be a mix of holiday classics and dance favorites. $15 cover charge."
    }
]
2025-06-18 16:57:36 [root] INFO: def clean_up_address(): Starting with events_df shape: (5, 14)
2025-06-18 16:57:36 [root] INFO: def clean_up_address(): Processing location '3131 O Street, Sacramento, CA' (event_id: None)
2025-06-18 16:57:36 [root] INFO: def clean_up_address(): Processing location 'Dance Studio, 1234 Main Street, Anytown, USA' (event_id: None)
2025-06-18 16:57:36 [root] INFO: def clean_up_address(): Processing location 'City Park, Anytown, USA' (event_id: None)
2025-06-18 16:57:36 [root] INFO: def clean_up_address(): Processing location 'Community Center, 5678 Elm Street, Anytown, USA' (event_id: None)
2025-06-18 16:57:36 [root] INFO: def clean_up_address(): Processing location 'Ballroom Studio, 9101 Oak Avenue, Anytown, USA' (event_id: None)
2025-06-18 16:57:36 [root] INFO: write_events_to_db: Number of events to write: 5
2025-06-18 16:57:36 [root] INFO: write_url_to_db(): appended URL 'https://onbeatmarketing.com'
2025-06-18 16:57:36 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 16:57:36 [root] INFO: def process_llm_response: URL https://onbeatmarketing.com marked as relevant with events written to the database.
2025-06-18 16:57:36 [root] INFO: write_url_to_db(): appended URL 'https://onbeatmarketing.com'
2025-06-18 16:57:36 [root] INFO: def parse(): URL https://onbeatmarketing.com marked as relevant (LLM positive).
2025-06-18 16:57:36 [root] INFO: def parse(): Found 10 links on https://www.onbeatmarketing.com/
2025-06-18 16:57:36 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/justin.mcclendon.779/posts/10165331399000545'
2025-06-18 16:57:36 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/justin.mcclendon.779/posts/10165331399000545
2025-06-18 16:57:36 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/arthurmurray.salem/posts/3096721787224997'
2025-06-18 16:57:36 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/arthurmurray.salem/posts/3096721787224997
2025-06-18 16:57:36 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/onbeatmarketing/'
2025-06-18 16:57:36 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/onbeatmarketing/
2025-06-18 16:57:36 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/arthurmurray.salem'
2025-06-18 16:57:36 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/arthurmurray.salem
2025-06-18 16:57:36 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/justin.mcclendon.779'
2025-06-18 16:57:36 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/justin.mcclendon.779
2025-06-18 16:57:36 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/serge.chmelnitzki'
2025-06-18 16:57:36 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/serge.chmelnitzki
2025-06-18 16:57:36 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/serge.chmelnitzki/posts/10225982788254492'
2025-06-18 16:57:36 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/serge.chmelnitzki/posts/10225982788254492
2025-06-18 16:57:36 [root] INFO: should_process_url: URL https://onbeatmarketing.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 16:57:36 [root] INFO: def parse(): Found keywords for URL https://2traveldads.com/southeast-usa/: ['balboa']
2025-06-18 16:57:36 [root] INFO: def generate_prompt(): Generating prompt for URL: https://2traveldads.com/southeast-usa/
2025-06-18 16:57:36 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:57:36 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:57:36 [root] INFO: query_llm(): Querying Mistral
2025-06-18 16:59:32 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 16:59:32 [root] INFO: query_llm(): Mistral response received: Extracted Text:

[
  {
    "source": "2TravelDads",
    "dance_style": "bachata",
    "url": "",
    "event_type": "live music",
    "event_name": "Summer Music Fest",
    "day_of_week": "Saturday",
    "start_date": "2025-06-22",
    "end_date": "2025-06-22",
    "start_time": "18:00",
    "end_time": "23:00",
    "price": "$35 for entry, $75 for VIP",
    "location": "Beachside Music Venue, 123 Beach Avenue, Beachside, FL 32401",
    "description": "Enjoy a night of live music with performances by local bands. VIP tickets include access to a private lounge with complimentary drinks and appetizers. All proceeds benefit local charities.",
    "source_link": "https://2traveldads.com/southeast-usa/"
  },
  {
    "source": "2TravelDads",
    "dance_style": "bachata",
    "url": "",
    "event_type": "social dance",
    "event_name": "Dance Night at The Beach",
    "day_of_week": "Friday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "20:00",
    "end_time": "01:00",
    "price": "$10 for entry",
    "location": "Beachside Dance Hall, 456 Ocean Drive, Beachside, FL 32401",
    "description": "Join us for a night of dancing under the stars. All levels welcome. No partner required.",
    "source_link": "https://2traveldads.com/southeast-usa/"
  },
  {
    "source": "2TravelDads",
    "dance_style": "bachata",
    "url": "",
    "event_type": "social dance",
    "event_name": "Saturday Night Social",
    "day_of_week": "Saturday",
    "start_date": "2025-06-22",
    "end_date": "2025-06-22",
    "start_time": "19:00",
    "end_time": "23:00",
    "price": "$15 for entry",
    "location": "City Community Center, 789 Main Street, Beachside, FL 32401",
    "description": "Every Saturday night, join us for a social dance event. All levels welcome. No partner required.",
    "source_link": "https://2traveldads.com/southeast-usa/"
  }
]

The extracted text contains three events. Here is the JSON array:

```json
[
  {
    "source": "2TravelDads",
    "dance_style": "bachata",
    "url": "",
    "event_type": "live music",
    "event_name": "Summer Music Fest",
    "day_of_week": "Saturday",
    "start_date": "2025-06-22",
    "end_date": "2025-06-22",
    "start_time": "18:00",
    "end_time": "23:00",
    "price": "$35 for entry, $75 for VIP",
    "location": "Beachside Music Venue, 123 Beach Avenue, Beachside, FL 32401",
    "description": "Enjoy a night of live music with performances by local bands. VIP tickets include access to a private lounge with complimentary drinks and appetizers. All proceeds benefit local charities.",
    "source_link": "https://2traveldads.com/southeast-usa/"
  },
  {
    "source": "2TravelDads",
    "dance_style": "bachata",
    "url": "",
    "event_type": "social dance",
    "event_name": "Dance Night at The Beach",
    "day_of_week": "Friday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "20:00",
    "end_time": "01:00",
    "price": "$10 for entry",
    "location": "Beachside Dance Hall, 456 Ocean Drive, Beachside, FL 32401",
    "description": "Join us for a night of dancing under the stars. All levels welcome. No partner required.",
    "source_link": "https://2traveldads.com/southeast-usa/"
  },
  {
    "source": "2TravelDads",
    "dance_style": "bachata",
    "url": "",
    "event_type": "social dance",
    "event_name": "Saturday Night Social",
    "day_of_week": "Saturday",
    "start_date": "2025-06-22",
    "end_date": "2025-06-22",
    "start_time": "19:00",
    "end_time": "23:00",
    "price": "$15 for entry",
    "location": "City Community Center, 789 Main Street, Beachside, FL 32401",
    "description": "Every Saturday night, join us for a social dance event. All levels welcome. No partner required.",
    "source_link": "https://2traveldads.com/southeast-usa/"
  }
]
```
2025-06-18 16:59:32 [root] INFO: def extract_and_parse_json(): for url https://2traveldads.com/southeast-usa/, 
Cleaned JSON ready for parsing:
[
  {
    "source": "2TravelDads",
    "dance_style": "bachata",
    "url": "",
    "event_type": "live music",
    "event_name": "Summer Music Fest",
    "day_of_week": "Saturday",
    "start_date": "2025-06-22",
    "end_date": "2025-06-22",
    "start_time": "18:00",
    "end_time": "23:00",
    "price": "$35 for entry, $75 for VIP",
    "location": "Beachside Music Venue, 123 Beach Avenue, Beachside, FL 32401",
    "description": "Enjoy a night of live music with performances by local bands. VIP tickets include access to a private lounge with complimentary drinks and appetizers. All proceeds benefit local charities.",
    "source_link": "https://2traveldads.com/southeast-usa/"
  },
  {
    "source": "2TravelDads",
    "dance_style": "bachata",
    "url": "",
    "event_type": "social dance",
    "event_name": "Dance Night at The Beach",
    "day_of_week": "Friday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "20:00",
    "end_time": "01:00",
    "price": "$10 for entry",
    "location": "Beachside Dance Hall, 456 Ocean Drive, Beachside, FL 32401",
    "description": "Join us for a night of dancing under the stars. All levels welcome. No partner required.",
    "source_link": "https://2traveldads.com/southeast-usa/"
  },
  {
    "source": "2TravelDads",
    "dance_style": "bachata",
    "url": "",
    "event_type": "social dance",
    "event_name": "Saturday Night Social",
    "day_of_week": "Saturday",
    "start_date": "2025-06-22",
    "end_date": "2025-06-22",
    "start_time": "19:00",
    "end_time": "23:00",
    "price": "$15 for entry",
    "location": "City Community Center, 789 Main Street, Beachside, FL 32401",
    "description": "Every Saturday night, join us for a social dance event. All levels welcome. No partner required.",
    "source_link": "https://2traveldads.com/southeast-usa/"
  }
]
2025-06-18 16:59:32 [root] INFO: def clean_up_address(): Starting with events_df shape: (3, 15)
2025-06-18 16:59:33 [root] INFO: def clean_up_address(): Processing location 'Beachside Music Venue, 123 Beach Avenue, Beachside, FL 32401' (event_id: None)
2025-06-18 16:59:33 [root] INFO: def clean_up_address(): Processing location 'Beachside Dance Hall, 456 Ocean Drive, Beachside, FL 32401' (event_id: None)
2025-06-18 16:59:33 [root] INFO: def clean_up_address(): Processing location 'City Community Center, 789 Main Street, Beachside, FL 32401' (event_id: None)
2025-06-18 16:59:33 [root] INFO: write_events_to_db: Number of events to write: 3
2025-06-18 16:59:33 [scrapy.core.scraper] ERROR: Spider error processing <GET https://2traveldads.com/southeast-usa/> (referer: https://2traveldads.com/balboa-park-guide-san-diego/minolta-digital-camera-109/)
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column "source_link" of relation "events" does not exist
LINE 1: ...art_time, end_time, price, location, description, source_lin...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/utils/defer.py", line 343, in iter_errback
    yield next(it)
          ^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/utils/python.py", line 369, in __next__
    return next(self.data)
           ^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/utils/python.py", line 369, in __next__
    return next(self.data)
           ^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/spidermw.py", line 167, in process_sync
    yield from iterable
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/spidermiddlewares/base.py", line 58, in process_spider_output
    for o in result:
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/spidermw.py", line 167, in process_sync
    yield from iterable
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/spidermiddlewares/base.py", line 58, in process_spider_output
    for o in result:
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/spidermw.py", line 167, in process_sync
    yield from iterable
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/spidermiddlewares/base.py", line 58, in process_spider_output
    for o in result:
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/spidermw.py", line 167, in process_sync
    yield from iterable
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/spidermiddlewares/depth.py", line 59, in process_spider_output
    yield from super().process_spider_output(response, result, spider)
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/spidermiddlewares/base.py", line 58, in process_spider_output
    for o in result:
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/spidermw.py", line 167, in process_sync
    yield from iterable
  File "/mnt/d/GitHub/social_dance_app/src/scraper.py", line 139, in parse
    llm_status = llm_handler.process_llm_response(url, parent_url, extracted_text, source, keywords, prompt)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/d/GitHub/social_dance_app/src/llm.py", line 208, in process_llm_response
    db_handler.write_events_to_db(events_df, url, parent_url, source, keywords_list)
  File "/mnt/d/GitHub/social_dance_app/src/db.py", line 753, in write_events_to_db
    cleaned_df.to_sql('events', self.conn, if_exists='append', index=False, method='multi')
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/pandas/io/sql.py", line 1027, in _execute_insert_multi
    result = conn.execute(stmt)
             ^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "source_link" of relation "events" does not exist
LINE 1: ...art_time, end_time, price, location, description, source_lin...
                                                             ^

[SQL: INSERT INTO events (source, dance_style, url, event_type, event_name, day_of_week, start_date, end_date, start_time, end_time, price, location, description, source_link, time_stamp) VALUES (%(source_m0)s, %(dance_style_m0)s, %(url_m0)s, %(event_type_m0)s, %(event_name_m0)s, %(day_of_week_m0)s, %(start_date_m0)s, %(end_date_m0)s, %(start_time_m0)s, %(end_time_m0)s, %(price_m0)s, %(location_m0)s, %(description_m0)s, %(source_link_m0)s, %(time_stamp_m0)s), (%(source_m1)s, %(dance_style_m1)s, %(url_m1)s, %(event_type_m1)s, %(event_name_m1)s, %(day_of_week_m1)s, %(start_date_m1)s, %(end_date_m1)s, %(start_time_m1)s, %(end_time_m1)s, %(price_m1)s, %(location_m1)s, %(description_m1)s, %(source_link_m1)s, %(time_stamp_m1)s), (%(source_m2)s, %(dance_style_m2)s, %(url_m2)s, %(event_type_m2)s, %(event_name_m2)s, %(day_of_week_m2)s, %(start_date_m2)s, %(end_date_m2)s, %(start_time_m2)s, %(end_time_m2)s, %(price_m2)s, %(location_m2)s, %(description_m2)s, %(source_link_m2)s, %(time_stamp_m2)s)]
[parameters: {'source_m0': 'Balboa Park in Golden Hour San Diego California - 2TravelDads', 'dance_style_m0': 'bachata', 'url_m0': 'https://2traveldads.com/southeast-usa/', 'event_type_m0': 'live music', 'event_name_m0': 'Summer Music Fest', 'day_of_week_m0': 'Saturday', 'start_date_m0': datetime.date(2025, 6, 22), 'end_date_m0': datetime.datetime(2025, 6, 22, 0, 0), 'start_time_m0': datetime.time(18, 0), 'end_time_m0': datetime.time(23, 0), 'price_m0': '$35 for entry, $75 for VIP', 'location_m0': 'Beachside Music Venue, 123 Beach Avenue, Beachside, FL 32401', 'description_m0': 'Enjoy a night of live music with performances by local bands. VIP tickets include access to a private lounge with complimentary drinks and appetizers. All proceeds benefit local charities.', 'source_link_m0': 'https://2traveldads.com/southeast-usa/', 'time_stamp_m0': datetime.datetime(2025, 6, 18, 16, 59, 32, 990282), 'source_m1': 'Balboa Park in Golden Hour San Diego California - 2TravelDads', 'dance_style_m1': 'bachata', 'url_m1': 'https://2traveldads.com/southeast-usa/', 'event_type_m1': 'social dance', 'event_name_m1': 'Dance Night at The Beach', 'day_of_week_m1': 'Friday', 'start_date_m1': datetime.date(2025, 6, 21), 'end_date_m1': datetime.datetime(2025, 6, 21, 0, 0), 'start_time_m1': datetime.time(20, 0), 'end_time_m1': datetime.time(1, 0), 'price_m1': '$10 for entry', 'location_m1': 'Beachside Dance Hall, 456 Ocean Drive, Beachside, FL 32401', 'description_m1': 'Join us for a night of dancing under the stars. All levels welcome. No partner required.', 'source_link_m1': 'https://2traveldads.com/southeast-usa/', 'time_stamp_m1': datetime.datetime(2025, 6, 18, 16, 59, 32, 990282), 'source_m2': 'Balboa Park in Golden Hour San Diego California - 2TravelDads', 'dance_style_m2': 'bachata', 'url_m2': 'https://2traveldads.com/southeast-usa/', 'event_type_m2': 'social dance', 'event_name_m2': 'Saturday Night Social', 'day_of_week_m2': 'Saturday', 'start_date_m2': datetime.date(2025, 6, 22), 'end_date_m2': datetime.datetime(2025, 6, 22, 0, 0), 'start_time_m2': datetime.time(19, 0), 'end_time_m2': datetime.time(23, 0), 'price_m2': '$15 for entry', 'location_m2': 'City Community Center, 789 Main Street, Beachside, FL 32401', 'description_m2': 'Every Saturday night, join us for a social dance event. All levels welcome. No partner required.', 'source_link_m2': 'https://2traveldads.com/southeast-usa/', 'time_stamp_m2': datetime.datetime(2025, 6, 18, 16, 59, 32, 990282)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-06-18 16:59:33 [root] INFO: def parse(): Found keywords for URL https://2traveldads.com/category/southeastern-us/florida/florida-keys/: ['balboa']
2025-06-18 16:59:33 [root] INFO: def generate_prompt(): Generating prompt for URL: https://2traveldads.com/category/southeastern-us/florida/florida-keys/
2025-06-18 16:59:33 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 16:59:33 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 16:59:33 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:00:17 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:00:17 [root] INFO: query_llm(): Mistral response received: The extracted_text is at the bottom of these instructions.  Here it is:

No events.
2025-06-18 17:00:17 [root] INFO: def extract_and_parse_json(): No valid events found in result.
2025-06-18 17:00:17 [root] INFO: write_url_to_db(): appended URL 'https://2traveldads.com/category/southeastern-us/florida/florida-keys/'
2025-06-18 17:00:17 [root] INFO: def parse(): URL https://2traveldads.com/category/southeastern-us/florida/florida-keys/ marked as irrelevant (LLM negative).
2025-06-18 17:00:17 [root] INFO: def parse(): Found 10 links on https://2traveldads.com/category/southeastern-us/florida/florida-keys/
2025-06-18 17:00:17 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/florida/florida-keys/ has never been seen before, processing it.
2025-06-18 17:00:17 [root] INFO: should_process_url: URL https://2traveldads.com/southeast-usa/ has never been seen before, processing it.
2025-06-18 17:00:17 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/florida/ has never been seen before, processing it.
2025-06-18 17:00:17 [root] INFO: should_process_url: URL https://2traveldads.com/ has never been seen before, processing it.
2025-06-18 17:00:17 [root] INFO: should_process_url: URL https://2traveldads.com/category/southwestern-us/ has never been seen before, processing it.
2025-06-18 17:00:17 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/alabama/ has never been seen before, processing it.
2025-06-18 17:00:17 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/georgia/ has never been seen before, processing it.
2025-06-18 17:00:17 [root] INFO: should_process_url: URL https://2traveldads.com/basics-of-visiting-the-united-states/ has never been seen before, processing it.
2025-06-18 17:00:17 [root] INFO: should_process_url: URL https://2traveldads.com/all-blog-posts/ has never been seen before, processing it.
2025-06-18 17:00:17 [root] INFO: def parse(): Found keywords for URL https://2traveldads.com/: ['balboa', 'semba']
2025-06-18 17:00:17 [root] INFO: def generate_prompt(): Generating prompt for URL: https://2traveldads.com/
2025-06-18 17:00:17 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:00:17 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:00:17 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:15:18 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 504 Gateway Timeout"
2025-06-18 17:15:18 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 504
{
  "message":"The upstream server is timing out",
  "request_id":"8a452e2e6565e13d71c1671c59d4c431"
}
2025-06-18 17:15:18 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 17:15:24 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:15:24 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 17:15:24 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 17:15:24 [root] INFO: write_url_to_db(): appended URL 'https://2traveldads.com/'
2025-06-18 17:15:24 [root] INFO: def parse(): URL https://2traveldads.com/ marked as irrelevant (LLM negative).
2025-06-18 17:15:24 [root] INFO: def parse(): Found 10 links on https://2traveldads.com/
2025-06-18 17:15:24 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/florida/florida-keys/ has never been seen before, processing it.
2025-06-18 17:15:24 [root] INFO: should_process_url: URL https://2traveldads.com/southeast-usa/ has never been seen before, processing it.
2025-06-18 17:15:24 [root] INFO: should_process_url: URL https://2traveldads.com/ has never been seen before, processing it.
2025-06-18 17:15:24 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/florida/ has never been seen before, processing it.
2025-06-18 17:15:24 [root] INFO: should_process_url: URL https://2traveldads.com/category/southwestern-us/ has never been seen before, processing it.
2025-06-18 17:15:24 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/alabama/ has never been seen before, processing it.
2025-06-18 17:15:24 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/georgia/ has never been seen before, processing it.
2025-06-18 17:15:24 [root] INFO: should_process_url: URL https://2traveldads.com/basics-of-visiting-the-united-states/ has never been seen before, processing it.
2025-06-18 17:15:24 [root] INFO: should_process_url: URL https://2traveldads.com/all-blog-posts/ has never been seen before, processing it.
2025-06-18 17:15:24 [root] INFO: def parse(): Found keywords for URL https://www.5rhythms.com/EventSearch.php: ['dance']
2025-06-18 17:15:24 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.5rhythms.com/EventSearch.php
2025-06-18 17:15:24 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:15:24 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:15:24 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:16:10 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:16:10 [root] INFO: query_llm(): Mistral response received: ```json
[
    {
        "source": "https://www.5rhythms.com/EventSearch.php",
        "dance_style": "",
        "url": "",
        "event_type": "class",
        "event_name": "5Rhythms Faculty",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "https://www.5rhythms.com/EventSearch.php",
        "dance_style": "",
        "url": "",
        "event_type": "class",
        "event_name": "The Moving Center NY",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "https://www.5rhythms.com/EventSearch.php",
        "dance_style": "",
        "url": "",
        "event_type": "class",
        "event_name": "Teacher Trainings",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "https://www.5rhythms.com/EventSearch.php",
        "dance_style": "",
        "url": "",
        "event_type": "class",
        "event_name": "SpaceHolder Orientations",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "https://www.5rhythms.com/EventSearch.php",
        "dance_style": "",
        "url": "",
        "event_type": "class",
        "event_name": "5RTA Concentration",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": ""
    }
]
```
2025-06-18 17:16:10 [root] INFO: def extract_and_parse_json(): for url https://www.5rhythms.com/EventSearch.php, 
Cleaned JSON ready for parsing:
[
    {
        "source": "https://www.5rhythms.com/EventSearch.php",
        "dance_style": "",
        "url": "",
        "event_type": "class",
        "event_name": "5Rhythms Faculty",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "https://www.5rhythms.com/EventSearch.php",
        "dance_style": "",
        "url": "",
        "event_type": "class",
        "event_name": "The Moving Center NY",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "https://www.5rhythms.com/EventSearch.php",
        "dance_style": "",
        "url": "",
        "event_type": "class",
        "event_name": "Teacher Trainings",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "https://www.5rhythms.com/EventSearch.php",
        "dance_style": "",
        "url": "",
        "event_type": "class",
        "event_name": "SpaceHolder Orientations",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "https://www.5rhythms.com/EventSearch.php",
        "dance_style": "",
        "url": "",
        "event_type": "class",
        "event_name": "5RTA Concentration",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": ""
    }
]
2025-06-18 17:16:10 [root] INFO: def clean_up_address(): Starting with events_df shape: (5, 14)
2025-06-18 17:16:10 [root] INFO: write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 17:16:10 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/EventSearch.php'
2025-06-18 17:16:10 [root] INFO: def process_llm_response: URL https://www.5rhythms.com/EventSearch.php marked as relevant with events written to the database.
2025-06-18 17:16:10 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/EventSearch.php'
2025-06-18 17:16:10 [root] INFO: def parse(): URL https://www.5rhythms.com/EventSearch.php marked as relevant (LLM positive).
2025-06-18 17:16:10 [root] INFO: def parse(): Found 10 links on https://www.5rhythms.com/EventSearch.php
2025-06-18 17:16:10 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/5rhythms'
2025-06-18 17:16:10 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/5rhythms
2025-06-18 17:16:10 [root] INFO: write_url_to_db(): appended URL 'https://instagram.com/5rhythms/'
2025-06-18 17:16:10 [root] INFO: def parse(): Recorded unwanted URL: https://instagram.com/5rhythms/
2025-06-18 17:16:10 [root] INFO: should_process_url: URL https://www.5rhythms.com/EventSearch.php was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:16:10 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/5Rhythms.
2025-06-18 17:16:10 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:16:10 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:16:10 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/nl/'
2025-06-18 17:16:10 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/nl/
2025-06-18 17:16:10 [scrapy.extensions.logstats] INFO: Crawled 368 pages (at 11 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 17:16:10 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.facebook.com/groups/1634269246863069/> (failed 3 times): User timeout caused connection failure: Getting https://www.facebook.com/groups/1634269246863069/ took longer than 180.0 seconds..
2025-06-18 17:16:10 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://abcbookworld.com/writer/winn-vanessa/> (failed 3 times): User timeout caused connection failure: Getting https://abcbookworld.com/writer/winn-vanessa/ took longer than 180.0 seconds..
2025-06-18 17:16:10 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://books.friesenpress.com/store/title/119734000143340479/Jaime-Smith-Foxtrot> (failed 3 times): User timeout caused connection failure: Getting https://books.friesenpress.com/store/title/119734000143340479/Jaime-Smith-Foxtrot took longer than 180.0 seconds..
2025-06-18 17:16:10 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:16:10 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:16:10 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/hr/'
2025-06-18 17:16:10 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/hr/
2025-06-18 17:16:10 [root] INFO: should_process_url: URL https://www.5rhythms.com/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:16:10 [root] INFO: should_process_url: URL https://www.5rhythms.com/es/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:16:10 [root] INFO: should_process_url: URL https://www.5rhythms.com/es/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:16:10 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/es/'
2025-06-18 17:16:10 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/es/
2025-06-18 17:16:10 [root] INFO: should_process_url: URL https://www.5rhythms.com/TeacherSearch.php was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:16:10 [root] INFO: should_process_url: URL https://www.5rhythms.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:16:10 [root] INFO: def parse(): Found keywords for URL https://2traveldads.com/category/southeastern-us/florida/: ['balboa', 'tango']
2025-06-18 17:16:10 [root] INFO: def generate_prompt(): Generating prompt for URL: https://2traveldads.com/category/southeastern-us/florida/
2025-06-18 17:16:10 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:16:10 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:16:10 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:16:12 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 17:16:12 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 172196 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 17:16:12 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 17:16:22 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:16:22 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 17:16:22 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 17:16:22 [root] INFO: write_url_to_db(): appended URL 'https://2traveldads.com/category/southeastern-us/florida/'
2025-06-18 17:16:22 [root] INFO: def parse(): URL https://2traveldads.com/category/southeastern-us/florida/ marked as irrelevant (LLM negative).
2025-06-18 17:16:22 [root] INFO: def parse(): Found 10 links on https://2traveldads.com/category/southeastern-us/florida/
2025-06-18 17:16:22 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/florida/florida-keys/ has never been seen before, processing it.
2025-06-18 17:16:22 [root] INFO: should_process_url: URL https://2traveldads.com/southeast-usa/ has never been seen before, processing it.
2025-06-18 17:16:22 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/florida/ has never been seen before, processing it.
2025-06-18 17:16:22 [root] INFO: should_process_url: URL https://2traveldads.com/ has never been seen before, processing it.
2025-06-18 17:16:22 [root] INFO: should_process_url: URL https://2traveldads.com/category/southwestern-us/ has never been seen before, processing it.
2025-06-18 17:16:22 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/alabama/ has never been seen before, processing it.
2025-06-18 17:16:22 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/georgia/ has never been seen before, processing it.
2025-06-18 17:16:22 [root] INFO: should_process_url: URL https://2traveldads.com/basics-of-visiting-the-united-states/ has never been seen before, processing it.
2025-06-18 17:16:22 [root] INFO: should_process_url: URL https://2traveldads.com/all-blog-posts/ has never been seen before, processing it.
2025-06-18 17:16:22 [root] INFO: def parse(): Found keywords for URL https://2traveldads.com/category/southeastern-us/georgia/: ['balboa', 'swing']
2025-06-18 17:16:22 [root] INFO: def generate_prompt(): Generating prompt for URL: https://2traveldads.com/category/southeastern-us/georgia/
2025-06-18 17:16:22 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:16:22 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:16:22 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:16:24 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 17:16:24 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 140045 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 17:16:24 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 17:16:32 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:16:32 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 17:16:32 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 17:16:32 [root] INFO: write_url_to_db(): appended URL 'https://2traveldads.com/category/southeastern-us/georgia/'
2025-06-18 17:16:32 [root] INFO: def parse(): URL https://2traveldads.com/category/southeastern-us/georgia/ marked as irrelevant (LLM negative).
2025-06-18 17:16:32 [root] INFO: def parse(): Found 10 links on https://2traveldads.com/category/southeastern-us/georgia/
2025-06-18 17:16:32 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/florida/florida-keys/ has never been seen before, processing it.
2025-06-18 17:16:32 [root] INFO: should_process_url: URL https://2traveldads.com/southeast-usa/ has never been seen before, processing it.
2025-06-18 17:16:32 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/florida/ has never been seen before, processing it.
2025-06-18 17:16:32 [root] INFO: should_process_url: URL https://2traveldads.com/ has never been seen before, processing it.
2025-06-18 17:16:32 [root] INFO: should_process_url: URL https://2traveldads.com/category/southwestern-us/ has never been seen before, processing it.
2025-06-18 17:16:32 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/alabama/ has never been seen before, processing it.
2025-06-18 17:16:32 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/georgia/ has never been seen before, processing it.
2025-06-18 17:16:32 [root] INFO: should_process_url: URL https://2traveldads.com/basics-of-visiting-the-united-states/ has never been seen before, processing it.
2025-06-18 17:16:32 [root] INFO: should_process_url: URL https://2traveldads.com/all-blog-posts/ has never been seen before, processing it.
2025-06-18 17:16:33 [root] INFO: def parse(): Found keywords for URL https://2traveldads.com/all-blog-posts/: ['balboa', 'semba']
2025-06-18 17:16:33 [root] INFO: def generate_prompt(): Generating prompt for URL: https://2traveldads.com/all-blog-posts/
2025-06-18 17:16:33 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:16:33 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:16:33 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:16:34 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 17:16:34 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 142725 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 17:16:34 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 17:16:41 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:16:41 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 17:16:41 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 17:16:41 [root] INFO: write_url_to_db(): appended URL 'https://2traveldads.com/all-blog-posts/'
2025-06-18 17:16:41 [root] INFO: def parse(): URL https://2traveldads.com/all-blog-posts/ marked as irrelevant (LLM negative).
2025-06-18 17:16:41 [root] INFO: def parse(): Found 10 links on https://2traveldads.com/all-blog-posts/
2025-06-18 17:16:41 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/florida/florida-keys/ has never been seen before, processing it.
2025-06-18 17:16:41 [root] INFO: should_process_url: URL https://2traveldads.com/southeast-usa/ has never been seen before, processing it.
2025-06-18 17:16:41 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/florida/ has never been seen before, processing it.
2025-06-18 17:16:41 [root] INFO: should_process_url: URL https://2traveldads.com/ has never been seen before, processing it.
2025-06-18 17:16:41 [root] INFO: should_process_url: URL https://2traveldads.com/category/southwestern-us/ has never been seen before, processing it.
2025-06-18 17:16:41 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/alabama/ has never been seen before, processing it.
2025-06-18 17:16:41 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/georgia/ has never been seen before, processing it.
2025-06-18 17:16:41 [root] INFO: should_process_url: URL https://2traveldads.com/basics-of-visiting-the-united-states/ has never been seen before, processing it.
2025-06-18 17:16:41 [root] INFO: should_process_url: URL https://2traveldads.com/all-blog-posts/ has never been seen before, processing it.
2025-06-18 17:16:41 [root] INFO: def parse(): Found keywords for URL https://2traveldads.com/basics-of-visiting-the-united-states/: ['balboa']
2025-06-18 17:16:41 [root] INFO: def generate_prompt(): Generating prompt for URL: https://2traveldads.com/basics-of-visiting-the-united-states/
2025-06-18 17:16:41 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:16:41 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:16:41 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:16:57 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:16:57 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 17:16:57 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 17:16:57 [root] INFO: write_url_to_db(): appended URL 'https://2traveldads.com/basics-of-visiting-the-united-states/'
2025-06-18 17:16:57 [root] INFO: def parse(): URL https://2traveldads.com/basics-of-visiting-the-united-states/ marked as irrelevant (LLM negative).
2025-06-18 17:16:57 [root] INFO: def parse(): Found 10 links on https://2traveldads.com/basics-of-visiting-the-united-states/
2025-06-18 17:16:57 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/florida/florida-keys/ has never been seen before, processing it.
2025-06-18 17:16:57 [root] INFO: should_process_url: URL https://2traveldads.com/southeast-usa/ has never been seen before, processing it.
2025-06-18 17:16:57 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/florida/ has never been seen before, processing it.
2025-06-18 17:16:57 [root] INFO: should_process_url: URL https://2traveldads.com/ has never been seen before, processing it.
2025-06-18 17:16:57 [root] INFO: should_process_url: URL https://2traveldads.com/category/southwestern-us/ has never been seen before, processing it.
2025-06-18 17:16:57 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/alabama/ has never been seen before, processing it.
2025-06-18 17:16:57 [root] INFO: should_process_url: URL https://2traveldads.com/basics-of-visiting-the-united-states/ has never been seen before, processing it.
2025-06-18 17:16:57 [root] INFO: should_process_url: URL https://2traveldads.com/category/southeastern-us/georgia/ has never been seen before, processing it.
2025-06-18 17:16:57 [root] INFO: should_process_url: URL https://2traveldads.com/all-blog-posts/ has never been seen before, processing it.
2025-06-18 17:16:57 [root] INFO: def parse(): Found keywords for URL https://www.5rhythms.com/hr/who-we-are/teacher-communities/the-americas/canada-west-coast/: ['dance']
2025-06-18 17:16:57 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.5rhythms.com/hr/who-we-are/teacher-communities/the-americas/canada-west-coast/
2025-06-18 17:16:57 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:16:57 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:16:57 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:17:33 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:17:33 [root] INFO: query_llm(): Mistral response received: ```json
[
    {
        "source": "5Ritmova | Zapadna obala Kanade",
        "dance_style": "",
        "url": "",
        "event_type": "workshop",
        "event_name": "UNTAMED: Campout Retreat WILD EXPANSION",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-22",
        "start_time": "",
        "end_time": null,
        "price": "$485",
        "location": "Salt Spring Island",
        "description": "A weekend of movement, sun honouring & full illumination. Includes: 2 nights camping, 5 meals and 5 sessions. This workshop invites participants to welcome in the Summer Solstice with dance, writing, circle/partner work and ritual. We will honour the power of the sun and the energy of stepping fully into our untamed, radiant selves. Includes sunrise and sunset sessions."
    },
    {
        "source": "5Ritmova | Zapadna obala Kanade",
        "dance_style": "",
        "url": "",
        "event_type": "workshop",
        "event_name": "FLOWSTATE",
        "day_of_week": "Saturday",
        "start_date": "2025-06-28",
        "end_date": "2025-06-28",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Vancouver",
        "description": "There is a place we touch in movement where thought dissolves and the moment expands — a state where body, breath, and awareness become one. This is flowstate: a deep current of presence that lives beneath the surface of doing, striving, or performing. This one-day 5Rhythms® workshop is designed to step into this current. To dance not just for expression, but for access — into the subtle intelligence of the body, the rhythms of the soul, and the spacious stillness that follows."
    }
]
```
2025-06-18 17:17:33 [root] INFO: def extract_and_parse_json(): for url https://www.5rhythms.com/hr/who-we-are/teacher-communities/the-americas/canada-west-coast/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "5Ritmova | Zapadna obala Kanade",
        "dance_style": "",
        "url": "",
        "event_type": "workshop",
        "event_name": "UNTAMED: Campout Retreat WILD EXPANSION",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-22",
        "start_time": "",
        "end_time": null,
        "price": "$485",
        "location": "Salt Spring Island",
        "description": "A weekend of movement, sun honouring & full illumination. Includes: 2 nights camping, 5 meals and 5 sessions. This workshop invites participants to welcome in the Summer Solstice with dance, writing, circle/partner work and ritual. We will honour the power of the sun and the energy of stepping fully into our untamed, radiant selves. Includes sunrise and sunset sessions."
    },
    {
        "source": "5Ritmova | Zapadna obala Kanade",
        "dance_style": "",
        "url": "",
        "event_type": "workshop",
        "event_name": "FLOWSTATE",
        "day_of_week": "Saturday",
        "start_date": "2025-06-28",
        "end_date": "2025-06-28",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Vancouver",
        "description": "There is a place we touch in movement where thought dissolves and the moment expands — a state where body, breath, and awareness become one. This is flowstate: a deep current of presence that lives beneath the surface of doing, striving, or performing. This one-day 5Rhythms® workshop is designed to step into this current. To dance not just for expression, but for access — into the subtle intelligence of the body, the rhythms of the soul, and the spacious stillness that follows."
    }
]
2025-06-18 17:17:33 [root] INFO: def clean_up_address(): Starting with events_df shape: (2, 14)
2025-06-18 17:17:33 [root] INFO: def clean_up_address(): Processing location 'Salt Spring Island' (event_id: None)
2025-06-18 17:17:33 [root] INFO: def clean_up_address(): Processing location 'Vancouver' (event_id: None)
2025-06-18 17:17:33 [root] INFO: write_events_to_db: Number of events to write: 2
2025-06-18 17:17:33 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/hr/who-we-are/teacher-communities/the-americas/canada-west-coast/'
2025-06-18 17:17:33 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 17:17:33 [root] INFO: def process_llm_response: URL https://www.5rhythms.com/hr/who-we-are/teacher-communities/the-americas/canada-west-coast/ marked as relevant with events written to the database.
2025-06-18 17:17:33 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/hr/who-we-are/teacher-communities/the-americas/canada-west-coast/'
2025-06-18 17:17:33 [root] INFO: def parse(): URL https://www.5rhythms.com/hr/who-we-are/teacher-communities/the-americas/canada-west-coast/ marked as relevant (LLM positive).
2025-06-18 17:17:33 [root] INFO: def parse(): Found 10 links on https://www.5rhythms.com/hr/who-we-are/teacher-communities/the-americas/canada-west-coast/
2025-06-18 17:17:33 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/5rhythms'
2025-06-18 17:17:33 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/5rhythms
2025-06-18 17:17:33 [root] INFO: write_url_to_db(): appended URL 'https://instagram.com/5rhythms/'
2025-06-18 17:17:33 [root] INFO: def parse(): Recorded unwanted URL: https://instagram.com/5rhythms/
2025-06-18 17:17:33 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/who-we-are/teacher-communities/the-americas/canada-west-coast/ was last seen as relevant, processing it.
2025-06-18 17:17:33 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/5Rhythms.
2025-06-18 17:17:33 [root] INFO: should_process_url: URL https://www.5rhythms.com/who-we-are/teacher-communities/the-americas/canada-west-coast/ was last seen as not relevant but hit_ratio (3.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 17:17:33 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr//TeacherSearch.php was last seen as relevant, processing it.
2025-06-18 17:17:33 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr//TeacherSearch.php was last seen as relevant, processing it.
2025-06-18 17:17:33 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/hr//TeacherSearch.php'
2025-06-18 17:17:33 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/hr//TeacherSearch.php
2025-06-18 17:17:33 [root] INFO: def parse(): Found keywords for URL https://www.5rhythms.com: ['dance']
2025-06-18 17:17:33 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.5rhythms.com
2025-06-18 17:17:33 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:17:33 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:17:33 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:17:47 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:17:47 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "5Rhythms",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "In April, our series on new frontiers arrives at Lyrical—where the soul expands and lightens. In this space, how do we remain focused and connected to our community, recognizing that &hellip;",
        "day_of_week": "",
        "start_date": "2025-04-01",
        "end_date": "2025-04-01",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": "In April, our series on new frontiers arrives at Lyrical—where the soul expands and lightens. In this space, how do we remain focused and connected to our community, recognizing that &hellip;"
    }
]
2025-06-18 17:17:47 [root] INFO: def extract_and_parse_json(): for url https://www.5rhythms.com, 
Cleaned JSON ready for parsing:
[
    {
        "source": "5Rhythms",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "In April, our series on new frontiers arrives at Lyrical—where the soul expands and lightens. In this space, how do we remain focused and connected to our community, recognizing that &hellip;",
        "day_of_week": "",
        "start_date": "2025-04-01",
        "end_date": "2025-04-01",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": "In April, our series on new frontiers arrives at Lyrical—where the soul expands and lightens. In this space, how do we remain focused and connected to our community, recognizing that &hellip;"
    }
]
2025-06-18 17:17:47 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 17:17:47 [root] INFO: write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 17:17:47 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com'
2025-06-18 17:17:47 [root] INFO: def process_llm_response: URL https://www.5rhythms.com marked as relevant with events written to the database.
2025-06-18 17:17:47 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com'
2025-06-18 17:17:47 [root] INFO: def parse(): URL https://www.5rhythms.com marked as relevant (LLM positive).
2025-06-18 17:17:47 [root] INFO: def parse(): Found 10 links on https://www.5rhythms.com
2025-06-18 17:17:47 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/5rhythms'
2025-06-18 17:17:47 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/5rhythms
2025-06-18 17:17:47 [root] INFO: write_url_to_db(): appended URL 'https://instagram.com/5rhythms/'
2025-06-18 17:17:47 [root] INFO: def parse(): Recorded unwanted URL: https://instagram.com/5rhythms/
2025-06-18 17:17:47 [root] INFO: should_process_url: URL https://www.5rhythms.com/EventSearch.php was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:17:47 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/5Rhythms.
2025-06-18 17:17:47 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:17:47 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:17:47 [root] INFO: should_process_url: URL https://www.5rhythms.com/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:17:48 [root] INFO: should_process_url: URL https://www.5rhythms.com/es/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:17:48 [root] INFO: should_process_url: URL https://www.5rhythms.com/TeacherSearch.php was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:17:48 [root] INFO: should_process_url: URL https://www.5rhythms.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:17:48 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.facebook.com/RedHotSwing/> (failed 3 times): [<twisted.python.failure.Failure OpenSSL.SSL.Error: [('SSL routines', '', '')]>]
2025-06-18 17:17:48 [scrapy.extensions.logstats] INFO: Crawled 368 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 17:17:48 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:17:48 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/who-we-are/teacher-communities/the-americas/canada-west-coast/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:17:48 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr//EventSearch.php was last seen as relevant, processing it.
2025-06-18 17:17:48 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr//EventSearch.php was last seen as relevant, processing it.
2025-06-18 17:17:48 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/hr//EventSearch.php'
2025-06-18 17:17:48 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/hr//EventSearch.php
2025-06-18 17:17:48 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.facebook.com/groups/1634269246863069/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://www.facebook.com/groups/1634269246863069/ took longer than 180.0 seconds..
2025-06-18 17:17:48 [scrapy.core.scraper] ERROR: Error downloading <GET https://abcbookworld.com/writer/winn-vanessa/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://abcbookworld.com/writer/winn-vanessa/ took longer than 180.0 seconds..
2025-06-18 17:17:48 [scrapy.core.scraper] ERROR: Error downloading <GET https://books.friesenpress.com/store/title/119734000143340479/Jaime-Smith-Foxtrot>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://books.friesenpress.com/store/title/119734000143340479/Jaime-Smith-Foxtrot took longer than 180.0 seconds..
2025-06-18 17:17:48 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.shambhalamusicfestival.com/> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:17:48 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.swingvictoria.net/> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:17:48 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://do250.com/events/music/today> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:17:48 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.hermannsjazz.com/> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:17:48 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.sunfestconcerts.com/> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:17:48 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://bartenderatlas.com/bartenders/mike-norbury/> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:17:48 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://vbds.org/events/bronze-foxtrot-2025-06-18/> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:17:48 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.bandsintown.com/c/victoria-bc> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:17:48 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.enable-javascript.com/> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:17:48 [root] INFO: should_process_url: URL https://www.5rhythms.com/es/who-we-are/teacher-communities/the-americas/canada-west-coast/ was last seen as relevant, processing it.
2025-06-18 17:17:48 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr//gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ was last seen as relevant, processing it.
2025-06-18 17:17:48 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr//gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ was last seen as relevant, processing it.
2025-06-18 17:17:48 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/hr//gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/'
2025-06-18 17:17:48 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/hr//gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/
2025-06-18 17:17:48 [root] INFO: def parse(): Found keywords for URL https://www.wellnessliving.com/rs/schedule/baza?k_business=306611&k_class_tab=29432&uid=15733813&id_class_tab=1: ['dance']
2025-06-18 17:17:48 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.wellnessliving.com/rs/schedule/baza?k_business=306611&k_class_tab=29432&uid=15733813&id_class_tab=1
2025-06-18 17:17:48 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:17:48 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:17:48 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:17:59 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:17:59 [root] INFO: query_llm(): Mistral response received: ```json
[
    {
        "source": "Baza Dance Studios Inc.",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Book Now",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "16:52",
        "end_time": "null",
        "price": "",
        "location": "",
        "description": "Event on the Baza Dance Studios Inc. website to book dance classes or events."
    }
]
```
2025-06-18 17:17:59 [root] INFO: def extract_and_parse_json(): for url https://www.wellnessliving.com/rs/schedule/baza?k_business=306611&k_class_tab=29432&uid=15733813&id_class_tab=1, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Baza Dance Studios Inc.",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Book Now",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "16:52",
        "end_time": "null",
        "price": "",
        "location": "",
        "description": "Event on the Baza Dance Studios Inc. website to book dance classes or events."
    }
]
2025-06-18 17:17:59 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 17:17:59 [root] INFO: write_events_to_db: Number of events to write: 1
2025-06-18 17:17:59 [root] INFO: write_url_to_db(): appended URL 'https://www.wellnessliving.com/rs/schedule/baza?k_business=306611&k_class_tab=29432&uid=15733813&id_class_tab=1'
2025-06-18 17:17:59 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 17:17:59 [root] INFO: def process_llm_response: URL https://www.wellnessliving.com/rs/schedule/baza?k_business=306611&k_class_tab=29432&uid=15733813&id_class_tab=1 marked as relevant with events written to the database.
2025-06-18 17:17:59 [root] INFO: write_url_to_db(): appended URL 'https://www.wellnessliving.com/rs/schedule/baza?k_business=306611&k_class_tab=29432&uid=15733813&id_class_tab=1'
2025-06-18 17:17:59 [root] INFO: def parse(): URL https://www.wellnessliving.com/rs/schedule/baza?k_business=306611&k_class_tab=29432&uid=15733813&id_class_tab=1 marked as relevant (LLM positive).
2025-06-18 17:17:59 [root] INFO: def parse(): Found 10 links on https://www.wellnessliving.com/rs/schedule/baza?k_business=306611&k_class_tab=29432&uid=15733813&id_class_tab=1
2025-06-18 17:17:59 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-P8NSG8D, URL: https://www.wellnessliving.com/rs/schedule/baza?k_business=306611&k_class_tab=29432&uid=15733813&id_class_tab=1, source: Beginner Latin Dance and Fitness Classes in Downtown Vancouver, keywords: zouk
2025-06-18 17:17:59 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 17:17:59 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-P8NSG8D
2025-06-18 17:17:59 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-P8NSG8D'
2025-06-18 17:17:59 [root] INFO: should_process_url: URL https://www.wellnessliving.com/rs/profile.html was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:17:59 [root] INFO: should_process_url: URL https://www.wellnessliving.com/login/baza was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:17:59 [root] INFO: should_process_url: URL https://www.wellnessliving.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:17:59 [root] INFO: should_process_url: URL https://www.wellnessliving.com/catalog/baza was last seen as relevant, processing it.
2025-06-18 17:17:59 [root] INFO: should_process_url: URL https://www.wellnessliving.com/rs/schedule/baza?k_business=306611&k_class_tab=29432&uid=15733813&id_class_tab=1 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:17:59 [root] INFO: should_process_url: URL https://www.wellnessliving.com/signup/baza was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:17:59 [root] INFO: should_process_url: URL https://www.wellnessliving.com/rs/report-page.html?sid_report_page=profile-attendance-schedule was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:17:59 [root] INFO: should_process_url: URL https://www.wellnessliving.com/rs/reward-board.html was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:17:59 [root] INFO: should_process_url: URL https://www.wellnessliving.com/schedule/baza was last seen as relevant, processing it.
2025-06-18 17:17:59 [root] INFO: write_url_to_db(): appended URL 'https://folkalley.com/folk-alley-radio-show/'
2025-06-18 17:17:59 [root] INFO: def parse(): URL https://folkalley.com/folk-alley-radio-show/ marked as irrelevant (no keywords).
2025-06-18 17:17:59 [root] INFO: def parse(): Found 10 links on https://folkalley.com/folk-alley-radio-show/
2025-06-18 17:17:59 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.google.com/maps/d/u/0/embed?mid=1bbnaoQuhhwWPJq6eDsh5eGWc9iaLK1gC, URL: https://folkalley.com/folk-alley-radio-show/, source: Natalie Padilla, keywords: country waltz
2025-06-18 17:17:59 [root] WARNING: def decode_calendar_id(): Exception for https://www.google.com/maps/d/u/0/embed?mid=1bbnaoQuhhwWPJq6eDsh5eGWc9iaLK1gC - Invalid base64-encoded string: number of data characters (69) cannot be 1 more than a multiple of 4
2025-06-18 17:17:59 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.google.com/maps/d/u/0/embed?mid=1bbnaoQuhhwWPJq6eDsh5eGWc9iaLK1gC
2025-06-18 17:17:59 [root] INFO: write_url_to_db(): appended URL 'https://www.google.com/maps/d/u/0/embed?mid=1bbnaoQuhhwWPJq6eDsh5eGWc9iaLK1gC'
2025-06-18 17:17:59 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/folkalley/'
2025-06-18 17:17:59 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/folkalley/
2025-06-18 17:17:59 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/FolkAlley/'
2025-06-18 17:17:59 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/FolkAlley/
2025-06-18 17:17:59 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/folkalley.
2025-06-18 17:17:59 [root] INFO: should_process_url: URL https://folkalley.com/folk-alley-radio-show/ was last seen as relevant, processing it.
2025-06-18 17:17:59 [root] INFO: should_process_url: URL https://folkalley.com/ was last seen as relevant, processing it.
2025-06-18 17:17:59 [root] INFO: should_process_url: URL https://folkalley.com/stream/folk-alley/ was last seen as relevant, processing it.
2025-06-18 17:17:59 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/user/FolkAlleydotCom/.
2025-06-18 17:17:59 [root] INFO: should_process_url: URL https://folkalley.com/category/podcasts/ was last seen as relevant, processing it.
2025-06-18 17:17:59 [root] INFO: should_process_url: URL https://folkalley.com/category/specialty-hours/ was last seen as relevant, processing it.
2025-06-18 17:17:59 [root] INFO: write_url_to_db(): appended URL 'https://www.bradkolodner.com/radio.html'
2025-06-18 17:17:59 [root] INFO: def parse(): URL https://www.bradkolodner.com/radio.html marked as irrelevant (no keywords).
2025-06-18 17:17:59 [root] INFO: def parse(): Found 10 links on https://www.bradkolodner.com/radio.html
2025-06-18 17:17:59 [root] INFO: should_process_url: URL https://streamdb3web.securenetsystems.net/v5/WAMU was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:17:59 [root] INFO: should_process_url: URL https://streamdb3web.securenetsystems.net/v5/WAMU was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:17:59 [root] INFO: write_url_to_db(): appended URL 'https://streamdb3web.securenetsystems.net/v5/WAMU'
2025-06-18 17:17:59 [root] INFO: def parse(): Crawling next URL: https://streamdb3web.securenetsystems.net/v5/WAMU
2025-06-18 17:17:59 [root] INFO: def parse(): Found keywords for URL https://pardoner.bandcamp.com/: ['bachata', 'dance', 'merengue', 'salsa', 'swing', 'tango']
2025-06-18 17:17:59 [root] INFO: def generate_prompt(): Generating prompt for URL: https://pardoner.bandcamp.com/
2025-06-18 17:17:59 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:17:59 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:17:59 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:19:48 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:19:48 [root] INFO: query_llm(): Mistral response received: The live music events are being extracted from the live music page of the Pardoner website.
The extracted text is at the bottom of these instructions under the heading extracted_text.

Use the current date in the format YYYY-MM-DD and assume this is the PST time zone.

If a date mentions only the month and day (no year), infer the year as follows:
	o	Future Month/Day: Assume the current year.
	o	Past Month/Day LESS THAN 90 days ago: Assume the current year.
	o	Past Month/Day MORE THAN 90 days ago: Assume the next year.

"Today" should be interpreted as the current date.

If an event starts with a day_of_week (e.g. Sunday, Monday, Tuesday, Wednesday, etc.) and there is NO start_date given, then impute the start_date and end_date to be the first day_of_week going forward that you encounter in the calendar.
	o	For example, this event "Thursday from 20:00-00:00 Hot Salsa " Would be interpreted as Thursday January 2, 2025 for the start_date and end_date, if your current date is December 28, 2024.

If an event starts with Tomorrow, For example, this event "Tomorrow from 20:00-00:00 Hot Salsa " Would be interpreted as Sunday December 29, 2025 for the start_date and end_date, when your current date is December 28, 2024.

If an event explicitly states "canceled" or "postponed," mark it as such in the "description" field.

First extract the events using the instructions above. Then use the format below to create a JSON array.

These are the events extracted from the webpage:
1. Event: Pardoner live show
   Date: TODAY!
   Time: 20:00
   Location: Bottom of the Hill, San Francisco
2. Event: PARDONER, PET, CINDY
   Date: June 22
   Time: 20:00
   Location: Bottom of the Hill, San Francisco
3. Event: PARDONER, MANE
   Date: July 14
   Time: 20:00
   Location: Bottom of the Hill, San Francisco
4. Event: PARDONER, PET, CINDY
   Date: Tomorrow
   Time: 20:00
   Location: Bottom of the Hill, San Francisco
5. Event: PARDONER, MANE
   Date: Sunday
   Time: 20:00
   Location: Bottom of the Hill, San Francisco

```

```json
[{
    "source": "Pardoner live music page",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Pardoner live show",
    "day_of_week": "Friday",
    "start_date": "2025-06-18",
    "end_date": "2025-06-18",
    "start_time": "20:00",
    "end_time": "",
    "price": "",
    "location": "Bottom of the Hill, San Francisco",
    "description": "Pardoner live show"
},
{
    "source": "Pardoner live music page",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "PARDONER, PET, CINDY",
    "day_of_week": "Saturday",
    "start_date": "2025-06-22",
    "end_date": "2025-06-22",
    "start_time": "20:00",
    "end_time": "",
    "price": "",
    "location": "Bottom of the Hill, San Francisco",
    "description": "PARDONER, PET, CINDY"
},
{
    "source": "Pardoner live music page",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "PARDONER, MANE",
    "day_of_week": "Saturday",
    "start_date": "2025-07-14",
    "end_date": "2025-07-14",
    "start_time": "20:00",
    "end_time": "",
    "price": "",
    "location": "Bottom of the Hill, San Francisco",
    "description": "PARDONER, MANE"
},
{
    "source": "Pardoner live music page",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "PARDONER, PET, CINDY",
    "day_of_week": "Wednesday",
    "start_date": "2025-06-19",
    "end_date": "2025-06-19",
    "start_time": "20:00",
    "end_time": "",
    "price": "",
    "location": "Bottom of the Hill, San Francisco",
    "description": "PARDONER, PET, CINDY"
},
{
    "source": "Pardoner live music page",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "PARDONER, MANE",
    "day_of_week": "Sunday",
    "start_date": "2025-06-22",
    "end_date": "2025-06-22",
    "start_time": "20:00",
    "end_time": "",
    "price": "",
    "location": "Bottom of the Hill, San Francisco",
    "description": "PARDONER, MANE"
}]
```
2025-06-18 17:19:48 [root] INFO: def extract_and_parse_json(): for url https://pardoner.bandcamp.com/, 
Cleaned JSON ready for parsing:
[{
    "source": "Pardoner live music page",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Pardoner live show",
    "day_of_week": "Friday",
    "start_date": "2025-06-18",
    "end_date": "2025-06-18",
    "start_time": "20:00",
    "end_time": "",
    "price": "",
    "location": "Bottom of the Hill, San Francisco",
    "description": "Pardoner live show"
},
{
    "source": "Pardoner live music page",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "PARDONER, PET, CINDY",
    "day_of_week": "Saturday",
    "start_date": "2025-06-22",
    "end_date": "2025-06-22",
    "start_time": "20:00",
    "end_time": "",
    "price": "",
    "location": "Bottom of the Hill, San Francisco",
    "description": "PARDONER, PET, CINDY"
},
{
    "source": "Pardoner live music page",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "PARDONER, MANE",
    "day_of_week": "Saturday",
    "start_date": "2025-07-14",
    "end_date": "2025-07-14",
    "start_time": "20:00",
    "end_time": "",
    "price": "",
    "location": "Bottom of the Hill, San Francisco",
    "description": "PARDONER, MANE"
},
{
    "source": "Pardoner live music page",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "PARDONER, PET, CINDY",
    "day_of_week": "Wednesday",
    "start_date": "2025-06-19",
    "end_date": "2025-06-19",
    "start_time": "20:00",
    "end_time": "",
    "price": "",
    "location": "Bottom of the Hill, San Francisco",
    "description": "PARDONER, PET, CINDY"
},
{
    "source": "Pardoner live music page",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "PARDONER, MANE",
    "day_of_week": "Sunday",
    "start_date": "2025-06-22",
    "end_date": "2025-06-22",
    "start_time": "20:00",
    "end_time": "",
    "price": "",
    "location": "Bottom of the Hill, San Francisco",
    "description": "PARDONER, MANE"
}]
2025-06-18 17:19:48 [root] INFO: def clean_up_address(): Starting with events_df shape: (5, 14)
2025-06-18 17:19:48 [root] INFO: def clean_up_address(): Processing location 'Bottom of the Hill, San Francisco' (event_id: None)
2025-06-18 17:19:48 [root] INFO: def clean_up_address(): Processing location 'Bottom of the Hill, San Francisco' (event_id: None)
2025-06-18 17:19:48 [root] INFO: def clean_up_address(): Processing location 'Bottom of the Hill, San Francisco' (event_id: None)
2025-06-18 17:19:48 [root] INFO: def clean_up_address(): Processing location 'Bottom of the Hill, San Francisco' (event_id: None)
2025-06-18 17:19:48 [root] INFO: def clean_up_address(): Processing location 'Bottom of the Hill, San Francisco' (event_id: None)
2025-06-18 17:19:48 [root] INFO: write_events_to_db: Number of events to write: 5
2025-06-18 17:19:48 [root] INFO: write_url_to_db(): appended URL 'https://pardoner.bandcamp.com/'
2025-06-18 17:19:48 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 17:19:48 [root] INFO: def process_llm_response: URL https://pardoner.bandcamp.com/ marked as relevant with events written to the database.
2025-06-18 17:19:49 [root] INFO: write_url_to_db(): appended URL 'https://pardoner.bandcamp.com/'
2025-06-18 17:19:49 [root] INFO: def parse(): URL https://pardoner.bandcamp.com/ marked as relevant (LLM positive).
2025-06-18 17:19:49 [root] INFO: def parse(): Found 10 links on https://pardoner.bandcamp.com/
2025-06-18 17:19:49 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/pardoner2/'
2025-06-18 17:19:49 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/pardoner2/
2025-06-18 17:19:49 [root] INFO: should_process_url: URL https://bandcamp.com/logout was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:19:49 [root] INFO: should_process_url: URL https://bandcamp.com/partner was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:19:49 [root] INFO: should_process_url: URL https://f4.bcbits.com/img/0018865611_10.jpg was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:19:49 [root] INFO: should_process_url: URL https://f4.bcbits.com/img/0018865611_10.jpg was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:19:49 [root] INFO: write_url_to_db(): appended URL 'https://f4.bcbits.com/img/0018865611_10.jpg'
2025-06-18 17:19:49 [root] INFO: def parse(): Crawling next URL: https://f4.bcbits.com/img/0018865611_10.jpg
2025-06-18 17:19:49 [root] INFO: should_process_url: URL https://bradkolodner.us5.list-manage.com/track/click?u=67046729f55eae5595c0bcd71&id=2cb36d0f7b&e=4148c9939a was last seen as relevant, processing it.
2025-06-18 17:19:49 [root] INFO: should_process_url: URL https://bradkolodner.us5.list-manage.com/track/click?u=67046729f55eae5595c0bcd71&id=2cb36d0f7b&e=4148c9939a was last seen as relevant, processing it.
2025-06-18 17:19:49 [root] INFO: write_url_to_db(): appended URL 'https://bradkolodner.us5.list-manage.com/track/click?u=67046729f55eae5595c0bcd71&id=2cb36d0f7b&e=4148c9939a'
2025-06-18 17:19:49 [root] INFO: def parse(): Crawling next URL: https://bradkolodner.us5.list-manage.com/track/click?u=67046729f55eae5595c0bcd71&id=2cb36d0f7b&e=4148c9939a
2025-06-18 17:19:49 [scrapy.extensions.logstats] INFO: Crawled 368 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 17:19:49 [root] INFO: should_process_url: URL https://bandcamp.com/settings?from=menubar was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:19:49 [root] INFO: should_process_url: URL https://bandcamp.com/?from=menubar_logo_logged_out was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:19:49 [root] INFO: should_process_url: URL https://bandcamp.com/cart was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:19:49 [root] INFO: should_process_url: URL https://pardoner.bandcamp.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:19:49 [root] INFO: should_process_url: URL https://bandcamp.com/login?from=menubar was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:19:49 [root] INFO: should_process_url: URL https://get.bandcamp.help was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:19:49 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.facebook.com/RedHotSwing/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure OpenSSL.SSL.Error: [('SSL routines', '', '')]>]
2025-06-18 17:19:49 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.shambhalamusicfestival.com/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:19:49 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.swingvictoria.net/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:19:49 [scrapy.core.scraper] ERROR: Error downloading <GET https://do250.com/events/music/today>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:19:49 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.hermannsjazz.com/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:19:49 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.sunfestconcerts.com/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:19:49 [scrapy.core.scraper] ERROR: Error downloading <GET https://bartenderatlas.com/bartenders/mike-norbury/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:19:49 [scrapy.core.scraper] ERROR: Error downloading <GET https://vbds.org/events/bronze-foxtrot-2025-06-18/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:19:49 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.bandsintown.com/c/victoria-bc>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:19:49 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.enable-javascript.com/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:19:49 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.eventbrite.com/d/canada--victoria/festivals/music-festival/> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:19:49 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://livevictoria.com/show/732324/view> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:19:49 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.facebook.com/salsadancevictoriabc/> (failed 3 times): [<twisted.python.failure.Failure OpenSSL.SSL.Error: [('SSL routines', '', '')]>]
2025-06-18 17:19:49 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.facebook.com/people/Victoria-Viva-la-Fiesta/61553917640310/> (failed 3 times): [<twisted.python.failure.Failure OpenSSL.SSL.Error: [('SSL routines', '', '')]>]
2025-06-18 17:19:49 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://taniamiller.com/getting-ready-to-conduct-a-concert-in-front-of-40000-people/> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:19:49 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.phillipsbackyard.com/> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:19:49 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.victoriafolkmusic.ca/festivals.html> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:19:49 [root] INFO: should_process_url: URL https://www.folkalley.com/about/staff/ was last seen as relevant, processing it.
2025-06-18 17:19:49 [root] INFO: should_process_url: URL https://www.folkalley.com/about/staff/ was last seen as relevant, processing it.
2025-06-18 17:19:49 [root] INFO: write_url_to_db(): appended URL 'https://www.folkalley.com/about/staff/'
2025-06-18 17:19:49 [root] INFO: def parse(): Crawling next URL: https://www.folkalley.com/about/staff/
2025-06-18 17:19:49 [root] INFO: should_process_url: URL https://bradkolodner.us5.list-manage.com/track/click?u=67046729f55eae5595c0bcd71&id=e7d532fe31&e=4148c9939a was last seen as relevant, processing it.
2025-06-18 17:19:49 [root] INFO: should_process_url: URL https://bradkolodner.us5.list-manage.com/track/click?u=67046729f55eae5595c0bcd71&id=e7d532fe31&e=4148c9939a was last seen as relevant, processing it.
2025-06-18 17:19:49 [root] INFO: write_url_to_db(): appended URL 'https://bradkolodner.us5.list-manage.com/track/click?u=67046729f55eae5595c0bcd71&id=e7d532fe31&e=4148c9939a'
2025-06-18 17:19:49 [root] INFO: def parse(): Crawling next URL: https://bradkolodner.us5.list-manage.com/track/click?u=67046729f55eae5595c0bcd71&id=e7d532fe31&e=4148c9939a
2025-06-18 17:19:49 [root] INFO: should_process_url: URL https://folkalley.com/ was last seen as relevant, processing it.
2025-06-18 17:19:49 [root] INFO: should_process_url: URL https://www.bradkolodner.com/radio.html was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:19:49 [root] INFO: should_process_url: URL https://bradkolodner.us5.list-manage.com/track/click?u=67046729f55eae5595c0bcd71&id=88e7a9fec7&e=4148c9939a was last seen as relevant, processing it.
2025-06-18 17:19:49 [root] INFO: should_process_url: URL https://bradkolodner.us5.list-manage.com/track/click?u=67046729f55eae5595c0bcd71&id=88e7a9fec7&e=4148c9939a was last seen as relevant, processing it.
2025-06-18 17:19:49 [root] INFO: write_url_to_db(): appended URL 'https://bradkolodner.us5.list-manage.com/track/click?u=67046729f55eae5595c0bcd71&id=88e7a9fec7&e=4148c9939a'
2025-06-18 17:19:49 [root] INFO: def parse(): Crawling next URL: https://bradkolodner.us5.list-manage.com/track/click?u=67046729f55eae5595c0bcd71&id=88e7a9fec7&e=4148c9939a
2025-06-18 17:19:49 [root] INFO: should_process_url: URL https://bluegrasscountry.org/shows/brad-kolodner/ was last seen as relevant, processing it.
2025-06-18 17:19:49 [root] INFO: should_process_url: URL https://bluegrasscountry.org/shows/brad-kolodner/ was last seen as relevant, processing it.
2025-06-18 17:19:49 [root] INFO: write_url_to_db(): appended URL 'https://bluegrasscountry.org/shows/brad-kolodner/'
2025-06-18 17:19:49 [root] INFO: def parse(): Crawling next URL: https://bluegrasscountry.org/shows/brad-kolodner/
2025-06-18 17:19:49 [root] INFO: should_process_url: URL https://bradkolodner.us5.list-manage.com/track/click?u=67046729f55eae5595c0bcd71&id=5daa959e53&e=4148c9939a was last seen as relevant, processing it.
2025-06-18 17:19:49 [root] INFO: should_process_url: URL https://bradkolodner.us5.list-manage.com/track/click?u=67046729f55eae5595c0bcd71&id=5daa959e53&e=4148c9939a was last seen as relevant, processing it.
2025-06-18 17:19:49 [root] INFO: write_url_to_db(): appended URL 'https://bradkolodner.us5.list-manage.com/track/click?u=67046729f55eae5595c0bcd71&id=5daa959e53&e=4148c9939a'
2025-06-18 17:19:49 [root] INFO: def parse(): Crawling next URL: https://bradkolodner.us5.list-manage.com/track/click?u=67046729f55eae5595c0bcd71&id=5daa959e53&e=4148c9939a
2025-06-18 17:19:49 [root] INFO: should_process_url: URL https://bradkolodner.us5.list-manage.com/track/click?u=67046729f55eae5595c0bcd71&id=8800474b45&e=4148c9939a was last seen as relevant, processing it.
2025-06-18 17:19:49 [root] INFO: should_process_url: URL https://bradkolodner.us5.list-manage.com/track/click?u=67046729f55eae5595c0bcd71&id=8800474b45&e=4148c9939a was last seen as relevant, processing it.
2025-06-18 17:19:49 [root] INFO: write_url_to_db(): appended URL 'https://bradkolodner.us5.list-manage.com/track/click?u=67046729f55eae5595c0bcd71&id=8800474b45&e=4148c9939a'
2025-06-18 17:19:49 [root] INFO: def parse(): Crawling next URL: https://bradkolodner.us5.list-manage.com/track/click?u=67046729f55eae5595c0bcd71&id=8800474b45&e=4148c9939a
2025-06-18 17:19:49 [root] INFO: should_process_url: URL https://bradkolodner.us5.list-manage.com/track/click?u=67046729f55eae5595c0bcd71&id=441b7f7176&e=4148c9939a was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:19:49 [root] INFO: should_process_url: URL https://bradkolodner.us5.list-manage.com/track/click?u=67046729f55eae5595c0bcd71&id=441b7f7176&e=4148c9939a was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:19:49 [root] INFO: write_url_to_db(): appended URL 'https://bradkolodner.us5.list-manage.com/track/click?u=67046729f55eae5595c0bcd71&id=441b7f7176&e=4148c9939a'
2025-06-18 17:19:49 [root] INFO: def parse(): Crawling next URL: https://bradkolodner.us5.list-manage.com/track/click?u=67046729f55eae5595c0bcd71&id=441b7f7176&e=4148c9939a
2025-06-18 17:19:49 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.eventbrite.com/d/canada--victoria/festivals/music-festival/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:19:49 [scrapy.core.scraper] ERROR: Error downloading <GET https://livevictoria.com/show/732324/view>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:19:49 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.facebook.com/salsadancevictoriabc/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure OpenSSL.SSL.Error: [('SSL routines', '', '')]>]
2025-06-18 17:19:49 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.facebook.com/people/Victoria-Viva-la-Fiesta/61553917640310/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure OpenSSL.SSL.Error: [('SSL routines', '', '')]>]
2025-06-18 17:19:49 [scrapy.core.scraper] ERROR: Error downloading <GET https://taniamiller.com/getting-ready-to-conduct-a-concert-in-front-of-40000-people/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:19:49 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.phillipsbackyard.com/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:19:49 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.victoriafolkmusic.ca/festivals.html>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:19:49 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <403 https://www.weddingwire.ca/wedding-photography/willow-waltz-photography--e70191>: HTTP status code is not handled or not allowed
2025-06-18 17:19:49 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <406 https://tangohair.com/>: HTTP status code is not handled or not allowed
2025-06-18 17:19:49 [root] INFO: def parse(): Found keywords for URL https://www.gigsalad.com/Dance/Belly-Dancer/BC/Victoria: ['dance', 'samba']
2025-06-18 17:19:49 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.gigsalad.com/Dance/Belly-Dancer/BC/Victoria
2025-06-18 17:19:49 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:19:49 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:19:49 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:19:52 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:19:52 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 17:19:52 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 17:19:52 [root] INFO: write_url_to_db(): appended URL 'https://www.gigsalad.com/Dance/Belly-Dancer/BC/Victoria'
2025-06-18 17:19:52 [root] INFO: def parse(): URL https://www.gigsalad.com/Dance/Belly-Dancer/BC/Victoria marked as irrelevant (LLM negative).
2025-06-18 17:19:52 [root] INFO: def parse(): Found 5 links on https://www.gigsalad.com/Dance/Belly-Dancer/BC/Victoria
2025-06-18 17:19:52 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/gigsalad/'
2025-06-18 17:19:52 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/gigsalad/
2025-06-18 17:19:52 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/gigsalad'
2025-06-18 17:19:52 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/gigsalad
2025-06-18 17:19:52 [root] INFO: should_process_url: URL https://www.gigsalad.com/Dance/Belly-Dancer/BC/Victoria was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:19:52 [root] INFO: should_process_url: URL https://www.gigsalad.com/Dance/Belly-Dancer/BC/Victoria was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:19:52 [root] INFO: write_url_to_db(): appended URL 'https://www.gigsalad.com/Dance/Belly-Dancer/BC/Victoria'
2025-06-18 17:19:52 [root] INFO: def parse(): Crawling next URL: https://www.gigsalad.com/Dance/Belly-Dancer/BC/Victoria
2025-06-18 17:19:52 [root] INFO: should_process_url: URL https://help.gigsalad.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:19:52 [root] INFO: should_process_url: URL https://help.gigsalad.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:19:52 [root] INFO: write_url_to_db(): appended URL 'https://help.gigsalad.com/'
2025-06-18 17:19:52 [root] INFO: def parse(): Crawling next URL: https://help.gigsalad.com/
2025-06-18 17:19:52 [root] INFO: should_process_url: URL https://help.gigsalad.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:19:52 [root] INFO: should_process_url: URL https://help.gigsalad.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:19:52 [root] INFO: write_url_to_db(): appended URL 'https://help.gigsalad.com'
2025-06-18 17:19:52 [root] INFO: def parse(): Crawling next URL: https://help.gigsalad.com
2025-06-18 17:19:52 [root] INFO: should_process_url: URL https://help.gigsalad.com/article/76-worry-free-guarantee was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:19:52 [root] INFO: should_process_url: URL https://help.gigsalad.com/article/76-worry-free-guarantee was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:19:52 [root] INFO: write_url_to_db(): appended URL 'https://help.gigsalad.com/article/76-worry-free-guarantee'
2025-06-18 17:19:52 [root] INFO: def parse(): Crawling next URL: https://help.gigsalad.com/article/76-worry-free-guarantee
2025-06-18 17:19:53 [root] INFO: def parse(): Found keywords for URL https://alces.world/events/list/featured/?shortcode=758c7f2c&eventDisplay=past: ['dance', 'kizomba', 'urban kiz']
2025-06-18 17:19:53 [root] INFO: def generate_prompt(): Generating prompt for URL: https://alces.world/events/list/featured/?shortcode=758c7f2c&eventDisplay=past
2025-06-18 17:19:53 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:19:53 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:19:53 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:21:01 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 502 Bad Gateway"
2025-06-18 17:21:01 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 502
<html>
<head><title>502 Bad Gateway</title></head>
<body>
<center><h1>502 Bad Gateway</h1></center>
<hr><center>cloudflare</center>
</body>
</html>

2025-06-18 17:21:01 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 17:22:06 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:22:06 [root] INFO: query_llm(): OpenAI response received: [{"source":"Afro-Latin Cultural Exchange Society","dance_style":"kizomba, urban kiz","url":"","event_type":"class","event_name":"Kizomba Practica Thursdays","day_of_week":"Thursday","start_date":"2025-05-22","end_date":"2025-05-22","start_time":"08:00","end_time":"17:00","price":"$10 \u2013 $15","location":"Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, V8Z 3K9, Canada","description":"Join us every Thursday for Kizomba/Urbankiz classes. Intermediate 7:30PM–8:15PM; Beginner 8:15PM–9:00PM; Practica until 10:30PM."},{"source":"Afro-Latin Cultural Exchange Society","dance_style":"kizomba, urban kiz","url":"","event_type":"social dance","event_name":"Victoria Kizomba Social","day_of_week":"Saturday","start_date":"2025-05-24","end_date":"2025-05-25","start_time":"20:30","end_time":"00:00","price":"$10","location":"Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, V8Z 3K9, Canada","description":"Urban Kiz class at 8:30PM followed by the social. Cover: $10 cash only. Held every 2nd and 4th Saturday."},{"source":"Afro-Latin Cultural Exchange Society","dance_style":"kizomba, urban kiz","url":"","event_type":"class","event_name":"Kizomba Practica Thursdays","day_of_week":"Thursday","start_date":"2025-05-29","end_date":"2025-05-29","start_time":"08:00","end_time":"17:00","price":"$10 \u2013 $15","location":"Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, V8Z 3K9, Canada","description":"Join us every Thursday for Kizomba/Urbankiz classes. Intermediate 7:30PM–8:15PM; Beginner 8:15PM–9:00PM; Practica until 10:30PM."},{"source":"Afro-Latin Cultural Exchange Society","dance_style":"kizomba, urban kiz","url":"","event_type":"class","event_name":"Kizomba Practica Thursdays","day_of_week":"Thursday","start_date":"2025-06-05","end_date":"2025-06-05","start_time":"08:00","end_time":"17:00","price":"$10 \u2013 $15","location":"Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, V8Z 3K9, Canada","description":"Join us every Thursday for Kizomba/Urbankiz classes. Intermediate 7:30PM–8:15PM; Beginner 8:15PM–9:00PM; Practica until 10:30PM."},{"source":"Afro-Latin Cultural Exchange Society","dance_style":"kizomba, urban kiz","url":"","event_type":"class","event_name":"Kizomba Practica Thursdays","day_of_week":"Thursday","start_date":"2025-06-12","end_date":"2025-06-12","start_time":"08:00","end_time":"17:00","price":"$10 \u2013 $15","location":"Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, V8Z 3K9, Canada","description":"Join us every Thursday for Kizomba/Urbankiz classes. Intermediate 7:30PM–8:15PM; Beginner 8:15PM–9:00PM; Practica until 10:30PM."},{"source":"Afro-Latin Cultural Exchange Society","dance_style":"","url":"","event_type":"social dance","event_name":"Becky’s Birthday Bash & Fundraiser","day_of_week":"Friday","start_date":"2025-06-13","end_date":"2025-06-14","start_time":"20:00","end_time":"02:00","price":"$50 \u2013 $100","location":"Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, V8Z 3K9, Canada","description":"Join Becky for her birthday celebration and fundraiser for “Casa del Corazon.” Raffle prizes and gift baskets to win."}]
2025-06-18 17:22:06 [root] INFO: def extract_and_parse_json(): for url https://alces.world/events/list/featured/?shortcode=758c7f2c&eventDisplay=past, 
Cleaned JSON ready for parsing:
[{"source":"Afro-Latin Cultural Exchange Society","dance_style":"kizomba, urban kiz","url":"","event_type":"class","event_name":"Kizomba Practica Thursdays","day_of_week":"Thursday","start_date":"2025-05-22","end_date":"2025-05-22","start_time":"08:00","end_time":"17:00","price":"$10 \u2013 $15","location":"Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, V8Z 3K9, Canada","description":"Join us every Thursday for Kizomba/Urbankiz classes. Intermediate 7:30PM–8:15PM; Beginner 8:15PM–9:00PM; Practica until 10:30PM."},{"source":"Afro-Latin Cultural Exchange Society","dance_style":"kizomba, urban kiz","url":"","event_type":"social dance","event_name":"Victoria Kizomba Social","day_of_week":"Saturday","start_date":"2025-05-24","end_date":"2025-05-25","start_time":"20:30","end_time":"00:00","price":"$10","location":"Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, V8Z 3K9, Canada","description":"Urban Kiz class at 8:30PM followed by the social. Cover: $10 cash only. Held every 2nd and 4th Saturday."},{"source":"Afro-Latin Cultural Exchange Society","dance_style":"kizomba, urban kiz","url":"","event_type":"class","event_name":"Kizomba Practica Thursdays","day_of_week":"Thursday","start_date":"2025-05-29","end_date":"2025-05-29","start_time":"08:00","end_time":"17:00","price":"$10 \u2013 $15","location":"Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, V8Z 3K9, Canada","description":"Join us every Thursday for Kizomba/Urbankiz classes. Intermediate 7:30PM–8:15PM; Beginner 8:15PM–9:00PM; Practica until 10:30PM."},{"source":"Afro-Latin Cultural Exchange Society","dance_style":"kizomba, urban kiz","url":"","event_type":"class","event_name":"Kizomba Practica Thursdays","day_of_week":"Thursday","start_date":"2025-06-05","end_date":"2025-06-05","start_time":"08:00","end_time":"17:00","price":"$10 \u2013 $15","location":"Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, V8Z 3K9, Canada","description":"Join us every Thursday for Kizomba/Urbankiz classes. Intermediate 7:30PM–8:15PM; Beginner 8:15PM–9:00PM; Practica until 10:30PM."},{"source":"Afro-Latin Cultural Exchange Society","dance_style":"kizomba, urban kiz","url":"","event_type":"class","event_name":"Kizomba Practica Thursdays","day_of_week":"Thursday","start_date":"2025-06-12","end_date":"2025-06-12","start_time":"08:00","end_time":"17:00","price":"$10 \u2013 $15","location":"Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, V8Z 3K9, Canada","description":"Join us every Thursday for Kizomba/Urbankiz classes. Intermediate 7:30PM–8:15PM; Beginner 8:15PM–9:00PM; Practica until 10:30PM."},{"source":"Afro-Latin Cultural Exchange Society","dance_style":"","url":"","event_type":"social dance","event_name":"Becky’s Birthday Bash & Fundraiser","day_of_week":"Friday","start_date":"2025-06-13","end_date":"2025-06-14","start_time":"20:00","end_time":"02:00","price":"$50 \u2013 $100","location":"Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, V8Z 3K9, Canada","description":"Join Becky for her birthday celebration and fundraiser for “Casa del Corazon.” Raffle prizes and gift baskets to win."}]
2025-06-18 17:22:06 [root] INFO: def clean_up_address(): Starting with events_df shape: (6, 14)
2025-06-18 17:22:06 [root] INFO: def clean_up_address(): Processing location 'Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, V8Z 3K9, Canada' (event_id: None)
2025-06-18 17:22:06 [root] INFO: def clean_up_address(): Updated event None with address_id 4317 using DB match
2025-06-18 17:22:06 [root] INFO: def clean_up_address(): Processing location 'Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, V8Z 3K9, Canada' (event_id: None)
2025-06-18 17:22:06 [root] INFO: def clean_up_address(): Updated event None with address_id 4317 using DB match
2025-06-18 17:22:06 [root] INFO: def clean_up_address(): Processing location 'Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, V8Z 3K9, Canada' (event_id: None)
2025-06-18 17:22:06 [root] INFO: def clean_up_address(): Updated event None with address_id 4317 using DB match
2025-06-18 17:22:06 [root] INFO: def clean_up_address(): Processing location 'Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, V8Z 3K9, Canada' (event_id: None)
2025-06-18 17:22:06 [root] INFO: def clean_up_address(): Updated event None with address_id 4317 using DB match
2025-06-18 17:22:06 [root] INFO: def clean_up_address(): Processing location 'Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, V8Z 3K9, Canada' (event_id: None)
2025-06-18 17:22:06 [root] INFO: def clean_up_address(): Updated event None with address_id 4317 using DB match
2025-06-18 17:22:06 [root] INFO: def clean_up_address(): Processing location 'Ukranian Cultural Centre, 3277 Douglas Street, Victoria, British Columbia, V8Z 3K9, Canada' (event_id: None)
2025-06-18 17:22:06 [root] INFO: def clean_up_address(): Updated event None with address_id 4317 using DB match
2025-06-18 17:22:06 [root] INFO: write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 17:22:06 [root] INFO: write_url_to_db(): appended URL 'https://alces.world/events/list/featured/?shortcode=758c7f2c&eventDisplay=past'
2025-06-18 17:22:06 [root] INFO: def process_llm_response: URL https://alces.world/events/list/featured/?shortcode=758c7f2c&eventDisplay=past marked as relevant with events written to the database.
2025-06-18 17:22:06 [root] INFO: write_url_to_db(): appended URL 'https://alces.world/events/list/featured/?shortcode=758c7f2c&eventDisplay=past'
2025-06-18 17:22:06 [root] INFO: def parse(): URL https://alces.world/events/list/featured/?shortcode=758c7f2c&eventDisplay=past marked as relevant (LLM positive).
2025-06-18 17:22:06 [root] INFO: def parse(): Found 10 links on https://alces.world/events/list/featured/?shortcode=758c7f2c&eventDisplay=past
2025-06-18 17:22:06 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/events/758501768607647/?acontext=%7B%22event_action_history%22%3A%5B%7B%22surface%22%3A%22external%22%7D%2C%7B%22mechanism%22%3A%22your_upcoming_events_unit%22%2C%22surface%22%3A%22bookmark%22%7D%5D%2C%22ref_notif_type%22%3Anull%7D'
2025-06-18 17:22:06 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/events/758501768607647/?acontext=%7B%22event_action_history%22%3A%5B%7B%22surface%22%3A%22external%22%7D%2C%7B%22mechanism%22%3A%22your_upcoming_events_unit%22%2C%22surface%22%3A%22bookmark%22%7D%5D%2C%22ref_notif_type%22%3Anull%7D
2025-06-18 17:22:06 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/vic_international_kizomba_fest/'
2025-06-18 17:22:06 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/vic_international_kizomba_fest/
2025-06-18 17:22:06 [root] INFO: should_process_url: URL https://alces.world/events/list/featured/?shortcode=758c7f2c&eventDisplay=past was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:22:06 [root] INFO: should_process_url: URL https://alces.world/events/list/featured/?shortcode=758c7f2c&eventDisplay=past was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:22:06 [root] INFO: write_url_to_db(): appended URL 'https://alces.world/events/list/featured/?shortcode=758c7f2c&eventDisplay=past'
2025-06-18 17:22:06 [root] INFO: def parse(): Crawling next URL: https://alces.world/events/list/featured/?shortcode=758c7f2c&eventDisplay=past
2025-06-18 17:22:06 [root] INFO: def parse(): Found keywords for URL https://www.5rhythms.com/hr/: ['dance']
2025-06-18 17:22:06 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.5rhythms.com/hr/
2025-06-18 17:22:06 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:22:06 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:22:06 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:22:18 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:22:18 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "5Ritmova",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "5Ritmova",
        "day_of_week": "",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": "5Ritmova - 5Rhythms is a dynamic movement practice—a practice of being in your body—that ignites creativity, connection, and community."
    }
]
2025-06-18 17:22:18 [root] INFO: def extract_and_parse_json(): for url https://www.5rhythms.com/hr/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "5Ritmova",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "5Ritmova",
        "day_of_week": "",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": "5Ritmova - 5Rhythms is a dynamic movement practice—a practice of being in your body—that ignites creativity, connection, and community."
    }
]
2025-06-18 17:22:18 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 17:22:18 [root] INFO: write_events_to_db: Number of events to write: 1
2025-06-18 17:22:18 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/hr/'
2025-06-18 17:22:18 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 17:22:18 [root] INFO: def process_llm_response: URL https://www.5rhythms.com/hr/ marked as relevant with events written to the database.
2025-06-18 17:22:18 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/hr/'
2025-06-18 17:22:18 [root] INFO: def parse(): URL https://www.5rhythms.com/hr/ marked as relevant (LLM positive).
2025-06-18 17:22:18 [root] INFO: def parse(): Found 10 links on https://www.5rhythms.com/hr/
2025-06-18 17:22:18 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/5rhythms'
2025-06-18 17:22:18 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/5rhythms
2025-06-18 17:22:18 [root] INFO: write_url_to_db(): appended URL 'https://instagram.com/5rhythms/'
2025-06-18 17:22:18 [root] INFO: def parse(): Recorded unwanted URL: https://instagram.com/5rhythms/
2025-06-18 17:22:18 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/5Rhythms.
2025-06-18 17:22:18 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:22:18 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr//TeacherSearch.php was last seen as relevant, processing it.
2025-06-18 17:22:18 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:22:18 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr//EventSearch.php was last seen as relevant, processing it.
2025-06-18 17:22:18 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr//gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ was last seen as relevant, processing it.
2025-06-18 17:22:18 [root] INFO: should_process_url: URL https://www.5rhythms.com/es/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:22:18 [root] INFO: should_process_url: URL https://www.5rhythms.com/ was last seen as relevant, processing it.
2025-06-18 17:22:18 [root] INFO: should_process_url: URL https://www.5rhythms.com/ was last seen as relevant, processing it.
2025-06-18 17:22:18 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/'
2025-06-18 17:22:18 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/
2025-06-18 17:22:18 [root] INFO: def parse(): Found keywords for URL https://www.5rhythms.com/es/: ['dance']
2025-06-18 17:22:18 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.5rhythms.com/es/
2025-06-18 17:22:18 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:22:18 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:22:18 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:22:19 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-06-18 17:22:19 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 429
{"object":"rejection","message":"Service tier capacity exceeded for this model.","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 17:22:19 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 17:22:24 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:22:24 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 17:22:24 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 17:22:24 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/es/'
2025-06-18 17:22:24 [root] INFO: def parse(): URL https://www.5rhythms.com/es/ marked as irrelevant (LLM negative).
2025-06-18 17:22:24 [root] INFO: def parse(): Found 10 links on https://www.5rhythms.com/es/
2025-06-18 17:22:24 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/5rhythms'
2025-06-18 17:22:24 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/5rhythms
2025-06-18 17:22:24 [root] INFO: write_url_to_db(): appended URL 'https://instagram.com/5rhythms/'
2025-06-18 17:22:24 [root] INFO: def parse(): Recorded unwanted URL: https://instagram.com/5rhythms/
2025-06-18 17:22:24 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/5Rhythms.
2025-06-18 17:22:24 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:22:24 [root] INFO: should_process_url: URL https://www.5rhythms.com/es//TeacherSearch.php was last seen as relevant, processing it.
2025-06-18 17:22:24 [root] INFO: should_process_url: URL https://www.5rhythms.com/es//TeacherSearch.php was last seen as relevant, processing it.
2025-06-18 17:22:24 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/es//TeacherSearch.php'
2025-06-18 17:22:24 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/es//TeacherSearch.php
2025-06-18 17:22:24 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:22:24 [root] INFO: should_process_url: URL https://www.5rhythms.com/es//EventSearch.php was last seen as relevant, processing it.
2025-06-18 17:22:24 [root] INFO: should_process_url: URL https://www.5rhythms.com/es//EventSearch.php was last seen as relevant, processing it.
2025-06-18 17:22:24 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/es//EventSearch.php'
2025-06-18 17:22:24 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/es//EventSearch.php
2025-06-18 17:22:24 [root] INFO: should_process_url: URL https://www.5rhythms.com/es//gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:22:24 [root] INFO: should_process_url: URL https://www.5rhythms.com/es//gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:22:24 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/es//gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/'
2025-06-18 17:22:24 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/es//gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/
2025-06-18 17:22:24 [root] INFO: should_process_url: URL https://www.5rhythms.com/es/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:22:24 [root] INFO: should_process_url: URL https://www.5rhythms.com/ was last seen as relevant, processing it.
2025-06-18 17:22:24 [root] INFO: write_url_to_db(): appended URL 'https://streamdb3web.securenetsystems.net/v5/WAMU'
2025-06-18 17:22:24 [root] INFO: def parse(): URL https://streamdb3web.securenetsystems.net/v5/WAMU marked as irrelevant (no keywords).
2025-06-18 17:22:24 [root] INFO: def parse(): Found 9 links on https://streamdb3web.securenetsystems.net/v5/WAMU
2025-06-18 17:22:24 [root] INFO: should_process_url: URL http://www.google.com/policies/privacy was last seen as relevant, processing it.
2025-06-18 17:22:24 [root] INFO: should_process_url: URL http://www.google.com/policies/privacy was last seen as relevant, processing it.
2025-06-18 17:22:24 [root] INFO: write_url_to_db(): appended URL 'http://www.google.com/policies/privacy'
2025-06-18 17:22:24 [root] INFO: def parse(): Crawling next URL: http://www.google.com/policies/privacy
2025-06-18 17:22:24 [root] INFO: should_process_url: URL https://get.adobe.com/flashplayer/ was last seen as relevant, processing it.
2025-06-18 17:22:24 [root] INFO: should_process_url: URL https://get.adobe.com/flashplayer/ was last seen as relevant, processing it.
2025-06-18 17:22:24 [root] INFO: write_url_to_db(): appended URL 'https://get.adobe.com/flashplayer/'
2025-06-18 17:22:24 [root] INFO: def parse(): Crawling next URL: https://get.adobe.com/flashplayer/
2025-06-18 17:22:24 [root] INFO: should_process_url: URL https://streamdb3web.securenetsystems.net/v5/WAMU was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:22:24 [root] INFO: should_process_url: URL http://bluegrasscountryfoundation.org/donate-now/ was last seen as relevant, processing it.
2025-06-18 17:22:24 [root] INFO: should_process_url: URL http://bluegrasscountryfoundation.org/donate-now/ was last seen as relevant, processing it.
2025-06-18 17:22:24 [root] INFO: write_url_to_db(): appended URL 'http://bluegrasscountryfoundation.org/donate-now/'
2025-06-18 17:22:24 [root] INFO: def parse(): Crawling next URL: http://bluegrasscountryfoundation.org/donate-now/
2025-06-18 17:22:24 [root] INFO: should_process_url: URL http://networkadvertising.org/choices was last seen as relevant, processing it.
2025-06-18 17:22:24 [root] INFO: should_process_url: URL http://networkadvertising.org/choices was last seen as relevant, processing it.
2025-06-18 17:22:24 [root] INFO: write_url_to_db(): appended URL 'http://networkadvertising.org/choices'
2025-06-18 17:22:24 [root] INFO: def parse(): Crawling next URL: http://networkadvertising.org/choices
2025-06-18 17:22:24 [root] INFO: parse: Skipping blacklisted URL https://youtube.com/@https://www.youtube.com/channel/UCX1j0y1X-HR0Yntry.
2025-06-18 17:22:24 [root] INFO: should_process_url: URL http://bluegrasscountryfoundation.org/ was last seen as relevant, processing it.
2025-06-18 17:22:24 [root] INFO: should_process_url: URL http://bluegrasscountryfoundation.org/ was last seen as relevant, processing it.
2025-06-18 17:22:24 [root] INFO: write_url_to_db(): appended URL 'http://bluegrasscountryfoundation.org/'
2025-06-18 17:22:24 [root] INFO: def parse(): Crawling next URL: http://bluegrasscountryfoundation.org/
2025-06-18 17:22:24 [root] INFO: should_process_url: URL http://www.nielsen.com/digitalprivacy was last seen as relevant, processing it.
2025-06-18 17:22:24 [root] INFO: should_process_url: URL http://www.nielsen.com/digitalprivacy was last seen as relevant, processing it.
2025-06-18 17:22:24 [root] INFO: write_url_to_db(): appended URL 'http://www.nielsen.com/digitalprivacy'
2025-06-18 17:22:24 [root] INFO: def parse(): Crawling next URL: http://www.nielsen.com/digitalprivacy
2025-06-18 17:22:24 [root] INFO: parse: Skipping blacklisted URL http://en.wikipedia.org/wiki/HTTP_cookie.
2025-06-18 17:22:24 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/t/terms.
2025-06-18 17:22:24 [root] INFO: def parse(): Found keywords for URL https://www.5rhythms.com/hr//gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/: ['dance']
2025-06-18 17:22:24 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.5rhythms.com/hr//gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/
2025-06-18 17:22:24 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:22:24 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:22:24 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:22:28 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:22:28 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 17:22:28 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 17:22:28 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/hr//gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/'
2025-06-18 17:22:28 [root] INFO: def parse(): URL https://www.5rhythms.com/hr//gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ marked as irrelevant (LLM negative).
2025-06-18 17:22:28 [root] INFO: def parse(): Found 10 links on https://www.5rhythms.com/hr/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/
2025-06-18 17:22:28 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/5rhythms'
2025-06-18 17:22:28 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/5rhythms
2025-06-18 17:22:28 [root] INFO: write_url_to_db(): appended URL 'https://instagram.com/5rhythms/'
2025-06-18 17:22:28 [root] INFO: def parse(): Recorded unwanted URL: https://instagram.com/5rhythms/
2025-06-18 17:22:28 [root] INFO: should_process_url: URL https://www.5rhythms.com/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings-old/ has never been seen before, processing it.
2025-06-18 17:22:28 [root] INFO: should_process_url: URL https://www.5rhythms.com/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings-old/ has never been seen before, processing it.
2025-06-18 17:22:28 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings-old/'
2025-06-18 17:22:28 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings-old/
2025-06-18 17:22:28 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/5Rhythms.
2025-06-18 17:22:28 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr//TeacherSearch.php was last seen as relevant, processing it.
2025-06-18 17:22:28 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:22:28 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr//EventSearch.php was last seen as relevant, processing it.
2025-06-18 17:22:28 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr//gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ was last seen as relevant, processing it.
2025-06-18 17:22:28 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ has never been seen before, processing it.
2025-06-18 17:22:28 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ has never been seen before, processing it.
2025-06-18 17:22:28 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/nl/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/'
2025-06-18 17:22:28 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/nl/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/
2025-06-18 17:22:28 [root] INFO: should_process_url: URL https://www.5rhythms.com/es/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ has never been seen before, processing it.
2025-06-18 17:22:28 [root] INFO: should_process_url: URL https://www.5rhythms.com/es/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ has never been seen before, processing it.
2025-06-18 17:22:28 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/es/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/'
2025-06-18 17:22:28 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/es/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/
2025-06-18 17:22:28 [root] INFO: def parse(): Found keywords for URL https://vbds.org/events/beginners-pre-bronze-w-t-c-r-2025-06-09/: ['cha cha', 'dance', 'foxtrot', 'line dance', 'quickstep', 'rumba', 'samba', 'swing', 'tango', 'waltz', 'west coast swing']
2025-06-18 17:22:28 [root] INFO: def generate_prompt(): Generating prompt for URL: https://vbds.org/events/beginners-pre-bronze-w-t-c-r-2025-06-09/
2025-06-18 17:22:28 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:22:28 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:22:28 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:22:29 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 17:22:29 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 137878 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 17:22:29 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 17:22:59 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:22:59 [root] INFO: query_llm(): OpenAI response received: [{
    "source": "Victoria Ballroom Dance Society",
    "dance_style": "waltz, tango, cha cha, rumba",
    "url": "",
    "event_type": "class",
    "event_name": "Beginners to Pre-Bronze Waltz, Tango, Cha Cha, Rumba",
    "day_of_week": "Monday",
    "start_date": "2025-06-09",
    "end_date": "2025-06-30",
    "start_time": "19:00",
    "end_time": "20:30",
    "price": "$75.00",
    "location": "Centennial United Church – Dance Studio",
    "description": "Our June classes are designed for dancers with 3–12 months of Ballroom and Latin experience, focusing on styling, musicality, and fundamentals in Waltz, Tango, Cha Cha, and Rumba with Victor Golubkov."
}]
2025-06-18 17:22:59 [root] INFO: def extract_and_parse_json(): for url https://vbds.org/events/beginners-pre-bronze-w-t-c-r-2025-06-09/, 
Cleaned JSON ready for parsing:
[{
    "source": "Victoria Ballroom Dance Society",
    "dance_style": "waltz, tango, cha cha, rumba",
    "url": "",
    "event_type": "class",
    "event_name": "Beginners to Pre-Bronze Waltz, Tango, Cha Cha, Rumba",
    "day_of_week": "Monday",
    "start_date": "2025-06-09",
    "end_date": "2025-06-30",
    "start_time": "19:00",
    "end_time": "20:30",
    "price": "$75.00",
    "location": "Centennial United Church – Dance Studio",
    "description": "Our June classes are designed for dancers with 3–12 months of Ballroom and Latin experience, focusing on styling, musicality, and fundamentals in Waltz, Tango, Cha Cha, and Rumba with Victor Golubkov."
}]
2025-06-18 17:22:59 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 17:22:59 [root] INFO: def clean_up_address(): Processing location 'Centennial United Church – Dance Studio' (event_id: None)
2025-06-18 17:22:59 [root] INFO: write_events_to_db: Number of events to write: 1
2025-06-18 17:22:59 [root] INFO: write_url_to_db(): appended URL 'https://vbds.org/events/beginners-pre-bronze-w-t-c-r-2025-06-09/'
2025-06-18 17:22:59 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 17:22:59 [root] INFO: def process_llm_response: URL https://vbds.org/events/beginners-pre-bronze-w-t-c-r-2025-06-09/ marked as relevant with events written to the database.
2025-06-18 17:22:59 [root] INFO: write_url_to_db(): appended URL 'https://vbds.org/events/beginners-pre-bronze-w-t-c-r-2025-06-09/'
2025-06-18 17:22:59 [root] INFO: def parse(): URL https://vbds.org/events/beginners-pre-bronze-w-t-c-r-2025-06-09/ marked as relevant (LLM positive).
2025-06-18 17:22:59 [root] INFO: def parse(): Found 10 links on https://vbds.org/events/beginners-pre-bronze-w-t-c-r-2025-06-09/
2025-06-18 17:22:59 [root] INFO: should_process_url: URL https://vbds.org/login/ was last seen as relevant, processing it.
2025-06-18 17:22:59 [root] INFO: should_process_url: URL https://vbds.org/events/beginners-pre-bronze-w-t-c-r-2025-06-09/ has never been seen before, processing it.
2025-06-18 17:22:59 [root] INFO: should_process_url: URL https://vbds.org/events/beginners-pre-bronze-w-t-c-r-2025-06-09/ has never been seen before, processing it.
2025-06-18 17:22:59 [root] INFO: write_url_to_db(): appended URL 'https://vbds.org/events/beginners-pre-bronze-w-t-c-r-2025-06-09/'
2025-06-18 17:22:59 [root] INFO: def parse(): Crawling next URL: https://vbds.org/events/beginners-pre-bronze-w-t-c-r-2025-06-09/
2025-06-18 17:22:59 [root] INFO: def parse(): Found keywords for URL https://pacificopera.ca/event/take-this-waltz/: ['dance', 'waltz']
2025-06-18 17:22:59 [root] INFO: def generate_prompt(): Generating prompt for URL: https://pacificopera.ca/event/take-this-waltz/
2025-06-18 17:22:59 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:22:59 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:22:59 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:25:00 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:25:00 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "https://pacificopera.ca/event/take-this-waltz/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Take This Waltz",
        "day_of_week": "Wednesday",
        "start_date": "2022-11-23",
        "end_date": "2022-11-23",
        "start_time": "19:30",
        "end_time": "",
        "price": "$15-$40",
        "location": "Baumann Centre",
        "description": "This evening of music, dance, and stunning visuals, staged by Israeli choreographer and director Idan Cohen of Ne. Sans Opera & Dance, celebrates the legendary Canadian singer-songwriter Leonard Cohen. Performers featured are world-renowned Canadian bass-baritone Daniel Okulitch, described as “flat-out brilliant” by Opera News, the multi-talented dancer/musician Ted Littlemore, and a classical chamber ensemble of violin, accordion and cello."
    },
    {
        "source": "https://pacificopera.ca/event/take-this-waltz/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Take This Waltz",
        "day_of_week": "Thursday",
        "start_date": "2022-11-24",
        "end_date": "2022-11-24",
        "start_time": "16:00",
        "end_time": "",
        "price": "$15-$40",
        "location": "Baumann Centre",
        "description": "This evening of music, dance, and stunning visuals, staged by Israeli choreographer and director Idan Cohen of Ne. Sans Opera & Dance, celebrates the legendary Canadian singer-songwriter Leonard Cohen. Performers featured are world-renowned Canadian bass-baritone Daniel Okulitch, described as “flat-out brilliant” by Opera News, the multi-talented dancer/musician Ted Littlemore, and a classical chamber ensemble of violin, accordion and cello."
    },
    {
        "source": "https://pacificopera.ca/event/take-this-waltz/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Take This Waltz",
        "day_of_week": "Friday",
        "start_date": "2022-11-25",
        "end_date": "2022-11-25",
        "start_time": "19:30",
        "end_time": "",
        "price": "$15-$40",
        "location": "Baumann Centre",
        "description": "This evening of music, dance, and stunning visuals, staged by Israeli choreographer and director Idan Cohen of Ne. Sans Opera & Dance, celebrates the legendary Canadian singer-songwriter Leonard Cohen. Performers featured are world-renowned Canadian bass-baritone Daniel Okulitch, described as “flat-out brilliant” by Opera News, the multi-talented dancer/musician Ted Littlemore, and a classical chamber ensemble of violin, accordion and cello."
    },
    {
        "source": "https://pacificopera.ca/event/take-this-waltz/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Take This Waltz",
        "day_of_week": "Saturday",
        "start_date": "2022-11-26",
        "end_date": "2022-11-26",
        "start_time": "19:30",
        "end_time": "",
        "price": "$15-$40",
        "location": "Baumann Centre",
        "description": "This evening of music, dance, and stunning visuals, staged by Israeli choreographer and director Idan Cohen of Ne. Sans Opera & Dance, celebrates the legendary Canadian singer-songwriter Leonard Cohen. Performers featured are world-renowned Canadian bass-baritone Daniel Okulitch, described as “flat-out brilliant” by Opera News, the multi-talented dancer/musician Ted Littlemore, and a classical chamber ensemble of violin, accordion and cello."
    },
    {
        "source": "https://pacificopera.ca/event/take-this-waltz/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Take This Waltz",
        "day_of_week": "Sunday",
        "start_date": "2022-11-27",
        "end_date": "2022-11-27",
        "start_time": "16:00",
        "end_time": "",
        "price": "$15-$40",
        "location": "Baumann Centre",
        "description": "This evening of music, dance, and stunning visuals, staged by Israeli choreographer and director Idan Cohen of Ne. Sans Opera & Dance, celebrates the legendary Canadian singer-songwriter Leonard Cohen. Performers featured are world-renowned Canadian bass-baritone Daniel Okulitch, described as “flat-out brilliant” by Opera News, the multi-talented dancer/musician Ted Littlemore, and a classical chamber ensemble of violin, accordion and cello."
    },
    {
        "source": "https://pacificopera.ca/event/the-birds/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "The Birds",
        "day_of_week": "Tuesday",
        "start_date": "2023-02-22",
        "end_date": "2023-02-22",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "https://pacificopera.ca/event/the-birds/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "The Birds",
        "day_of_week": "Sunday",
        "start_date": "2023-02-28",
        "end_date": "2023-02-28",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "https://pacificopera.ca/event/cosi-fan-tutte/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Così fan tutte",
        "day_of_week": "Tuesday",
        "start_date": "2023-04-12",
        "end_date": "2023-04-12",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "https://pacificopera.ca/event/cosi-fan-tutte/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Così fan tutte",
        "day_of_week": "Monday",
        "start_date": "2023-04-18",
        "end_date": "2023-04-18",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "https://pacificopera.ca/event/the-book-of-my-shames/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "The Book of My Shames",
        "day_of_week": "Saturday",
        "start_date": "2023-05-12",
        "end_date": "2023-05-12",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "https://pacificopera.ca/event/the-book-of-my-shames/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "The Book of My Shames",
        "day_of_week": "Monday",
        "start_date": "2023-05-14",
        "end_date": "2023-05-14",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": ""
    }
]
2025-06-18 17:25:00 [root] INFO: def extract_and_parse_json(): for url https://pacificopera.ca/event/take-this-waltz/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "https://pacificopera.ca/event/take-this-waltz/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Take This Waltz",
        "day_of_week": "Wednesday",
        "start_date": "2022-11-23",
        "end_date": "2022-11-23",
        "start_time": "19:30",
        "end_time": "",
        "price": "$15-$40",
        "location": "Baumann Centre",
        "description": "This evening of music, dance, and stunning visuals, staged by Israeli choreographer and director Idan Cohen of Ne. Sans Opera & Dance, celebrates the legendary Canadian singer-songwriter Leonard Cohen. Performers featured are world-renowned Canadian bass-baritone Daniel Okulitch, described as “flat-out brilliant” by Opera News, the multi-talented dancer/musician Ted Littlemore, and a classical chamber ensemble of violin, accordion and cello."
    },
    {
        "source": "https://pacificopera.ca/event/take-this-waltz/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Take This Waltz",
        "day_of_week": "Thursday",
        "start_date": "2022-11-24",
        "end_date": "2022-11-24",
        "start_time": "16:00",
        "end_time": "",
        "price": "$15-$40",
        "location": "Baumann Centre",
        "description": "This evening of music, dance, and stunning visuals, staged by Israeli choreographer and director Idan Cohen of Ne. Sans Opera & Dance, celebrates the legendary Canadian singer-songwriter Leonard Cohen. Performers featured are world-renowned Canadian bass-baritone Daniel Okulitch, described as “flat-out brilliant” by Opera News, the multi-talented dancer/musician Ted Littlemore, and a classical chamber ensemble of violin, accordion and cello."
    },
    {
        "source": "https://pacificopera.ca/event/take-this-waltz/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Take This Waltz",
        "day_of_week": "Friday",
        "start_date": "2022-11-25",
        "end_date": "2022-11-25",
        "start_time": "19:30",
        "end_time": "",
        "price": "$15-$40",
        "location": "Baumann Centre",
        "description": "This evening of music, dance, and stunning visuals, staged by Israeli choreographer and director Idan Cohen of Ne. Sans Opera & Dance, celebrates the legendary Canadian singer-songwriter Leonard Cohen. Performers featured are world-renowned Canadian bass-baritone Daniel Okulitch, described as “flat-out brilliant” by Opera News, the multi-talented dancer/musician Ted Littlemore, and a classical chamber ensemble of violin, accordion and cello."
    },
    {
        "source": "https://pacificopera.ca/event/take-this-waltz/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Take This Waltz",
        "day_of_week": "Saturday",
        "start_date": "2022-11-26",
        "end_date": "2022-11-26",
        "start_time": "19:30",
        "end_time": "",
        "price": "$15-$40",
        "location": "Baumann Centre",
        "description": "This evening of music, dance, and stunning visuals, staged by Israeli choreographer and director Idan Cohen of Ne. Sans Opera & Dance, celebrates the legendary Canadian singer-songwriter Leonard Cohen. Performers featured are world-renowned Canadian bass-baritone Daniel Okulitch, described as “flat-out brilliant” by Opera News, the multi-talented dancer/musician Ted Littlemore, and a classical chamber ensemble of violin, accordion and cello."
    },
    {
        "source": "https://pacificopera.ca/event/take-this-waltz/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Take This Waltz",
        "day_of_week": "Sunday",
        "start_date": "2022-11-27",
        "end_date": "2022-11-27",
        "start_time": "16:00",
        "end_time": "",
        "price": "$15-$40",
        "location": "Baumann Centre",
        "description": "This evening of music, dance, and stunning visuals, staged by Israeli choreographer and director Idan Cohen of Ne. Sans Opera & Dance, celebrates the legendary Canadian singer-songwriter Leonard Cohen. Performers featured are world-renowned Canadian bass-baritone Daniel Okulitch, described as “flat-out brilliant” by Opera News, the multi-talented dancer/musician Ted Littlemore, and a classical chamber ensemble of violin, accordion and cello."
    },
    {
        "source": "https://pacificopera.ca/event/the-birds/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "The Birds",
        "day_of_week": "Tuesday",
        "start_date": "2023-02-22",
        "end_date": "2023-02-22",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "https://pacificopera.ca/event/the-birds/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "The Birds",
        "day_of_week": "Sunday",
        "start_date": "2023-02-28",
        "end_date": "2023-02-28",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "https://pacificopera.ca/event/cosi-fan-tutte/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Così fan tutte",
        "day_of_week": "Tuesday",
        "start_date": "2023-04-12",
        "end_date": "2023-04-12",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "https://pacificopera.ca/event/cosi-fan-tutte/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Così fan tutte",
        "day_of_week": "Monday",
        "start_date": "2023-04-18",
        "end_date": "2023-04-18",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "https://pacificopera.ca/event/the-book-of-my-shames/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "The Book of My Shames",
        "day_of_week": "Saturday",
        "start_date": "2023-05-12",
        "end_date": "2023-05-12",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "https://pacificopera.ca/event/the-book-of-my-shames/",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "The Book of My Shames",
        "day_of_week": "Monday",
        "start_date": "2023-05-14",
        "end_date": "2023-05-14",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": ""
    }
]
2025-06-18 17:25:00 [root] INFO: def clean_up_address(): Starting with events_df shape: (11, 14)
2025-06-18 17:25:00 [root] INFO: def clean_up_address(): Processing location 'Baumann Centre' (event_id: None)
2025-06-18 17:25:00 [root] INFO: def clean_up_address(): Processing location 'Baumann Centre' (event_id: None)
2025-06-18 17:25:00 [root] INFO: def clean_up_address(): Processing location 'Baumann Centre' (event_id: None)
2025-06-18 17:25:00 [root] INFO: def clean_up_address(): Processing location 'Baumann Centre' (event_id: None)
2025-06-18 17:25:00 [root] INFO: def clean_up_address(): Processing location 'Baumann Centre' (event_id: None)
2025-06-18 17:25:00 [root] INFO: write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 17:25:00 [root] INFO: write_url_to_db(): appended URL 'https://pacificopera.ca/event/take-this-waltz/'
2025-06-18 17:25:00 [root] INFO: def process_llm_response: URL https://pacificopera.ca/event/take-this-waltz/ marked as relevant with events written to the database.
2025-06-18 17:25:00 [root] INFO: write_url_to_db(): appended URL 'https://pacificopera.ca/event/take-this-waltz/'
2025-06-18 17:25:00 [root] INFO: def parse(): URL https://pacificopera.ca/event/take-this-waltz/ marked as relevant (LLM positive).
2025-06-18 17:25:00 [root] INFO: def parse(): Found 10 links on https://pacificopera.ca/event/take-this-waltz/
2025-06-18 17:25:00 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-P6BKZXG, URL: https://pacificopera.ca/event/take-this-waltz/, source: Take This Waltz - Pacific Opera Victoria, keywords: waltz
2025-06-18 17:25:00 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 17:25:00 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-P6BKZXG
2025-06-18 17:25:00 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-P6BKZXG'
2025-06-18 17:25:00 [root] INFO: should_process_url: URL https://pacificopera.ca was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:25:00 [root] INFO: should_process_url: URL https://pacificopera.ca was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:25:00 [root] INFO: write_url_to_db(): appended URL 'https://pacificopera.ca'
2025-06-18 17:25:00 [root] INFO: def parse(): Crawling next URL: https://pacificopera.ca
2025-06-18 17:25:00 [scrapy.extensions.logstats] INFO: Crawled 384 pages (at 16 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 17:25:00 [root] INFO: should_process_url: URL https://alces.world/about-us/#volunteer was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:25:00 [root] INFO: should_process_url: URL https://alces.world/about-us/ was last seen as relevant, processing it.
2025-06-18 17:25:00 [root] INFO: should_process_url: URL https://alces.world/about-us/#values was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:25:00 [root] INFO: should_process_url: URL https://alces.world/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 17:25:00 [root] INFO: should_process_url: URL https://alces.world/6th-edition/ was last seen as relevant, processing it.
2025-06-18 17:25:00 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.facebook.com/groups/vancitykizomba/> (failed 3 times): User timeout caused connection failure: Getting https://www.facebook.com/groups/vancitykizomba/ took longer than 180.0 seconds..
2025-06-18 17:25:00 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.facebook.com/willowandwaltzphoto/> (failed 3 times): User timeout caused connection failure: Getting https://www.facebook.com/willowandwaltzphoto/ took longer than 180.0 seconds..
2025-06-18 17:25:00 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.facebook.com/groups/victoriawestcoastswingcollective/> (failed 3 times): User timeout caused connection failure: Getting https://www.facebook.com/groups/victoriawestcoastswingcollective/ took longer than 180.0 seconds..
2025-06-18 17:25:00 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://folkalley.com/category/podcasts/> (failed 3 times): User timeout caused connection failure: Getting https://folkalley.com/category/podcasts/ took longer than 180.0 seconds..
2025-06-18 17:25:00 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://folkalley.com/stream/folk-alley/> (failed 3 times): User timeout caused connection failure: Getting https://folkalley.com/stream/folk-alley/ took longer than 180.0 seconds..
2025-06-18 17:25:00 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://folkalley.com/category/specialty-hours/> (failed 3 times): User timeout caused connection failure: Getting https://folkalley.com/category/specialty-hours/ took longer than 180.0 seconds..
2025-06-18 17:25:00 [root] INFO: should_process_url: URL https://vbds.org/vbds-practices/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:25:00 [root] INFO: should_process_url: URL https://vbds.org/ was last seen as relevant, processing it.
2025-06-18 17:25:00 [root] INFO: should_process_url: URL https://vbds.org/upcoming-classes-workshops/ was last seen as relevant, processing it.
2025-06-18 17:25:00 [root] INFO: should_process_url: URL https://vbds.org/calendar/ was last seen as relevant, processing it.
2025-06-18 17:25:00 [root] INFO: should_process_url: URL https://vbds.org/members/ was last seen as relevant, processing it.
2025-06-18 17:25:00 [root] INFO: should_process_url: URL https://vbds.org/introduction-to-ballroom-dancing/ was last seen as relevant, processing it.
2025-06-18 17:25:00 [root] INFO: should_process_url: URL https://pacificopera.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:25:00 [root] INFO: should_process_url: URL https://pacificopera.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:25:00 [root] INFO: write_url_to_db(): appended URL 'https://pacificopera.ca/'
2025-06-18 17:25:00 [root] INFO: def parse(): Crawling next URL: https://pacificopera.ca/
2025-06-18 17:25:00 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/tickets-subscriptions/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:25:00 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/tickets-subscriptions/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:25:00 [root] INFO: write_url_to_db(): appended URL 'https://pacificopera.ca/whats-on/tickets-subscriptions/'
2025-06-18 17:25:00 [root] INFO: def parse(): Crawling next URL: https://pacificopera.ca/whats-on/tickets-subscriptions/
2025-06-18 17:25:00 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/calendar/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:25:00 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/calendar/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:25:00 [root] INFO: write_url_to_db(): appended URL 'https://pacificopera.ca/whats-on/calendar/'
2025-06-18 17:25:00 [root] INFO: def parse(): Crawling next URL: https://pacificopera.ca/whats-on/calendar/
2025-06-18 17:25:00 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/opera-etc/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:25:00 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/opera-etc/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:25:00 [root] INFO: write_url_to_db(): appended URL 'https://pacificopera.ca/whats-on/opera-etc/'
2025-06-18 17:25:00 [root] INFO: def parse(): Crawling next URL: https://pacificopera.ca/whats-on/opera-etc/
2025-06-18 17:25:00 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/opera-etc/for-youth/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:25:00 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/opera-etc/for-youth/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:25:00 [root] INFO: write_url_to_db(): appended URL 'https://pacificopera.ca/whats-on/opera-etc/for-youth/'
2025-06-18 17:25:00 [root] INFO: def parse(): Crawling next URL: https://pacificopera.ca/whats-on/opera-etc/for-youth/
2025-06-18 17:25:00 [root] INFO: should_process_url: URL https://pacificopera.ca/event/take-this-waltz/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 17:25:00 [root] INFO: should_process_url: URL https://pacificopera.ca/event/take-this-waltz/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 17:25:00 [root] INFO: write_url_to_db(): appended URL 'https://pacificopera.ca/event/take-this-waltz/'
2025-06-18 17:25:00 [root] INFO: def parse(): Crawling next URL: https://pacificopera.ca/event/take-this-waltz/
2025-06-18 17:25:00 [root] INFO: def parse(): Found keywords for URL https://www.facebook.com/groups/britishcolumbiaphotos/posts/3967435853476303/: ['dance', 'swing', 'wcs']
2025-06-18 17:25:00 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.facebook.com/groups/britishcolumbiaphotos/posts/3967435853476303/
2025-06-18 17:25:00 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:25:00 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:25:00 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:25:02 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 17:25:02 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 374202 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 17:25:02 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 17:25:03 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 17:25:03 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 278605 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 17:25:03 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 17:25:03 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://www.facebook.com/groups/britishcolumbiaphotos/posts/3967435853476303/
2025-06-18 17:25:03 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/britishcolumbiaphotos/posts/3967435853476303/'
2025-06-18 17:25:03 [root] INFO: def parse(): URL https://www.facebook.com/groups/britishcolumbiaphotos/posts/3967435853476303/ marked as irrelevant (LLM negative).
2025-06-18 17:25:03 [root] INFO: def parse(): Found 0 links on https://www.facebook.com/groups/britishcolumbiaphotos/posts/3967435853476303/
2025-06-18 17:25:03 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/groups/britishcolumbiaphotos/posts/3967435853476303/'
2025-06-18 17:25:03 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/groups/britishcolumbiaphotos/posts/3967435853476303/
2025-06-18 17:25:04 [root] INFO: def parse(): Found keywords for URL https://www.instagram.com/lena.deschner/?hl=en: ['balboa', 'dance', 'kizomba', 'semba', 'urban kiz', 'wcs']
2025-06-18 17:25:04 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.instagram.com/lena.deschner/?hl=en
2025-06-18 17:25:04 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:25:04 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:25:04 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:25:05 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 17:25:05 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 402738 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 17:25:05 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 17:25:06 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 17:25:06 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 307060 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 17:25:06 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 17:25:06 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://www.instagram.com/lena.deschner/?hl=en
2025-06-18 17:25:06 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/lena.deschner/?hl=en'
2025-06-18 17:25:06 [root] INFO: def parse(): URL https://www.instagram.com/lena.deschner/?hl=en marked as irrelevant (LLM negative).
2025-06-18 17:25:06 [root] INFO: def parse(): Found 0 links on https://www.instagram.com/lena.deschner/?hl=en
2025-06-18 17:25:06 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/lena.deschner/?hl=en'
2025-06-18 17:25:06 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/lena.deschner/?hl=en
2025-06-18 17:25:06 [root] INFO: def parse(): Found keywords for URL https://www.5rhythms.com/hr//TeacherSearch.php: ['dance']
2025-06-18 17:25:06 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.5rhythms.com/hr//TeacherSearch.php
2025-06-18 17:25:06 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:25:06 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:25:06 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:25:12 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:25:12 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 17:25:12 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 17:25:12 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/hr//TeacherSearch.php'
2025-06-18 17:25:12 [root] INFO: def parse(): URL https://www.5rhythms.com/hr//TeacherSearch.php marked as irrelevant (LLM negative).
2025-06-18 17:25:12 [root] INFO: def parse(): Found 10 links on https://www.5rhythms.com/hr//TeacherSearch.php
2025-06-18 17:25:12 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/5rhythms'
2025-06-18 17:25:12 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/5rhythms
2025-06-18 17:25:12 [root] INFO: write_url_to_db(): appended URL 'https://instagram.com/5rhythms/'
2025-06-18 17:25:12 [root] INFO: def parse(): Recorded unwanted URL: https://instagram.com/5rhythms/
2025-06-18 17:25:12 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/5Rhythms.
2025-06-18 17:25:12 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:25:12 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr//TeacherSearch.php was last seen as relevant, processing it.
2025-06-18 17:25:12 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/EventSearch.php has never been seen before, processing it.
2025-06-18 17:25:12 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/EventSearch.php has never been seen before, processing it.
2025-06-18 17:25:12 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/hr/EventSearch.php'
2025-06-18 17:25:12 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/hr/EventSearch.php
2025-06-18 17:25:12 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr has never been seen before, processing it.
2025-06-18 17:25:12 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr has never been seen before, processing it.
2025-06-18 17:25:12 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/hr'
2025-06-18 17:25:12 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/hr
2025-06-18 17:25:12 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/TeacherSearch.php has never been seen before, processing it.
2025-06-18 17:25:12 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/TeacherSearch.php has never been seen before, processing it.
2025-06-18 17:25:12 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/hr/TeacherSearch.php'
2025-06-18 17:25:12 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/hr/TeacherSearch.php
2025-06-18 17:25:12 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ has never been seen before, processing it.
2025-06-18 17:25:12 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ has never been seen before, processing it.
2025-06-18 17:25:12 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/hr/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/'
2025-06-18 17:25:12 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/hr/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/
2025-06-18 17:25:12 [root] INFO: should_process_url: URL https://www.5rhythms.com/es/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:25:12 [root] INFO: should_process_url: URL https://www.5rhythms.com/ was last seen as relevant, processing it.
2025-06-18 17:25:12 [root] INFO: def parse(): Found keywords for URL https://www.5rhythms.com/hr//EventSearch.php: ['dance']
2025-06-18 17:25:12 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.5rhythms.com/hr//EventSearch.php
2025-06-18 17:25:12 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:25:12 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:25:12 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:25:30 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:25:30 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "5Ritmova",
        "dance_style": "",
        "url": "",
        "event_type": "workshop",
        "event_name": "Učiteljski treninzi",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "5Ritmova",
        "dance_style": "",
        "url": "",
        "event_type": "workshop",
        "event_name": "SpaceHolder Orijentacija",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "5Ritmova",
        "dance_style": "",
        "url": "",
        "event_type": "workshop",
        "event_name": "5RTA",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": ""
    }
]
2025-06-18 17:25:30 [root] INFO: def extract_and_parse_json(): for url https://www.5rhythms.com/hr//EventSearch.php, 
Cleaned JSON ready for parsing:
[
    {
        "source": "5Ritmova",
        "dance_style": "",
        "url": "",
        "event_type": "workshop",
        "event_name": "Učiteljski treninzi",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "5Ritmova",
        "dance_style": "",
        "url": "",
        "event_type": "workshop",
        "event_name": "SpaceHolder Orijentacija",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": ""
    },
    {
        "source": "5Ritmova",
        "dance_style": "",
        "url": "",
        "event_type": "workshop",
        "event_name": "5RTA",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": ""
    }
]
2025-06-18 17:25:30 [root] INFO: def clean_up_address(): Starting with events_df shape: (3, 14)
2025-06-18 17:25:30 [root] INFO: write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 17:25:30 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/hr//EventSearch.php'
2025-06-18 17:25:30 [root] INFO: def process_llm_response: URL https://www.5rhythms.com/hr//EventSearch.php marked as relevant with events written to the database.
2025-06-18 17:25:30 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/hr//EventSearch.php'
2025-06-18 17:25:30 [root] INFO: def parse(): URL https://www.5rhythms.com/hr//EventSearch.php marked as relevant (LLM positive).
2025-06-18 17:25:30 [root] INFO: def parse(): Found 10 links on https://www.5rhythms.com/hr//EventSearch.php
2025-06-18 17:25:30 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/5rhythms'
2025-06-18 17:25:30 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/5rhythms
2025-06-18 17:25:30 [root] INFO: write_url_to_db(): appended URL 'https://instagram.com/5rhythms/'
2025-06-18 17:25:30 [root] INFO: def parse(): Recorded unwanted URL: https://instagram.com/5rhythms/
2025-06-18 17:25:30 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/5Rhythms.
2025-06-18 17:25:30 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:25:30 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/EventSearch.php has never been seen before, processing it.
2025-06-18 17:25:30 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr has never been seen before, processing it.
2025-06-18 17:25:30 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr//EventSearch.php was last seen as relevant, processing it.
2025-06-18 17:25:30 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/TeacherSearch.php has never been seen before, processing it.
2025-06-18 17:25:30 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ has never been seen before, processing it.
2025-06-18 17:25:30 [root] INFO: should_process_url: URL https://www.5rhythms.com/es/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:25:30 [root] INFO: should_process_url: URL https://www.5rhythms.com/ was last seen as relevant, processing it.
2025-06-18 17:25:30 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.facebook.com/groups/vancitykizomba/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://www.facebook.com/groups/vancitykizomba/ took longer than 180.0 seconds..
2025-06-18 17:25:30 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.facebook.com/willowandwaltzphoto/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://www.facebook.com/willowandwaltzphoto/ took longer than 180.0 seconds..
2025-06-18 17:25:30 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.facebook.com/groups/victoriawestcoastswingcollective/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://www.facebook.com/groups/victoriawestcoastswingcollective/ took longer than 180.0 seconds..
2025-06-18 17:25:30 [scrapy.core.scraper] ERROR: Error downloading <GET https://folkalley.com/category/podcasts/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://folkalley.com/category/podcasts/ took longer than 180.0 seconds..
2025-06-18 17:25:30 [scrapy.core.scraper] ERROR: Error downloading <GET https://folkalley.com/stream/folk-alley/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://folkalley.com/stream/folk-alley/ took longer than 180.0 seconds..
2025-06-18 17:25:30 [scrapy.core.scraper] ERROR: Error downloading <GET https://folkalley.com/category/specialty-hours/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://folkalley.com/category/specialty-hours/ took longer than 180.0 seconds..
2025-06-18 17:25:30 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.google.com/url?sa=t&source=web&rct=j&opi=89978449&url=/maps/dir//seda%2Bdance/data%3D!4m6!4m5!1m1!4e2!1m2!1m1!1s0x548f75d7ebf254e5:0xdc92cc2da43d9826%3Fsa%3DX%26ved%3D1t:3061%26ictx%3D111> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:25:30 [root] INFO: should_process_url: URL https://pacificopera.ca/support/donate/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:25:30 [root] INFO: should_process_url: URL https://pacificopera.ca/support/donate/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:25:30 [root] INFO: write_url_to_db(): appended URL 'https://pacificopera.ca/support/donate/'
2025-06-18 17:25:30 [root] INFO: def parse(): Crawling next URL: https://pacificopera.ca/support/donate/
2025-06-18 17:25:30 [scrapy.extensions.logstats] INFO: Crawled 384 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 17:25:30 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://folkalley.com/> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:25:30 [root] INFO: def parse(): Found keywords for URL https://www.thisisclassicalguitar.com/duet-play-along-waltz-czerny-method/: ['waltz']
2025-06-18 17:25:30 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.thisisclassicalguitar.com/duet-play-along-waltz-czerny-method/
2025-06-18 17:25:30 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:25:30 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:25:30 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:26:43 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:26:43 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "This is Classical Guitar",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Duet Play-Along: Waltz by Czerny from Method Vol.1",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "10:21",
        "end_time": null,
        "price": "$0",
        "location": "This is Classical Guitar",
        "description": "Waltz by Carl Czerny (1791-1857) – Duet Play-Along Video for beginner guitar from my Free Classical Guitar Method Volume 1. This is originally for piano so the student is playing the right hand part (treble clef) and the teacher is playing the left hand part (bass clef). It is also the introduction to staccato articulation. I’ll play the duet and then play the teacher part so you can play along. Using the YouTube Link might be easier for skipping back for retries."
    },
    {
        "source": "This is Classical Guitar",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Caprice No.1-4, Op.20 by Luigi Legnani",
        "day_of_week": "Wednesday",
        "start_date": "2025-05-15",
        "end_date": "2025-05-15",
        "start_time": "06:46",
        "end_time": null,
        "price": "$0",
        "location": "This is Classical Guitar",
        "description": "Luigi Legnani Caprice"
    },
    {
        "source": "This is Classical Guitar",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Positive Music Practice when Injured",
        "day_of_week": "Wednesday",
        "start_date": "2025-05-07",
        "end_date": "2025-05-07",
        "start_time": "11:24",
        "end_time": null,
        "price": "$0",
        "location": "This is Classical Guitar",
        "description": "Positive Music Practice when Injured. 3 Comments"
    },
    {
        "source": "This is Classical Guitar",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Right Hand Movement When Playing Across the Strings",
        "day_of_week": "Wednesday",
        "start_date": "2025-04-08",
        "end_date": "2025-04-08",
        "start_time": "16:25",
        "end_time": null,
        "price": "$0",
        "location": "This is Classical Guitar",
        "description": "Right Hand Movement When Playing Across the Strings. 4 Comments"
    },
    {
        "source": "This is Classical Guitar",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Benefits of Practicing Barre Exercises Everyday",
        "day_of_week": "Wednesday",
        "start_date": "2025-03-22",
        "end_date": "2025-03-22",
        "start_time": "11:19",
        "end_time": null,
        "price": "$0",
        "location": "This is Classical Guitar",
        "description": "Benefits of Practicing Barre Exercises Everyday"
    }
]
2025-06-18 17:26:43 [root] INFO: def extract_and_parse_json(): for url https://www.thisisclassicalguitar.com/duet-play-along-waltz-czerny-method/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "This is Classical Guitar",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Duet Play-Along: Waltz by Czerny from Method Vol.1",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "10:21",
        "end_time": null,
        "price": "$0",
        "location": "This is Classical Guitar",
        "description": "Waltz by Carl Czerny (1791-1857) – Duet Play-Along Video for beginner guitar from my Free Classical Guitar Method Volume 1. This is originally for piano so the student is playing the right hand part (treble clef) and the teacher is playing the left hand part (bass clef). It is also the introduction to staccato articulation. I’ll play the duet and then play the teacher part so you can play along. Using the YouTube Link might be easier for skipping back for retries."
    },
    {
        "source": "This is Classical Guitar",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Caprice No.1-4, Op.20 by Luigi Legnani",
        "day_of_week": "Wednesday",
        "start_date": "2025-05-15",
        "end_date": "2025-05-15",
        "start_time": "06:46",
        "end_time": null,
        "price": "$0",
        "location": "This is Classical Guitar",
        "description": "Luigi Legnani Caprice"
    },
    {
        "source": "This is Classical Guitar",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Positive Music Practice when Injured",
        "day_of_week": "Wednesday",
        "start_date": "2025-05-07",
        "end_date": "2025-05-07",
        "start_time": "11:24",
        "end_time": null,
        "price": "$0",
        "location": "This is Classical Guitar",
        "description": "Positive Music Practice when Injured. 3 Comments"
    },
    {
        "source": "This is Classical Guitar",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Right Hand Movement When Playing Across the Strings",
        "day_of_week": "Wednesday",
        "start_date": "2025-04-08",
        "end_date": "2025-04-08",
        "start_time": "16:25",
        "end_time": null,
        "price": "$0",
        "location": "This is Classical Guitar",
        "description": "Right Hand Movement When Playing Across the Strings. 4 Comments"
    },
    {
        "source": "This is Classical Guitar",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Benefits of Practicing Barre Exercises Everyday",
        "day_of_week": "Wednesday",
        "start_date": "2025-03-22",
        "end_date": "2025-03-22",
        "start_time": "11:19",
        "end_time": null,
        "price": "$0",
        "location": "This is Classical Guitar",
        "description": "Benefits of Practicing Barre Exercises Everyday"
    }
]
2025-06-18 17:26:43 [root] INFO: def clean_up_address(): Starting with events_df shape: (5, 14)
2025-06-18 17:26:43 [root] INFO: def clean_up_address(): Processing location 'This is Classical Guitar' (event_id: None)
2025-06-18 17:26:43 [root] INFO: def clean_up_address(): Processing location 'This is Classical Guitar' (event_id: None)
2025-06-18 17:26:43 [root] INFO: def clean_up_address(): Processing location 'This is Classical Guitar' (event_id: None)
2025-06-18 17:26:43 [root] INFO: def clean_up_address(): Processing location 'This is Classical Guitar' (event_id: None)
2025-06-18 17:26:43 [root] INFO: def clean_up_address(): Processing location 'This is Classical Guitar' (event_id: None)
2025-06-18 17:26:43 [root] INFO: write_events_to_db: Number of events to write: 5
2025-06-18 17:26:43 [root] INFO: write_url_to_db(): appended URL 'https://www.thisisclassicalguitar.com/duet-play-along-waltz-czerny-method/'
2025-06-18 17:26:43 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 17:26:43 [root] INFO: def process_llm_response: URL https://www.thisisclassicalguitar.com/duet-play-along-waltz-czerny-method/ marked as relevant with events written to the database.
2025-06-18 17:26:43 [root] INFO: write_url_to_db(): appended URL 'https://www.thisisclassicalguitar.com/duet-play-along-waltz-czerny-method/'
2025-06-18 17:26:43 [root] INFO: def parse(): URL https://www.thisisclassicalguitar.com/duet-play-along-waltz-czerny-method/ marked as relevant (LLM positive).
2025-06-18 17:26:43 [root] INFO: def parse(): Found 10 links on https://www.thisisclassicalguitar.com/duet-play-along-waltz-czerny-method/
2025-06-18 17:26:43 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.youtube.com/embed/_YPJaMhWqRU?feature=oembed, URL: https://www.thisisclassicalguitar.com/duet-play-along-waltz-czerny-method/, source: Duet Play-Along: Waltz by Czerny from Method Vol.1 | This is ..., keywords: waltz
2025-06-18 17:26:43 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: 2nm(m`Z2EGj۫zm
2025-06-18 17:26:43 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.youtube.com/embed/_YPJaMhWqRU?feature=oembed
2025-06-18 17:26:43 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.youtube.com/embed/HiBJtS3Wv7Q?feature=oembed, URL: https://www.thisisclassicalguitar.com/duet-play-along-waltz-czerny-method/, source: Duet Play-Along: Waltz by Czerny from Method Vol.1 | This is ..., keywords: waltz
2025-06-18 17:26:43 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: 2nm(m I-ֿyn
2025-06-18 17:26:43 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.youtube.com/embed/HiBJtS3Wv7Q?feature=oembed
2025-06-18 17:26:43 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://jetpack.wordpress.com/jetpack-comment/?blogid=45037674&postid=20221&comment_registration=0&require_name_email=1&stc_enabled=0&stb_enabled=0&show_avatars=0&avatar_default=mystery&greeting=Ask+a+Question+or+Leave+a+Positive+Comment&jetpack_comments_nonce=9dfc0e8bf2&greeting_reply=Leave+a+Reply+to+%25s&color_scheme=light&lang=en_US&jetpack_version=14.7&iframe_unique_id=1&show_cookie_consent=10&has_cookie_consent=0&is_current_user_subscribed=0&token_key=%3Bnormal%3B&sig=7e260a9504266947b5084f6436aa54b2195a595e#parent=https%3A%2F%2Fwww.thisisclassicalguitar.com%2Fduet-play-along-waltz-czerny-method%2F, URL: https://www.thisisclassicalguitar.com/duet-play-along-waltz-czerny-method/, source: Duet Play-Along: Waltz by Czerny from Method Vol.1 | This is ..., keywords: waltz
2025-06-18 17:26:43 [root] WARNING: def decode_calendar_id(): Exception for https://jetpack.wordpress.com/jetpack-comment/?blogid=45037674&postid=20221&comment_registration=0&require_name_email=1&stc_enabled=0&stb_enabled=0&show_avatars=0&avatar_default=mystery&greeting=Ask+a+Question+or+Leave+a+Positive+Comment&jetpack_comments_nonce=9dfc0e8bf2&greeting_reply=Leave+a+Reply+to+%25s&color_scheme=light&lang=en_US&jetpack_version=14.7&iframe_unique_id=1&show_cookie_consent=10&has_cookie_consent=0&is_current_user_subscribed=0&token_key=%3Bnormal%3B&sig=7e260a9504266947b5084f6436aa54b2195a595e#parent=https%3A%2F%2Fwww.thisisclassicalguitar.com%2Fduet-play-along-waltz-czerny-method%2F - Invalid base64-encoded string: number of data characters (53) cannot be 1 more than a multiple of 4
2025-06-18 17:26:43 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://jetpack.wordpress.com/jetpack-comment/?blogid=45037674&postid=20221&comment_registration=0&require_name_email=1&stc_enabled=0&stb_enabled=0&show_avatars=0&avatar_default=mystery&greeting=Ask+a+Question+or+Leave+a+Positive+Comment&jetpack_comments_nonce=9dfc0e8bf2&greeting_reply=Leave+a+Reply+to+%25s&color_scheme=light&lang=en_US&jetpack_version=14.7&iframe_unique_id=1&show_cookie_consent=10&has_cookie_consent=0&is_current_user_subscribed=0&token_key=%3Bnormal%3B&sig=7e260a9504266947b5084f6436aa54b2195a595e#parent=https%3A%2F%2Fwww.thisisclassicalguitar.com%2Fduet-play-along-waltz-czerny-method%2F
2025-06-18 17:26:43 [root] INFO: write_url_to_db(): appended URL 'https://jetpack.wordpress.com/jetpack-comment/?blogid=45037674&postid=20221&comment_registration=0&require_name_email=1&stc_enabled=0&stb_enabled=0&show_avatars=0&avatar_default=mystery&greeting=Ask+a+Question+or+Leave+a+Positive+Comment&jetpack_comments_nonce=9dfc0e8bf2&greeting_reply=Leave+a+Reply+to+%25s&color_scheme=light&lang=en_US&jetpack_version=14.7&iframe_unique_id=1&show_cookie_consent=10&has_cookie_consent=0&is_current_user_subscribed=0&token_key=%3Bnormal%3B&sig=7e260a9504266947b5084f6436aa54b2195a595e#parent=https%3A%2F%2Fwww.thisisclassicalguitar.com%2Fduet-play-along-waltz-czerny-method%2F'
2025-06-18 17:26:43 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/lessons/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:43 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/lessons/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:43 [root] INFO: write_url_to_db(): appended URL 'https://www.thisisclassicalguitar.com/lessons/'
2025-06-18 17:26:43 [root] INFO: def parse(): Crawling next URL: https://www.thisisclassicalguitar.com/lessons/
2025-06-18 17:26:43 [scrapy.extensions.logstats] INFO: Crawled 385 pages (at 1 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 17:26:43 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/start-here/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:43 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/start-here/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:43 [root] INFO: write_url_to_db(): appended URL 'https://www.thisisclassicalguitar.com/start-here/'
2025-06-18 17:26:43 [root] INFO: def parse(): Crawling next URL: https://www.thisisclassicalguitar.com/start-here/
2025-06-18 17:26:43 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.google.com/url?sa=t&source=web&rct=j&opi=89978449&url=/maps/dir//seda%2Bdance/data%3D!4m6!4m5!1m1!4e2!1m2!1m1!1s0x548f75d7ebf254e5:0xdc92cc2da43d9826%3Fsa%3DX%26ved%3D1t:3061%26ictx%3D111>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:26:43 [scrapy.core.scraper] ERROR: Error downloading <GET https://folkalley.com/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:26:43 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.5rhythms.com/nl/> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:26:43 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.folkalley.com/song-request/> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:26:43 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.folkalley.com/about/alleychat/> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:26:43 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.folkalley.com/> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:26:43 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://freshgrassfoundation.org/> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:26:43 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:43 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:43 [root] INFO: write_url_to_db(): appended URL 'https://www.thisisclassicalguitar.com/'
2025-06-18 17:26:43 [root] INFO: def parse(): Crawling next URL: https://www.thisisclassicalguitar.com/
2025-06-18 17:26:43 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/duet-play-along-waltz-czerny-method/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:43 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/duet-play-along-waltz-czerny-method/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:43 [root] INFO: write_url_to_db(): appended URL 'https://www.thisisclassicalguitar.com/duet-play-along-waltz-czerny-method/'
2025-06-18 17:26:43 [root] INFO: def parse(): Crawling next URL: https://www.thisisclassicalguitar.com/duet-play-along-waltz-czerny-method/
2025-06-18 17:26:43 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/interest-articles/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:43 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/interest-articles/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:43 [root] INFO: write_url_to_db(): appended URL 'https://www.thisisclassicalguitar.com/category/interest-articles/'
2025-06-18 17:26:43 [root] INFO: def parse(): Crawling next URL: https://www.thisisclassicalguitar.com/category/interest-articles/
2025-06-18 17:26:43 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/classical-guitar-store-reviews/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/classical-guitar-store-reviews/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: write_url_to_db(): appended URL 'https://www.thisisclassicalguitar.com/classical-guitar-store-reviews/'
2025-06-18 17:26:44 [root] INFO: def parse(): Crawling next URL: https://www.thisisclassicalguitar.com/classical-guitar-store-reviews/
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/sheet-music-for-classical-guitar/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/sheet-music-for-classical-guitar/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: write_url_to_db(): appended URL 'https://www.thisisclassicalguitar.com/sheet-music-for-classical-guitar/'
2025-06-18 17:26:44 [root] INFO: def parse(): Crawling next URL: https://www.thisisclassicalguitar.com/sheet-music-for-classical-guitar/
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/classical-guitarists/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/classical-guitarists/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: write_url_to_db(): appended URL 'https://www.thisisclassicalguitar.com/classical-guitarists/'
2025-06-18 17:26:44 [root] INFO: def parse(): Crawling next URL: https://www.thisisclassicalguitar.com/classical-guitarists/
2025-06-18 17:26:44 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.5rhythms.com/nl/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:26:44 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.folkalley.com/song-request/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:26:44 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.folkalley.com/about/alleychat/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:26:44 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.folkalley.com/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:26:44 [scrapy.core.scraper] ERROR: Error downloading <GET https://freshgrassfoundation.org/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/video/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/video/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: write_url_to_db(): appended URL 'https://www.thisisclassicalguitar.com/category/video/'
2025-06-18 17:26:44 [root] INFO: def parse(): Crawling next URL: https://www.thisisclassicalguitar.com/category/video/
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/spotlights-interviews/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/spotlights-interviews/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: write_url_to_db(): appended URL 'https://www.thisisclassicalguitar.com/category/spotlights-interviews/'
2025-06-18 17:26:44 [root] INFO: def parse(): Crawling next URL: https://www.thisisclassicalguitar.com/category/spotlights-interviews/
2025-06-18 17:26:44 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/'
2025-06-18 17:26:44 [root] INFO: def parse(): URL https://butchartgardens.com/ marked as irrelevant (no keywords).
2025-06-18 17:26:44 [root] INFO: def parse(): Found 10 links on https://butchartgardens.com/
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/mediterranean-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/sunken-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/italian-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/rose-garden/ was last seen as relevant, processing it.
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/japanese-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://butchartgardens.com/garden-map/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://butchartgardens.com/garden-map/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/garden-map/'
2025-06-18 17:26:44 [root] INFO: def parse(): Crawling next URL: https://butchartgardens.com/garden-map/
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://butchartgardens.com/?lang=fr was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://butchartgardens.com/?lang=fr was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/?lang=fr'
2025-06-18 17:26:44 [root] INFO: def parse(): Crawling next URL: https://butchartgardens.com/?lang=fr
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://butchartgardens.com/our-story/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://butchartgardens.com/our-story/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/our-story/'
2025-06-18 17:26:44 [root] INFO: def parse(): Crawling next URL: https://butchartgardens.com/our-story/
2025-06-18 17:26:44 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <406 https://bcswingdance.ca/>: HTTP status code is not handled or not allowed
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://butchartgardens.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:44 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://bluegrasscountry.org/shows/brad-kolodner/> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:26:44 [root] INFO: write_url_to_db(): appended URL 'https://pacificopera.ca'
2025-06-18 17:26:44 [root] INFO: def parse(): URL https://pacificopera.ca marked as irrelevant (no keywords).
2025-06-18 17:26:44 [root] INFO: def parse(): Found 10 links on https://pacificopera.ca
2025-06-18 17:26:44 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-P6BKZXG, URL: https://pacificopera.ca, source: Take This Waltz - Pacific Opera Victoria, keywords: waltz
2025-06-18 17:26:44 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 17:26:44 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-P6BKZXG
2025-06-18 17:26:44 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-P6BKZXG'
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://pacificopera.ca was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://pacificopera.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/tickets-subscriptions/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/calendar/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/opera-etc/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/opera-etc/for-youth/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://pacificopera.ca/support/donate/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:44 [scrapy.core.scraper] ERROR: Error downloading <GET https://bluegrasscountry.org/shows/brad-kolodner/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:26:44 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/our-story/'
2025-06-18 17:26:44 [root] INFO: def parse(): URL https://butchartgardens.com/our-story/ marked as irrelevant (no keywords).
2025-06-18 17:26:44 [root] INFO: def parse(): Found 10 links on https://butchartgardens.com/our-story/
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/mediterranean-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/sunken-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/italian-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/rose-garden/ was last seen as relevant, processing it.
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://butchartgardens.com/how-to-get-here/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/japanese-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://tickets.butchartgardens.com/WebStore/shop/viewItems.aspx?cg=tt&c=DAtt was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://butchartgardens.com/hours-rates/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://butchartgardens.com/our-story/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://butchartgardens.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: write_url_to_db(): appended URL 'https://help.gigsalad.com/'
2025-06-18 17:26:44 [root] INFO: def parse(): URL https://help.gigsalad.com/ marked as irrelevant (no keywords).
2025-06-18 17:26:44 [root] INFO: def parse(): Found 3 links on https://help.gigsalad.com/
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://www.helpscout.com/docs-refer/?co=GigSalad&utm_source=docs&utm_medium=footerlink&utm_campaign=Docs+Branding was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: should_process_url: URL https://www.helpscout.com/docs-refer/?co=GigSalad&utm_source=docs&utm_medium=footerlink&utm_campaign=Docs+Branding was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:44 [root] INFO: write_url_to_db(): appended URL 'https://www.helpscout.com/docs-refer/?co=GigSalad&utm_source=docs&utm_medium=footerlink&utm_campaign=Docs+Branding'
2025-06-18 17:26:44 [root] INFO: def parse(): Crawling next URL: https://www.helpscout.com/docs-refer/?co=GigSalad&utm_source=docs&utm_medium=footerlink&utm_campaign=Docs+Branding
2025-06-18 17:26:44 [root] INFO: def parse(): Found keywords for URL https://www.thisisclassicalguitar.com/lessons/: ['swing', 'waltz']
2025-06-18 17:26:44 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.thisisclassicalguitar.com/lessons/
2025-06-18 17:26:44 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:26:44 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:26:44 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:26:58 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:26:58 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 17:26:58 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 17:26:58 [root] INFO: write_url_to_db(): appended URL 'https://www.thisisclassicalguitar.com/lessons/'
2025-06-18 17:26:58 [root] INFO: def parse(): URL https://www.thisisclassicalguitar.com/lessons/ marked as irrelevant (LLM negative).
2025-06-18 17:26:58 [root] INFO: def parse(): Found 10 links on https://www.thisisclassicalguitar.com/lessons/
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/lessons/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/start-here/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/interest-articles/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/classical-guitar-store-reviews/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/sheet-music-for-classical-guitar/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/classical-guitarists/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/video/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/spotlights-interviews/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: write_url_to_db(): appended URL 'https://help.gigsalad.com/article/76-worry-free-guarantee'
2025-06-18 17:26:58 [root] INFO: def parse(): URL https://help.gigsalad.com/article/76-worry-free-guarantee marked as irrelevant (no keywords).
2025-06-18 17:26:58 [root] INFO: def parse(): Found 4 links on https://help.gigsalad.com/article/76-worry-free-guarantee
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://www.helpscout.com/docs-refer/?co=GigSalad&utm_source=docs&utm_medium=footerlink&utm_campaign=Docs+Branding was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://www.gigsalad.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://www.gigsalad.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: write_url_to_db(): appended URL 'https://www.gigsalad.com'
2025-06-18 17:26:58 [root] INFO: def parse(): Crawling next URL: https://www.gigsalad.com
2025-06-18 17:26:58 [root] INFO: write_url_to_db(): appended URL 'https://pacificopera.ca/whats-on/opera-etc/'
2025-06-18 17:26:58 [root] INFO: def parse(): URL https://pacificopera.ca/whats-on/opera-etc/ marked as irrelevant (no keywords).
2025-06-18 17:26:58 [root] INFO: def parse(): Found 10 links on https://pacificopera.ca/whats-on/opera-etc/
2025-06-18 17:26:58 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-P6BKZXG, URL: https://pacificopera.ca/whats-on/opera-etc/, source: Take This Waltz - Pacific Opera Victoria, keywords: waltz
2025-06-18 17:26:58 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 17:26:58 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-P6BKZXG
2025-06-18 17:26:58 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-P6BKZXG'
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://pacificopera.ca was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://pacificopera.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/tickets-subscriptions/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/calendar/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/opera-etc/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/opera-etc/for-youth/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://pacificopera.ca/support/donate/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://www.gigsalad.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://help.gigsalad.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://www.gigsalad.com/contact was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://www.gigsalad.com/contact was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: write_url_to_db(): appended URL 'https://www.gigsalad.com/contact'
2025-06-18 17:26:58 [root] INFO: def parse(): Crawling next URL: https://www.gigsalad.com/contact
2025-06-18 17:26:58 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://folkalley.com/staff/> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://help.gigsalad.com/article/76-worry-free-guarantee was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: write_url_to_db(): appended URL 'https://pacificopera.ca/whats-on/calendar/'
2025-06-18 17:26:58 [root] INFO: def parse(): URL https://pacificopera.ca/whats-on/calendar/ marked as irrelevant (no keywords).
2025-06-18 17:26:58 [root] INFO: def parse(): Found 10 links on https://pacificopera.ca/whats-on/calendar/
2025-06-18 17:26:58 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-P6BKZXG, URL: https://pacificopera.ca/whats-on/calendar/, source: Take This Waltz - Pacific Opera Victoria, keywords: waltz
2025-06-18 17:26:58 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 17:26:58 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-P6BKZXG
2025-06-18 17:26:58 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-P6BKZXG'
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://pacificopera.ca was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://pacificopera.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/tickets-subscriptions/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/calendar/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/opera-etc/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/opera-etc/for-youth/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://pacificopera.ca/support/donate/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: write_url_to_db(): appended URL 'https://pacificopera.ca/support/donate/'
2025-06-18 17:26:58 [root] INFO: def parse(): URL https://pacificopera.ca/support/donate/ marked as irrelevant (no keywords).
2025-06-18 17:26:58 [root] INFO: def parse(): Found 10 links on https://pacificopera.ca/support/donate/
2025-06-18 17:26:58 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-P6BKZXG, URL: https://pacificopera.ca/support/donate/, source: Take This Waltz - Pacific Opera Victoria, keywords: waltz
2025-06-18 17:26:58 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 17:26:58 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-P6BKZXG
2025-06-18 17:26:58 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-P6BKZXG'
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://pacificopera.ca was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://pacificopera.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/tickets-subscriptions/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/calendar/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/opera-etc/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/opera-etc/for-youth/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://pacificopera.ca/support/donate/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: write_url_to_db(): appended URL 'https://www.thisisclassicalguitar.com/start-here/'
2025-06-18 17:26:58 [root] INFO: def parse(): URL https://www.thisisclassicalguitar.com/start-here/ marked as irrelevant (no keywords).
2025-06-18 17:26:58 [root] INFO: def parse(): Found 10 links on https://www.thisisclassicalguitar.com/start-here/
2025-06-18 17:26:58 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.youtube.com/embed/nQOJ2OFsOrQ?feature=oembed, URL: https://www.thisisclassicalguitar.com/start-here/, source: Duet Play-Along: Waltz by Czerny from Method Vol.1 | This is ..., keywords: waltz
2025-06-18 17:26:58 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: 2nm(ml:yn
2025-06-18 17:26:58 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.youtube.com/embed/nQOJ2OFsOrQ?feature=oembed
2025-06-18 17:26:58 [root] INFO: write_url_to_db(): appended URL 'https://www.youtube.com/embed/nQOJ2OFsOrQ?feature=oembed'
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/lessons/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/start-here/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/interest-articles/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/classical-guitar-store-reviews/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/sheet-music-for-classical-guitar/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/classical-guitarists/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/video/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/spotlights-interviews/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: write_url_to_db(): appended URL 'https://bsky.app/profile/swimintosound.bsky.social'
2025-06-18 17:26:58 [root] INFO: def parse(): URL https://bsky.app/profile/swimintosound.bsky.social marked as irrelevant (no keywords).
2025-06-18 17:26:58 [root] INFO: def parse(): Found 2 links on https://bsky.app/profile/swimintosound.bsky.social
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://bsky.social was last seen as relevant, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://bsky.social was last seen as relevant, processing it.
2025-06-18 17:26:58 [root] INFO: write_url_to_db(): appended URL 'https://bsky.social'
2025-06-18 17:26:58 [root] INFO: def parse(): Crawling next URL: https://bsky.social
2025-06-18 17:26:58 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/?lang=fr'
2025-06-18 17:26:58 [root] INFO: def parse(): URL https://butchartgardens.com/?lang=fr marked as irrelevant (no keywords).
2025-06-18 17:26:58 [root] INFO: def parse(): Found 10 links on https://butchartgardens.com/?lang=fr
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/jardin-japonais/?lang=fr was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/jardin-japonais/?lang=fr was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/garden/jardin-japonais/?lang=fr'
2025-06-18 17:26:58 [root] INFO: def parse(): Crawling next URL: https://butchartgardens.com/garden/jardin-japonais/?lang=fr
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://butchartgardens.com/carte-des-jardins/?lang=fr was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://butchartgardens.com/carte-des-jardins/?lang=fr was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/carte-des-jardins/?lang=fr'
2025-06-18 17:26:58 [root] INFO: def parse(): Crawling next URL: https://butchartgardens.com/carte-des-jardins/?lang=fr
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://butchartgardens.com/notre-histoire/?lang=fr was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://butchartgardens.com/notre-histoire/?lang=fr was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/notre-histoire/?lang=fr'
2025-06-18 17:26:58 [root] INFO: def parse(): Crawling next URL: https://butchartgardens.com/notre-histoire/?lang=fr
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/jardin-mediterraneen/?lang=fr was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/jardin-mediterraneen/?lang=fr was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/garden/jardin-mediterraneen/?lang=fr'
2025-06-18 17:26:58 [root] INFO: def parse(): Crawling next URL: https://butchartgardens.com/garden/jardin-mediterraneen/?lang=fr
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/jardin-italien/?lang=fr was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/jardin-italien/?lang=fr was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/garden/jardin-italien/?lang=fr'
2025-06-18 17:26:58 [root] INFO: def parse(): Crawling next URL: https://butchartgardens.com/garden/jardin-italien/?lang=fr
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/jardin-de-roses/?lang=fr was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/jardin-de-roses/?lang=fr was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/garden/jardin-de-roses/?lang=fr'
2025-06-18 17:26:58 [root] INFO: def parse(): Crawling next URL: https://butchartgardens.com/garden/jardin-de-roses/?lang=fr
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/jardin-en-contrebas/?lang=fr was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/jardin-en-contrebas/?lang=fr was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/garden/jardin-en-contrebas/?lang=fr'
2025-06-18 17:26:58 [root] INFO: def parse(): Crawling next URL: https://butchartgardens.com/garden/jardin-en-contrebas/?lang=fr
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://butchartgardens.com/?lang=fr was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://butchartgardens.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: write_url_to_db(): appended URL 'https://butchartgardens.com/garden-map/'
2025-06-18 17:26:58 [root] INFO: def parse(): URL https://butchartgardens.com/garden-map/ marked as irrelevant (no keywords).
2025-06-18 17:26:58 [root] INFO: def parse(): Found 10 links on https://butchartgardens.com/garden-map/
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/mediterranean-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:58 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/sunken-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/italian-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/rose-garden/ was last seen as relevant, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://butchartgardens.com/how-to-get-here/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://butchartgardens.com/garden/japanese-garden/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://butchartgardens.com/garden-map/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://tickets.butchartgardens.com/WebStore/shop/viewItems.aspx?cg=tt&c=DAtt was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://butchartgardens.com/hours-rates/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://butchartgardens.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://atproto.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://atproto.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: write_url_to_db(): appended URL 'https://atproto.com'
2025-06-18 17:26:59 [root] INFO: def parse(): Crawling next URL: https://atproto.com
2025-06-18 17:26:59 [scrapy.core.scraper] ERROR: Error downloading <GET https://folkalley.com/staff/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://bsky.app/profile/swimintosound.bsky.social was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: write_url_to_db(): appended URL 'https://www.thisisclassicalguitar.com/classical-guitar-store-reviews/'
2025-06-18 17:26:59 [root] INFO: def parse(): URL https://www.thisisclassicalguitar.com/classical-guitar-store-reviews/ marked as irrelevant (no keywords).
2025-06-18 17:26:59 [root] INFO: def parse(): Found 10 links on https://www.thisisclassicalguitar.com/classical-guitar-store-reviews/
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/lessons/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/start-here/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/interest-articles/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/classical-guitar-store-reviews/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/sheet-music-for-classical-guitar/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/classical-guitarists/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/video/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/spotlights-interviews/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: write_url_to_db(): appended URL 'https://www.thisisclassicalguitar.com/category/interest-articles/'
2025-06-18 17:26:59 [root] INFO: def parse(): URL https://www.thisisclassicalguitar.com/category/interest-articles/ marked as irrelevant (no keywords).
2025-06-18 17:26:59 [root] INFO: def parse(): Found 10 links on https://www.thisisclassicalguitar.com/category/interest-articles/
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/lessons/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/start-here/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/interest-articles/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/classical-guitar-store-reviews/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/sheet-music-for-classical-guitar/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/classical-guitarists/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/video/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/spotlights-interviews/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: write_url_to_db(): appended URL 'https://www.thisisclassicalguitar.com/category/spotlights-interviews/'
2025-06-18 17:26:59 [root] INFO: def parse(): URL https://www.thisisclassicalguitar.com/category/spotlights-interviews/ marked as irrelevant (no keywords).
2025-06-18 17:26:59 [root] INFO: def parse(): Found 10 links on https://www.thisisclassicalguitar.com/category/spotlights-interviews/
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/lessons/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/start-here/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/interest-articles/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/classical-guitar-store-reviews/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/sheet-music-for-classical-guitar/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/classical-guitarists/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/video/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/spotlights-interviews/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: write_url_to_db(): appended URL 'https://pacificopera.ca/whats-on/opera-etc/for-youth/'
2025-06-18 17:26:59 [root] INFO: def parse(): URL https://pacificopera.ca/whats-on/opera-etc/for-youth/ marked as irrelevant (no keywords).
2025-06-18 17:26:59 [root] INFO: def parse(): Found 10 links on https://pacificopera.ca/whats-on/opera-etc/for-youth/
2025-06-18 17:26:59 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-P6BKZXG, URL: https://pacificopera.ca/whats-on/opera-etc/for-youth/, source: Take This Waltz - Pacific Opera Victoria, keywords: waltz
2025-06-18 17:26:59 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 17:26:59 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-P6BKZXG
2025-06-18 17:26:59 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-P6BKZXG'
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://pacificopera.ca was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://pacificopera.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/tickets-subscriptions/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/calendar/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/opera-etc/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/opera-etc/for-youth/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://pacificopera.ca/support/donate/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: write_url_to_db(): appended URL 'https://www.thisisclassicalguitar.com/classical-guitarists/'
2025-06-18 17:26:59 [root] INFO: def parse(): URL https://www.thisisclassicalguitar.com/classical-guitarists/ marked as irrelevant (no keywords).
2025-06-18 17:26:59 [root] INFO: def parse(): Found 10 links on https://www.thisisclassicalguitar.com/classical-guitarists/
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/lessons/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/start-here/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/interest-articles/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/classical-guitar-store-reviews/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/sheet-music-for-classical-guitar/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/classical-guitarists/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/video/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/spotlights-interviews/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:26:59 [root] INFO: def parse(): Found keywords for URL https://www.thisisclassicalguitar.com/sheet-music-for-classical-guitar/: ['waltz']
2025-06-18 17:26:59 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.thisisclassicalguitar.com/sheet-music-for-classical-guitar/
2025-06-18 17:26:59 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:26:59 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:26:59 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:27:24 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:27:24 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 17:27:24 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 17:27:24 [root] INFO: write_url_to_db(): appended URL 'https://www.thisisclassicalguitar.com/sheet-music-for-classical-guitar/'
2025-06-18 17:27:24 [root] INFO: def parse(): URL https://www.thisisclassicalguitar.com/sheet-music-for-classical-guitar/ marked as irrelevant (LLM negative).
2025-06-18 17:27:24 [root] INFO: def parse(): Found 10 links on https://www.thisisclassicalguitar.com/sheet-music-for-classical-guitar/
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/lessons/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/start-here/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/interest-articles/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/classical-guitar-store-reviews/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/sheet-music-for-classical-guitar/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/classical-guitarists/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/video/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/spotlights-interviews/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: write_url_to_db(): appended URL 'https://www.thisisclassicalguitar.com/category/video/'
2025-06-18 17:27:24 [root] INFO: def parse(): URL https://www.thisisclassicalguitar.com/category/video/ marked as irrelevant (no keywords).
2025-06-18 17:27:24 [root] INFO: def parse(): Found 10 links on https://www.thisisclassicalguitar.com/category/video/
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/lessons/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/start-here/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/interest-articles/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/classical-guitar-store-reviews/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/sheet-music-for-classical-guitar/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/classical-guitarists/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/video/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/spotlights-interviews/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: write_url_to_db(): appended URL 'https://pacificopera.ca/whats-on/tickets-subscriptions/'
2025-06-18 17:27:24 [root] INFO: def parse(): URL https://pacificopera.ca/whats-on/tickets-subscriptions/ marked as irrelevant (no keywords).
2025-06-18 17:27:24 [root] INFO: def parse(): Found 10 links on https://pacificopera.ca/whats-on/tickets-subscriptions/subscriptions/
2025-06-18 17:27:24 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-P6BKZXG, URL: https://pacificopera.ca/whats-on/tickets-subscriptions/, source: Take This Waltz - Pacific Opera Victoria, keywords: waltz
2025-06-18 17:27:24 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 17:27:24 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-P6BKZXG
2025-06-18 17:27:24 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-P6BKZXG'
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://pacificopera.ca was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://pacificopera.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/tickets-subscriptions/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/calendar/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/opera-etc/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://pacificopera.ca/whats-on/opera-etc/for-youth/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://pacificopera.ca/support/donate/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:27:24 [scrapy.extensions.logstats] INFO: Crawled 414 pages (at 29 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 17:27:24 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://folkalley.com/about/listen/mobile> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:27:24 [root] INFO: write_url_to_db(): appended URL 'https://www.thisisclassicalguitar.com/'
2025-06-18 17:27:24 [root] INFO: def parse(): URL https://www.thisisclassicalguitar.com/ marked as irrelevant (no keywords).
2025-06-18 17:27:24 [root] INFO: def parse(): Found 10 links on https://www.thisisclassicalguitar.com/
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/lessons/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/start-here/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/interest-articles/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/classical-guitar-store-reviews/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/sheet-music-for-classical-guitar/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/classical-guitarists/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/video/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:27:24 [root] INFO: should_process_url: URL https://www.thisisclassicalguitar.com/category/spotlights-interviews/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:27:24 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://stringsmagazine.com/forget-me-not-is-a-simple-waltz-that-offers-fiddlers-freedom-at-a-gentle-tempo/> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:27:24 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://bluegrasscountry.org/brad-kolodner-on-air-interviews/> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:27:24 [scrapy.core.scraper] ERROR: Error downloading <GET https://folkalley.com/about/listen/mobile>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:27:24 [root] INFO: def parse(): Found keywords for URL https://www.5rhythms.com/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/: ['dance']
2025-06-18 17:27:24 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.5rhythms.com/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/
2025-06-18 17:27:24 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:27:24 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:27:24 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:28:10 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:28:10 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "https://www.5rhythms.com/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/",
        "dance_style": "",
        "url": "",
        "event_type": "workshop",
        "event_name": "5Rhythms Waves Teacher Training",
        "day_of_week": "",
        "start_date": "2026-02-01",
        "end_date": "2026-02-01",
        "start_time": "",
        "end_time": null,
        "price": "$11,300",
        "location": "",
        "description": "The 5Rhythms Dancing Path is a life-long journey. The Dancing Path to becoming a teacher is also one that requires many hours of practice, that translates into years of dancing. We appreciate your enthusiasm for the 5Rhythms practice and wanting to teach the practice. We also understand that for some of you the number of prerequisites required to apply for the training may feel overwhelming. Please know that the depth of experience required to become a certified teacher is what has made the teachers you study with such inspiring and adept teachers and teachings."
    }
]
2025-06-18 17:28:10 [root] INFO: def extract_and_parse_json(): for url https://www.5rhythms.com/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "https://www.5rhythms.com/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/",
        "dance_style": "",
        "url": "",
        "event_type": "workshop",
        "event_name": "5Rhythms Waves Teacher Training",
        "day_of_week": "",
        "start_date": "2026-02-01",
        "end_date": "2026-02-01",
        "start_time": "",
        "end_time": null,
        "price": "$11,300",
        "location": "",
        "description": "The 5Rhythms Dancing Path is a life-long journey. The Dancing Path to becoming a teacher is also one that requires many hours of practice, that translates into years of dancing. We appreciate your enthusiasm for the 5Rhythms practice and wanting to teach the practice. We also understand that for some of you the number of prerequisites required to apply for the training may feel overwhelming. Please know that the depth of experience required to become a certified teacher is what has made the teachers you study with such inspiring and adept teachers and teachings."
    }
]
2025-06-18 17:28:10 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 17:28:10 [root] INFO: write_events_to_db: Number of events to write: 1
2025-06-18 17:28:10 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/'
2025-06-18 17:28:10 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 17:28:10 [root] INFO: def process_llm_response: URL https://www.5rhythms.com/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ marked as relevant with events written to the database.
2025-06-18 17:28:10 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/'
2025-06-18 17:28:10 [root] INFO: def parse(): URL https://www.5rhythms.com/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ marked as relevant (LLM positive).
2025-06-18 17:28:10 [root] INFO: def parse(): Found 10 links on https://www.5rhythms.com/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/
2025-06-18 17:28:10 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/5rhythms'
2025-06-18 17:28:10 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/5rhythms
2025-06-18 17:28:10 [root] INFO: write_url_to_db(): appended URL 'https://instagram.com/5rhythms/'
2025-06-18 17:28:10 [root] INFO: def parse(): Recorded unwanted URL: https://instagram.com/5rhythms/
2025-06-18 17:28:10 [root] INFO: should_process_url: URL https://www.5rhythms.com/EventSearch.php was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:28:10 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/5Rhythms.
2025-06-18 17:28:10 [root] INFO: should_process_url: URL https://www.5rhythms.com/shop/ has never been seen before, processing it.
2025-06-18 17:28:10 [root] INFO: should_process_url: URL https://www.5rhythms.com/shop/ has never been seen before, processing it.
2025-06-18 17:28:10 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/shop/'
2025-06-18 17:28:10 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/shop/
2025-06-18 17:28:10 [root] INFO: def parse(): Found keywords for URL https://www.5rhythms.com/nl/who-we-are/teacher-communities/the-americas/canada-west-coast/: ['dance']
2025-06-18 17:28:10 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.5rhythms.com/nl/who-we-are/teacher-communities/the-americas/canada-west-coast/
2025-06-18 17:28:10 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:28:10 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:28:10 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:28:35 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:28:35 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "5Rhythms | Westkust van Canada",
        "dance_style": "",
        "url": "",
        "event_type": "workshop",
        "event_name": "UNTAMED: Campout Retreat WILD EXPANSION",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-22",
        "start_time": "",
        "end_time": null,
        "price": "$485",
        "location": "Salt Spring Island",
        "description": "Includes: 2 nights camping, 5 meals and 5 sessions. This workshop invites participants to welcome in the Summer Solstice with dance, writing, circle/partner work and ritual. We will honour the power of the sun and the energy of stepping fully into our untamed, radiant selves. Includes sunrise and sunset sessions."
    },
    {
        "source": "5Rhythms | Westkust van Canada",
        "dance_style": "",
        "url": "",
        "event_type": "workshop",
        "event_name": "FLOWSTATE",
        "day_of_week": "Saturday",
        "start_date": "2025-06-28",
        "end_date": "2025-06-28",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Vancouver",
        "description": "A deep current of presence that lives beneath the surface of doing, striving, or performing. This one-day 5Rhythms® workshop is designed to step into this current. To dance not just for expression, but for access — into the subtle intelligence of the body, the rhythms of the soul, and the spacious stillness that follows."
    }
]
2025-06-18 17:28:35 [root] INFO: def extract_and_parse_json(): for url https://www.5rhythms.com/nl/who-we-are/teacher-communities/the-americas/canada-west-coast/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "5Rhythms | Westkust van Canada",
        "dance_style": "",
        "url": "",
        "event_type": "workshop",
        "event_name": "UNTAMED: Campout Retreat WILD EXPANSION",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-22",
        "start_time": "",
        "end_time": null,
        "price": "$485",
        "location": "Salt Spring Island",
        "description": "Includes: 2 nights camping, 5 meals and 5 sessions. This workshop invites participants to welcome in the Summer Solstice with dance, writing, circle/partner work and ritual. We will honour the power of the sun and the energy of stepping fully into our untamed, radiant selves. Includes sunrise and sunset sessions."
    },
    {
        "source": "5Rhythms | Westkust van Canada",
        "dance_style": "",
        "url": "",
        "event_type": "workshop",
        "event_name": "FLOWSTATE",
        "day_of_week": "Saturday",
        "start_date": "2025-06-28",
        "end_date": "2025-06-28",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "Vancouver",
        "description": "A deep current of presence that lives beneath the surface of doing, striving, or performing. This one-day 5Rhythms® workshop is designed to step into this current. To dance not just for expression, but for access — into the subtle intelligence of the body, the rhythms of the soul, and the spacious stillness that follows."
    }
]
2025-06-18 17:28:35 [root] INFO: def clean_up_address(): Starting with events_df shape: (2, 14)
2025-06-18 17:28:35 [root] INFO: def clean_up_address(): Processing location 'Salt Spring Island' (event_id: None)
2025-06-18 17:28:35 [root] INFO: def clean_up_address(): Processing location 'Vancouver' (event_id: None)
2025-06-18 17:28:35 [root] INFO: write_events_to_db: Number of events to write: 2
2025-06-18 17:28:35 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/nl/who-we-are/teacher-communities/the-americas/canada-west-coast/'
2025-06-18 17:28:35 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 17:28:35 [root] INFO: def process_llm_response: URL https://www.5rhythms.com/nl/who-we-are/teacher-communities/the-americas/canada-west-coast/ marked as relevant with events written to the database.
2025-06-18 17:28:35 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/nl/who-we-are/teacher-communities/the-americas/canada-west-coast/'
2025-06-18 17:28:35 [root] INFO: def parse(): URL https://www.5rhythms.com/nl/who-we-are/teacher-communities/the-americas/canada-west-coast/ marked as relevant (LLM positive).
2025-06-18 17:28:35 [root] INFO: def parse(): Found 10 links on https://www.5rhythms.com/nl/who-we-are/teacher-communities/the-americas/canada-west-coast/
2025-06-18 17:28:35 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/5rhythms'
2025-06-18 17:28:35 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/5rhythms
2025-06-18 17:28:35 [root] INFO: write_url_to_db(): appended URL 'https://instagram.com/5rhythms/'
2025-06-18 17:28:35 [root] INFO: def parse(): Recorded unwanted URL: https://instagram.com/5rhythms/
2025-06-18 17:28:35 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/who-we-are/teacher-communities/the-americas/canada-west-coast/ was last seen as relevant, processing it.
2025-06-18 17:28:35 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/5Rhythms.
2025-06-18 17:28:35 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:28:35 [root] INFO: should_process_url: URL https://www.5rhythms.com/who-we-are/teacher-communities/the-americas/canada-west-coast/ was last seen as not relevant but hit_ratio (3.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 17:28:35 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl//EventSearch.php was last seen as relevant, processing it.
2025-06-18 17:28:35 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl//EventSearch.php was last seen as relevant, processing it.
2025-06-18 17:28:35 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/nl//EventSearch.php'
2025-06-18 17:28:35 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/nl//EventSearch.php
2025-06-18 17:28:35 [root] INFO: def parse(): Found keywords for URL https://www.5rhythms.com/TeacherSearch.php: ['dance']
2025-06-18 17:28:35 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.5rhythms.com/TeacherSearch.php
2025-06-18 17:28:35 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:28:35 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:28:35 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:28:36 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-06-18 17:28:36 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 429
{"object":"rejection","message":"Service tier capacity exceeded for this model.","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 17:28:36 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 17:28:40 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:28:40 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 17:28:40 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 17:28:40 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/TeacherSearch.php'
2025-06-18 17:28:40 [root] INFO: def parse(): URL https://www.5rhythms.com/TeacherSearch.php marked as irrelevant (LLM negative).
2025-06-18 17:28:40 [root] INFO: def parse(): Found 10 links on https://www.5rhythms.com/TeacherSearch.php
2025-06-18 17:28:40 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/5rhythms'
2025-06-18 17:28:40 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/5rhythms
2025-06-18 17:28:40 [root] INFO: write_url_to_db(): appended URL 'https://instagram.com/5rhythms/'
2025-06-18 17:28:40 [root] INFO: def parse(): Recorded unwanted URL: https://instagram.com/5rhythms/
2025-06-18 17:28:40 [root] INFO: should_process_url: URL https://www.5rhythms.com/EventSearch.php was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:28:40 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/5Rhythms.
2025-06-18 17:28:40 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:28:40 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:28:40 [root] INFO: should_process_url: URL https://www.5rhythms.com/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:28:40 [root] INFO: should_process_url: URL https://www.5rhythms.com/es/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:28:40 [root] INFO: should_process_url: URL https://www.5rhythms.com/TeacherSearch.php was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:28:40 [root] INFO: should_process_url: URL https://www.5rhythms.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:28:40 [root] INFO: def parse(): Found keywords for URL https://www.gigsalad.com: ['dance', 'salsa', 'swing']
2025-06-18 17:28:40 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.gigsalad.com
2025-06-18 17:28:40 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:28:40 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:28:40 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:29:44 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:29:44 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "https://www.gigsalad.com",
        "dance_style": "salsa",
        "url": "",
        "event_type": "class",
        "event_name": "Salsa Dancer",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Salsa Dancers"
    },
    {
        "source": "https://www.gigsalad.com",
        "dance_style": "belly",
        "url": "",
        "event_type": "class",
        "event_name": "Belly Dancer",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Belly Dancers"
    },
    {
        "source": "https://www.gigsalad.com",
        "dance_style": "break",
        "url": "",
        "event_type": "class",
        "event_name": "Break Dancer Krump Dance",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Break Dancers"
    },
    {
        "source": "https://www.gigsalad.com",
        "dance_style": "douceur",
        "url": "",
        "event_type": "class",
        "event_name": "Choreographer",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Choreographers"
    },
    {
        "source": "https://www.gigsalad.com",
        "dance_style": "douceur",
        "url": "",
        "event_type": "class",
        "event_name": "Dance Instructor",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Dance Instructors"
    },
    {
        "source": "https://www.gigsalad.com",
        "dance_style": "douceur",
        "url": "",
        "event_type": "class",
        "event_name": "Dance Troupe",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Dance Troupes"
    },
    {
        "source": "https://www.gigsalad.com",
        "dance_style": "hula",
        "url": "",
        "event_type": "class",
        "event_name": "Hula Dancers",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Hula Dancers"
    },
    {
        "source": "https://www.gigsalad.com",
        "dance_style": "irish",
        "url": "",
        "event_type": "class",
        "event_name": "Irish Dance",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Irish Dancers"
    },
    {
        "source": "https://www.gigsalad.com",
        "dance_style": "salsa",
        "url": "",
        "event_type": "class",
        "event_name": "Salsa Dancer",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Salsa Dancers"
    },
    {
        "source": "https://www.gigsalad.com",
        "dance_style": "tango",
        "url": "",
        "event_type": "class",
        "event_name": "Tango Dancer",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Tango Dancers"
    }
]
2025-06-18 17:29:44 [root] INFO: def extract_and_parse_json(): for url https://www.gigsalad.com, 
Cleaned JSON ready for parsing:
[
    {
        "source": "https://www.gigsalad.com",
        "dance_style": "salsa",
        "url": "",
        "event_type": "class",
        "event_name": "Salsa Dancer",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Salsa Dancers"
    },
    {
        "source": "https://www.gigsalad.com",
        "dance_style": "belly",
        "url": "",
        "event_type": "class",
        "event_name": "Belly Dancer",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Belly Dancers"
    },
    {
        "source": "https://www.gigsalad.com",
        "dance_style": "break",
        "url": "",
        "event_type": "class",
        "event_name": "Break Dancer Krump Dance",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Break Dancers"
    },
    {
        "source": "https://www.gigsalad.com",
        "dance_style": "douceur",
        "url": "",
        "event_type": "class",
        "event_name": "Choreographer",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Choreographers"
    },
    {
        "source": "https://www.gigsalad.com",
        "dance_style": "douceur",
        "url": "",
        "event_type": "class",
        "event_name": "Dance Instructor",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Dance Instructors"
    },
    {
        "source": "https://www.gigsalad.com",
        "dance_style": "douceur",
        "url": "",
        "event_type": "class",
        "event_name": "Dance Troupe",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Dance Troupes"
    },
    {
        "source": "https://www.gigsalad.com",
        "dance_style": "hula",
        "url": "",
        "event_type": "class",
        "event_name": "Hula Dancers",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Hula Dancers"
    },
    {
        "source": "https://www.gigsalad.com",
        "dance_style": "irish",
        "url": "",
        "event_type": "class",
        "event_name": "Irish Dance",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Irish Dancers"
    },
    {
        "source": "https://www.gigsalad.com",
        "dance_style": "salsa",
        "url": "",
        "event_type": "class",
        "event_name": "Salsa Dancer",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Salsa Dancers"
    },
    {
        "source": "https://www.gigsalad.com",
        "dance_style": "tango",
        "url": "",
        "event_type": "class",
        "event_name": "Tango Dancer",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "",
        "description": "Tango Dancers"
    }
]
2025-06-18 17:29:44 [root] INFO: def clean_up_address(): Starting with events_df shape: (10, 14)
2025-06-18 17:29:44 [root] INFO: write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 17:29:44 [root] INFO: write_url_to_db(): appended URL 'https://www.gigsalad.com'
2025-06-18 17:29:44 [root] INFO: def process_llm_response: URL https://www.gigsalad.com marked as relevant with events written to the database.
2025-06-18 17:29:44 [root] INFO: write_url_to_db(): appended URL 'https://www.gigsalad.com'
2025-06-18 17:29:44 [root] INFO: def parse(): URL https://www.gigsalad.com marked as relevant (LLM positive).
2025-06-18 17:29:44 [root] INFO: def parse(): Found 10 links on https://www.gigsalad.com
2025-06-18 17:29:44 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/gigsalad/'
2025-06-18 17:29:44 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/gigsalad/
2025-06-18 17:29:44 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/gigsalad'
2025-06-18 17:29:44 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/gigsalad
2025-06-18 17:29:44 [root] INFO: should_process_url: URL https://www.gigsalad.com/about was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:29:44 [root] INFO: should_process_url: URL https://www.gigsalad.com/about was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:29:44 [root] INFO: write_url_to_db(): appended URL 'https://www.gigsalad.com/about'
2025-06-18 17:29:44 [root] INFO: def parse(): Crawling next URL: https://www.gigsalad.com/about
2025-06-18 17:29:44 [root] INFO: should_process_url: URL https://www.gigsalad.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:29:44 [root] INFO: should_process_url: URL https://help.gigsalad.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:29:44 [root] INFO: should_process_url: URL https://help.gigsalad.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:29:44 [root] INFO: write_url_to_db(): appended URL 'https://www.gigsalad.com/contact'
2025-06-18 17:29:44 [root] INFO: def parse(): URL https://www.gigsalad.com/contact marked as irrelevant (no keywords).
2025-06-18 17:29:44 [root] INFO: def parse(): Found 10 links on https://www.gigsalad.com/contact
2025-06-18 17:29:44 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/gigsalad/'
2025-06-18 17:29:44 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/gigsalad/
2025-06-18 17:29:44 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/gigsalad'
2025-06-18 17:29:44 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/gigsalad
2025-06-18 17:29:44 [root] INFO: should_process_url: URL https://www.gigsalad.com/about was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:29:44 [root] INFO: should_process_url: URL https://www.gigsalad.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:29:44 [root] INFO: should_process_url: URL https://help.gigsalad.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:29:44 [root] INFO: should_process_url: URL https://www.gigsalad.com/contact was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:29:44 [root] INFO: should_process_url: URL https://help.gigsalad.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:29:44 [root] INFO: write_url_to_db(): appended URL 'https://bradkolodner.us5.list-manage.com/track/click?u=67046729f55eae5595c0bcd71&id=e7d532fe31&e=4148c9939a'
2025-06-18 17:29:44 [root] INFO: def parse(): URL https://bradkolodner.us5.list-manage.com/track/click?u=67046729f55eae5595c0bcd71&id=e7d532fe31&e=4148c9939a marked as irrelevant (no keywords).
2025-06-18 17:29:44 [root] INFO: def parse(): Found 10 links on https://folkalley.com/
2025-06-18 17:29:44 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/folkalley/'
2025-06-18 17:29:44 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/folkalley/
2025-06-18 17:29:44 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/FolkAlley/'
2025-06-18 17:29:44 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/FolkAlley/
2025-06-18 17:29:44 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/folkalley.
2025-06-18 17:29:44 [root] INFO: should_process_url: URL https://bradkolodner.us5.list-manage.com/track/click?u=67046729f55eae5595c0bcd71&id=e7d532fe31&e=4148c9939a was last seen as relevant, processing it.
2025-06-18 17:29:44 [root] INFO: should_process_url: URL https://folkalley.com/folk-alley-radio-show/ was last seen as relevant, processing it.
2025-06-18 17:29:44 [root] INFO: should_process_url: URL https://folkalley.com/ was last seen as relevant, processing it.
2025-06-18 17:29:44 [root] INFO: should_process_url: URL https://folkalley.com/stream/folk-alley/ was last seen as relevant, processing it.
2025-06-18 17:29:44 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/user/FolkAlleydotCom/.
2025-06-18 17:29:44 [root] INFO: should_process_url: URL https://folkalley.com/category/podcasts/ was last seen as relevant, processing it.
2025-06-18 17:29:44 [root] INFO: should_process_url: URL https://folkalley.com/category/specialty-hours/ was last seen as relevant, processing it.
2025-06-18 17:29:44 [root] INFO: def parse(): Found keywords for URL http://www.folkworld.eu/81/e/cds1.html: ['dance', 'swing', 'tango', 'two step', 'waltz', 'zouk']
2025-06-18 17:29:44 [root] INFO: def generate_prompt(): Generating prompt for URL: http://www.folkworld.eu/81/e/cds1.html
2025-06-18 17:29:44 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:29:44 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:29:44 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:29:45 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-06-18 17:29:45 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 429
{"object":"rejection","message":"Service tier capacity exceeded for this model.","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 17:29:45 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 17:29:49 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:29:50 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 17:29:50 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 17:29:50 [root] INFO: write_url_to_db(): appended URL 'http://www.folkworld.eu/81/e/cds1.html'
2025-06-18 17:29:50 [root] INFO: def parse(): URL http://www.folkworld.eu/81/e/cds1.html marked as irrelevant (LLM negative).
2025-06-18 17:29:50 [root] INFO: def parse(): Found 10 links on http://www.folkworld.eu/81/e/cds1.html
2025-06-18 17:29:50 [root] INFO: should_process_url: URL http://WestparkMusic.de was last seen as relevant, processing it.
2025-06-18 17:29:50 [root] INFO: should_process_url: URL http://WestparkMusic.de was last seen as relevant, processing it.
2025-06-18 17:29:50 [root] INFO: write_url_to_db(): appended URL 'http://WestparkMusic.de'
2025-06-18 17:29:50 [root] INFO: def parse(): Crawling next URL: http://WestparkMusic.de
2025-06-18 17:29:50 [root] INFO: def parse(): Found keywords for URL https://www.5rhythms.com/es/who-we-are/teacher-communities/the-americas/canada-west-coast/: ['dance']
2025-06-18 17:29:50 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.5rhythms.com/es/who-we-are/teacher-communities/the-americas/canada-west-coast/
2025-06-18 17:29:50 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:29:50 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:29:50 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:31:03 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:31:03 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "https://www.5rhythms.com/es/who-we-are/teacher-communities/the-americas/canada-west-coast/",
        "dance_style": "",
        "url": "",
        "event_type": "class",
        "event_name": "Moving Through Waves: A Weekly practice",
        "day_of_week": "Monday",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Vancouver",
        "description": "Gloria Glo"
    },
    {
        "source": "https://www.5rhythms.com/es/who-we-are/teacher-communities/the-americas/canada-west-coast/",
        "dance_style": "",
        "url": "",
        "event_type": "class",
        "event_name": "Endless Waves",
        "day_of_week": "Tuesday",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Victoria",
        "description": "Joanne Winstanley"
    },
    {
        "source": "https://www.5rhythms.com/es/who-we-are/teacher-communities/the-americas/canada-west-coast/",
        "dance_style": "",
        "url": "",
        "event_type": "class",
        "event_name": "Wednesday 5Rhythms ONLINE",
        "day_of_week": "Wednesday",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Salt Spring Island",
        "description": "Shauna Devlin"
    },
    {
        "source": "https://www.5rhythms.com/es/who-we-are/teacher-communities/the-americas/canada-west-coast/",
        "dance_style": "",
        "url": "",
        "event_type": "class",
        "event_name": "5Rhythms Class",
        "day_of_week": "Wednesday",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Whistler",
        "description": "Anna Mrozik"
    },
    {
        "source": "https://www.5rhythms.com/es/who-we-are/teacher-communities/the-americas/canada-west-coast/",
        "dance_style": "",
        "url": "",
        "event_type": "workshop",
        "event_name": "UNTAMED: Campout Retreat WILD EXPANSION",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-22",
        "start_time": "",
        "end_time": "",
        "price": "$485",
        "location": "Salt Spring Island",
        "description": "WILD EXPANSION • June 20-22. A weekend of movement, sun honouring & full illumination. Includes: 2 nights camping, 5 meals and 5 sessions. This workshop invites participants to welcome in the Summer Solstice with dance, writing, circle/partner work and ritual. We will honour the power of the sun and the energy of stepping fully into our untamed, radiant selves. Includes sunrise and sunset sessions. Friday to Sunday"
    },
    {
        "source": "https://www.5rhythms.com/es/who-we-are/teacher-communities/the-americas/canada-west-coast/",
        "dance_style": "",
        "url": "",
        "event_type": "workshop",
        "event_name": "FLOWSTATE",
        "day_of_week": "Saturday",
        "start_date": "2025-06-28",
        "end_date": "2025-06-28",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Vancouver",
        "description": "There is a place we touch in movement where thought dissolves and the moment expands — a state where body, breath, and awareness become one. This is flowstate: a deep current of presence that lives beneath the surface of doing, striving, or performing. This one-day 5Rhythms® workshop is designed to step into this current. To dance not just for expression, but for access — into the subtle intelligence of the body, the rhythms of the soul, and the spacious stillness that follows."
    }
]
2025-06-18 17:31:03 [root] INFO: def extract_and_parse_json(): for url https://www.5rhythms.com/es/who-we-are/teacher-communities/the-americas/canada-west-coast/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "https://www.5rhythms.com/es/who-we-are/teacher-communities/the-americas/canada-west-coast/",
        "dance_style": "",
        "url": "",
        "event_type": "class",
        "event_name": "Moving Through Waves: A Weekly practice",
        "day_of_week": "Monday",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Vancouver",
        "description": "Gloria Glo"
    },
    {
        "source": "https://www.5rhythms.com/es/who-we-are/teacher-communities/the-americas/canada-west-coast/",
        "dance_style": "",
        "url": "",
        "event_type": "class",
        "event_name": "Endless Waves",
        "day_of_week": "Tuesday",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Victoria",
        "description": "Joanne Winstanley"
    },
    {
        "source": "https://www.5rhythms.com/es/who-we-are/teacher-communities/the-americas/canada-west-coast/",
        "dance_style": "",
        "url": "",
        "event_type": "class",
        "event_name": "Wednesday 5Rhythms ONLINE",
        "day_of_week": "Wednesday",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Salt Spring Island",
        "description": "Shauna Devlin"
    },
    {
        "source": "https://www.5rhythms.com/es/who-we-are/teacher-communities/the-americas/canada-west-coast/",
        "dance_style": "",
        "url": "",
        "event_type": "class",
        "event_name": "5Rhythms Class",
        "day_of_week": "Wednesday",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Whistler",
        "description": "Anna Mrozik"
    },
    {
        "source": "https://www.5rhythms.com/es/who-we-are/teacher-communities/the-americas/canada-west-coast/",
        "dance_style": "",
        "url": "",
        "event_type": "workshop",
        "event_name": "UNTAMED: Campout Retreat WILD EXPANSION",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-22",
        "start_time": "",
        "end_time": "",
        "price": "$485",
        "location": "Salt Spring Island",
        "description": "WILD EXPANSION • June 20-22. A weekend of movement, sun honouring & full illumination. Includes: 2 nights camping, 5 meals and 5 sessions. This workshop invites participants to welcome in the Summer Solstice with dance, writing, circle/partner work and ritual. We will honour the power of the sun and the energy of stepping fully into our untamed, radiant selves. Includes sunrise and sunset sessions. Friday to Sunday"
    },
    {
        "source": "https://www.5rhythms.com/es/who-we-are/teacher-communities/the-americas/canada-west-coast/",
        "dance_style": "",
        "url": "",
        "event_type": "workshop",
        "event_name": "FLOWSTATE",
        "day_of_week": "Saturday",
        "start_date": "2025-06-28",
        "end_date": "2025-06-28",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "Vancouver",
        "description": "There is a place we touch in movement where thought dissolves and the moment expands — a state where body, breath, and awareness become one. This is flowstate: a deep current of presence that lives beneath the surface of doing, striving, or performing. This one-day 5Rhythms® workshop is designed to step into this current. To dance not just for expression, but for access — into the subtle intelligence of the body, the rhythms of the soul, and the spacious stillness that follows."
    }
]
2025-06-18 17:31:03 [root] INFO: def clean_up_address(): Starting with events_df shape: (6, 14)
2025-06-18 17:31:03 [root] INFO: def clean_up_address(): Processing location 'Vancouver' (event_id: None)
2025-06-18 17:31:03 [root] INFO: def clean_up_address(): Processing location 'Victoria' (event_id: None)
2025-06-18 17:31:03 [root] INFO: def clean_up_address(): Processing location 'Salt Spring Island' (event_id: None)
2025-06-18 17:31:03 [root] INFO: def clean_up_address(): Processing location 'Whistler' (event_id: None)
2025-06-18 17:31:03 [root] INFO: def clean_up_address(): Processing location 'Salt Spring Island' (event_id: None)
2025-06-18 17:31:03 [root] INFO: def clean_up_address(): Processing location 'Vancouver' (event_id: None)
2025-06-18 17:31:04 [root] INFO: write_events_to_db: Number of events to write: 6
2025-06-18 17:31:04 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/es/who-we-are/teacher-communities/the-americas/canada-west-coast/'
2025-06-18 17:31:04 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 17:31:04 [root] INFO: def process_llm_response: URL https://www.5rhythms.com/es/who-we-are/teacher-communities/the-americas/canada-west-coast/ marked as relevant with events written to the database.
2025-06-18 17:31:04 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/es/who-we-are/teacher-communities/the-americas/canada-west-coast/'
2025-06-18 17:31:04 [root] INFO: def parse(): URL https://www.5rhythms.com/es/who-we-are/teacher-communities/the-americas/canada-west-coast/ marked as relevant (LLM positive).
2025-06-18 17:31:04 [root] INFO: def parse(): Found 10 links on https://www.5rhythms.com/es/who-we-are/teacher-communities/the-americas/canada-west-coast/
2025-06-18 17:31:04 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/5rhythms'
2025-06-18 17:31:04 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/5rhythms
2025-06-18 17:31:04 [root] INFO: write_url_to_db(): appended URL 'https://instagram.com/5rhythms/'
2025-06-18 17:31:04 [root] INFO: def parse(): Recorded unwanted URL: https://instagram.com/5rhythms/
2025-06-18 17:31:04 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/who-we-are/teacher-communities/the-americas/canada-west-coast/ was last seen as relevant, processing it.
2025-06-18 17:31:04 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/5Rhythms.
2025-06-18 17:31:04 [root] INFO: should_process_url: URL https://www.5rhythms.com/who-we-are/teacher-communities/the-americas/canada-west-coast/ was last seen as not relevant but hit_ratio (3.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 17:31:04 [root] INFO: should_process_url: URL https://www.5rhythms.com/es//TeacherSearch.php was last seen as relevant, processing it.
2025-06-18 17:31:04 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/who-we-are/teacher-communities/the-americas/canada-west-coast/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:31:04 [root] INFO: should_process_url: URL https://www.5rhythms.com/es/who-we-are/teacher-communities/the-americas/canada-west-coast/ was last seen as relevant, processing it.
2025-06-18 17:31:04 [root] INFO: should_process_url: URL https://www.5rhythms.com/es//EventSearch.php was last seen as relevant, processing it.
2025-06-18 17:31:04 [root] INFO: should_process_url: URL https://www.5rhythms.com/es//gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:31:04 [root] INFO: should_process_url: URL https://www.5rhythms.com/es/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:04 [root] INFO: should_process_url: URL https://www.5rhythms.com/who-we-are/ has never been seen before, processing it.
2025-06-18 17:31:04 [root] INFO: should_process_url: URL https://www.5rhythms.com/who-we-are/ has never been seen before, processing it.
2025-06-18 17:31:04 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/who-we-are/'
2025-06-18 17:31:04 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/who-we-are/
2025-06-18 17:31:04 [scrapy.extensions.logstats] INFO: Crawled 418 pages (at 4 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 17:31:04 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/who-we-are/teacher-communities/the-americas/canada-west-coast/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:31:04 [root] INFO: should_process_url: URL https://www.5rhythms.com/es/who-we-are/teacher-communities/the-americas/canada-west-coast/ was last seen as relevant, processing it.
2025-06-18 17:31:04 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl//gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ was last seen as relevant, processing it.
2025-06-18 17:31:04 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl//gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ was last seen as relevant, processing it.
2025-06-18 17:31:04 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/nl//gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/'
2025-06-18 17:31:04 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/nl//gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/
2025-06-18 17:31:04 [root] INFO: should_process_url: URL http://Huldrelokkk.com was last seen as relevant, processing it.
2025-06-18 17:31:04 [root] INFO: should_process_url: URL http://Huldrelokkk.com was last seen as relevant, processing it.
2025-06-18 17:31:04 [root] INFO: write_url_to_db(): appended URL 'http://Huldrelokkk.com'
2025-06-18 17:31:04 [root] INFO: def parse(): Crawling next URL: http://Huldrelokkk.com
2025-06-18 17:31:04 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://bandcamp.com/?from=menubar_logo_logged_out> (failed 3 times): User timeout caused connection failure: Getting https://bandcamp.com/?from=menubar_logo_logged_out took longer than 180.0 seconds..
2025-06-18 17:31:04 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.redhotswing.com/?page_id=22> (failed 3 times): User timeout caused connection failure: Getting https://www.redhotswing.com/?page_id=22 took longer than 180.0 seconds..
2025-06-18 17:31:04 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.redhotswing.com/?page_id=8> (failed 3 times): User timeout caused connection failure: Getting https://www.redhotswing.com/?page_id=8 took longer than 180.0 seconds..
2025-06-18 17:31:04 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.redhotswing.com/?page_id=32> (failed 3 times): User timeout caused connection failure: Getting https://www.redhotswing.com/?page_id=32 took longer than 180.0 seconds..
2025-06-18 17:31:04 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.redhotswing.com/?page_id=25> (failed 3 times): User timeout caused connection failure: Getting https://www.redhotswing.com/?page_id=25 took longer than 180.0 seconds..
2025-06-18 17:31:04 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.redhotswing.com/?page_id=41> (failed 3 times): User timeout caused connection failure: Getting https://www.redhotswing.com/?page_id=41 took longer than 180.0 seconds..
2025-06-18 17:31:04 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.funtasticalberni.com/> (failed 3 times): User timeout caused connection failure: Getting https://www.funtasticalberni.com/ took longer than 180.0 seconds..
2025-06-18 17:31:04 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://musicbc.org/> (failed 3 times): User timeout caused connection failure: Getting https://musicbc.org/ took longer than 180.0 seconds..
2025-06-18 17:31:04 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://youtu.be/x4luGJ-7og8> (failed 3 times): User timeout caused connection failure: Getting https://youtu.be/x4luGJ-7og8 took longer than 180.0 seconds..
2025-06-18 17:31:04 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://northernwilds.com/current-issue/> (failed 3 times): User timeout caused connection failure: Getting https://northernwilds.com/current-issue/ took longer than 180.0 seconds..
2025-06-18 17:31:04 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://northernwilds.com/along-the-shore/> (failed 3 times): User timeout caused connection failure: Getting https://northernwilds.com/along-the-shore/ took longer than 180.0 seconds..
2025-06-18 17:31:04 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://northernwilds.com/advertise-in-northern-minnesota/> (failed 3 times): User timeout caused connection failure: Getting https://northernwilds.com/advertise-in-northern-minnesota/ took longer than 180.0 seconds..
2025-06-18 17:31:04 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://westwoodrecordings.com/> (failed 3 times): User timeout caused connection failure: Getting https://westwoodrecordings.com/ took longer than 180.0 seconds..
2025-06-18 17:31:04 [scrapy.core.scraper] ERROR: Error downloading <GET https://stringsmagazine.com/forget-me-not-is-a-simple-waltz-that-offers-fiddlers-freedom-at-a-gentle-tempo/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:31:04 [scrapy.core.scraper] ERROR: Error downloading <GET https://bluegrasscountry.org/brad-kolodner-on-air-interviews/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:31:04 [root] INFO: should_process_url: URL https://www.5rhythms.com/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:31:04 [root] INFO: should_process_url: URL https://www.5rhythms.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:31:04 [root] INFO: should_process_url: URL https://www.5rhythms.com/gabrielle-roths-5rhythms/ has never been seen before, processing it.
2025-06-18 17:31:04 [root] INFO: should_process_url: URL https://www.5rhythms.com/gabrielle-roths-5rhythms/ has never been seen before, processing it.
2025-06-18 17:31:04 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/gabrielle-roths-5rhythms/'
2025-06-18 17:31:04 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/gabrielle-roths-5rhythms/
2025-06-18 17:31:04 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl//TeacherSearch.php was last seen as relevant, processing it.
2025-06-18 17:31:04 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl//TeacherSearch.php was last seen as relevant, processing it.
2025-06-18 17:31:04 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/nl//TeacherSearch.php'
2025-06-18 17:31:04 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/nl//TeacherSearch.php
2025-06-18 17:31:04 [root] INFO: should_process_url: URL https://bethmalcolm.bandcamp.com/album/kissed-and-cried was last seen as relevant, processing it.
2025-06-18 17:31:04 [root] INFO: should_process_url: URL https://bethmalcolm.bandcamp.com/album/kissed-and-cried was last seen as relevant, processing it.
2025-06-18 17:31:04 [root] INFO: write_url_to_db(): appended URL 'https://bethmalcolm.bandcamp.com/album/kissed-and-cried'
2025-06-18 17:31:04 [root] INFO: def parse(): Crawling next URL: https://bethmalcolm.bandcamp.com/album/kissed-and-cried
2025-06-18 17:31:04 [root] INFO: should_process_url: URL https://www.5rhythms.com/TeacherSearch.php was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:31:04 [root] INFO: should_process_url: URL http://www.artes-Konzertbuero.de was last seen as relevant, processing it.
2025-06-18 17:31:04 [root] INFO: should_process_url: URL http://www.artes-Konzertbuero.de was last seen as relevant, processing it.
2025-06-18 17:31:04 [root] INFO: write_url_to_db(): appended URL 'http://www.artes-Konzertbuero.de'
2025-06-18 17:31:04 [root] INFO: def parse(): Crawling next URL: http://www.artes-Konzertbuero.de
2025-06-18 17:31:04 [root] INFO: should_process_url: URL http://www.bethmalcolm.com was last seen as relevant, processing it.
2025-06-18 17:31:04 [root] INFO: should_process_url: URL http://www.bethmalcolm.com was last seen as relevant, processing it.
2025-06-18 17:31:04 [root] INFO: write_url_to_db(): appended URL 'http://www.bethmalcolm.com'
2025-06-18 17:31:04 [root] INFO: def parse(): Crawling next URL: http://www.bethmalcolm.com
2025-06-18 17:31:04 [root] INFO: should_process_url: URL http://www.folkworld.eu/81/e/cds1.html was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:04 [root] INFO: should_process_url: URL http://www.gofolk.dk was last seen as relevant, processing it.
2025-06-18 17:31:04 [root] INFO: should_process_url: URL http://www.gofolk.dk was last seen as relevant, processing it.
2025-06-18 17:31:04 [root] INFO: write_url_to_db(): appended URL 'http://www.gofolk.dk'
2025-06-18 17:31:04 [root] INFO: def parse(): Crawling next URL: http://www.gofolk.dk
2025-06-18 17:31:04 [root] INFO: should_process_url: URL http://www.svobsk.dk was last seen as relevant, processing it.
2025-06-18 17:31:04 [root] INFO: should_process_url: URL http://www.svobsk.dk was last seen as relevant, processing it.
2025-06-18 17:31:04 [root] INFO: write_url_to_db(): appended URL 'http://www.svobsk.dk'
2025-06-18 17:31:04 [root] INFO: def parse(): Crawling next URL: http://www.svobsk.dk
2025-06-18 17:31:04 [root] INFO: def parse(): Found keywords for URL https://www.helpscout.com/docs-refer/?co=GigSalad&utm_source=docs&utm_medium=footerlink&utm_campaign=Docs+Branding: ['wcs']
2025-06-18 17:31:04 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.helpscout.com/docs-refer/?co=GigSalad&utm_source=docs&utm_medium=footerlink&utm_campaign=Docs+Branding
2025-06-18 17:31:04 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:31:04 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:31:04 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:31:05 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 17:31:05 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 354021 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 17:31:05 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 17:31:07 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 17:31:07 [root] WARNING: query_llm(): OpenAI query failed: Error code: 400 - {'rejection': {'message': "This model's maximum context length is 200000 tokens. However, your messages resulted in 254244 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_rejection', 'param': 'messages', 'code': 'context_length_exceeded'}}
2025-06-18 17:31:07 [root] ERROR: query_llm(): Both LLM providers failed to provide a response.
2025-06-18 17:31:07 [root] ERROR: def process_llm_response: Failed to process LLM response for URL: https://www.helpscout.com/docs-refer/?co=GigSalad&utm_source=docs&utm_medium=footerlink&utm_campaign=Docs+Branding
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://www.helpscout.com/docs-refer/?co=GigSalad&utm_source=docs&utm_medium=footerlink&utm_campaign=Docs+Branding'
2025-06-18 17:31:07 [root] INFO: def parse(): URL https://www.helpscout.com/docs-refer/?co=GigSalad&utm_source=docs&utm_medium=footerlink&utm_campaign=Docs+Branding marked as irrelevant (LLM negative).
2025-06-18 17:31:07 [root] INFO: def parse(): Found 10 links on https://www.helpscout.com/docs-refer/?co=GigSalad&utm_source=docs&utm_medium=footerlink&utm_campaign=Docs+Branding
2025-06-18 17:31:07 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-TTVS5W5R, URL: https://www.helpscout.com/docs-refer/?co=GigSalad&utm_source=docs&utm_medium=footerlink&utm_campaign=Docs+Branding, source: The Best Belly Dancers for Hire in Victoria, BC | GigSalad, keywords: samba
2025-06-18 17:31:07 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 17:31:07 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-TTVS5W5R
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-TTVS5W5R'
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/helpscout'
2025-06-18 17:31:07 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/helpscout
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/hellohelpscout/'
2025-06-18 17:31:07 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/hellohelpscout/
2025-06-18 17:31:07 [root] INFO: parse: Skipping blacklisted URL https://www.linkedin.com/company/help-scout.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://developer.helpscout.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://developer.helpscout.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://developer.helpscout.com/'
2025-06-18 17:31:07 [root] INFO: def parse(): Crawling next URL: https://developer.helpscout.com/
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://status.helpscout.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://status.helpscout.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://status.helpscout.com/'
2025-06-18 17:31:07 [root] INFO: def parse(): Crawling next URL: https://status.helpscout.com/
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://www.helpscout.com/docs-refer/?co=GigSalad&utm_source=docs&utm_medium=footerlink&utm_campaign=Docs+Branding was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://docs.helpscout.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://docs.helpscout.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://docs.helpscout.com/'
2025-06-18 17:31:07 [root] INFO: def parse(): Crawling next URL: https://docs.helpscout.com/
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://secure.helpscout.net/members/register/52/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://secure.helpscout.net/members/register/52/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://secure.helpscout.net/members/register/52/'
2025-06-18 17:31:07 [root] INFO: def parse(): Crawling next URL: https://secure.helpscout.net/members/register/52/
2025-06-18 17:31:07 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/helpscout.
2025-06-18 17:31:07 [scrapy.core.scraper] ERROR: Error downloading <GET https://bandcamp.com/?from=menubar_logo_logged_out>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://bandcamp.com/?from=menubar_logo_logged_out took longer than 180.0 seconds..
2025-06-18 17:31:07 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.redhotswing.com/?page_id=22>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://www.redhotswing.com/?page_id=22 took longer than 180.0 seconds..
2025-06-18 17:31:07 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.redhotswing.com/?page_id=8>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://www.redhotswing.com/?page_id=8 took longer than 180.0 seconds..
2025-06-18 17:31:07 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.redhotswing.com/?page_id=32>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://www.redhotswing.com/?page_id=32 took longer than 180.0 seconds..
2025-06-18 17:31:07 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.redhotswing.com/?page_id=25>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://www.redhotswing.com/?page_id=25 took longer than 180.0 seconds..
2025-06-18 17:31:07 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.redhotswing.com/?page_id=41>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://www.redhotswing.com/?page_id=41 took longer than 180.0 seconds..
2025-06-18 17:31:07 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.funtasticalberni.com/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://www.funtasticalberni.com/ took longer than 180.0 seconds..
2025-06-18 17:31:07 [scrapy.core.scraper] ERROR: Error downloading <GET https://musicbc.org/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://musicbc.org/ took longer than 180.0 seconds..
2025-06-18 17:31:07 [scrapy.core.scraper] ERROR: Error downloading <GET https://youtu.be/x4luGJ-7og8>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://youtu.be/x4luGJ-7og8 took longer than 180.0 seconds..
2025-06-18 17:31:07 [scrapy.core.scraper] ERROR: Error downloading <GET https://northernwilds.com/current-issue/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://northernwilds.com/current-issue/ took longer than 180.0 seconds..
2025-06-18 17:31:07 [scrapy.core.scraper] ERROR: Error downloading <GET https://northernwilds.com/along-the-shore/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://northernwilds.com/along-the-shore/ took longer than 180.0 seconds..
2025-06-18 17:31:07 [scrapy.core.scraper] ERROR: Error downloading <GET https://northernwilds.com/advertise-in-northern-minnesota/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://northernwilds.com/advertise-in-northern-minnesota/ took longer than 180.0 seconds..
2025-06-18 17:31:07 [scrapy.core.scraper] ERROR: Error downloading <GET https://westwoodrecordings.com/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://westwoodrecordings.com/ took longer than 180.0 seconds..
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://walthertreyz.com/ was last seen as relevant, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://walthertreyz.com/ was last seen as relevant, processing it.
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://walthertreyz.com/'
2025-06-18 17:31:07 [root] INFO: def parse(): Crawling next URL: https://walthertreyz.com/
2025-06-18 17:31:07 [root] INFO: should_process_url: URL http://www.bragr.dk was last seen as relevant, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL http://www.bragr.dk was last seen as relevant, processing it.
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'http://www.bragr.dk'
2025-06-18 17:31:07 [root] INFO: def parse(): Crawling next URL: http://www.bragr.dk
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://bsky.social'
2025-06-18 17:31:07 [root] INFO: def parse(): URL https://bsky.social marked as irrelevant (no keywords).
2025-06-18 17:31:07 [root] INFO: def parse(): Found 10 links on https://bsky.social:443/about
2025-06-18 17:31:07 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-KZT6XPW7, URL: https://bsky.social, source: Pardoner, Nick Normal, Guitar, Shoplifter, Cherry Venom | Concert ..., keywords: double shuffle
2025-06-18 17:31:07 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 17:31:07 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-KZT6XPW7
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-KZT6XPW7'
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://atproto.com/ has never been seen before, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://atproto.com/ has never been seen before, processing it.
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://atproto.com/'
2025-06-18 17:31:07 [root] INFO: def parse(): Crawling next URL: https://atproto.com/
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://bsky.social was last seen as relevant, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://apps.apple.com/us/app/bluesky-social/id6444370199 has never been seen before, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://apps.apple.com/us/app/bluesky-social/id6444370199 has never been seen before, processing it.
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://apps.apple.com/us/app/bluesky-social/id6444370199'
2025-06-18 17:31:07 [root] INFO: def parse(): Crawling next URL: https://apps.apple.com/us/app/bluesky-social/id6444370199
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://github.com/bluesky-social has never been seen before, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://github.com/bluesky-social has never been seen before, processing it.
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://github.com/bluesky-social'
2025-06-18 17:31:07 [root] INFO: def parse(): Crawling next URL: https://github.com/bluesky-social
2025-06-18 17:31:07 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/bluesky.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://bsky.app has never been seen before, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://bsky.app has never been seen before, processing it.
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://bsky.app'
2025-06-18 17:31:07 [root] INFO: def parse(): Crawling next URL: https://bsky.app
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://bsky.app/profile/bsky.app has never been seen before, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://bsky.app/profile/bsky.app has never been seen before, processing it.
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://bsky.app/profile/bsky.app'
2025-06-18 17:31:07 [root] INFO: def parse(): Crawling next URL: https://bsky.app/profile/bsky.app
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://www.coastaljazz.ca/festival/festival-ticket-info/'
2025-06-18 17:31:07 [root] INFO: def parse(): URL https://www.coastaljazz.ca/festival/festival-ticket-info/ marked as irrelevant (no keywords).
2025-06-18 17:31:07 [root] INFO: def parse(): Found 10 links on https://www.coastaljazz.ca/festival/festival-ticket-info/
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/education/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/artist-submissions/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/festival-guide/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://www.coastaljazz.ca was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/festival-ticket-info/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/ticket-info/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/visitor-info/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/volunteers/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/artist-residency/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/partners/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/partners/corporate-giving/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://www.zenseekers.com/'
2025-06-18 17:31:07 [root] INFO: def parse(): URL https://www.zenseekers.com/ marked as irrelevant (no keywords).
2025-06-18 17:31:07 [root] INFO: def parse(): Found 8 links on https://www.zenseekers.com/
2025-06-18 17:31:07 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-T6B8BNP, URL: https://www.zenseekers.com/, source: 20+ BC summer 2025 music festivals all about good vibes ..., keywords: music festivals
2025-06-18 17:31:07 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 17:31:07 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-T6B8BNP
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-T6B8BNP'
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/zenseekers/'
2025-06-18 17:31:07 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/zenseekers/
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/ZenSeekers'
2025-06-18 17:31:07 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/ZenSeekers
2025-06-18 17:31:07 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/channel/UCJp7CfY2VL_9I3LSXRs0wyw.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://www.festivalseekers.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://www.festivalseekers.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/'
2025-06-18 17:31:07 [root] INFO: def parse(): Crawling next URL: https://www.festivalseekers.com/
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://www.snowseekers.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://www.zenseekers.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://www.snowseekers.ca/'
2025-06-18 17:31:07 [root] INFO: def parse(): URL https://www.snowseekers.ca/ marked as irrelevant (no keywords).
2025-06-18 17:31:07 [root] INFO: def parse(): Found 8 links on https://www.snowseekers.ca/
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/snowseekers/'
2025-06-18 17:31:07 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/snowseekers/
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/snowseekers'
2025-06-18 17:31:07 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/snowseekers
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://www.festivalseekers.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/user/SnowSeekersInc.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://www.snowseekers.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://www.zenseekers.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://www.zenseekers.com/story/port-alberni-easy-vancouver-island-getaway-youre-looking'
2025-06-18 17:31:07 [root] INFO: def parse(): URL https://www.zenseekers.com/story/port-alberni-easy-vancouver-island-getaway-youre-looking marked as irrelevant (no keywords).
2025-06-18 17:31:07 [root] INFO: def parse(): Found 10 links on https://www.zenseekers.com/story/port-alberni-easy-vancouver-island-getaway-youre-looking
2025-06-18 17:31:07 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-T6B8BNP, URL: https://www.zenseekers.com/story/port-alberni-easy-vancouver-island-getaway-youre-looking, source: 20+ BC summer 2025 music festivals all about good vibes ..., keywords: music festivals
2025-06-18 17:31:07 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 17:31:07 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-T6B8BNP
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-T6B8BNP'
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://youtu.be/Fw6Rz2GAxc0?si=Y9Z3eYbduydoOFbf was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://youtu.be/Fw6Rz2GAxc0?si=Y9Z3eYbduydoOFbf was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://youtu.be/Fw6Rz2GAxc0?si=Y9Z3eYbduydoOFbf'
2025-06-18 17:31:07 [root] INFO: def parse(): Crawling next URL: https://youtu.be/Fw6Rz2GAxc0?si=Y9Z3eYbduydoOFbf
2025-06-18 17:31:07 [root] INFO: should_process_url: URL http://albernivalleytourism.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL http://albernivalleytourism.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'http://albernivalleytourism.com/'
2025-06-18 17:31:07 [root] INFO: def parse(): Crawling next URL: http://albernivalleytourism.com/
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://www.zenseekers.com/story/chill-port-albernis-hip-shops-foodie-and-photo-spots was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://www.zenseekers.com/story/chill-port-albernis-hip-shops-foodie-and-photo-spots was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://www.zenseekers.com/story/chill-port-albernis-hip-shops-foodie-and-photo-spots'
2025-06-18 17:31:07 [root] INFO: def parse(): Crawling next URL: https://www.zenseekers.com/story/chill-port-albernis-hip-shops-foodie-and-photo-spots
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://albernivalleytourism.com/things-to-do/activities/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://albernivalleytourism.com/things-to-do/activities/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://albernivalleytourism.com/things-to-do/activities/'
2025-06-18 17:31:07 [root] INFO: def parse(): Crawling next URL: https://albernivalleytourism.com/things-to-do/activities/
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://www.zenseekers.com/story/cool-port-alberni-easy-fun-summer-adventures was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://www.zenseekers.com/story/cool-port-alberni-easy-fun-summer-adventures was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://www.zenseekers.com/story/cool-port-alberni-easy-fun-summer-adventures'
2025-06-18 17:31:07 [root] INFO: def parse(): Crawling next URL: https://www.zenseekers.com/story/cool-port-alberni-easy-fun-summer-adventures
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://www.zenseekers.com/story/port-alberni-easy-vancouver-island-getaway-youre-looking was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://www.zenseekers.com/story/port-alberni-hikes-you-can-do-under-3-hours was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://www.zenseekers.com/story/port-alberni-hikes-you-can-do-under-3-hours was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://www.zenseekers.com/story/port-alberni-hikes-you-can-do-under-3-hours'
2025-06-18 17:31:07 [root] INFO: def parse(): Crawling next URL: https://www.zenseekers.com/story/port-alberni-hikes-you-can-do-under-3-hours
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://atproto.com'
2025-06-18 17:31:07 [root] INFO: def parse(): URL https://atproto.com marked as irrelevant (no keywords).
2025-06-18 17:31:07 [root] INFO: def parse(): Found 10 links on https://atproto.com
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://flipboard.video/w/ophhJTECuL7fcBNbUitV3q was last seen as relevant, processing it.
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://flipboard.video/w/ophhJTECuL7fcBNbUitV3q was last seen as relevant, processing it.
2025-06-18 17:31:07 [root] INFO: write_url_to_db(): appended URL 'https://flipboard.video/w/ophhJTECuL7fcBNbUitV3q'
2025-06-18 17:31:07 [root] INFO: def parse(): Crawling next URL: https://flipboard.video/w/ophhJTECuL7fcBNbUitV3q
2025-06-18 17:31:07 [root] INFO: should_process_url: URL https://arxiv.org/abs/2402.03239 was last seen as relevant, processing it.
2025-06-18 17:31:08 [root] INFO: should_process_url: URL https://arxiv.org/abs/2402.03239 was last seen as relevant, processing it.
2025-06-18 17:31:08 [root] INFO: write_url_to_db(): appended URL 'https://arxiv.org/abs/2402.03239'
2025-06-18 17:31:08 [root] INFO: def parse(): Crawling next URL: https://arxiv.org/abs/2402.03239
2025-06-18 17:31:08 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/watch?v=F1sJW6nTP6E.
2025-06-18 17:31:08 [root] INFO: should_process_url: URL https://docs.bsky.app/blog was last seen as relevant, processing it.
2025-06-18 17:31:08 [root] INFO: should_process_url: URL https://docs.bsky.app/blog was last seen as relevant, processing it.
2025-06-18 17:31:08 [root] INFO: write_url_to_db(): appended URL 'https://docs.bsky.app/blog'
2025-06-18 17:31:08 [root] INFO: def parse(): Crawling next URL: https://docs.bsky.app/blog
2025-06-18 17:31:08 [root] INFO: should_process_url: URL https://atproto.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:31:08 [root] INFO: should_process_url: URL https://bsky.app/profile/atproto.com was last seen as relevant, processing it.
2025-06-18 17:31:08 [root] INFO: should_process_url: URL https://bsky.app/profile/atproto.com was last seen as relevant, processing it.
2025-06-18 17:31:08 [root] INFO: write_url_to_db(): appended URL 'https://bsky.app/profile/atproto.com'
2025-06-18 17:31:08 [root] INFO: def parse(): Crawling next URL: https://bsky.app/profile/atproto.com
2025-06-18 17:31:08 [root] INFO: should_process_url: URL https://github.com/bluesky-social/atproto was last seen as relevant, processing it.
2025-06-18 17:31:08 [root] INFO: should_process_url: URL https://github.com/bluesky-social/atproto was last seen as relevant, processing it.
2025-06-18 17:31:08 [root] INFO: write_url_to_db(): appended URL 'https://github.com/bluesky-social/atproto'
2025-06-18 17:31:08 [root] INFO: def parse(): Crawling next URL: https://github.com/bluesky-social/atproto
2025-06-18 17:31:08 [root] INFO: should_process_url: URL https://docs.bsky.app was last seen as relevant, processing it.
2025-06-18 17:31:08 [root] INFO: should_process_url: URL https://docs.bsky.app was last seen as relevant, processing it.
2025-06-18 17:31:08 [root] INFO: write_url_to_db(): appended URL 'https://docs.bsky.app'
2025-06-18 17:31:08 [root] INFO: def parse(): Crawling next URL: https://docs.bsky.app
2025-06-18 17:31:08 [root] INFO: write_url_to_db(): appended URL 'https://www.zenseekers.com/expedition/explorevernon'
2025-06-18 17:31:08 [root] INFO: def parse(): URL https://www.zenseekers.com/expedition/explorevernon marked as irrelevant (no keywords).
2025-06-18 17:31:08 [root] INFO: def parse(): Found 7 links on https://www.zenseekers.com/campaign/explorevernon
2025-06-18 17:31:08 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-T6B8BNP, URL: https://www.zenseekers.com/expedition/explorevernon, source: 20+ BC summer 2025 music festivals all about good vibes ..., keywords: music festivals
2025-06-18 17:31:08 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 17:31:08 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-T6B8BNP
2025-06-18 17:31:08 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-T6B8BNP'
2025-06-18 17:31:08 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/zenseekers/'
2025-06-18 17:31:08 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/zenseekers/
2025-06-18 17:31:08 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/ZenSeekers'
2025-06-18 17:31:08 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/ZenSeekers
2025-06-18 17:31:08 [root] INFO: should_process_url: URL https://www.festivalseekers.com/story/vernon-started-winter-party-1893-and-its-still-going-strong was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:31:08 [root] INFO: should_process_url: URL https://www.festivalseekers.com/story/vernon-started-winter-party-1893-and-its-still-going-strong was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:31:08 [root] INFO: write_url_to_db(): appended URL 'https://www.festivalseekers.com/story/vernon-started-winter-party-1893-and-its-still-going-strong'
2025-06-18 17:31:08 [root] INFO: def parse(): Crawling next URL: https://www.festivalseekers.com/story/vernon-started-winter-party-1893-and-its-still-going-strong
2025-06-18 17:31:08 [root] INFO: should_process_url: URL https://www.zenseekers.com/expedition/explorevernon was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:31:08 [root] INFO: should_process_url: URL https://www.tourismvernon.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:31:08 [root] INFO: should_process_url: URL https://www.tourismvernon.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:31:08 [root] INFO: write_url_to_db(): appended URL 'https://www.tourismvernon.com/'
2025-06-18 17:31:08 [root] INFO: def parse(): Crawling next URL: https://www.tourismvernon.com/
2025-06-18 17:31:08 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/channel/UCJp7CfY2VL_9I3LSXRs0wyw.
2025-06-18 17:31:08 [root] INFO: should_process_url: URL https://www.festivalseekers.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:31:08 [root] INFO: should_process_url: URL https://www.snowseekers.ca/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:31:08 [root] INFO: def parse(): Found keywords for URL https://albernivalleytourism.com/business-directory/?business_category=accommodations: ['live music']
2025-06-18 17:31:08 [root] INFO: def generate_prompt(): Generating prompt for URL: https://albernivalleytourism.com/business-directory/?business_category=accommodations
2025-06-18 17:31:08 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:31:08 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:31:08 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:31:34 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:31:34 [root] INFO: query_llm(): Mistral response received: [
  {
    "source": "https://albernivalleytourism.com/business_category/accommodations/",
    "dance_style": "salsa, bachata, kizomba, lindy hop, tarraxo, tarraxa, tarraxinha, urban kiz",
    "url": "",
    "event_type": "other",
    "event_name": "Business Listings | Alberni Valley",
    "day_of_week": "",
    "start_date": "",
    "end_date": "",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "This page lists businesses in the Alberni Valley area offering accommodations.",
    "source": "https://albernivalleytourism.com/business_category/accommodations/"
  }
]
2025-06-18 17:31:34 [root] INFO: def extract_and_parse_json(): for url https://albernivalleytourism.com/business-directory/?business_category=accommodations, 
Cleaned JSON ready for parsing:
[
  {
    "source": "https://albernivalleytourism.com/business_category/accommodations/",
    "dance_style": "salsa, bachata, kizomba, lindy hop, tarraxo, tarraxa, tarraxinha, urban kiz",
    "url": "",
    "event_type": "other",
    "event_name": "Business Listings | Alberni Valley",
    "day_of_week": "",
    "start_date": "",
    "end_date": "",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "This page lists businesses in the Alberni Valley area offering accommodations.",
    "source": "https://albernivalleytourism.com/business_category/accommodations/"
  }
]
2025-06-18 17:31:34 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 17:31:34 [root] INFO: write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 17:31:34 [root] INFO: write_url_to_db(): appended URL 'https://albernivalleytourism.com/business-directory/?business_category=accommodations'
2025-06-18 17:31:34 [root] INFO: def process_llm_response: URL https://albernivalleytourism.com/business-directory/?business_category=accommodations marked as relevant with events written to the database.
2025-06-18 17:31:34 [root] INFO: write_url_to_db(): appended URL 'https://albernivalleytourism.com/business-directory/?business_category=accommodations'
2025-06-18 17:31:34 [root] INFO: def parse(): URL https://albernivalleytourism.com/business-directory/?business_category=accommodations marked as relevant (LLM positive).
2025-06-18 17:31:34 [root] INFO: def parse(): Found 10 links on https://albernivalleytourism.com/business-directory/?business_category=accommodations
2025-06-18 17:31:34 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-WCNL33V, URL: https://albernivalleytourism.com/business-directory/?business_category=accommodations, source: 20+ BC summer 2025 music festivals all about good vibes ..., keywords: music festivals
2025-06-18 17:31:34 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 17:31:34 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-WCNL33V
2025-06-18 17:31:34 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-WCNL33V'
2025-06-18 17:31:34 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/albernivalley'
2025-06-18 17:31:34 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/albernivalley
2025-06-18 17:31:34 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/albernivalleytourism/'
2025-06-18 17:31:34 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/albernivalleytourism/
2025-06-18 17:31:34 [root] INFO: should_process_url: URL https://albernivalleytourism.com/activities/hiking-alberni-valley/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:34 [root] INFO: should_process_url: URL https://albernivalleytourism.com/activities/hiking-alberni-valley/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:34 [root] INFO: write_url_to_db(): appended URL 'https://albernivalleytourism.com/activities/hiking-alberni-valley/'
2025-06-18 17:31:34 [root] INFO: def parse(): Crawling next URL: https://albernivalleytourism.com/activities/hiking-alberni-valley/
2025-06-18 17:31:34 [root] INFO: should_process_url: URL https://albernivalleytourism.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:34 [root] INFO: should_process_url: URL https://albernivalleytourism.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:34 [root] INFO: write_url_to_db(): appended URL 'https://albernivalleytourism.com'
2025-06-18 17:31:34 [root] INFO: def parse(): Crawling next URL: https://albernivalleytourism.com
2025-06-18 17:31:34 [root] INFO: should_process_url: URL https://albernivalleytourism.com/business-directory/?business_category=accommodations was last seen as relevant, processing it.
2025-06-18 17:31:34 [root] INFO: should_process_url: URL https://albernivalleytourism.com/activities/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:34 [root] INFO: should_process_url: URL https://albernivalleytourism.com/activities/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:34 [root] INFO: write_url_to_db(): appended URL 'https://albernivalleytourism.com/activities/'
2025-06-18 17:31:34 [root] INFO: def parse(): Crawling next URL: https://albernivalleytourism.com/activities/
2025-06-18 17:31:34 [root] INFO: should_process_url: URL https://albernivalleytourism.com/get-connected/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:34 [root] INFO: should_process_url: URL https://albernivalleytourism.com/get-connected/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:34 [root] INFO: write_url_to_db(): appended URL 'https://albernivalleytourism.com/get-connected/'
2025-06-18 17:31:34 [root] INFO: def parse(): Crawling next URL: https://albernivalleytourism.com/get-connected/
2025-06-18 17:31:34 [root] INFO: should_process_url: URL https://albernivalleytourism.com/activities/biking-alberni-valley/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:34 [root] INFO: should_process_url: URL https://albernivalleytourism.com/activities/biking-alberni-valley/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:34 [root] INFO: write_url_to_db(): appended URL 'https://albernivalleytourism.com/activities/biking-alberni-valley/'
2025-06-18 17:31:34 [root] INFO: def parse(): Crawling next URL: https://albernivalleytourism.com/activities/biking-alberni-valley/
2025-06-18 17:31:34 [root] INFO: should_process_url: URL https://albernivalleytourism.com/activities/golfing/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:34 [root] INFO: should_process_url: URL https://albernivalleytourism.com/activities/golfing/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:34 [root] INFO: write_url_to_db(): appended URL 'https://albernivalleytourism.com/activities/golfing/'
2025-06-18 17:31:34 [root] INFO: def parse(): Crawling next URL: https://albernivalleytourism.com/activities/golfing/
2025-06-18 17:31:34 [root] INFO: should_process_url: URL https://albernivalleytourism.com/activities/fishing/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:34 [root] INFO: should_process_url: URL https://albernivalleytourism.com/activities/fishing/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:31:34 [root] INFO: write_url_to_db(): appended URL 'https://albernivalleytourism.com/activities/fishing/'
2025-06-18 17:31:34 [root] INFO: def parse(): Crawling next URL: https://albernivalleytourism.com/activities/fishing/
2025-06-18 17:31:34 [root] INFO: def parse(): Found keywords for URL https://www.foxtrotwine.com/western-living-magazine-the-pinot-chronicles-pt-2-foxtrot-vineyards-the-winery-that-kicked-off-the-pinot-frenzy/: ['foxtrot', 'waltz']
2025-06-18 17:31:34 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.foxtrotwine.com/western-living-magazine-the-pinot-chronicles-pt-2-foxtrot-vineyards-the-winery-that-kicked-off-the-pinot-frenzy/
2025-06-18 17:31:34 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:31:34 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:31:34 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:31:39 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:31:39 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 17:31:39 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 17:31:39 [root] INFO: write_url_to_db(): appended URL 'https://www.foxtrotwine.com/western-living-magazine-the-pinot-chronicles-pt-2-foxtrot-vineyards-the-winery-that-kicked-off-the-pinot-frenzy/'
2025-06-18 17:31:39 [root] INFO: def parse(): URL https://www.foxtrotwine.com/western-living-magazine-the-pinot-chronicles-pt-2-foxtrot-vineyards-the-winery-that-kicked-off-the-pinot-frenzy/ marked as irrelevant (LLM negative).
2025-06-18 17:31:39 [root] INFO: def parse(): Found 10 links on https://www.foxtrotwine.com/western-living-magazine-the-pinot-chronicles-pt-2-foxtrot-vineyards-the-winery-that-kicked-off-the-pinot-frenzy/
2025-06-18 17:31:39 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/western-living-magazine-the-pinot-chronicles-pt-2-foxtrot-vineyards-the-winery-that-kicked-off-the-pinot-frenzy/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:31:39 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/our-philosophy/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:31:39 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (4) ≤ 3, processing it.
2025-06-18 17:31:39 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/the-story-behind-the-label/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:31:39 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/contact-us/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:31:39 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/club/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:31:39 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/category/uncategorized/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:31:39 [root] INFO: should_process_url: URL https://www.foxtrotwine.com/visit/ was last seen as relevant, processing it.
2025-06-18 17:31:39 [root] INFO: should_process_url: URL https://www.westernliving.ca/The-Pinot-Chronicles-Pt2-Foxtrot-Vineyards was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:31:39 [root] INFO: should_process_url: URL https://www.westernliving.ca/The-Pinot-Chronicles-Pt2-Foxtrot-Vineyards was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:31:39 [root] INFO: write_url_to_db(): appended URL 'https://www.westernliving.ca/The-Pinot-Chronicles-Pt2-Foxtrot-Vineyards'
2025-06-18 17:31:39 [root] INFO: def parse(): Crawling next URL: https://www.westernliving.ca/The-Pinot-Chronicles-Pt2-Foxtrot-Vineyards
2025-06-18 17:31:39 [root] INFO: def parse(): Found keywords for URL https://www.5rhythms.com/nl//EventSearch.php: ['dance']
2025-06-18 17:31:39 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.5rhythms.com/nl//EventSearch.php
2025-06-18 17:31:39 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:31:39 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:31:39 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:33:25 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:33:25 [root] INFO: query_llm(): Mistral response received: ```json
[
  {
    "source": "5Rhythms",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "The 1st Tuesday in 2025 is January 7, 2025",
    "day_of_week": "Tuesday",
    "start_date": "2025-01-07",
    "end_date": "2025-01-07",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "The 1st Tuesday in 2025 is January 7, 2025"
  },
  {
    "source": "5Rhythms",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "The 1st Tuesday in 2025 is February 4, 2025",
    "day_of_week": "Tuesday",
    "start_date": "2025-02-04",
    "end_date": "2025-02-04",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "The 1st Tuesday in 2025 is February 4, 2025"
  },
  {
    "source": "5Rhythms",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "The 1st Tuesday in 2025 is March 4, 2025",
    "day_of_week": "Tuesday",
    "start_date": "2025-03-04",
    "end_date": "2025-03-04",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "The 1st Tuesday in 2025 is March 4, 2025"
  },
  {
    "source": "5Rhythms",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "The 1st Tuesday in 2025 is April 1, 2025",
    "day_of_week": "Tuesday",
    "start_date": "2025-04-01",
    "end_date": "2025-04-01",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "The 1st Tuesday in 2025 is April 1, 2025"
  },
  {
    "source": "5Rhythms",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "The 1st Tuesday in 2025 is May 6, 2025",
    "day_of_week": "Tuesday",
    "start_date": "2025-05-06",
    "end_date": "2025-05-06",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "The 1st Tuesday in 2025 is May 6, 2025"
  },
  {
    "source": "5Rhythms",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "The 1st Tuesday in 2025 is June 3, 2025",
    "day_of_week": "Tuesday",
    "start_date": "2025-06-03",
    "end_date": "2025-06-03",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "The 1st Tuesday in 2025 is June 3, 2025"
  },
  {
    "source": "5Rhythms",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "The 1st Tuesday in 2025 is July 1, 2025",
    "day_of_week": "Tuesday",
    "start_date": "2025-07-01",
    "end_date": "2025-07-01",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "The 1st Tuesday in 2025 is July 1, 2025"
  },
  {
    "source": "5Rhythms",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "The 1st Tuesday in 2025 is August 5, 2025",
    "day_of_week": "Tuesday",
    "start_date": "2025-08-05",
    "end_date": "2025-08-05",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "The 1st Tuesday in 2025 is August 5, 2025"
  },
  {
    "source": "5Rhythms",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "The 1st Tuesday in 2025 is September 2, 2025",
    "day_of_week": "Tuesday",
    "start_date": "2025-09-02",
    "end_date": "2025-09-02",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "The 1st Tuesday in 2025 is September 2, 2025"
  },
  {
    "source": "5Rhythms",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "The 1st Tuesday in 2025 is October 7, 2025",
    "day_of_week": "Tuesday",
    "start_date": "2025-10-07",
    "end_date": "2025-10-07",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "The 1st Tuesday in 2025 is October 7, 2025"
  },
  {
    "source": "5Rhythms",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "The 1st Tuesday in 2025 is November 4, 2025",
    "day_of_week": "Tuesday",
    "start_date": "2025-11-04",
    "end_date": "2025-11-04",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "The 1st Tuesday in 2025 is November 4, 2025"
  },
  {
    "source": "5Rhythms",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "The 1st Tuesday in 2025 is December 2, 2025",
    "day_of_week": "Tuesday",
    "start_date": "2025-12-02",
    "end_date": "2025-12-02",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "The 1st Tuesday in 2025 is December 2, 2025"
  }
]
```
2025-06-18 17:33:25 [root] INFO: def extract_and_parse_json(): for url https://www.5rhythms.com/nl//EventSearch.php, 
Cleaned JSON ready for parsing:
[
  {
    "source": "5Rhythms",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "The 1st Tuesday in 2025 is January 7, 2025",
    "day_of_week": "Tuesday",
    "start_date": "2025-01-07",
    "end_date": "2025-01-07",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "The 1st Tuesday in 2025 is January 7, 2025"
  },
  {
    "source": "5Rhythms",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "The 1st Tuesday in 2025 is February 4, 2025",
    "day_of_week": "Tuesday",
    "start_date": "2025-02-04",
    "end_date": "2025-02-04",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "The 1st Tuesday in 2025 is February 4, 2025"
  },
  {
    "source": "5Rhythms",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "The 1st Tuesday in 2025 is March 4, 2025",
    "day_of_week": "Tuesday",
    "start_date": "2025-03-04",
    "end_date": "2025-03-04",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "The 1st Tuesday in 2025 is March 4, 2025"
  },
  {
    "source": "5Rhythms",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "The 1st Tuesday in 2025 is April 1, 2025",
    "day_of_week": "Tuesday",
    "start_date": "2025-04-01",
    "end_date": "2025-04-01",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "The 1st Tuesday in 2025 is April 1, 2025"
  },
  {
    "source": "5Rhythms",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "The 1st Tuesday in 2025 is May 6, 2025",
    "day_of_week": "Tuesday",
    "start_date": "2025-05-06",
    "end_date": "2025-05-06",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "The 1st Tuesday in 2025 is May 6, 2025"
  },
  {
    "source": "5Rhythms",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "The 1st Tuesday in 2025 is June 3, 2025",
    "day_of_week": "Tuesday",
    "start_date": "2025-06-03",
    "end_date": "2025-06-03",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "The 1st Tuesday in 2025 is June 3, 2025"
  },
  {
    "source": "5Rhythms",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "The 1st Tuesday in 2025 is July 1, 2025",
    "day_of_week": "Tuesday",
    "start_date": "2025-07-01",
    "end_date": "2025-07-01",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "The 1st Tuesday in 2025 is July 1, 2025"
  },
  {
    "source": "5Rhythms",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "The 1st Tuesday in 2025 is August 5, 2025",
    "day_of_week": "Tuesday",
    "start_date": "2025-08-05",
    "end_date": "2025-08-05",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "The 1st Tuesday in 2025 is August 5, 2025"
  },
  {
    "source": "5Rhythms",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "The 1st Tuesday in 2025 is September 2, 2025",
    "day_of_week": "Tuesday",
    "start_date": "2025-09-02",
    "end_date": "2025-09-02",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "The 1st Tuesday in 2025 is September 2, 2025"
  },
  {
    "source": "5Rhythms",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "The 1st Tuesday in 2025 is October 7, 2025",
    "day_of_week": "Tuesday",
    "start_date": "2025-10-07",
    "end_date": "2025-10-07",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "The 1st Tuesday in 2025 is October 7, 2025"
  },
  {
    "source": "5Rhythms",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "The 1st Tuesday in 2025 is November 4, 2025",
    "day_of_week": "Tuesday",
    "start_date": "2025-11-04",
    "end_date": "2025-11-04",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "The 1st Tuesday in 2025 is November 4, 2025"
  },
  {
    "source": "5Rhythms",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "The 1st Tuesday in 2025 is December 2, 2025",
    "day_of_week": "Tuesday",
    "start_date": "2025-12-02",
    "end_date": "2025-12-02",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "",
    "description": "The 1st Tuesday in 2025 is December 2, 2025"
  }
]
2025-06-18 17:33:25 [root] INFO: def clean_up_address(): Starting with events_df shape: (12, 14)
2025-06-18 17:33:25 [root] INFO: write_events_to_db: Number of events to write: 12
2025-06-18 17:33:25 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/nl//EventSearch.php'
2025-06-18 17:33:25 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 17:33:25 [root] INFO: def process_llm_response: URL https://www.5rhythms.com/nl//EventSearch.php marked as relevant with events written to the database.
2025-06-18 17:33:25 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/nl//EventSearch.php'
2025-06-18 17:33:25 [root] INFO: def parse(): URL https://www.5rhythms.com/nl//EventSearch.php marked as relevant (LLM positive).
2025-06-18 17:33:25 [root] INFO: def parse(): Found 10 links on https://www.5rhythms.com/nl//EventSearch.php
2025-06-18 17:33:25 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/5rhythms'
2025-06-18 17:33:25 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/5rhythms
2025-06-18 17:33:25 [root] INFO: write_url_to_db(): appended URL 'https://instagram.com/5rhythms/'
2025-06-18 17:33:25 [root] INFO: def parse(): Recorded unwanted URL: https://instagram.com/5rhythms/
2025-06-18 17:33:25 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/5Rhythms.
2025-06-18 17:33:25 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:25 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl has never been seen before, processing it.
2025-06-18 17:33:25 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl has never been seen before, processing it.
2025-06-18 17:33:25 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/nl'
2025-06-18 17:33:25 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/nl
2025-06-18 17:33:25 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl//EventSearch.php was last seen as relevant, processing it.
2025-06-18 17:33:25 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ has never been seen before, processing it.
2025-06-18 17:33:25 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/EventSearch.php has never been seen before, processing it.
2025-06-18 17:33:25 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/EventSearch.php has never been seen before, processing it.
2025-06-18 17:33:25 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/nl/EventSearch.php'
2025-06-18 17:33:25 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/nl/EventSearch.php
2025-06-18 17:33:25 [root] INFO: should_process_url: URL https://www.5rhythms.com/es/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:33:25 [root] INFO: should_process_url: URL https://www.5rhythms.com/ was last seen as relevant, processing it.
2025-06-18 17:33:25 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/TeacherSearch.php has never been seen before, processing it.
2025-06-18 17:33:25 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/TeacherSearch.php has never been seen before, processing it.
2025-06-18 17:33:25 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/nl/TeacherSearch.php'
2025-06-18 17:33:25 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/nl/TeacherSearch.php
2025-06-18 17:33:25 [scrapy.extensions.logstats] INFO: Crawled 431 pages (at 13 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 17:33:25 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.sunshinecoastcanada.com/?utm_source=FestivalSeekers&utm_medium=Referral&utm_campaign=FestivalSeekers> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:33:25 [root] INFO: def parse(): Found keywords for URL https://www.5rhythms.com/shop/: ['dance', 'tango']
2025-06-18 17:33:25 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.5rhythms.com/shop/
2025-06-18 17:33:25 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:33:25 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:33:25 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:33:36 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:33:36 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 17:33:36 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 17:33:36 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/shop/'
2025-06-18 17:33:36 [root] INFO: def parse(): URL https://www.5rhythms.com/shop/ marked as irrelevant (LLM negative).
2025-06-18 17:33:36 [root] INFO: def parse(): Found 10 links on https://www.5rhythms.com/shop/
2025-06-18 17:33:36 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/5rhythms'
2025-06-18 17:33:36 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/5rhythms
2025-06-18 17:33:36 [root] INFO: write_url_to_db(): appended URL 'https://instagram.com/5rhythms/'
2025-06-18 17:33:36 [root] INFO: def parse(): Recorded unwanted URL: https://instagram.com/5rhythms/
2025-06-18 17:33:36 [root] INFO: should_process_url: URL https://www.5rhythms.com/EventSearch.php was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:36 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/5Rhythms.
2025-06-18 17:33:36 [root] INFO: should_process_url: URL https://www.5rhythms.com/shop/ has never been seen before, processing it.
2025-06-18 17:33:36 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/shop/ has never been seen before, processing it.
2025-06-18 17:33:36 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/shop/ has never been seen before, processing it.
2025-06-18 17:33:36 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/nl/shop/'
2025-06-18 17:33:36 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/nl/shop/
2025-06-18 17:33:36 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/shop/ has never been seen before, processing it.
2025-06-18 17:33:36 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/shop/ has never been seen before, processing it.
2025-06-18 17:33:36 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/hr/shop/'
2025-06-18 17:33:36 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/hr/shop/
2025-06-18 17:33:36 [root] INFO: should_process_url: URL https://www.5rhythms.com/es/shop/ has never been seen before, processing it.
2025-06-18 17:33:36 [root] INFO: should_process_url: URL https://www.5rhythms.com/es/shop/ has never been seen before, processing it.
2025-06-18 17:33:36 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/es/shop/'
2025-06-18 17:33:36 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/es/shop/
2025-06-18 17:33:36 [root] INFO: should_process_url: URL https://www.5rhythms.com/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:36 [root] INFO: should_process_url: URL https://www.5rhythms.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:36 [root] INFO: should_process_url: URL https://www.5rhythms.com/TeacherSearch.php was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:37 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.sunshinecoastcanada.com/?utm_source=FestivalSeekers&utm_medium=Referral&utm_campaign=FestivalSeekers>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:33:37 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <404 https://smithersmusicfest.com/festival/>: HTTP status code is not handled or not allowed
2025-06-18 17:33:37 [root] INFO: write_url_to_db(): appended URL 'https://cowichanbluegrass.com/tickets/'
2025-06-18 17:33:37 [root] INFO: def parse(): URL https://cowichanbluegrass.com/tickets/ marked as irrelevant (no keywords).
2025-06-18 17:33:37 [root] INFO: def parse(): Found 10 links on https://cowichanbluegrass.com/tickets/
2025-06-18 17:33:37 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/school-workshops/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:37 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/lineup/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:37 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:33:37 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/schedule/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:37 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/about/faqs/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:37 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/john-hartford-fiddle-tunes-workshop/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:37 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:33:37 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/about/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:37 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/stay/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:37 [root] INFO: should_process_url: URL https://cowichanbluegrass.com/about/visit/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:37 [root] INFO: def parse(): Found keywords for URL https://www.5rhythms.com/gabrielle-roths-5rhythms/: ['dance']
2025-06-18 17:33:37 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.5rhythms.com/gabrielle-roths-5rhythms/
2025-06-18 17:33:37 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:33:37 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:33:37 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:33:50 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:33:50 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "5Rhythms | Gabrielle Roth’s 5Rhythms",
        "dance_style": "ecstatic dance",
        "url": "",
        "event_type": "social dance",
        "event_name": "Sweat Your Prayers",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "5Rhythms Global",
        "description": "Sweat Your Prayers® is a dynamic movement practice—a practice of being in your body—that ignites creativity, connection, and community."
    }
]
2025-06-18 17:33:50 [root] INFO: def extract_and_parse_json(): for url https://www.5rhythms.com/gabrielle-roths-5rhythms/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "5Rhythms | Gabrielle Roth’s 5Rhythms",
        "dance_style": "ecstatic dance",
        "url": "",
        "event_type": "social dance",
        "event_name": "Sweat Your Prayers",
        "day_of_week": "Tuesday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "",
        "end_time": "",
        "price": "",
        "location": "5Rhythms Global",
        "description": "Sweat Your Prayers® is a dynamic movement practice—a practice of being in your body—that ignites creativity, connection, and community."
    }
]
2025-06-18 17:33:50 [root] INFO: def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 17:33:50 [root] INFO: def clean_up_address(): Processing location '5Rhythms Global' (event_id: None)
2025-06-18 17:33:50 [root] INFO: write_events_to_db: Number of events to write: 1
2025-06-18 17:33:50 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/gabrielle-roths-5rhythms/'
2025-06-18 17:33:50 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 17:33:50 [root] INFO: def process_llm_response: URL https://www.5rhythms.com/gabrielle-roths-5rhythms/ marked as relevant with events written to the database.
2025-06-18 17:33:50 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/gabrielle-roths-5rhythms/'
2025-06-18 17:33:50 [root] INFO: def parse(): URL https://www.5rhythms.com/gabrielle-roths-5rhythms/ marked as relevant (LLM positive).
2025-06-18 17:33:50 [root] INFO: def parse(): Found 10 links on https://www.5rhythms.com/gabrielle-roths-5rhythms/
2025-06-18 17:33:50 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/5rhythms'
2025-06-18 17:33:50 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/5rhythms
2025-06-18 17:33:50 [root] INFO: write_url_to_db(): appended URL 'https://instagram.com/5rhythms/'
2025-06-18 17:33:50 [root] INFO: def parse(): Recorded unwanted URL: https://instagram.com/5rhythms/
2025-06-18 17:33:50 [root] INFO: should_process_url: URL https://www.5rhythms.com/EventSearch.php was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:50 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/5Rhythms.
2025-06-18 17:33:50 [root] INFO: should_process_url: URL https://www.5rhythms.com/es/gabrielle-roths-5rhythms/ has never been seen before, processing it.
2025-06-18 17:33:50 [root] INFO: should_process_url: URL https://www.5rhythms.com/es/gabrielle-roths-5rhythms/ has never been seen before, processing it.
2025-06-18 17:33:50 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/es/gabrielle-roths-5rhythms/'
2025-06-18 17:33:50 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/es/gabrielle-roths-5rhythms/
2025-06-18 17:33:50 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/gabrielle-roths-5rhythms/ has never been seen before, processing it.
2025-06-18 17:33:50 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/gabrielle-roths-5rhythms/ has never been seen before, processing it.
2025-06-18 17:33:50 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/hr/gabrielle-roths-5rhythms/'
2025-06-18 17:33:50 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/hr/gabrielle-roths-5rhythms/
2025-06-18 17:33:50 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/gabrielle-roths-5rhythms/ has never been seen before, processing it.
2025-06-18 17:33:50 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/gabrielle-roths-5rhythms/ has never been seen before, processing it.
2025-06-18 17:33:50 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/nl/gabrielle-roths-5rhythms/'
2025-06-18 17:33:50 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/nl/gabrielle-roths-5rhythms/
2025-06-18 17:33:50 [root] INFO: should_process_url: URL https://www.5rhythms.com/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:50 [root] INFO: should_process_url: URL https://www.5rhythms.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:50 [root] INFO: should_process_url: URL https://www.5rhythms.com/gabrielle-roths-5rhythms/ has never been seen before, processing it.
2025-06-18 17:33:50 [root] INFO: should_process_url: URL https://www.5rhythms.com/TeacherSearch.php was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:50 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET http://huldrelokkk.com> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionDone: Connection was closed cleanly.>]
2025-06-18 17:33:50 [root] INFO: write_url_to_db(): appended URL 'https://smithersmusicfest.com/tickets/'
2025-06-18 17:33:50 [root] INFO: def parse(): URL https://smithersmusicfest.com/tickets/ marked as irrelevant (no keywords).
2025-06-18 17:33:50 [root] INFO: def parse(): Found 10 links on https://smithersmusicfest.com/tickets/
2025-06-18 17:33:50 [root] INFO: should_process_url: URL https://smithersmusicfest.com/about/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:50 [root] INFO: should_process_url: URL https://smithersmusicfest.com/merchandise/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:50 [root] INFO: should_process_url: URL https://smithersmusicfest.com/camping-and-grounds/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:50 [root] INFO: should_process_url: URL https://smithersmusicfest.com/2025-lineup/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:50 [root] INFO: should_process_url: URL https://smithersmusicfest.com/admission/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:50 [root] INFO: should_process_url: URL https://smithersmusicfest.com/performer-application/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:50 [root] INFO: should_process_url: URL https://smithersmusicfest.com/tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:33:50 [root] INFO: should_process_url: URL https://smithersmusicfest.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:33:50 [root] INFO: should_process_url: URL https://www.tickettailor.com/events/bulkleyvalleyfolkmusicsociety/1670109 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:50 [scrapy.core.scraper] ERROR: Error downloading <GET http://huldrelokkk.com>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionDone: Connection was closed cleanly.>]
2025-06-18 17:33:50 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <406 http://www.bethmalcolm.com>: HTTP status code is not handled or not allowed
2025-06-18 17:33:50 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <455 http://www.bragr.dk>: HTTP status code is not handled or not allowed
2025-06-18 17:33:50 [root] INFO: write_url_to_db(): appended URL 'https://www.hellobc.com/places-to-go/vancouver-island/'
2025-06-18 17:33:50 [root] INFO: def parse(): URL https://www.hellobc.com/places-to-go/vancouver-island/ marked as irrelevant (no keywords).
2025-06-18 17:33:50 [root] INFO: def parse(): Found 10 links on https://www.hellobc.com/places-to-go/vancouver-island/
2025-06-18 17:33:50 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5TPC7Q3, URL: https://www.hellobc.com/places-to-go/vancouver-island/, source: 20+ BC summer 2025 music festivals all about good vibes ..., keywords: music festivals
2025-06-18 17:33:50 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 17:33:50 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5TPC7Q3
2025-06-18 17:33:50 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-5TPC7Q3'
2025-06-18 17:33:50 [root] INFO: should_process_url: URL https://www.hellobc.com/travel-ideas/road-trips/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:51 [root] INFO: should_process_url: URL https://www.hellobc.com/travel-ideas/road-trips/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:51 [root] INFO: write_url_to_db(): appended URL 'https://www.hellobc.com/travel-ideas/road-trips/'
2025-06-18 17:33:51 [root] INFO: def parse(): Crawling next URL: https://www.hellobc.com/travel-ideas/road-trips/
2025-06-18 17:33:51 [root] INFO: should_process_url: URL https://www.hellobc.com/places-to-go/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:51 [root] INFO: should_process_url: URL https://www.hellobc.com/places-to-go/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:51 [root] INFO: write_url_to_db(): appended URL 'https://www.hellobc.com/places-to-go/'
2025-06-18 17:33:51 [root] INFO: def parse(): Crawling next URL: https://www.hellobc.com/places-to-go/
2025-06-18 17:33:51 [root] INFO: should_process_url: URL https://www.hellobc.com/places-to-go/vancouver-island/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:33:51 [root] INFO: should_process_url: URL https://www.hellobc.com/places-to-go/vancouver/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:51 [root] INFO: should_process_url: URL https://www.hellobc.com/places-to-go/vancouver/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:51 [root] INFO: write_url_to_db(): appended URL 'https://www.hellobc.com/places-to-go/vancouver/'
2025-06-18 17:33:51 [root] INFO: def parse(): Crawling next URL: https://www.hellobc.com/places-to-go/vancouver/
2025-06-18 17:33:51 [root] INFO: should_process_url: URL https://www.hellobc.com/travel-ideas/cities/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:51 [root] INFO: should_process_url: URL https://www.hellobc.com/travel-ideas/cities/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:51 [root] INFO: write_url_to_db(): appended URL 'https://www.hellobc.com/travel-ideas/cities/'
2025-06-18 17:33:51 [root] INFO: def parse(): Crawling next URL: https://www.hellobc.com/travel-ideas/cities/
2025-06-18 17:33:51 [root] INFO: should_process_url: URL https://www.hellobc.com/travel-ideas/rainforest/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:51 [root] INFO: should_process_url: URL https://www.hellobc.com/travel-ideas/rainforest/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:51 [root] INFO: write_url_to_db(): appended URL 'https://www.hellobc.com/travel-ideas/rainforest/'
2025-06-18 17:33:51 [root] INFO: def parse(): Crawling next URL: https://www.hellobc.com/travel-ideas/rainforest/
2025-06-18 17:33:51 [root] INFO: should_process_url: URL https://www.hellobc.com/travel-ideas/ocean/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:51 [root] INFO: should_process_url: URL https://www.hellobc.com/travel-ideas/ocean/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:51 [root] INFO: write_url_to_db(): appended URL 'https://www.hellobc.com/travel-ideas/ocean/'
2025-06-18 17:33:51 [root] INFO: def parse(): Crawling next URL: https://www.hellobc.com/travel-ideas/ocean/
2025-06-18 17:33:51 [root] INFO: should_process_url: URL https://www.hellobc.com/travel-ideas/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:51 [root] INFO: should_process_url: URL https://www.hellobc.com/travel-ideas/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:51 [root] INFO: write_url_to_db(): appended URL 'https://www.hellobc.com/travel-ideas/'
2025-06-18 17:33:51 [root] INFO: def parse(): Crawling next URL: https://www.hellobc.com/travel-ideas/
2025-06-18 17:33:51 [root] INFO: should_process_url: URL https://www.hellobc.com/summer2020/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:51 [root] INFO: should_process_url: URL https://www.hellobc.com/summer2020/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:51 [root] INFO: write_url_to_db(): appended URL 'https://www.hellobc.com/summer2020/'
2025-06-18 17:33:51 [root] INFO: def parse(): Crawling next URL: https://www.hellobc.com/summer2020/
2025-06-18 17:33:51 [root] INFO: should_process_url: URL https://www.hellobc.com/travel-ideas/mountains/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:51 [root] INFO: should_process_url: URL https://www.hellobc.com/travel-ideas/mountains/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:51 [root] INFO: write_url_to_db(): appended URL 'https://www.hellobc.com/travel-ideas/mountains/'
2025-06-18 17:33:51 [root] INFO: def parse(): Crawling next URL: https://www.hellobc.com/travel-ideas/mountains/
2025-06-18 17:33:51 [root] INFO: def parse(): Found keywords for URL https://www.tourismvernon.com/en/index.aspx: ['dance']
2025-06-18 17:33:51 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.tourismvernon.com/en/index.aspx
2025-06-18 17:33:51 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:33:51 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:33:51 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:33:51 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 17:33:51 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 131630 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 17:33:51 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 17:33:58 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:33:58 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 17:33:58 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 17:33:58 [root] INFO: write_url_to_db(): appended URL 'https://www.tourismvernon.com/en/index.aspx'
2025-06-18 17:33:58 [root] INFO: def parse(): URL https://www.tourismvernon.com/en/index.aspx marked as irrelevant (LLM negative).
2025-06-18 17:33:58 [root] INFO: def parse(): Found 4 links on https://www.tourismvernon.com/
2025-06-18 17:33:58 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-NT782KHB, URL: https://www.tourismvernon.com/en/index.aspx, source: 20+ BC summer 2025 music festivals all about good vibes ..., keywords: music festivals
2025-06-18 17:33:58 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 17:33:58 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-NT782KHB
2025-06-18 17:33:58 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-NT782KHB'
2025-06-18 17:33:58 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/Tourism.Vernon/'
2025-06-18 17:33:58 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/Tourism.Vernon/
2025-06-18 17:33:58 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/tourism_vernon/'
2025-06-18 17:33:58 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/tourism_vernon/
2025-06-18 17:33:58 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/@tourismvernon.
2025-06-18 17:33:58 [root] INFO: should_process_url: URL https://www.tourismvernon.com/en/index.aspx was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:33:58 [root] INFO: should_process_url: URL https://www.tourismvernon.com/get-inspired/whats-on-in-june was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:58 [root] INFO: should_process_url: URL https://www.tourismvernon.com/get-inspired/whats-on-in-june was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:33:58 [root] INFO: write_url_to_db(): appended URL 'https://www.tourismvernon.com/get-inspired/whats-on-in-june'
2025-06-18 17:33:58 [root] INFO: def parse(): Crawling next URL: https://www.tourismvernon.com/get-inspired/whats-on-in-june
2025-06-18 17:33:58 [root] INFO: def parse(): Found keywords for URL https://www.5rhythms.com/nl//TeacherSearch.php: ['dance']
2025-06-18 17:33:58 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.5rhythms.com/nl//TeacherSearch.php
2025-06-18 17:33:58 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:33:58 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:33:58 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:34:03 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:34:03 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 17:34:03 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 17:34:03 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/nl//TeacherSearch.php'
2025-06-18 17:34:03 [root] INFO: def parse(): URL https://www.5rhythms.com/nl//TeacherSearch.php marked as irrelevant (LLM negative).
2025-06-18 17:34:03 [root] INFO: def parse(): Found 10 links on https://www.5rhythms.com/nl//TeacherSearch.php
2025-06-18 17:34:03 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/5rhythms'
2025-06-18 17:34:03 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/5rhythms
2025-06-18 17:34:03 [root] INFO: write_url_to_db(): appended URL 'https://instagram.com/5rhythms/'
2025-06-18 17:34:03 [root] INFO: def parse(): Recorded unwanted URL: https://instagram.com/5rhythms/
2025-06-18 17:34:03 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/5Rhythms.
2025-06-18 17:34:03 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:34:03 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl has never been seen before, processing it.
2025-06-18 17:34:03 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ has never been seen before, processing it.
2025-06-18 17:34:03 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/EventSearch.php has never been seen before, processing it.
2025-06-18 17:34:03 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl//TeacherSearch.php was last seen as relevant, processing it.
2025-06-18 17:34:03 [root] INFO: should_process_url: URL https://www.5rhythms.com/es/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:34:03 [root] INFO: should_process_url: URL https://www.5rhythms.com/ was last seen as relevant, processing it.
2025-06-18 17:34:03 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/TeacherSearch.php has never been seen before, processing it.
2025-06-18 17:34:03 [root] INFO: def parse(): Found keywords for URL https://www.5rhythms.com/nl//gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/: ['dance']
2025-06-18 17:34:03 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.5rhythms.com/nl//gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/
2025-06-18 17:34:03 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:34:03 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:34:03 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:34:08 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:34:08 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 17:34:08 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 17:34:08 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/nl//gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/'
2025-06-18 17:34:08 [root] INFO: def parse(): URL https://www.5rhythms.com/nl//gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ marked as irrelevant (LLM negative).
2025-06-18 17:34:08 [root] INFO: def parse(): Found 10 links on https://www.5rhythms.com/nl/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/
2025-06-18 17:34:08 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/5rhythms'
2025-06-18 17:34:08 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/5rhythms
2025-06-18 17:34:08 [root] INFO: write_url_to_db(): appended URL 'https://instagram.com/5rhythms/'
2025-06-18 17:34:08 [root] INFO: def parse(): Recorded unwanted URL: https://instagram.com/5rhythms/
2025-06-18 17:34:08 [root] INFO: should_process_url: URL https://www.5rhythms.com/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings-old/ has never been seen before, processing it.
2025-06-18 17:34:08 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/5Rhythms.
2025-06-18 17:34:08 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:34:08 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl//EventSearch.php was last seen as relevant, processing it.
2025-06-18 17:34:08 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl//gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ was last seen as relevant, processing it.
2025-06-18 17:34:08 [root] INFO: should_process_url: URL https://www.5rhythms.com/es/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ has never been seen before, processing it.
2025-06-18 17:34:08 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ has never been seen before, processing it.
2025-06-18 17:34:08 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl//TeacherSearch.php was last seen as relevant, processing it.
2025-06-18 17:34:08 [root] INFO: def parse(): Found keywords for URL https://www.5rhythms.com/who-we-are/: ['dance']
2025-06-18 17:34:08 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.5rhythms.com/who-we-are/
2025-06-18 17:34:08 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:34:08 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:34:08 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:34:42 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:34:42 [root] INFO: query_llm(): Mistral response received: [
    {
        "source": "https://www.5rhythms.com/who-we-are/",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "5Rhythms Global",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": "Details on 5 Rhythms founder Gabrielle Roth, the movement center and our teachers."
    },
    {
        "source": "https://www.5rhythms.com/who-we-are/",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "A World of Practice",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": "A World of Practice."
    },
    {
        "source": "https://www.5rhythms.com/who-we-are/",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "5Rhythms Teachers Association",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": "5Rhythms Teachers Association."
    },
    {
        "source": "https://www.5rhythms.com/who-we-are/",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Our Tribe",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": "Our Tribe."
    },
    {
        "source": "https://www.5rhythms.com/who-we-are/",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Community Service",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": "Community Service."
    }
]
2025-06-18 17:34:42 [root] INFO: def extract_and_parse_json(): for url https://www.5rhythms.com/who-we-are/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "https://www.5rhythms.com/who-we-are/",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "5Rhythms Global",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": "Details on 5 Rhythms founder Gabrielle Roth, the movement center and our teachers."
    },
    {
        "source": "https://www.5rhythms.com/who-we-are/",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "A World of Practice",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": "A World of Practice."
    },
    {
        "source": "https://www.5rhythms.com/who-we-are/",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "5Rhythms Teachers Association",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": "5Rhythms Teachers Association."
    },
    {
        "source": "https://www.5rhythms.com/who-we-are/",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Our Tribe",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": "Our Tribe."
    },
    {
        "source": "https://www.5rhythms.com/who-we-are/",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Community Service",
        "day_of_week": "",
        "start_date": "",
        "end_date": "",
        "start_time": "",
        "end_time": null,
        "price": "",
        "location": "",
        "description": "Community Service."
    }
]
2025-06-18 17:34:42 [root] INFO: def clean_up_address(): Starting with events_df shape: (5, 14)
2025-06-18 17:34:42 [root] INFO: write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 17:34:42 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/who-we-are/'
2025-06-18 17:34:42 [root] INFO: def process_llm_response: URL https://www.5rhythms.com/who-we-are/ marked as relevant with events written to the database.
2025-06-18 17:34:42 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/who-we-are/'
2025-06-18 17:34:42 [root] INFO: def parse(): URL https://www.5rhythms.com/who-we-are/ marked as relevant (LLM positive).
2025-06-18 17:34:42 [root] INFO: def parse(): Found 10 links on https://www.5rhythms.com/who-we-are/
2025-06-18 17:34:42 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/5rhythms'
2025-06-18 17:34:42 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/5rhythms
2025-06-18 17:34:42 [root] INFO: write_url_to_db(): appended URL 'https://instagram.com/5rhythms/'
2025-06-18 17:34:42 [root] INFO: def parse(): Recorded unwanted URL: https://instagram.com/5rhythms/
2025-06-18 17:34:42 [root] INFO: should_process_url: URL https://www.5rhythms.com/EventSearch.php was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:34:42 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/5Rhythms.
2025-06-18 17:34:42 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/who-we-are/ has never been seen before, processing it.
2025-06-18 17:34:42 [root] INFO: should_process_url: URL https://www.5rhythms.com/nl/who-we-are/ has never been seen before, processing it.
2025-06-18 17:34:42 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/nl/who-we-are/'
2025-06-18 17:34:42 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/nl/who-we-are/
2025-06-18 17:34:42 [root] INFO: should_process_url: URL https://www.5rhythms.com/es/who-we-are/ has never been seen before, processing it.
2025-06-18 17:34:42 [root] INFO: should_process_url: URL https://www.5rhythms.com/es/who-we-are/ has never been seen before, processing it.
2025-06-18 17:34:42 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/es/who-we-are/'
2025-06-18 17:34:42 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/es/who-we-are/
2025-06-18 17:34:42 [root] INFO: should_process_url: URL https://www.5rhythms.com/who-we-are/ has never been seen before, processing it.
2025-06-18 17:34:42 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/who-we-are/ has never been seen before, processing it.
2025-06-18 17:34:42 [root] INFO: should_process_url: URL https://www.5rhythms.com/hr/who-we-are/ has never been seen before, processing it.
2025-06-18 17:34:42 [root] INFO: write_url_to_db(): appended URL 'https://www.5rhythms.com/hr/who-we-are/'
2025-06-18 17:34:42 [root] INFO: def parse(): Crawling next URL: https://www.5rhythms.com/hr/who-we-are/
2025-06-18 17:34:42 [root] INFO: should_process_url: URL https://www.5rhythms.com/gabrielle-roths-5rhythms/the-dancing-path/teacher-trainings/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:34:42 [root] INFO: should_process_url: URL https://www.5rhythms.com was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:34:42 [root] INFO: should_process_url: URL https://www.5rhythms.com/TeacherSearch.php was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:34:42 [root] INFO: write_url_to_db(): appended URL 'http://www.gofolk.dk'
2025-06-18 17:34:42 [root] INFO: def parse(): URL http://www.gofolk.dk marked as irrelevant (no keywords).
2025-06-18 17:34:42 [root] INFO: def parse(): Found 1 links on https://www.gofolk.dk/
2025-06-18 17:34:42 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://go2016.gofolk.dk, URL: http://www.gofolk.dk, source: Natalie Padilla, keywords: country waltz
2025-06-18 17:34:42 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: ר(~dv
2025-06-18 17:34:42 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://go2016.gofolk.dk
2025-06-18 17:34:42 [root] INFO: write_url_to_db(): appended URL 'https://go2016.gofolk.dk'
2025-06-18 17:34:42 [root] INFO: should_process_url: URL https://go2016.gofolk.dk has never been seen before, processing it.
2025-06-18 17:34:42 [root] INFO: should_process_url: URL https://go2016.gofolk.dk has never been seen before, processing it.
2025-06-18 17:34:42 [root] INFO: write_url_to_db(): appended URL 'https://go2016.gofolk.dk'
2025-06-18 17:34:42 [root] INFO: def parse(): Crawling next URL: https://go2016.gofolk.dk
2025-06-18 17:34:42 [root] INFO: should_process_url: URL http://www.gofolk.dk was last seen as relevant, processing it.
2025-06-18 17:34:42 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://mailchimp.com/integrations/?categories=E-commerce> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:34:42 [scrapy.extensions.logstats] INFO: Crawled 452 pages (at 21 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 17:34:42 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://mailchimp.com/> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:34:42 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://mailchimp.com/developer/> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:34:42 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.victoriaskafest.ca/home> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:34:42 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://store.last.fm> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:34:42 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.shopify.com?utm_campaign=poweredby&utm_medium=shopify&utm_source=onlinestore> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:34:42 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET http://jazzvictoria.ca/> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionDone: Connection was closed cleanly.>]
2025-06-18 17:34:42 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://jazzvictoria.ca/home/tickets/> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:34:42 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET http://www.thebluefoxcafe.com/> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionDone: Connection was closed cleanly.>]
2025-06-18 17:34:42 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.funtasticalberni.com/home.html> (failed 3 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:34:42 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <403 https://prismafestival.com/tickets/>: HTTP status code is not handled or not allowed
2025-06-18 17:34:42 [root] INFO: def parse(): Found keywords for URL https://www.salsagonzales.com/pages/about-us: ['salsa']
2025-06-18 17:34:42 [root] INFO: def generate_prompt(): Generating prompt for URL: https://www.salsagonzales.com/pages/about-us
2025-06-18 17:34:42 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:34:42 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:34:42 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:35:05 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:35:05 [root] INFO: query_llm(): Mistral response received: No events found.
2025-06-18 17:35:05 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 17:35:05 [root] INFO: write_url_to_db(): appended URL 'https://www.salsagonzales.com/pages/about-us'
2025-06-18 17:35:05 [root] INFO: def parse(): URL https://www.salsagonzales.com/pages/about-us marked as irrelevant (LLM negative).
2025-06-18 17:35:05 [root] INFO: def parse(): Found 2 links on https://www.salsagonzales.com/pages/about-us
2025-06-18 17:35:05 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://www.googletagmanager.com/ns.html?id=GTM-5FBTLHLM, URL: https://www.salsagonzales.com/pages/about-us, source: Salsa Gonzales - salsa, hot sauce, and spicy pickles for sale online, keywords: salsa
2025-06-18 17:35:05 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid:  %z֠ځܢof'
2025-06-18 17:35:05 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://www.googletagmanager.com/ns.html?id=GTM-5FBTLHLM
2025-06-18 17:35:05 [root] INFO: write_url_to_db(): appended URL 'https://www.googletagmanager.com/ns.html?id=GTM-5FBTLHLM'
2025-06-18 17:35:05 [root] INFO: should_process_url: URL https://www.salsagonzales.com/pages/about-us was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:35:05 [root] INFO: should_process_url: URL https://www.shopify.com?utm_campaign=poweredby&utm_medium=shopify&utm_source=onlinestore was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:35:05 [root] INFO: def parse(): Found keywords for URL https://bethmalcolm.bandcamp.com/album/kissed-and-cried: ['bachata', 'dance', 'merengue', 'salsa', 'swing', 'tango']
2025-06-18 17:35:05 [root] INFO: def generate_prompt(): Generating prompt for URL: https://bethmalcolm.bandcamp.com/album/kissed-and-cried
2025-06-18 17:35:05 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:35:05 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:35:05 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:35:06 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 17:35:06 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 140309 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 17:35:06 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 17:35:14 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:35:14 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 17:35:14 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 17:35:14 [root] INFO: write_url_to_db(): appended URL 'https://bethmalcolm.bandcamp.com/album/kissed-and-cried'
2025-06-18 17:35:14 [root] INFO: def parse(): URL https://bethmalcolm.bandcamp.com/album/kissed-and-cried marked as irrelevant (LLM negative).
2025-06-18 17:35:14 [root] INFO: def parse(): Found 10 links on https://bethmalcolm.bandcamp.com/album/kissed-and-cried
2025-06-18 17:35:14 [root] INFO: should_process_url: URL https://bandcamp.com/logout was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:35:14 [root] INFO: should_process_url: URL https://bethmalcolm.bandcamp.com/album/kissed-and-cried was last seen as relevant, processing it.
2025-06-18 17:35:14 [root] INFO: should_process_url: URL https://bandcamp.com/partner was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:35:14 [root] INFO: should_process_url: URL https://f4.bcbits.com/img/a1830593743_10.jpg has never been seen before, processing it.
2025-06-18 17:35:14 [root] INFO: should_process_url: URL https://f4.bcbits.com/img/a1830593743_10.jpg has never been seen before, processing it.
2025-06-18 17:35:14 [root] INFO: write_url_to_db(): appended URL 'https://f4.bcbits.com/img/a1830593743_10.jpg'
2025-06-18 17:35:14 [root] INFO: def parse(): Crawling next URL: https://f4.bcbits.com/img/a1830593743_10.jpg
2025-06-18 17:35:14 [root] INFO: should_process_url: URL https://bandcamp.com/settings?from=menubar was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:35:14 [root] INFO: should_process_url: URL https://bethmalcolm.bandcamp.com has never been seen before, processing it.
2025-06-18 17:35:14 [root] INFO: should_process_url: URL https://bethmalcolm.bandcamp.com has never been seen before, processing it.
2025-06-18 17:35:14 [root] INFO: write_url_to_db(): appended URL 'https://bethmalcolm.bandcamp.com'
2025-06-18 17:35:14 [root] INFO: def parse(): Crawling next URL: https://bethmalcolm.bandcamp.com
2025-06-18 17:35:14 [root] INFO: should_process_url: URL https://bandcamp.com/?from=menubar_logo_logged_out was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:35:14 [root] INFO: should_process_url: URL https://bandcamp.com/cart was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:35:14 [root] INFO: should_process_url: URL https://bandcamp.com/login?from=menubar was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:35:14 [root] INFO: should_process_url: URL https://get.bandcamp.help was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:35:14 [root] INFO: def parse(): Found keywords for URL https://victoriaskafest.ca/#/tickets: ['dance', 'swing']
2025-06-18 17:35:14 [root] INFO: def generate_prompt(): Generating prompt for URL: https://victoriaskafest.ca/#/tickets
2025-06-18 17:35:14 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:35:14 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:35:14 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:50:15 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 504 Gateway Timeout"
2025-06-18 17:50:15 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 504
{
  "message":"The upstream server is timing out",
  "request_id":"cafe22309fed3244fb81e75e002c3f19"
}
2025-06-18 17:50:15 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 17:50:32 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:50:32 [root] INFO: query_llm(): OpenAI response received: No events found.
2025-06-18 17:50:32 [root] INFO: def extract_and_parse_json(): No events found in result.
2025-06-18 17:50:33 [root] INFO: write_url_to_db(): appended URL 'https://victoriaskafest.ca/#/tickets'
2025-06-18 17:50:33 [root] INFO: def parse(): URL https://victoriaskafest.ca/#/tickets marked as irrelevant (LLM negative).
2025-06-18 17:50:33 [root] INFO: def parse(): Found 10 links on https://victoriaskafest.ca/
2025-06-18 17:50:33 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/victoria.ska.fest'
2025-06-18 17:50:33 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/victoria.ska.fest
2025-06-18 17:50:33 [root] INFO: write_url_to_db(): appended URL 'https://www.instagram.com/vicskareggaefest/'
2025-06-18 17:50:33 [root] INFO: def parse(): Recorded unwanted URL: https://www.instagram.com/vicskareggaefest/
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://tidal.com/browse/playlist/4954b1a7-03b5-48b9-8964-ffeae715688b has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://tidal.com/browse/playlist/4954b1a7-03b5-48b9-8964-ffeae715688b has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: write_url_to_db(): appended URL 'https://tidal.com/browse/playlist/4954b1a7-03b5-48b9-8964-ffeae715688b'
2025-06-18 17:50:33 [root] INFO: def parse(): Crawling next URL: https://tidal.com/browse/playlist/4954b1a7-03b5-48b9-8964-ffeae715688b
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://victoriaskafest.ca/#/tickets was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://tidal.com/browse/playlist/f8f40089-220b-4233-a281-f6b4f1fadbde has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://tidal.com/browse/playlist/f8f40089-220b-4233-a281-f6b4f1fadbde has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: write_url_to_db(): appended URL 'https://tidal.com/browse/playlist/f8f40089-220b-4233-a281-f6b4f1fadbde'
2025-06-18 17:50:33 [root] INFO: def parse(): Crawling next URL: https://tidal.com/browse/playlist/f8f40089-220b-4233-a281-f6b4f1fadbde
2025-06-18 17:50:33 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/c/VictoriaSkaReggaeSociety.
2025-06-18 17:50:33 [root] INFO: parse: Skipping blacklisted URL https://open.spotify.com/playlist/4P9VTIHFgeca99EoyHfdzk?si=944510cd68a24e16.
2025-06-18 17:50:33 [root] INFO: parse: Skipping blacklisted URL https://twitter.com/#!/Victoriaskafest.
2025-06-18 17:50:33 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/playlist?list=PLZL11OgzKdY0dBRSGPoiSlM5RvMaAsopO.
2025-06-18 17:50:33 [root] INFO: parse: Skipping blacklisted URL https://open.spotify.com/playlist/68VJYhrBLPfAx5ZcPAOkPC?si=b83bdc85ce024848.
2025-06-18 17:50:33 [root] INFO: parse: Skipping blacklisted URL https://open.spotify.com/playlist/0T0aLDX8F8SsVpQUB6RJ2q.
2025-06-18 17:50:33 [root] INFO: write_url_to_db(): appended URL 'http://www.svobsk.dk'
2025-06-18 17:50:33 [root] INFO: def parse(): URL http://www.svobsk.dk marked as irrelevant (no keywords).
2025-06-18 17:50:33 [root] INFO: def parse(): Found 10 links on https://svobsk.dk/
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://svobsk.dk/firma/ has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://svobsk.dk/firma/ has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: write_url_to_db(): appended URL 'https://svobsk.dk/firma/'
2025-06-18 17:50:33 [root] INFO: def parse(): Crawling next URL: https://svobsk.dk/firma/
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://svobsk.dk/kirke/ has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://svobsk.dk/kirke/ has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: write_url_to_db(): appended URL 'https://svobsk.dk/kirke/'
2025-06-18 17:50:33 [root] INFO: def parse(): Crawling next URL: https://svobsk.dk/kirke/
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://svobsk.dk/svobsk/ has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://svobsk.dk/svobsk/ has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: write_url_to_db(): appended URL 'https://svobsk.dk/svobsk/'
2025-06-18 17:50:33 [root] INFO: def parse(): Crawling next URL: https://svobsk.dk/svobsk/
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://svobsk.dk/svobsk-kvartet/ has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://svobsk.dk/svobsk-kvartet/ has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: write_url_to_db(): appended URL 'https://svobsk.dk/svobsk-kvartet/'
2025-06-18 17:50:33 [root] INFO: def parse(): Crawling next URL: https://svobsk.dk/svobsk-kvartet/
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://svobsk.dk/player-2/ has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://svobsk.dk/player-2/ has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: write_url_to_db(): appended URL 'https://svobsk.dk/player-2/'
2025-06-18 17:50:33 [root] INFO: def parse(): Crawling next URL: https://svobsk.dk/player-2/
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://svobsk.dk/ has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://svobsk.dk/ has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: write_url_to_db(): appended URL 'https://svobsk.dk/'
2025-06-18 17:50:33 [root] INFO: def parse(): Crawling next URL: https://svobsk.dk/
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://svobsk.dk/musikforedrag/ has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://svobsk.dk/musikforedrag/ has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: write_url_to_db(): appended URL 'https://svobsk.dk/musikforedrag/'
2025-06-18 17:50:33 [root] INFO: def parse(): Crawling next URL: https://svobsk.dk/musikforedrag/
2025-06-18 17:50:33 [root] INFO: should_process_url: URL http://www.svobsk.dk was last seen as relevant, processing it.
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://svobsk.dk/born/ has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://svobsk.dk/born/ has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: write_url_to_db(): appended URL 'https://svobsk.dk/born/'
2025-06-18 17:50:33 [root] INFO: def parse(): Crawling next URL: https://svobsk.dk/born/
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://svobsk.dk/katalog/ has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://svobsk.dk/katalog/ has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: write_url_to_db(): appended URL 'https://svobsk.dk/katalog/'
2025-06-18 17:50:33 [root] INFO: def parse(): Crawling next URL: https://svobsk.dk/katalog/
2025-06-18 17:50:33 [root] INFO: write_url_to_db(): appended URL 'http://www.artes-Konzertbuero.de'
2025-06-18 17:50:33 [root] INFO: def parse(): URL http://www.artes-Konzertbuero.de marked as irrelevant (no keywords).
2025-06-18 17:50:33 [root] INFO: def parse(): Found 10 links on https://www.artes-konzertbuero.de/
2025-06-18 17:50:33 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://player.vimeo.com/video/1000472108, URL: http://www.artes-Konzertbuero.de, source: Natalie Padilla, keywords: country waltz
2025-06-18 17:50:33 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: Vzoר]4ӎO
2025-06-18 17:50:33 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://player.vimeo.com/video/1000472108
2025-06-18 17:50:33 [root] INFO: write_url_to_db(): appended URL 'https://player.vimeo.com/video/1000472108'
2025-06-18 17:50:33 [root] INFO: write_url_to_db(): appended URL 'https://www.facebook.com/arteskonzertbuero'
2025-06-18 17:50:33 [root] INFO: def parse(): Recorded unwanted URL: https://www.facebook.com/arteskonzertbuero
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://listen.music-hub.com/oeBcfZ?fbclid=IwZXh0bgNhZW0CMTAAAR1lHFCcWGi8hxNRIDTANyCSHeYZ-FS9S-hbcdxoJ7yd05BajvWw0K1avu4_aem_ZjvNuoRF6a0lOmlNxyKlVw has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://listen.music-hub.com/oeBcfZ?fbclid=IwZXh0bgNhZW0CMTAAAR1lHFCcWGi8hxNRIDTANyCSHeYZ-FS9S-hbcdxoJ7yd05BajvWw0K1avu4_aem_ZjvNuoRF6a0lOmlNxyKlVw has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: write_url_to_db(): appended URL 'https://listen.music-hub.com/oeBcfZ?fbclid=IwZXh0bgNhZW0CMTAAAR1lHFCcWGi8hxNRIDTANyCSHeYZ-FS9S-hbcdxoJ7yd05BajvWw0K1avu4_aem_ZjvNuoRF6a0lOmlNxyKlVw'
2025-06-18 17:50:33 [root] INFO: def parse(): Crawling next URL: https://listen.music-hub.com/oeBcfZ?fbclid=IwZXh0bgNhZW0CMTAAAR1lHFCcWGi8hxNRIDTANyCSHeYZ-FS9S-hbcdxoJ7yd05BajvWw0K1avu4_aem_ZjvNuoRF6a0lOmlNxyKlVw
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://linktr.ee/flookquartet has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://linktr.ee/flookquartet has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: write_url_to_db(): appended URL 'https://linktr.ee/flookquartet'
2025-06-18 17:50:33 [root] INFO: def parse(): Crawling next URL: https://linktr.ee/flookquartet
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://www.schallplattenkritik.de/bestenlisten/2025/02?c=18 has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://www.schallplattenkritik.de/bestenlisten/2025/02?c=18 has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: write_url_to_db(): appended URL 'https://www.schallplattenkritik.de/bestenlisten/2025/02?c=18'
2025-06-18 17:50:33 [root] INFO: def parse(): Crawling next URL: https://www.schallplattenkritik.de/bestenlisten/2025/02?c=18
2025-06-18 17:50:33 [root] INFO: parse: Skipping blacklisted URL https://www.youtube.com/user/artesrecords.
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://www.jugendfolkorchester.de has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://www.jugendfolkorchester.de has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: write_url_to_db(): appended URL 'https://www.jugendfolkorchester.de'
2025-06-18 17:50:33 [root] INFO: def parse(): Crawling next URL: https://www.jugendfolkorchester.de
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://broombezzums.bandcamp.com/album/standing-strong?fbclid=IwZXh0bgNhZW0CMTAAAR28A8jD3wMz4CDtw2YjsBGUDrOTjNQwyJgzsl9VCo-hcp-bWAlkBBaLqrw_aem__9TsxGDSoEMTcf1cr4XnSw has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://broombezzums.bandcamp.com/album/standing-strong?fbclid=IwZXh0bgNhZW0CMTAAAR28A8jD3wMz4CDtw2YjsBGUDrOTjNQwyJgzsl9VCo-hcp-bWAlkBBaLqrw_aem__9TsxGDSoEMTcf1cr4XnSw has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: write_url_to_db(): appended URL 'https://broombezzums.bandcamp.com/album/standing-strong?fbclid=IwZXh0bgNhZW0CMTAAAR28A8jD3wMz4CDtw2YjsBGUDrOTjNQwyJgzsl9VCo-hcp-bWAlkBBaLqrw_aem__9TsxGDSoEMTcf1cr4XnSw'
2025-06-18 17:50:33 [root] INFO: def parse(): Crawling next URL: https://broombezzums.bandcamp.com/album/standing-strong?fbclid=IwZXh0bgNhZW0CMTAAAR28A8jD3wMz4CDtw2YjsBGUDrOTjNQwyJgzsl9VCo-hcp-bWAlkBBaLqrw_aem__9TsxGDSoEMTcf1cr4XnSw
2025-06-18 17:50:33 [root] INFO: should_process_url: URL http://www.artes-Konzertbuero.de was last seen as relevant, processing it.
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://listen.music-hub.com/T6n05s has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: should_process_url: URL https://listen.music-hub.com/T6n05s has never been seen before, processing it.
2025-06-18 17:50:33 [root] INFO: write_url_to_db(): appended URL 'https://listen.music-hub.com/T6n05s'
2025-06-18 17:50:33 [root] INFO: def parse(): Crawling next URL: https://listen.music-hub.com/T6n05s
2025-06-18 17:50:33 [root] INFO: def parse(): Found keywords for URL https://sipmagazine.com/travel/: ['dance', 'live music', 'rumba']
2025-06-18 17:50:33 [root] INFO: def generate_prompt(): Generating prompt for URL: https://sipmagazine.com/travel/
2025-06-18 17:50:33 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:50:33 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:50:33 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:50:35 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 17:50:35 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 227446 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 17:50:35 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 17:51:56 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:51:56 [root] INFO: query_llm(): OpenAI response received: [{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Summer Terrace Series",
    "day_of_week": "Monday",
    "start_date": "2025-06-16",
    "end_date": "2025-06-16",
    "start_time": "16:00",
    "end_time": "19:00",
    "price": "$0",
    "location": "Fielding Hills Winery, 565 S Lakeshore DR, Chelan, WA 98816",
    "description": "Every Saturday in July and August from 4 - 7pm, spend a relaxing evening listening to talented local musicians on our terrace. Evenings will include a menu of glass pours, …"
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Celebrate Walla Walla Summer Supper",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-20",
    "start_time": "17:30",
    "end_time": "20:00",
    "price": "$100",
    "location": "Echolands, 3281 Mill Creek Rd, Walla Walla, WA 99362",
    "description": "Enjoy a BBQ-inspired summer menu, paired with approachable wines, and community vibes at this relaxed vineyard dinner. Station-style dining and a wide range of wines highlight the Valley’s versatility. Includes …"
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Pizza Pop Up at Dineen Vineyards",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "12:00",
    "end_time": "17:00",
    "price": "",
    "location": "Dineen Vineyards, 2980 Gilbert Road, Zillah, 98953",
    "description": "Join us for Pizza Days at Dineen Vineyards On selected weekends, Chef Jacob will be on site making hand-thrown pizzas crafted with the freshest local ingredients! A perfect opportunity to …"
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Celebrate Walla Walla Block Party",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "14:00",
    "end_time": "17:00",
    "price": "",
    "location": "The Motor Co., 64 E. Rose Street, Walla Walla, WA 99362",
    "description": "Experience the Valley’s energy downtown! This vibrant event includes tastings from 50+ wineries, local cuisine, live music, and a bottle shop so you can take your favorites home. VIP early …"
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Wines in the Vines Vineyard Tour at Dineen Vineyards",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "14:00",
    "end_time": "16:00",
    "price": "",
    "location": "Dineen Vineyards, 2980 Gilbert Road, Zillah, 98953",
    "description": "Join Dineen Vineyards for a “Wines in the Vines” Experience! Every year we select different wines and choose a new path through the vineyard to share with our guests. Saturday, …"
}]
2025-06-18 17:51:56 [root] INFO: def extract_and_parse_json(): for url https://sipmagazine.com/travel/, 
Cleaned JSON ready for parsing:
[{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Summer Terrace Series",
    "day_of_week": "Monday",
    "start_date": "2025-06-16",
    "end_date": "2025-06-16",
    "start_time": "16:00",
    "end_time": "19:00",
    "price": "$0",
    "location": "Fielding Hills Winery, 565 S Lakeshore DR, Chelan, WA 98816",
    "description": "Every Saturday in July and August from 4 - 7pm, spend a relaxing evening listening to talented local musicians on our terrace. Evenings will include a menu of glass pours, …"
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Celebrate Walla Walla Summer Supper",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-20",
    "start_time": "17:30",
    "end_time": "20:00",
    "price": "$100",
    "location": "Echolands, 3281 Mill Creek Rd, Walla Walla, WA 99362",
    "description": "Enjoy a BBQ-inspired summer menu, paired with approachable wines, and community vibes at this relaxed vineyard dinner. Station-style dining and a wide range of wines highlight the Valley’s versatility. Includes …"
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Pizza Pop Up at Dineen Vineyards",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "12:00",
    "end_time": "17:00",
    "price": "",
    "location": "Dineen Vineyards, 2980 Gilbert Road, Zillah, 98953",
    "description": "Join us for Pizza Days at Dineen Vineyards On selected weekends, Chef Jacob will be on site making hand-thrown pizzas crafted with the freshest local ingredients! A perfect opportunity to …"
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Celebrate Walla Walla Block Party",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "14:00",
    "end_time": "17:00",
    "price": "",
    "location": "The Motor Co., 64 E. Rose Street, Walla Walla, WA 99362",
    "description": "Experience the Valley’s energy downtown! This vibrant event includes tastings from 50+ wineries, local cuisine, live music, and a bottle shop so you can take your favorites home. VIP early …"
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Wines in the Vines Vineyard Tour at Dineen Vineyards",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "14:00",
    "end_time": "16:00",
    "price": "",
    "location": "Dineen Vineyards, 2980 Gilbert Road, Zillah, 98953",
    "description": "Join Dineen Vineyards for a “Wines in the Vines” Experience! Every year we select different wines and choose a new path through the vineyard to share with our guests. Saturday, …"
}]
2025-06-18 17:51:56 [root] INFO: def clean_up_address(): Starting with events_df shape: (5, 14)
2025-06-18 17:51:56 [root] INFO: def clean_up_address(): Processing location 'Fielding Hills Winery, 565 S Lakeshore DR, Chelan, WA 98816' (event_id: None)
2025-06-18 17:51:56 [root] INFO: def clean_up_address(): Processing location 'Echolands, 3281 Mill Creek Rd, Walla Walla, WA 99362' (event_id: None)
2025-06-18 17:51:56 [root] INFO: def clean_up_address(): Processing location 'Dineen Vineyards, 2980 Gilbert Road, Zillah, 98953' (event_id: None)
2025-06-18 17:51:56 [root] INFO: def clean_up_address(): Processing location 'The Motor Co., 64 E. Rose Street, Walla Walla, WA 99362' (event_id: None)
2025-06-18 17:51:56 [root] INFO: def clean_up_address(): Processing location 'Dineen Vineyards, 2980 Gilbert Road, Zillah, 98953' (event_id: None)
2025-06-18 17:51:56 [root] INFO: write_events_to_db: Number of events to write: 5
2025-06-18 17:51:56 [root] INFO: write_url_to_db(): appended URL 'https://sipmagazine.com/travel/'
2025-06-18 17:51:56 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 17:51:56 [root] INFO: def process_llm_response: URL https://sipmagazine.com/travel/ marked as relevant with events written to the database.
2025-06-18 17:51:56 [root] INFO: write_url_to_db(): appended URL 'https://sipmagazine.com/travel/'
2025-06-18 17:51:56 [root] INFO: def parse(): URL https://sipmagazine.com/travel/ marked as relevant (LLM positive).
2025-06-18 17:51:56 [root] INFO: def parse(): Found 10 links on https://sipmagazine.com/travel/
2025-06-18 17:51:56 [root] INFO: should_process_url: URL https://sipmagazine.com/travel/ has never been seen before, processing it.
2025-06-18 17:51:56 [root] INFO: should_process_url: URL https://sipmagazine.com/spirits/ has never been seen before, processing it.
2025-06-18 17:51:56 [root] INFO: should_process_url: URL https://sipmagazine.com/shopping/ has never been seen before, processing it.
2025-06-18 17:51:56 [root] INFO: should_process_url: URL https://sipmagazine.com/events/ has never been seen before, processing it.
2025-06-18 17:51:56 [root] INFO: should_process_url: URL https://sipmagazine.com/cider/ has never been seen before, processing it.
2025-06-18 17:51:56 [root] INFO: should_process_url: URL https://sipmagazine.com/ has never been seen before, processing it.
2025-06-18 17:51:56 [root] INFO: should_process_url: URL https://sipmagazine.com/news/ has never been seen before, processing it.
2025-06-18 17:51:56 [root] INFO: should_process_url: URL https://sipmagazine.com/wine/ has never been seen before, processing it.
2025-06-18 17:51:56 [root] INFO: should_process_url: URL https://sipmagazine.com/beer/ has never been seen before, processing it.
2025-06-18 17:51:56 [root] INFO: should_process_url: URL https://sipmagazine.com/recipes/ has never been seen before, processing it.
2025-06-18 17:51:56 [scrapy.extensions.logstats] INFO: Crawled 452 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 17:51:56 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://turbotax.intuit.com/> (failed 3 times): DNS lookup failed: no results for hostname lookup: turbotax.intuit.com.
2025-06-18 17:51:56 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://bsky.app/profile/last.fm> (failed 3 times): User timeout caused connection failure: Getting https://bsky.app/profile/last.fm took longer than 180.0 seconds..
2025-06-18 17:51:56 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://app.e2ma.net/app2/audience/signup/2008664/1726574/> (failed 3 times): User timeout caused connection failure: Getting https://app.e2ma.net/app2/audience/signup/2008664/1726574/ took longer than 180.0 seconds..
2025-06-18 17:51:56 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://closestays.com/stays/?address=1333+Bayshore+Highway%2C+Burlingame%2C+CA+94403> (failed 3 times): User timeout caused connection failure: Getting https://closestays.com/stays/?address=1333+Bayshore+Highway%2C+Burlingame%2C+CA+94403 took longer than 180.0 seconds..
2025-06-18 17:51:56 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.cohoferry.com/about-us> (failed 3 times): User timeout caused connection failure: Getting https://www.cohoferry.com/about-us took longer than 180.0 seconds..
2025-06-18 17:51:56 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.cohoferry.com/packages/victoria/macaloneys-island-distillery-and-twa-dogs-brewery-with-ferry> (failed 3 times): User timeout caused connection failure: Getting https://www.cohoferry.com/packages/victoria/macaloneys-island-distillery-and-twa-dogs-brewery-with-ferry took longer than 180.0 seconds..
2025-06-18 17:51:56 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.kathaumixw.org/tickets.shtml> (failed 3 times): User timeout caused connection failure: Getting https://www.kathaumixw.org/tickets.shtml took longer than 180.0 seconds..
2025-06-18 17:51:56 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://jazzvictoria.ca/jazzfest-home/workshops/> (failed 3 times): User timeout caused connection failure: Getting https://jazzvictoria.ca/jazzfest-home/workshops/ took longer than 180.0 seconds..
2025-06-18 17:51:56 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://vbds.org/calendar/> (failed 3 times): User timeout caused connection failure: Getting https://vbds.org/calendar/ took longer than 180.0 seconds..
2025-06-18 17:51:56 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://vbds.org/upcoming-classes-workshops/> (failed 3 times): User timeout caused connection failure: Getting https://vbds.org/upcoming-classes-workshops/ took longer than 180.0 seconds..
2025-06-18 17:51:56 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://vbds.org/introduction-to-ballroom-dancing/> (failed 3 times): User timeout caused connection failure: Getting https://vbds.org/introduction-to-ballroom-dancing/ took longer than 180.0 seconds..
2025-06-18 17:51:56 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://vbds.org/> (failed 3 times): User timeout caused connection failure: Getting https://vbds.org/ took longer than 180.0 seconds..
2025-06-18 17:51:56 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://vbds.org/members/> (failed 3 times): User timeout caused connection failure: Getting https://vbds.org/members/ took longer than 180.0 seconds..
2025-06-18 17:51:56 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://www.eventbrite.com/signin/signup/?referrer=%2Fd%2Fwa--bellingham%2Farts--events--today%2F> (failed 3 times): User timeout caused connection failure: Getting https://www.eventbrite.com/signin/signup/?referrer=%2Fd%2Fwa--bellingham%2Farts--events--today%2F took longer than 180.0 seconds..
2025-06-18 17:51:56 [scrapy.core.scraper] ERROR: Error downloading <GET https://mailchimp.com/integrations/?categories=E-commerce>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:51:56 [scrapy.core.scraper] ERROR: Error downloading <GET https://mailchimp.com/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:51:56 [scrapy.core.scraper] ERROR: Error downloading <GET https://mailchimp.com/developer/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:51:56 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.victoriaskafest.ca/home>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:51:56 [scrapy.core.scraper] ERROR: Error downloading <GET https://store.last.fm>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:51:56 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.shopify.com?utm_campaign=poweredby&utm_medium=shopify&utm_source=onlinestore>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:51:56 [scrapy.core.scraper] ERROR: Error downloading <GET http://jazzvictoria.ca/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionDone: Connection was closed cleanly.>]
2025-06-18 17:51:56 [scrapy.core.scraper] ERROR: Error downloading <GET https://jazzvictoria.ca/home/tickets/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:51:56 [scrapy.core.scraper] ERROR: Error downloading <GET http://www.thebluefoxcafe.com/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionDone: Connection was closed cleanly.>]
2025-06-18 17:51:56 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.funtasticalberni.com/home.html>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.web._newclient.ResponseNeverReceived: [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion: Connection lost.>]
2025-06-18 17:51:57 [root] INFO: write_url_to_db(): appended URL 'https://smithersmusicfest.com/'
2025-06-18 17:51:57 [root] INFO: def parse(): URL https://smithersmusicfest.com/ marked as irrelevant (no keywords).
2025-06-18 17:51:57 [root] INFO: def parse(): Found 10 links on https://smithersmusicfest.com/
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://smithersmusicfest.com/about/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://smithersmusicfest.com/merchandise/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://smithersmusicfest.com/camping-and-grounds/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://smithersmusicfest.com/2025-lineup/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://smithersmusicfest.com/admission/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://smithersmusicfest.com/performer-application/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://smithersmusicfest.com/tickets/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://smithersmusicfest.com/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://www.tickettailor.com/events/bulkleyvalleyfolkmusicsociety/1670109 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:51:57 [root] INFO: write_url_to_db(): appended URL 'https://walthertreyz.com/'
2025-06-18 17:51:57 [root] INFO: def parse(): URL https://walthertreyz.com/ marked as irrelevant (no keywords).
2025-06-18 17:51:57 [root] INFO: def parse(): Found 10 links on https://walthertreyz.com/
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://walthertreyz.com/ was last seen as relevant, processing it.
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://walthertreyz.com/ueber-uns/ has never been seen before, processing it.
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://walthertreyz.com/ueber-uns/ has never been seen before, processing it.
2025-06-18 17:51:57 [root] INFO: write_url_to_db(): appended URL 'https://walthertreyz.com/ueber-uns/'
2025-06-18 17:51:57 [root] INFO: def parse(): Crawling next URL: https://walthertreyz.com/ueber-uns/
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://walthertreyz.com/kontakt/ has never been seen before, processing it.
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://walthertreyz.com/kontakt/ has never been seen before, processing it.
2025-06-18 17:51:57 [root] INFO: write_url_to_db(): appended URL 'https://walthertreyz.com/kontakt/'
2025-06-18 17:51:57 [root] INFO: def parse(): Crawling next URL: https://walthertreyz.com/kontakt/
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://walthertreyz.com/video/ has never been seen before, processing it.
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://walthertreyz.com/video/ has never been seen before, processing it.
2025-06-18 17:51:57 [root] INFO: write_url_to_db(): appended URL 'https://walthertreyz.com/video/'
2025-06-18 17:51:57 [root] INFO: def parse(): Crawling next URL: https://walthertreyz.com/video/
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://shop.walthertreyz.com/?origin=walthertreyz has never been seen before, processing it.
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://shop.walthertreyz.com/?origin=walthertreyz has never been seen before, processing it.
2025-06-18 17:51:57 [root] INFO: write_url_to_db(): appended URL 'https://shop.walthertreyz.com/?origin=walthertreyz'
2025-06-18 17:51:57 [root] INFO: def parse(): Crawling next URL: https://shop.walthertreyz.com/?origin=walthertreyz
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://walthertreyz.com/downloads-fuer-veranstalter/ has never been seen before, processing it.
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://walthertreyz.com/downloads-fuer-veranstalter/ has never been seen before, processing it.
2025-06-18 17:51:57 [root] INFO: write_url_to_db(): appended URL 'https://walthertreyz.com/downloads-fuer-veranstalter/'
2025-06-18 17:51:57 [root] INFO: def parse(): Crawling next URL: https://walthertreyz.com/downloads-fuer-veranstalter/
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://walthertreyz.com/tourdaten/ has never been seen before, processing it.
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://walthertreyz.com/tourdaten/ has never been seen before, processing it.
2025-06-18 17:51:57 [root] INFO: write_url_to_db(): appended URL 'https://walthertreyz.com/tourdaten/'
2025-06-18 17:51:57 [root] INFO: def parse(): Crawling next URL: https://walthertreyz.com/tourdaten/
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://walthertreyz.com/musik/ has never been seen before, processing it.
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://walthertreyz.com/musik/ has never been seen before, processing it.
2025-06-18 17:51:57 [root] INFO: write_url_to_db(): appended URL 'https://walthertreyz.com/musik/'
2025-06-18 17:51:57 [root] INFO: def parse(): Crawling next URL: https://walthertreyz.com/musik/
2025-06-18 17:51:57 [scrapy.core.scraper] ERROR: Error downloading <GET https://turbotax.intuit.com/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/endpoints.py", line 1061, in startConnectionAttempts
    raise error.DNSLookupError(
twisted.internet.error.DNSLookupError: DNS lookup failed: no results for hostname lookup: turbotax.intuit.com.
2025-06-18 17:51:57 [scrapy.core.scraper] ERROR: Error downloading <GET https://bsky.app/profile/last.fm>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://bsky.app/profile/last.fm took longer than 180.0 seconds..
2025-06-18 17:51:57 [scrapy.core.scraper] ERROR: Error downloading <GET https://app.e2ma.net/app2/audience/signup/2008664/1726574/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://app.e2ma.net/app2/audience/signup/2008664/1726574/ took longer than 180.0 seconds..
2025-06-18 17:51:57 [scrapy.core.scraper] ERROR: Error downloading <GET https://closestays.com/stays/?address=1333+Bayshore+Highway%2C+Burlingame%2C+CA+94403>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://closestays.com/stays/?address=1333+Bayshore+Highway%2C+Burlingame%2C+CA+94403 took longer than 180.0 seconds..
2025-06-18 17:51:57 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.cohoferry.com/about-us>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://www.cohoferry.com/about-us took longer than 180.0 seconds..
2025-06-18 17:51:57 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.cohoferry.com/packages/victoria/macaloneys-island-distillery-and-twa-dogs-brewery-with-ferry>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://www.cohoferry.com/packages/victoria/macaloneys-island-distillery-and-twa-dogs-brewery-with-ferry took longer than 180.0 seconds..
2025-06-18 17:51:57 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.kathaumixw.org/tickets.shtml>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://www.kathaumixw.org/tickets.shtml took longer than 180.0 seconds..
2025-06-18 17:51:57 [scrapy.core.scraper] ERROR: Error downloading <GET https://jazzvictoria.ca/jazzfest-home/workshops/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://jazzvictoria.ca/jazzfest-home/workshops/ took longer than 180.0 seconds..
2025-06-18 17:51:57 [scrapy.core.scraper] ERROR: Error downloading <GET https://vbds.org/calendar/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://vbds.org/calendar/ took longer than 180.0 seconds..
2025-06-18 17:51:57 [scrapy.core.scraper] ERROR: Error downloading <GET https://vbds.org/upcoming-classes-workshops/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://vbds.org/upcoming-classes-workshops/ took longer than 180.0 seconds..
2025-06-18 17:51:57 [scrapy.core.scraper] ERROR: Error downloading <GET https://vbds.org/introduction-to-ballroom-dancing/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://vbds.org/introduction-to-ballroom-dancing/ took longer than 180.0 seconds..
2025-06-18 17:51:57 [scrapy.core.scraper] ERROR: Error downloading <GET https://vbds.org/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://vbds.org/ took longer than 180.0 seconds..
2025-06-18 17:51:57 [scrapy.core.scraper] ERROR: Error downloading <GET https://vbds.org/members/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://vbds.org/members/ took longer than 180.0 seconds..
2025-06-18 17:51:57 [scrapy.core.scraper] ERROR: Error downloading <GET https://www.eventbrite.com/signin/signup/?referrer=%2Fd%2Fwa--bellingham%2Farts--events--today%2F>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://www.eventbrite.com/signin/signup/?referrer=%2Fd%2Fwa--bellingham%2Farts--events--today%2F took longer than 180.0 seconds..
2025-06-18 17:51:57 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://sipmagazine.com/cider/> (failed 3 times): 429 Unknown Status
2025-06-18 17:51:57 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://sipmagazine.com/recipes/> (failed 3 times): 429 Unknown Status
2025-06-18 17:51:57 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://sipmagazine.com/events/> (failed 3 times): 429 Unknown Status
2025-06-18 17:51:57 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://sipmagazine.com/wine/> (failed 3 times): 429 Unknown Status
2025-06-18 17:51:57 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://sipmagazine.com/spirits/> (failed 3 times): 429 Unknown Status
2025-06-18 17:51:57 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <403 https://tickets.butchartgardens.com/webstore/shop/viewItems.aspx?cg=magicxmas&c=xmasadm>: HTTP status code is not handled or not allowed
2025-06-18 17:51:57 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <429 https://sipmagazine.com/cider/>: HTTP status code is not handled or not allowed
2025-06-18 17:51:57 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <429 https://sipmagazine.com/recipes/>: HTTP status code is not handled or not allowed
2025-06-18 17:51:57 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <429 https://sipmagazine.com/events/>: HTTP status code is not handled or not allowed
2025-06-18 17:51:57 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <429 https://sipmagazine.com/wine/>: HTTP status code is not handled or not allowed
2025-06-18 17:51:57 [scrapy.spidermiddlewares.httperror] INFO: Ignoring response <429 https://sipmagazine.com/spirits/>: HTTP status code is not handled or not allowed
2025-06-18 17:51:57 [root] INFO: write_url_to_db(): appended URL 'http://www.coastaljazz.ca/ticket_information'
2025-06-18 17:51:57 [root] INFO: def parse(): URL http://www.coastaljazz.ca/ticket_information marked as irrelevant (no keywords).
2025-06-18 17:51:57 [root] INFO: def parse(): Found 10 links on https://www.coastaljazz.ca/festival/ticket-info/
2025-06-18 17:51:57 [root] INFO: def fetch_google_calendar_events(): Inputs - calendar_url: https://docs.google.com/forms/d/e/1FAIpQLSdKuDhPOMT5W5gjp6-BAqqQMsXRuwLVuBE_XV4H6g4gP0wCfg/viewform?embedded=true, URL: http://www.coastaljazz.ca/ticket_information, source: 20+ BC summer 2025 music festivals all about good vibes ..., keywords: music festivals
2025-06-18 17:51:57 [root] WARNING: def decode_calendar_id(): Decoded ID is not valid: v, (k?wPtO:z
@FVD]^ ?L~u
2025-06-18 17:51:57 [root] ERROR: def fetch_google_calendar_events(): Failed to extract valid Calendar ID from https://docs.google.com/forms/d/e/1FAIpQLSdKuDhPOMT5W5gjp6-BAqqQMsXRuwLVuBE_XV4H6g4gP0wCfg/viewform?embedded=true
2025-06-18 17:51:57 [root] INFO: write_url_to_db(): appended URL 'https://docs.google.com/forms/d/e/1FAIpQLSdKuDhPOMT5W5gjp6-BAqqQMsXRuwLVuBE_XV4H6g4gP0wCfg/viewform?embedded=true'
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/education/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/artist-submissions/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/festival-guide/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://www.coastaljazz.ca was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:51:57 [root] INFO: should_process_url: URL http://www.coastaljazz.ca/ticket_information was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/ticket-info/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/visitor-info/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/volunteers/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/festival/artist-residency/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/partners/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:51:57 [root] INFO: should_process_url: URL https://www.coastaljazz.ca/partners/corporate-giving/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 17:51:58 [root] INFO: write_url_to_db(): appended URL 'https://shop.blackball.com/collections/collectibles/products/2025-mv-coho-calendar'
2025-06-18 17:51:58 [root] INFO: def parse(): URL https://shop.blackball.com/collections/collectibles/products/2025-mv-coho-calendar marked as irrelevant (no keywords).
2025-06-18 17:51:58 [root] INFO: def parse(): Found 6 links on https://shop.blackball.com/collections/collectibles/products/2025-mv-coho-calendar
2025-06-18 17:51:58 [root] INFO: should_process_url: URL https://shop.blackball.com/collections/collectibles/products/2025-mv-coho-calendar was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:51:58 [root] INFO: should_process_url: URL https://www.shopify.com?utm_campaign=poweredby&utm_medium=shopify&utm_source=onlinestore was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 17:51:58 [root] INFO: should_process_url: URL https://goo.gl/maps/6sfzmTCG2vLCSHb8A was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:51:58 [root] INFO: should_process_url: URL https://goo.gl/maps/JfDSiXsnyoJSJ65s6 was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 17:51:58 [root] INFO: write_url_to_db(): appended URL 'https://mailchimp.com/integrations/?categories=Booking+%26+Scheduling'
2025-06-18 17:51:58 [root] INFO: def parse(): URL https://mailchimp.com/integrations/?categories=Booking+%26+Scheduling marked as irrelevant (no keywords).
2025-06-18 17:51:58 [root] INFO: def parse(): Found 10 links on https://mailchimp.com/integrations/?categories=Booking+%26+Scheduling
2025-06-18 17:51:58 [root] INFO: should_process_url: URL https://www.creditkarma.com/ has never been seen before, processing it.
2025-06-18 17:51:58 [root] INFO: should_process_url: URL https://mailchimp.com/integrations/?categories=Analytics has never been seen before, processing it.
2025-06-18 17:51:58 [root] INFO: should_process_url: URL https://mailchimp.com/developer/ has never been seen before, processing it.
2025-06-18 17:51:58 [root] INFO: should_process_url: URL https://mailchimp.com/integrations/?categories=E-commerce has never been seen before, processing it.
2025-06-18 17:51:58 [root] INFO: should_process_url: URL https://mailchimp.com/ has never been seen before, processing it.
2025-06-18 17:51:58 [root] INFO: should_process_url: URL https://www.intuit.com/ has never been seen before, processing it.
2025-06-18 17:51:58 [root] INFO: should_process_url: URL https://mailchimp.com/integrations/?categories=Loyalty has never been seen before, processing it.
2025-06-18 17:51:58 [root] INFO: should_process_url: URL https://mailchimp.com/integrations/?categories=Booking+%26+Scheduling has never been seen before, processing it.
2025-06-18 17:51:58 [root] INFO: should_process_url: URL https://turbotax.intuit.com/ has never been seen before, processing it.
2025-06-18 17:51:58 [root] INFO: should_process_url: URL https://quickbooks.intuit.com/ has never been seen before, processing it.
2025-06-18 17:51:58 [root] INFO: write_url_to_db(): appended URL 'https://mailchimp.com/integrations/?categories=Analytics'
2025-06-18 17:51:58 [root] INFO: def parse(): URL https://mailchimp.com/integrations/?categories=Analytics marked as irrelevant (no keywords).
2025-06-18 17:51:58 [root] INFO: def parse(): Found 10 links on https://mailchimp.com/integrations/?categories=Analytics
2025-06-18 17:51:58 [root] INFO: should_process_url: URL https://www.creditkarma.com/ has never been seen before, processing it.
2025-06-18 17:51:58 [root] INFO: should_process_url: URL https://mailchimp.com/integrations/?categories=Analytics has never been seen before, processing it.
2025-06-18 17:51:58 [root] INFO: should_process_url: URL https://mailchimp.com/developer/ has never been seen before, processing it.
2025-06-18 17:51:58 [root] INFO: should_process_url: URL https://mailchimp.com/integrations/?categories=E-commerce has never been seen before, processing it.
2025-06-18 17:51:58 [root] INFO: should_process_url: URL https://mailchimp.com/ has never been seen before, processing it.
2025-06-18 17:51:58 [root] INFO: should_process_url: URL https://www.intuit.com/ has never been seen before, processing it.
2025-06-18 17:51:58 [root] INFO: should_process_url: URL https://mailchimp.com/integrations/?categories=Loyalty has never been seen before, processing it.
2025-06-18 17:51:58 [root] INFO: should_process_url: URL https://mailchimp.com/integrations/?categories=Booking+%26+Scheduling has never been seen before, processing it.
2025-06-18 17:51:58 [root] INFO: should_process_url: URL https://turbotax.intuit.com/ has never been seen before, processing it.
2025-06-18 17:51:58 [root] INFO: should_process_url: URL https://quickbooks.intuit.com/ has never been seen before, processing it.
2025-06-18 17:51:59 [root] INFO: write_url_to_db(): appended URL 'https://mailchimp.com/integrations/?categories=Loyalty'
2025-06-18 17:51:59 [root] INFO: def parse(): URL https://mailchimp.com/integrations/?categories=Loyalty marked as irrelevant (no keywords).
2025-06-18 17:51:59 [root] INFO: def parse(): Found 10 links on https://mailchimp.com/integrations/?categories=Loyalty
2025-06-18 17:51:59 [root] INFO: should_process_url: URL https://www.creditkarma.com/ has never been seen before, processing it.
2025-06-18 17:51:59 [root] INFO: should_process_url: URL https://mailchimp.com/integrations/?categories=Analytics has never been seen before, processing it.
2025-06-18 17:51:59 [root] INFO: should_process_url: URL https://mailchimp.com/developer/ has never been seen before, processing it.
2025-06-18 17:51:59 [root] INFO: should_process_url: URL https://mailchimp.com/integrations/?categories=E-commerce has never been seen before, processing it.
2025-06-18 17:51:59 [root] INFO: should_process_url: URL https://mailchimp.com/ has never been seen before, processing it.
2025-06-18 17:51:59 [root] INFO: should_process_url: URL https://www.intuit.com/ has never been seen before, processing it.
2025-06-18 17:51:59 [root] INFO: should_process_url: URL https://mailchimp.com/integrations/?categories=Loyalty has never been seen before, processing it.
2025-06-18 17:51:59 [root] INFO: should_process_url: URL https://mailchimp.com/integrations/?categories=Booking+%26+Scheduling has never been seen before, processing it.
2025-06-18 17:51:59 [root] INFO: should_process_url: URL https://turbotax.intuit.com/ has never been seen before, processing it.
2025-06-18 17:51:59 [root] INFO: should_process_url: URL https://quickbooks.intuit.com/ has never been seen before, processing it.
2025-06-18 17:52:00 [root] INFO: def parse(): Found keywords for URL https://sipmagazine.com/shopping/: ['dance', 'live music', 'rumba']
2025-06-18 17:52:00 [root] INFO: def generate_prompt(): Generating prompt for URL: https://sipmagazine.com/shopping/
2025-06-18 17:52:00 [root] INFO: def generate_prompt(): prompt type: text file path: prompts/default.txt
2025-06-18 17:52:00 [root] INFO: def generate_prompt(): prompts/default.txt
2025-06-18 17:52:00 [root] INFO: query_llm(): Querying Mistral
2025-06-18 17:52:04 [httpx] INFO: HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-06-18 17:52:04 [root] WARNING: query_llm(): Mistral query failed: API rejection occurred: Status 400
{"object":"rejection","message":"Prompt contains 226451 tokens and 0 draft tokens, too large for model with 131072 maximum context length","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 17:52:04 [root] INFO: query_llm(): Falling back to OpenAI
2025-06-18 17:53:30 [httpx] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 17:53:30 [root] INFO: query_llm(): OpenAI response received: [{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Summer Terrace Series",
    "day_of_week": "Monday",
    "start_date": "2025-06-16",
    "end_date": "2025-06-16",
    "start_time": "16:00",
    "end_time": "19:00",
    "price": "$0",
    "location": "Fielding Hills Winery, 565 S Lakeshore DR, Chelan, WA 98816",
    "description": "Every Saturday in July and August from 4 - 7pm, spend a relaxing evening listening to talented local musicians on our terrace. Evenings will include a menu of glass pours."
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Celebrate Walla Walla Summer Supper",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-20",
    "start_time": "17:30",
    "end_time": "20:00",
    "price": "$100",
    "location": "Echolands, 3281 Mill Creek Rd, Walla Walla, WA 99362",
    "description": "Enjoy a BBQ-inspired summer menu, paired with approachable wines, and community vibes at this relaxed vineyard dinner."
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Pizza Pop Up at Dineen Vineyards",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "12:00",
    "end_time": "17:00",
    "price": "",
    "location": "Dineen Vineyards, 2980 Gilbert Road, Zillah, WA 98953",
    "description": "Chef Jacob will be on site making hand-thrown pizzas crafted with the freshest local ingredients on selected weekends."
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Celebrate Walla Walla Block Party",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "14:00",
    "end_time": "17:00",
    "price": "",
    "location": "The Motor Co., 64 E. Rose Street, Walla Walla, WA 99362",
    "description": "Experience the Valley’s energy downtown with tastings from 50+ wineries, local cuisine, live music, and a bottle shop so you can take your favorites home."
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Wines in the Vines Vineyard Tour at Dineen Vineyards",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "14:00",
    "end_time": "16:00",
    "price": "$60.00",
    "location": "Dineen Vineyards, 2980 Gilbert Road, Zillah, WA 98953",
    "description": "Join Dineen Vineyards for a Wines in the Vines experience with guided tasting and a walk through the vineyard."
}]
2025-06-18 17:53:30 [root] INFO: def extract_and_parse_json(): for url https://sipmagazine.com/shopping/, 
Cleaned JSON ready for parsing:
[{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Summer Terrace Series",
    "day_of_week": "Monday",
    "start_date": "2025-06-16",
    "end_date": "2025-06-16",
    "start_time": "16:00",
    "end_time": "19:00",
    "price": "$0",
    "location": "Fielding Hills Winery, 565 S Lakeshore DR, Chelan, WA 98816",
    "description": "Every Saturday in July and August from 4 - 7pm, spend a relaxing evening listening to talented local musicians on our terrace. Evenings will include a menu of glass pours."
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Celebrate Walla Walla Summer Supper",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-20",
    "start_time": "17:30",
    "end_time": "20:00",
    "price": "$100",
    "location": "Echolands, 3281 Mill Creek Rd, Walla Walla, WA 99362",
    "description": "Enjoy a BBQ-inspired summer menu, paired with approachable wines, and community vibes at this relaxed vineyard dinner."
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Pizza Pop Up at Dineen Vineyards",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "12:00",
    "end_time": "17:00",
    "price": "",
    "location": "Dineen Vineyards, 2980 Gilbert Road, Zillah, WA 98953",
    "description": "Chef Jacob will be on site making hand-thrown pizzas crafted with the freshest local ingredients on selected weekends."
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Celebrate Walla Walla Block Party",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "14:00",
    "end_time": "17:00",
    "price": "",
    "location": "The Motor Co., 64 E. Rose Street, Walla Walla, WA 99362",
    "description": "Experience the Valley’s energy downtown with tastings from 50+ wineries, local cuisine, live music, and a bottle shop so you can take your favorites home."
},
{
    "source": "Sip Magazine",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Wines in the Vines Vineyard Tour at Dineen Vineyards",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "14:00",
    "end_time": "16:00",
    "price": "$60.00",
    "location": "Dineen Vineyards, 2980 Gilbert Road, Zillah, WA 98953",
    "description": "Join Dineen Vineyards for a Wines in the Vines experience with guided tasting and a walk through the vineyard."
}]
2025-06-18 17:53:30 [root] INFO: def clean_up_address(): Starting with events_df shape: (5, 14)
2025-06-18 17:53:30 [root] INFO: def clean_up_address(): Processing location 'Fielding Hills Winery, 565 S Lakeshore DR, Chelan, WA 98816' (event_id: None)
2025-06-18 17:53:30 [root] INFO: def clean_up_address(): Processing location 'Echolands, 3281 Mill Creek Rd, Walla Walla, WA 99362' (event_id: None)
2025-06-18 17:53:30 [root] INFO: def clean_up_address(): Processing location 'Dineen Vineyards, 2980 Gilbert Road, Zillah, WA 98953' (event_id: None)
2025-06-18 17:53:30 [root] INFO: def clean_up_address(): Processing location 'The Motor Co., 64 E. Rose Street, Walla Walla, WA 99362' (event_id: None)
2025-06-18 17:53:30 [root] INFO: def clean_up_address(): Processing location 'Dineen Vineyards, 2980 Gilbert Road, Zillah, WA 98953' (event_id: None)
2025-06-18 17:53:30 [root] INFO: write_events_to_db: Number of events to write: 5
2025-06-18 17:53:30 [root] INFO: write_url_to_db(): appended URL 'https://sipmagazine.com/shopping/'
2025-06-18 17:53:30 [root] INFO: write_events_to_db: Events data written to the 'events' table.
2025-06-18 17:53:30 [root] INFO: def process_llm_response: URL https://sipmagazine.com/shopping/ marked as relevant with events written to the database.
2025-06-18 17:53:30 [root] INFO: write_url_to_db(): appended URL 'https://sipmagazine.com/shopping/'
2025-06-18 17:53:30 [root] INFO: def parse(): URL https://sipmagazine.com/shopping/ marked as relevant (LLM positive).
2025-06-18 17:53:30 [root] INFO: def parse(): Found 10 links on https://sipmagazine.com/shopping/
2025-06-18 17:53:30 [root] INFO: should_process_url: URL https://sipmagazine.com/travel/ has never been seen before, processing it.
2025-06-18 17:53:30 [root] INFO: should_process_url: URL https://sipmagazine.com/spirits/ has never been seen before, processing it.
2025-06-18 17:53:30 [root] INFO: should_process_url: URL https://sipmagazine.com/shopping/ has never been seen before, processing it.
2025-06-18 17:53:30 [root] INFO: should_process_url: URL https://sipmagazine.com/events/ has never been seen before, processing it.
2025-06-18 17:53:30 [root] INFO: should_process_url: URL https://sipmagazine.com/cider/ has never been seen before, processing it.
2025-06-18 17:53:30 [root] INFO: should_process_url: URL https://sipmagazine.com/ has never been seen before, processing it.
2025-06-18 17:53:30 [root] INFO: should_process_url: URL https://sipmagazine.com/news/ has never been seen before, processing it.
2025-06-18 17:53:30 [root] INFO: should_process_url: URL https://sipmagazine.com/wine/ has never been seen before, processing it.
2025-06-18 17:53:30 [root] INFO: should_process_url: URL https://sipmagazine.com/beer/ has never been seen before, processing it.
2025-06-18 17:53:30 [root] INFO: should_process_url: URL https://sipmagazine.com/recipes/ has never been seen before, processing it.
2025-06-18 17:53:30 [scrapy.extensions.logstats] INFO: Crawled 464 pages (at 12 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 17:54:10 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET http://westparkmusic.de> (failed 3 times): TCP connection timed out: 110: Connection timed out.
2025-06-18 17:54:10 [scrapy.core.scraper] ERROR: Error downloading <GET http://westparkmusic.de>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
twisted.internet.error.TCPTimedOutError: TCP connection timed out: 110: Connection timed out.
2025-06-18 17:54:21 [scrapy.extensions.logstats] INFO: Crawled 464 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2025-06-18 17:54:56 [scrapy.downloadermiddlewares.retry] ERROR: Gave up retrying <GET https://quickbooks.intuit.com/> (failed 3 times): User timeout caused connection failure: Getting https://quickbooks.intuit.com/ took longer than 180.0 seconds..
2025-06-18 17:54:57 [scrapy.core.scraper] ERROR: Error downloading <GET https://quickbooks.intuit.com/>
Traceback (most recent call last):
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 2013, in _inlineCallbacks
    result = context.run(
             ^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/python/failure.py", line 467, in throwExceptionIntoGenerator
    return g.throw(self.value.with_traceback(self.tb))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/middleware.py", line 68, in process_request
    return (yield download_func(request, spider))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/twisted/internet/defer.py", line 1088, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/miniconda3/envs/sda/lib/python3.11/site-packages/scrapy/core/downloader/handlers/http11.py", line 451, in _cb_timeout
    raise TimeoutError(f"Getting {url} took longer than {timeout} seconds.")
twisted.internet.error.TimeoutError: User timeout caused connection failure: Getting https://quickbooks.intuit.com/ took longer than 180.0 seconds..
2025-06-18 17:54:57 [scrapy.core.engine] INFO: Closing spider (finished)
2025-06-18 17:54:57 [scrapy.extensions.feedexport] INFO: Stored json feed (0 items) in: output/output.json
2025-06-18 17:54:57 [scrapy.statscollectors] INFO: Dumping Scrapy stats:
{'downloader/exception_count': 488,
 'downloader/exception_type_count/builtins.ValueError': 1,
 'downloader/exception_type_count/twisted.internet.error.ConnectError': 2,
 'downloader/exception_type_count/twisted.internet.error.DNSLookupError': 65,
 'downloader/exception_type_count/twisted.internet.error.TCPTimedOutError': 3,
 'downloader/exception_type_count/twisted.internet.error.TimeoutError': 169,
 'downloader/exception_type_count/twisted.web._newclient.ResponseFailed': 7,
 'downloader/exception_type_count/twisted.web._newclient.ResponseNeverReceived': 241,
 'downloader/request_bytes': 404411,
 'downloader/request_count': 1052,
 'downloader/request_method_count/GET': 1052,
 'downloader/response_bytes': 25661317,
 'downloader/response_count': 564,
 'downloader/response_status_count/200': 397,
 'downloader/response_status_count/301': 39,
 'downloader/response_status_count/302': 47,
 'downloader/response_status_count/303': 4,
 'downloader/response_status_count/400': 5,
 'downloader/response_status_count/403': 27,
 'downloader/response_status_count/404': 3,
 'downloader/response_status_count/406': 26,
 'downloader/response_status_count/429': 15,
 'downloader/response_status_count/455': 1,
 'dupefilter/filtered': 133,
 'elapsed_time_seconds': 18815.657864,
 'feedexport/success_count/FileFeedStorage': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2025, 6, 19, 0, 54, 57, 36096, tzinfo=datetime.timezone.utc),
 'httpcompression/response_bytes': 89871328,
 'httpcompression/response_count': 341,
 'httperror/response_ignored_count': 68,
 'httperror/response_ignored_status_count/400': 5,
 'httperror/response_ignored_status_count/403': 27,
 'httperror/response_ignored_status_count/404': 3,
 'httperror/response_ignored_status_count/406': 26,
 'httperror/response_ignored_status_count/429': 6,
 'httperror/response_ignored_status_count/455': 1,
 'items_per_minute': 0.0,
 'log_count/CRITICAL': 1,
 'log_count/ERROR': 408,
 'log_count/INFO': 12523,
 'log_count/WARNING': 287,
 'memusage/max': 463298560,
 'memusage/startup': 233480192,
 'request_depth_max': 2,
 'response_received_count': 464,
 'responses_per_minute': 1.4796704756842944,
 'retry/count': 414,
 'retry/max_reached': 88,
 'retry/reason_count/429 Unknown Status': 9,
 'retry/reason_count/twisted.internet.error.ConnectError': 2,
 'retry/reason_count/twisted.internet.error.DNSLookupError': 64,
 'retry/reason_count/twisted.internet.error.TCPTimedOutError': 2,
 'retry/reason_count/twisted.internet.error.TimeoutError': 132,
 'retry/reason_count/twisted.web._newclient.ResponseFailed': 7,
 'retry/reason_count/twisted.web._newclient.ResponseNeverReceived': 198,
 'scheduler/dequeued': 1052,
 'scheduler/dequeued/memory': 1052,
 'scheduler/enqueued': 1052,
 'scheduler/enqueued/memory': 1052,
 'spider_exceptions/ProgrammingError': 1,
 'spider_exceptions/count': 1,
 'start_time': datetime.datetime(2025, 6, 18, 19, 41, 21, 378232, tzinfo=datetime.timezone.utc)}
2025-06-18 17:54:57 [scrapy.core.engine] INFO: Spider closed (finished)
2025-06-18 17:54:57 [root] INFO: def run_crawler(): Crawler completed successfully.
2025-06-18 17:54:57 [root] INFO: __main__: Crawler process completed.
2025-06-18 17:54:57 [root] INFO: def count_events_urls_end(): Wrote events and urls statistics to: scraper.py
2025-06-18 17:54:57 [root] INFO: __main__: Finished the crawler process at 2025-06-18 17:54:57.218317
2025-06-18 17:54:57 [root] INFO: __main__: Total time taken: 5:13:36.783184


