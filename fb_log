2025-06-18 12:11:12 - INFO - 

fb.py starting...
2025-06-18 12:11:12 - INFO - Loaded 54 blacklisted domains.
2025-06-18 12:11:12 - INFO - def __init__(): Running locally.
2025-06-18 12:11:12 - INFO - def __init__(): Database connection established for social_dance_db.
2025-06-18 12:11:12 - INFO - def __init__(): Database connection established for address_db.
2025-06-18 12:11:12 - INFO - create_urls_df: Successfully created DataFrame from 'urls' table.
2025-06-18 12:11:12 - INFO - create_urls_df: 'urls' table contains 7341 rows.
2025-06-18 12:11:12 - INFO - __init__(): URLs DataFrame created with 7341 rows.
2025-06-18 12:11:12 - INFO - __init__(): urls_gb has 4334 rows and 3 columns.
2025-06-18 12:11:12 - INFO - Loaded 54 blacklisted domains.
2025-06-18 12:11:12 - INFO - def __init__(): Running locally.
2025-06-18 12:11:12 - INFO - def __init__(): Database connection established for social_dance_db.
2025-06-18 12:11:12 - INFO - def __init__(): Database connection established for address_db.
2025-06-18 12:11:13 - INFO - create_urls_df: Successfully created DataFrame from 'urls' table.
2025-06-18 12:11:13 - INFO - create_urls_df: 'urls' table contains 7341 rows.
2025-06-18 12:11:13 - INFO - __init__(): URLs DataFrame created with 7341 rows.
2025-06-18 12:11:13 - INFO - __init__(): urls_gb has 4334 rows and 3 columns.
2025-06-18 12:11:13 - INFO - Loaded 54 blacklisted domains.
2025-06-18 12:11:13 - INFO - def __init__(): Running locally.
2025-06-18 12:11:13 - INFO - def __init__(): Database connection established for social_dance_db.
2025-06-18 12:11:13 - INFO - def __init__(): Database connection established for address_db.
2025-06-18 12:11:13 - INFO - create_urls_df: Successfully created DataFrame from 'urls' table.
2025-06-18 12:11:13 - INFO - create_urls_df: 'urls' table contains 7341 rows.
2025-06-18 12:11:13 - INFO - __init__(): URLs DataFrame created with 7341 rows.
2025-06-18 12:11:14 - INFO - __init__(): urls_gb has 4334 rows and 3 columns.
2025-06-18 12:11:29 - WARNING - login_to_facebook: login page load timed out; proceeding.
2025-06-18 12:11:29 - INFO - login_to_facebook: already authenticated.
2025-06-18 12:11:29 - INFO - Facebook login successful.
2025-06-18 12:11:31 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q=dance&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:11:31 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q=dance&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:11:37 - INFO - extract_event_links(): Found 16 links on https://www.facebook.com/search/events?q=dance&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:11:37 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q=dance&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 16 event_links

2025-06-18 12:11:37 - INFO - should_process_url: URL https://www.facebook.com/events/1187402793186660/ was last seen as relevant, processing it.
2025-06-18 12:11:40 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1187402793186660/ (14256 ms)
2025-06-18 12:11:59 - INFO - extract_event_text: extracted 5029 chars
2025-06-18 12:11:59 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1187402793186660/.
2025-06-18 12:11:59 - INFO - def scrape_events(): Keywords: ['dance']: found in text for URL: https://www.facebook.com/events/1187402793186660/.
2025-06-18 12:11:59 - INFO - should_process_url: URL https://www.facebook.com/events/624858640069610/ was last seen as relevant, processing it.
2025-06-18 12:12:01 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/624858640069610/ (11439 ms)
2025-06-18 12:12:20 - INFO - extract_event_text: extracted 3349 chars
2025-06-18 12:12:20 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/624858640069610/.
2025-06-18 12:12:20 - WARNING - def extract_relevant_text(): 'Guests See All' not found after last day of the week in https://www.facebook.com/events/624858640069610/.
2025-06-18 12:12:20 - INFO - def scrape_events(): Keywords: ['bachata', 'cha cha', 'dance', 'kizomba', 'merengue', 'salsa', 'swing', 'tango', 'west coast swing']: found in text for URL: https://www.facebook.com/events/624858640069610/.
2025-06-18 12:12:20 - INFO - should_process_url: URL https://www.facebook.com/events/514087011782400/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:12:23 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/514087011782400/ (12266 ms)
2025-06-18 12:15:08 - INFO - 

fb.py starting...
2025-06-18 12:15:08 - INFO - Loaded 54 blacklisted domains.
2025-06-18 12:15:08 - INFO - def __init__(): Running locally.
2025-06-18 12:15:08 - INFO - def __init__(): Database connection established for social_dance_db.
2025-06-18 12:15:08 - INFO - def __init__(): Database connection established for address_db.
2025-06-18 12:15:08 - INFO - create_urls_df: Successfully created DataFrame from 'urls' table.
2025-06-18 12:15:08 - INFO - create_urls_df: 'urls' table contains 7343 rows.
2025-06-18 12:15:08 - INFO - __init__(): URLs DataFrame created with 7343 rows.
2025-06-18 12:15:08 - INFO - __init__(): urls_gb has 4334 rows and 3 columns.
2025-06-18 12:15:08 - INFO - Loaded 54 blacklisted domains.
2025-06-18 12:15:08 - INFO - def __init__(): Running locally.
2025-06-18 12:15:08 - INFO - def __init__(): Database connection established for social_dance_db.
2025-06-18 12:15:08 - INFO - def __init__(): Database connection established for address_db.
2025-06-18 12:15:09 - INFO - create_urls_df: Successfully created DataFrame from 'urls' table.
2025-06-18 12:15:09 - INFO - create_urls_df: 'urls' table contains 7343 rows.
2025-06-18 12:15:09 - INFO - __init__(): URLs DataFrame created with 7343 rows.
2025-06-18 12:15:09 - INFO - __init__(): urls_gb has 4334 rows and 3 columns.
2025-06-18 12:15:09 - INFO - Loaded 54 blacklisted domains.
2025-06-18 12:15:09 - INFO - def __init__(): Running locally.
2025-06-18 12:15:09 - INFO - def __init__(): Database connection established for social_dance_db.
2025-06-18 12:15:09 - INFO - def __init__(): Database connection established for address_db.
2025-06-18 12:15:09 - INFO - create_urls_df: Successfully created DataFrame from 'urls' table.
2025-06-18 12:15:09 - INFO - create_urls_df: 'urls' table contains 7344 rows.
2025-06-18 12:15:09 - INFO - __init__(): URLs DataFrame created with 7344 rows.
2025-06-18 12:15:10 - INFO - __init__(): urls_gb has 4334 rows and 3 columns.
2025-06-18 12:15:31 - WARNING - login_to_facebook: login page load timed out; proceeding.
2025-06-18 12:15:31 - INFO - login_to_facebook: already authenticated.
2025-06-18 12:15:31 - INFO - Facebook login successful.
2025-06-18 12:15:33 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q=dance&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:15:33 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q=dance&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:15:40 - INFO - extract_event_links(): Found 16 links on https://www.facebook.com/search/events?q=dance&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:15:40 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q=dance&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 16 event_links

2025-06-18 12:15:40 - INFO - should_process_url: URL https://www.facebook.com/events/3854957174726232/ was last seen as relevant, processing it.
2025-06-18 12:15:43 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/3854957174726232/ (12684 ms)
2025-06-18 12:16:04 - INFO - extract_event_text: extracted 3643 chars
2025-06-18 12:16:04 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/3854957174726232/.
2025-06-18 12:16:04 - INFO - def scrape_events(): Keywords: ['dance', 'kizomba', 'urban kiz']: found in text for URL: https://www.facebook.com/events/3854957174726232/.
2025-06-18 12:16:04 - INFO - should_process_url: URL https://www.facebook.com/events/1187402793186660/ was last seen as relevant, processing it.
2025-06-18 12:16:07 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1187402793186660/ (13381 ms)
2025-06-18 12:16:25 - INFO - extract_event_text: extracted 5029 chars
2025-06-18 12:16:25 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1187402793186660/.
2025-06-18 12:16:25 - INFO - def scrape_events(): Keywords: ['dance']: found in text for URL: https://www.facebook.com/events/1187402793186660/.
2025-06-18 12:16:25 - INFO - should_process_url: URL https://www.facebook.com/events/909522138040202/ was last seen as relevant, processing it.
2025-06-18 12:16:29 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/909522138040202/ (10687 ms)
2025-06-18 12:16:47 - INFO - extract_event_text: extracted 3351 chars
2025-06-18 12:16:47 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/909522138040202/.
2025-06-18 12:16:47 - WARNING - def extract_relevant_text(): 'Guests See All' not found after last day of the week in https://www.facebook.com/events/909522138040202/.
2025-06-18 12:16:47 - INFO - def scrape_events(): Keywords: ['bachata', 'cha cha', 'dance', 'kizomba', 'merengue', 'salsa', 'swing', 'tango', 'west coast swing']: found in text for URL: https://www.facebook.com/events/909522138040202/.
2025-06-18 12:16:47 - INFO - should_process_url: URL https://www.facebook.com/events/589043697010919/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:16:50 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/589043697010919/ (12372 ms)
2025-06-18 12:17:07 - INFO - extract_event_text: extracted 6781 chars
2025-06-18 12:17:07 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/589043697010919/.
2025-06-18 12:17:07 - INFO - def scrape_events(): Keywords: ['dance']: found in text for URL: https://www.facebook.com/events/589043697010919/.
2025-06-18 12:17:07 - INFO - should_process_url: URL https://www.facebook.com/events/556816543734629/ was last seen as relevant, processing it.
2025-06-18 12:17:10 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/556816543734629/ (13266 ms)
2025-06-18 12:17:29 - INFO - extract_event_text: extracted 3613 chars
2025-06-18 12:17:29 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/556816543734629/.
2025-06-18 12:17:29 - INFO - def scrape_events(): Keywords: ['dance', 'merengue']: found in text for URL: https://www.facebook.com/events/556816543734629/.
2025-06-18 12:17:29 - INFO - should_process_url: URL https://www.facebook.com/events/939376108286434/ was last seen as relevant, processing it.
2025-06-18 12:17:31 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/939376108286434/ (11664 ms)
2025-06-18 12:17:50 - INFO - extract_event_text: extracted 3448 chars
2025-06-18 12:17:50 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/939376108286434/.
2025-06-18 12:17:50 - WARNING - def extract_relevant_text(): 'Guests See All' not found after last day of the week in https://www.facebook.com/events/939376108286434/.
2025-06-18 12:17:50 - INFO - def scrape_events(): Keywords: ['bachata', 'cha cha', 'dance', 'kizomba', 'merengue', 'salsa', 'swing', 'tango', 'west coast swing']: found in text for URL: https://www.facebook.com/events/939376108286434/.
2025-06-18 12:17:50 - INFO - should_process_url: URL https://www.facebook.com/events/624858640069610/ was last seen as relevant, processing it.
2025-06-18 12:17:54 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/624858640069610/ (14489 ms)
2025-06-18 12:18:13 - INFO - extract_event_text: extracted 3349 chars
2025-06-18 12:18:13 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/624858640069610/.
2025-06-18 12:18:13 - WARNING - def extract_relevant_text(): 'Guests See All' not found after last day of the week in https://www.facebook.com/events/624858640069610/.
2025-06-18 12:18:13 - INFO - def scrape_events(): Keywords: ['bachata', 'cha cha', 'dance', 'kizomba', 'merengue', 'salsa', 'swing', 'tango', 'west coast swing']: found in text for URL: https://www.facebook.com/events/624858640069610/.
2025-06-18 12:18:13 - INFO - should_process_url: URL https://www.facebook.com/events/691138080073761/ was last seen as relevant, processing it.
2025-06-18 12:18:16 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/691138080073761/ (10996 ms)
2025-06-18 12:18:36 - INFO - extract_event_text: extracted 3468 chars
2025-06-18 12:18:36 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/691138080073761/.
2025-06-18 12:18:36 - INFO - def scrape_events(): Keywords: ['dance', 'kizomba']: found in text for URL: https://www.facebook.com/events/691138080073761/.
2025-06-18 12:18:36 - INFO - should_process_url: URL https://www.facebook.com/events/514087011782400/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:18:39 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/514087011782400/ (13522 ms)
2025-06-18 12:18:57 - INFO - extract_event_text: extracted 2931 chars
2025-06-18 12:18:57 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/514087011782400/.
2025-06-18 12:18:57 - INFO - def scrape_events(): Keywords: ['dance']: found in text for URL: https://www.facebook.com/events/514087011782400/.
2025-06-18 12:18:57 - INFO - should_process_url: URL https://www.facebook.com/events/1618420955545842/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:19:00 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1618420955545842/ (14530 ms)
2025-06-18 12:19:19 - INFO - extract_event_text: extracted 3239 chars
2025-06-18 12:19:19 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1618420955545842/.
2025-06-18 12:19:19 - WARNING - def extract_relevant_text(): 'Guests See All' not found after last day of the week in https://www.facebook.com/events/1618420955545842/.
2025-06-18 12:19:19 - INFO - def scrape_events(): Keywords: ['bachata', 'cha cha', 'dance', 'kizomba', 'merengue', 'salsa', 'swing', 'tango', 'west coast swing']: found in text for URL: https://www.facebook.com/events/1618420955545842/.
2025-06-18 12:19:19 - INFO - should_process_url: URL https://www.facebook.com/events/1031573525615192/ was last seen as relevant, processing it.
2025-06-18 12:19:22 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1031573525615192/ (13287 ms)
2025-06-18 12:19:48 - INFO - extract_event_text: extracted 3931 chars
2025-06-18 12:19:48 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1031573525615192/.
2025-06-18 12:19:48 - INFO - def scrape_events(): Keywords: ['dance']: found in text for URL: https://www.facebook.com/events/1031573525615192/.
2025-06-18 12:19:48 - INFO - should_process_url: URL https://www.facebook.com/events/1363696181561219/ was last seen as relevant, processing it.
2025-06-18 12:19:51 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1363696181561219/ (14447 ms)
2025-06-18 12:20:10 - INFO - extract_event_text: extracted 5864 chars
2025-06-18 12:20:10 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1363696181561219/.
2025-06-18 12:20:10 - INFO - def scrape_events(): Keywords: ['dance']: found in text for URL: https://www.facebook.com/events/1363696181561219/.
2025-06-18 12:20:10 - INFO - should_process_url: URL https://www.facebook.com/events/663135653237580/ was last seen as relevant, processing it.
2025-06-18 12:20:13 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/663135653237580/ (10646 ms)
2025-06-18 12:20:32 - INFO - extract_event_text: extracted 4188 chars
2025-06-18 12:20:32 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/663135653237580/.
2025-06-18 12:20:32 - INFO - def scrape_events(): Keywords: ['dance', 'line dance', 'swing', 'west coast swing']: found in text for URL: https://www.facebook.com/events/663135653237580/.
2025-06-18 12:20:32 - INFO - should_process_url: URL https://www.facebook.com/events/1904863453602318/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:20:36 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1904863453602318/ (12199 ms)
2025-06-18 12:20:49 - INFO - extract_event_text: extracted 2654 chars
2025-06-18 12:20:49 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1904863453602318/.
2025-06-18 12:20:49 - INFO - def scrape_events(): Keywords: ['dance']: found in text for URL: https://www.facebook.com/events/1904863453602318/.
2025-06-18 12:20:49 - INFO - should_process_url: URL https://www.facebook.com/events/1185783966345055/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:20:52 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1185783966345055/ (14454 ms)
2025-06-18 12:21:12 - INFO - extract_event_text: extracted 2984 chars
2025-06-18 12:21:12 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1185783966345055/.
2025-06-18 12:21:12 - INFO - def scrape_events(): Keywords: ['dance']: found in text for URL: https://www.facebook.com/events/1185783966345055/.
2025-06-18 12:21:12 - INFO - should_process_url: URL https://www.facebook.com/events/1682353965754886/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:21:15 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1682353965754886/ (12648 ms)
2025-06-18 12:21:28 - ERROR - extract_event_text: timeout on https://www.facebook.com/events/1682353965754886/
2025-06-18 12:21:28 - INFO - def scrape_events(): No text extracted for URL: https://www.facebook.com/events/1682353965754886/.
2025-06-18 12:21:31 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q= foxtrot&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:21:31 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q= foxtrot&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:21:36 - INFO - extract_event_links(): Found 0 links on https://www.facebook.com/search/events?q= foxtrot&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:21:36 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q= foxtrot&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 0 event_links

2025-06-18 12:21:39 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q= quickstep&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:21:39 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q= quickstep&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:21:46 - INFO - extract_event_links(): Found 0 links on https://www.facebook.com/search/events?q= quickstep&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:21:46 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q= quickstep&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 0 event_links

2025-06-18 12:21:48 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q= rumba&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:21:48 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q= rumba&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:21:54 - INFO - extract_event_links(): Found 3 links on https://www.facebook.com/search/events?q= rumba&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:21:54 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q= rumba&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 3 event_links

2025-06-18 12:21:54 - INFO - should_process_url: URL https://www.facebook.com/events/1910904133047825/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:21:57 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1910904133047825/ (11790 ms)
2025-06-18 12:22:16 - INFO - extract_event_text: extracted 4236 chars
2025-06-18 12:22:16 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1910904133047825/.
2025-06-18 12:22:16 - INFO - def scrape_events(): Keywords: ['dance', 'live music', 'merengue', 'rumba', 'salsa']: found in text for URL: https://www.facebook.com/events/1910904133047825/.
2025-06-18 12:22:16 - INFO - should_process_url: URL https://www.facebook.com/events/650657144184821/ was last seen as relevant, processing it.
2025-06-18 12:22:20 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/650657144184821/ (11496 ms)
2025-06-18 12:22:43 - INFO - extract_event_text: extracted 4604 chars
2025-06-18 12:22:43 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/650657144184821/.
2025-06-18 12:22:43 - INFO - def scrape_events(): Keywords: ['dance', 'live music', 'rumba']: found in text for URL: https://www.facebook.com/events/650657144184821/.
2025-06-18 12:22:43 - INFO - should_process_url: URL https://www.facebook.com/events/667083456006099/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:22:46 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/667083456006099/ (10424 ms)
2025-06-18 12:23:02 - INFO - extract_event_text: extracted 4385 chars
2025-06-18 12:23:02 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/667083456006099/.
2025-06-18 12:23:02 - INFO - def scrape_events(): Keywords: ['dance', 'merengue', 'rumba', 'salsa']: found in text for URL: https://www.facebook.com/events/667083456006099/.
2025-06-18 12:23:05 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q= samba&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:23:05 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q= samba&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:23:10 - INFO - extract_event_links(): Found 1 links on https://www.facebook.com/search/events?q= samba&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:23:10 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q= samba&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 1 event_links

2025-06-18 12:23:10 - INFO - should_process_url: URL https://www.facebook.com/events/1132427048350776/ was last seen as not relevant but hit_ratio (0.50) > 0.1 or crawl_try (3) ≤ 3, processing it.
2025-06-18 12:23:14 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1132427048350776/ (13541 ms)
2025-06-18 12:23:34 - INFO - extract_event_text: extracted 3791 chars
2025-06-18 12:23:34 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1132427048350776/.
2025-06-18 12:23:34 - INFO - def scrape_events(): Keywords: ['samba', 'swing']: found in text for URL: https://www.facebook.com/events/1132427048350776/.
2025-06-18 12:23:36 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q= waltz&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:23:36 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q= waltz&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:23:41 - INFO - extract_event_links(): Found 0 links on https://www.facebook.com/search/events?q= waltz&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:23:41 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q= waltz&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 0 event_links

2025-06-18 12:23:41 - INFO - def scrape_events(): Extracted text from 19 events.
2025-06-18 12:23:41 - INFO - def scrape_events(): Extracted text data written to checkpoint/extracted_text.xlsx.
2025-06-18 12:23:41 - INFO - def driver_fb_search(): Extracted text based on search_url: https://www.facebook.com/search/events?q= waltz&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9.
2025-06-18 12:23:41 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/3854957174726232/
2025-06-18 12:23:41 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/3854957174726232/.
2025-06-18 12:23:41 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/3854957174726232/
2025-06-18 12:23:41 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:23:42 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:23:42 - INFO - query_llm(): Querying Mistral
2025-06-18 12:23:46 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:23:46 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "Victoria Latin Dance Association",
    "dance_style": "urban kiz",
    "url": "",
    "event_type": "class",
    "event_name": "Free Outdoor Intro Dance Class + Social | Summer Series",
    "day_of_week": "Monday",
    "start_date": "2025-06-30",
    "end_date": "2025-06-30",
    "start_time": "17:30",
    "end_time": "19:30",
    "price": "Free",
    "location": "Ship's Point Inner Harbour, Big Blue Sailing, Victoria, BC V8W, Canada",
    "description": "Join us for an introduction to Urban Kizomba with Aaron and Fernanda— part of our summer series, proudly sponsored by the City of Victoria! Every Monday | June–August 5:30–7:30 PM. 1.5-hour dance class followed by a 30-minute outdoor social. Dance style rotates monthly — check our content calendar on our website for full details! This free outdoor event is open to everyone — no partner or dance experience needed. All ages, bodies, and abilities are warmly welcomed! Whether you’re dancing the night away or soaking in the summer vibes, come be part of this vibrant community celebration. Don’t forget to bring a water bottle and come ready to move!"
}]
```
2025-06-18 12:23:46 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/3854957174726232/, 
Cleaned JSON ready for parsing:
[{
    "source": "Victoria Latin Dance Association",
    "dance_style": "urban kiz",
    "url": "",
    "event_type": "class",
    "event_name": "Free Outdoor Intro Dance Class + Social | Summer Series",
    "day_of_week": "Monday",
    "start_date": "2025-06-30",
    "end_date": "2025-06-30",
    "start_time": "17:30",
    "end_time": "19:30",
    "price": "Free",
    "location": "Ship's Point Inner Harbour, Big Blue Sailing, Victoria, BC V8W, Canada",
    "description": "Join us for an introduction to Urban Kizomba with Aaron and Fernanda— part of our summer series, proudly sponsored by the City of Victoria! Every Monday | June–August 5:30–7:30 PM. 1.5-hour dance class followed by a 30-minute outdoor social. Dance style rotates monthly — check our content calendar on our website for full details! This free outdoor event is open to everyone — no partner or dance experience needed. All ages, bodies, and abilities are warmly welcomed! Whether you’re dancing the night away or soaking in the summer vibes, come be part of this vibrant community celebration. Don’t forget to bring a water bottle and come ready to move!"
}]
2025-06-18 12:23:46 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:23:46 - INFO - def clean_up_address(): Processing location 'Ship's Point Inner Harbour, Big Blue Sailing, Victoria, BC V8W, Canada' (event_id: None)
2025-06-18 12:23:46 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:23:46 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/3854957174726232/'
2025-06-18 12:23:46 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:23:46 - INFO - def process_llm_response: URL https://www.facebook.com/events/3854957174726232/ marked as relevant with events written to the database.
2025-06-18 12:23:46 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/3854957174726232/.
2025-06-18 12:23:46 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1187402793186660/
2025-06-18 12:23:46 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1187402793186660/.
2025-06-18 12:23:46 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1187402793186660/
2025-06-18 12:23:46 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:23:46 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:23:46 - INFO - query_llm(): Querying Mistral
2025-06-18 12:24:02 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:24:02 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "",
    "url": "https://globalunderscore.com/",
    "event_type": "other",
    "event_name": "Global Underscore Solstice Dance",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "08:00",
    "end_time": "12:00",
    "price": "$15-$20",
    "location": "Victoria Truth Centre, 2815 Cedar Hill Rd, Victoria, BC V8T 3H6, Canada",
    "description": "This summer solstice event invites participants to deepen their practice of Contact Improvisation with The Global Underscore. The event includes a talk-through, the Underscore practice, and a closing circle. Cost is $15-$20 with options for those with financial barriers. Pre-registration is required."
}]
```
2025-06-18 12:24:02 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1187402793186660/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "",
    "url": "https://globalunderscore.com/",
    "event_type": "other",
    "event_name": "Global Underscore Solstice Dance",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "08:00",
    "end_time": "12:00",
    "price": "$15-$20",
    "location": "Victoria Truth Centre, 2815 Cedar Hill Rd, Victoria, BC V8T 3H6, Canada",
    "description": "This summer solstice event invites participants to deepen their practice of Contact Improvisation with The Global Underscore. The event includes a talk-through, the Underscore practice, and a closing circle. Cost is $15-$20 with options for those with financial barriers. Pre-registration is required."
}]
2025-06-18 12:24:02 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:24:02 - INFO - def clean_up_address(): Processing location 'Victoria Truth Centre, 2815 Cedar Hill Rd, Victoria, BC V8T 3H6, Canada' (event_id: None)
2025-06-18 12:24:02 - INFO - def clean_up_address(): Updated event None with address_id 12110 using DB match
2025-06-18 12:24:02 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:24:02 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1187402793186660/'
2025-06-18 12:24:02 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:24:02 - INFO - def process_llm_response: URL https://www.facebook.com/events/1187402793186660/ marked as relevant with events written to the database.
2025-06-18 12:24:02 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1187402793186660/.
2025-06-18 12:24:02 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/909522138040202/
2025-06-18 12:24:02 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/909522138040202/.
2025-06-18 12:24:02 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/909522138040202/
2025-06-18 12:24:02 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:24:02 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:24:02 - INFO - query_llm(): Querying Mistral
2025-06-18 12:24:05 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:24:05 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "Facebook",
    "dance_style": "salsa, bachata, merengue, cha cha cha, bolero, latin hustle",
    "url": "",
    "event_type": "social dance",
    "event_name": "Salsa Night @ Dance City",
    "day_of_week": "Friday",
    "start_date": "2025-11-28",
    "end_date": "2025-11-28",
    "start_time": "19:45",
    "end_time": "00:00",
    "price": "$15.00 per person + service fee on Eventbrite or cash only at the door. $13 cash for Edelweiss Club members at the door only.",
    "location": "Edelweiss Club, 117 St Lawrence St, Victoria, BC V8V 1X7, Canada",
    "description": "Dancing the 4th Friday of every month at an all ages venue right in the heart of downtown, with a wood dance floor. 7:45pm Doors open. 8:00pm Salsa lesson. 9:00pm- midnight Dancing to Salsa, Bachata, Merengue, Cha Cha Cha, Bolero & Latin Hustle. All ages welcome. *Limited capacity. First come first served. We reserve the right to refuse entrance at the door."
}]
```
2025-06-18 12:24:05 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/909522138040202/, 
Cleaned JSON ready for parsing:
[{
    "source": "Facebook",
    "dance_style": "salsa, bachata, merengue, cha cha cha, bolero, latin hustle",
    "url": "",
    "event_type": "social dance",
    "event_name": "Salsa Night @ Dance City",
    "day_of_week": "Friday",
    "start_date": "2025-11-28",
    "end_date": "2025-11-28",
    "start_time": "19:45",
    "end_time": "00:00",
    "price": "$15.00 per person + service fee on Eventbrite or cash only at the door. $13 cash for Edelweiss Club members at the door only.",
    "location": "Edelweiss Club, 117 St Lawrence St, Victoria, BC V8V 1X7, Canada",
    "description": "Dancing the 4th Friday of every month at an all ages venue right in the heart of downtown, with a wood dance floor. 7:45pm Doors open. 8:00pm Salsa lesson. 9:00pm- midnight Dancing to Salsa, Bachata, Merengue, Cha Cha Cha, Bolero & Latin Hustle. All ages welcome. *Limited capacity. First come first served. We reserve the right to refuse entrance at the door."
}]
2025-06-18 12:24:05 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:24:05 - INFO - def clean_up_address(): Processing location 'Edelweiss Club, 117 St Lawrence St, Victoria, BC V8V 1X7, Canada' (event_id: None)
2025-06-18 12:24:05 - INFO - get_address_id: Inserted or updated address_id 3447 for address '117 St. Lawrence ST, VICTORIA, BC, V8V1X7, CA'.
2025-06-18 12:24:05 - INFO - Populated from DB for postal code 'V8V1X7': '117 St. Lawrence ST, VICTORIA, BC, V8V1X7, CA'
2025-06-18 12:24:05 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:24:05 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/909522138040202/'
2025-06-18 12:24:05 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:24:05 - INFO - def process_llm_response: URL https://www.facebook.com/events/909522138040202/ marked as relevant with events written to the database.
2025-06-18 12:24:05 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/909522138040202/.
2025-06-18 12:24:05 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/589043697010919/
2025-06-18 12:24:05 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/589043697010919/.
2025-06-18 12:24:05 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/589043697010919/
2025-06-18 12:24:05 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:24:05 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:24:05 - INFO - query_llm(): Querying Mistral
2025-06-18 12:24:06 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-06-18 12:24:06 - WARNING - query_llm(): Mistral query failed: API rejection occurred: Status 429
{"object":"rejection","message":"Service tier capacity exceeded for this model.","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 12:24:06 - INFO - query_llm(): Falling back to OpenAI
2025-06-18 12:24:18 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:24:18 - INFO - query_llm(): OpenAI response received: [{
    "source": "Facebook",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "Dance Temple w/ Cedar",
    "day_of_week": "Sunday",
    "start_date": "2025-05-25",
    "end_date": "2025-05-25",
    "start_time": "11:00",
    "end_time": "12:30",
    "price": "Sliding scale: $20-$40; $15-$20 low income; free for kids under 12",
    "location": "Edelweiss Club, 108 Niagara Street, Victoria, BC V8V 1E9, Canada",
    "description": "Weekly Sunday ecstatic/conscious dance at Edelweiss Club with facilitator/DJ Cedar Mathias. Doors open 10:45; dance 11:00-12:30. Sliding scale $20-$40 ($15-$20 low income; free for kids under 12). Scent-free, no cell phones, shirts on."
}]
2025-06-18 12:24:18 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/589043697010919/, 
Cleaned JSON ready for parsing:
[{
    "source": "Facebook",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "Dance Temple w/ Cedar",
    "day_of_week": "Sunday",
    "start_date": "2025-05-25",
    "end_date": "2025-05-25",
    "start_time": "11:00",
    "end_time": "12:30",
    "price": "Sliding scale: $20-$40; $15-$20 low income; free for kids under 12",
    "location": "Edelweiss Club, 108 Niagara Street, Victoria, BC V8V 1E9, Canada",
    "description": "Weekly Sunday ecstatic/conscious dance at Edelweiss Club with facilitator/DJ Cedar Mathias. Doors open 10:45; dance 11:00-12:30. Sliding scale $20-$40 ($15-$20 low income; free for kids under 12). Scent-free, no cell phones, shirts on."
}]
2025-06-18 12:24:18 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:24:18 - INFO - def clean_up_address(): Processing location 'Edelweiss Club, 108 Niagara Street, Victoria, BC V8V 1E9, Canada' (event_id: None)
2025-06-18 12:24:18 - INFO - def clean_up_address(): Updated event None with address_id 5 using DB match
2025-06-18 12:24:18 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:24:18 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/589043697010919/'
2025-06-18 12:24:18 - INFO - def process_llm_response: URL https://www.facebook.com/events/589043697010919/ marked as relevant with events written to the database.
2025-06-18 12:24:18 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/589043697010919/.
2025-06-18 12:24:18 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/556816543734629/
2025-06-18 12:24:18 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/556816543734629/.
2025-06-18 12:24:18 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/556816543734629/
2025-06-18 12:24:18 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:24:18 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:24:18 - INFO - query_llm(): Querying Mistral
2025-06-18 12:24:23 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:24:23 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "merengue",
        "url": "",
        "event_type": "class",
        "event_name": "Free Outdoor Intro Dance Class + Social | Summer Series",
        "day_of_week": "Monday",
        "start_date": "2025-07-07",
        "end_date": "2025-07-07",
        "start_time": "17:30",
        "end_time": "19:30",
        "price": "Free",
        "location": "Ship's Point Inner Harbour, Big Blue Sailing, Victoria, BC V8W, Canada",
        "description": "Join us for an introduction to Merengue with Sebastian and Hannah— part of our summer series, proudly sponsored by the City of Victoria! Every Monday | June–August 5:30–7:30 PM. 1.5-hour dance class followed by a 30-minute outdoor social. Dance style rotates monthly — check our content calendar on our website for full details! This free outdoor event is open to everyone — no partner or dance experience needed. All ages, bodies, and abilities are warmly welcomed! Whether you’re dancing the night away or soaking in the summer vibes, come be part of this vibrant community celebration. Don’t forget to bring a water bottle and come ready to move!"
    }
]
```
2025-06-18 12:24:23 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/556816543734629/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "merengue",
        "url": "",
        "event_type": "class",
        "event_name": "Free Outdoor Intro Dance Class + Social | Summer Series",
        "day_of_week": "Monday",
        "start_date": "2025-07-07",
        "end_date": "2025-07-07",
        "start_time": "17:30",
        "end_time": "19:30",
        "price": "Free",
        "location": "Ship's Point Inner Harbour, Big Blue Sailing, Victoria, BC V8W, Canada",
        "description": "Join us for an introduction to Merengue with Sebastian and Hannah— part of our summer series, proudly sponsored by the City of Victoria! Every Monday | June–August 5:30–7:30 PM. 1.5-hour dance class followed by a 30-minute outdoor social. Dance style rotates monthly — check our content calendar on our website for full details! This free outdoor event is open to everyone — no partner or dance experience needed. All ages, bodies, and abilities are warmly welcomed! Whether you’re dancing the night away or soaking in the summer vibes, come be part of this vibrant community celebration. Don’t forget to bring a water bottle and come ready to move!"
    }
]
2025-06-18 12:24:23 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:24:23 - INFO - def clean_up_address(): Processing location 'Ship's Point Inner Harbour, Big Blue Sailing, Victoria, BC V8W, Canada' (event_id: None)
2025-06-18 12:24:23 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:24:23 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/556816543734629/'
2025-06-18 12:24:23 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:24:23 - INFO - def process_llm_response: URL https://www.facebook.com/events/556816543734629/ marked as relevant with events written to the database.
2025-06-18 12:24:23 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/556816543734629/.
2025-06-18 12:24:23 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/939376108286434/
2025-06-18 12:24:23 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/939376108286434/.
2025-06-18 12:24:23 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/939376108286434/
2025-06-18 12:24:23 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:24:23 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:24:23 - INFO - query_llm(): Querying Mistral
2025-06-18 12:24:28 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:24:28 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "Facebook",
        "dance_style": "salsa, bachata, merengue, cha cha cha, bolero, latin hustle",
        "url": "www.eventbrite.com/e/salsa-night-dance-city-tickets-1415720962509",
        "event_type": "social dance",
        "event_name": "Salsa Night @ Dance City",
        "day_of_week": "Friday",
        "start_date": "2025-06-27",
        "end_date": "2025-06-27",
        "start_time": "19:45",
        "end_time": "00:00",
        "price": "CA$17.31",
        "location": "Edelweiss Club, 117 St Lawrence St, Victoria, BC V8V 1X7, Canada",
        "description": "Salsa Night @ Dance City, happening the 4th Friday of every month. Doors open at 7:45pm, Salsa lesson at 8:00pm, Dancing from 9:00pm to midnight. All ages welcome. $15.00 per person + service fee on Eventbrite or cash only at the door. $13 cash for Edelweiss Club members at the door only."
    }
]
```
2025-06-18 12:24:28 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/939376108286434/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Facebook",
        "dance_style": "salsa, bachata, merengue, cha cha cha, bolero, latin hustle",
        "url": "www.eventbrite.com/e/salsa-night-dance-city-tickets-1415720962509",
        "event_type": "social dance",
        "event_name": "Salsa Night @ Dance City",
        "day_of_week": "Friday",
        "start_date": "2025-06-27",
        "end_date": "2025-06-27",
        "start_time": "19:45",
        "end_time": "00:00",
        "price": "CA$17.31",
        "location": "Edelweiss Club, 117 St Lawrence St, Victoria, BC V8V 1X7, Canada",
        "description": "Salsa Night @ Dance City, happening the 4th Friday of every month. Doors open at 7:45pm, Salsa lesson at 8:00pm, Dancing from 9:00pm to midnight. All ages welcome. $15.00 per person + service fee on Eventbrite or cash only at the door. $13 cash for Edelweiss Club members at the door only."
    }
]
2025-06-18 12:24:28 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:24:28 - INFO - def clean_up_address(): Processing location 'Edelweiss Club, 117 St Lawrence St, Victoria, BC V8V 1X7, Canada' (event_id: None)
2025-06-18 12:24:28 - INFO - get_address_id: Inserted or updated address_id 3447 for address '117 St. Lawrence ST, VICTORIA, BC, V8V1X7, CA'.
2025-06-18 12:24:28 - INFO - Populated from DB for postal code 'V8V1X7': '117 St. Lawrence ST, VICTORIA, BC, V8V1X7, CA'
2025-06-18 12:24:28 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:24:28 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/939376108286434/'
2025-06-18 12:24:28 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:24:28 - INFO - def process_llm_response: URL https://www.facebook.com/events/939376108286434/ marked as relevant with events written to the database.
2025-06-18 12:24:28 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/939376108286434/.
2025-06-18 12:24:28 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/624858640069610/
2025-06-18 12:24:28 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/624858640069610/.
2025-06-18 12:24:28 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/624858640069610/
2025-06-18 12:24:28 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:24:28 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:24:28 - INFO - query_llm(): Querying Mistral
2025-06-18 12:24:37 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:24:37 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "Facebook",
    "dance_style": "salsa, bachata, merengue, cha cha cha, bolero, latin hustle",
    "url": "",
    "event_type": "social dance",
    "event_name": "Salsa Night @ Dance City",
    "day_of_week": "Friday",
    "start_date": "2025-08-22",
    "end_date": "2025-08-22",
    "start_time": "19:45",
    "end_time": "00:00",
    "price": "$15.00 per person + service fee on Eventbrite or cash only at the door. $13 cash for Edelweiss Club members at the door only.",
    "location": "Edelweiss Club, 117 St Lawrence St, Victoria, BC V8V 1X7, Canada",
    "description": "Salsa Night @ Dance City happens the 4th Friday of every month at an all ages venue right in the heart of downtown, with a wood dance floor."
}]
```
2025-06-18 12:24:37 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/624858640069610/, 
Cleaned JSON ready for parsing:
[{
    "source": "Facebook",
    "dance_style": "salsa, bachata, merengue, cha cha cha, bolero, latin hustle",
    "url": "",
    "event_type": "social dance",
    "event_name": "Salsa Night @ Dance City",
    "day_of_week": "Friday",
    "start_date": "2025-08-22",
    "end_date": "2025-08-22",
    "start_time": "19:45",
    "end_time": "00:00",
    "price": "$15.00 per person + service fee on Eventbrite or cash only at the door. $13 cash for Edelweiss Club members at the door only.",
    "location": "Edelweiss Club, 117 St Lawrence St, Victoria, BC V8V 1X7, Canada",
    "description": "Salsa Night @ Dance City happens the 4th Friday of every month at an all ages venue right in the heart of downtown, with a wood dance floor."
}]
2025-06-18 12:24:37 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:24:37 - INFO - def clean_up_address(): Processing location 'Edelweiss Club, 117 St Lawrence St, Victoria, BC V8V 1X7, Canada' (event_id: None)
2025-06-18 12:24:37 - INFO - get_address_id: Inserted or updated address_id 3447 for address '117 St. Lawrence ST, VICTORIA, BC, V8V1X7, CA'.
2025-06-18 12:24:37 - INFO - Populated from DB for postal code 'V8V1X7': '117 St. Lawrence ST, VICTORIA, BC, V8V1X7, CA'
2025-06-18 12:24:37 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:24:37 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/624858640069610/'
2025-06-18 12:24:37 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:24:37 - INFO - def process_llm_response: URL https://www.facebook.com/events/624858640069610/ marked as relevant with events written to the database.
2025-06-18 12:24:37 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/624858640069610/.
2025-06-18 12:24:37 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/691138080073761/
2025-06-18 12:24:37 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/691138080073761/.
2025-06-18 12:24:37 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/691138080073761/
2025-06-18 12:24:37 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:24:37 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:24:37 - INFO - query_llm(): Querying Mistral
2025-06-18 12:24:46 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:24:46 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "Victoria Latin Dance Association",
    "dance_style": "kizomba",
    "url": "",
    "event_type": "class",
    "event_name": "Free Outdoor Intro Dance Class + Social | Summer Series",
    "day_of_week": "Monday",
    "start_date": "2025-06-23",
    "end_date": "2025-06-23",
    "start_time": "17:30",
    "end_time": "19:30",
    "price": "Free",
    "location": "Ship's Point Inner Harbour, Big Blue Sailing, Victoria, BC V8W, Canada",
    "description": "Join us for an introduction to Kizomba with Aaron and Fernanda— part of our summer series, proudly sponsored by the City of Victoria! Every Monday | June–August 5:30–7:30 PM 1.5-hour dance class followed by a 30-minute outdoor social. Dance style rotates monthly — check our content calendar on our website for full details! This free outdoor event is open to everyone — no partner or dance experience needed. All ages, bodies, and abilities are warmly welcomed! Whether you’re dancing the night away or soaking in the summer vibes, come be part of this vibrant community celebration. Don’t forget to bring a water bottle and come ready to move!"
}]
```
2025-06-18 12:24:46 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/691138080073761/, 
Cleaned JSON ready for parsing:
[{
    "source": "Victoria Latin Dance Association",
    "dance_style": "kizomba",
    "url": "",
    "event_type": "class",
    "event_name": "Free Outdoor Intro Dance Class + Social | Summer Series",
    "day_of_week": "Monday",
    "start_date": "2025-06-23",
    "end_date": "2025-06-23",
    "start_time": "17:30",
    "end_time": "19:30",
    "price": "Free",
    "location": "Ship's Point Inner Harbour, Big Blue Sailing, Victoria, BC V8W, Canada",
    "description": "Join us for an introduction to Kizomba with Aaron and Fernanda— part of our summer series, proudly sponsored by the City of Victoria! Every Monday | June–August 5:30–7:30 PM 1.5-hour dance class followed by a 30-minute outdoor social. Dance style rotates monthly — check our content calendar on our website for full details! This free outdoor event is open to everyone — no partner or dance experience needed. All ages, bodies, and abilities are warmly welcomed! Whether you’re dancing the night away or soaking in the summer vibes, come be part of this vibrant community celebration. Don’t forget to bring a water bottle and come ready to move!"
}]
2025-06-18 12:24:46 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:24:46 - INFO - def clean_up_address(): Processing location 'Ship's Point Inner Harbour, Big Blue Sailing, Victoria, BC V8W, Canada' (event_id: None)
2025-06-18 12:24:46 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:24:46 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/691138080073761/'
2025-06-18 12:24:46 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:24:46 - INFO - def process_llm_response: URL https://www.facebook.com/events/691138080073761/ marked as relevant with events written to the database.
2025-06-18 12:24:46 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/691138080073761/.
2025-06-18 12:24:46 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/514087011782400/
2025-06-18 12:24:46 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/514087011782400/.
2025-06-18 12:24:46 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/514087011782400/
2025-06-18 12:24:46 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:24:46 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:24:46 - INFO - query_llm(): Querying Mistral
2025-06-18 12:24:54 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:24:54 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "80s Dance Party",
    "day_of_week": "Thursday",
    "start_date": "2025-06-05",
    "end_date": "2025-06-05",
    "start_time": "18:00",
    "end_time": null,
    "price": "",
    "location": "751 View St, Victoria, BC, Canada, British Columbia V8W 1J9",
    "description": "Join Kai Aris and Friends for an evening of upbeat 80s dance, pop, and rock classics. Featuring some of Victoria’s best young musicians: Lily Gyles Thomas on vocals, Josh Warren on bass, Ava Creed on drums, Alex Gwillim on guitar, and Kai Aris on Synthesizer. Enjoy some drinks and dance the night away!"
}]
```
2025-06-18 12:24:54 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/514087011782400/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "80s Dance Party",
    "day_of_week": "Thursday",
    "start_date": "2025-06-05",
    "end_date": "2025-06-05",
    "start_time": "18:00",
    "end_time": null,
    "price": "",
    "location": "751 View St, Victoria, BC, Canada, British Columbia V8W 1J9",
    "description": "Join Kai Aris and Friends for an evening of upbeat 80s dance, pop, and rock classics. Featuring some of Victoria’s best young musicians: Lily Gyles Thomas on vocals, Josh Warren on bass, Ava Creed on drums, Alex Gwillim on guitar, and Kai Aris on Synthesizer. Enjoy some drinks and dance the night away!"
}]
2025-06-18 12:24:54 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:24:54 - INFO - def clean_up_address(): Processing location '751 View St, Victoria, BC, Canada, British Columbia V8W 1J9' (event_id: None)
2025-06-18 12:24:54 - INFO - def clean_up_address(): Updated event None with address_id 4326 using DB match
2025-06-18 12:24:54 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:24:54 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/514087011782400/'
2025-06-18 12:24:54 - INFO - def process_llm_response: URL https://www.facebook.com/events/514087011782400/ marked as relevant with events written to the database.
2025-06-18 12:24:54 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/514087011782400/.
2025-06-18 12:24:54 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1618420955545842/
2025-06-18 12:24:54 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1618420955545842/.
2025-06-18 12:24:54 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1618420955545842/
2025-06-18 12:24:54 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:24:54 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:24:54 - INFO - query_llm(): Querying Mistral
2025-06-18 12:24:58 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:24:58 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "Facebook",
    "dance_style": "salsa, bachata, merengue, cha cha cha, bolero, latin hustle",
    "url": "",
    "event_type": "social dance",
    "event_name": "Salsa Night @ Dance City",
    "day_of_week": "Friday",
    "start_date": "2025-05-30",
    "end_date": "2025-05-30",
    "start_time": "19:45",
    "end_time": "23:59",
    "price": "$15.00 per person + service fee on Eventbrite or cash only at the door. $13 cash for Edelweiss Club members at the door only.",
    "location": "Edelweiss Club, 117 St Lawrence St, Victoria, BC V8V 1X7, Canada",
    "description": "Salsa Night @ Dance City. Doors open at 7:45pm. Salsa lesson at 8:00pm. Dancing to Salsa, Bachata, Merengue, Cha Cha Cha, Bolero & Latin Hustle from 9:00pm to midnight. All ages welcome. Limited capacity, first come first served."
}]
```
2025-06-18 12:24:58 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1618420955545842/, 
Cleaned JSON ready for parsing:
[{
    "source": "Facebook",
    "dance_style": "salsa, bachata, merengue, cha cha cha, bolero, latin hustle",
    "url": "",
    "event_type": "social dance",
    "event_name": "Salsa Night @ Dance City",
    "day_of_week": "Friday",
    "start_date": "2025-05-30",
    "end_date": "2025-05-30",
    "start_time": "19:45",
    "end_time": "23:59",
    "price": "$15.00 per person + service fee on Eventbrite or cash only at the door. $13 cash for Edelweiss Club members at the door only.",
    "location": "Edelweiss Club, 117 St Lawrence St, Victoria, BC V8V 1X7, Canada",
    "description": "Salsa Night @ Dance City. Doors open at 7:45pm. Salsa lesson at 8:00pm. Dancing to Salsa, Bachata, Merengue, Cha Cha Cha, Bolero & Latin Hustle from 9:00pm to midnight. All ages welcome. Limited capacity, first come first served."
}]
2025-06-18 12:24:58 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:24:58 - INFO - def clean_up_address(): Processing location 'Edelweiss Club, 117 St Lawrence St, Victoria, BC V8V 1X7, Canada' (event_id: None)
2025-06-18 12:24:58 - INFO - get_address_id: Inserted or updated address_id 3447 for address '117 St. Lawrence ST, VICTORIA, BC, V8V1X7, CA'.
2025-06-18 12:24:58 - INFO - Populated from DB for postal code 'V8V1X7': '117 St. Lawrence ST, VICTORIA, BC, V8V1X7, CA'
2025-06-18 12:24:58 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:24:58 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1618420955545842/'
2025-06-18 12:24:58 - INFO - def process_llm_response: URL https://www.facebook.com/events/1618420955545842/ marked as relevant with events written to the database.
2025-06-18 12:24:58 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1618420955545842/.
2025-06-18 12:24:58 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1031573525615192/
2025-06-18 12:24:58 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1031573525615192/.
2025-06-18 12:24:58 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1031573525615192/
2025-06-18 12:24:58 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:24:58 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:24:58 - INFO - query_llm(): Querying Mistral
2025-06-18 12:25:03 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:25:03 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "",
    "url": "https://hermannsjazz.com/show/737557/view",
    "event_type": "live music",
    "event_name": "GROOVE KITCHEN'S JUNEFEST DANCE!!",
    "day_of_week": "Sunday",
    "start_date": "2025-06-29",
    "end_date": "2025-06-29",
    "start_time": "19:00",
    "end_time": null,
    "price": "",
    "location": "Hermann's Jazz Club, 753 View Street, Victoria, BC V8W 1J9",
    "description": "The festival is over and it seems you still wanna celebrate music, but also... wanna get down and boogie?? You're our kind of people!! Observe the top of Summer with song and funky steps as the kitchen's groove moves your body like they've done before at spots like the Butchart Gardens, The Esquimalt Ribfest, The Osbourne Bay Pub, or the hottest rooms in and outta town. The Chefs are ready to serve their mouthwatering melange of funk, pop, soul, Latin, and flavours to party to the end!! Join us... Doors 5:30 PM / 7:00 PM Show, Sunday June 29th Hermann's Jazz Club 753 View Street Victoria, BC V8W 1J9"
}]
```
2025-06-18 12:25:03 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1031573525615192/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "",
    "url": "https://hermannsjazz.com/show/737557/view",
    "event_type": "live music",
    "event_name": "GROOVE KITCHEN'S JUNEFEST DANCE!!",
    "day_of_week": "Sunday",
    "start_date": "2025-06-29",
    "end_date": "2025-06-29",
    "start_time": "19:00",
    "end_time": null,
    "price": "",
    "location": "Hermann's Jazz Club, 753 View Street, Victoria, BC V8W 1J9",
    "description": "The festival is over and it seems you still wanna celebrate music, but also wanna get down and boogie?? You're our kind of people!! Observe the top of Summer with song and funky steps as the kitchen's groove moves your body like they've done before at spots like the Butchart Gardens, The Esquimalt Ribfest, The Osbourne Bay Pub, or the hottest rooms in and outta town. The Chefs are ready to serve their mouthwatering melange of funk, pop, soul, Latin, and flavours to party to the end!! Join us Doors 5:30 PM / 7:00 PM Show, Sunday June 29th Hermann's Jazz Club 753 View Street Victoria, BC V8W 1J9"
}]
2025-06-18 12:25:03 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:25:03 - INFO - def clean_up_address(): Processing location 'Hermann's Jazz Club, 753 View Street, Victoria, BC V8W 1J9' (event_id: None)
2025-06-18 12:25:03 - INFO - def clean_up_address(): Updated event None with address_id 1246 using DB match
2025-06-18 12:25:03 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:25:03 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1031573525615192/'
2025-06-18 12:25:03 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:25:03 - INFO - def process_llm_response: URL https://www.facebook.com/events/1031573525615192/ marked as relevant with events written to the database.
2025-06-18 12:25:03 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1031573525615192/.
2025-06-18 12:25:03 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1363696181561219/
2025-06-18 12:25:03 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1363696181561219/.
2025-06-18 12:25:03 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1363696181561219/
2025-06-18 12:25:03 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:25:03 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:25:03 - INFO - query_llm(): Querying Mistral
2025-06-18 12:25:08 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:25:08 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "",
        "url": "https://clannamorna.ca/.../ticket-victoria-pride-contra.../",
        "event_type": "social dance",
        "event_name": "Pride Contra Dance",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "19:00",
        "end_time": "22:00",
        "price": "$12 - Youth $20 - Everyone who is willing and able to NOTAFLOF",
        "location": "Fairfield United, 925 Balmoral Rd, Victoria, BC V8T 1A7, Canada",
        "description": "The return of our QUEER Contra Dance to celebrate the month of Pride! All Dancers welcome! Join us Friday, June 20th at the United Commons Fellowship Hall to do-si-do the night away to sprightly fiddle tunes and stellar performances from our two favorite drag performers! We'll have more capacity than our previous Valentines Day Dance, but we still might sell out, so grab your tickets online here! 6:30 - doors open 7:00 - dancing starts with a beginner friendly dance lesson Everyone welcome, no experience necessary."
    }
]
```
2025-06-18 12:25:08 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1363696181561219/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "",
        "url": "https://clannamorna.ca//ticket-victoria-pride-contra/",
        "event_type": "social dance",
        "event_name": "Pride Contra Dance",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "19:00",
        "end_time": "22:00",
        "price": "$12 - Youth $20 - Everyone who is willing and able to NOTAFLOF",
        "location": "Fairfield United, 925 Balmoral Rd, Victoria, BC V8T 1A7, Canada",
        "description": "The return of our QUEER Contra Dance to celebrate the month of Pride! All Dancers welcome! Join us Friday, June 20th at the United Commons Fellowship Hall to do-si-do the night away to sprightly fiddle tunes and stellar performances from our two favorite drag performers! We'll have more capacity than our previous Valentines Day Dance, but we still might sell out, so grab your tickets online here! 6:30 - doors open 7:00 - dancing starts with a beginner friendly dance lesson Everyone welcome, no experience necessary."
    }
]
2025-06-18 12:25:08 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:25:08 - INFO - def clean_up_address(): Processing location 'Fairfield United, 925 Balmoral Rd, Victoria, BC V8T 1A7, Canada' (event_id: None)
2025-06-18 12:25:08 - INFO - def clean_up_address(): Updated event None with address_id 5688 using DB match
2025-06-18 12:25:08 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:25:08 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1363696181561219/'
2025-06-18 12:25:08 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:25:08 - INFO - def process_llm_response: URL https://www.facebook.com/events/1363696181561219/ marked as relevant with events written to the database.
2025-06-18 12:25:08 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1363696181561219/.
2025-06-18 12:25:08 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/663135653237580/
2025-06-18 12:25:08 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/663135653237580/.
2025-06-18 12:25:08 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/663135653237580/
2025-06-18 12:25:08 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:25:08 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:25:08 - INFO - query_llm(): Querying Mistral
2025-06-18 12:25:18 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:25:18 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "Friday from 19:30-23:00 WACK! Another West Coast Swing Social Dance Method Studio - Victoria BC Canice Ma invited you Interested Going About Discussion More About Discussion WACK! Another West Coast Swing Social Dance Invite Details 40 people responded Event by Canice Ma and Wyatt Ritchie Method Studio - Victoria BC Duration: 3 hr 30 min Public · Anyone on or off Facebook Guess who's back, it's WACK! (please ignore the fact that it's been 2 years...) The schmucks are back with another spontaneous west coast swing social dance, featuring music by DJs Topknot and Amandance from Vancouver! DETAILS: • Friday, June 20th, 2025 • Method Studio, 841 Fisgard St, Victoria, BC • 7:30-8:30 pm: \"Shake That\" line dance lesson featuring Kaitlyn • 8:30-11 pm: social dancing with 100% west coast swing • Admission: $10 • Water and AC on us (and maybe some bonus chocolate) • Please keep in mind that parking is limited at the venue GENERAL SOCIAL DANCE ETIQUETTE: • Consent is cool- don't be creepy. • Shake off any shyness and get out there! Ask people to dance regardless if you’re a lead or follow, dancing for 10 years or started yesterday- it's more fun that way! • No teaching or unsolicited feedback on the dance floor. Good vibes only! • If you would like to partake in a steal dance, try to remain with that group for the whole song. • Bring a water bottle! The studio is known to get warm with more bodies in the space so we want you to stay healthy and hydrated. • Personal hygiene is important! Consider bringing a towel and/or a spare shirt to change into if you sweat easily. Our studio has a bathroom and change rooms available for all to use. • We recommend wearing clothes that are easy to move in, especially pants given the nature of the dance. • Clean, comfortable shoes (ideally dance shoes) on the dance floor only! See less Victoria, British Columbia Method Studio - Victoria BC 833 Fisgard St, Victoria, BC V8W 1R9, Canada Guests See All",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "WACK! Another West Coast Swing Social Dance",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "19:30",
        "end_time": "23:00",
        "price": "$10",
        "location": "Method Studio, 841 Fisgard St, Victoria, BC",
        "description": "Featuring music by DJs Topknot and Amandance from Vancouver! DETAILS: • 7:30-8:30 pm: \"Shake That\" line dance lesson featuring Kaitlyn • 8:30-11 pm: social dancing with 100% west coast swing • Admission: $10 • Water and AC on us (and maybe some bonus chocolate) • Please keep in mind that parking is limited at the venue GENERAL SOCIAL DANCE ETIQUETTE: • Consent is cool- don't be creepy. • Shake off any shyness and get out there! Ask people to dance regardless if you’re a lead or follow, dancing for 10 years or started yesterday- it's more fun that way! • No teaching or unsolicited feedback on the dance floor. Good vibes only! • If you would like to partake in a steal dance, try to remain with that group for the whole song. • Bring a water bottle! The studio is known to get warm with more bodies in the space so we want you to stay healthy and hydrated. • Personal hygiene is important! Consider bringing a towel and/or a spare shirt to change into if you sweat easily. Our studio has a bathroom and change rooms available for all to use. • We recommend wearing clothes that are easy to move in, especially pants given the nature of the dance. • Clean, comfortable shoes (ideally dance shoes) on the dance floor only!"
    }
]
```
2025-06-18 12:25:18 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/663135653237580/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Friday from 19:30-23:00 WACK! Another West Coast Swing Social Dance Method Studio - Victoria BC Canice Ma invited you Interested Going About Discussion More About Discussion WACK! Another West Coast Swing Social Dance Invite Details 40 people responded Event by Canice Ma and Wyatt Ritchie Method Studio - Victoria BC Duration: 3 hr 30 min Public · Anyone on or off Facebook Guess who's back, it's WACK! (please ignore the fact that it's been 2 years) The schmucks are back with another spontaneous west coast swing social dance, featuring music by DJs Topknot and Amandance from Vancouver! DETAILS: • Friday, June 20th, 2025 • Method Studio, 841 Fisgard St, Victoria, BC • 7:30-8:30 pm: \"Shake That\" line dance lesson featuring Kaitlyn • 8:30-11 pm: social dancing with 100% west coast swing • Admission: $10 • Water and AC on us (and maybe some bonus chocolate) • Please keep in mind that parking is limited at the venue GENERAL SOCIAL DANCE ETIQUETTE: • Consent is cool- don't be creepy. • Shake off any shyness and get out there! Ask people to dance regardless if you’re a lead or follow, dancing for 10 years or started yesterday- it's more fun that way! • No teaching or unsolicited feedback on the dance floor. Good vibes only! • If you would like to partake in a steal dance, try to remain with that group for the whole song. • Bring a water bottle! The studio is known to get warm with more bodies in the space so we want you to stay healthy and hydrated. • Personal hygiene is important! Consider bringing a towel and/or a spare shirt to change into if you sweat easily. Our studio has a bathroom and change rooms available for all to use. • We recommend wearing clothes that are easy to move in, especially pants given the nature of the dance. • Clean, comfortable shoes (ideally dance shoes) on the dance floor only! See less Victoria, British Columbia Method Studio - Victoria BC 833 Fisgard St, Victoria, BC V8W 1R9, Canada Guests See All",
        "dance_style": "west coast swing",
        "url": "",
        "event_type": "social dance",
        "event_name": "WACK! Another West Coast Swing Social Dance",
        "day_of_week": "Friday",
        "start_date": "2025-06-20",
        "end_date": "2025-06-20",
        "start_time": "19:30",
        "end_time": "23:00",
        "price": "$10",
        "location": "Method Studio, 841 Fisgard St, Victoria, BC",
        "description": "Featuring music by DJs Topknot and Amandance from Vancouver! DETAILS: • 7:30-8:30 pm: \"Shake That\" line dance lesson featuring Kaitlyn • 8:30-11 pm: social dancing with 100% west coast swing • Admission: $10 • Water and AC on us (and maybe some bonus chocolate) • Please keep in mind that parking is limited at the venue GENERAL SOCIAL DANCE ETIQUETTE: • Consent is cool- don't be creepy. • Shake off any shyness and get out there! Ask people to dance regardless if you’re a lead or follow, dancing for 10 years or started yesterday- it's more fun that way! • No teaching or unsolicited feedback on the dance floor. Good vibes only! • If you would like to partake in a steal dance, try to remain with that group for the whole song. • Bring a water bottle! The studio is known to get warm with more bodies in the space so we want you to stay healthy and hydrated. • Personal hygiene is important! Consider bringing a towel and/or a spare shirt to change into if you sweat easily. Our studio has a bathroom and change rooms available for all to use. • We recommend wearing clothes that are easy to move in, especially pants given the nature of the dance. • Clean, comfortable shoes (ideally dance shoes) on the dance floor only!"
    }
]
2025-06-18 12:25:18 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:25:18 - INFO - def clean_up_address(): Processing location 'Method Studio, 841 Fisgard St, Victoria, BC' (event_id: None)
2025-06-18 12:25:18 - INFO - def clean_up_address(): Updated event None with address_id 4948 using DB match
2025-06-18 12:25:18 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:25:18 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/663135653237580/'
2025-06-18 12:25:18 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:25:18 - INFO - def process_llm_response: URL https://www.facebook.com/events/663135653237580/ marked as relevant with events written to the database.
2025-06-18 12:25:18 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/663135653237580/.
2025-06-18 12:25:18 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1904863453602318/
2025-06-18 12:25:18 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1904863453602318/.
2025-06-18 12:25:18 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1904863453602318/
2025-06-18 12:25:18 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:25:18 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:25:18 - INFO - query_llm(): Querying Mistral
2025-06-18 12:25:21 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:25:21 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Private Dance",
        "day_of_week": "Saturday",
        "start_date": "2025-05-31",
        "end_date": "2025-05-31",
        "start_time": "19:00",
        "end_time": "22:00",
        "price": "",
        "location": "Saanichton, BC",
        "description": "We are excited for our gig on May 31 at Saanichton Bay. It is a private event. There will be good rocking tonight."
    }
]
```
2025-06-18 12:25:21 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1904863453602318/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Private Dance",
        "day_of_week": "Saturday",
        "start_date": "2025-05-31",
        "end_date": "2025-05-31",
        "start_time": "19:00",
        "end_time": "22:00",
        "price": "",
        "location": "Saanichton, BC",
        "description": "We are excited for our gig on May 31 at Saanichton Bay. It is a private event. There will be good rocking tonight."
    }
]
2025-06-18 12:25:21 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:25:21 - INFO - def clean_up_address(): Processing location 'Saanichton, BC' (event_id: None)
2025-06-18 12:25:21 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:25:21 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1904863453602318/'
2025-06-18 12:25:21 - INFO - def process_llm_response: URL https://www.facebook.com/events/1904863453602318/ marked as relevant with events written to the database.
2025-06-18 12:25:21 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1904863453602318/.
2025-06-18 12:25:21 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1185783966345055/
2025-06-18 12:25:21 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1185783966345055/.
2025-06-18 12:25:21 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1185783966345055/
2025-06-18 12:25:21 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:25:21 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:25:21 - INFO - query_llm(): Querying Mistral
2025-06-18 12:25:24 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:25:24 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "shuffle",
        "url": "https://www.thebeatclinic.ca/",
        "event_type": "workshop",
        "event_name": "Shuffle Dance Workshop",
        "day_of_week": "Sunday",
        "start_date": "2025-05-25",
        "end_date": "2025-05-25",
        "start_time": "10:00",
        "end_time": "13:00",
        "price": "",
        "location": "The Beat Clinic, 1303 Broad Street, Victoria, BC",
        "description": "Join our Shuffle Dance Workshop and learn a full shuffle choreography set to an energetic electronic track. We’ll guide you through each step, focusing on key shuffle movements, while incorporating them into a dynamic routine. Perfect for ALL LEVELS! This workshop will help you improve your footwork, coordination, and cardiovascular stamina as you master a complete choreography."
    }
]
```
2025-06-18 12:25:24 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1185783966345055/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "shuffle",
        "url": "https://www.thebeatclinic.ca/",
        "event_type": "workshop",
        "event_name": "Shuffle Dance Workshop",
        "day_of_week": "Sunday",
        "start_date": "2025-05-25",
        "end_date": "2025-05-25",
        "start_time": "10:00",
        "end_time": "13:00",
        "price": "",
        "location": "The Beat Clinic, 1303 Broad Street, Victoria, BC",
        "description": "Join our Shuffle Dance Workshop and learn a full shuffle choreography set to an energetic electronic track. We’ll guide you through each step, focusing on key shuffle movements, while incorporating them into a dynamic routine. Perfect for ALL LEVELS! This workshop will help you improve your footwork, coordination, and cardiovascular stamina as you master a complete choreography."
    }
]
2025-06-18 12:25:24 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:25:24 - INFO - def clean_up_address(): Processing location 'The Beat Clinic, 1303 Broad Street, Victoria, BC' (event_id: None)
2025-06-18 12:25:24 - INFO - def clean_up_address(): Updated event None with address_id 1928 using DB match
2025-06-18 12:25:24 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:25:24 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1185783966345055/'
2025-06-18 12:25:24 - INFO - def process_llm_response: URL https://www.facebook.com/events/1185783966345055/ marked as relevant with events written to the database.
2025-06-18 12:25:24 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1185783966345055/.
2025-06-18 12:25:24 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1910904133047825/
2025-06-18 12:25:24 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1910904133047825/.
2025-06-18 12:25:24 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1910904133047825/
2025-06-18 12:25:24 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:25:24 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:25:24 - INFO - query_llm(): Querying Mistral
2025-06-18 12:25:30 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:25:30 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "salsa, merengue",
    "url": "",
    "event_type": "live music",
    "event_name": "COLOMBIAN RUMBA - BARRANQUILLA CARNIVAL PARTY",
    "day_of_week": "Friday",
    "start_date": "2025-03-14",
    "end_date": "2025-03-14",
    "start_time": "21:30",
    "end_time": "01:30",
    "price": "$30",
    "location": "The Coda - 751 View Street (2nd floor, Hermmans Jazz Club), Victoria, British Columbia",
    "description": "Get set for an unforgettable night filled with the vibrant rhythms, pulsating music, and electric atmosphere of one of Latin America's most exhilarating celebrations! Join us as we dive into a kaleidoscope of Caribbean rhythms, from cumbia and champeta to reggaeton, salsa, and merengue - all fueled by the hottest Latin vibes! Immerse yourself in a high-energy dance class Feel the thrill of live Colombian music “Parrandon Vallenato” and get swept away by the magic of electrifying DJ sets by Alex King and Dj Miro from Colombia. Lose yourself in spectacular performances by Fusion Chibcha “Colombian Culture Society” Show off your Carnival spirit with a colorful, eye-catching dress code, and have the chance of winning a surprise prize. Embrace the wild and wonderful world of Barranquilla Carnival with your most dazzling outfit! A fantastic surprise prize awaits the attendee who steals the show with the best costume!"
}]
```
2025-06-18 12:25:30 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1910904133047825/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "salsa, merengue",
    "url": "",
    "event_type": "live music",
    "event_name": "COLOMBIAN RUMBA - BARRANQUILLA CARNIVAL PARTY",
    "day_of_week": "Friday",
    "start_date": "2025-03-14",
    "end_date": "2025-03-14",
    "start_time": "21:30",
    "end_time": "01:30",
    "price": "$30",
    "location": "The Coda - 751 View Street (2nd floor, Hermmans Jazz Club), Victoria, British Columbia",
    "description": "Get set for an unforgettable night filled with the vibrant rhythms, pulsating music, and electric atmosphere of one of Latin America's most exhilarating celebrations! Join us as we dive into a kaleidoscope of Caribbean rhythms, from cumbia and champeta to reggaeton, salsa, and merengue - all fueled by the hottest Latin vibes! Immerse yourself in a high-energy dance class Feel the thrill of live Colombian music “Parrandon Vallenato” and get swept away by the magic of electrifying DJ sets by Alex King and Dj Miro from Colombia. Lose yourself in spectacular performances by Fusion Chibcha “Colombian Culture Society” Show off your Carnival spirit with a colorful, eye-catching dress code, and have the chance of winning a surprise prize. Embrace the wild and wonderful world of Barranquilla Carnival with your most dazzling outfit! A fantastic surprise prize awaits the attendee who steals the show with the best costume!"
}]
2025-06-18 12:25:30 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:25:30 - INFO - def clean_up_address(): Processing location 'The Coda - 751 View Street (2nd floor, Hermmans Jazz Club), Victoria, British Columbia' (event_id: None)
2025-06-18 12:25:30 - INFO - def clean_up_address(): Updated event None with address_id 4326 using DB match
2025-06-18 12:25:30 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:25:30 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1910904133047825/'
2025-06-18 12:25:30 - INFO - def process_llm_response: URL https://www.facebook.com/events/1910904133047825/ marked as relevant with events written to the database.
2025-06-18 12:25:30 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1910904133047825/.
2025-06-18 12:25:30 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/650657144184821/
2025-06-18 12:25:30 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/650657144184821/.
2025-06-18 12:25:30 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/650657144184821/
2025-06-18 12:25:30 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:25:30 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:25:30 - INFO - query_llm(): Querying Mistral
2025-06-18 12:25:38 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:25:38 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "salsa, merengue, reggaetón, colombian",
    "url": "",
    "event_type": "live music",
    "event_name": "COLOMBIAN SUMMER RUMBA “TIERRA QUERIDA” PARTY",
    "day_of_week": "Saturday",
    "start_date": "2025-07-19",
    "end_date": "2025-07-19",
    "start_time": "21:00",
    "end_time": "02:00",
    "price": "$20 | Second-tier: $25 | Limited tickets available at the door for $27",
    "location": "The Coda, 751 View St, Victoria",
    "description": "Celebrate Colombian Independence Day with live music, dance, culture, and pure rumba energy! Live tribute to Colombian music by Daniel Sar & Sofia Leonne, followed by DJ Miro and DJ Alex King. Special folkloric performance by Danza Colombia and a unifying moment with the national anthem. Enjoy cocktails, vibrant downtown vibes, and a night filled with alegría and Colombian vibes."
}]
```
2025-06-18 12:25:38 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/650657144184821/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "salsa, merengue, reggaetón, colombian",
    "url": "",
    "event_type": "live music",
    "event_name": "COLOMBIAN SUMMER RUMBA “TIERRA QUERIDA” PARTY",
    "day_of_week": "Saturday",
    "start_date": "2025-07-19",
    "end_date": "2025-07-19",
    "start_time": "21:00",
    "end_time": "02:00",
    "price": "$20 | Second-tier: $25 | Limited tickets available at the door for $27",
    "location": "The Coda, 751 View St, Victoria",
    "description": "Celebrate Colombian Independence Day with live music, dance, culture, and pure rumba energy! Live tribute to Colombian music by Daniel Sar & Sofia Leonne, followed by DJ Miro and DJ Alex King. Special folkloric performance by Danza Colombia and a unifying moment with the national anthem. Enjoy cocktails, vibrant downtown vibes, and a night filled with alegría and Colombian vibes."
}]
2025-06-18 12:25:38 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:25:38 - INFO - def clean_up_address(): Processing location 'The Coda, 751 View St, Victoria' (event_id: None)
2025-06-18 12:25:38 - INFO - def clean_up_address(): Updated event None with address_id 4326 using DB match
2025-06-18 12:25:38 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:25:38 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/650657144184821/'
2025-06-18 12:25:38 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:25:38 - INFO - def process_llm_response: URL https://www.facebook.com/events/650657144184821/ marked as relevant with events written to the database.
2025-06-18 12:25:38 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/650657144184821/.
2025-06-18 12:25:38 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/667083456006099/
2025-06-18 12:25:38 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/667083456006099/.
2025-06-18 12:25:38 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/667083456006099/
2025-06-18 12:25:38 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:25:38 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:25:38 - INFO - query_llm(): Querying Mistral
2025-06-18 12:25:42 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:25:42 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "cumbia, champeta, reggaeton, salsa, merengue",
    "url": "",
    "event_type": "live music",
    "event_name": "COLOMBIAN RUMBA - BARRANQUILLA CARNIVAL NIGHT",
    "day_of_week": "Friday",
    "start_date": "2025-03-14",
    "end_date": "2025-03-14",
    "start_time": "21:30",
    "end_time": "01:30",
    "price": "$30",
    "location": "Coda - 753 View Street (2nd floor, Hermmans Jazz Club), Victoria, BC, Canada, British Columbia V8W 1J9",
    "description": "Get set for an unforgettable night filled with the vibrant rhythms, pulsating music, and electric atmosphere of one of Latin America's most exhilarating celebrations! Join us as we dive into a kaleidoscope of Caribbean rhythms, from cumbia and champeta to reggaeton, salsa, and merengue - all fueled by the hottest Latin vibes! Immerse yourself in a high-energy dance class Feel the thrill of live Colombian music “Parrandon Vallenato” and get swept away by the magic of electrifying DJ sets by Alex King and Dj Miro from Colombia. Lose yourself in spectacular performances by Fusion Chibcha “Colombian Culture Society” Show off your Carnival spirit with a colorful, eye-catching dress code, and have the chance of winning a surprise prize. Embrace the wild and wonderful world of Barranquilla Carnival with your most dazzling outfit! A fantastic surprise prize awaits the attendee who steals the show with the best costume! Legal drinking age required + two photo IDs Brought to you by Victoria Viva la Fiesta, get your tickets now and prepare to experience the heart-pounding excitement and magical ambiance of Carnaval in Canada! It's time to let loose, embrace your Latin side, and create memories that will last a lifetime!"
}]
```
2025-06-18 12:25:42 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/667083456006099/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "cumbia, champeta, reggaeton, salsa, merengue",
    "url": "",
    "event_type": "live music",
    "event_name": "COLOMBIAN RUMBA - BARRANQUILLA CARNIVAL NIGHT",
    "day_of_week": "Friday",
    "start_date": "2025-03-14",
    "end_date": "2025-03-14",
    "start_time": "21:30",
    "end_time": "01:30",
    "price": "$30",
    "location": "Coda - 753 View Street (2nd floor, Hermmans Jazz Club), Victoria, BC, Canada, British Columbia V8W 1J9",
    "description": "Get set for an unforgettable night filled with the vibrant rhythms, pulsating music, and electric atmosphere of one of Latin America's most exhilarating celebrations! Join us as we dive into a kaleidoscope of Caribbean rhythms, from cumbia and champeta to reggaeton, salsa, and merengue - all fueled by the hottest Latin vibes! Immerse yourself in a high-energy dance class Feel the thrill of live Colombian music “Parrandon Vallenato” and get swept away by the magic of electrifying DJ sets by Alex King and Dj Miro from Colombia. Lose yourself in spectacular performances by Fusion Chibcha “Colombian Culture Society” Show off your Carnival spirit with a colorful, eye-catching dress code, and have the chance of winning a surprise prize. Embrace the wild and wonderful world of Barranquilla Carnival with your most dazzling outfit! A fantastic surprise prize awaits the attendee who steals the show with the best costume! Legal drinking age required + two photo IDs Brought to you by Victoria Viva la Fiesta, get your tickets now and prepare to experience the heart-pounding excitement and magical ambiance of Carnaval in Canada! It's time to let loose, embrace your Latin side, and create memories that will last a lifetime!"
}]
2025-06-18 12:25:42 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:25:42 - INFO - def clean_up_address(): Processing location 'Coda - 753 View Street (2nd floor, Hermmans Jazz Club), Victoria, BC, Canada, British Columbia V8W 1J9' (event_id: None)
2025-06-18 12:25:42 - INFO - def clean_up_address(): Updated event None with address_id 1246 using DB match
2025-06-18 12:25:42 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:25:42 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/667083456006099/'
2025-06-18 12:25:42 - INFO - def process_llm_response: URL https://www.facebook.com/events/667083456006099/ marked as relevant with events written to the database.
2025-06-18 12:25:42 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/667083456006099/.
2025-06-18 12:25:42 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1132427048350776/
2025-06-18 12:25:42 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1132427048350776/.
2025-06-18 12:25:42 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1132427048350776/
2025-06-18 12:25:42 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:25:42 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:25:42 - INFO - query_llm(): Querying Mistral
2025-06-18 12:25:46 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:25:46 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "swing",
        "url": "",
        "event_type": "live music",
        "event_name": "A Night of Classic Swing and Brazilian Jazz with The RoseBuds & Samba E Sol",
        "day_of_week": "Saturday",
        "start_date": "2025-04-05",
        "end_date": "2025-04-05",
        "start_time": "18:30",
        "end_time": "21:00",
        "price": "$12 Presale - E-transfer almix12@gmail.com or $15 cash/e-transfer at the door",
        "location": "Caffè Fantastico Specialty Coffees, 965 Kings Road, Victoria",
        "description": "A Night of Classic Swing and Brazilian Jazz with Rosebuds and Samba e Sol. Doors at 6:30pm, Music at 7-9pm. Presale tickets available via E-transfer."
    }
]
```
2025-06-18 12:25:46 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1132427048350776/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "swing",
        "url": "",
        "event_type": "live music",
        "event_name": "A Night of Classic Swing and Brazilian Jazz with The RoseBuds & Samba E Sol",
        "day_of_week": "Saturday",
        "start_date": "2025-04-05",
        "end_date": "2025-04-05",
        "start_time": "18:30",
        "end_time": "21:00",
        "price": "$12 Presale - E-transfer almix12@gmail.com or $15 cash/e-transfer at the door",
        "location": "Caffè Fantastico Specialty Coffees, 965 Kings Road, Victoria",
        "description": "A Night of Classic Swing and Brazilian Jazz with Rosebuds and Samba e Sol. Doors at 6:30pm, Music at 7-9pm. Presale tickets available via E-transfer."
    }
]
2025-06-18 12:25:46 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:25:46 - INFO - def clean_up_address(): Processing location 'Caffè Fantastico Specialty Coffees, 965 Kings Road, Victoria' (event_id: None)
2025-06-18 12:25:46 - INFO - def clean_up_address(): Updated event None with address_id 2599 using DB match
2025-06-18 12:25:46 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:25:46 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1132427048350776/'
2025-06-18 12:25:46 - INFO - def process_llm_response: URL https://www.facebook.com/events/1132427048350776/ marked as relevant with events written to the database.
2025-06-18 12:25:46 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1132427048350776/.
2025-06-18 12:25:46 - INFO - def driver_fb_search(): Keywords checkpoint updated.
2025-06-18 12:25:50 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q=double shuffle&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:25:50 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q=double shuffle&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:25:56 - INFO - extract_event_links(): Found 0 links on https://www.facebook.com/search/events?q=double shuffle&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:25:56 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q=double shuffle&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 0 event_links

2025-06-18 12:25:59 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q= country waltz&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:25:59 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q= country waltz&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:26:04 - INFO - extract_event_links(): Found 0 links on https://www.facebook.com/search/events?q= country waltz&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:26:04 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q= country waltz&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 0 event_links

2025-06-18 12:26:08 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q= line dance&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:26:08 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q= line dance&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:26:14 - INFO - extract_event_links(): Found 0 links on https://www.facebook.com/search/events?q= line dance&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:26:14 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q= line dance&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 0 event_links

2025-06-18 12:26:16 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q= nite club two&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:26:16 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q= nite club two&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:26:22 - INFO - extract_event_links(): Found 0 links on https://www.facebook.com/search/events?q= nite club two&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:26:22 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q= nite club two&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 0 event_links

2025-06-18 12:26:24 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q= two step&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:26:24 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q= two step&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:26:30 - INFO - extract_event_links(): Found 0 links on https://www.facebook.com/search/events?q= two step&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:26:30 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q= two step&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 0 event_links

2025-06-18 12:26:30 - INFO - def scrape_events(): Extracted text from 0 events.
2025-06-18 12:26:30 - INFO - def scrape_events(): Extracted text data written to checkpoint/extracted_text.xlsx.
2025-06-18 12:26:30 - INFO - def driver_fb_search(): Extracted text based on search_url: https://www.facebook.com/search/events?q= two step&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9.
2025-06-18 12:26:30 - INFO - def driver_fb_search(): No extracted text found for any URLs.
2025-06-18 12:26:30 - INFO - def driver_fb_search(): Keywords checkpoint updated.
2025-06-18 12:26:33 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q=kizomba&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:26:33 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q=kizomba&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:26:39 - INFO - extract_event_links(): Found 14 links on https://www.facebook.com/search/events?q=kizomba&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:26:39 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q=kizomba&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 14 event_links

2025-06-18 12:26:39 - INFO - should_process_url: URL https://www.facebook.com/events/1079226067560481/ was last seen as relevant, processing it.
2025-06-18 12:26:42 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1079226067560481/ (11606 ms)
2025-06-18 12:27:01 - INFO - extract_event_text: extracted 4861 chars
2025-06-18 12:27:01 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1079226067560481/.
2025-06-18 12:27:01 - INFO - def scrape_events(): Keywords: ['bachata', 'dance', 'kizomba', 'merengue', 'salsa']: found in text for URL: https://www.facebook.com/events/1079226067560481/.
2025-06-18 12:27:01 - INFO - should_process_url: URL https://www.facebook.com/events/1861230087752141/ was last seen as relevant, processing it.
2025-06-18 12:27:04 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1861230087752141/ (10432 ms)
2025-06-18 12:27:25 - INFO - extract_event_text: extracted 4840 chars
2025-06-18 12:27:25 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1861230087752141/.
2025-06-18 12:27:25 - INFO - def scrape_events(): Keywords: ['bachata', 'dance', 'kizomba', 'merengue', 'salsa']: found in text for URL: https://www.facebook.com/events/1861230087752141/.
2025-06-18 12:27:25 - INFO - should_process_url: URL https://www.facebook.com/events/1179097320623502/ was last seen as relevant, processing it.
2025-06-18 12:27:29 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1179097320623502/ (13305 ms)
2025-06-18 12:27:51 - INFO - extract_event_text: extracted 3132 chars
2025-06-18 12:27:51 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1179097320623502/.
2025-06-18 12:27:51 - INFO - def scrape_events(): Keywords: ['dance', 'kizomba', 'urban kiz']: found in text for URL: https://www.facebook.com/events/1179097320623502/.
2025-06-18 12:27:51 - INFO - should_process_url: URL https://www.facebook.com/events/1029869435768837/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:27:54 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1029869435768837/ (12741 ms)
2025-06-18 12:28:15 - INFO - extract_event_text: extracted 3195 chars
2025-06-18 12:28:15 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1029869435768837/.
2025-06-18 12:28:15 - INFO - def scrape_events(): Keywords: ['dance', 'kizomba', 'urban kiz']: found in text for URL: https://www.facebook.com/events/1029869435768837/.
2025-06-18 12:28:15 - INFO - should_process_url: URL https://www.facebook.com/events/1743571267040445/ was last seen as relevant, processing it.
2025-06-18 12:28:19 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1743571267040445/ (14318 ms)
2025-06-18 12:28:43 - INFO - extract_event_text: extracted 5112 chars
2025-06-18 12:28:43 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1743571267040445/.
2025-06-18 12:28:43 - INFO - def scrape_events(): Keywords: ['bachata', 'dance', 'kizomba', 'merengue', 'salsa']: found in text for URL: https://www.facebook.com/events/1743571267040445/.
2025-06-18 12:28:43 - INFO - should_process_url: URL https://www.facebook.com/events/2637194793152555/ was last seen as relevant, processing it.
2025-06-18 12:28:47 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/2637194793152555/ (12484 ms)
2025-06-18 12:29:06 - INFO - extract_event_text: extracted 4881 chars
2025-06-18 12:29:06 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/2637194793152555/.
2025-06-18 12:29:06 - INFO - def scrape_events(): Keywords: ['bachata', 'dance', 'kizomba', 'merengue', 'salsa']: found in text for URL: https://www.facebook.com/events/2637194793152555/.
2025-06-18 12:29:06 - INFO - should_process_url: URL https://www.facebook.com/events/947213690692385/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:29:09 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/947213690692385/ (14547 ms)
2025-06-18 12:29:26 - INFO - extract_event_text: extracted 3143 chars
2025-06-18 12:29:26 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/947213690692385/.
2025-06-18 12:29:26 - INFO - def scrape_events(): Keywords: ['dance', 'kizomba', 'urban kiz']: found in text for URL: https://www.facebook.com/events/947213690692385/.
2025-06-18 12:29:26 - INFO - should_process_url: URL https://www.facebook.com/events/1293301738436581/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:29:31 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1293301738436581/ (12483 ms)
2025-06-18 12:29:47 - INFO - extract_event_text: extracted 3046 chars
2025-06-18 12:29:47 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1293301738436581/.
2025-06-18 12:29:47 - INFO - def scrape_events(): Keywords: ['dance', 'kizomba']: found in text for URL: https://www.facebook.com/events/1293301738436581/.
2025-06-18 12:29:47 - INFO - should_process_url: URL https://www.facebook.com/events/960236445839425/ was last seen as relevant, processing it.
2025-06-18 12:29:51 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/960236445839425/ (12829 ms)
2025-06-18 12:30:11 - INFO - extract_event_text: extracted 2955 chars
2025-06-18 12:30:11 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/960236445839425/.
2025-06-18 12:30:11 - INFO - def scrape_events(): Keywords: ['kizomba']: found in text for URL: https://www.facebook.com/events/960236445839425/.
2025-06-18 12:30:11 - INFO - should_process_url: URL https://www.facebook.com/events/1337760257449745/ was last seen as relevant, processing it.
2025-06-18 12:30:14 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1337760257449745/ (14512 ms)
2025-06-18 12:30:33 - INFO - extract_event_text: extracted 4855 chars
2025-06-18 12:30:33 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1337760257449745/.
2025-06-18 12:30:33 - INFO - def scrape_events(): Keywords: ['bachata', 'dance', 'kizomba', 'merengue', 'salsa']: found in text for URL: https://www.facebook.com/events/1337760257449745/.
2025-06-18 12:30:33 - INFO - should_process_url: URL https://www.facebook.com/events/3006474846197996/ was last seen as relevant, processing it.
2025-06-18 12:30:36 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/3006474846197996/ (12645 ms)
2025-06-18 12:30:58 - INFO - extract_event_text: extracted 5218 chars
2025-06-18 12:30:58 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/3006474846197996/.
2025-06-18 12:30:58 - INFO - def scrape_events(): Keywords: ['bachata', 'dance', 'kizomba', 'merengue', 'salsa']: found in text for URL: https://www.facebook.com/events/3006474846197996/.
2025-06-18 12:30:58 - INFO - should_process_url: URL https://www.facebook.com/events/1794066937801722/ was last seen as not relevant but hit_ratio (0.00) > 0.1 or crawl_try (1) ≤ 3, processing it.
2025-06-18 12:31:07 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1794066937801722/ (10086 ms)
2025-06-18 12:31:25 - INFO - extract_event_text: extracted 3131 chars
2025-06-18 12:31:25 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1794066937801722/.
2025-06-18 12:31:25 - INFO - def scrape_events(): Keywords: ['dance', 'kizomba', 'urban kiz']: found in text for URL: https://www.facebook.com/events/1794066937801722/.
2025-06-18 12:31:25 - INFO - should_process_url: URL https://www.facebook.com/events/372311028526699/ was last seen as relevant, processing it.
2025-06-18 12:31:28 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/372311028526699/ (10264 ms)
2025-06-18 12:31:45 - INFO - extract_event_text: extracted 3079 chars
2025-06-18 12:31:45 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/372311028526699/.
2025-06-18 12:31:45 - INFO - def scrape_events(): Keywords: ['dance', 'kizomba', 'urban kiz']: found in text for URL: https://www.facebook.com/events/372311028526699/.
2025-06-18 12:31:45 - INFO - should_process_url: URL https://www.facebook.com/events/1060779176049104/ was last seen as relevant, processing it.
2025-06-18 12:31:49 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1060779176049104/ (12315 ms)
2025-06-18 12:32:08 - INFO - extract_event_text: extracted 3277 chars
2025-06-18 12:32:08 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1060779176049104/.
2025-06-18 12:32:08 - INFO - def scrape_events(): Keywords: ['kizomba']: found in text for URL: https://www.facebook.com/events/1060779176049104/.
2025-06-18 12:32:14 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q= urban kiz&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:32:14 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q= urban kiz&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:32:19 - INFO - extract_event_links(): Found 5 links on https://www.facebook.com/search/events?q= urban kiz&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:32:19 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q= urban kiz&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 5 event_links

2025-06-18 12:32:19 - INFO - should_process_url: URL https://www.facebook.com/events/1184791909680061/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:32:23 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1184791909680061/ (10140 ms)
2025-06-18 12:32:42 - INFO - extract_event_text: extracted 4021 chars
2025-06-18 12:32:42 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1184791909680061/.
2025-06-18 12:32:42 - INFO - def scrape_events(): Keywords: ['dance', 'urban kiz']: found in text for URL: https://www.facebook.com/events/1184791909680061/.
2025-06-18 12:32:42 - INFO - should_process_url: URL https://www.facebook.com/events/3185065321631809/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:32:45 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/3185065321631809/ (10486 ms)
2025-06-18 12:33:01 - INFO - extract_event_text: extracted 4091 chars
2025-06-18 12:33:01 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/3185065321631809/.
2025-06-18 12:33:01 - INFO - def scrape_events(): Keywords: ['dance', 'urban kiz']: found in text for URL: https://www.facebook.com/events/3185065321631809/.
2025-06-18 12:33:01 - INFO - should_process_url: URL https://www.facebook.com/events/1334757257408713/ has never been seen before, processing it.
2025-06-18 12:33:05 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1334757257408713/ (11742 ms)
2025-06-18 12:33:23 - INFO - extract_event_text: extracted 3554 chars
2025-06-18 12:33:23 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1334757257408713/.
2025-06-18 12:33:23 - INFO - def scrape_events(): Keywords: ['dance', 'kizomba', 'semba']: found in text for URL: https://www.facebook.com/events/1334757257408713/.
2025-06-18 12:33:23 - INFO - should_process_url: URL https://www.facebook.com/events/1152065639712042/ was last seen as relevant, processing it.
2025-06-18 12:33:27 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1152065639712042/ (11508 ms)
2025-06-18 12:33:43 - INFO - extract_event_text: extracted 3629 chars
2025-06-18 12:33:43 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1152065639712042/.
2025-06-18 12:33:43 - INFO - def scrape_events(): Keywords: ['dance', 'kizomba', 'tango']: found in text for URL: https://www.facebook.com/events/1152065639712042/.
2025-06-18 12:33:45 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q= semba&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:33:45 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q= semba&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:33:52 - INFO - extract_event_links(): Found 0 links on https://www.facebook.com/search/events?q= semba&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:33:52 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q= semba&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 0 event_links

2025-06-18 12:33:52 - INFO - def scrape_events(): Extracted text from 18 events.
2025-06-18 12:33:53 - INFO - def scrape_events(): Extracted text data written to checkpoint/extracted_text.xlsx.
2025-06-18 12:33:53 - INFO - def driver_fb_search(): Extracted text based on search_url: https://www.facebook.com/search/events?q= semba&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9.
2025-06-18 12:33:53 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1079226067560481/
2025-06-18 12:33:53 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1079226067560481/.
2025-06-18 12:33:53 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1079226067560481/
2025-06-18 12:33:53 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:33:53 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:33:53 - INFO - query_llm(): Querying Mistral
2025-06-18 12:33:56 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:33:56 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "Victoria Latin Dance Association",
    "dance_style": "salsa, bachata, kizomba, merengue",
    "url": "",
    "event_type": "social dance",
    "event_name": "Sunday Sundown Social: Salsa Fire, Bachata Desire, Kizomba Inspire",
    "day_of_week": "Sunday",
    "start_date": "2025-07-06",
    "end_date": "2025-07-06",
    "start_time": "15:45",
    "end_time": "19:30",
    "price": "$5 for students (with valid ID), $10 general admission",
    "location": "Songhees Plaza (near the Johnson Street Bridge), 30 Esquimalt Rd, Victoria, BC V9A, Canada",
    "description": "Join us for a vibrant late afternoon of Latin dancing by the ocean! We’ll begin with a beginner-friendly lesson— no partner or experience needed. After the class, enjoy an open-air social featuring a dynamic blend of Salsa, Bachata, and Kizomba, with just a light touch of Merengue to round out the evening."
}]
```
2025-06-18 12:33:56 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1079226067560481/, 
Cleaned JSON ready for parsing:
[{
    "source": "Victoria Latin Dance Association",
    "dance_style": "salsa, bachata, kizomba, merengue",
    "url": "",
    "event_type": "social dance",
    "event_name": "Sunday Sundown Social: Salsa Fire, Bachata Desire, Kizomba Inspire",
    "day_of_week": "Sunday",
    "start_date": "2025-07-06",
    "end_date": "2025-07-06",
    "start_time": "15:45",
    "end_time": "19:30",
    "price": "$5 for students (with valid ID), $10 general admission",
    "location": "Songhees Plaza (near the Johnson Street Bridge), 30 Esquimalt Rd, Victoria, BC V9A, Canada",
    "description": "Join us for a vibrant late afternoon of Latin dancing by the ocean! We’ll begin with a beginner-friendly lesson— no partner or experience needed. After the class, enjoy an open-air social featuring a dynamic blend of Salsa, Bachata, and Kizomba, with just a light touch of Merengue to round out the evening."
}]
2025-06-18 12:33:56 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:33:57 - INFO - def clean_up_address(): Processing location 'Songhees Plaza (near the Johnson Street Bridge), 30 Esquimalt Rd, Victoria, BC V9A, Canada' (event_id: None)
2025-06-18 12:33:57 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:33:57 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1079226067560481/'
2025-06-18 12:33:57 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:33:57 - INFO - def process_llm_response: URL https://www.facebook.com/events/1079226067560481/ marked as relevant with events written to the database.
2025-06-18 12:33:57 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1079226067560481/.
2025-06-18 12:33:57 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1861230087752141/
2025-06-18 12:33:57 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1861230087752141/.
2025-06-18 12:33:57 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1861230087752141/
2025-06-18 12:33:57 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:33:57 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:33:57 - INFO - query_llm(): Querying Mistral
2025-06-18 12:34:01 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:34:01 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "Victoria Latin Dance Association",
        "dance_style": "salsa, bachata, kizomba, merengue",
        "url": "",
        "event_type": "social dance",
        "event_name": "Sunday Sundown Social: Salsa Fire, Bachata Desire, Kizomba Inspire",
        "day_of_week": "Sunday",
        "start_date": "2025-08-31",
        "end_date": "2025-08-31",
        "start_time": "15:45",
        "end_time": "19:30",
        "price": "$5 for students (with valid ID), $10 general admission",
        "location": "Songhees Plaza (near the Johnson Street Bridge), 30 Esquimalt Rd, Victoria, BC V9A, Canada",
        "description": "Join us for a vibrant late afternoon of Latin dancing by the ocean! We’ll begin with a beginner-friendly lesson— no partner or experience needed. After the class, enjoy an open-air social featuring a dynamic blend of Salsa, Bachata, and Kizomba, with just a light touch of Merengue to round out the evening."
    }
]
```
2025-06-18 12:34:01 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1861230087752141/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Victoria Latin Dance Association",
        "dance_style": "salsa, bachata, kizomba, merengue",
        "url": "",
        "event_type": "social dance",
        "event_name": "Sunday Sundown Social: Salsa Fire, Bachata Desire, Kizomba Inspire",
        "day_of_week": "Sunday",
        "start_date": "2025-08-31",
        "end_date": "2025-08-31",
        "start_time": "15:45",
        "end_time": "19:30",
        "price": "$5 for students (with valid ID), $10 general admission",
        "location": "Songhees Plaza (near the Johnson Street Bridge), 30 Esquimalt Rd, Victoria, BC V9A, Canada",
        "description": "Join us for a vibrant late afternoon of Latin dancing by the ocean! We’ll begin with a beginner-friendly lesson— no partner or experience needed. After the class, enjoy an open-air social featuring a dynamic blend of Salsa, Bachata, and Kizomba, with just a light touch of Merengue to round out the evening."
    }
]
2025-06-18 12:34:01 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:34:01 - INFO - def clean_up_address(): Processing location 'Songhees Plaza (near the Johnson Street Bridge), 30 Esquimalt Rd, Victoria, BC V9A, Canada' (event_id: None)
2025-06-18 12:34:01 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:34:01 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1861230087752141/'
2025-06-18 12:34:01 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:34:01 - INFO - def process_llm_response: URL https://www.facebook.com/events/1861230087752141/ marked as relevant with events written to the database.
2025-06-18 12:34:01 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1861230087752141/.
2025-06-18 12:34:01 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1179097320623502/
2025-06-18 12:34:01 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1179097320623502/.
2025-06-18 12:34:01 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1179097320623502/
2025-06-18 12:34:01 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:34:01 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:34:01 - INFO - query_llm(): Querying Mistral
2025-06-18 12:34:04 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:34:04 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "urban kiz",
    "url": "",
    "event_type": "social dance",
    "event_name": "Victoria Kizomba Socials: Spring Series",
    "day_of_week": "Saturday",
    "start_date": "2025-05-10",
    "end_date": "2025-05-10",
    "start_time": "20:30",
    "end_time": "23:30",
    "price": "$10",
    "location": "Ukrainian Cultural Centre - Victoria, BC 3277 Douglas St, Saanich, BC V8Z 3K9, Canada",
    "description": "Join the island vibe this Saturday. Great music, great energy, great atmosphere. Urban Kiz class starts at 8:30pm, followed by the night social. Cover: $10, cash only. 'Dance with your heart. your feet will follow'."
}]
```
2025-06-18 12:34:04 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1179097320623502/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "urban kiz",
    "url": "",
    "event_type": "social dance",
    "event_name": "Victoria Kizomba Socials: Spring Series",
    "day_of_week": "Saturday",
    "start_date": "2025-05-10",
    "end_date": "2025-05-10",
    "start_time": "20:30",
    "end_time": "23:30",
    "price": "$10",
    "location": "Ukrainian Cultural Centre - Victoria, BC 3277 Douglas St, Saanich, BC V8Z 3K9, Canada",
    "description": "Join the island vibe this Saturday. Great music, great energy, great atmosphere. Urban Kiz class starts at 8:30pm, followed by the night social. Cover: $10, cash only. 'Dance with your heart. your feet will follow'."
}]
2025-06-18 12:34:04 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:34:04 - INFO - def clean_up_address(): Processing location 'Ukrainian Cultural Centre - Victoria, BC 3277 Douglas St, Saanich, BC V8Z 3K9, Canada' (event_id: None)
2025-06-18 12:34:04 - INFO - def clean_up_address(): Updated event None with address_id 4317 using DB match
2025-06-18 12:34:04 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:34:04 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1179097320623502/'
2025-06-18 12:34:04 - INFO - def process_llm_response: URL https://www.facebook.com/events/1179097320623502/ marked as relevant with events written to the database.
2025-06-18 12:34:04 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1179097320623502/.
2025-06-18 12:34:04 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1029869435768837/
2025-06-18 12:34:04 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1029869435768837/.
2025-06-18 12:34:04 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1029869435768837/
2025-06-18 12:34:04 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:34:04 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:34:04 - INFO - query_llm(): Querying Mistral
2025-06-18 12:34:08 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:34:08 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "Victoria Kizomba Lovers Group",
        "dance_style": "urban kiz",
        "url": "",
        "event_type": "social dance",
        "event_name": "Victoria Kizomba Socials: Winter Series",
        "day_of_week": "Saturday",
        "start_date": "2025-03-22",
        "end_date": "2025-03-22",
        "start_time": "20:30",
        "end_time": null,
        "price": "$10",
        "location": "Ukrainian Cultural Centre - Victoria, BC, 3277 Douglas St, Saanich, BC V8Z 3K9, Canada",
        "description": "This event has been cancelled. Another Season, another series of kizomba events coming up. Join the island vibe this Saturday. Great music, great energy, great atmosphere. Urban Kiz class starts at 8:30pm, followed by the night social. Cover: $10, cash only. 'Dance with your heart. your feet will follow.'"
    }
]
```
2025-06-18 12:34:08 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1029869435768837/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Victoria Kizomba Lovers Group",
        "dance_style": "urban kiz",
        "url": "",
        "event_type": "social dance",
        "event_name": "Victoria Kizomba Socials: Winter Series",
        "day_of_week": "Saturday",
        "start_date": "2025-03-22",
        "end_date": "2025-03-22",
        "start_time": "20:30",
        "end_time": null,
        "price": "$10",
        "location": "Ukrainian Cultural Centre - Victoria, BC, 3277 Douglas St, Saanich, BC V8Z 3K9, Canada",
        "description": "This event has been cancelled. Another Season, another series of kizomba events coming up. Join the island vibe this Saturday. Great music, great energy, great atmosphere. Urban Kiz class starts at 8:30pm, followed by the night social. Cover: $10, cash only. 'Dance with your heart. your feet will follow.'"
    }
]
2025-06-18 12:34:08 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:34:08 - INFO - def clean_up_address(): Processing location 'Ukrainian Cultural Centre - Victoria, BC, 3277 Douglas St, Saanich, BC V8Z 3K9, Canada' (event_id: None)
2025-06-18 12:34:08 - INFO - def clean_up_address(): Updated event None with address_id 4317 using DB match
2025-06-18 12:34:08 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:34:08 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1029869435768837/'
2025-06-18 12:34:08 - INFO - def process_llm_response: URL https://www.facebook.com/events/1029869435768837/ marked as relevant with events written to the database.
2025-06-18 12:34:08 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1029869435768837/.
2025-06-18 12:34:08 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1743571267040445/
2025-06-18 12:34:08 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1743571267040445/.
2025-06-18 12:34:08 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1743571267040445/
2025-06-18 12:34:08 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:34:08 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:34:08 - INFO - query_llm(): Querying Mistral
2025-06-18 12:34:12 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:34:12 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "Victoria Latin Dance Association",
    "dance_style": "salsa, bachata, kizomba, merengue",
    "url": "",
    "event_type": "social dance",
    "event_name": "Sunday Sundown Social: Salsa Fire, Bachata Desire, Kizomba Inspire",
    "day_of_week": "Sunday",
    "start_date": "2025-06-22",
    "end_date": "2025-06-22",
    "start_time": "15:45",
    "end_time": "19:30",
    "price": "$5 for students (with valid ID), $10 general admission",
    "location": "Songhees Plaza (near the Johnson Street Bridge), Victoria, British Columbia",
    "description": "Join us for a vibrant late afternoon of Latin dancing by the ocean! We’ll begin with a beginner-friendly lesson— no partner or experience needed. After the class, enjoy an open-air social featuring a dynamic blend of Salsa, Bachata, and Kizomba, with just a light touch of Merengue to round out the evening. This is a beautiful, inclusive, and supportive community where new friendships are made and everyone belongs. This year, we’re excited to offer a 10 x 17.6 ft sun tent to provide shade and help keep you cool while you relax between dances."
}]
```
2025-06-18 12:34:12 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1743571267040445/, 
Cleaned JSON ready for parsing:
[{
    "source": "Victoria Latin Dance Association",
    "dance_style": "salsa, bachata, kizomba, merengue",
    "url": "",
    "event_type": "social dance",
    "event_name": "Sunday Sundown Social: Salsa Fire, Bachata Desire, Kizomba Inspire",
    "day_of_week": "Sunday",
    "start_date": "2025-06-22",
    "end_date": "2025-06-22",
    "start_time": "15:45",
    "end_time": "19:30",
    "price": "$5 for students (with valid ID), $10 general admission",
    "location": "Songhees Plaza (near the Johnson Street Bridge), Victoria, British Columbia",
    "description": "Join us for a vibrant late afternoon of Latin dancing by the ocean! We’ll begin with a beginner-friendly lesson— no partner or experience needed. After the class, enjoy an open-air social featuring a dynamic blend of Salsa, Bachata, and Kizomba, with just a light touch of Merengue to round out the evening. This is a beautiful, inclusive, and supportive community where new friendships are made and everyone belongs. This year, we’re excited to offer a 10 x 17.6 ft sun tent to provide shade and help keep you cool while you relax between dances."
}]
2025-06-18 12:34:12 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:34:12 - INFO - def clean_up_address(): Processing location 'Songhees Plaza (near the Johnson Street Bridge), Victoria, British Columbia' (event_id: None)
2025-06-18 12:34:12 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:34:12 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1743571267040445/'
2025-06-18 12:34:12 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:34:12 - INFO - def process_llm_response: URL https://www.facebook.com/events/1743571267040445/ marked as relevant with events written to the database.
2025-06-18 12:34:12 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1743571267040445/.
2025-06-18 12:34:12 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/2637194793152555/
2025-06-18 12:34:12 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/2637194793152555/.
2025-06-18 12:34:12 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/2637194793152555/
2025-06-18 12:34:12 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:34:12 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:34:12 - INFO - query_llm(): Querying Mistral
2025-06-18 12:34:13 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-06-18 12:34:13 - WARNING - query_llm(): Mistral query failed: API rejection occurred: Status 429
{"object":"rejection","message":"Service tier capacity exceeded for this model.","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 12:34:13 - INFO - query_llm(): Falling back to OpenAI
2025-06-18 12:34:31 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:34:31 - INFO - query_llm(): OpenAI response received: [{
    "source":"Victoria Latin Dance Association",
    "dance_style":"salsa, bachata, kizomba, merengue",
    "url":"",
    "event_type":"social dance",
    "event_name":"Sunday Sundown Social: Salsa Fire, Bachata Desire, Kizomba Inspire",
    "day_of_week":"Sunday",
    "start_date":"2025-06-29",
    "end_date":"2025-06-29",
    "start_time":"15:45",
    "end_time":"19:30",
    "price":"$5 students, $10 general (cash only)",
    "location":"Songhees Plaza (near the Johnson Street Bridge), 30 Esquimalt Rd, Victoria, BC V9A, Canada",
    "description":"Beginner-friendly Intro to Salsa Rueda lesson followed by open-air social featuring Salsa, Bachata, Kizomba, and a bit of Merengue by the ocean at Songhees Plaza."
}]
2025-06-18 12:34:31 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/2637194793152555/, 
Cleaned JSON ready for parsing:
[{
    "source":"Victoria Latin Dance Association",
    "dance_style":"salsa, bachata, kizomba, merengue",
    "url":"",
    "event_type":"social dance",
    "event_name":"Sunday Sundown Social: Salsa Fire, Bachata Desire, Kizomba Inspire",
    "day_of_week":"Sunday",
    "start_date":"2025-06-29",
    "end_date":"2025-06-29",
    "start_time":"15:45",
    "end_time":"19:30",
    "price":"$5 students, $10 general (cash only)",
    "location":"Songhees Plaza (near the Johnson Street Bridge), 30 Esquimalt Rd, Victoria, BC V9A, Canada",
    "description":"Beginner-friendly Intro to Salsa Rueda lesson followed by open-air social featuring Salsa, Bachata, Kizomba, and a bit of Merengue by the ocean at Songhees Plaza."
}]
2025-06-18 12:34:31 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:34:31 - INFO - def clean_up_address(): Processing location 'Songhees Plaza (near the Johnson Street Bridge), 30 Esquimalt Rd, Victoria, BC V9A, Canada' (event_id: None)
2025-06-18 12:34:31 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:34:31 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/2637194793152555/'
2025-06-18 12:34:31 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:34:31 - INFO - def process_llm_response: URL https://www.facebook.com/events/2637194793152555/ marked as relevant with events written to the database.
2025-06-18 12:34:31 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/2637194793152555/.
2025-06-18 12:34:31 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/947213690692385/
2025-06-18 12:34:31 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/947213690692385/.
2025-06-18 12:34:31 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/947213690692385/
2025-06-18 12:34:31 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:34:31 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:34:31 - INFO - query_llm(): Querying Mistral
2025-06-18 12:34:34 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:34:34 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "urban kiz",
        "url": "",
        "event_type": "social dance",
        "event_name": "Victoria Kizomba Socials: Spring Series",
        "day_of_week": "Saturday",
        "start_date": "2025-05-24",
        "end_date": "2025-05-24",
        "start_time": "20:30",
        "end_time": "23:30",
        "price": "$10",
        "location": "Ukrainian Cultural Centre - Victoria, BC, 3277 Douglas St, Saanich, BC V8Z 3K9, Canada",
        "description": "Join the island vibe this Saturday. Great music, great energy, great atmosphere. Urban Kiz class starts at 8:30pm, followed by the night social."
    }
]
```
2025-06-18 12:34:34 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/947213690692385/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "urban kiz",
        "url": "",
        "event_type": "social dance",
        "event_name": "Victoria Kizomba Socials: Spring Series",
        "day_of_week": "Saturday",
        "start_date": "2025-05-24",
        "end_date": "2025-05-24",
        "start_time": "20:30",
        "end_time": "23:30",
        "price": "$10",
        "location": "Ukrainian Cultural Centre - Victoria, BC, 3277 Douglas St, Saanich, BC V8Z 3K9, Canada",
        "description": "Join the island vibe this Saturday. Great music, great energy, great atmosphere. Urban Kiz class starts at 8:30pm, followed by the night social."
    }
]
2025-06-18 12:34:34 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:34:34 - INFO - def clean_up_address(): Processing location 'Ukrainian Cultural Centre - Victoria, BC, 3277 Douglas St, Saanich, BC V8Z 3K9, Canada' (event_id: None)
2025-06-18 12:34:34 - INFO - def clean_up_address(): Updated event None with address_id 4317 using DB match
2025-06-18 12:34:34 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:34:34 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/947213690692385/'
2025-06-18 12:34:34 - INFO - def process_llm_response: URL https://www.facebook.com/events/947213690692385/ marked as relevant with events written to the database.
2025-06-18 12:34:34 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/947213690692385/.
2025-06-18 12:34:34 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1293301738436581/
2025-06-18 12:34:34 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1293301738436581/.
2025-06-18 12:34:34 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1293301738436581/
2025-06-18 12:34:34 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:34:34 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:34:34 - INFO - query_llm(): Querying Mistral
2025-06-18 12:34:37 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:34:37 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "kizomba",
        "url": "",
        "event_type": "social dance",
        "event_name": "Kizomba Sundown Party: Free of charge",
        "day_of_week": "Sunday",
        "start_date": "2025-04-06",
        "end_date": "2025-04-06",
        "start_time": "17:00",
        "end_time": null,
        "price": "Free",
        "location": "Method Studio - Victoria BC, 841 Fisgard Street, Victoria",
        "description": "Pre-VIKFest party. Bring snack and drink. Expect great music, great energy, great atmosphere. 'Dance with your heart. your feet will follow'"
    }
]
```
2025-06-18 12:34:37 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1293301738436581/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "kizomba",
        "url": "",
        "event_type": "social dance",
        "event_name": "Kizomba Sundown Party: Free of charge",
        "day_of_week": "Sunday",
        "start_date": "2025-04-06",
        "end_date": "2025-04-06",
        "start_time": "17:00",
        "end_time": null,
        "price": "Free",
        "location": "Method Studio - Victoria BC, 841 Fisgard Street, Victoria",
        "description": "Pre-VIKFest party. Bring snack and drink. Expect great music, great energy, great atmosphere. 'Dance with your heart. your feet will follow'"
    }
]
2025-06-18 12:34:37 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:34:37 - INFO - def clean_up_address(): Processing location 'Method Studio - Victoria BC, 841 Fisgard Street, Victoria' (event_id: None)
2025-06-18 12:34:37 - INFO - def clean_up_address(): Updated event None with address_id 4948 using DB match
2025-06-18 12:34:37 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:34:37 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1293301738436581/'
2025-06-18 12:34:37 - INFO - def process_llm_response: URL https://www.facebook.com/events/1293301738436581/ marked as relevant with events written to the database.
2025-06-18 12:34:37 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1293301738436581/.
2025-06-18 12:34:37 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/960236445839425/
2025-06-18 12:34:37 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/960236445839425/.
2025-06-18 12:34:37 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/960236445839425/
2025-06-18 12:34:37 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:34:37 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:34:37 - INFO - query_llm(): Querying Mistral
2025-06-18 12:34:41 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:34:41 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "kizomba, urbankiz",
    "url": "",
    "event_type": "social dance",
    "event_name": "Kizomba/UrbanKiz at Clover",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "18:00",
    "end_time": "21:00",
    "price": "",
    "location": "Clover Pt, Victoria, BC V8S, Canada",
    "description": "Come join us for our first time dancing at Clover Point! There will be no lesson beforehand and this is super casual. Just a bunch of friends hanging out and dancing. Bring snacks, something to drink, blankets, warm clothes (as it is typically cooler by the ocean). There isn't a lot of parking at Clover Point but you can park along Dallas Rd and just walk down. Feel free to invite friends and family. Hope to see you all there!"
}]
```
2025-06-18 12:34:41 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/960236445839425/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "kizomba, urbankiz",
    "url": "",
    "event_type": "social dance",
    "event_name": "Kizomba/UrbanKiz at Clover",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "18:00",
    "end_time": "21:00",
    "price": "",
    "location": "Clover Pt, Victoria, BC V8S, Canada",
    "description": "Come join us for our first time dancing at Clover Point! There will be no lesson beforehand and this is super casual. Just a bunch of friends hanging out and dancing. Bring snacks, something to drink, blankets, warm clothes (as it is typically cooler by the ocean). There isn't a lot of parking at Clover Point but you can park along Dallas Rd and just walk down. Feel free to invite friends and family. Hope to see you all there!"
}]
2025-06-18 12:34:41 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:34:41 - INFO - def clean_up_address(): Processing location 'Clover Pt, Victoria, BC V8S, Canada' (event_id: None)
2025-06-18 12:34:41 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:34:41 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/960236445839425/'
2025-06-18 12:34:41 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:34:41 - INFO - def process_llm_response: URL https://www.facebook.com/events/960236445839425/ marked as relevant with events written to the database.
2025-06-18 12:34:41 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/960236445839425/.
2025-06-18 12:34:41 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1337760257449745/
2025-06-18 12:34:41 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1337760257449745/.
2025-06-18 12:34:41 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1337760257449745/
2025-06-18 12:34:41 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:34:41 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:34:41 - INFO - query_llm(): Querying Mistral
2025-06-18 12:34:47 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:34:47 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "salsa, bachata, kizomba, merengue",
        "url": "",
        "event_type": "social dance",
        "event_name": "Sunday Sundown Social: Salsa Fire, Bachata Desire, Kizomba Inspire",
        "day_of_week": "Sunday",
        "start_date": "2025-08-10",
        "end_date": "2025-08-10",
        "start_time": "15:45",
        "end_time": "19:30",
        "price": "$5 for students (with valid ID), $10 general admission",
        "location": "Songhees Plaza (near the Johnson Street Bridge), 30 Esquimalt Rd, Victoria, BC V9A, Canada",
        "description": "Join us for a vibrant late afternoon of Latin dancing by the ocean! We’ll begin with a beginner-friendly lesson— no partner or experience needed. After the class, enjoy an open-air social featuring a dynamic blend of Salsa, Bachata, and Kizomba, with just a light touch of Merengue to round out the evening."
    }
]
```
2025-06-18 12:34:47 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1337760257449745/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "salsa, bachata, kizomba, merengue",
        "url": "",
        "event_type": "social dance",
        "event_name": "Sunday Sundown Social: Salsa Fire, Bachata Desire, Kizomba Inspire",
        "day_of_week": "Sunday",
        "start_date": "2025-08-10",
        "end_date": "2025-08-10",
        "start_time": "15:45",
        "end_time": "19:30",
        "price": "$5 for students (with valid ID), $10 general admission",
        "location": "Songhees Plaza (near the Johnson Street Bridge), 30 Esquimalt Rd, Victoria, BC V9A, Canada",
        "description": "Join us for a vibrant late afternoon of Latin dancing by the ocean! We’ll begin with a beginner-friendly lesson— no partner or experience needed. After the class, enjoy an open-air social featuring a dynamic blend of Salsa, Bachata, and Kizomba, with just a light touch of Merengue to round out the evening."
    }
]
2025-06-18 12:34:47 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:34:47 - INFO - def clean_up_address(): Processing location 'Songhees Plaza (near the Johnson Street Bridge), 30 Esquimalt Rd, Victoria, BC V9A, Canada' (event_id: None)
2025-06-18 12:34:47 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:34:47 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1337760257449745/'
2025-06-18 12:34:47 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:34:47 - INFO - def process_llm_response: URL https://www.facebook.com/events/1337760257449745/ marked as relevant with events written to the database.
2025-06-18 12:34:47 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1337760257449745/.
2025-06-18 12:34:47 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/3006474846197996/
2025-06-18 12:34:47 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/3006474846197996/.
2025-06-18 12:34:47 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/3006474846197996/
2025-06-18 12:34:47 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:34:47 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:34:47 - INFO - query_llm(): Querying Mistral
2025-06-18 12:34:47 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-06-18 12:34:47 - WARNING - query_llm(): Mistral query failed: API rejection occurred: Status 429
{"object":"rejection","message":"Service tier capacity exceeded for this model.","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 12:34:47 - INFO - query_llm(): Falling back to OpenAI
2025-06-18 12:34:59 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:34:59 - INFO - query_llm(): OpenAI response received: [{
    "source": "Victoria Latin Dance Association Facebook",
    "dance_style": "salsa, bachata, kizomba, merengue",
    "url": "",
    "event_type": "social dance",
    "event_name": "Sunday Sundown Social: Salsa Fire, Bachata Desire, Kizomba Inspire",
    "day_of_week": "Sunday",
    "start_date": "2025-07-27",
    "end_date": "2025-07-27",
    "start_time": "15:45",
    "end_time": "19:30",
    "price": "$5 student; $10 general",
    "location": "Songhees Plaza (near the Johnson Street Bridge), 30 Esquimalt Rd, Victoria, BC V9A, Canada",
    "description": "Beginner-friendly lesson followed by an open-air social featuring Salsa, Bachata, and Kizomba with light Merengue; bring water, sun protection; cash cover charge."
}]
2025-06-18 12:34:59 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/3006474846197996/, 
Cleaned JSON ready for parsing:
[{
    "source": "Victoria Latin Dance Association Facebook",
    "dance_style": "salsa, bachata, kizomba, merengue",
    "url": "",
    "event_type": "social dance",
    "event_name": "Sunday Sundown Social: Salsa Fire, Bachata Desire, Kizomba Inspire",
    "day_of_week": "Sunday",
    "start_date": "2025-07-27",
    "end_date": "2025-07-27",
    "start_time": "15:45",
    "end_time": "19:30",
    "price": "$5 student; $10 general",
    "location": "Songhees Plaza (near the Johnson Street Bridge), 30 Esquimalt Rd, Victoria, BC V9A, Canada",
    "description": "Beginner-friendly lesson followed by an open-air social featuring Salsa, Bachata, and Kizomba with light Merengue; bring water, sun protection; cash cover charge."
}]
2025-06-18 12:34:59 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:34:59 - INFO - def clean_up_address(): Processing location 'Songhees Plaza (near the Johnson Street Bridge), 30 Esquimalt Rd, Victoria, BC V9A, Canada' (event_id: None)
2025-06-18 12:34:59 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:34:59 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/3006474846197996/'
2025-06-18 12:34:59 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:34:59 - INFO - def process_llm_response: URL https://www.facebook.com/events/3006474846197996/ marked as relevant with events written to the database.
2025-06-18 12:34:59 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/3006474846197996/.
2025-06-18 12:34:59 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1794066937801722/
2025-06-18 12:34:59 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1794066937801722/.
2025-06-18 12:34:59 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1794066937801722/
2025-06-18 12:34:59 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:34:59 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:34:59 - INFO - query_llm(): Querying Mistral
2025-06-18 12:35:03 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:35:03 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "urban kiz",
        "url": "",
        "event_type": "social dance",
        "event_name": "Victoria Kizomba Socials: Winter Series",
        "day_of_week": "Saturday",
        "start_date": "2025-03-08",
        "end_date": "2025-03-08",
        "start_time": "20:30",
        "end_time": "23:30",
        "price": "$10",
        "location": "Ukrainian Cultural Centre - Victoria, BC 3277 Douglas St, Saanich, BC V8Z 3K9, Canada",
        "description": "Join the island vibe this Saturday. Great music, great energy, great atmosphere. Urban Kiz class starts at 8:30pm, followed by the night social."
    }
]
```
2025-06-18 12:35:03 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1794066937801722/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "urban kiz",
        "url": "",
        "event_type": "social dance",
        "event_name": "Victoria Kizomba Socials: Winter Series",
        "day_of_week": "Saturday",
        "start_date": "2025-03-08",
        "end_date": "2025-03-08",
        "start_time": "20:30",
        "end_time": "23:30",
        "price": "$10",
        "location": "Ukrainian Cultural Centre - Victoria, BC 3277 Douglas St, Saanich, BC V8Z 3K9, Canada",
        "description": "Join the island vibe this Saturday. Great music, great energy, great atmosphere. Urban Kiz class starts at 8:30pm, followed by the night social."
    }
]
2025-06-18 12:35:03 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:35:03 - INFO - def clean_up_address(): Processing location 'Ukrainian Cultural Centre - Victoria, BC 3277 Douglas St, Saanich, BC V8Z 3K9, Canada' (event_id: None)
2025-06-18 12:35:03 - INFO - def clean_up_address(): Updated event None with address_id 4317 using DB match
2025-06-18 12:35:03 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:35:03 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1794066937801722/'
2025-06-18 12:35:03 - INFO - def process_llm_response: URL https://www.facebook.com/events/1794066937801722/ marked as relevant with events written to the database.
2025-06-18 12:35:03 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1794066937801722/.
2025-06-18 12:35:03 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/372311028526699/
2025-06-18 12:35:03 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/372311028526699/.
2025-06-18 12:35:03 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/372311028526699/
2025-06-18 12:35:03 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:35:03 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:35:03 - INFO - query_llm(): Querying Mistral
2025-06-18 12:35:07 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:35:07 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "urban kiz",
    "url": "",
    "event_type": "social dance",
    "event_name": "Victoria Kizomba Social: Fall Series",
    "day_of_week": "Saturday",
    "start_date": "2023-12-09",
    "end_date": "2023-12-09",
    "start_time": "20:30",
    "end_time": "23:30",
    "price": "$10",
    "location": "Ukrainian Cultural Centre, 3277 Douglas St, Saanich, BC V8Z 3K9, Canada",
    "description": "Another Season, another series of kizomba events coming up. Join the island vibe this Saturday. Great music, great energy, great atmosphere. Urban Kiz class starts at 8:30pm, followed by the night social. Cover: $10, cash only. 'Dance with your heart. your feet will follow'"
}]
```
2025-06-18 12:35:07 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/372311028526699/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "urban kiz",
    "url": "",
    "event_type": "social dance",
    "event_name": "Victoria Kizomba Social: Fall Series",
    "day_of_week": "Saturday",
    "start_date": "2023-12-09",
    "end_date": "2023-12-09",
    "start_time": "20:30",
    "end_time": "23:30",
    "price": "$10",
    "location": "Ukrainian Cultural Centre, 3277 Douglas St, Saanich, BC V8Z 3K9, Canada",
    "description": "Another Season, another series of kizomba events coming up. Join the island vibe this Saturday. Great music, great energy, great atmosphere. Urban Kiz class starts at 8:30pm, followed by the night social. Cover: $10, cash only. 'Dance with your heart. your feet will follow'"
}]
2025-06-18 12:35:07 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:35:07 - INFO - def clean_up_address(): Processing location 'Ukrainian Cultural Centre, 3277 Douglas St, Saanich, BC V8Z 3K9, Canada' (event_id: None)
2025-06-18 12:35:07 - INFO - def clean_up_address(): Updated event None with address_id 4317 using DB match
2025-06-18 12:35:07 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:35:07 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/372311028526699/'
2025-06-18 12:35:07 - INFO - def process_llm_response: URL https://www.facebook.com/events/372311028526699/ marked as relevant with events written to the database.
2025-06-18 12:35:07 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/372311028526699/.
2025-06-18 12:35:07 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1060779176049104/
2025-06-18 12:35:07 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1060779176049104/.
2025-06-18 12:35:07 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1060779176049104/
2025-06-18 12:35:07 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:35:07 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:35:07 - INFO - query_llm(): Querying Mistral
2025-06-18 12:35:11 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:35:11 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "kizomba, urbankiz",
    "url": "",
    "event_type": "class",
    "event_name": "Kizomba Practica Thursdays: Fall Series",
    "day_of_week": "Thursday",
    "start_date": "2025-10-02",
    "end_date": "2025-10-02",
    "start_time": "19:30",
    "end_time": "22:30",
    "price": "$10-$15",
    "location": "Ukrainian Cultural Centre, 3277 Douglas St, Saanich, BC V8Z 3K9, Canada",
    "description": "Join us every Thursday for Kizomba/Urbankiz classes. Intermediate 7:30PM-8:15pm Beginner 8:15pm-9:00pm Practica until 10:30pm Class only: $10 Class & Practica: $15 or $10 for university students w/ID Practice only $10 Classes will be provided by your local Instructor (David Lamine) and assistants (Robyn, Becky) and occasionally by some out of town and International Instructors."
}]
```
2025-06-18 12:35:11 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1060779176049104/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "kizomba, urbankiz",
    "url": "",
    "event_type": "class",
    "event_name": "Kizomba Practica Thursdays: Fall Series",
    "day_of_week": "Thursday",
    "start_date": "2025-10-02",
    "end_date": "2025-10-02",
    "start_time": "19:30",
    "end_time": "22:30",
    "price": "$10-$15",
    "location": "Ukrainian Cultural Centre, 3277 Douglas St, Saanich, BC V8Z 3K9, Canada",
    "description": "Join us every Thursday for Kizomba/Urbankiz classes. Intermediate 7:30PM-8:15pm Beginner 8:15pm-9:00pm Practica until 10:30pm Class only: $10 Class & Practica: $15 or $10 for university students w/ID Practice only $10 Classes will be provided by your local Instructor (David Lamine) and assistants (Robyn, Becky) and occasionally by some out of town and International Instructors."
}]
2025-06-18 12:35:11 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:35:11 - INFO - def clean_up_address(): Processing location 'Ukrainian Cultural Centre, 3277 Douglas St, Saanich, BC V8Z 3K9, Canada' (event_id: None)
2025-06-18 12:35:11 - INFO - def clean_up_address(): Updated event None with address_id 4317 using DB match
2025-06-18 12:35:11 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:35:11 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1060779176049104/'
2025-06-18 12:35:11 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:35:11 - INFO - def process_llm_response: URL https://www.facebook.com/events/1060779176049104/ marked as relevant with events written to the database.
2025-06-18 12:35:11 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1060779176049104/.
2025-06-18 12:35:11 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1184791909680061/
2025-06-18 12:35:11 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1184791909680061/.
2025-06-18 12:35:11 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1184791909680061/
2025-06-18 12:35:11 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:35:11 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:35:11 - INFO - query_llm(): Querying Mistral
2025-06-18 12:35:14 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:35:14 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "urban kiz",
    "url": "",
    "event_type": "workshop",
    "event_name": "Urban Kiz Workshop with Mannie",
    "day_of_week": "Thursday",
    "start_date": "2025-03-13",
    "end_date": "2025-03-13",
    "start_time": "19:30",
    "end_time": "23:00",
    "price": "$80",
    "location": "Ukrainian Cultural Centre, 3277 Douglas St, Saanich, BC V8Z 3K9, Canada",
    "description": "Join us in welcoming Mannie for his first time to Victoria! Mannie was born in Zimbabwe and has lived in Manchester, London, San Francisco, NYC and currently in Dallas, Texas. He has a passion for music, dance and performance. His classes emphasize precision, fluidity, and personal expression, ensuring that students not only master choreography but also understand the artistry behind it. The workshop will focus on musicality, expression, connection and communication with your partner. This is part of a series, with the next event on Saturday, March 15th at Medicine Moves Studio."
}]
```
2025-06-18 12:35:14 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1184791909680061/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "urban kiz",
    "url": "",
    "event_type": "workshop",
    "event_name": "Urban Kiz Workshop with Mannie",
    "day_of_week": "Thursday",
    "start_date": "2025-03-13",
    "end_date": "2025-03-13",
    "start_time": "19:30",
    "end_time": "23:00",
    "price": "$80",
    "location": "Ukrainian Cultural Centre, 3277 Douglas St, Saanich, BC V8Z 3K9, Canada",
    "description": "Join us in welcoming Mannie for his first time to Victoria! Mannie was born in Zimbabwe and has lived in Manchester, London, San Francisco, NYC and currently in Dallas, Texas. He has a passion for music, dance and performance. His classes emphasize precision, fluidity, and personal expression, ensuring that students not only master choreography but also understand the artistry behind it. The workshop will focus on musicality, expression, connection and communication with your partner. This is part of a series, with the next event on Saturday, March 15th at Medicine Moves Studio."
}]
2025-06-18 12:35:14 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:35:14 - INFO - def clean_up_address(): Processing location 'Ukrainian Cultural Centre, 3277 Douglas St, Saanich, BC V8Z 3K9, Canada' (event_id: None)
2025-06-18 12:35:14 - INFO - def clean_up_address(): Updated event None with address_id 4317 using DB match
2025-06-18 12:35:14 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:35:14 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1184791909680061/'
2025-06-18 12:35:14 - INFO - def process_llm_response: URL https://www.facebook.com/events/1184791909680061/ marked as relevant with events written to the database.
2025-06-18 12:35:14 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1184791909680061/.
2025-06-18 12:35:14 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/3185065321631809/
2025-06-18 12:35:14 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/3185065321631809/.
2025-06-18 12:35:14 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/3185065321631809/
2025-06-18 12:35:14 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:35:14 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:35:14 - INFO - query_llm(): Querying Mistral
2025-06-18 12:35:18 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:35:18 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "urban kiz",
    "url": "",
    "event_type": "workshop",
    "event_name": "Urban Kiz Workshop with Mannie",
    "day_of_week": "Saturday",
    "start_date": "2025-03-15",
    "end_date": "2025-03-15",
    "start_time": "20:00",
    "end_time": "00:00",
    "price": "$80",
    "location": "Medicine Moves Studio 841 Fisgard St. Victoria, BC",
    "description": "Join us in welcoming Mannie for his first time to Victoria! This workshop will focus on musicality, expression, connection, and communication with your partner. The event includes 4 hours of workshops in total, with social dancing from 10:00pm-12:00am. The price includes both Thursday & Saturday workshops."
}]
```
2025-06-18 12:35:18 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/3185065321631809/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "urban kiz",
    "url": "",
    "event_type": "workshop",
    "event_name": "Urban Kiz Workshop with Mannie",
    "day_of_week": "Saturday",
    "start_date": "2025-03-15",
    "end_date": "2025-03-15",
    "start_time": "20:00",
    "end_time": "00:00",
    "price": "$80",
    "location": "Medicine Moves Studio 841 Fisgard St. Victoria, BC",
    "description": "Join us in welcoming Mannie for his first time to Victoria! This workshop will focus on musicality, expression, connection, and communication with your partner. The event includes 4 hours of workshops in total, with social dancing from 10:00pm-12:00am. The price includes both Thursday & Saturday workshops."
}]
2025-06-18 12:35:18 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:35:18 - INFO - def clean_up_address(): Processing location 'Medicine Moves Studio 841 Fisgard St. Victoria, BC' (event_id: None)
2025-06-18 12:35:18 - INFO - def clean_up_address(): Updated event None with address_id 4948 using DB match
2025-06-18 12:35:18 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:35:18 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/3185065321631809/'
2025-06-18 12:35:18 - INFO - def process_llm_response: URL https://www.facebook.com/events/3185065321631809/ marked as relevant with events written to the database.
2025-06-18 12:35:18 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/3185065321631809/.
2025-06-18 12:35:18 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1334757257408713/
2025-06-18 12:35:18 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1334757257408713/.
2025-06-18 12:35:18 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1334757257408713/
2025-06-18 12:35:18 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:35:18 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:35:18 - INFO - query_llm(): Querying Mistral
2025-06-18 12:35:22 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:35:22 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "Victoria Kizomba Lovers Group",
    "dance_style": "urbankiz, kizomba, semba",
    "url": "",
    "event_type": "workshop",
    "event_name": "Special Edition Urbankiz Workshop w/ Kenny Odumosu",
    "day_of_week": "Saturday",
    "start_date": "2025-01-25",
    "end_date": "2025-01-25",
    "start_time": "19:00",
    "end_time": "23:30",
    "price": "$40",
    "location": "Ukrainian Cultural Centre, 3277 Douglas St, Saanich, BC V8Z 3K9, Canada",
    "description": "Join us for a 2hr Urbankiz workshop followed by a social dance. Kenny Odumosu from Calgary will share his knowledge and love for Urbankiz. Price includes both the workshop and social dance."
}]
```
2025-06-18 12:35:22 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1334757257408713/, 
Cleaned JSON ready for parsing:
[{
    "source": "Victoria Kizomba Lovers Group",
    "dance_style": "urbankiz, kizomba, semba",
    "url": "",
    "event_type": "workshop",
    "event_name": "Special Edition Urbankiz Workshop w/ Kenny Odumosu",
    "day_of_week": "Saturday",
    "start_date": "2025-01-25",
    "end_date": "2025-01-25",
    "start_time": "19:00",
    "end_time": "23:30",
    "price": "$40",
    "location": "Ukrainian Cultural Centre, 3277 Douglas St, Saanich, BC V8Z 3K9, Canada",
    "description": "Join us for a 2hr Urbankiz workshop followed by a social dance. Kenny Odumosu from Calgary will share his knowledge and love for Urbankiz. Price includes both the workshop and social dance."
}]
2025-06-18 12:35:22 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:35:22 - INFO - def clean_up_address(): Processing location 'Ukrainian Cultural Centre, 3277 Douglas St, Saanich, BC V8Z 3K9, Canada' (event_id: None)
2025-06-18 12:35:22 - INFO - def clean_up_address(): Updated event None with address_id 4317 using DB match
2025-06-18 12:35:22 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:35:22 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1334757257408713/'
2025-06-18 12:35:22 - INFO - def process_llm_response: URL https://www.facebook.com/events/1334757257408713/ marked as relevant with events written to the database.
2025-06-18 12:35:22 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1334757257408713/.
2025-06-18 12:35:22 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1152065639712042/
2025-06-18 12:35:22 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1152065639712042/.
2025-06-18 12:35:22 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1152065639712042/
2025-06-18 12:35:22 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:35:22 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:35:22 - INFO - query_llm(): Querying Mistral
2025-06-18 12:35:27 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:35:27 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "urbankiz, tarraxo",
    "url": "",
    "event_type": "workshop",
    "event_name": "Urbankiz & Tarraxo Workshops with Mike Ahombi",
    "day_of_week": "Tuesday",
    "start_date": "2025-02-20",
    "end_date": "2025-02-23",
    "start_time": "19:30",
    "end_time": "23:00",
    "price": "$90 Workshops only, $70 Practica only, $20",
    "location": "Ukrainian Cultural Centre, 3277 Douglas St, Saanich, BC V8Z 3K9, Canada",
    "description": "Join us for our special edition Urbankiz & Tarraxo workshops with Mike Ahombi. Mike has been a big supporter of our VIKF and bringing his talent and low key vibe to the west coast. He is based out of Ottawa but you will find him at many different festivals and cities teaching Kizomba, Urbakiz and Tarraxo. We cannot wait for you all to have the opportunity to learn from such an incredible person and instructor. Details: Feb 20th Urbankiz Workshop 7:30pm-9:30pm Practica 9:30pm-11:00pm Feb 22nd Tarraxo Workshop 8:00pm-10:00pm Practica 10:00-11:30pm"
}]
```
2025-06-18 12:35:27 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1152065639712042/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "urbankiz, tarraxo",
    "url": "",
    "event_type": "workshop",
    "event_name": "Urbankiz & Tarraxo Workshops with Mike Ahombi",
    "day_of_week": "Tuesday",
    "start_date": "2025-02-20",
    "end_date": "2025-02-23",
    "start_time": "19:30",
    "end_time": "23:00",
    "price": "$90 Workshops only, $70 Practica only, $20",
    "location": "Ukrainian Cultural Centre, 3277 Douglas St, Saanich, BC V8Z 3K9, Canada",
    "description": "Join us for our special edition Urbankiz & Tarraxo workshops with Mike Ahombi. Mike has been a big supporter of our VIKF and bringing his talent and low key vibe to the west coast. He is based out of Ottawa but you will find him at many different festivals and cities teaching Kizomba, Urbakiz and Tarraxo. We cannot wait for you all to have the opportunity to learn from such an incredible person and instructor. Details: Feb 20th Urbankiz Workshop 7:30pm-9:30pm Practica 9:30pm-11:00pm Feb 22nd Tarraxo Workshop 8:00pm-10:00pm Practica 10:00-11:30pm"
}]
2025-06-18 12:35:27 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:35:27 - INFO - def clean_up_address(): Processing location 'Ukrainian Cultural Centre, 3277 Douglas St, Saanich, BC V8Z 3K9, Canada' (event_id: None)
2025-06-18 12:35:27 - INFO - def clean_up_address(): Updated event None with address_id 4317 using DB match
2025-06-18 12:35:27 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:35:27 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1152065639712042/'
2025-06-18 12:35:27 - INFO - def process_llm_response: URL https://www.facebook.com/events/1152065639712042/ marked as relevant with events written to the database.
2025-06-18 12:35:27 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1152065639712042/.
2025-06-18 12:35:27 - INFO - def driver_fb_search(): Keywords checkpoint updated.
2025-06-18 12:35:31 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q=bachata&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:35:31 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q=bachata&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:35:38 - INFO - extract_event_links(): Found 18 links on https://www.facebook.com/search/events?q=bachata&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:35:38 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q=bachata&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 18 event_links

2025-06-18 12:35:38 - INFO - should_process_url: URL https://www.facebook.com/events/1813229489279716/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:35:45 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1813229489279716/ (14508 ms)
2025-06-18 12:36:01 - INFO - extract_event_text: extracted 3567 chars
2025-06-18 12:36:01 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1813229489279716/.
2025-06-18 12:36:01 - INFO - def scrape_events(): Keywords: ['bachata', 'dance']: found in text for URL: https://www.facebook.com/events/1813229489279716/.
2025-06-18 12:36:01 - INFO - should_process_url: URL https://www.facebook.com/events/1350929566137538/ was last seen as relevant, processing it.
2025-06-18 12:36:07 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1350929566137538/ (11528 ms)
2025-06-18 12:36:32 - INFO - extract_event_text: extracted 5212 chars
2025-06-18 12:36:32 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1350929566137538/.
2025-06-18 12:36:32 - INFO - def scrape_events(): Keywords: ['bachata', 'dance', 'kizomba', 'merengue', 'salsa']: found in text for URL: https://www.facebook.com/events/1350929566137538/.
2025-06-18 12:36:32 - INFO - should_process_url: URL https://www.facebook.com/events/1388695712154512/ was last seen as relevant, processing it.
2025-06-18 12:36:35 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1388695712154512/ (13771 ms)
2025-06-18 12:36:53 - INFO - extract_event_text: extracted 4846 chars
2025-06-18 12:36:53 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1388695712154512/.
2025-06-18 12:36:53 - INFO - def scrape_events(): Keywords: ['bachata', 'dance', 'kizomba', 'merengue', 'salsa']: found in text for URL: https://www.facebook.com/events/1388695712154512/.
2025-06-18 12:36:53 - INFO - should_process_url: URL https://www.facebook.com/events/692165093260868/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:36:57 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/692165093260868/ (10889 ms)
2025-06-18 12:37:21 - INFO - extract_event_text: extracted 3857 chars
2025-06-18 12:37:21 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/692165093260868/.
2025-06-18 12:37:21 - INFO - def scrape_events(): Keywords: ['bachata', 'dance', 'salsa']: found in text for URL: https://www.facebook.com/events/692165093260868/.
2025-06-18 12:37:21 - INFO - should_process_url: URL https://www.facebook.com/events/1057471579628015/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:37:26 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1057471579628015/ (14157 ms)
2025-06-18 12:37:45 - INFO - extract_event_text: extracted 3355 chars
2025-06-18 12:37:45 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1057471579628015/.
2025-06-18 12:37:45 - INFO - def scrape_events(): Keywords: ['bachata', 'dance', 'salsa']: found in text for URL: https://www.facebook.com/events/1057471579628015/.
2025-06-18 12:37:45 - INFO - should_process_url: URL https://www.facebook.com/events/1300938064467261/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:37:48 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1300938064467261/ (11527 ms)
2025-06-18 12:38:08 - INFO - extract_event_text: extracted 3391 chars
2025-06-18 12:38:08 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1300938064467261/.
2025-06-18 12:38:08 - INFO - def scrape_events(): Keywords: ['bachata', 'dance']: found in text for URL: https://www.facebook.com/events/1300938064467261/.
2025-06-18 12:38:08 - INFO - should_process_url: URL https://www.facebook.com/events/1069894401564900/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:38:11 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1069894401564900/ (12989 ms)
2025-06-18 12:38:34 - INFO - extract_event_text: extracted 4149 chars
2025-06-18 12:38:34 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1069894401564900/.
2025-06-18 12:38:34 - INFO - def scrape_events(): Keywords: ['bachata', 'dance']: found in text for URL: https://www.facebook.com/events/1069894401564900/.
2025-06-18 12:38:34 - INFO - should_process_url: URL https://www.facebook.com/events/1730246844256904/ has never been seen before, processing it.
2025-06-18 12:38:39 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1730246844256904/ (10519 ms)
2025-06-18 12:38:57 - INFO - extract_event_text: extracted 2939 chars
2025-06-18 12:38:57 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1730246844256904/.
2025-06-18 12:38:57 - INFO - def scrape_events(): Keywords: ['bachata', 'dance', 'salsa']: found in text for URL: https://www.facebook.com/events/1730246844256904/.
2025-06-18 12:38:57 - INFO - should_process_url: URL https://www.facebook.com/events/1342233713680795/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:39:00 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1342233713680795/ (10837 ms)
2025-06-18 12:39:18 - INFO - extract_event_text: extracted 3184 chars
2025-06-18 12:39:18 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1342233713680795/.
2025-06-18 12:39:18 - INFO - def scrape_events(): Keywords: ['bachata', 'dance', 'merengue', 'salsa']: found in text for URL: https://www.facebook.com/events/1342233713680795/.
2025-06-18 12:39:18 - INFO - should_process_url: URL https://www.facebook.com/events/717475250956404/ was last seen as relevant, processing it.
2025-06-18 12:39:22 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/717475250956404/ (13993 ms)
2025-06-18 12:39:43 - INFO - extract_event_text: extracted 3456 chars
2025-06-18 12:39:43 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/717475250956404/.
2025-06-18 12:39:43 - INFO - def scrape_events(): Keywords: ['bachata', 'dance']: found in text for URL: https://www.facebook.com/events/717475250956404/.
2025-06-18 12:39:43 - INFO - should_process_url: URL https://www.facebook.com/events/9677364319006080/ was last seen as relevant, processing it.
2025-06-18 12:39:45 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/9677364319006080/ (12054 ms)
2025-06-18 12:40:12 - INFO - extract_event_text: extracted 4832 chars
2025-06-18 12:40:12 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/9677364319006080/.
2025-06-18 12:40:12 - INFO - def scrape_events(): Keywords: ['bachata', 'dance', 'kizomba', 'merengue', 'salsa']: found in text for URL: https://www.facebook.com/events/9677364319006080/.
2025-06-18 12:40:12 - INFO - should_process_url: URL https://www.facebook.com/events/1901245437276872/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:40:18 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1901245437276872/ (13597 ms)
2025-06-18 12:40:35 - INFO - extract_event_text: extracted 3474 chars
2025-06-18 12:40:35 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1901245437276872/.
2025-06-18 12:40:35 - INFO - def scrape_events(): Keywords: ['bachata', 'dance', 'salsa']: found in text for URL: https://www.facebook.com/events/1901245437276872/.
2025-06-18 12:40:44 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q=  cha cha&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:40:44 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q=  cha cha&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:40:50 - INFO - extract_event_links(): Found 7 links on https://www.facebook.com/search/events?q=  cha cha&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:40:50 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q=  cha cha&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 7 event_links

2025-06-18 12:40:50 - INFO - should_process_url: URL https://www.facebook.com/events/679241811720932/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:40:58 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/679241811720932/ (14213 ms)
2025-06-18 12:41:17 - INFO - extract_event_text: extracted 3553 chars
2025-06-18 12:41:17 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/679241811720932/.
2025-06-18 12:41:17 - INFO - def scrape_events(): Keywords: ['cha cha', 'dance', 'salsa']: found in text for URL: https://www.facebook.com/events/679241811720932/.
2025-06-18 12:41:17 - INFO - should_process_url: URL https://www.facebook.com/events/1382188962971661/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:41:21 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1382188962971661/ (13381 ms)
2025-06-18 12:41:39 - INFO - extract_event_text: extracted 3509 chars
2025-06-18 12:41:39 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1382188962971661/.
2025-06-18 12:41:39 - INFO - def scrape_events(): Keywords: ['cha cha', 'dance', 'salsa']: found in text for URL: https://www.facebook.com/events/1382188962971661/.
2025-06-18 12:41:39 - INFO - should_process_url: URL https://www.facebook.com/events/1342792743590871/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:41:45 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1342792743590871/ (10689 ms)
2025-06-18 12:42:04 - INFO - extract_event_text: extracted 3342 chars
2025-06-18 12:42:04 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1342792743590871/.
2025-06-18 12:42:04 - INFO - def scrape_events(): Keywords: ['cha cha', 'dance', 'salsa']: found in text for URL: https://www.facebook.com/events/1342792743590871/.
2025-06-18 12:42:04 - INFO - should_process_url: URL https://www.facebook.com/events/10048344358532607/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:42:13 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/10048344358532607/ (13711 ms)
2025-06-18 12:42:31 - INFO - extract_event_text: extracted 3558 chars
2025-06-18 12:42:31 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/10048344358532607/.
2025-06-18 12:42:31 - INFO - def scrape_events(): Keywords: ['cha cha', 'dance', 'salsa']: found in text for URL: https://www.facebook.com/events/10048344358532607/.
2025-06-18 12:42:31 - INFO - should_process_url: URL https://www.facebook.com/events/966455485665576/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:42:37 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/966455485665576/ (10451 ms)
2025-06-18 12:42:59 - INFO - extract_event_text: extracted 3570 chars
2025-06-18 12:42:59 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/966455485665576/.
2025-06-18 12:42:59 - INFO - def scrape_events(): Keywords: ['cha cha', 'dance', 'salsa']: found in text for URL: https://www.facebook.com/events/966455485665576/.
2025-06-18 12:42:59 - INFO - should_process_url: URL https://www.facebook.com/events/669591372187091/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:43:04 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/669591372187091/ (14965 ms)
2025-06-18 12:43:23 - INFO - extract_event_text: extracted 3191 chars
2025-06-18 12:43:23 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/669591372187091/.
2025-06-18 12:43:23 - INFO - def scrape_events(): Keywords: ['cha cha', 'dance', 'salsa']: found in text for URL: https://www.facebook.com/events/669591372187091/.
2025-06-18 12:43:23 - INFO - should_process_url: URL https://www.facebook.com/events/2214494908966327/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:43:26 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/2214494908966327/ (14931 ms)
2025-06-18 12:43:47 - INFO - extract_event_text: extracted 3331 chars
2025-06-18 12:43:47 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/2214494908966327/.
2025-06-18 12:43:47 - INFO - def scrape_events(): Keywords: ['cha cha', 'dance', 'salsa']: found in text for URL: https://www.facebook.com/events/2214494908966327/.
2025-06-18 12:43:53 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q=  merengue&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:43:53 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q=  merengue&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:43:58 - INFO - extract_event_links(): Found 1 links on https://www.facebook.com/search/events?q=  merengue&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:43:58 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q=  merengue&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 1 event_links

2025-06-18 12:44:03 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q= salsa&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:44:03 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q= salsa&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:44:09 - INFO - extract_event_links(): Found 18 links on https://www.facebook.com/search/events?q= salsa&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:44:09 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q= salsa&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 18 event_links

2025-06-18 12:44:09 - INFO - should_process_url: URL https://www.facebook.com/events/1059622278965884/ was last seen as relevant, processing it.
2025-06-18 12:44:16 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1059622278965884/ (12073 ms)
2025-06-18 12:44:36 - INFO - extract_event_text: extracted 3300 chars
2025-06-18 12:44:36 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1059622278965884/.
2025-06-18 12:44:36 - WARNING - def extract_relevant_text(): 'Guests See All' not found after last day of the week in https://www.facebook.com/events/1059622278965884/.
2025-06-18 12:44:36 - INFO - def scrape_events(): Keywords: ['bachata', 'cha cha', 'dance', 'merengue', 'salsa', 'swing', 'tango', 'west coast swing']: found in text for URL: https://www.facebook.com/events/1059622278965884/.
2025-06-18 12:44:36 - INFO - should_process_url: URL https://www.facebook.com/events/530862806349067/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:44:41 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/530862806349067/ (10766 ms)
2025-06-18 12:44:58 - INFO - extract_event_text: extracted 3193 chars
2025-06-18 12:44:58 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/530862806349067/.
2025-06-18 12:44:58 - INFO - def scrape_events(): Keywords: ['salsa']: found in text for URL: https://www.facebook.com/events/530862806349067/.
2025-06-18 12:44:58 - INFO - should_process_url: URL https://www.facebook.com/events/1636237610432412/ was last seen as relevant, processing it.
2025-06-18 12:45:02 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1636237610432412/ (11154 ms)
2025-06-18 12:45:23 - INFO - extract_event_text: extracted 3718 chars
2025-06-18 12:45:23 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1636237610432412/.
2025-06-18 12:45:23 - INFO - def scrape_events(): Keywords: ['bachata', 'dance', 'merengue', 'salsa']: found in text for URL: https://www.facebook.com/events/1636237610432412/.
2025-06-18 12:45:23 - INFO - should_process_url: URL https://www.facebook.com/events/2251848171850840/ was last seen as relevant, processing it.
2025-06-18 12:45:29 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/2251848171850840/ (10364 ms)
2025-06-18 12:45:46 - INFO - extract_event_text: extracted 3247 chars
2025-06-18 12:45:46 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/2251848171850840/.
2025-06-18 12:45:46 - WARNING - def extract_relevant_text(): 'Guests See All' not found after last day of the week in https://www.facebook.com/events/2251848171850840/.
2025-06-18 12:45:46 - INFO - def scrape_events(): Keywords: ['bachata', 'cha cha', 'dance', 'merengue', 'salsa', 'swing', 'tango', 'west coast swing']: found in text for URL: https://www.facebook.com/events/2251848171850840/.
2025-06-18 12:45:46 - INFO - should_process_url: URL https://www.facebook.com/events/884101187183426/ was last seen as relevant, processing it.
2025-06-18 12:45:50 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/884101187183426/ (10757 ms)
2025-06-18 12:46:09 - INFO - extract_event_text: extracted 3381 chars
2025-06-18 12:46:09 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/884101187183426/.
2025-06-18 12:46:09 - WARNING - def extract_relevant_text(): 'Guests See All' not found after last day of the week in https://www.facebook.com/events/884101187183426/.
2025-06-18 12:46:09 - INFO - def scrape_events(): Keywords: ['bachata', 'cha cha', 'dance', 'kizomba', 'merengue', 'salsa', 'swing', 'tango', 'west coast swing']: found in text for URL: https://www.facebook.com/events/884101187183426/.
2025-06-18 12:46:09 - INFO - should_process_url: URL https://www.facebook.com/events/3899920353641309/ was last seen as relevant, processing it.
2025-06-18 12:46:16 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/3899920353641309/ (14184 ms)
2025-06-18 12:46:36 - INFO - extract_event_text: extracted 3306 chars
2025-06-18 12:46:36 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/3899920353641309/.
2025-06-18 12:46:36 - WARNING - def extract_relevant_text(): 'Guests See All' not found after last day of the week in https://www.facebook.com/events/3899920353641309/.
2025-06-18 12:46:36 - INFO - def scrape_events(): Keywords: ['bachata', 'cha cha', 'dance', 'merengue', 'salsa', 'swing', 'tango', 'west coast swing']: found in text for URL: https://www.facebook.com/events/3899920353641309/.
2025-06-18 12:46:56 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q=  zouk&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:46:56 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q=  zouk&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:47:03 - INFO - extract_event_links(): Found 2 links on https://www.facebook.com/search/events?q=  zouk&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:47:03 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q=  zouk&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 2 event_links

2025-06-18 12:47:03 - INFO - should_process_url: URL https://www.facebook.com/events/1411005319893067/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:47:08 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1411005319893067/ (14877 ms)
2025-06-18 12:47:33 - INFO - extract_event_text: extracted 4234 chars
2025-06-18 12:47:33 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1411005319893067/.
2025-06-18 12:47:33 - INFO - def scrape_events(): Keywords: ['bachata', 'dance', 'zouk']: found in text for URL: https://www.facebook.com/events/1411005319893067/.
2025-06-18 12:47:33 - INFO - should_process_url: URL https://www.facebook.com/events/1106484714432492/ was last seen as relevant, processing it.
2025-06-18 12:47:37 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1106484714432492/ (14490 ms)
2025-06-18 12:47:58 - INFO - extract_event_text: extracted 3639 chars
2025-06-18 12:47:58 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1106484714432492/.
2025-06-18 12:47:58 - INFO - def scrape_events(): Keywords: ['dance', 'salsa', 'zouk']: found in text for URL: https://www.facebook.com/events/1106484714432492/.
2025-06-18 12:47:58 - INFO - def scrape_events(): Extracted text from 27 events.
2025-06-18 12:47:59 - INFO - def scrape_events(): Extracted text data written to checkpoint/extracted_text.xlsx.
2025-06-18 12:47:59 - INFO - def driver_fb_search(): Extracted text based on search_url: https://www.facebook.com/search/events?q=  zouk&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9.
2025-06-18 12:47:59 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1813229489279716/
2025-06-18 12:47:59 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1813229489279716/.
2025-06-18 12:47:59 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1813229489279716/
2025-06-18 12:47:59 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:47:59 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:47:59 - INFO - query_llm(): Querying Mistral
2025-06-18 12:48:03 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:48:03 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "bachata",
    "url": "",
    "event_type": "class",
    "event_name": "Sensual Bachata 4 Week Series",
    "day_of_week": "Thursday",
    "start_date": "2025-05-29",
    "end_date": "2025-05-29",
    "start_time": "19:55",
    "end_time": "21:00",
    "price": "$80 for all 4 classes",
    "location": "Method Studio - Victoria BC, 841 Fisgard Street, Victoria",
    "description": "Ready to level up your Sensual Bachata? May 8, 15, 22, 29 Method Studio | 7:55–9:00 PM | $80 for all 4 classes Join us for an exciting and dynamic Bachata Sensual class designed for experienced beginners and intermediate dancers! We’re blending solid fundamentals with fresh, fun, and sensual combos to help you grow, challenge yourself, and have an amazing time on the dance floor. No partner needed — just bring yourself and your love for dance! Spots are limited — don’t miss out! Register by e-transferring $80 to maximumotion@gmail.com and mentioning “Bachata Sensual” in the notes. Get ready to connect, move, and elevate your dancing! P.S. All fees are non-refundable as they go directly toward securing the studio space and running the class."
}]
```
2025-06-18 12:48:03 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1813229489279716/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "bachata",
    "url": "",
    "event_type": "class",
    "event_name": "Sensual Bachata 4 Week Series",
    "day_of_week": "Thursday",
    "start_date": "2025-05-29",
    "end_date": "2025-05-29",
    "start_time": "19:55",
    "end_time": "21:00",
    "price": "$80 for all 4 classes",
    "location": "Method Studio - Victoria BC, 841 Fisgard Street, Victoria",
    "description": "Ready to level up your Sensual Bachata? May 8, 15, 22, 29 Method Studio | 7:55–9:00 PM | $80 for all 4 classes Join us for an exciting and dynamic Bachata Sensual class designed for experienced beginners and intermediate dancers! We’re blending solid fundamentals with fresh, fun, and sensual combos to help you grow, challenge yourself, and have an amazing time on the dance floor. No partner needed — just bring yourself and your love for dance! Spots are limited — don’t miss out! Register by e-transferring $80 to maximumotion@gmail.com and mentioning “Bachata Sensual” in the notes. Get ready to connect, move, and elevate your dancing! P.S. All fees are non-refundable as they go directly toward securing the studio space and running the class."
}]
2025-06-18 12:48:03 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:48:03 - INFO - def clean_up_address(): Processing location 'Method Studio - Victoria BC, 841 Fisgard Street, Victoria' (event_id: None)
2025-06-18 12:48:03 - INFO - def clean_up_address(): Updated event None with address_id 4948 using DB match
2025-06-18 12:48:03 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:48:03 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1813229489279716/'
2025-06-18 12:48:03 - INFO - def process_llm_response: URL https://www.facebook.com/events/1813229489279716/ marked as relevant with events written to the database.
2025-06-18 12:48:03 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1813229489279716/.
2025-06-18 12:48:03 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1350929566137538/
2025-06-18 12:48:03 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1350929566137538/.
2025-06-18 12:48:03 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1350929566137538/
2025-06-18 12:48:03 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:48:03 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:48:03 - INFO - query_llm(): Querying Mistral
2025-06-18 12:48:06 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:48:06 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "Victoria Latin Dance Association",
        "dance_style": "bachata, salsa, kizomba, merengue",
        "url": "",
        "event_type": "social dance",
        "event_name": "Sunday Sundown Social: Bachata Temptation, Salsa Sensation",
        "day_of_week": "Sunday",
        "start_date": "2025-08-10",
        "end_date": "2025-08-10",
        "start_time": "15:45",
        "end_time": "19:30",
        "price": "$5 for students (with valid ID), $10 general admission",
        "location": "Songhees Plaza (near the Johnson Street Bridge), 30 Esquimalt Rd, Victoria, BC V9A, Canada",
        "description": "Join us for a vibrant late afternoon of Latin dancing by the ocean! We’ll begin with a beginner-friendly lesson— no partner or experience needed. After the class, enjoy an open-air social featuring a dynamic blend of Salsa, Bachata, and Kizomba, with just a light touch of Merengue to round out the evening."
    }
]
```
2025-06-18 12:48:06 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1350929566137538/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Victoria Latin Dance Association",
        "dance_style": "bachata, salsa, kizomba, merengue",
        "url": "",
        "event_type": "social dance",
        "event_name": "Sunday Sundown Social: Bachata Temptation, Salsa Sensation",
        "day_of_week": "Sunday",
        "start_date": "2025-08-10",
        "end_date": "2025-08-10",
        "start_time": "15:45",
        "end_time": "19:30",
        "price": "$5 for students (with valid ID), $10 general admission",
        "location": "Songhees Plaza (near the Johnson Street Bridge), 30 Esquimalt Rd, Victoria, BC V9A, Canada",
        "description": "Join us for a vibrant late afternoon of Latin dancing by the ocean! We’ll begin with a beginner-friendly lesson— no partner or experience needed. After the class, enjoy an open-air social featuring a dynamic blend of Salsa, Bachata, and Kizomba, with just a light touch of Merengue to round out the evening."
    }
]
2025-06-18 12:48:07 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:48:07 - INFO - def clean_up_address(): Processing location 'Songhees Plaza (near the Johnson Street Bridge), 30 Esquimalt Rd, Victoria, BC V9A, Canada' (event_id: None)
2025-06-18 12:48:07 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:48:07 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1350929566137538/'
2025-06-18 12:48:07 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:48:07 - INFO - def process_llm_response: URL https://www.facebook.com/events/1350929566137538/ marked as relevant with events written to the database.
2025-06-18 12:48:07 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1350929566137538/.
2025-06-18 12:48:07 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1388695712154512/
2025-06-18 12:48:07 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1388695712154512/.
2025-06-18 12:48:07 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1388695712154512/
2025-06-18 12:48:07 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:48:07 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:48:07 - INFO - query_llm(): Querying Mistral
2025-06-18 12:48:10 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:48:10 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "Victoria Latin Dance Association",
        "dance_style": "salsa, bachata, kizomba, merengue",
        "url": "",
        "event_type": "social dance",
        "event_name": "Sunday Sundown Social: Bachata Temptation, Salsa Sensation",
        "day_of_week": "Sunday",
        "start_date": "2025-06-22",
        "end_date": "2025-06-22",
        "start_time": "15:45",
        "end_time": "19:30",
        "price": "$5 for students (with valid ID), $10 general admission",
        "location": "Songhees Plaza (near the Johnson Street Bridge), 30 Esquimalt Rd, Victoria, BC V9A, Canada",
        "description": "Join us for a vibrant late afternoon of Latin dancing by the ocean! We’ll begin with a beginner-friendly lesson— no partner or experience needed. After the class, enjoy an open-air social featuring a dynamic blend of Salsa, Bachata, and Kizomba, with just a light touch of Merengue to round out the evening."
    }
]
```
2025-06-18 12:48:10 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1388695712154512/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Victoria Latin Dance Association",
        "dance_style": "salsa, bachata, kizomba, merengue",
        "url": "",
        "event_type": "social dance",
        "event_name": "Sunday Sundown Social: Bachata Temptation, Salsa Sensation",
        "day_of_week": "Sunday",
        "start_date": "2025-06-22",
        "end_date": "2025-06-22",
        "start_time": "15:45",
        "end_time": "19:30",
        "price": "$5 for students (with valid ID), $10 general admission",
        "location": "Songhees Plaza (near the Johnson Street Bridge), 30 Esquimalt Rd, Victoria, BC V9A, Canada",
        "description": "Join us for a vibrant late afternoon of Latin dancing by the ocean! We’ll begin with a beginner-friendly lesson— no partner or experience needed. After the class, enjoy an open-air social featuring a dynamic blend of Salsa, Bachata, and Kizomba, with just a light touch of Merengue to round out the evening."
    }
]
2025-06-18 12:48:10 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:48:10 - INFO - def clean_up_address(): Processing location 'Songhees Plaza (near the Johnson Street Bridge), 30 Esquimalt Rd, Victoria, BC V9A, Canada' (event_id: None)
2025-06-18 12:48:10 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:48:10 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1388695712154512/'
2025-06-18 12:48:10 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:48:10 - INFO - def process_llm_response: URL https://www.facebook.com/events/1388695712154512/ marked as relevant with events written to the database.
2025-06-18 12:48:10 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1388695712154512/.
2025-06-18 12:48:10 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/692165093260868/
2025-06-18 12:48:10 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/692165093260868/.
2025-06-18 12:48:10 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/692165093260868/
2025-06-18 12:48:10 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:48:10 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:48:10 - INFO - query_llm(): Querying Mistral
2025-06-18 12:48:13 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:48:13 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "Solwood Studio",
    "dance_style": "salsa, bachata",
    "url": "https://forms.gle/4QThxT6yByd3h5KH8",
    "event_type": "workshop",
    "event_name": "Salsa & Bachata Masterclass with Adam & Ghada",
    "day_of_week": "Saturday",
    "start_date": "2025-05-10",
    "end_date": "2025-05-10",
    "start_time": "13:00",
    "end_time": "16:00",
    "price": "$25 for one class, $35 for two classes",
    "location": "Solwood studio, 1303 Broad st, Victoria, British Columbia",
    "description": "Salsa & Bachata Masterclass with Adam & Ghada. Get ready to learn details that will help you with creating flow – both as leads and follows – in addition to some socials-friendly tricks!"
}]
```
2025-06-18 12:48:13 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/692165093260868/, 
Cleaned JSON ready for parsing:
[{
    "source": "Solwood Studio",
    "dance_style": "salsa, bachata",
    "url": "https://forms.gle/4QThxT6yByd3h5KH8",
    "event_type": "workshop",
    "event_name": "Salsa & Bachata Masterclass with Adam & Ghada",
    "day_of_week": "Saturday",
    "start_date": "2025-05-10",
    "end_date": "2025-05-10",
    "start_time": "13:00",
    "end_time": "16:00",
    "price": "$25 for one class, $35 for two classes",
    "location": "Solwood studio, 1303 Broad st, Victoria, British Columbia",
    "description": "Salsa & Bachata Masterclass with Adam & Ghada. Get ready to learn details that will help you with creating flow – both as leads and follows – in addition to some socials-friendly tricks!"
}]
2025-06-18 12:48:13 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:48:13 - INFO - def clean_up_address(): Processing location 'Solwood studio, 1303 Broad st, Victoria, British Columbia' (event_id: None)
2025-06-18 12:48:13 - INFO - def clean_up_address(): Updated event None with address_id 1928 using DB match
2025-06-18 12:48:13 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:48:13 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/692165093260868/'
2025-06-18 12:48:13 - INFO - def process_llm_response: URL https://www.facebook.com/events/692165093260868/ marked as relevant with events written to the database.
2025-06-18 12:48:13 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/692165093260868/.
2025-06-18 12:48:13 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1057471579628015/
2025-06-18 12:48:13 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1057471579628015/.
2025-06-18 12:48:13 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1057471579628015/
2025-06-18 12:48:13 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:48:13 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:48:13 - INFO - query_llm(): Querying Mistral
2025-06-18 12:48:17 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:48:17 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "bachata, salsa",
        "url": "",
        "event_type": "social dance",
        "event_name": "Bachata Nights Victoria Bc",
        "day_of_week": "Friday",
        "start_date": "2025-05-23",
        "end_date": "2025-05-23",
        "start_time": "20:00",
        "end_time": "00:00",
        "price": "$10 cash per person",
        "location": "Method Studio, 841 Fisgard St, Victoria, British Columbia",
        "description": "Join us on our next Bachata Nights May 23 at Method Studio (841 Fisgard St) for a night of music, dancing, and fun! Schedule: 8:00 PM – Doors open 8:15 PM – All Levels Bachata Lesson 9:00 PM - 12:00 AM – Social Dance This Friday @sebastianyhannah will teach an amazing open level bachata class! Don’t miss it Dance to the perfect 3:1 mix of Bachata & Salsa!"
    }
]
```
2025-06-18 12:48:17 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1057471579628015/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "bachata, salsa",
        "url": "",
        "event_type": "social dance",
        "event_name": "Bachata Nights Victoria Bc",
        "day_of_week": "Friday",
        "start_date": "2025-05-23",
        "end_date": "2025-05-23",
        "start_time": "20:00",
        "end_time": "00:00",
        "price": "$10 cash per person",
        "location": "Method Studio, 841 Fisgard St, Victoria, British Columbia",
        "description": "Join us on our next Bachata Nights May 23 at Method Studio (841 Fisgard St) for a night of music, dancing, and fun! Schedule: 8:00 PM – Doors open 8:15 PM – All Levels Bachata Lesson 9:00 PM - 12:00 AM – Social Dance This Friday @sebastianyhannah will teach an amazing open level bachata class! Don’t miss it Dance to the perfect 3:1 mix of Bachata & Salsa!"
    }
]
2025-06-18 12:48:17 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:48:17 - INFO - def clean_up_address(): Processing location 'Method Studio, 841 Fisgard St, Victoria, British Columbia' (event_id: None)
2025-06-18 12:48:17 - INFO - def clean_up_address(): Updated event None with address_id 4948 using DB match
2025-06-18 12:48:17 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:48:17 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1057471579628015/'
2025-06-18 12:48:17 - INFO - def process_llm_response: URL https://www.facebook.com/events/1057471579628015/ marked as relevant with events written to the database.
2025-06-18 12:48:17 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1057471579628015/.
2025-06-18 12:48:17 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1300938064467261/
2025-06-18 12:48:17 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1300938064467261/.
2025-06-18 12:48:17 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1300938064467261/
2025-06-18 12:48:17 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:48:17 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:48:17 - INFO - query_llm(): Querying Mistral
2025-06-18 12:48:21 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:48:21 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "bachata",
        "url": "",
        "event_type": "workshop",
        "event_name": "Intermediate Sensual Bachata Workshop",
        "day_of_week": "Thursday",
        "start_date": "2025-03-20",
        "end_date": "2025-03-20",
        "start_time": "20:00",
        "end_time": "22:00",
        "price": "$30",
        "location": "Method Studio, 841 Fisgard St, Victoria, British Columbia",
        "description": "Intermediate workshop: Take your skills to a higher level! Master the advanced variations of the Madrid pass, smooth transitions and musicality. No partner needed, just bring your energy and comfortable shoes!"
    }
]
```
2025-06-18 12:48:21 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1300938064467261/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "bachata",
        "url": "",
        "event_type": "workshop",
        "event_name": "Intermediate Sensual Bachata Workshop",
        "day_of_week": "Thursday",
        "start_date": "2025-03-20",
        "end_date": "2025-03-20",
        "start_time": "20:00",
        "end_time": "22:00",
        "price": "$30",
        "location": "Method Studio, 841 Fisgard St, Victoria, British Columbia",
        "description": "Intermediate workshop: Take your skills to a higher level! Master the advanced variations of the Madrid pass, smooth transitions and musicality. No partner needed, just bring your energy and comfortable shoes!"
    }
]
2025-06-18 12:48:21 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:48:21 - INFO - def clean_up_address(): Processing location 'Method Studio, 841 Fisgard St, Victoria, British Columbia' (event_id: None)
2025-06-18 12:48:21 - INFO - def clean_up_address(): Updated event None with address_id 4948 using DB match
2025-06-18 12:48:21 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:48:21 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1300938064467261/'
2025-06-18 12:48:21 - INFO - def process_llm_response: URL https://www.facebook.com/events/1300938064467261/ marked as relevant with events written to the database.
2025-06-18 12:48:21 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1300938064467261/.
2025-06-18 12:48:21 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1069894401564900/
2025-06-18 12:48:21 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1069894401564900/.
2025-06-18 12:48:21 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1069894401564900/
2025-06-18 12:48:21 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:48:21 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:48:21 - INFO - query_llm(): Querying Mistral
2025-06-18 12:48:25 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:48:25 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "Victoria Latin Dance Association",
    "dance_style": "bachata",
    "url": "",
    "event_type": "class",
    "event_name": "Sensual Bachata Series – Monday Nights!",
    "day_of_week": "Monday",
    "start_date": "2025-06-23",
    "end_date": "2025-06-23",
    "start_time": "18:30",
    "end_time": "20:40",
    "price": "",
    "location": "111 Superior St, Victoria, BC V8V 1T2, Canada",
    "description": "Foundation Class (6:30–7:35 PM) Perfect for absolute beginners or dancers looking to strengthen their foundation! Intermediate Class (7:35–8:40 PM) Ready to level up? This class is designed for dancers who already feel comfortable with the basics and want to challenge themselves. Event series will run on subsequent Mondays."
}]
```
2025-06-18 12:48:25 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1069894401564900/, 
Cleaned JSON ready for parsing:
[{
    "source": "Victoria Latin Dance Association",
    "dance_style": "bachata",
    "url": "",
    "event_type": "class",
    "event_name": "Sensual Bachata Series – Monday Nights!",
    "day_of_week": "Monday",
    "start_date": "2025-06-23",
    "end_date": "2025-06-23",
    "start_time": "18:30",
    "end_time": "20:40",
    "price": "",
    "location": "111 Superior St, Victoria, BC V8V 1T2, Canada",
    "description": "Foundation Class (6:30–7:35 PM) Perfect for absolute beginners or dancers looking to strengthen their foundation! Intermediate Class (7:35–8:40 PM) Ready to level up? This class is designed for dancers who already feel comfortable with the basics and want to challenge themselves. Event series will run on subsequent Mondays."
}]
2025-06-18 12:48:25 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:48:25 - INFO - def clean_up_address(): Processing location '111 Superior St, Victoria, BC V8V 1T2, Canada' (event_id: None)
2025-06-18 12:48:25 - INFO - def clean_up_address(): Updated event None with address_id 2086 using DB match
2025-06-18 12:48:25 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:48:25 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1069894401564900/'
2025-06-18 12:48:25 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:48:25 - INFO - def process_llm_response: URL https://www.facebook.com/events/1069894401564900/ marked as relevant with events written to the database.
2025-06-18 12:48:25 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1069894401564900/.
2025-06-18 12:48:25 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1730246844256904/
2025-06-18 12:48:25 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1730246844256904/.
2025-06-18 12:48:25 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1730246844256904/
2025-06-18 12:48:25 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:48:25 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:48:25 - INFO - query_llm(): Querying Mistral
2025-06-18 12:48:26 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-06-18 12:48:26 - WARNING - query_llm(): Mistral query failed: API rejection occurred: Status 429
{"object":"rejection","message":"Service tier capacity exceeded for this model.","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 12:48:26 - INFO - query_llm(): Falling back to OpenAI
2025-06-18 12:48:35 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:48:35 - INFO - query_llm(): OpenAI response received: [{
    "source": "Facebook - Latin Dance Canada",
    "dance_style": "salsa, bachata",
    "url": "",
    "event_type": "social dance",
    "event_name": "Saturday Salsa/Bachata Social",
    "day_of_week": "Saturday",
    "start_date": "2025-06-28",
    "end_date": "2025-06-28",
    "start_time": "20:00",
    "end_time": "00:00",
    "price": "$15",
    "location": "Ukrainian Cultural Centre, 3277 Douglas Street, Victoria BC",
    "description": "Beginner lesson 8:00-8:30 pm followed by social dancing with salsa and bachata until midnight."
}]
2025-06-18 12:48:35 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1730246844256904/, 
Cleaned JSON ready for parsing:
[{
    "source": "Facebook - Latin Dance Canada",
    "dance_style": "salsa, bachata",
    "url": "",
    "event_type": "social dance",
    "event_name": "Saturday Salsa/Bachata Social",
    "day_of_week": "Saturday",
    "start_date": "2025-06-28",
    "end_date": "2025-06-28",
    "start_time": "20:00",
    "end_time": "00:00",
    "price": "$15",
    "location": "Ukrainian Cultural Centre, 3277 Douglas Street, Victoria BC",
    "description": "Beginner lesson 8:00-8:30 pm followed by social dancing with salsa and bachata until midnight."
}]
2025-06-18 12:48:35 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:48:35 - INFO - def clean_up_address(): Processing location 'Ukrainian Cultural Centre, 3277 Douglas Street, Victoria BC' (event_id: None)
2025-06-18 12:48:35 - INFO - def clean_up_address(): Updated event None with address_id 4317 using DB match
2025-06-18 12:48:35 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:48:35 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1730246844256904/'
2025-06-18 12:48:35 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:48:35 - INFO - def process_llm_response: URL https://www.facebook.com/events/1730246844256904/ marked as relevant with events written to the database.
2025-06-18 12:48:35 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1730246844256904/.
2025-06-18 12:48:35 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1342233713680795/
2025-06-18 12:48:35 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1342233713680795/.
2025-06-18 12:48:35 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1342233713680795/
2025-06-18 12:48:35 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:48:35 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:48:35 - INFO - query_llm(): Querying Mistral
2025-06-18 12:48:43 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:48:43 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "bachata, merengue",
    "url": "",
    "event_type": "class",
    "event_name": "Bachata & Merengue- All Levels- May Series",
    "day_of_week": "Thursday",
    "start_date": "2025-05-01",
    "end_date": "2025-05-01",
    "start_time": "21:00",
    "end_time": "22:00",
    "price": "",
    "location": "Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada",
    "description": "Bachata & Merengue- All Levels- May Series. Classes are registered on a monthly basis and take place every Thursday from 8:00- 9:00pm, May 1, 8, 15, 22, 29. No experience required. No partner is necessary as we rotate partners throughout the lesson."
}]
```
2025-06-18 12:48:43 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1342233713680795/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "bachata, merengue",
    "url": "",
    "event_type": "class",
    "event_name": "Bachata & Merengue- All Levels- May Series",
    "day_of_week": "Thursday",
    "start_date": "2025-05-01",
    "end_date": "2025-05-01",
    "start_time": "21:00",
    "end_time": "22:00",
    "price": "",
    "location": "Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada",
    "description": "Bachata & Merengue- All Levels- May Series. Classes are registered on a monthly basis and take place every Thursday from 8:00- 9:00pm, May 1, 8, 15, 22, 29. No experience required. No partner is necessary as we rotate partners throughout the lesson."
}]
2025-06-18 12:48:43 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:48:43 - INFO - def clean_up_address(): Processing location 'Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:48:43 - INFO - get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:48:43 - INFO - Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:48:43 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:48:43 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1342233713680795/'
2025-06-18 12:48:43 - INFO - def process_llm_response: URL https://www.facebook.com/events/1342233713680795/ marked as relevant with events written to the database.
2025-06-18 12:48:43 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1342233713680795/.
2025-06-18 12:48:43 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/717475250956404/
2025-06-18 12:48:43 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/717475250956404/.
2025-06-18 12:48:43 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/717475250956404/
2025-06-18 12:48:43 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:48:43 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:48:43 - INFO - query_llm(): Querying Mistral
2025-06-18 12:48:51 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:48:51 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "bachata",
        "url": "",
        "event_type": "class",
        "event_name": "FREE Beginner Bachata Class",
        "day_of_week": "Friday",
        "start_date": "2025-05-30",
        "end_date": "2025-05-30",
        "start_time": "18:00",
        "end_time": null,
        "price": "FREE",
        "location": "221- 3147 Douglas Street, Victoria, BC, Canada, British Columbia V8Z 6E3",
        "description": "Ready to get your groove on? We’re teaming up with the Victoria Latin Dance Association for a FREE Beginner Bachata Class right here at Centre Court! Join us on Friday, May 30 at 6:00 PM for an evening of fun and dancing. NO partner or experience necessary! Bachata is a beautiful and easy-to-learn dance that’s great for meeting new people, getting active, and connecting with an amazing community."
    }
]
```
2025-06-18 12:48:51 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/717475250956404/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "bachata",
        "url": "",
        "event_type": "class",
        "event_name": "FREE Beginner Bachata Class",
        "day_of_week": "Friday",
        "start_date": "2025-05-30",
        "end_date": "2025-05-30",
        "start_time": "18:00",
        "end_time": null,
        "price": "FREE",
        "location": "221- 3147 Douglas Street, Victoria, BC, Canada, British Columbia V8Z 6E3",
        "description": "Ready to get your groove on? We’re teaming up with the Victoria Latin Dance Association for a FREE Beginner Bachata Class right here at Centre Court! Join us on Friday, May 30 at 6:00 PM for an evening of fun and dancing. NO partner or experience necessary! Bachata is a beautiful and easy-to-learn dance that’s great for meeting new people, getting active, and connecting with an amazing community."
    }
]
2025-06-18 12:48:51 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:48:51 - INFO - def clean_up_address(): Processing location '221- 3147 Douglas Street, Victoria, BC, Canada, British Columbia V8Z 6E3' (event_id: None)
2025-06-18 12:48:51 - INFO - get_address_id: Inserted or updated address_id 9747 for address '3147 Douglas ST, VICTORIA, BC, V8Z6E3, CA'.
2025-06-18 12:48:51 - INFO - Populated from DB for postal code 'V8Z6E3': '3147 Douglas ST, VICTORIA, BC, V8Z6E3, CA'
2025-06-18 12:48:51 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:48:51 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/717475250956404/'
2025-06-18 12:48:51 - INFO - def process_llm_response: URL https://www.facebook.com/events/717475250956404/ marked as relevant with events written to the database.
2025-06-18 12:48:51 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/717475250956404/.
2025-06-18 12:48:51 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/9677364319006080/
2025-06-18 12:48:51 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/9677364319006080/.
2025-06-18 12:48:51 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/9677364319006080/
2025-06-18 12:48:51 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:48:51 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:48:51 - INFO - query_llm(): Querying Mistral
2025-06-18 12:48:54 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:48:55 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "Victoria Latin Dance Association",
        "dance_style": "bachata, salsa, kizomba, merengue",
        "url": "",
        "event_type": "social dance",
        "event_name": "Sunday Sundown Social: Bachata Temptation, Salsa Sensation",
        "day_of_week": "Sunday",
        "start_date": "2025-07-20",
        "end_date": "2025-07-20",
        "start_time": "15:45",
        "end_time": "19:30",
        "price": "$5 for students (with valid ID), $10 general admission",
        "location": "Songhees Plaza (near the Johnson Street Bridge), 30 Esquimalt Rd, Victoria, BC V9A, Canada",
        "description": "Join us for a vibrant late afternoon of Latin dancing by the ocean! We’ll begin with a beginner-friendly lesson— no partner or experience needed. After the class, enjoy an open-air social featuring a dynamic blend of Salsa, Bachata, and Kizomba, with just a light touch of Merengue to round out the evening."
    }
]
```
2025-06-18 12:48:55 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/9677364319006080/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Victoria Latin Dance Association",
        "dance_style": "bachata, salsa, kizomba, merengue",
        "url": "",
        "event_type": "social dance",
        "event_name": "Sunday Sundown Social: Bachata Temptation, Salsa Sensation",
        "day_of_week": "Sunday",
        "start_date": "2025-07-20",
        "end_date": "2025-07-20",
        "start_time": "15:45",
        "end_time": "19:30",
        "price": "$5 for students (with valid ID), $10 general admission",
        "location": "Songhees Plaza (near the Johnson Street Bridge), 30 Esquimalt Rd, Victoria, BC V9A, Canada",
        "description": "Join us for a vibrant late afternoon of Latin dancing by the ocean! We’ll begin with a beginner-friendly lesson— no partner or experience needed. After the class, enjoy an open-air social featuring a dynamic blend of Salsa, Bachata, and Kizomba, with just a light touch of Merengue to round out the evening."
    }
]
2025-06-18 12:48:55 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:48:55 - INFO - def clean_up_address(): Processing location 'Songhees Plaza (near the Johnson Street Bridge), 30 Esquimalt Rd, Victoria, BC V9A, Canada' (event_id: None)
2025-06-18 12:48:55 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:48:55 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/9677364319006080/'
2025-06-18 12:48:55 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:48:55 - INFO - def process_llm_response: URL https://www.facebook.com/events/9677364319006080/ marked as relevant with events written to the database.
2025-06-18 12:48:55 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/9677364319006080/.
2025-06-18 12:48:55 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1901245437276872/
2025-06-18 12:48:55 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1901245437276872/.
2025-06-18 12:48:55 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1901245437276872/
2025-06-18 12:48:55 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:48:55 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:48:55 - INFO - query_llm(): Querying Mistral
2025-06-18 12:48:58 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:48:58 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "bachata, salsa",
        "url": "",
        "event_type": "social dance",
        "event_name": "Bachata Nights",
        "day_of_week": "Friday",
        "start_date": "2025-05-09",
        "end_date": "2025-05-09",
        "start_time": "20:00",
        "end_time": "00:00",
        "price": "$10 cash per person",
        "location": "Method Studio, 841 Fisgard St, Victoria, British Columbia",
        "description": "Join us on our next Bachata Nights May 09 at Method Studio (841 Fisgard St) for a night of music, dancing, and fun! Schedule: 8:00 PM – Doors open 8:15 PM – All Levels Bachata Lesson 9:00 PM - 12:00 AM – Social Dance"
    }
]
```
2025-06-18 12:48:58 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1901245437276872/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "bachata, salsa",
        "url": "",
        "event_type": "social dance",
        "event_name": "Bachata Nights",
        "day_of_week": "Friday",
        "start_date": "2025-05-09",
        "end_date": "2025-05-09",
        "start_time": "20:00",
        "end_time": "00:00",
        "price": "$10 cash per person",
        "location": "Method Studio, 841 Fisgard St, Victoria, British Columbia",
        "description": "Join us on our next Bachata Nights May 09 at Method Studio (841 Fisgard St) for a night of music, dancing, and fun! Schedule: 8:00 PM – Doors open 8:15 PM – All Levels Bachata Lesson 9:00 PM - 12:00 AM – Social Dance"
    }
]
2025-06-18 12:48:58 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:48:58 - INFO - def clean_up_address(): Processing location 'Method Studio, 841 Fisgard St, Victoria, British Columbia' (event_id: None)
2025-06-18 12:48:58 - INFO - def clean_up_address(): Updated event None with address_id 4948 using DB match
2025-06-18 12:48:58 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:48:58 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1901245437276872/'
2025-06-18 12:48:58 - INFO - def process_llm_response: URL https://www.facebook.com/events/1901245437276872/ marked as relevant with events written to the database.
2025-06-18 12:48:58 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1901245437276872/.
2025-06-18 12:48:58 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/679241811720932/
2025-06-18 12:48:58 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/679241811720932/.
2025-06-18 12:48:58 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/679241811720932/
2025-06-18 12:48:58 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:48:58 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:48:58 - INFO - query_llm(): Querying Mistral
2025-06-18 12:49:14 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:49:14 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "salsa, cha cha cha",
    "url": "",
    "event_type": "class",
    "event_name": "Salsa & Cha Cha Cha- Fundamentals- May Series",
    "day_of_week": "Tuesday",
    "start_date": "2025-05-06",
    "end_date": "2025-05-06",
    "start_time": "21:00",
    "end_time": null,
    "price": "",
    "location": "Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada",
    "description": "This class is perfect for brand new beginners, dancers of other styles, or more experienced dancers that want to continue to improve technique. NY Style Salsa (Mambo) is danced to the rhythm of the congas and the techniques used allow for quick turns and direction changes, complex partner patterns and more body movement while dancing on a crowded dance floor. Cha Cha Cha is a fun dance with a playful energy that uses a very similar step to Salsa and learning them together will help you understand and be better at both. Classes are registered on a monthly basis and take place from 8:00- 9:00pm, Tuesdays, May 6, 13, 20, 27. No experience required. No partner is necessary as we rotate partners throughout the lesson. Call 250-881-6141 or email info@calientedance.com for more details. No drop ins permitted so please contact us to reserve your spot!"
}]
```
2025-06-18 12:49:14 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/679241811720932/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "salsa, cha cha cha",
    "url": "",
    "event_type": "class",
    "event_name": "Salsa & Cha Cha Cha- Fundamentals- May Series",
    "day_of_week": "Tuesday",
    "start_date": "2025-05-06",
    "end_date": "2025-05-06",
    "start_time": "21:00",
    "end_time": null,
    "price": "",
    "location": "Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada",
    "description": "This class is perfect for brand new beginners, dancers of other styles, or more experienced dancers that want to continue to improve technique. NY Style Salsa (Mambo) is danced to the rhythm of the congas and the techniques used allow for quick turns and direction changes, complex partner patterns and more body movement while dancing on a crowded dance floor. Cha Cha Cha is a fun dance with a playful energy that uses a very similar step to Salsa and learning them together will help you understand and be better at both. Classes are registered on a monthly basis and take place from 8:00- 9:00pm, Tuesdays, May 6, 13, 20, 27. No experience required. No partner is necessary as we rotate partners throughout the lesson. Call 250-881-6141 or email info@calientedance.com for more details. No drop ins permitted so please contact us to reserve your spot!"
}]
2025-06-18 12:49:14 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:49:14 - INFO - def clean_up_address(): Processing location 'Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:49:14 - INFO - get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:49:14 - INFO - Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:49:14 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:49:14 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/679241811720932/'
2025-06-18 12:49:14 - INFO - def process_llm_response: URL https://www.facebook.com/events/679241811720932/ marked as relevant with events written to the database.
2025-06-18 12:49:14 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/679241811720932/.
2025-06-18 12:49:14 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1382188962971661/
2025-06-18 12:49:14 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1382188962971661/.
2025-06-18 12:49:14 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1382188962971661/
2025-06-18 12:49:14 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:49:14 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:49:14 - INFO - query_llm(): Querying Mistral
2025-06-18 12:49:22 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:49:22 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "salsa, cha cha cha",
    "url": "",
    "event_type": "class",
    "event_name": "Salsa & Cha Cha Cha- Fundamentals- April Series",
    "day_of_week": "Tuesday",
    "start_date": "2025-04-01",
    "end_date": "2025-04-01",
    "start_time": "20:00",
    "end_time": "21:00",
    "price": "",
    "location": "Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada",
    "description": "This class is perfect for brand new beginners, dancers of other styles, or more experienced dancers that want to continue to improve technique. NY Style Salsa (Mambo) is danced to the rhythm of the congas and the techniques used allow for quick turns and direction changes, complex partner patterns and more body movement while dancing on a crowded dance floor. Cha Cha Cha is a fun dance with a playful energy that uses a very similar step to Salsa and learning them together will help you understand and be better at both. Classes are registered on a monthly basis and take place from 8:00- 9:00pm, Tuesdays, Apr 1, 8, 15, 22, 29 No experience required. No partner is necessary as we rotate partners throughout the lesson. Call 250-881-6141 or email info@calientedance.com for more details. No drop ins permitted so please contact us to reserve your spot!"
}]
```
2025-06-18 12:49:22 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1382188962971661/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "salsa, cha cha cha",
    "url": "",
    "event_type": "class",
    "event_name": "Salsa & Cha Cha Cha- Fundamentals- April Series",
    "day_of_week": "Tuesday",
    "start_date": "2025-04-01",
    "end_date": "2025-04-01",
    "start_time": "20:00",
    "end_time": "21:00",
    "price": "",
    "location": "Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada",
    "description": "This class is perfect for brand new beginners, dancers of other styles, or more experienced dancers that want to continue to improve technique. NY Style Salsa (Mambo) is danced to the rhythm of the congas and the techniques used allow for quick turns and direction changes, complex partner patterns and more body movement while dancing on a crowded dance floor. Cha Cha Cha is a fun dance with a playful energy that uses a very similar step to Salsa and learning them together will help you understand and be better at both. Classes are registered on a monthly basis and take place from 8:00- 9:00pm, Tuesdays, Apr 1, 8, 15, 22, 29 No experience required. No partner is necessary as we rotate partners throughout the lesson. Call 250-881-6141 or email info@calientedance.com for more details. No drop ins permitted so please contact us to reserve your spot!"
}]
2025-06-18 12:49:22 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:49:22 - INFO - def clean_up_address(): Processing location 'Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:49:22 - INFO - get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:49:22 - INFO - Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:49:22 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:49:22 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1382188962971661/'
2025-06-18 12:49:22 - INFO - def process_llm_response: URL https://www.facebook.com/events/1382188962971661/ marked as relevant with events written to the database.
2025-06-18 12:49:22 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1382188962971661/.
2025-06-18 12:49:22 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1342792743590871/
2025-06-18 12:49:22 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1342792743590871/.
2025-06-18 12:49:22 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1342792743590871/
2025-06-18 12:49:22 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:49:22 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:49:22 - INFO - query_llm(): Querying Mistral
2025-06-18 12:49:32 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:49:32 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "salsa, cha cha cha",
    "url": "",
    "event_type": "class",
    "event_name": "Salsa & Cha Cha Cha- Int/ Adv- April series",
    "day_of_week": "Monday",
    "start_date": "2025-04-07",
    "end_date": "2025-04-07",
    "start_time": "20:00",
    "end_time": "21:00",
    "price": "",
    "location": "Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada",
    "description": "NY Style Salsa (Mambo) is danced to the rhythm of the congas and the techniques used allow for quick turns and direction changes, complex partner patterns and more body movement while dancing on a crowded dance floor. Cha Cha Cha is a fun dance with a playful energy that uses a very similar step to Salsa and learning them together will help you understand and be better at both. Classes are registered on a monthly basis and take place from 8:00- 9:00pm, Mondays, April 7, 14, 28. Must be a competent On 2 dancer and have instructor permission to attend. No partner is necessary as we rotate partners throughout the lesson."
}]
```
2025-06-18 12:49:32 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1342792743590871/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "salsa, cha cha cha",
    "url": "",
    "event_type": "class",
    "event_name": "Salsa & Cha Cha Cha- Int/ Adv- April series",
    "day_of_week": "Monday",
    "start_date": "2025-04-07",
    "end_date": "2025-04-07",
    "start_time": "20:00",
    "end_time": "21:00",
    "price": "",
    "location": "Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada",
    "description": "NY Style Salsa (Mambo) is danced to the rhythm of the congas and the techniques used allow for quick turns and direction changes, complex partner patterns and more body movement while dancing on a crowded dance floor. Cha Cha Cha is a fun dance with a playful energy that uses a very similar step to Salsa and learning them together will help you understand and be better at both. Classes are registered on a monthly basis and take place from 8:00- 9:00pm, Mondays, April 7, 14, 28. Must be a competent On 2 dancer and have instructor permission to attend. No partner is necessary as we rotate partners throughout the lesson."
}]
2025-06-18 12:49:32 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:49:32 - INFO - def clean_up_address(): Processing location 'Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:49:32 - INFO - get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:49:32 - INFO - Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:49:32 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:49:32 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1342792743590871/'
2025-06-18 12:49:32 - INFO - def process_llm_response: URL https://www.facebook.com/events/1342792743590871/ marked as relevant with events written to the database.
2025-06-18 12:49:32 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1342792743590871/.
2025-06-18 12:49:32 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/10048344358532607/
2025-06-18 12:49:32 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/10048344358532607/.
2025-06-18 12:49:32 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/10048344358532607/
2025-06-18 12:49:32 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:49:32 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:49:32 - INFO - query_llm(): Querying Mistral
2025-06-18 12:49:38 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:49:38 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "salsa, cha cha cha",
        "url": "",
        "event_type": "class",
        "event_name": "Salsa & Cha Cha Cha- Beg/ Int- May series",
        "day_of_week": "Tuesday",
        "start_date": "2025-05-06",
        "end_date": "2025-05-06",
        "start_time": "21:00",
        "end_time": "22:00",
        "price": "",
        "location": "Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada",
        "description": "This class is for dancers that have completed the Fundamentals course and want to continue to improve their social dancing using the techniques they have learned. NY Style Salsa (Mambo) is danced to the rhythm of the congas and the techniques used allow for quick turns and direction changes, complex partner patterns and more body movement while dancing on a crowded dance floor. Cha Cha Cha is a fun dance with a playful energy that uses a very similar step to Salsa and learning them together will help you understand and be better at both. Classes are registered on a monthly basis and take place every Tuesday from 9:00-10:00pm. No partner is necessary as we rotate partners throughout the lesson. Must have completed Fundamentals or have instructor permission to attend. Call 250-881-6141 or email info@calientedance.com for more details. No drop ins permitted so please contact us to reserve your spot!"
    }
]
```
2025-06-18 12:49:38 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/10048344358532607/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "salsa, cha cha cha",
        "url": "",
        "event_type": "class",
        "event_name": "Salsa & Cha Cha Cha- Beg/ Int- May series",
        "day_of_week": "Tuesday",
        "start_date": "2025-05-06",
        "end_date": "2025-05-06",
        "start_time": "21:00",
        "end_time": "22:00",
        "price": "",
        "location": "Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada",
        "description": "This class is for dancers that have completed the Fundamentals course and want to continue to improve their social dancing using the techniques they have learned. NY Style Salsa (Mambo) is danced to the rhythm of the congas and the techniques used allow for quick turns and direction changes, complex partner patterns and more body movement while dancing on a crowded dance floor. Cha Cha Cha is a fun dance with a playful energy that uses a very similar step to Salsa and learning them together will help you understand and be better at both. Classes are registered on a monthly basis and take place every Tuesday from 9:00-10:00pm. No partner is necessary as we rotate partners throughout the lesson. Must have completed Fundamentals or have instructor permission to attend. Call 250-881-6141 or email info@calientedance.com for more details. No drop ins permitted so please contact us to reserve your spot!"
    }
]
2025-06-18 12:49:38 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:49:38 - INFO - def clean_up_address(): Processing location 'Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:49:38 - INFO - get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:49:38 - INFO - Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:49:38 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:49:38 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/10048344358532607/'
2025-06-18 12:49:38 - INFO - def process_llm_response: URL https://www.facebook.com/events/10048344358532607/ marked as relevant with events written to the database.
2025-06-18 12:49:38 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/10048344358532607/.
2025-06-18 12:49:38 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/966455485665576/
2025-06-18 12:49:38 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/966455485665576/.
2025-06-18 12:49:38 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/966455485665576/
2025-06-18 12:49:38 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:49:38 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:49:38 - INFO - query_llm(): Querying Mistral
2025-06-18 12:49:43 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:49:43 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "salsa, cha cha cha",
        "url": "",
        "event_type": "class",
        "event_name": "Salsa & Cha Cha Cha- Beg/ Int- April series",
        "day_of_week": "Thursday",
        "start_date": "2025-04-03",
        "end_date": "2025-04-03",
        "start_time": "21:00",
        "end_time": null,
        "price": "",
        "location": "Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada",
        "description": "This class is for dancers that have completed the Fundamentals course and want to continue to improve their social dancing using the techniques they have learned. NY Style Salsa (Mambo) is danced to the rhythm of the congas and the techniques used allow for quick turns and direction changes, complex partner patterns and more body movement while dancing on a crowded dance floor. Cha Cha Cha is a fun dance with a playful energy that uses a very similar step to Salsa and learning them together will help you understand and be better at both. Classes are registered on a monthly basis and take place every Tuesday from 9:00-10:00pm. Apr 1, 8, 15, 22, 29 No partner is necessary as we rotate partners throughout the lesson. Must have completed Fundamentals or have instructor permission to attend."
    }
]
```
2025-06-18 12:49:43 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/966455485665576/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "salsa, cha cha cha",
        "url": "",
        "event_type": "class",
        "event_name": "Salsa & Cha Cha Cha- Beg/ Int- April series",
        "day_of_week": "Thursday",
        "start_date": "2025-04-03",
        "end_date": "2025-04-03",
        "start_time": "21:00",
        "end_time": null,
        "price": "",
        "location": "Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada",
        "description": "This class is for dancers that have completed the Fundamentals course and want to continue to improve their social dancing using the techniques they have learned. NY Style Salsa (Mambo) is danced to the rhythm of the congas and the techniques used allow for quick turns and direction changes, complex partner patterns and more body movement while dancing on a crowded dance floor. Cha Cha Cha is a fun dance with a playful energy that uses a very similar step to Salsa and learning them together will help you understand and be better at both. Classes are registered on a monthly basis and take place every Tuesday from 9:00-10:00pm. Apr 1, 8, 15, 22, 29 No partner is necessary as we rotate partners throughout the lesson. Must have completed Fundamentals or have instructor permission to attend."
    }
]
2025-06-18 12:49:43 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:49:43 - INFO - def clean_up_address(): Processing location 'Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:49:43 - INFO - get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:49:43 - INFO - Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:49:43 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:49:43 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/966455485665576/'
2025-06-18 12:49:43 - INFO - def process_llm_response: URL https://www.facebook.com/events/966455485665576/ marked as relevant with events written to the database.
2025-06-18 12:49:43 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/966455485665576/.
2025-06-18 12:49:43 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/669591372187091/
2025-06-18 12:49:43 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/669591372187091/.
2025-06-18 12:49:43 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/669591372187091/
2025-06-18 12:49:43 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:49:43 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:49:43 - INFO - query_llm(): Querying Mistral
2025-06-18 12:49:46 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:49:46 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "Westshore Dance Studios",
    "dance_style": "salsa, chacha",
    "url": "www.westshoredance.com",
    "event_type": "class",
    "event_name": "Salsa & ChaCha Solo",
    "day_of_week": "Saturday",
    "start_date": "2025-05-31",
    "end_date": "2025-05-31",
    "start_time": "10:00",
    "end_time": "11:00",
    "price": "",
    "location": "Westshore Dance Studios 109-2675 Wilfert Road, Victoria",
    "description": "Elevate your dance journey with our Ladies Solo Class. Join our exciting series and learn the basics of Salsa and Cha Cha. Perfect for beginners looking to spice up their dance skills! Class Highlights: - Learn exciting dance moves tailored for solo dancers; - Fun and welcoming environment; - Suitable for absolute beginners. Come dance with us and let the rhythm guide you!"
}]
```
2025-06-18 12:49:46 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/669591372187091/, 
Cleaned JSON ready for parsing:
[{
    "source": "Westshore Dance Studios",
    "dance_style": "salsa, chacha",
    "url": "www.westshoredance.com",
    "event_type": "class",
    "event_name": "Salsa & ChaCha Solo",
    "day_of_week": "Saturday",
    "start_date": "2025-05-31",
    "end_date": "2025-05-31",
    "start_time": "10:00",
    "end_time": "11:00",
    "price": "",
    "location": "Westshore Dance Studios 109-2675 Wilfert Road, Victoria",
    "description": "Elevate your dance journey with our Ladies Solo Class. Join our exciting series and learn the basics of Salsa and Cha Cha. Perfect for beginners looking to spice up their dance skills! Class Highlights: - Learn exciting dance moves tailored for solo dancers; - Fun and welcoming environment; - Suitable for absolute beginners. Come dance with us and let the rhythm guide you!"
}]
2025-06-18 12:49:46 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:49:46 - INFO - def clean_up_address(): Processing location 'Westshore Dance Studios 109-2675 Wilfert Road, Victoria' (event_id: None)
2025-06-18 12:49:46 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:49:46 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/669591372187091/'
2025-06-18 12:49:46 - INFO - def process_llm_response: URL https://www.facebook.com/events/669591372187091/ marked as relevant with events written to the database.
2025-06-18 12:49:46 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/669591372187091/.
2025-06-18 12:49:46 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/2214494908966327/
2025-06-18 12:49:46 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/2214494908966327/.
2025-06-18 12:49:46 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/2214494908966327/
2025-06-18 12:49:46 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:49:46 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:49:46 - INFO - query_llm(): Querying Mistral
2025-06-18 12:49:51 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:49:51 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "salsa, cha cha cha",
    "url": "",
    "event_type": "class",
    "event_name": "Salsa & Cha Cha Cha- Int/ Adv- May series",
    "day_of_week": "Monday",
    "start_date": "2025-05-05",
    "end_date": "2025-05-05",
    "start_time": "21:00",
    "end_time": "22:00",
    "price": "",
    "location": "Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada",
    "description": "NY Style Salsa (Mambo) is danced to the rhythm of the congas and the techniques used allow for quick turns and direction changes, complex partner patterns and more body movement while dancing on a crowded dance floor. Cha Cha Cha is a fun dance with a playful energy that uses a very similar step to Salsa and learning them together will help you understand and be better at both. Classes are registered on a monthly basis and take place from 8:00- 9:00pm, Mondays, May 5, 12, 26. Must be a competent On 2 dancer and have instructor permission to attend. No partner is necessary as we rotate partners throughout the lesson."
}]
```
2025-06-18 12:49:51 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/2214494908966327/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "salsa, cha cha cha",
    "url": "",
    "event_type": "class",
    "event_name": "Salsa & Cha Cha Cha- Int/ Adv- May series",
    "day_of_week": "Monday",
    "start_date": "2025-05-05",
    "end_date": "2025-05-05",
    "start_time": "21:00",
    "end_time": "22:00",
    "price": "",
    "location": "Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada",
    "description": "NY Style Salsa (Mambo) is danced to the rhythm of the congas and the techniques used allow for quick turns and direction changes, complex partner patterns and more body movement while dancing on a crowded dance floor. Cha Cha Cha is a fun dance with a playful energy that uses a very similar step to Salsa and learning them together will help you understand and be better at both. Classes are registered on a monthly basis and take place from 8:00- 9:00pm, Mondays, May 5, 12, 26. Must be a competent On 2 dancer and have instructor permission to attend. No partner is necessary as we rotate partners throughout the lesson."
}]
2025-06-18 12:49:51 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:49:51 - INFO - def clean_up_address(): Processing location 'Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:49:51 - INFO - get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:49:51 - INFO - Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:49:51 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:49:51 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/2214494908966327/'
2025-06-18 12:49:51 - INFO - def process_llm_response: URL https://www.facebook.com/events/2214494908966327/ marked as relevant with events written to the database.
2025-06-18 12:49:51 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/2214494908966327/.
2025-06-18 12:49:51 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1059622278965884/
2025-06-18 12:49:51 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1059622278965884/.
2025-06-18 12:49:51 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1059622278965884/
2025-06-18 12:49:51 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:49:51 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:49:51 - INFO - query_llm(): Querying Mistral
2025-06-18 12:49:55 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:49:55 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "Facebook",
        "dance_style": "salsa, bachata, merengue",
        "url": "",
        "event_type": "social dance",
        "event_name": "Caliente Salsa Saturdays",
        "day_of_week": "Saturday",
        "start_date": "2025-11-08",
        "end_date": "2025-11-08",
        "start_time": "20:15",
        "end_time": "00:00",
        "price": "$15.00 per person CASH ONLY at the door",
        "location": "Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada",
        "description": "Join us for Caliente Salsa Saturdays! 8:15pm Doors open 8:30pm Beginner Salsa Lesson No partner or experience required.  Taught by World Salsa University certified instructor, Christina Morrison. No experience or partner is necessary as we rotate partners throughout the lesson so you will already know a LOT of people by the time the dancing begins. 9:00pm- midnight Dancing for all levels to Salsa, Bachata, Merengue & Cha Cha Cha. Ages 16+ welcome."
    }
]
```
2025-06-18 12:49:55 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1059622278965884/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Facebook",
        "dance_style": "salsa, bachata, merengue",
        "url": "",
        "event_type": "social dance",
        "event_name": "Caliente Salsa Saturdays",
        "day_of_week": "Saturday",
        "start_date": "2025-11-08",
        "end_date": "2025-11-08",
        "start_time": "20:15",
        "end_time": "00:00",
        "price": "$15.00 per person CASH ONLY at the door",
        "location": "Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada",
        "description": "Join us for Caliente Salsa Saturdays! 8:15pm Doors open 8:30pm Beginner Salsa Lesson No partner or experience required.  Taught by World Salsa University certified instructor, Christina Morrison. No experience or partner is necessary as we rotate partners throughout the lesson so you will already know a LOT of people by the time the dancing begins. 9:00pm- midnight Dancing for all levels to Salsa, Bachata, Merengue & Cha Cha Cha. Ages 16+ welcome."
    }
]
2025-06-18 12:49:56 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:49:56 - INFO - def clean_up_address(): Processing location 'Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:49:56 - INFO - get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:49:56 - INFO - Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:49:56 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:49:56 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1059622278965884/'
2025-06-18 12:49:56 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:49:56 - INFO - def process_llm_response: URL https://www.facebook.com/events/1059622278965884/ marked as relevant with events written to the database.
2025-06-18 12:49:56 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1059622278965884/.
2025-06-18 12:49:56 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/530862806349067/
2025-06-18 12:49:56 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/530862806349067/.
2025-06-18 12:49:56 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/530862806349067/
2025-06-18 12:49:56 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:49:56 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:49:56 - INFO - query_llm(): Querying Mistral
2025-06-18 12:49:59 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:49:59 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Salsa Gonzales tasting!",
    "day_of_week": "Sunday",
    "start_date": "2025-03-30",
    "end_date": "2025-03-30",
    "start_time": "13:00",
    "end_time": "17:00",
    "price": "",
    "location": "THE ROOT CELLAR | village green grocer, 1286 McKenzie Avenue, Victoria, BC, Canada, British Columbia",
    "description": "It's time to get those tastebuds tingling - you're invited to come and join us for a Salsa Gonzales tasting at our McKenzie Corner store! Salsa Gonzales is a little condiment company with a big personality! Nestled on Gonzales Beach in Victoria, they craft salsas, hot sauces, pickles, preserves, and more – all with a generous splash of love and a fiery kick."
}]
```
2025-06-18 12:49:59 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/530862806349067/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "Salsa Gonzales tasting!",
    "day_of_week": "Sunday",
    "start_date": "2025-03-30",
    "end_date": "2025-03-30",
    "start_time": "13:00",
    "end_time": "17:00",
    "price": "",
    "location": "THE ROOT CELLAR | village green grocer, 1286 McKenzie Avenue, Victoria, BC, Canada, British Columbia",
    "description": "It's time to get those tastebuds tingling - you're invited to come and join us for a Salsa Gonzales tasting at our McKenzie Corner store! Salsa Gonzales is a little condiment company with a big personality! Nestled on Gonzales Beach in Victoria, they craft salsas, hot sauces, pickles, preserves, and more – all with a generous splash of love and a fiery kick."
}]
2025-06-18 12:49:59 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:49:59 - INFO - def clean_up_address(): Processing location 'THE ROOT CELLAR | village green grocer, 1286 McKenzie Avenue, Victoria, BC, Canada, British Columbia' (event_id: None)
2025-06-18 12:49:59 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:49:59 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/530862806349067/'
2025-06-18 12:49:59 - INFO - def process_llm_response: URL https://www.facebook.com/events/530862806349067/ marked as relevant with events written to the database.
2025-06-18 12:49:59 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/530862806349067/.
2025-06-18 12:49:59 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1636237610432412/
2025-06-18 12:49:59 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1636237610432412/.
2025-06-18 12:49:59 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1636237610432412/
2025-06-18 12:49:59 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:49:59 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:49:59 - INFO - query_llm(): Querying Mistral
2025-06-18 12:50:04 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:50:04 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "Latin Dance Canada",
        "dance_style": "salsa, bachata, merengue",
        "url": "",
        "event_type": "social dance",
        "event_name": "Salsa Sunset Latin Party – August 16th!",
        "day_of_week": "Saturday",
        "start_date": "2025-08-16",
        "end_date": "2025-08-16",
        "start_time": "20:00",
        "end_time": "23:59",
        "price": "$15",
        "location": "Ukrainian Cultural Centre, 3277 Douglas St., Victoria, BC",
        "description": "Get ready for a magical summer night filled with Latin rhythms, sunset vibes, and non-stop dancing! Join us for the Salsa Sunset Latin Party, where the Salsa, Bachata, and Merengue beats will keep you moving all night long under the stunning sunset sky! Dress Code: Wear your best sunset-inspired outfit – think bright, tropical colors, and beach party vibes! Dance to the best Salsa, Bachata, Merengue & Latin hits all night! No partner? No problem! Join our fun intro class at 8:00 PM! Intro Class: 8:00 PM | Social Dance: 8:30 PM - Late"
    }
]
```
2025-06-18 12:50:04 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1636237610432412/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Latin Dance Canada",
        "dance_style": "salsa, bachata, merengue",
        "url": "",
        "event_type": "social dance",
        "event_name": "Salsa Sunset Latin Party – August 16th!",
        "day_of_week": "Saturday",
        "start_date": "2025-08-16",
        "end_date": "2025-08-16",
        "start_time": "20:00",
        "end_time": "23:59",
        "price": "$15",
        "location": "Ukrainian Cultural Centre, 3277 Douglas St., Victoria, BC",
        "description": "Get ready for a magical summer night filled with Latin rhythms, sunset vibes, and non-stop dancing! Join us for the Salsa Sunset Latin Party, where the Salsa, Bachata, and Merengue beats will keep you moving all night long under the stunning sunset sky! Dress Code: Wear your best sunset-inspired outfit – think bright, tropical colors, and beach party vibes! Dance to the best Salsa, Bachata, Merengue & Latin hits all night! No partner? No problem! Join our fun intro class at 8:00 PM! Intro Class: 8:00 PM | Social Dance: 8:30 PM - Late"
    }
]
2025-06-18 12:50:04 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:50:04 - INFO - def clean_up_address(): Processing location 'Ukrainian Cultural Centre, 3277 Douglas St., Victoria, BC' (event_id: None)
2025-06-18 12:50:04 - INFO - def clean_up_address(): Updated event None with address_id 4317 using DB match
2025-06-18 12:50:04 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:50:04 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1636237610432412/'
2025-06-18 12:50:04 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:50:04 - INFO - def process_llm_response: URL https://www.facebook.com/events/1636237610432412/ marked as relevant with events written to the database.
2025-06-18 12:50:04 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1636237610432412/.
2025-06-18 12:50:04 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/2251848171850840/
2025-06-18 12:50:04 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/2251848171850840/.
2025-06-18 12:50:04 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/2251848171850840/
2025-06-18 12:50:04 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:50:04 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:50:04 - INFO - query_llm(): Querying Mistral
2025-06-18 12:50:08 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:50:08 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "Facebook",
    "dance_style": "salsa, bachata, merengue",
    "url": "https://www.facebook.com",
    "event_type": "social dance",
    "event_name": "Caliente Salsa Saturdays",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "20:15",
    "end_time": null,
    "price": "$15.00 per person CASH ONLY at the door.",
    "location": "Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada",
    "description": "Join us for Caliente Salsa Saturdays! 8:15pm Doors open. 8:30pm Beginner Salsa Lesson. No partner or experience required. 9:00pm- midnight Dancing for all levels to Salsa, Bachata, Merengue & Cha Cha Cha. Ages 16+ welcome. Tickets also available on Eventbrite in April. There will be a small non-alcoholic concession available as a fundraiser for the teams. *Limited capacity. First come first served. We reserve the right to refuse entrance at the door. The venue is only accessible via stairs."
}]
```
2025-06-18 12:50:08 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/2251848171850840/, 
Cleaned JSON ready for parsing:
[{
    "source": "Facebook",
    "dance_style": "salsa, bachata, merengue",
    "url": "https://www.facebook.com",
    "event_type": "social dance",
    "event_name": "Caliente Salsa Saturdays",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "20:15",
    "end_time": null,
    "price": "$15.00 per person CASH ONLY at the door.",
    "location": "Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada",
    "description": "Join us for Caliente Salsa Saturdays! 8:15pm Doors open. 8:30pm Beginner Salsa Lesson. No partner or experience required. 9:00pm- midnight Dancing for all levels to Salsa, Bachata, Merengue & Cha Cha Cha. Ages 16+ welcome. Tickets also available on Eventbrite in April. There will be a small non-alcoholic concession available as a fundraiser for the teams. *Limited capacity. First come first served. We reserve the right to refuse entrance at the door. The venue is only accessible via stairs."
}]
2025-06-18 12:50:08 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:50:08 - INFO - def clean_up_address(): Processing location 'Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:50:08 - INFO - get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:50:08 - INFO - Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:50:08 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:50:08 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/2251848171850840/'
2025-06-18 12:50:08 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:50:08 - INFO - def process_llm_response: URL https://www.facebook.com/events/2251848171850840/ marked as relevant with events written to the database.
2025-06-18 12:50:08 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/2251848171850840/.
2025-06-18 12:50:08 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/884101187183426/
2025-06-18 12:50:08 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/884101187183426/.
2025-06-18 12:50:08 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/884101187183426/
2025-06-18 12:50:08 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:50:08 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:50:08 - INFO - query_llm(): Querying Mistral
2025-06-18 12:50:12 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:50:12 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "Facebook",
        "dance_style": "salsa, bachata, merengue",
        "url": "www.eventbrite.com/e/caliente-salsa-saturdays-tickets-1415724884239",
        "event_type": "social dance",
        "event_name": "Caliente Salsa Saturdays",
        "day_of_week": "Saturday",
        "start_date": "2025-07-12",
        "end_date": "2025-07-12",
        "start_time": "20:15",
        "end_time": null,
        "price": "$15.00",
        "location": "Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada",
        "description": "Join us for Caliente Salsa Saturdays! 8:15pm Doors open 8:30pm Beginner Salsa Lesson No partner or experience required.  Taught by World Salsa University certified instructor, Christina Morrison. No experience or partner is necessary as we rotate partners throughout the lesson so you will already know a LOT of people by the time the dancing begins. 9:00pm- midnight Dancing for all levels to Salsa, Bachata, Merengue & Cha Cha Cha. Ages 16+ welcome."
    }
]
```
2025-06-18 12:50:12 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/884101187183426/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Facebook",
        "dance_style": "salsa, bachata, merengue",
        "url": "www.eventbrite.com/e/caliente-salsa-saturdays-tickets-1415724884239",
        "event_type": "social dance",
        "event_name": "Caliente Salsa Saturdays",
        "day_of_week": "Saturday",
        "start_date": "2025-07-12",
        "end_date": "2025-07-12",
        "start_time": "20:15",
        "end_time": null,
        "price": "$15.00",
        "location": "Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada",
        "description": "Join us for Caliente Salsa Saturdays! 8:15pm Doors open 8:30pm Beginner Salsa Lesson No partner or experience required.  Taught by World Salsa University certified instructor, Christina Morrison. No experience or partner is necessary as we rotate partners throughout the lesson so you will already know a LOT of people by the time the dancing begins. 9:00pm- midnight Dancing for all levels to Salsa, Bachata, Merengue & Cha Cha Cha. Ages 16+ welcome."
    }
]
2025-06-18 12:50:12 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:50:12 - INFO - def clean_up_address(): Processing location 'Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:50:12 - INFO - get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:50:12 - INFO - Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:50:12 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:50:12 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/884101187183426/'
2025-06-18 12:50:12 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:50:12 - INFO - def process_llm_response: URL https://www.facebook.com/events/884101187183426/ marked as relevant with events written to the database.
2025-06-18 12:50:12 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/884101187183426/.
2025-06-18 12:50:12 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/3899920353641309/
2025-06-18 12:50:12 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/3899920353641309/.
2025-06-18 12:50:12 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/3899920353641309/
2025-06-18 12:50:12 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:50:12 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:50:12 - INFO - query_llm(): Querying Mistral
2025-06-18 12:50:17 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:50:17 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "Facebook",
        "dance_style": "salsa, bachata, merengue, cha cha cha",
        "url": "",
        "event_type": "social dance",
        "event_name": "Caliente Salsa Saturdays",
        "day_of_week": "Saturday",
        "start_date": "2025-08-09",
        "end_date": "2025-08-09",
        "start_time": "20:15",
        "end_time": "00:00",
        "price": "$15.00",
        "location": "Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada",
        "description": "Join us for Caliente Salsa Saturdays! 8:15pm Doors open. 8:30pm Beginner Salsa Lesson. 9:00pm- midnight Dancing for all levels to Salsa, Bachata, Merengue & Cha Cha Cha. Ages 16+ welcome. $15.00 per person CASH ONLY at the door. Tickets also available on Eventbrite in July. There will be a small non-alcoholic concession available as a fundraiser for the teams. *Limited capacity. First come first served. We reserve the right to refuse entrance at the door. The venue is only accessible via stairs.*"
    }
]
```
2025-06-18 12:50:17 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/3899920353641309/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Facebook",
        "dance_style": "salsa, bachata, merengue, cha cha cha",
        "url": "",
        "event_type": "social dance",
        "event_name": "Caliente Salsa Saturdays",
        "day_of_week": "Saturday",
        "start_date": "2025-08-09",
        "end_date": "2025-08-09",
        "start_time": "20:15",
        "end_time": "00:00",
        "price": "$15.00",
        "location": "Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada",
        "description": "Join us for Caliente Salsa Saturdays! 8:15pm Doors open. 8:30pm Beginner Salsa Lesson. 9:00pm- midnight Dancing for all levels to Salsa, Bachata, Merengue & Cha Cha Cha. Ages 16+ welcome. $15.00 per person CASH ONLY at the door. Tickets also available on Eventbrite in July. There will be a small non-alcoholic concession available as a fundraiser for the teams. *Limited capacity. First come first served. We reserve the right to refuse entrance at the door. The venue is only accessible via stairs.*"
    }
]
2025-06-18 12:50:17 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:50:17 - INFO - def clean_up_address(): Processing location 'Studio 4 Athletics, 709 Yates St, Victoria, BC V8W 1L6, Canada' (event_id: None)
2025-06-18 12:50:17 - INFO - get_address_id: Inserted or updated address_id 65 for address '725 Yates ST, VICTORIA, BC, V8W1L6, CA'.
2025-06-18 12:50:17 - INFO - Populated from DB for postal code 'V8W1L6': '725 Yates ST, VICTORIA, BC, V8W1L6, CA'
2025-06-18 12:50:17 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:50:18 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/3899920353641309/'
2025-06-18 12:50:18 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:50:18 - INFO - def process_llm_response: URL https://www.facebook.com/events/3899920353641309/ marked as relevant with events written to the database.
2025-06-18 12:50:18 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/3899920353641309/.
2025-06-18 12:50:18 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1411005319893067/
2025-06-18 12:50:18 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1411005319893067/.
2025-06-18 12:50:18 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1411005319893067/
2025-06-18 12:50:18 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:50:18 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:50:18 - INFO - query_llm(): Querying Mistral
2025-06-18 12:50:24 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:50:24 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "bachata, brazilian zouk",
        "url": "",
        "event_type": "class",
        "event_name": "Bachata & Brazilian Zouk dance classes",
        "day_of_week": "Monday",
        "start_date": "2025-04-28",
        "end_date": "2025-04-28",
        "start_time": "18:30",
        "end_time": "22:30",
        "price": "$20 | 1 Class $35 | 2 Classes (Brazilian Zouk 1&2, or Brazilian Zouk 1 & Bachata, Bachata 1&2) $50| 3 Classes (3 classes, BEST value)",
        "location": "1709 Blanshard St, Victoria, BC V8W 2J8, Canada",
        "description": "Join us for a 4 week course exploring the joy and magic of Brazilian Zouk & Bachata dancing! Discover your new passion! Latin Dancing! Experience a new level of joy and connection by learning two popular dance styles focusing on enhancing body awareness, building confidence in dance vocabulary with lead and follow techniques, exploring musicality, and loving yourself deeper with styling! Be prepared to have lots of fun dancing with new friends! Schedule: Monday April 7 - 28th 6:30-7:25pm | Brazilian Zouk - Level 2 (ask Javi for permission) 7:30-8:25pm | Brazilian Zouk - Level 1 8:30-9:25pm | Sensual Bachata - Beginner Foundations 9:30-10:30pm | Sensual Bachata - Intermediate 'Trending Moves' Tuition: $20 | 1 Class $35 | 2 Classes (Brazilian Zouk 1&2, or Brazilian Zouk 1 & Bachata, Bachata 1&2) $50| 3 Classes (3 classes, BEST value)."
    }
]
```
2025-06-18 12:50:24 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1411005319893067/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "bachata, brazilian zouk",
        "url": "",
        "event_type": "class",
        "event_name": "Bachata & Brazilian Zouk dance classes",
        "day_of_week": "Monday",
        "start_date": "2025-04-28",
        "end_date": "2025-04-28",
        "start_time": "18:30",
        "end_time": "22:30",
        "price": "$20 | 1 Class $35 | 2 Classes (Brazilian Zouk 1&2, or Brazilian Zouk 1 & Bachata, Bachata 1&2) $50| 3 Classes (3 classes, BEST value)",
        "location": "1709 Blanshard St, Victoria, BC V8W 2J8, Canada",
        "description": "Join us for a 4 week course exploring the joy and magic of Brazilian Zouk & Bachata dancing! Discover your new passion! Latin Dancing! Experience a new level of joy and connection by learning two popular dance styles focusing on enhancing body awareness, building confidence in dance vocabulary with lead and follow techniques, exploring musicality, and loving yourself deeper with styling! Be prepared to have lots of fun dancing with new friends! Schedule: Monday April 7 - 28th 6:30-7:25pm | Brazilian Zouk - Level 2 (ask Javi for permission) 7:30-8:25pm | Brazilian Zouk - Level 1 8:30-9:25pm | Sensual Bachata - Beginner Foundations 9:30-10:30pm | Sensual Bachata - Intermediate 'Trending Moves' Tuition: $20 | 1 Class $35 | 2 Classes (Brazilian Zouk 1&2, or Brazilian Zouk 1 & Bachata, Bachata 1&2) $50| 3 Classes (3 classes, BEST value)."
    }
]
2025-06-18 12:50:25 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:50:25 - INFO - def clean_up_address(): Processing location '1709 Blanshard St, Victoria, BC V8W 2J8, Canada' (event_id: None)
2025-06-18 12:50:25 - INFO - get_address_id: Inserted or updated address_id 2654 for address '1703 Blanshard ST, VICTORIA, BC, V8W2J8, CA'.
2025-06-18 12:50:25 - INFO - Populated from DB for postal code 'V8W2J8': '1703 Blanshard ST, VICTORIA, BC, V8W2J8, CA'
2025-06-18 12:50:25 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:50:25 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1411005319893067/'
2025-06-18 12:50:25 - INFO - def process_llm_response: URL https://www.facebook.com/events/1411005319893067/ marked as relevant with events written to the database.
2025-06-18 12:50:25 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1411005319893067/.
2025-06-18 12:50:25 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1106484714432492/
2025-06-18 12:50:25 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1106484714432492/.
2025-06-18 12:50:25 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1106484714432492/
2025-06-18 12:50:25 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:50:25 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:50:25 - INFO - query_llm(): Querying Mistral
2025-06-18 12:50:28 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:50:28 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "zouk",
    "url": "",
    "event_type": "social dance",
    "event_name": "Zouk practica and social",
    "day_of_week": "Wednesday",
    "start_date": "2025-06-25",
    "end_date": "2025-06-25",
    "start_time": "18:30",
    "end_time": "21:00",
    "price": "$5",
    "location": "White Eagle Hall, 90 Dock St, Victoria BC",
    "description": "Drop-in zouk practica by donation - everyone welcome! Shared warm up, free dance time, review material from lessons and congresses, connect and share knowledge! Help is always available. Minimum $5 donation. Cash at the door, or etransfer to oceanzouk@gmail.com. Enter the lower hall by the side door on Niagara Street just beside the Polka food truck. Recurring event every Wednesday."
}]
```
2025-06-18 12:50:28 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1106484714432492/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "zouk",
    "url": "",
    "event_type": "social dance",
    "event_name": "Zouk practica and social",
    "day_of_week": "Wednesday",
    "start_date": "2025-06-25",
    "end_date": "2025-06-25",
    "start_time": "18:30",
    "end_time": "21:00",
    "price": "$5",
    "location": "White Eagle Hall, 90 Dock St, Victoria BC",
    "description": "Drop-in zouk practica by donation - everyone welcome! Shared warm up, free dance time, review material from lessons and congresses, connect and share knowledge! Help is always available. Minimum $5 donation. Cash at the door, or etransfer to oceanzouk@gmail.com. Enter the lower hall by the side door on Niagara Street just beside the Polka food truck. Recurring event every Wednesday."
}]
2025-06-18 12:50:28 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:50:28 - INFO - def clean_up_address(): Processing location 'White Eagle Hall, 90 Dock St, Victoria BC' (event_id: None)
2025-06-18 12:50:28 - INFO - def clean_up_address(): Updated event None with address_id 2635 using DB match
2025-06-18 12:50:28 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:50:28 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1106484714432492/'
2025-06-18 12:50:28 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:50:28 - INFO - def process_llm_response: URL https://www.facebook.com/events/1106484714432492/ marked as relevant with events written to the database.
2025-06-18 12:50:28 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1106484714432492/.
2025-06-18 12:50:28 - INFO - def driver_fb_search(): Keywords checkpoint updated.
2025-06-18 12:50:31 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q=balboa&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:50:31 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q=balboa&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:50:36 - INFO - extract_event_links(): Found 1 links on https://www.facebook.com/search/events?q=balboa&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:50:36 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q=balboa&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 1 event_links

2025-06-18 12:50:36 - INFO - should_process_url: URL https://www.facebook.com/events/544121845403419/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:50:39 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/544121845403419/ (10691 ms)
2025-06-18 12:50:57 - INFO - extract_event_text: extracted 3378 chars
2025-06-18 12:50:57 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/544121845403419/.
2025-06-18 12:50:57 - INFO - def scrape_events(): Keywords: ['balboa', 'dance', 'swing']: found in text for URL: https://www.facebook.com/events/544121845403419/.
2025-06-18 12:51:01 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q= east coast swing&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:51:01 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q= east coast swing&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:51:10 - INFO - extract_event_links(): Found 0 links on https://www.facebook.com/search/events?q= east coast swing&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:51:10 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q= east coast swing&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 0 event_links

2025-06-18 12:51:14 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q=  lindy hop&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:51:14 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q=  lindy hop&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:51:20 - INFO - extract_event_links(): Found 0 links on https://www.facebook.com/search/events?q=  lindy hop&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:51:20 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q=  lindy hop&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 0 event_links

2025-06-18 12:51:24 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q= swing&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:51:24 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q= swing&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:51:29 - INFO - extract_event_links(): Found 14 links on https://www.facebook.com/search/events?q= swing&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:51:29 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q= swing&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 14 event_links

2025-06-18 12:51:29 - INFO - should_process_url: URL https://www.facebook.com/events/302778660295534/ was last seen as relevant, processing it.
2025-06-18 12:51:33 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/302778660295534/ (14053 ms)
2025-06-18 12:51:50 - INFO - extract_event_text: extracted 3077 chars
2025-06-18 12:51:50 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/302778660295534/.
2025-06-18 12:51:50 - INFO - def scrape_events(): Keywords: ['dance', 'swing', 'wcs', 'west coast swing']: found in text for URL: https://www.facebook.com/events/302778660295534/.
2025-06-18 12:51:50 - INFO - should_process_url: URL https://www.facebook.com/events/417338985546213/ was last seen as relevant, processing it.
2025-06-18 12:51:53 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/417338985546213/ (13420 ms)
2025-06-18 12:52:15 - INFO - extract_event_text: extracted 4254 chars
2025-06-18 12:52:15 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/417338985546213/.
2025-06-18 12:52:15 - INFO - def scrape_events(): Keywords: ['dance', 'swing', 'wcs', 'west coast swing']: found in text for URL: https://www.facebook.com/events/417338985546213/.
2025-06-18 12:52:15 - INFO - should_process_url: URL https://www.facebook.com/events/634773653668605/ was last seen as relevant, processing it.
2025-06-18 12:52:18 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/634773653668605/ (11944 ms)
2025-06-18 12:52:35 - INFO - extract_event_text: extracted 3984 chars
2025-06-18 12:52:35 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/634773653668605/.
2025-06-18 12:52:35 - INFO - def scrape_events(): Keywords: ['dance', 'swing', 'wcs', 'west coast swing']: found in text for URL: https://www.facebook.com/events/634773653668605/.
2025-06-18 12:52:35 - INFO - should_process_url: URL https://www.facebook.com/events/1692156731689650/ was last seen as relevant, processing it.
2025-06-18 12:52:38 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1692156731689650/ (13120 ms)
2025-06-18 12:52:59 - INFO - extract_event_text: extracted 3611 chars
2025-06-18 12:52:59 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1692156731689650/.
2025-06-18 12:52:59 - INFO - def scrape_events(): Keywords: ['dance', 'swing', 'wcs', 'west coast swing']: found in text for URL: https://www.facebook.com/events/1692156731689650/.
2025-06-18 12:52:59 - INFO - should_process_url: URL https://www.facebook.com/events/1594011994641933/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:53:03 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1594011994641933/ (12207 ms)
2025-06-18 12:53:22 - INFO - extract_event_text: extracted 3448 chars
2025-06-18 12:53:22 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1594011994641933/.
2025-06-18 12:53:22 - INFO - def scrape_events(): Keywords: ['dance', 'swing', 'wcs', 'west coast swing']: found in text for URL: https://www.facebook.com/events/1594011994641933/.
2025-06-18 12:53:22 - INFO - should_process_url: URL https://www.facebook.com/events/373500473108499/ was last seen as relevant, processing it.
2025-06-18 12:53:25 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/373500473108499/ (14257 ms)
2025-06-18 12:53:43 - INFO - extract_event_text: extracted 3132 chars
2025-06-18 12:53:43 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/373500473108499/.
2025-06-18 12:53:43 - INFO - def scrape_events(): Keywords: ['swing']: found in text for URL: https://www.facebook.com/events/373500473108499/.
2025-06-18 12:53:43 - INFO - should_process_url: URL https://www.facebook.com/events/1776457206589544/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:53:46 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1776457206589544/ (14883 ms)
2025-06-18 12:54:06 - INFO - extract_event_text: extracted 3097 chars
2025-06-18 12:54:06 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1776457206589544/.
2025-06-18 12:54:06 - INFO - def scrape_events(): Keywords: ['dance', 'music festivals', 'swing']: found in text for URL: https://www.facebook.com/events/1776457206589544/.
2025-06-18 12:54:06 - INFO - should_process_url: URL https://www.facebook.com/events/2441697862726705/ was last seen as relevant, processing it.
2025-06-18 12:54:12 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/2441697862726705/ (14030 ms)
2025-06-18 12:54:27 - INFO - extract_event_text: extracted 2946 chars
2025-06-18 12:54:27 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/2441697862726705/.
2025-06-18 12:54:27 - INFO - def scrape_events(): Keywords: ['dance', 'swing', 'west coast swing']: found in text for URL: https://www.facebook.com/events/2441697862726705/.
2025-06-18 12:54:27 - INFO - should_process_url: URL https://www.facebook.com/events/1035925295253912/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:54:30 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1035925295253912/ (13047 ms)
2025-06-18 12:54:49 - INFO - extract_event_text: extracted 2658 chars
2025-06-18 12:54:49 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1035925295253912/.
2025-06-18 12:54:49 - INFO - def scrape_events(): Keywords: ['dance', 'swing']: found in text for URL: https://www.facebook.com/events/1035925295253912/.
2025-06-18 12:54:49 - INFO - should_process_url: URL https://www.facebook.com/events/663756533046485/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:54:52 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/663756533046485/ (14199 ms)
2025-06-18 12:55:11 - INFO - extract_event_text: extracted 3299 chars
2025-06-18 12:55:11 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/663756533046485/.
2025-06-18 12:55:11 - INFO - def scrape_events(): Keywords: ['dance', 'swing']: found in text for URL: https://www.facebook.com/events/663756533046485/.
2025-06-18 12:55:11 - INFO - should_process_url: URL https://www.facebook.com/events/402729737034904/ was last seen as relevant, processing it.
2025-06-18 12:55:15 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/402729737034904/ (14816 ms)
2025-06-18 12:55:42 - INFO - extract_event_text: extracted 4274 chars
2025-06-18 12:55:42 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/402729737034904/.
2025-06-18 12:55:42 - INFO - def scrape_events(): Keywords: ['dance', 'swing', 'wcs', 'west coast swing']: found in text for URL: https://www.facebook.com/events/402729737034904/.
2025-06-18 12:55:42 - INFO - def scrape_events(): Extracted text from 12 events.
2025-06-18 12:55:42 - INFO - def scrape_events(): Extracted text data written to checkpoint/extracted_text.xlsx.
2025-06-18 12:55:42 - INFO - def driver_fb_search(): Extracted text based on search_url: https://www.facebook.com/search/events?q= swing&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9.
2025-06-18 12:55:42 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/544121845403419/
2025-06-18 12:55:42 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/544121845403419/.
2025-06-18 12:55:42 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/544121845403419/
2025-06-18 12:55:42 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:55:42 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:55:42 - INFO - query_llm(): Querying Mistral
2025-06-18 12:55:45 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:55:45 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "balboa",
        "url": "",
        "event_type": "workshop",
        "event_name": "Swing Session: Balboa with Yoshi and Etsuko",
        "day_of_week": "Saturday",
        "start_date": "2025-05-31",
        "end_date": "2025-05-31",
        "start_time": "13:00",
        "end_time": "23:55",
        "price": "",
        "location": "Solwood Studio, 1303 Broad St, Victoria, BC V8W 2A8, Canada",
        "description": "An afternoon of Balboa Classes and an evening of Social Dancing with Yoshi and Etsuko Uemura. 4 Classes for everyone & 1 Social Dance! Passes go on sale April 19 at noon at our SDAV Square Shop. You must know and be comfortable with Balboa basics for all of these classes - they won't be covered at this workshop."
    }
]
```
2025-06-18 12:55:45 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/544121845403419/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "balboa",
        "url": "",
        "event_type": "workshop",
        "event_name": "Swing Session: Balboa with Yoshi and Etsuko",
        "day_of_week": "Saturday",
        "start_date": "2025-05-31",
        "end_date": "2025-05-31",
        "start_time": "13:00",
        "end_time": "23:55",
        "price": "",
        "location": "Solwood Studio, 1303 Broad St, Victoria, BC V8W 2A8, Canada",
        "description": "An afternoon of Balboa Classes and an evening of Social Dancing with Yoshi and Etsuko Uemura. 4 Classes for everyone & 1 Social Dance! Passes go on sale April 19 at noon at our SDAV Square Shop. You must know and be comfortable with Balboa basics for all of these classes - they won't be covered at this workshop."
    }
]
2025-06-18 12:55:45 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:55:45 - INFO - def clean_up_address(): Processing location 'Solwood Studio, 1303 Broad St, Victoria, BC V8W 2A8, Canada' (event_id: None)
2025-06-18 12:55:45 - INFO - def clean_up_address(): Updated event None with address_id 1928 using DB match
2025-06-18 12:55:45 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:55:45 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/544121845403419/'
2025-06-18 12:55:45 - INFO - def process_llm_response: URL https://www.facebook.com/events/544121845403419/ marked as relevant with events written to the database.
2025-06-18 12:55:45 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/544121845403419/.
2025-06-18 12:55:45 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/302778660295534/
2025-06-18 12:55:45 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/302778660295534/.
2025-06-18 12:55:45 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/302778660295534/
2025-06-18 12:55:45 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:55:45 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:55:45 - INFO - query_llm(): Querying Mistral
2025-06-18 12:55:50 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:55:50 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "West Coast Swing in the Park!",
        "day_of_week": "Sunday",
        "start_date": "2026-08-16",
        "end_date": "2026-08-16",
        "start_time": "18:00",
        "end_time": "21:00",
        "price": "",
        "location": "Cameron Bandshell @ Beacon Hill Park Victoria, British Columbia",
        "description": "Come join us for another evening of fun and WCS dancing in Beacon Hill Park! WCS music will be provided by DJ Carolyn. For those who are familiar with the routine, the 2018 WCS Rally Song will be played at 6:30, 7:30 and 8:30pm. Sam Jackson and Meaghan Efford, from wcsmovementmethods.com will be on hand to answer questions about WCS or how to improve your WCS dancing. They will also demo some incredible WCS dancing at 7pm. Please invite your WCS dance friends by sharing this event!"
    }
]
```
2025-06-18 12:55:50 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/302778660295534/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "West Coast Swing in the Park!",
        "day_of_week": "Sunday",
        "start_date": "2026-08-16",
        "end_date": "2026-08-16",
        "start_time": "18:00",
        "end_time": "21:00",
        "price": "",
        "location": "Cameron Bandshell @ Beacon Hill Park Victoria, British Columbia",
        "description": "Come join us for another evening of fun and WCS dancing in Beacon Hill Park! WCS music will be provided by DJ Carolyn. For those who are familiar with the routine, the 2018 WCS Rally Song will be played at 6:30, 7:30 and 8:30pm. Sam Jackson and Meaghan Efford, from wcsmovementmethods.com will be on hand to answer questions about WCS or how to improve your WCS dancing. They will also demo some incredible WCS dancing at 7pm. Please invite your WCS dance friends by sharing this event!"
    }
]
2025-06-18 12:55:50 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:55:50 - INFO - def clean_up_address(): Processing location 'Cameron Bandshell @ Beacon Hill Park Victoria, British Columbia' (event_id: None)
2025-06-18 12:55:50 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:55:50 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/302778660295534/'
2025-06-18 12:55:50 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:55:50 - INFO - def process_llm_response: URL https://www.facebook.com/events/302778660295534/ marked as relevant with events written to the database.
2025-06-18 12:55:50 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/302778660295534/.
2025-06-18 12:55:50 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/417338985546213/
2025-06-18 12:55:50 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/417338985546213/.
2025-06-18 12:55:50 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/417338985546213/
2025-06-18 12:55:50 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:55:50 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:55:50 - INFO - query_llm(): Querying Mistral
2025-06-18 12:55:53 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:55:53 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "BC Swing Dance Club Victoria Centennial Square",
    "dance_style": "west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "Free EVENT - West Coast Swing in the Square - August 29!",
    "day_of_week": "Thursday",
    "start_date": "2026-08-29",
    "end_date": "2026-08-29",
    "start_time": "18:00",
    "end_time": "21:00",
    "price": "Free",
    "location": "Centennial Square, Victoria, British Columbia",
    "description": "Come join BC Swing Victoria for a fabulous (and FREE) evening of fun and West Coast Swing dancing at Centennial Square! The schedule for the night will be: 6pm (sharp) there will be an intro lesson to West Coast Swing. 7 - 9pm WCS music will be provided by DJ Carolyn Gebbie. Note: For those who are familiar with the 2019 WCS Rally routine, and would like to practice performing it live prior to Sept 7, the 'Hands Up' song will be played at 7:30 and 8:30pm. There will be WCS instructors on hand to answer questions about WCS or how to improve your WCS dancing."
}]
```
2025-06-18 12:55:53 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/417338985546213/, 
Cleaned JSON ready for parsing:
[{
    "source": "BC Swing Dance Club Victoria Centennial Square",
    "dance_style": "west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "Free EVENT - West Coast Swing in the Square - August 29!",
    "day_of_week": "Thursday",
    "start_date": "2026-08-29",
    "end_date": "2026-08-29",
    "start_time": "18:00",
    "end_time": "21:00",
    "price": "Free",
    "location": "Centennial Square, Victoria, British Columbia",
    "description": "Come join BC Swing Victoria for a fabulous (and FREE) evening of fun and West Coast Swing dancing at Centennial Square! The schedule for the night will be: 6pm (sharp) there will be an intro lesson to West Coast Swing. 7 - 9pm WCS music will be provided by DJ Carolyn Gebbie. Note: For those who are familiar with the 2019 WCS Rally routine, and would like to practice performing it live prior to Sept 7, the 'Hands Up' song will be played at 7:30 and 8:30pm. There will be WCS instructors on hand to answer questions about WCS or how to improve your WCS dancing."
}]
2025-06-18 12:55:53 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:55:53 - INFO - def clean_up_address(): Processing location 'Centennial Square, Victoria, British Columbia' (event_id: None)
2025-06-18 12:55:53 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:55:53 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/417338985546213/'
2025-06-18 12:55:53 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:55:53 - INFO - def process_llm_response: URL https://www.facebook.com/events/417338985546213/ marked as relevant with events written to the database.
2025-06-18 12:55:53 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/417338985546213/.
2025-06-18 12:55:53 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/634773653668605/
2025-06-18 12:55:53 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/634773653668605/.
2025-06-18 12:55:53 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/634773653668605/
2025-06-18 12:55:53 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:55:53 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:55:53 - INFO - query_llm(): Querying Mistral
2025-06-18 12:55:58 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:55:58 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "BC Swing Dance Club Victoria",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Saturday Night West Coast Swing",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "$10 ($5 for students)",
        "location": "BC Swing Dance Club Victoria",
        "description": "Come join us every Saturday all year long for a fabulous WCS social dance from 8 - 11pm. Just $10 for the ($5 for students). Meaghan Efford and Bob Gebbie 's lesson on June 1st (starting PROMPTLY at 7pm) will be the only lesson in June, and it will be a great way to build, refresh or accelerate your skills in the dance, so please be sure to take advantage of this opportunity.  The lesson is included in the dance entrance price.  No experience or partner is required."
    }
]
```
2025-06-18 12:55:58 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/634773653668605/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "BC Swing Dance Club Victoria",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Saturday Night West Coast Swing",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "20:00",
        "end_time": "23:00",
        "price": "$10 ($5 for students)",
        "location": "BC Swing Dance Club Victoria",
        "description": "Come join us every Saturday all year long for a fabulous WCS social dance from 8 - 11pm. Just $10 for the ($5 for students). Meaghan Efford and Bob Gebbie 's lesson on June 1st (starting PROMPTLY at 7pm) will be the only lesson in June, and it will be a great way to build, refresh or accelerate your skills in the dance, so please be sure to take advantage of this opportunity.  The lesson is included in the dance entrance price.  No experience or partner is required."
    }
]
2025-06-18 12:55:58 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:55:58 - INFO - def clean_up_address(): Processing location 'BC Swing Dance Club Victoria' (event_id: None)
2025-06-18 12:55:58 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:55:58 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/634773653668605/'
2025-06-18 12:55:58 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:55:58 - INFO - def process_llm_response: URL https://www.facebook.com/events/634773653668605/ marked as relevant with events written to the database.
2025-06-18 12:55:58 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/634773653668605/.
2025-06-18 12:55:58 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1692156731689650/
2025-06-18 12:55:58 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1692156731689650/.
2025-06-18 12:55:58 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1692156731689650/
2025-06-18 12:55:58 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:55:58 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:55:58 - INFO - query_llm(): Querying Mistral
2025-06-18 12:56:03 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:56:03 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "Eastern Star Hall Chapters No 5 & No 17",
    "dance_style": "west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "Victoria West Coast Swing Collective social dance",
    "day_of_week": "Tuesday",
    "start_date": "2025-06-24",
    "end_date": "2025-06-24",
    "start_time": "19:45",
    "end_time": "21:45",
    "price": "$7 at the door - cash or etransfer. Free for dancers registered in a series of WCS lessons.",
    "location": "Eastern Star Hall Chapters No 5 & No 17, 3281 Harriet Rd, Saanich, BC V8Z 3S3, Canada",
    "description": "Door opens at 7:30pm. DJ's in the comments. Beginners are welcome. No partner is required. There will NOT be a beginner lesson, but if you're brand new, let the person at the door know and they'll find someone to teach you the starter steps. Dance shoes or socks on the dance floor only. Bring your own water. No food or drink (except water) in the dance area by request of the hall. If you bring a snack to keep your energy up, please enjoy it in the foyer."
}]
```
2025-06-18 12:56:03 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1692156731689650/, 
Cleaned JSON ready for parsing:
[{
    "source": "Eastern Star Hall Chapters No 5 & No 17",
    "dance_style": "west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "Victoria West Coast Swing Collective social dance",
    "day_of_week": "Tuesday",
    "start_date": "2025-06-24",
    "end_date": "2025-06-24",
    "start_time": "19:45",
    "end_time": "21:45",
    "price": "$7 at the door - cash or etransfer. Free for dancers registered in a series of WCS lessons.",
    "location": "Eastern Star Hall Chapters No 5 & No 17, 3281 Harriet Rd, Saanich, BC V8Z 3S3, Canada",
    "description": "Door opens at 7:30pm. DJ's in the comments. Beginners are welcome. No partner is required. There will NOT be a beginner lesson, but if you're brand new, let the person at the door know and they'll find someone to teach you the starter steps. Dance shoes or socks on the dance floor only. Bring your own water. No food or drink (except water) in the dance area by request of the hall. If you bring a snack to keep your energy up, please enjoy it in the foyer."
}]
2025-06-18 12:56:03 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:56:03 - INFO - def clean_up_address(): Processing location 'Eastern Star Hall Chapters No 5 & No 17, 3281 Harriet Rd, Saanich, BC V8Z 3S3, Canada' (event_id: None)
2025-06-18 12:56:03 - INFO - get_address_id: Inserted or updated address_id 922 for address '3255 Harriet RD, VICTORIA, BC, V8Z3S3, CA'.
2025-06-18 12:56:03 - INFO - Populated from DB for postal code 'V8Z3S3': '3255 Harriet RD, VICTORIA, BC, V8Z3S3, CA'
2025-06-18 12:56:03 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:56:03 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1692156731689650/'
2025-06-18 12:56:03 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:56:03 - INFO - def process_llm_response: URL https://www.facebook.com/events/1692156731689650/ marked as relevant with events written to the database.
2025-06-18 12:56:03 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1692156731689650/.
2025-06-18 12:56:03 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1594011994641933/
2025-06-18 12:56:03 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1594011994641933/.
2025-06-18 12:56:03 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1594011994641933/
2025-06-18 12:56:03 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:56:03 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:56:03 - INFO - query_llm(): Querying Mistral
2025-06-18 12:56:06 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:56:06 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Victoria West Coast Swing Collective social dance",
        "day_of_week": "Tuesday",
        "start_date": "2025-04-22",
        "end_date": "2025-04-22",
        "start_time": "19:45",
        "end_time": "21:45",
        "price": "$7",
        "location": "Eastern Star Hall Chapters No 5 & No 17, 3281 Harriet Rd, Victoria",
        "description": "Victoria West Coast Swing Collective social dance. Door opens at 7:30pm. DJ's in the comments. Beginners are welcome. No partner is required. There will NOT be a beginner lesson, but if you're brand new, let the person at the door know and they'll find someone to teach you the starter steps. Dance shoes or socks on the dance floor only. No street shoes. Bring your own water. No food or drink (except water) in the dance area by request of the hall. If you bring a snack to keep your energy up, please enjoy it in the foyer."
    }
]
```
2025-06-18 12:56:06 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1594011994641933/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Victoria West Coast Swing Collective social dance",
        "day_of_week": "Tuesday",
        "start_date": "2025-04-22",
        "end_date": "2025-04-22",
        "start_time": "19:45",
        "end_time": "21:45",
        "price": "$7",
        "location": "Eastern Star Hall Chapters No 5 & No 17, 3281 Harriet Rd, Victoria",
        "description": "Victoria West Coast Swing Collective social dance. Door opens at 7:30pm. DJ's in the comments. Beginners are welcome. No partner is required. There will NOT be a beginner lesson, but if you're brand new, let the person at the door know and they'll find someone to teach you the starter steps. Dance shoes or socks on the dance floor only. No street shoes. Bring your own water. No food or drink (except water) in the dance area by request of the hall. If you bring a snack to keep your energy up, please enjoy it in the foyer."
    }
]
2025-06-18 12:56:06 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:56:06 - INFO - def clean_up_address(): Processing location 'Eastern Star Hall Chapters No 5 & No 17, 3281 Harriet Rd, Victoria' (event_id: None)
2025-06-18 12:56:06 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:56:06 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1594011994641933/'
2025-06-18 12:56:06 - INFO - def process_llm_response: URL https://www.facebook.com/events/1594011994641933/ marked as relevant with events written to the database.
2025-06-18 12:56:06 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1594011994641933/.
2025-06-18 12:56:06 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/373500473108499/
2025-06-18 12:56:06 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/373500473108499/.
2025-06-18 12:56:06 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/373500473108499/
2025-06-18 12:56:06 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:56:06 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:56:06 - INFO - query_llm(): Querying Mistral
2025-06-18 12:56:14 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:56:14 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "Sunday Swing at Logan's Logan's Pub 10 Dec 2017 Debi Wong invited you About Discussion More About Discussion Sunday Swing at Logan's Details Event by Swing X Logan's Pub Duration: 3 hr 30 min Public · Anyone on or off Facebook Sunday Swing at Logan's is BACK! Come join us for some great tunes and we'll party like it's 1939. Bring your dancing shoes, sweet moves, and a few dollars for our fabulous DJ (and gracious bartenders). Feel free to come early to hang out and grab a bite to eat. 19+. NEW: Crash course 15min swing lesson at 8:30pm! This is intended to be the bare minimum for someone to show up and know the basics of swing dancing, nothing fancy! DETAILS: * 8:30pm Quickie 15min beginner lesson! * 8:45pm social dancing until as late as midnight (maybe!) * Usually gets bluesy after 11pm See less Victoria, British Columbia Logan's Pub 1821 Cook Street, Victoria Original - Authentic - Unique Guests See All",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Sunday Swing at Logan's",
    "day_of_week": "Sunday",
    "start_date": "2025-06-22",
    "end_date": "2025-06-22",
    "start_time": "20:45",
    "end_time": "00:00",
    "price": "",
    "location": "Logan's Pub 1821 Cook Street, Victoria, British Columbia",
    "description": "Sunday Swing at Logan's is BACK! Come join us for some great tunes and we'll party like it's 1939. Bring your dancing shoes, sweet moves, and a few dollars for our fabulous DJ (and gracious bartenders). Feel free to come early to hang out and grab a bite to eat. 19+. NEW: Crash course 15min swing lesson at 8:30pm! This is intended to be the bare minimum for someone to show up and know the basics of swing dancing, nothing fancy! DETAILS: * 8:30pm Quickie 15min beginner lesson! * 8:45pm social dancing until as late as midnight (maybe!) * Usually gets bluesy after 11pm."
}]
```
2025-06-18 12:56:14 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/373500473108499/, 
Cleaned JSON ready for parsing:
[{
    "source": "Sunday Swing at Logan's Logan's Pub 10 Dec 2017 Debi Wong invited you About Discussion More About Discussion Sunday Swing at Logan's Details Event by Swing X Logan's Pub Duration: 3 hr 30 min Public · Anyone on or off Facebook Sunday Swing at Logan's is BACK! Come join us for some great tunes and we'll party like it's 1939. Bring your dancing shoes, sweet moves, and a few dollars for our fabulous DJ (and gracious bartenders). Feel free to come early to hang out and grab a bite to eat. 19+. NEW: Crash course 15min swing lesson at 8:30pm! This is intended to be the bare minimum for someone to show up and know the basics of swing dancing, nothing fancy! DETAILS: * 8:30pm Quickie 15min beginner lesson! * 8:45pm social dancing until as late as midnight (maybe!) * Usually gets bluesy after 11pm See less Victoria, British Columbia Logan's Pub 1821 Cook Street, Victoria Original - Authentic - Unique Guests See All",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Sunday Swing at Logan's",
    "day_of_week": "Sunday",
    "start_date": "2025-06-22",
    "end_date": "2025-06-22",
    "start_time": "20:45",
    "end_time": "00:00",
    "price": "",
    "location": "Logan's Pub 1821 Cook Street, Victoria, British Columbia",
    "description": "Sunday Swing at Logan's is BACK! Come join us for some great tunes and we'll party like it's 1939. Bring your dancing shoes, sweet moves, and a few dollars for our fabulous DJ (and gracious bartenders). Feel free to come early to hang out and grab a bite to eat. 19+. NEW: Crash course 15min swing lesson at 8:30pm! This is intended to be the bare minimum for someone to show up and know the basics of swing dancing, nothing fancy! DETAILS: * 8:30pm Quickie 15min beginner lesson! * 8:45pm social dancing until as late as midnight (maybe!) * Usually gets bluesy after 11pm."
}]
2025-06-18 12:56:14 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:56:14 - INFO - def clean_up_address(): Processing location 'Logan's Pub 1821 Cook Street, Victoria, British Columbia' (event_id: None)
2025-06-18 12:56:14 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:56:14 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/373500473108499/'
2025-06-18 12:56:14 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:56:14 - INFO - def process_llm_response: URL https://www.facebook.com/events/373500473108499/ marked as relevant with events written to the database.
2025-06-18 12:56:14 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/373500473108499/.
2025-06-18 12:56:14 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1776457206589544/
2025-06-18 12:56:14 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1776457206589544/.
2025-06-18 12:56:14 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1776457206589544/
2025-06-18 12:56:14 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:56:14 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:56:14 - INFO - query_llm(): Querying Mistral
2025-06-18 12:56:21 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:56:21 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "swing",
        "url": "",
        "event_type": "live music",
        "event_name": "Slim Sandy's Atomic Cocktails swing speakeasy party!",
        "day_of_week": "Friday",
        "start_date": "2025-03-21",
        "end_date": "2025-03-21",
        "start_time": "18:30",
        "end_time": "20:30",
        "price": "",
        "location": "The Coda, 749 View St, Victoria, BC V8W 1J9, Canada",
        "description": "Join Slim Sandy's Atomic Cocktails and dance as they play 2 sets of swing jazz, jive and rhythm and blues from the 20’s to the 40’s. Slim, on guitar and harmonica, is joined by Willa Mae on vocals, “Big Daddy Bo” on bass, and Bryn Bad on trumpet. Slim Sandy has been playing music for over 40 years with acts such as Ray Condo and the Crazy Rhythm Daddies. In 2012, he and Willa Mae co-created the Slim Sandy band in Victoria! They have played music festivals in Canada, France, Spain, Germany, Belgium, and the Netherlands. In May they will be touring in Japan!"
    }
]
```
2025-06-18 12:56:21 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1776457206589544/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "swing",
        "url": "",
        "event_type": "live music",
        "event_name": "Slim Sandy's Atomic Cocktails swing speakeasy party!",
        "day_of_week": "Friday",
        "start_date": "2025-03-21",
        "end_date": "2025-03-21",
        "start_time": "18:30",
        "end_time": "20:30",
        "price": "",
        "location": "The Coda, 749 View St, Victoria, BC V8W 1J9, Canada",
        "description": "Join Slim Sandy's Atomic Cocktails and dance as they play 2 sets of swing jazz, jive and rhythm and blues from the 20’s to the 40’s. Slim, on guitar and harmonica, is joined by Willa Mae on vocals, “Big Daddy Bo” on bass, and Bryn Bad on trumpet. Slim Sandy has been playing music for over 40 years with acts such as Ray Condo and the Crazy Rhythm Daddies. In 2012, he and Willa Mae co-created the Slim Sandy band in Victoria! They have played music festivals in Canada, France, Spain, Germany, Belgium, and the Netherlands. In May they will be touring in Japan!"
    }
]
2025-06-18 12:56:21 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:56:21 - INFO - def clean_up_address(): Processing location 'The Coda, 749 View St, Victoria, BC V8W 1J9, Canada' (event_id: None)
2025-06-18 12:56:21 - INFO - def clean_up_address(): Updated event None with address_id 3457 using DB match
2025-06-18 12:56:21 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:56:21 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1776457206589544/'
2025-06-18 12:56:21 - INFO - def process_llm_response: URL https://www.facebook.com/events/1776457206589544/ marked as relevant with events written to the database.
2025-06-18 12:56:21 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1776457206589544/.
2025-06-18 12:56:21 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/2441697862726705/
2025-06-18 12:56:21 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/2441697862726705/.
2025-06-18 12:56:21 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/2441697862726705/
2025-06-18 12:56:21 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:56:21 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:56:21 - INFO - query_llm(): Querying Mistral
2025-06-18 12:56:24 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:56:24 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "Journey’s 50th Birthday!!  A West Coast Swing dance party!!",
    "day_of_week": "Sunday",
    "start_date": "2026-06-30",
    "end_date": "2026-06-30",
    "start_time": "19:00",
    "end_time": "22:00",
    "price": "",
    "location": "Eastern Star Hall Chapters No 5 & No 17, 3281 Harriet Road, Victoria, BC",
    "description": "Bring your own alcohol-free beverage... Bring a gluten-free appie if you’d like. Dance West Coast Swing until 10 pm to Blues, Pop, RnB, Swing, and a wee bit of Ballroom"
}]
```
2025-06-18 12:56:24 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/2441697862726705/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "Journey’s 50th Birthday!!  A West Coast Swing dance party!!",
    "day_of_week": "Sunday",
    "start_date": "2026-06-30",
    "end_date": "2026-06-30",
    "start_time": "19:00",
    "end_time": "22:00",
    "price": "",
    "location": "Eastern Star Hall Chapters No 5 & No 17, 3281 Harriet Road, Victoria, BC",
    "description": "Bring your own alcohol-free beverage Bring a gluten-free appie if you’d like. Dance West Coast Swing until 10 pm to Blues, Pop, RnB, Swing, and a wee bit of Ballroom"
}]
2025-06-18 12:56:24 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:56:24 - INFO - def clean_up_address(): Processing location 'Eastern Star Hall Chapters No 5 & No 17, 3281 Harriet Road, Victoria, BC' (event_id: None)
2025-06-18 12:56:24 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:56:24 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/2441697862726705/'
2025-06-18 12:56:24 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:56:24 - INFO - def process_llm_response: URL https://www.facebook.com/events/2441697862726705/ marked as relevant with events written to the database.
2025-06-18 12:56:24 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/2441697862726705/.
2025-06-18 12:56:24 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1035925295253912/
2025-06-18 12:56:24 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1035925295253912/.
2025-06-18 12:56:24 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1035925295253912/
2025-06-18 12:56:24 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:56:24 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:56:24 - INFO - query_llm(): Querying Mistral
2025-06-18 12:56:28 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:56:28 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "swing",
    "url": "",
    "event_type": "live music",
    "event_name": "Swing out with the ATOMIC COCKTAILS",
    "day_of_week": "Friday",
    "start_date": "2025-04-18",
    "end_date": "2025-04-18",
    "start_time": "18:30",
    "end_time": "20:30",
    "price": "$20",
    "location": "751 View St, Victoria, BC V8W 1J9, Canada",
    "description": "Join the ATOMIC COCKTAILS as they swing out for their pre-Japan Tour dance party on April 18 at the Coda, 751 View Street. Doors open 6 pm, show from 6:30-8:30 pm! With songs from their new album BLUE LIGHT BOOGIE!"
}]
```
2025-06-18 12:56:28 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1035925295253912/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "swing",
    "url": "",
    "event_type": "live music",
    "event_name": "Swing out with the ATOMIC COCKTAILS",
    "day_of_week": "Friday",
    "start_date": "2025-04-18",
    "end_date": "2025-04-18",
    "start_time": "18:30",
    "end_time": "20:30",
    "price": "$20",
    "location": "751 View St, Victoria, BC V8W 1J9, Canada",
    "description": "Join the ATOMIC COCKTAILS as they swing out for their pre-Japan Tour dance party on April 18 at the Coda, 751 View Street. Doors open 6 pm, show from 6:30-8:30 pm! With songs from their new album BLUE LIGHT BOOGIE!"
}]
2025-06-18 12:56:28 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:56:28 - INFO - def clean_up_address(): Processing location '751 View St, Victoria, BC V8W 1J9, Canada' (event_id: None)
2025-06-18 12:56:28 - INFO - def clean_up_address(): Updated event None with address_id 4326 using DB match
2025-06-18 12:56:28 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:56:28 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1035925295253912/'
2025-06-18 12:56:28 - INFO - def process_llm_response: URL https://www.facebook.com/events/1035925295253912/ marked as relevant with events written to the database.
2025-06-18 12:56:28 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1035925295253912/.
2025-06-18 12:56:28 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/663756533046485/
2025-06-18 12:56:28 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/663756533046485/.
2025-06-18 12:56:28 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/663756533046485/
2025-06-18 12:56:28 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:56:28 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:56:28 - INFO - query_llm(): Querying Mistral
2025-06-18 12:56:35 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:56:35 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "The Coda",
    "dance_style": "swing",
    "url": "",
    "event_type": "live music",
    "event_name": "Miguelito Valdes presents Contodo",
    "day_of_week": "Friday",
    "start_date": "2025-04-11",
    "end_date": "2025-04-11",
    "start_time": "21:30",
    "end_time": null,
    "price": "",
    "location": "751 View St, Victoria, BC, Canada, British Columbia V8W 1J9",
    "description": "Miguelito Valdes presents Contodo- Blues, rock, swing, funk and soul...Havana style. Featuring: Miguelito Valdes – brass/vocals/percussion Jose Sanchez – drumset/timbales Hector Ramos – congas/percussion Peter Dowse - bass Brooke Maxwell – keys/vocals"
}]
```
2025-06-18 12:56:35 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/663756533046485/, 
Cleaned JSON ready for parsing:
[{
    "source": "The Coda",
    "dance_style": "swing",
    "url": "",
    "event_type": "live music",
    "event_name": "Miguelito Valdes presents Contodo",
    "day_of_week": "Friday",
    "start_date": "2025-04-11",
    "end_date": "2025-04-11",
    "start_time": "21:30",
    "end_time": null,
    "price": "",
    "location": "751 View St, Victoria, BC, Canada, British Columbia V8W 1J9",
    "description": "Miguelito Valdes presents Contodo- Blues, rock, swing, funk and soulHavana style. Featuring: Miguelito Valdes – brass/vocals/percussion Jose Sanchez – drumset/timbales Hector Ramos – congas/percussion Peter Dowse - bass Brooke Maxwell – keys/vocals"
}]
2025-06-18 12:56:35 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:56:35 - INFO - def clean_up_address(): Processing location '751 View St, Victoria, BC, Canada, British Columbia V8W 1J9' (event_id: None)
2025-06-18 12:56:35 - INFO - def clean_up_address(): Updated event None with address_id 4326 using DB match
2025-06-18 12:56:35 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:56:35 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/663756533046485/'
2025-06-18 12:56:35 - INFO - def process_llm_response: URL https://www.facebook.com/events/663756533046485/ marked as relevant with events written to the database.
2025-06-18 12:56:35 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/663756533046485/.
2025-06-18 12:56:35 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/402729737034904/
2025-06-18 12:56:35 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/402729737034904/.
2025-06-18 12:56:35 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/402729737034904/
2025-06-18 12:56:35 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:56:35 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:56:35 - INFO - query_llm(): Querying Mistral
2025-06-18 12:56:40 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:56:40 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "BC Swing Dance Club Victoria",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Free EVENT - West Coast Swing in the Square",
        "day_of_week": "Thursday",
        "start_date": "2025-09-04",
        "end_date": "2025-09-04",
        "start_time": "18:00",
        "end_time": "21:00",
        "price": "Free",
        "location": "Centennial Square, Victoria, British Columbia, Canada",
        "description": "Come join BC Swing Victoria for our second fabulous (and FREE) evening of fun and West Coast Swing dancing at Centennial Square! The schedule for the night will be: 6pm (sharp) there will be an intro lesson to West Coast Swing. 7 - 9pm WCS music will be provided by DJ Carolyn Gebbie. Note: For those who are familiar with the 2019 WCS Rally routine, and would like to practice performing it live prior to Sept 7, the 'Hands Up' song will be played at 7:30 and 8:30pm. There will be WCS instructors on hand to answer questions about WCS or how to improve your WCS dancing."
    }
]
```
2025-06-18 12:56:40 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/402729737034904/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "BC Swing Dance Club Victoria",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Free EVENT - West Coast Swing in the Square",
        "day_of_week": "Thursday",
        "start_date": "2025-09-04",
        "end_date": "2025-09-04",
        "start_time": "18:00",
        "end_time": "21:00",
        "price": "Free",
        "location": "Centennial Square, Victoria, British Columbia, Canada",
        "description": "Come join BC Swing Victoria for our second fabulous (and FREE) evening of fun and West Coast Swing dancing at Centennial Square! The schedule for the night will be: 6pm (sharp) there will be an intro lesson to West Coast Swing. 7 - 9pm WCS music will be provided by DJ Carolyn Gebbie. Note: For those who are familiar with the 2019 WCS Rally routine, and would like to practice performing it live prior to Sept 7, the 'Hands Up' song will be played at 7:30 and 8:30pm. There will be WCS instructors on hand to answer questions about WCS or how to improve your WCS dancing."
    }
]
2025-06-18 12:56:40 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:56:40 - INFO - def clean_up_address(): Processing location 'Centennial Square, Victoria, British Columbia, Canada' (event_id: None)
2025-06-18 12:56:40 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:56:40 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/402729737034904/'
2025-06-18 12:56:40 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:56:40 - INFO - def process_llm_response: URL https://www.facebook.com/events/402729737034904/ marked as relevant with events written to the database.
2025-06-18 12:56:40 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/402729737034904/.
2025-06-18 12:56:40 - INFO - def driver_fb_search(): Keywords checkpoint updated.
2025-06-18 12:56:47 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q=milonga tango&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:56:47 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q=milonga tango&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:56:53 - INFO - extract_event_links(): Found 2 links on https://www.facebook.com/search/events?q=milonga tango&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:56:53 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q=milonga tango&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 2 event_links

2025-06-18 12:56:53 - INFO - should_process_url: URL https://www.facebook.com/events/1864555154338100/ was last seen as relevant, processing it.
2025-06-18 12:56:57 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1864555154338100/ (12161 ms)
2025-06-18 12:57:18 - INFO - extract_event_text: extracted 3868 chars
2025-06-18 12:57:18 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1864555154338100/.
2025-06-18 12:57:18 - INFO - def scrape_events(): Keywords: ['dance', 'milonga', 'tango']: found in text for URL: https://www.facebook.com/events/1864555154338100/.
2025-06-18 12:57:18 - INFO - should_process_url: URL https://www.facebook.com/events/1766891834185825/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:57:27 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1766891834185825/ (14179 ms)
2025-06-18 12:57:44 - INFO - extract_event_text: extracted 3177 chars
2025-06-18 12:57:44 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1766891834185825/.
2025-06-18 12:57:44 - INFO - def scrape_events(): Keywords: ['milonga', 'tango']: found in text for URL: https://www.facebook.com/events/1766891834185825/.
2025-06-18 12:57:47 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q= argentine tango&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:57:47 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q= argentine tango&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:57:51 - INFO - extract_event_links(): Found 0 links on https://www.facebook.com/search/events?q= argentine tango&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:57:51 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q= argentine tango&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 0 event_links

2025-06-18 12:57:54 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q= tango&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:57:54 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q= tango&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:57:59 - INFO - extract_event_links(): Found 4 links on https://www.facebook.com/search/events?q= tango&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:57:59 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q= tango&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 4 event_links

2025-06-18 12:57:59 - INFO - should_process_url: URL https://www.facebook.com/events/1318668532737609/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 12:58:02 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1318668532737609/ (14380 ms)
2025-06-18 12:58:20 - INFO - extract_event_text: extracted 4131 chars
2025-06-18 12:58:20 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1318668532737609/.
2025-06-18 12:58:20 - INFO - def scrape_events(): Keywords: ['dance', 'milonga', 'tango']: found in text for URL: https://www.facebook.com/events/1318668532737609/.
2025-06-18 12:58:20 - INFO - should_process_url: URL https://www.facebook.com/events/3637725693193744/ was last seen as relevant, processing it.
2025-06-18 12:58:26 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/3637725693193744/ (11907 ms)
2025-06-18 12:58:43 - INFO - extract_event_text: extracted 3907 chars
2025-06-18 12:58:43 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/3637725693193744/.
2025-06-18 12:58:43 - INFO - def scrape_events(): Keywords: ['dance', 'milonga', 'tango']: found in text for URL: https://www.facebook.com/events/3637725693193744/.
2025-06-18 12:58:43 - INFO - should_process_url: URL https://www.facebook.com/events/1009684807956058/ was last seen as relevant, processing it.
2025-06-18 12:58:49 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1009684807956058/ (14714 ms)
2025-06-18 12:59:07 - INFO - extract_event_text: extracted 3808 chars
2025-06-18 12:59:07 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1009684807956058/.
2025-06-18 12:59:07 - INFO - def scrape_events(): Keywords: ['dance', 'milonga', 'tango']: found in text for URL: https://www.facebook.com/events/1009684807956058/.
2025-06-18 12:59:07 - INFO - def scrape_events(): Extracted text from 5 events.
2025-06-18 12:59:07 - INFO - def scrape_events(): Extracted text data written to checkpoint/extracted_text.xlsx.
2025-06-18 12:59:07 - INFO - def driver_fb_search(): Extracted text based on search_url: https://www.facebook.com/search/events?q= tango&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9.
2025-06-18 12:59:07 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1864555154338100/
2025-06-18 12:59:07 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1864555154338100/.
2025-06-18 12:59:07 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1864555154338100/
2025-06-18 12:59:07 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:59:07 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:59:07 - INFO - query_llm(): Querying Mistral
2025-06-18 12:59:07 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-06-18 12:59:07 - WARNING - query_llm(): Mistral query failed: API rejection occurred: Status 429
{"object":"rejection","message":"Service tier capacity exceeded for this model.","type":"invalid_request_rejection","param":null,"code":null}
2025-06-18 12:59:07 - INFO - query_llm(): Falling back to OpenAI
2025-06-18 12:59:29 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:59:29 - INFO - query_llm(): OpenAI response received: [{
    "source": "",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Pride Contra Dance",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-20",
    "start_time": "19:00",
    "end_time": "22:00",
    "price": "",
    "location": "",
    "description": "Pride Contra Dance hosted by Adam, social dance event on Friday from 19:00 to 22:00."
}]
2025-06-18 12:59:29 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1864555154338100/, 
Cleaned JSON ready for parsing:
[{
    "source": "",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Pride Contra Dance",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-20",
    "start_time": "19:00",
    "end_time": "22:00",
    "price": "",
    "location": "",
    "description": "Pride Contra Dance hosted by Adam, social dance event on Friday from 19:00 to 22:00."
}]
2025-06-18 12:59:29 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:59:29 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:59:29 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1864555154338100/'
2025-06-18 12:59:29 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:59:29 - INFO - def process_llm_response: URL https://www.facebook.com/events/1864555154338100/ marked as relevant with events written to the database.
2025-06-18 12:59:29 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1864555154338100/.
2025-06-18 12:59:29 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1766891834185825/
2025-06-18 12:59:29 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1766891834185825/.
2025-06-18 12:59:29 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1766891834185825/
2025-06-18 12:59:29 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:59:29 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:59:29 - INFO - query_llm(): Querying Mistral
2025-06-18 12:59:32 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:59:32 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "tango",
        "url": "",
        "event_type": "social dance",
        "event_name": "Sunday Afternoon Milonga",
        "day_of_week": "Sunday",
        "start_date": "2025-06-08",
        "end_date": "2025-06-08",
        "start_time": "13:00",
        "end_time": "16:00",
        "price": "$15 (plus tax)",
        "location": "The Coda, 751 View Street, Victoria",
        "description": "Join us for a wonderful afternoon of warm hugs and close embrace at The Coda Club, a beautiful newly renovated venue with a nice wood floor and great sound system. Special Guest DJ: Francis Nowaczynski (from Vancouver). Free parking available at View Street Parkade (next door) or Broughton Parkade. Cash bar is open for drinks."
    }
]
```
2025-06-18 12:59:32 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1766891834185825/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "tango",
        "url": "",
        "event_type": "social dance",
        "event_name": "Sunday Afternoon Milonga",
        "day_of_week": "Sunday",
        "start_date": "2025-06-08",
        "end_date": "2025-06-08",
        "start_time": "13:00",
        "end_time": "16:00",
        "price": "$15 (plus tax)",
        "location": "The Coda, 751 View Street, Victoria",
        "description": "Join us for a wonderful afternoon of warm hugs and close embrace at The Coda Club, a beautiful newly renovated venue with a nice wood floor and great sound system. Special Guest DJ: Francis Nowaczynski (from Vancouver). Free parking available at View Street Parkade (next door) or Broughton Parkade. Cash bar is open for drinks."
    }
]
2025-06-18 12:59:32 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:59:32 - INFO - def clean_up_address(): Processing location 'The Coda, 751 View Street, Victoria' (event_id: None)
2025-06-18 12:59:32 - INFO - def clean_up_address(): Updated event None with address_id 4326 using DB match
2025-06-18 12:59:32 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 12:59:32 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1766891834185825/'
2025-06-18 12:59:32 - INFO - def process_llm_response: URL https://www.facebook.com/events/1766891834185825/ marked as relevant with events written to the database.
2025-06-18 12:59:32 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1766891834185825/.
2025-06-18 12:59:32 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1318668532737609/
2025-06-18 12:59:32 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1318668532737609/.
2025-06-18 12:59:32 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1318668532737609/
2025-06-18 12:59:32 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:59:32 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:59:32 - INFO - query_llm(): Querying Mistral
2025-06-18 12:59:35 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:59:35 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "tango",
        "url": "",
        "event_type": "class",
        "event_name": "Ignite Your Tango",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "18:30",
        "end_time": "20:00",
        "price": "$30",
        "location": "Alive Tango Victoria, 1303 Broad St., Victoria",
        "description": "Seminar series for Tango Dancers that want to transform their way of moving and connecting! We will travel through the Essentials of Tango in order to look for new answers and deeper understanding."
    }
]
```
2025-06-18 12:59:35 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1318668532737609/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "tango",
        "url": "",
        "event_type": "class",
        "event_name": "Ignite Your Tango",
        "day_of_week": "Wednesday",
        "start_date": "2025-06-18",
        "end_date": "2025-06-18",
        "start_time": "18:30",
        "end_time": "20:00",
        "price": "$30",
        "location": "Alive Tango Victoria, 1303 Broad St., Victoria",
        "description": "Seminar series for Tango Dancers that want to transform their way of moving and connecting! We will travel through the Essentials of Tango in order to look for new answers and deeper understanding."
    }
]
2025-06-18 12:59:35 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:59:35 - INFO - def clean_up_address(): Processing location 'Alive Tango Victoria, 1303 Broad St., Victoria' (event_id: None)
2025-06-18 12:59:35 - INFO - def clean_up_address(): Updated event None with address_id 1928 using DB match
2025-06-18 12:59:35 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:59:35 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1318668532737609/'
2025-06-18 12:59:35 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:59:35 - INFO - def process_llm_response: URL https://www.facebook.com/events/1318668532737609/ marked as relevant with events written to the database.
2025-06-18 12:59:35 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1318668532737609/.
2025-06-18 12:59:35 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/3637725693193744/
2025-06-18 12:59:35 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/3637725693193744/.
2025-06-18 12:59:35 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/3637725693193744/
2025-06-18 12:59:35 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:59:35 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:59:35 - INFO - query_llm(): Querying Mistral
2025-06-18 12:59:39 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:59:39 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "Alive Tango Victoria",
        "dance_style": "tango",
        "url": "",
        "event_type": "class",
        "event_name": "Weekend with Tango with Jorge Olguín",
        "day_of_week": "Saturday",
        "start_date": "2026-03-22",
        "end_date": "2026-03-23",
        "start_time": "17:00",
        "end_time": "13:30",
        "price": "$80 entire weekend",
        "location": "Alive Tango Victoria 1303 Broad St., Victoria",
        "description": "22 Mar at 17:00 – 23 Mar at 13:30 Weekend with Tango with Jorge Olguín. Activities include solo technique classes, partnered workshops, and a milonga. Prices vary by class and workshop. Next workshop dates are the May 17th &18th."
    }
]
```
2025-06-18 12:59:39 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/3637725693193744/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Alive Tango Victoria",
        "dance_style": "tango",
        "url": "",
        "event_type": "class",
        "event_name": "Weekend with Tango with Jorge Olguín",
        "day_of_week": "Saturday",
        "start_date": "2026-03-22",
        "end_date": "2026-03-23",
        "start_time": "17:00",
        "end_time": "13:30",
        "price": "$80 entire weekend",
        "location": "Alive Tango Victoria 1303 Broad St., Victoria",
        "description": "22 Mar at 17:00 – 23 Mar at 13:30 Weekend with Tango with Jorge Olguín. Activities include solo technique classes, partnered workshops, and a milonga. Prices vary by class and workshop. Next workshop dates are the May 17th &18th."
    }
]
2025-06-18 12:59:39 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:59:39 - INFO - def clean_up_address(): Processing location 'Alive Tango Victoria 1303 Broad St., Victoria' (event_id: None)
2025-06-18 12:59:39 - INFO - def clean_up_address(): Updated event None with address_id 1928 using DB match
2025-06-18 12:59:39 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:59:39 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/3637725693193744/'
2025-06-18 12:59:39 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:59:39 - INFO - def process_llm_response: URL https://www.facebook.com/events/3637725693193744/ marked as relevant with events written to the database.
2025-06-18 12:59:39 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/3637725693193744/.
2025-06-18 12:59:39 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1009684807956058/
2025-06-18 12:59:39 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1009684807956058/.
2025-06-18 12:59:39 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1009684807956058/
2025-06-18 12:59:39 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 12:59:39 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 12:59:39 - INFO - query_llm(): Querying Mistral
2025-06-18 12:59:41 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 12:59:41 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "contra",
    "url": "",
    "event_type": "social dance",
    "event_name": "Pride Contra Dance",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-20",
    "start_time": "19:00",
    "end_time": "22:00",
    "price": "",
    "location": "",
    "description": "Pride Contra Dance"
}]
```
2025-06-18 12:59:41 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1009684807956058/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "contra",
    "url": "",
    "event_type": "social dance",
    "event_name": "Pride Contra Dance",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-20",
    "start_time": "19:00",
    "end_time": "22:00",
    "price": "",
    "location": "",
    "description": "Pride Contra Dance"
}]
2025-06-18 12:59:41 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 12:59:41 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 12:59:41 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1009684807956058/'
2025-06-18 12:59:41 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 12:59:41 - INFO - def process_llm_response: URL https://www.facebook.com/events/1009684807956058/ marked as relevant with events written to the database.
2025-06-18 12:59:41 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1009684807956058/.
2025-06-18 12:59:41 - INFO - def driver_fb_search(): Keywords checkpoint updated.
2025-06-18 12:59:44 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q=west coast swing&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:59:44 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q=west coast swing&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:59:48 - INFO - extract_event_links(): Found 8 links on https://www.facebook.com/search/events?q=west coast swing&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:59:48 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q=west coast swing&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 8 event_links

2025-06-18 12:59:51 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q= wcs&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:59:51 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q= wcs&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:59:56 - INFO - extract_event_links(): Found 8 links on https://www.facebook.com/search/events?q= wcs&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 12:59:56 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q= wcs&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 8 event_links

2025-06-18 12:59:56 - INFO - should_process_url: URL https://www.facebook.com/events/2162855673833831/ was last seen as relevant, processing it.
2025-06-18 12:59:58 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/2162855673833831/ (13961 ms)
2025-06-18 13:00:18 - INFO - extract_event_text: extracted 3954 chars
2025-06-18 13:00:18 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/2162855673833831/.
2025-06-18 13:00:18 - INFO - def scrape_events(): Keywords: ['dance', 'swing', 'wcs', 'west coast swing']: found in text for URL: https://www.facebook.com/events/2162855673833831/.
2025-06-18 13:00:18 - INFO - should_process_url: URL https://www.facebook.com/events/2238975779474166/ was last seen as relevant, processing it.
2025-06-18 13:00:22 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/2238975779474166/ (11175 ms)
2025-06-18 13:00:42 - INFO - extract_event_text: extracted 3291 chars
2025-06-18 13:00:42 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/2238975779474166/.
2025-06-18 13:00:42 - INFO - def scrape_events(): Keywords: ['dance', 'swing', 'wcs']: found in text for URL: https://www.facebook.com/events/2238975779474166/.
2025-06-18 13:00:42 - INFO - should_process_url: URL https://www.facebook.com/events/516994561244886/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:00:47 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/516994561244886/ (10991 ms)
2025-06-18 13:01:08 - INFO - extract_event_text: extracted 3472 chars
2025-06-18 13:01:08 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/516994561244886/.
2025-06-18 13:01:08 - INFO - def scrape_events(): Keywords: ['dance', 'swing', 'wcs', 'west coast swing']: found in text for URL: https://www.facebook.com/events/516994561244886/.
2025-06-18 13:01:08 - INFO - should_process_url: URL https://www.facebook.com/events/1024182725709172/ was last seen as relevant, processing it.
2025-06-18 13:01:10 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1024182725709172/ (12192 ms)
2025-06-18 13:01:27 - INFO - extract_event_text: extracted 3051 chars
2025-06-18 13:01:27 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1024182725709172/.
2025-06-18 13:01:27 - INFO - def scrape_events(): Keywords: ['dance', 'swing', 'wcs', 'west coast swing']: found in text for URL: https://www.facebook.com/events/1024182725709172/.
2025-06-18 13:01:27 - INFO - should_process_url: URL https://www.facebook.com/events/1225266505917189/ was last seen as relevant, processing it.
2025-06-18 13:01:29 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1225266505917189/ (13888 ms)
2025-06-18 13:01:48 - INFO - extract_event_text: extracted 3001 chars
2025-06-18 13:01:48 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1225266505917189/.
2025-06-18 13:01:48 - INFO - def scrape_events(): Keywords: ['dance', 'wcs']: found in text for URL: https://www.facebook.com/events/1225266505917189/.
2025-06-18 13:01:48 - INFO - should_process_url: URL https://www.facebook.com/events/641769172035949/ was last seen as relevant, processing it.
2025-06-18 13:01:51 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/641769172035949/ (11759 ms)
2025-06-18 13:02:09 - INFO - extract_event_text: extracted 3143 chars
2025-06-18 13:02:09 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/641769172035949/.
2025-06-18 13:02:09 - INFO - def scrape_events(): Keywords: ['dance', 'swing', 'wcs', 'west coast swing']: found in text for URL: https://www.facebook.com/events/641769172035949/.
2025-06-18 13:02:09 - INFO - should_process_url: URL https://www.facebook.com/events/1366072544640156/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:02:12 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1366072544640156/ (11266 ms)
2025-06-18 13:02:36 - INFO - extract_event_text: extracted 3200 chars
2025-06-18 13:02:36 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1366072544640156/.
2025-06-18 13:02:36 - INFO - def scrape_events(): Keywords: ['dance', 'swing', 'wcs', 'west coast swing']: found in text for URL: https://www.facebook.com/events/1366072544640156/.
2025-06-18 13:02:36 - INFO - should_process_url: URL https://www.facebook.com/events/967438905456066/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:02:40 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/967438905456066/ (11760 ms)
2025-06-18 13:02:56 - INFO - extract_event_text: extracted 2801 chars
2025-06-18 13:02:56 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/967438905456066/.
2025-06-18 13:02:56 - INFO - def scrape_events(): Keywords: ['dance', 'wcs']: found in text for URL: https://www.facebook.com/events/967438905456066/.
2025-06-18 13:02:56 - INFO - def scrape_events(): Extracted text from 8 events.
2025-06-18 13:02:57 - INFO - def scrape_events(): Extracted text data written to checkpoint/extracted_text.xlsx.
2025-06-18 13:02:57 - INFO - def driver_fb_search(): Extracted text based on search_url: https://www.facebook.com/search/events?q= wcs&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9.
2025-06-18 13:02:57 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/2162855673833831/
2025-06-18 13:02:57 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/2162855673833831/.
2025-06-18 13:02:57 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/2162855673833831/
2025-06-18 13:02:57 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:02:57 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:02:57 - INFO - query_llm(): Querying Mistral
2025-06-18 13:03:00 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:03:00 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "west coast swing, wcs",
    "url": "",
    "event_type": "class, social dance",
    "event_name": "Saturday Night WCS Intro Lesson and Social Dance",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "18:45",
    "end_time": "23:00",
    "price": "$10 ($5 for students)",
    "location": "BC Swing Dance Club Victoria",
    "description": "Intro lesson and social dance every Saturday night. Just $10 for the lesson and/or social dance ($5 for students). No experience or partner required. Doors open at 6:45 pm, Intro lesson at 7:00 pm, Social dance from 8:00 pm to 11:00 pm."
}]
```
2025-06-18 13:03:00 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/2162855673833831/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "west coast swing, wcs",
    "url": "",
    "event_type": "class, social dance",
    "event_name": "Saturday Night WCS Intro Lesson and Social Dance",
    "day_of_week": "Saturday",
    "start_date": "2025-06-21",
    "end_date": "2025-06-21",
    "start_time": "18:45",
    "end_time": "23:00",
    "price": "$10 ($5 for students)",
    "location": "BC Swing Dance Club Victoria",
    "description": "Intro lesson and social dance every Saturday night. Just $10 for the lesson and/or social dance ($5 for students). No experience or partner required. Doors open at 6:45 pm, Intro lesson at 7:00 pm, Social dance from 8:00 pm to 11:00 pm."
}]
2025-06-18 13:03:00 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:03:00 - INFO - def clean_up_address(): Processing location 'BC Swing Dance Club Victoria' (event_id: None)
2025-06-18 13:03:00 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 13:03:01 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/2162855673833831/'
2025-06-18 13:03:01 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:03:01 - INFO - def process_llm_response: URL https://www.facebook.com/events/2162855673833831/ marked as relevant with events written to the database.
2025-06-18 13:03:01 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/2162855673833831/.
2025-06-18 13:03:01 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/2238975779474166/
2025-06-18 13:03:01 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/2238975779474166/.
2025-06-18 13:03:01 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/2238975779474166/
2025-06-18 13:03:01 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:03:01 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:03:01 - INFO - query_llm(): Querying Mistral
2025-06-18 13:03:04 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:03:04 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Saturday Night WCS Intro Lesson and Social Dance",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "18:45",
        "end_time": "23:00",
        "price": "$10 ($5 for Students)",
        "location": "BC Swing Dance Club Victoria",
        "description": "A new month, a new social! Come and join in on the fun at our inaugural Saturday night dance and intro lesson on April 6 (and every Saturday night after that)! No experience or partner required. • 6:45 pm – Doors open • 7:00 pm – Beginner Lesson with Sam and Meaghan (this is perfect as a refresher class too!) • 8:00 – 11:00 pm Social Dancing featuring DJ Carolyn. Please note the NEW START TIMES for the BC Swing Victoria Saturday night dances."
    }
]
```
2025-06-18 13:03:04 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/2238975779474166/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Saturday Night WCS Intro Lesson and Social Dance",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "18:45",
        "end_time": "23:00",
        "price": "$10 ($5 for Students)",
        "location": "BC Swing Dance Club Victoria",
        "description": "A new month, a new social! Come and join in on the fun at our inaugural Saturday night dance and intro lesson on April 6 (and every Saturday night after that)! No experience or partner required. • 6:45 pm – Doors open • 7:00 pm – Beginner Lesson with Sam and Meaghan (this is perfect as a refresher class too!) • 8:00 – 11:00 pm Social Dancing featuring DJ Carolyn. Please note the NEW START TIMES for the BC Swing Victoria Saturday night dances."
    }
]
2025-06-18 13:03:04 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:03:04 - INFO - def clean_up_address(): Processing location 'BC Swing Dance Club Victoria' (event_id: None)
2025-06-18 13:03:04 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 13:03:04 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/2238975779474166/'
2025-06-18 13:03:04 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:03:04 - INFO - def process_llm_response: URL https://www.facebook.com/events/2238975779474166/ marked as relevant with events written to the database.
2025-06-18 13:03:04 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/2238975779474166/.
2025-06-18 13:03:04 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/516994561244886/
2025-06-18 13:03:04 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/516994561244886/.
2025-06-18 13:03:04 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/516994561244886/
2025-06-18 13:03:04 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:03:04 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:03:04 - INFO - query_llm(): Querying Mistral
2025-06-18 13:03:08 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:03:08 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "Victoria WCS Collective",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Sat April 5th LESSON  PLUS 3 HOURS  SOCIAL DANCING",
        "day_of_week": "Saturday",
        "start_date": "2025-04-05",
        "end_date": "2025-04-05",
        "start_time": "18:45",
        "end_time": null,
        "price": "$15/$12 for students",
        "location": "White Eagle Polish Association, 90 Dock St, Victoria, BC V8V 2A1, Canada",
        "description": "Doors open at 6:45pm. Advanced beginner/intermediate lesson by Chantelle Pianetta from 7 to 8 pm. Social dancing for 3 HOURS from 8 to 11 pm. DJs Donna and Andre. No need to register and you do not need a dance partner. Please bring scuff-free dance shoes or socks to dance in and a water bottle."
    }
]
```
2025-06-18 13:03:08 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/516994561244886/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Victoria WCS Collective",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Sat April 5th LESSON  PLUS 3 HOURS  SOCIAL DANCING",
        "day_of_week": "Saturday",
        "start_date": "2025-04-05",
        "end_date": "2025-04-05",
        "start_time": "18:45",
        "end_time": null,
        "price": "$15/$12 for students",
        "location": "White Eagle Polish Association, 90 Dock St, Victoria, BC V8V 2A1, Canada",
        "description": "Doors open at 6:45pm. Advanced beginner/intermediate lesson by Chantelle Pianetta from 7 to 8 pm. Social dancing for 3 HOURS from 8 to 11 pm. DJs Donna and Andre. No need to register and you do not need a dance partner. Please bring scuff-free dance shoes or socks to dance in and a water bottle."
    }
]
2025-06-18 13:03:08 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:03:08 - INFO - def clean_up_address(): Processing location 'White Eagle Polish Association, 90 Dock St, Victoria, BC V8V 2A1, Canada' (event_id: None)
2025-06-18 13:03:08 - INFO - def clean_up_address(): Updated event None with address_id 2635 using DB match
2025-06-18 13:03:08 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 13:03:08 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/516994561244886/'
2025-06-18 13:03:08 - INFO - def process_llm_response: URL https://www.facebook.com/events/516994561244886/ marked as relevant with events written to the database.
2025-06-18 13:03:08 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/516994561244886/.
2025-06-18 13:03:08 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1024182725709172/
2025-06-18 13:03:08 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1024182725709172/.
2025-06-18 13:03:08 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1024182725709172/
2025-06-18 13:03:08 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:03:08 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:03:08 - INFO - query_llm(): Querying Mistral
2025-06-18 13:03:11 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:03:11 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "Dance Victoria",
    "dance_style": "west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "Saturday April 19th Lesson and Social Dance",
    "day_of_week": "Saturday",
    "start_date": "2026-04-19",
    "end_date": "2026-04-19",
    "start_time": "18:45",
    "end_time": "22:15",
    "price": "$15/$12 for students",
    "location": "2740 Quadra St, Victoria, BC V8T 4E8, Canada",
    "description": "Lesson and Social Dance. Doors open at 6:45 pm. Beginner plus lesson with Pamela Podmoroff from 8 to 10:15 pm. Social dancing from 8 to 10:15 pm. DJs Donna and Amanda. No need to register and no partner required. Please bring scuff-free indoor dance shoes or socks to dance in and a water bottle."
}]
```
2025-06-18 13:03:11 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1024182725709172/, 
Cleaned JSON ready for parsing:
[{
    "source": "Dance Victoria",
    "dance_style": "west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "Saturday April 19th Lesson and Social Dance",
    "day_of_week": "Saturday",
    "start_date": "2026-04-19",
    "end_date": "2026-04-19",
    "start_time": "18:45",
    "end_time": "22:15",
    "price": "$15/$12 for students",
    "location": "2740 Quadra St, Victoria, BC V8T 4E8, Canada",
    "description": "Lesson and Social Dance. Doors open at 6:45 pm. Beginner plus lesson with Pamela Podmoroff from 8 to 10:15 pm. Social dancing from 8 to 10:15 pm. DJs Donna and Amanda. No need to register and no partner required. Please bring scuff-free indoor dance shoes or socks to dance in and a water bottle."
}]
2025-06-18 13:03:11 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:03:11 - INFO - def clean_up_address(): Processing location '2740 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 13:03:11 - INFO - get_address_id: Inserted or updated address_id 2628 for address '2750 Quadra ST, VICTORIA, BC, V8T4E8, CA'.
2025-06-18 13:03:11 - INFO - Populated from DB for postal code 'V8T4E8': '2750 Quadra ST, VICTORIA, BC, V8T4E8, CA'
2025-06-18 13:03:11 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 13:03:11 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1024182725709172/'
2025-06-18 13:03:11 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:03:11 - INFO - def process_llm_response: URL https://www.facebook.com/events/1024182725709172/ marked as relevant with events written to the database.
2025-06-18 13:03:11 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1024182725709172/.
2025-06-18 13:03:11 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1225266505917189/
2025-06-18 13:03:11 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1225266505917189/.
2025-06-18 13:03:11 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1225266505917189/
2025-06-18 13:03:11 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:03:11 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:03:11 - INFO - query_llm(): Querying Mistral
2025-06-18 13:03:16 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:03:16 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "Dance Victoria",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Saturday Beginner Lesson and Social Dancing",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "19:00",
        "end_time": "22:15",
        "price": "$15/$12 for students",
        "location": "Dance Victoria Studios, 2740 Quadra St, Victoria, BC V8T 4E8, Canada",
        "description": "Victoria WCS Collective hosts Saturday Beginner Lesson and Social Dancing. Beginner lesson from 7 to 8 pm. Social dancing from 8 to 10:15 pm. No need to register and no need for previous dance experience or a partner. Please bring scuff-free inside low-heeled dance shoes or socks to dance in and a water bottle."
    }
]
```
2025-06-18 13:03:16 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1225266505917189/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Dance Victoria",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Saturday Beginner Lesson and Social Dancing",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "19:00",
        "end_time": "22:15",
        "price": "$15/$12 for students",
        "location": "Dance Victoria Studios, 2740 Quadra St, Victoria, BC V8T 4E8, Canada",
        "description": "Victoria WCS Collective hosts Saturday Beginner Lesson and Social Dancing. Beginner lesson from 7 to 8 pm. Social dancing from 8 to 10:15 pm. No need to register and no need for previous dance experience or a partner. Please bring scuff-free inside low-heeled dance shoes or socks to dance in and a water bottle."
    }
]
2025-06-18 13:03:16 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:03:16 - INFO - def clean_up_address(): Processing location 'Dance Victoria Studios, 2740 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 13:03:16 - INFO - get_address_id: Inserted or updated address_id 2628 for address '2750 Quadra ST, VICTORIA, BC, V8T4E8, CA'.
2025-06-18 13:03:16 - INFO - Populated from DB for postal code 'V8T4E8': '2750 Quadra ST, VICTORIA, BC, V8T4E8, CA'
2025-06-18 13:03:16 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 13:03:16 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1225266505917189/'
2025-06-18 13:03:16 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:03:16 - INFO - def process_llm_response: URL https://www.facebook.com/events/1225266505917189/ marked as relevant with events written to the database.
2025-06-18 13:03:16 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1225266505917189/.
2025-06-18 13:03:16 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/641769172035949/
2025-06-18 13:03:16 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/641769172035949/.
2025-06-18 13:03:16 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/641769172035949/
2025-06-18 13:03:16 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:03:16 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:03:16 - INFO - query_llm(): Querying Mistral
2025-06-18 13:03:19 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:03:19 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "Beginner lesson and social dance at Dance Victoria",
    "day_of_week": "Saturday",
    "start_date": "2026-04-12",
    "end_date": "2026-04-12",
    "start_time": "18:45",
    "end_time": "22:15",
    "price": "$15 /$12 for Students",
    "location": "Dance Victoria 2740 Quadra St, Victoria, BC V8T 4E8, Canada",
    "description": "Doors open at 6:45 pm. Beginners lesson by Donna from 7 to 8 pm. Social dancing from 8 to 10:15 pm. DJs Andre and Nel. No need to register and no partner required. Please bring scuff-free inside dance shoes or socks to dance in and a water bottle."
}]
```
2025-06-18 13:03:19 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/641769172035949/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "west coast swing, wcs",
    "url": "",
    "event_type": "social dance",
    "event_name": "Beginner lesson and social dance at Dance Victoria",
    "day_of_week": "Saturday",
    "start_date": "2026-04-12",
    "end_date": "2026-04-12",
    "start_time": "18:45",
    "end_time": "22:15",
    "price": "$15 /$12 for Students",
    "location": "Dance Victoria 2740 Quadra St, Victoria, BC V8T 4E8, Canada",
    "description": "Doors open at 6:45 pm. Beginners lesson by Donna from 7 to 8 pm. Social dancing from 8 to 10:15 pm. DJs Andre and Nel. No need to register and no partner required. Please bring scuff-free inside dance shoes or socks to dance in and a water bottle."
}]
2025-06-18 13:03:19 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:03:19 - INFO - def clean_up_address(): Processing location 'Dance Victoria 2740 Quadra St, Victoria, BC V8T 4E8, Canada' (event_id: None)
2025-06-18 13:03:19 - INFO - get_address_id: Inserted or updated address_id 2628 for address '2750 Quadra ST, VICTORIA, BC, V8T4E8, CA'.
2025-06-18 13:03:19 - INFO - Populated from DB for postal code 'V8T4E8': '2750 Quadra ST, VICTORIA, BC, V8T4E8, CA'
2025-06-18 13:03:19 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 13:03:19 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/641769172035949/'
2025-06-18 13:03:19 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:03:19 - INFO - def process_llm_response: URL https://www.facebook.com/events/641769172035949/ marked as relevant with events written to the database.
2025-06-18 13:03:19 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/641769172035949/.
2025-06-18 13:03:19 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1366072544640156/
2025-06-18 13:03:19 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1366072544640156/.
2025-06-18 13:03:19 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1366072544640156/
2025-06-18 13:03:19 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:03:19 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:03:19 - INFO - query_llm(): Querying Mistral
2025-06-18 13:03:23 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:03:23 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "Dance Victoria",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Victoria WCS Collective Beginner Lesson and Social Dancing",
        "day_of_week": "Saturday",
        "start_date": "2025-05-17",
        "end_date": "2025-05-17",
        "start_time": "18:45",
        "end_time": "22:15",
        "price": "$15 / $12 for students",
        "location": "2750 Quadra St # 111, Victoria, British Columbia",
        "description": "Doors open at 6:45pm. Beginner lesson from 7 to 8 pm by John de Pfyffer. Social dancing from 8 to 10:15pm DJed by Donna and Nel. No need to register and no need for dance experience. Also, no partner necessary, we got you! Please bring indoor scuff-free dance shoes or socks to dance in."
    }
]
```
2025-06-18 13:03:23 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1366072544640156/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Dance Victoria",
        "dance_style": "west coast swing, wcs",
        "url": "",
        "event_type": "social dance",
        "event_name": "Victoria WCS Collective Beginner Lesson and Social Dancing",
        "day_of_week": "Saturday",
        "start_date": "2025-05-17",
        "end_date": "2025-05-17",
        "start_time": "18:45",
        "end_time": "22:15",
        "price": "$15 / $12 for students",
        "location": "2750 Quadra St # 111, Victoria, British Columbia",
        "description": "Doors open at 6:45pm. Beginner lesson from 7 to 8 pm by John de Pfyffer. Social dancing from 8 to 10:15pm DJed by Donna and Nel. No need to register and no need for dance experience. Also, no partner necessary, we got you! Please bring indoor scuff-free dance shoes or socks to dance in."
    }
]
2025-06-18 13:03:23 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:03:23 - INFO - def clean_up_address(): Processing location '2750 Quadra St # 111, Victoria, British Columbia' (event_id: None)
2025-06-18 13:03:23 - INFO - def clean_up_address(): Updated event None with address_id 2628 using DB match
2025-06-18 13:03:23 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 13:03:23 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1366072544640156/'
2025-06-18 13:03:23 - INFO - def process_llm_response: URL https://www.facebook.com/events/1366072544640156/ marked as relevant with events written to the database.
2025-06-18 13:03:23 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1366072544640156/.
2025-06-18 13:03:23 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/967438905456066/
2025-06-18 13:03:23 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/967438905456066/.
2025-06-18 13:03:23 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/967438905456066/
2025-06-18 13:03:23 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:03:23 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:03:23 - INFO - query_llm(): Querying Mistral
2025-06-18 13:03:30 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:03:30 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "Facebook",
    "dance_style": "west coast swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Victoria WCS Lesson and Dance",
    "day_of_week": "Wednesday",
    "start_date": "2025-03-26",
    "end_date": "2025-03-26",
    "start_time": "19:00",
    "end_time": "22:15",
    "price": "$12",
    "location": "Eastern Star Hall Chapters No 5 & No 17, 3281 Harriet Rd, Victoria",
    "description": "Doors open at 6:45pm. Beginner lesson by John de Pyffer from 7 to 8 pm. Social dancing from 8 to 10:15pm. Djs Amanda and Nel. No need to register and no partner required. Please bring scuff-free indoor shoes or socks to dance in and a water bottle."
}]
```
2025-06-18 13:03:30 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/967438905456066/, 
Cleaned JSON ready for parsing:
[{
    "source": "Facebook",
    "dance_style": "west coast swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Victoria WCS Lesson and Dance",
    "day_of_week": "Wednesday",
    "start_date": "2025-03-26",
    "end_date": "2025-03-26",
    "start_time": "19:00",
    "end_time": "22:15",
    "price": "$12",
    "location": "Eastern Star Hall Chapters No 5 & No 17, 3281 Harriet Rd, Victoria",
    "description": "Doors open at 6:45pm. Beginner lesson by John de Pyffer from 7 to 8 pm. Social dancing from 8 to 10:15pm. Djs Amanda and Nel. No need to register and no partner required. Please bring scuff-free indoor shoes or socks to dance in and a water bottle."
}]
2025-06-18 13:03:30 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:03:30 - INFO - def clean_up_address(): Processing location 'Eastern Star Hall Chapters No 5 & No 17, 3281 Harriet Rd, Victoria' (event_id: None)
2025-06-18 13:03:30 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 13:03:30 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/967438905456066/'
2025-06-18 13:03:30 - INFO - def process_llm_response: URL https://www.facebook.com/events/967438905456066/ marked as relevant with events written to the database.
2025-06-18 13:03:30 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/967438905456066/.
2025-06-18 13:03:30 - INFO - def driver_fb_search(): Keywords checkpoint updated.
2025-06-18 13:03:32 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q=milonga&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 13:03:32 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q=milonga&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 13:03:37 - INFO - extract_event_links(): Found 4 links on https://www.facebook.com/search/events?q=milonga&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 13:03:37 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q=milonga&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 4 event_links

2025-06-18 13:03:37 - INFO - should_process_url: URL https://www.facebook.com/events/644050564927019/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:03:41 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/644050564927019/ (13073 ms)
2025-06-18 13:03:57 - INFO - extract_event_text: extracted 3001 chars
2025-06-18 13:03:57 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/644050564927019/.
2025-06-18 13:03:57 - INFO - def scrape_events(): Keywords: ['dance', 'milonga', 'tango']: found in text for URL: https://www.facebook.com/events/644050564927019/.
2025-06-18 13:03:57 - INFO - should_process_url: URL https://www.facebook.com/events/1022330066692643/ was last seen as relevant, processing it.
2025-06-18 13:04:00 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1022330066692643/ (14133 ms)
2025-06-18 13:04:19 - INFO - extract_event_text: extracted 3495 chars
2025-06-18 13:04:19 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1022330066692643/.
2025-06-18 13:04:19 - INFO - def scrape_events(): Keywords: ['milonga', 'tango']: found in text for URL: https://www.facebook.com/events/1022330066692643/.
2025-06-18 13:04:19 - INFO - should_process_url: URL https://www.facebook.com/events/713923214640962/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:04:22 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/713923214640962/ (12004 ms)
2025-06-18 13:04:41 - INFO - extract_event_text: extracted 2740 chars
2025-06-18 13:04:41 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/713923214640962/.
2025-06-18 13:04:41 - INFO - def scrape_events(): Keywords: ['live music', 'milonga']: found in text for URL: https://www.facebook.com/events/713923214640962/.
2025-06-18 13:04:44 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q= tango&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 13:04:44 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q= tango&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 13:04:48 - INFO - extract_event_links(): Found 4 links on https://www.facebook.com/search/events?q= tango&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 13:04:48 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q= tango&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 4 event_links

2025-06-18 13:04:48 - INFO - def scrape_events(): Extracted text from 3 events.
2025-06-18 13:04:48 - INFO - def scrape_events(): Extracted text data written to checkpoint/extracted_text.xlsx.
2025-06-18 13:04:48 - INFO - def driver_fb_search(): Extracted text based on search_url: https://www.facebook.com/search/events?q= tango&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9.
2025-06-18 13:04:48 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/644050564927019/
2025-06-18 13:04:48 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/644050564927019/.
2025-06-18 13:04:48 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/644050564927019/
2025-06-18 13:04:48 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:04:48 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:04:48 - INFO - query_llm(): Querying Mistral
2025-06-18 13:04:52 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:04:52 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "tango",
        "url": "",
        "event_type": "social dance",
        "event_name": "Sunday Afternoon Milonga",
        "day_of_week": "Sunday",
        "start_date": "2025-04-06",
        "end_date": "2025-04-06",
        "start_time": "14:00",
        "end_time": "17:00",
        "price": "$15",
        "location": "The Coda Club, 751 View Street, Victoria",
        "description": "A NEW SUNDAY AFTERNOON MILONGA! This is the first of a regular monthly milonga at a beautiful new venue…The Coda Club (formerly Hermann’s Upstairs) at 751 View Street, Victoria. Great ambience, nice wood floor, good sound system. So come join us for the warm hugs and close embrace and dance to the beautiful music of our very own DJ John Dewhirst. Cash Bar is open for drinks Free Parking at View Street Parkade just next door Come celebrate this exciting day with us!"
    }
]
```
2025-06-18 13:04:52 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/644050564927019/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "tango",
        "url": "",
        "event_type": "social dance",
        "event_name": "Sunday Afternoon Milonga",
        "day_of_week": "Sunday",
        "start_date": "2025-04-06",
        "end_date": "2025-04-06",
        "start_time": "14:00",
        "end_time": "17:00",
        "price": "$15",
        "location": "The Coda Club, 751 View Street, Victoria",
        "description": "A NEW SUNDAY AFTERNOON MILONGA! This is the first of a regular monthly milonga at a beautiful new venue…The Coda Club (formerly Hermann’s Upstairs) at 751 View Street, Victoria. Great ambience, nice wood floor, good sound system. So come join us for the warm hugs and close embrace and dance to the beautiful music of our very own DJ John Dewhirst. Cash Bar is open for drinks Free Parking at View Street Parkade just next door Come celebrate this exciting day with us!"
    }
]
2025-06-18 13:04:52 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:04:52 - INFO - def clean_up_address(): Processing location 'The Coda Club, 751 View Street, Victoria' (event_id: None)
2025-06-18 13:04:52 - INFO - def clean_up_address(): Updated event None with address_id 4326 using DB match
2025-06-18 13:04:52 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 13:04:52 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/644050564927019/'
2025-06-18 13:04:52 - INFO - def process_llm_response: URL https://www.facebook.com/events/644050564927019/ marked as relevant with events written to the database.
2025-06-18 13:04:52 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/644050564927019/.
2025-06-18 13:04:52 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1022330066692643/
2025-06-18 13:04:52 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1022330066692643/.
2025-06-18 13:04:52 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1022330066692643/
2025-06-18 13:04:52 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:04:52 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:04:52 - INFO - query_llm(): Querying Mistral
2025-06-18 13:04:54 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:04:54 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "Alive Tango Victoria",
    "dance_style": "tango",
    "url": "",
    "event_type": "workshop",
    "event_name": "Technique and Milonga with Monica Parra",
    "day_of_week": "Wednesday",
    "start_date": "2025-07-02",
    "end_date": "2025-07-02",
    "start_time": "18:30",
    "end_time": "20:00",
    "price": "$30",
    "location": "Alive Tango Victoria, 1303 Broad St., Victoria",
    "description": "Follower’s technique: Pivots and turns, Dissociation technique and axis control, Free leg preparation before the turn, Turns in tight spaces (useful in a close embrace!!). 90 minutes."
}]
```
2025-06-18 13:04:54 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1022330066692643/, 
Cleaned JSON ready for parsing:
[{
    "source": "Alive Tango Victoria",
    "dance_style": "tango",
    "url": "",
    "event_type": "workshop",
    "event_name": "Technique and Milonga with Monica Parra",
    "day_of_week": "Wednesday",
    "start_date": "2025-07-02",
    "end_date": "2025-07-02",
    "start_time": "18:30",
    "end_time": "20:00",
    "price": "$30",
    "location": "Alive Tango Victoria, 1303 Broad St., Victoria",
    "description": "Follower’s technique: Pivots and turns, Dissociation technique and axis control, Free leg preparation before the turn, Turns in tight spaces (useful in a close embrace!!). 90 minutes."
}]
2025-06-18 13:04:54 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:04:54 - INFO - def clean_up_address(): Processing location 'Alive Tango Victoria, 1303 Broad St., Victoria' (event_id: None)
2025-06-18 13:04:54 - INFO - def clean_up_address(): Updated event None with address_id 1928 using DB match
2025-06-18 13:04:54 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 13:04:54 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1022330066692643/'
2025-06-18 13:04:54 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:04:54 - INFO - def process_llm_response: URL https://www.facebook.com/events/1022330066692643/ marked as relevant with events written to the database.
2025-06-18 13:04:54 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1022330066692643/.
2025-06-18 13:04:54 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/713923214640962/
2025-06-18 13:04:54 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/713923214640962/.
2025-06-18 13:04:54 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/713923214640962/
2025-06-18 13:04:54 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:04:54 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:04:54 - INFO - query_llm(): Querying Mistral
2025-06-18 13:04:59 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:04:59 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "tango",
    "url": "",
    "event_type": "social dance",
    "event_name": "May 4th Afternoon Milonga",
    "day_of_week": "Sunday",
    "start_date": "2025-05-04",
    "end_date": "2025-05-04",
    "start_time": "13:00",
    "end_time": "16:00",
    "price": "$15",
    "location": "Solwood Studio 1303 Broad St Victoria, BC",
    "description": "A one-time special afternoon milonga! Join us in celebrating the warmth of Spring and return to sunshine. Or, star wars, if you like. Featuring special guests Kimberly and Khang performing live music (violin/guitar). DJ Ingrid. Hosts: Kathryn & Ingrid."
}]
```
2025-06-18 13:04:59 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/713923214640962/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "tango",
    "url": "",
    "event_type": "social dance",
    "event_name": "May 4th Afternoon Milonga",
    "day_of_week": "Sunday",
    "start_date": "2025-05-04",
    "end_date": "2025-05-04",
    "start_time": "13:00",
    "end_time": "16:00",
    "price": "$15",
    "location": "Solwood Studio 1303 Broad St Victoria, BC",
    "description": "A one-time special afternoon milonga! Join us in celebrating the warmth of Spring and return to sunshine. Or, star wars, if you like. Featuring special guests Kimberly and Khang performing live music (violin/guitar). DJ Ingrid. Hosts: Kathryn & Ingrid."
}]
2025-06-18 13:04:59 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:04:59 - INFO - def clean_up_address(): Processing location 'Solwood Studio 1303 Broad St Victoria, BC' (event_id: None)
2025-06-18 13:04:59 - INFO - def clean_up_address(): Updated event None with address_id 1928 using DB match
2025-06-18 13:04:59 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 13:04:59 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/713923214640962/'
2025-06-18 13:04:59 - INFO - def process_llm_response: URL https://www.facebook.com/events/713923214640962/ marked as relevant with events written to the database.
2025-06-18 13:04:59 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/713923214640962/.
2025-06-18 13:04:59 - INFO - def driver_fb_search(): Keywords checkpoint updated.
2025-06-18 13:05:01 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q=live music&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 13:05:01 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q=live music&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 13:05:06 - INFO - extract_event_links(): Found 18 links on https://www.facebook.com/search/events?q=live music&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 13:05:06 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q=live music&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 18 event_links

2025-06-18 13:05:06 - INFO - should_process_url: URL https://www.facebook.com/events/1142760357225336/ was last seen as relevant, processing it.
2025-06-18 13:05:10 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1142760357225336/ (11981 ms)
2025-06-18 13:05:28 - INFO - extract_event_text: extracted 3098 chars
2025-06-18 13:05:28 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1142760357225336/.
2025-06-18 13:05:28 - INFO - def scrape_events(): Keywords: ['dance', 'live music', 'tango']: found in text for URL: https://www.facebook.com/events/1142760357225336/.
2025-06-18 13:05:28 - INFO - should_process_url: URL https://www.facebook.com/events/1217747446718881/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:05:32 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1217747446718881/ (12595 ms)
2025-06-18 13:05:53 - INFO - extract_event_text: extracted 2989 chars
2025-06-18 13:05:53 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1217747446718881/.
2025-06-18 13:05:53 - INFO - def scrape_events(): Keywords: ['dance', 'live music']: found in text for URL: https://www.facebook.com/events/1217747446718881/.
2025-06-18 13:05:53 - INFO - should_process_url: URL https://www.facebook.com/events/651664851189740/ was last seen as relevant, processing it.
2025-06-18 13:05:56 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/651664851189740/ (11938 ms)
2025-06-18 13:06:13 - INFO - extract_event_text: extracted 3148 chars
2025-06-18 13:06:13 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/651664851189740/.
2025-06-18 13:06:13 - INFO - def scrape_events(): Keywords: ['live music']: found in text for URL: https://www.facebook.com/events/651664851189740/.
2025-06-18 13:06:13 - INFO - should_process_url: URL https://www.facebook.com/events/1381660939932292/ has never been seen before, processing it.
2025-06-18 13:06:16 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1381660939932292/ (12948 ms)
2025-06-18 13:06:34 - INFO - extract_event_text: extracted 3637 chars
2025-06-18 13:06:34 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1381660939932292/.
2025-06-18 13:06:34 - INFO - def scrape_events(): No keywords found in extracted text for URL: https://www.facebook.com/events/1381660939932292/.
2025-06-18 13:06:34 - INFO - should_process_url: URL https://www.facebook.com/events/1414577976223422/ was last seen as relevant, processing it.
2025-06-18 13:06:36 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1414577976223422/ (12274 ms)
2025-06-18 13:06:59 - INFO - extract_event_text: extracted 3724 chars
2025-06-18 13:06:59 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1414577976223422/.
2025-06-18 13:06:59 - INFO - def scrape_events(): Keywords: ['live music']: found in text for URL: https://www.facebook.com/events/1414577976223422/.
2025-06-18 13:06:59 - INFO - should_process_url: URL https://www.facebook.com/events/1235598461330700/ has never been seen before, processing it.
2025-06-18 13:07:02 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1235598461330700/ (13293 ms)
2025-06-18 13:07:20 - INFO - extract_event_text: extracted 4304 chars
2025-06-18 13:07:20 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1235598461330700/.
2025-06-18 13:07:20 - INFO - def scrape_events(): Keywords: ['dance', 'tango']: found in text for URL: https://www.facebook.com/events/1235598461330700/.
2025-06-18 13:07:20 - INFO - should_process_url: URL https://www.facebook.com/events/665127126496204/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:07:23 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/665127126496204/ (11444 ms)
2025-06-18 13:07:36 - INFO - extract_event_text: extracted 2816 chars
2025-06-18 13:07:36 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/665127126496204/.
2025-06-18 13:07:36 - INFO - def scrape_events(): Keywords: ['live music']: found in text for URL: https://www.facebook.com/events/665127126496204/.
2025-06-18 13:07:36 - INFO - should_process_url: URL https://www.facebook.com/events/1093118172681618/ was last seen as relevant, processing it.
2025-06-18 13:07:39 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1093118172681618/ (14946 ms)
2025-06-18 13:07:52 - INFO - extract_event_text: extracted 2909 chars
2025-06-18 13:07:52 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1093118172681618/.
2025-06-18 13:07:52 - WARNING - def extract_relevant_text(): 'Guests See All' not found after last day of the week in https://www.facebook.com/events/1093118172681618/.
2025-06-18 13:07:52 - INFO - def scrape_events(): Keywords: ['bachata', 'dance', 'live music', 'salsa', 'swing', 'tango', 'west coast swing']: found in text for URL: https://www.facebook.com/events/1093118172681618/.
2025-06-18 13:07:52 - INFO - should_process_url: URL https://www.facebook.com/events/1085685423617722/ has never been seen before, processing it.
2025-06-18 13:07:55 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1085685423617722/ (11869 ms)
2025-06-18 13:08:11 - INFO - extract_event_text: extracted 3204 chars
2025-06-18 13:08:11 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1085685423617722/.
2025-06-18 13:08:11 - INFO - def scrape_events(): Keywords: ['live music']: found in text for URL: https://www.facebook.com/events/1085685423617722/.
2025-06-18 13:08:11 - INFO - should_process_url: URL https://www.facebook.com/events/1975172826621817/ was last seen as relevant, processing it.
2025-06-18 13:08:13 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1975172826621817/ (11491 ms)
2025-06-18 13:08:31 - INFO - extract_event_text: extracted 4458 chars
2025-06-18 13:08:31 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1975172826621817/.
2025-06-18 13:08:31 - WARNING - def extract_relevant_text(): 'Guests See All' not found after last day of the week in https://www.facebook.com/events/1975172826621817/.
2025-06-18 13:08:31 - INFO - def scrape_events(): Keywords: ['bachata', 'dance', 'kizomba', 'live music', 'salsa', 'swing', 'tango', 'west coast swing']: found in text for URL: https://www.facebook.com/events/1975172826621817/.
2025-06-18 13:08:31 - INFO - should_process_url: URL https://www.facebook.com/events/979769967649565/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:08:33 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/979769967649565/ (12743 ms)
2025-06-18 13:08:48 - INFO - extract_event_text: extracted 2712 chars
2025-06-18 13:08:48 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/979769967649565/.
2025-06-18 13:08:48 - INFO - def scrape_events(): Keywords: ['live music']: found in text for URL: https://www.facebook.com/events/979769967649565/.
2025-06-18 13:08:48 - INFO - should_process_url: URL https://www.facebook.com/events/686146924271113/ was last seen as relevant, processing it.
2025-06-18 13:08:50 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/686146924271113/ (13276 ms)
2025-06-18 13:09:09 - INFO - extract_event_text: extracted 4146 chars
2025-06-18 13:09:09 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/686146924271113/.
2025-06-18 13:09:09 - WARNING - def extract_relevant_text(): 'Guests See All' not found after last day of the week in https://www.facebook.com/events/686146924271113/.
2025-06-18 13:09:09 - INFO - def scrape_events(): Keywords: ['bachata', 'dance', 'salsa', 'swing', 'tango', 'west coast swing']: found in text for URL: https://www.facebook.com/events/686146924271113/.
2025-06-18 13:09:09 - INFO - should_process_url: URL https://www.facebook.com/events/685376710864837/ has never been seen before, processing it.
2025-06-18 13:09:12 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/685376710864837/ (11166 ms)
2025-06-18 13:09:28 - INFO - extract_event_text: extracted 3261 chars
2025-06-18 13:09:28 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/685376710864837/.
2025-06-18 13:09:28 - INFO - def scrape_events(): No keywords found in extracted text for URL: https://www.facebook.com/events/685376710864837/.
2025-06-18 13:09:28 - INFO - should_process_url: URL https://www.facebook.com/events/2579625309035667/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:09:31 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/2579625309035667/ (12202 ms)
2025-06-18 13:09:50 - INFO - extract_event_text: extracted 3295 chars
2025-06-18 13:09:50 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/2579625309035667/.
2025-06-18 13:09:50 - INFO - def scrape_events(): Keywords: ['live music']: found in text for URL: https://www.facebook.com/events/2579625309035667/.
2025-06-18 13:09:50 - INFO - should_process_url: URL https://www.facebook.com/events/4223643791110348/ was last seen as relevant, processing it.
2025-06-18 13:09:53 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/4223643791110348/ (13781 ms)
2025-06-18 13:10:04 - INFO - extract_event_text: extracted 2663 chars
2025-06-18 13:10:04 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/4223643791110348/.
2025-06-18 13:10:04 - INFO - def scrape_events(): Keywords: ['live music']: found in text for URL: https://www.facebook.com/events/4223643791110348/.
2025-06-18 13:10:04 - INFO - should_process_url: URL https://www.facebook.com/events/1838117176980132/ was last seen as relevant, processing it.
2025-06-18 13:10:07 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1838117176980132/ (10949 ms)
2025-06-18 13:10:25 - INFO - extract_event_text: extracted 2923 chars
2025-06-18 13:10:25 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1838117176980132/.
2025-06-18 13:10:25 - INFO - def scrape_events(): No keywords found in extracted text for URL: https://www.facebook.com/events/1838117176980132/.
2025-06-18 13:10:25 - INFO - should_process_url: URL https://www.facebook.com/events/640894018988221/ has never been seen before, processing it.
2025-06-18 13:10:29 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/640894018988221/ (14491 ms)
2025-06-18 13:10:50 - INFO - extract_event_text: extracted 3477 chars
2025-06-18 13:10:50 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/640894018988221/.
2025-06-18 13:10:50 - INFO - def scrape_events(): No keywords found in extracted text for URL: https://www.facebook.com/events/640894018988221/.
2025-06-18 13:10:50 - INFO - should_process_url: URL https://www.facebook.com/events/1399479741193649/ was last seen as relevant, processing it.
2025-06-18 13:10:52 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1399479741193649/ (10551 ms)
2025-06-18 13:11:06 - INFO - extract_event_text: extracted 2729 chars
2025-06-18 13:11:06 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1399479741193649/.
2025-06-18 13:11:06 - INFO - def scrape_events(): Keywords: ['live music']: found in text for URL: https://www.facebook.com/events/1399479741193649/.
2025-06-18 13:11:08 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q= music festivals&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 13:11:08 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q= music festivals&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 13:11:13 - INFO - extract_event_links(): Found 5 links on https://www.facebook.com/search/events?q= music festivals&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 13:11:13 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q= music festivals&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 5 event_links

2025-06-18 13:11:13 - INFO - should_process_url: URL https://www.facebook.com/events/1110747367748372/ was last seen as relevant, processing it.
2025-06-18 13:11:16 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1110747367748372/ (14773 ms)
2025-06-18 13:11:41 - INFO - extract_event_text: extracted 6722 chars
2025-06-18 13:11:41 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1110747367748372/.
2025-06-18 13:11:41 - INFO - def scrape_events(): Keywords: ['dance']: found in text for URL: https://www.facebook.com/events/1110747367748372/.
2025-06-18 13:11:41 - INFO - should_process_url: URL https://www.facebook.com/events/3865520990379929/ was last seen as relevant, processing it.
2025-06-18 13:11:44 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/3865520990379929/ (11474 ms)
2025-06-18 13:11:55 - INFO - extract_event_text: extracted 3197 chars
2025-06-18 13:11:55 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/3865520990379929/.
2025-06-18 13:11:55 - INFO - def scrape_events(): No keywords found in extracted text for URL: https://www.facebook.com/events/3865520990379929/.
2025-06-18 13:11:55 - INFO - should_process_url: URL https://www.facebook.com/events/1050242777151793/ was last seen as relevant, processing it.
2025-06-18 13:11:58 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1050242777151793/ (13001 ms)
2025-06-18 13:12:25 - INFO - extract_event_text: extracted 3363 chars
2025-06-18 13:12:25 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1050242777151793/.
2025-06-18 13:12:25 - INFO - def scrape_events(): Keywords: ['dance', 'tango']: found in text for URL: https://www.facebook.com/events/1050242777151793/.
2025-06-18 13:12:25 - INFO - should_process_url: URL https://www.facebook.com/events/1451663826076478/ has never been seen before, processing it.
2025-06-18 13:12:28 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1451663826076478/ (13052 ms)
2025-06-18 13:12:47 - INFO - extract_event_text: extracted 3355 chars
2025-06-18 13:12:47 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1451663826076478/.
2025-06-18 13:12:47 - INFO - def scrape_events(): Keywords: ['live music']: found in text for URL: https://www.facebook.com/events/1451663826076478/.
2025-06-18 13:12:49 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/search/events?q= outdoor music&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 13:12:49 - INFO - extract_event_links(): Navigating to https://www.facebook.com/search/events?q= outdoor music&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 13:12:54 - INFO - extract_event_links(): Found 4 links on https://www.facebook.com/search/events?q= outdoor music&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9
2025-06-18 13:12:54 - INFO - def scrape_events: Used https://www.facebook.com/search/events?q= outdoor music&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9 to get 4 event_links

2025-06-18 13:12:54 - INFO - should_process_url: URL https://www.facebook.com/events/1384436216056647/ has never been seen before, processing it.
2025-06-18 13:12:58 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1384436216056647/ (11368 ms)
2025-06-18 13:13:16 - INFO - extract_event_text: extracted 3903 chars
2025-06-18 13:13:16 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1384436216056647/.
2025-06-18 13:13:16 - INFO - def scrape_events(): No keywords found in extracted text for URL: https://www.facebook.com/events/1384436216056647/.
2025-06-18 13:13:16 - INFO - should_process_url: URL https://www.facebook.com/events/1514674672845802/ was last seen as relevant, processing it.
2025-06-18 13:13:19 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1514674672845802/ (14001 ms)
2025-06-18 13:13:38 - INFO - extract_event_text: extracted 3146 chars
2025-06-18 13:13:38 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/1514674672845802/.
2025-06-18 13:13:38 - INFO - def scrape_events(): Keywords: ['dance']: found in text for URL: https://www.facebook.com/events/1514674672845802/.
2025-06-18 13:13:38 - INFO - should_process_url: URL https://www.facebook.com/events/738449035511156/ has never been seen before, processing it.
2025-06-18 13:13:41 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/738449035511156/ (12060 ms)
2025-06-18 13:13:58 - INFO - extract_event_text: extracted 2996 chars
2025-06-18 13:13:58 - INFO - def extract_relevant_text(): Extracting relevant text from https://www.facebook.com/events/738449035511156/.
2025-06-18 13:13:58 - INFO - def scrape_events(): No keywords found in extracted text for URL: https://www.facebook.com/events/738449035511156/.
2025-06-18 13:13:58 - INFO - def scrape_events(): Extracted text from 18 events.
2025-06-18 13:13:58 - INFO - def scrape_events(): Extracted text data written to checkpoint/extracted_text.xlsx.
2025-06-18 13:13:58 - INFO - def driver_fb_search(): Extracted text based on search_url: https://www.facebook.com/search/events?q= outdoor music&filters=eyJycF9ldmVudHNfbG9jYXRpb246MCI6IntcIm5hbWVcIjpcImZpbHRlcl9ldmVudHNfbG9jYXRpb25cIixcImFyZ3NcIjpcIjEwMzEzNTg3OTcyNzM4MlwifSJ9.
2025-06-18 13:13:58 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1142760357225336/
2025-06-18 13:13:58 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1142760357225336/.
2025-06-18 13:13:58 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1142760357225336/
2025-06-18 13:13:58 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:13:58 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:13:58 - INFO - query_llm(): Querying Mistral
2025-06-18 13:14:01 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:14:01 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "contra",
    "url": "",
    "event_type": "social dance",
    "event_name": "Pride Contra Dance",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-20",
    "start_time": "19:00",
    "end_time": "22:00",
    "price": "",
    "location": "",
    "description": ""
}]
```
2025-06-18 13:14:01 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1142760357225336/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "contra",
    "url": "",
    "event_type": "social dance",
    "event_name": "Pride Contra Dance",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-20",
    "start_time": "19:00",
    "end_time": "22:00",
    "price": "",
    "location": "",
    "description": ""
}]
2025-06-18 13:14:01 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:14:01 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 13:14:01 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1142760357225336/'
2025-06-18 13:14:01 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:14:01 - INFO - def process_llm_response: URL https://www.facebook.com/events/1142760357225336/ marked as relevant with events written to the database.
2025-06-18 13:14:01 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1142760357225336/.
2025-06-18 13:14:01 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1217747446718881/
2025-06-18 13:14:01 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1217747446718881/.
2025-06-18 13:14:01 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1217747446718881/
2025-06-18 13:14:01 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:14:01 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:14:01 - INFO - query_llm(): Querying Mistral
2025-06-18 13:14:03 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:14:03 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "",
        "url": "www.victoriaedelweiss.ca/events",
        "event_type": "live music",
        "event_name": "Maifest - Evening of Live Music",
        "day_of_week": "Saturday",
        "start_date": "2025-05-24",
        "end_date": "2025-05-24",
        "start_time": "18:00",
        "end_time": "22:00",
        "price": "",
        "location": "Edelweiss Club, 108 Niagara Street, Victoria",
        "description": "Join the Edelweiss Club for a lively evening of music and dance with Bijoux du Bayou and The Helen Davies Band. Let the infectious Zydeco beats and soulful rhythms set the tone for a night of fun, complete with delicious German snacks from the kitchen. Don’t miss out on this high-energy event!"
    }
]
```
2025-06-18 13:14:03 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1217747446718881/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "",
        "url": "www.victoriaedelweiss.ca/events",
        "event_type": "live music",
        "event_name": "Maifest - Evening of Live Music",
        "day_of_week": "Saturday",
        "start_date": "2025-05-24",
        "end_date": "2025-05-24",
        "start_time": "18:00",
        "end_time": "22:00",
        "price": "",
        "location": "Edelweiss Club, 108 Niagara Street, Victoria",
        "description": "Join the Edelweiss Club for a lively evening of music and dance with Bijoux du Bayou and The Helen Davies Band. Let the infectious Zydeco beats and soulful rhythms set the tone for a night of fun, complete with delicious German snacks from the kitchen. Don’t miss out on this high-energy event!"
    }
]
2025-06-18 13:14:03 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:14:03 - INFO - def clean_up_address(): Processing location 'Edelweiss Club, 108 Niagara Street, Victoria' (event_id: None)
2025-06-18 13:14:03 - INFO - def clean_up_address(): Updated event None with address_id 5 using DB match
2025-06-18 13:14:03 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 13:14:03 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1217747446718881/'
2025-06-18 13:14:03 - INFO - def process_llm_response: URL https://www.facebook.com/events/1217747446718881/ marked as relevant with events written to the database.
2025-06-18 13:14:03 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1217747446718881/.
2025-06-18 13:14:03 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/651664851189740/
2025-06-18 13:14:03 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/651664851189740/.
2025-06-18 13:14:03 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/651664851189740/
2025-06-18 13:14:03 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:14:03 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:14:03 - INFO - query_llm(): Querying Mistral
2025-06-18 13:14:07 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:14:07 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Music in the Orchard",
    "day_of_week": "Sunday",
    "start_date": "2025-06-15",
    "end_date": "2025-06-15",
    "start_time": "12:00",
    "end_time": "18:00",
    "price": "",
    "location": "Junction Orchard & Cidery, 284 Prospect Lake Rd, Saanich, BC V9E 1J7, Canada",
    "description": "Come enjoy the start of the summer in the orchard. We have two amazing artists for you, some delicious fun summer ciders for you to try and amazing food to enjoy to complete the experience. Delicious Cider Live Music Bicycle Pizza Beautiful location Dog Friendly This is an outdoor event so bring your WELL BEHAVED two legged and 4 legged babies and dress appropriately coz we are going ahead RAIN OR SHINE!"
}]
```
2025-06-18 13:14:07 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/651664851189740/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Music in the Orchard",
    "day_of_week": "Sunday",
    "start_date": "2025-06-15",
    "end_date": "2025-06-15",
    "start_time": "12:00",
    "end_time": "18:00",
    "price": "",
    "location": "Junction Orchard & Cidery, 284 Prospect Lake Rd, Saanich, BC V9E 1J7, Canada",
    "description": "Come enjoy the start of the summer in the orchard. We have two amazing artists for you, some delicious fun summer ciders for you to try and amazing food to enjoy to complete the experience. Delicious Cider Live Music Bicycle Pizza Beautiful location Dog Friendly This is an outdoor event so bring your WELL BEHAVED two legged and 4 legged babies and dress appropriately coz we are going ahead RAIN OR SHINE!"
}]
2025-06-18 13:14:07 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:14:07 - INFO - def clean_up_address(): Processing location 'Junction Orchard & Cidery, 284 Prospect Lake Rd, Saanich, BC V9E 1J7, Canada' (event_id: None)
2025-06-18 13:14:07 - INFO - def clean_up_address(): Updated event None with address_id 9811 using DB match
2025-06-18 13:14:07 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 13:14:07 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/651664851189740/'
2025-06-18 13:14:07 - INFO - def process_llm_response: URL https://www.facebook.com/events/651664851189740/ marked as relevant with events written to the database.
2025-06-18 13:14:07 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/651664851189740/.
2025-06-18 13:14:07 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1414577976223422/
2025-06-18 13:14:07 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1414577976223422/.
2025-06-18 13:14:07 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1414577976223422/
2025-06-18 13:14:07 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:14:07 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:14:07 - INFO - query_llm(): Querying Mistral
2025-06-18 13:14:10 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:14:10 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "",
        "url": "www.eventbrite.com/e/solstice-slammer-3-tickets-1389012316229",
        "event_type": "live music",
        "event_name": "Solstice Slammer 3 - Moon Under Water",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "19:00",
        "end_time": "23:00",
        "price": "CA$10",
        "location": "The Moon Under Water Brewpub, 5435 Fowler Rd, Saanich, BC V8Y 1Y4, Canada",
        "description": "Come join us for Solstice Slammer III at Moon Under Water Brewpub and Distillery! Get ready to celebrate with Electric Druids, Gate Theory and West Street Children, hefty drinks and good vibes. Whether you're a craft beer enthusiast or just an enthusiast, there's something for everyone at this epic night of live music. Don't miss out - mark your calendars!"
    }
]
```
2025-06-18 13:14:10 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1414577976223422/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "",
        "url": "www.eventbrite.com/e/solstice-slammer-3-tickets-1389012316229",
        "event_type": "live music",
        "event_name": "Solstice Slammer 3 - Moon Under Water",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "19:00",
        "end_time": "23:00",
        "price": "CA$10",
        "location": "The Moon Under Water Brewpub, 5435 Fowler Rd, Saanich, BC V8Y 1Y4, Canada",
        "description": "Come join us for Solstice Slammer III at Moon Under Water Brewpub and Distillery! Get ready to celebrate with Electric Druids, Gate Theory and West Street Children, hefty drinks and good vibes. Whether you're a craft beer enthusiast or just an enthusiast, there's something for everyone at this epic night of live music. Don't miss out - mark your calendars!"
    }
]
2025-06-18 13:14:10 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:14:10 - INFO - def clean_up_address(): Processing location 'The Moon Under Water Brewpub, 5435 Fowler Rd, Saanich, BC V8Y 1Y4, Canada' (event_id: None)
2025-06-18 13:14:10 - INFO - def clean_up_address(): Updated event None with address_id 10279 using DB match
2025-06-18 13:14:10 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 13:14:10 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1414577976223422/'
2025-06-18 13:14:10 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:14:10 - INFO - def process_llm_response: URL https://www.facebook.com/events/1414577976223422/ marked as relevant with events written to the database.
2025-06-18 13:14:10 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1414577976223422/.
2025-06-18 13:14:10 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1235598461330700/
2025-06-18 13:14:10 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1235598461330700/.
2025-06-18 13:14:10 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1235598461330700/
2025-06-18 13:14:10 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:14:10 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:14:10 - INFO - query_llm(): Querying Mistral
2025-06-18 13:14:13 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:14:13 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Alfie Zappacosta Live at Hermann's Jazz Club",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "19:00",
        "end_time": null,
        "price": "",
        "location": "Hermann's Jazz Club, 751 View St, Victoria, BC V8W 1J9, Canada",
        "description": "Two time Juno award winner singer songwriter Alfie Zappacosta delivers a performance like no other. A sophisticated musician with international poise Alfie sings in both English and Italian; studied in jazz and classical guitar. He is a virtuoso composer and seasoned live performer. Alfie's rich soaring vocals have always been his signature and his songs diverse drawing from pop, jazz and rock elements."
    }
]
```
2025-06-18 13:14:13 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1235598461330700/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Alfie Zappacosta Live at Hermann's Jazz Club",
        "day_of_week": "Saturday",
        "start_date": "2025-06-21",
        "end_date": "2025-06-21",
        "start_time": "19:00",
        "end_time": null,
        "price": "",
        "location": "Hermann's Jazz Club, 751 View St, Victoria, BC V8W 1J9, Canada",
        "description": "Two time Juno award winner singer songwriter Alfie Zappacosta delivers a performance like no other. A sophisticated musician with international poise Alfie sings in both English and Italian; studied in jazz and classical guitar. He is a virtuoso composer and seasoned live performer. Alfie's rich soaring vocals have always been his signature and his songs diverse drawing from pop, jazz and rock elements."
    }
]
2025-06-18 13:14:13 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:14:13 - INFO - def clean_up_address(): Processing location 'Hermann's Jazz Club, 751 View St, Victoria, BC V8W 1J9, Canada' (event_id: None)
2025-06-18 13:14:13 - INFO - def clean_up_address(): Updated event None with address_id 4326 using DB match
2025-06-18 13:14:13 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 13:14:13 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1235598461330700/'
2025-06-18 13:14:13 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:14:13 - INFO - def process_llm_response: URL https://www.facebook.com/events/1235598461330700/ marked as relevant with events written to the database.
2025-06-18 13:14:13 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1235598461330700/.
2025-06-18 13:14:13 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/665127126496204/
2025-06-18 13:14:13 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/665127126496204/.
2025-06-18 13:14:13 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/665127126496204/
2025-06-18 13:14:13 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:14:13 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:14:13 - INFO - query_llm(): Querying Mistral
2025-06-18 13:14:17 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:14:17 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "VINYL WAVE",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Live Music at the Saxe Point Public House",
        "day_of_week": "Tuesday",
        "start_date": "2025-05-27",
        "end_date": "2025-05-27",
        "start_time": "19:30",
        "end_time": null,
        "price": "",
        "location": "Saxe Point Public House, 101-505 Park Place, Victoria",
        "description": "Live Music every other Tuesday starting May 27th! Victoria, British Columbia"
    }
]
```
2025-06-18 13:14:17 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/665127126496204/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "VINYL WAVE",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Live Music at the Saxe Point Public House",
        "day_of_week": "Tuesday",
        "start_date": "2025-05-27",
        "end_date": "2025-05-27",
        "start_time": "19:30",
        "end_time": null,
        "price": "",
        "location": "Saxe Point Public House, 101-505 Park Place, Victoria",
        "description": "Live Music every other Tuesday starting May 27th! Victoria, British Columbia"
    }
]
2025-06-18 13:14:17 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:14:17 - INFO - def clean_up_address(): Processing location 'Saxe Point Public House, 101-505 Park Place, Victoria' (event_id: None)
2025-06-18 13:14:17 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 13:14:17 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/665127126496204/'
2025-06-18 13:14:17 - INFO - def process_llm_response: URL https://www.facebook.com/events/665127126496204/ marked as relevant with events written to the database.
2025-06-18 13:14:17 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/665127126496204/.
2025-06-18 13:14:17 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1093118172681618/
2025-06-18 13:14:17 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1093118172681618/.
2025-06-18 13:14:17 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1093118172681618/
2025-06-18 13:14:17 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:14:17 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:14:17 - INFO - query_llm(): Querying Mistral
2025-06-18 13:14:19 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:14:19 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "Facebook",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Swing Dancing in City Square",
    "day_of_week": "Wednesday",
    "start_date": "2025-06-18",
    "end_date": "2025-06-18",
    "start_time": "18:30",
    "end_time": null,
    "price": "",
    "location": "Duncan City Hall",
    "description": "Swing Dancing in City Square"
}]
```
2025-06-18 13:14:19 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1093118172681618/, 
Cleaned JSON ready for parsing:
[{
    "source": "Facebook",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Swing Dancing in City Square",
    "day_of_week": "Wednesday",
    "start_date": "2025-06-18",
    "end_date": "2025-06-18",
    "start_time": "18:30",
    "end_time": null,
    "price": "",
    "location": "Duncan City Hall",
    "description": "Swing Dancing in City Square"
}]
2025-06-18 13:14:19 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:14:19 - INFO - def clean_up_address(): Processing location 'Duncan City Hall' (event_id: None)
2025-06-18 13:14:19 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 13:14:19 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1093118172681618/'
2025-06-18 13:14:19 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:14:19 - INFO - def process_llm_response: URL https://www.facebook.com/events/1093118172681618/ marked as relevant with events written to the database.
2025-06-18 13:14:19 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1093118172681618/.
2025-06-18 13:14:19 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1085685423617722/
2025-06-18 13:14:19 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1085685423617722/.
2025-06-18 13:14:19 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1085685423617722/
2025-06-18 13:14:19 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:14:19 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:14:19 - INFO - query_llm(): Querying Mistral
2025-06-18 13:14:21 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:14:21 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "Mcpherson Playhouse",
        "dance_style": "",
        "url": "https://www.rmts.bc.ca/.../2025.../the-men-in-black/",
        "event_type": "live music",
        "event_name": "The Men in Black: A Tribute to the Music of Johnny Cash",
        "day_of_week": "Thursday",
        "start_date": "2025-09-25",
        "end_date": "2025-09-25",
        "start_time": "10:00",
        "end_time": null,
        "price": "",
        "location": "Mcpherson Playhouse, Victoria, British Columbia",
        "description": "The Men in Black: The Songs and stories of Johnny Cash, presented Live onstage in this Multimedia production. Featuring special guest Tracee Rees singing the parts of June Carter Cash."
    }
]
```
2025-06-18 13:14:21 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1085685423617722/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Mcpherson Playhouse",
        "dance_style": "",
        "url": "https://www.rmts.bc.ca//2025/the-men-in-black/",
        "event_type": "live music",
        "event_name": "The Men in Black: A Tribute to the Music of Johnny Cash",
        "day_of_week": "Thursday",
        "start_date": "2025-09-25",
        "end_date": "2025-09-25",
        "start_time": "10:00",
        "end_time": null,
        "price": "",
        "location": "Mcpherson Playhouse, Victoria, British Columbia",
        "description": "The Men in Black: The Songs and stories of Johnny Cash, presented Live onstage in this Multimedia production. Featuring special guest Tracee Rees singing the parts of June Carter Cash."
    }
]
2025-06-18 13:14:21 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:14:21 - INFO - def clean_up_address(): Processing location 'Mcpherson Playhouse, Victoria, British Columbia' (event_id: None)
2025-06-18 13:14:21 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 13:14:21 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1085685423617722/'
2025-06-18 13:14:21 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:14:21 - INFO - def process_llm_response: URL https://www.facebook.com/events/1085685423617722/ marked as relevant with events written to the database.
2025-06-18 13:14:21 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1085685423617722/.
2025-06-18 13:14:21 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1975172826621817/
2025-06-18 13:14:21 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1975172826621817/.
2025-06-18 13:14:21 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1975172826621817/
2025-06-18 13:14:21 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:14:21 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:14:21 - INFO - query_llm(): Querying Mistral
2025-06-18 13:14:25 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:14:25 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "Facebook",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Rest&Resonate: an Evening of Restorative Yoga and Live Music",
        "day_of_week": "Thursday",
        "start_date": "2025-06-12",
        "end_date": "2025-06-12",
        "start_time": "19:00",
        "end_time": "20:30",
        "price": "$42",
        "location": "Little Fernwood Gallery, 1923 Fernwood Ave., Victoria",
        "description": "Join Anna & Roxie for a dreamy candlelit evening of restorative yoga, live music, and guided journalling. The space will be dreamy, there will be tea, guided journalling, poetry, restorative yoga shapes that can be adapted for any body, and LIVE MUSIC! Anna will be playing guitar, creating dreamy sound worlds with vocal looping, and singing you lullabies all evening. This event is on the ground floor and there is a unisex/non-gendered bathroom on the same level. As members of and allies of the 2SLGBTQIA community, we (Anna & Roxie) will create a supportive, inclusive, affirming environment and expect all participants to do the same."
    }
]
```
2025-06-18 13:14:25 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1975172826621817/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Facebook",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Rest&Resonate: an Evening of Restorative Yoga and Live Music",
        "day_of_week": "Thursday",
        "start_date": "2025-06-12",
        "end_date": "2025-06-12",
        "start_time": "19:00",
        "end_time": "20:30",
        "price": "$42",
        "location": "Little Fernwood Gallery, 1923 Fernwood Ave., Victoria",
        "description": "Join Anna & Roxie for a dreamy candlelit evening of restorative yoga, live music, and guided journalling. The space will be dreamy, there will be tea, guided journalling, poetry, restorative yoga shapes that can be adapted for any body, and LIVE MUSIC! Anna will be playing guitar, creating dreamy sound worlds with vocal looping, and singing you lullabies all evening. This event is on the ground floor and there is a unisex/non-gendered bathroom on the same level. As members of and allies of the 2SLGBTQIA community, we (Anna & Roxie) will create a supportive, inclusive, affirming environment and expect all participants to do the same."
    }
]
2025-06-18 13:14:25 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:14:25 - INFO - def clean_up_address(): Processing location 'Little Fernwood Gallery, 1923 Fernwood Ave., Victoria' (event_id: None)
2025-06-18 13:14:25 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 13:14:25 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1975172826621817/'
2025-06-18 13:14:25 - INFO - def process_llm_response: URL https://www.facebook.com/events/1975172826621817/ marked as relevant with events written to the database.
2025-06-18 13:14:25 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1975172826621817/.
2025-06-18 13:14:25 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/979769967649565/
2025-06-18 13:14:25 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/979769967649565/.
2025-06-18 13:14:25 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/979769967649565/
2025-06-18 13:14:25 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:14:25 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:14:25 - INFO - query_llm(): Querying Mistral
2025-06-18 13:14:28 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:14:28 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Live Music at the Legion",
        "day_of_week": "Saturday",
        "start_date": "2025-05-31",
        "end_date": "2025-05-31",
        "start_time": "15:00",
        "end_time": "18:00",
        "price": "",
        "location": "Royal Canadian Legion, Esquimalt Dockyard #172 102-622 Admirals Rd, V9A 2N7",
        "description": "Come enjoy live music on Saturdays 3-6 p. Dancing encouraged! Recurring event."
    }
]
```
2025-06-18 13:14:28 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/979769967649565/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Live Music at the Legion",
        "day_of_week": "Saturday",
        "start_date": "2025-05-31",
        "end_date": "2025-05-31",
        "start_time": "15:00",
        "end_time": "18:00",
        "price": "",
        "location": "Royal Canadian Legion, Esquimalt Dockyard #172 102-622 Admirals Rd, V9A 2N7",
        "description": "Come enjoy live music on Saturdays 3-6 p. Dancing encouraged! Recurring event."
    }
]
2025-06-18 13:14:28 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:14:28 - INFO - def clean_up_address(): Processing location 'Royal Canadian Legion, Esquimalt Dockyard #172 102-622 Admirals Rd, V9A 2N7' (event_id: None)
2025-06-18 13:14:28 - INFO - get_address_id: Inserted or updated address_id 8593 for address '622 Admirals RD, ESQUIMALT, BC, V9A2N7, CA'.
2025-06-18 13:14:28 - INFO - Populated from DB for postal code 'V9A2N7': '622 Admirals RD, ESQUIMALT, BC, V9A2N7, CA'
2025-06-18 13:14:28 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 13:14:28 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/979769967649565/'
2025-06-18 13:14:28 - INFO - def process_llm_response: URL https://www.facebook.com/events/979769967649565/ marked as relevant with events written to the database.
2025-06-18 13:14:28 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/979769967649565/.
2025-06-18 13:14:28 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/686146924271113/
2025-06-18 13:14:28 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/686146924271113/.
2025-06-18 13:14:28 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/686146924271113/
2025-06-18 13:14:28 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:14:28 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:14:28 - INFO - query_llm(): Querying Mistral
2025-06-18 13:14:32 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:14:32 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "Facebook",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Adonis Puentes & The Jazz Bohemians - Live at Hermann's Jazz",
        "day_of_week": "Thursday",
        "start_date": "2025-06-26",
        "end_date": "2025-06-26",
        "start_time": "19:00",
        "end_time": "22:00",
        "price": "",
        "location": "Hermann's Jazz, 753 View St, Victoria, BC V8W 1J9, Canada",
        "description": "An evening of Jazzy Cuban Fusion Music; traditional, contemporary, romance and dance. Juno & Grammy Nominated vocalist, Adonis Puentes, will be joined by the Jazz Bohemians, featuring Brent Jarvis (piano), Ken Lister (bass), Nicholas Marquez (percussion) and Brooke Maxwell (Sax)."
    }
]
```
2025-06-18 13:14:32 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/686146924271113/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Facebook",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Adonis Puentes & The Jazz Bohemians - Live at Hermann's Jazz",
        "day_of_week": "Thursday",
        "start_date": "2025-06-26",
        "end_date": "2025-06-26",
        "start_time": "19:00",
        "end_time": "22:00",
        "price": "",
        "location": "Hermann's Jazz, 753 View St, Victoria, BC V8W 1J9, Canada",
        "description": "An evening of Jazzy Cuban Fusion Music; traditional, contemporary, romance and dance. Juno & Grammy Nominated vocalist, Adonis Puentes, will be joined by the Jazz Bohemians, featuring Brent Jarvis (piano), Ken Lister (bass), Nicholas Marquez (percussion) and Brooke Maxwell (Sax)."
    }
]
2025-06-18 13:14:32 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:14:32 - INFO - def clean_up_address(): Processing location 'Hermann's Jazz, 753 View St, Victoria, BC V8W 1J9, Canada' (event_id: None)
2025-06-18 13:14:32 - INFO - def clean_up_address(): Updated event None with address_id 1246 using DB match
2025-06-18 13:14:32 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 13:14:32 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/686146924271113/'
2025-06-18 13:14:32 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:14:32 - INFO - def process_llm_response: URL https://www.facebook.com/events/686146924271113/ marked as relevant with events written to the database.
2025-06-18 13:14:32 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/686146924271113/.
2025-06-18 13:14:32 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/2579625309035667/
2025-06-18 13:14:32 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/2579625309035667/.
2025-06-18 13:14:32 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/2579625309035667/
2025-06-18 13:14:32 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:14:32 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:14:32 - INFO - query_llm(): Querying Mistral
2025-06-18 13:14:38 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:14:38 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Live Music @ Junction (RAIN OR SHINE)",
        "day_of_week": "Sunday",
        "start_date": "2025-05-18",
        "end_date": "2025-05-18",
        "start_time": "12:00",
        "end_time": "18:00",
        "price": "",
        "location": "Junction Orchard & Cidery, 284 Prospect Lake Rd, Saanich, BC V9E 1J7, Canada",
        "description": "Live Music @ Junction (RAIN OR SHINE). First Live Music of the year at Junction. Emergency Exit playing from 12:30-2:30pm. An & Ben playing from 3:00-5:00pm. Tasting Room and Picnic Area are open 12:00-6:00pm. This is an outdoor event so bring your well-behaved two-legged and 4-legged babies and dress appropriately coz we are going ahead RAIN OR SHINE!"
    }
]
```
2025-06-18 13:14:38 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/2579625309035667/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Live Music @ Junction (RAIN OR SHINE)",
        "day_of_week": "Sunday",
        "start_date": "2025-05-18",
        "end_date": "2025-05-18",
        "start_time": "12:00",
        "end_time": "18:00",
        "price": "",
        "location": "Junction Orchard & Cidery, 284 Prospect Lake Rd, Saanich, BC V9E 1J7, Canada",
        "description": "Live Music @ Junction (RAIN OR SHINE). First Live Music of the year at Junction. Emergency Exit playing from 12:30-2:30pm. An & Ben playing from 3:00-5:00pm. Tasting Room and Picnic Area are open 12:00-6:00pm. This is an outdoor event so bring your well-behaved two-legged and 4-legged babies and dress appropriately coz we are going ahead RAIN OR SHINE!"
    }
]
2025-06-18 13:14:38 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:14:38 - INFO - def clean_up_address(): Processing location 'Junction Orchard & Cidery, 284 Prospect Lake Rd, Saanich, BC V9E 1J7, Canada' (event_id: None)
2025-06-18 13:14:38 - INFO - def clean_up_address(): Updated event None with address_id 9811 using DB match
2025-06-18 13:14:38 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 13:14:38 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/2579625309035667/'
2025-06-18 13:14:38 - INFO - def process_llm_response: URL https://www.facebook.com/events/2579625309035667/ marked as relevant with events written to the database.
2025-06-18 13:14:38 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/2579625309035667/.
2025-06-18 13:14:38 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/4223643791110348/
2025-06-18 13:14:38 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/4223643791110348/.
2025-06-18 13:14:38 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/4223643791110348/
2025-06-18 13:14:38 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:14:38 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:14:38 - INFO - query_llm(): Querying Mistral
2025-06-18 13:14:41 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:14:41 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Victoria Italian Day",
    "day_of_week": "Sunday",
    "start_date": "2025-06-22",
    "end_date": "2025-06-22",
    "start_time": "13:00",
    "end_time": null,
    "price": "Free admission",
    "location": "195 Bay St, Victoria, BC V9A 3K4, Canada",
    "description": "Join us for live music, food, gelato, games, cars, cultural exhibits, vendors, bike valets and much more."
}]
```
2025-06-18 13:14:41 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/4223643791110348/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "Victoria Italian Day",
    "day_of_week": "Sunday",
    "start_date": "2025-06-22",
    "end_date": "2025-06-22",
    "start_time": "13:00",
    "end_time": null,
    "price": "Free admission",
    "location": "195 Bay St, Victoria, BC V9A 3K4, Canada",
    "description": "Join us for live music, food, gelato, games, cars, cultural exhibits, vendors, bike valets and much more."
}]
2025-06-18 13:14:41 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:14:41 - INFO - def clean_up_address(): Processing location '195 Bay St, Victoria, BC V9A 3K4, Canada' (event_id: None)
2025-06-18 13:14:41 - INFO - def clean_up_address(): Updated event None with address_id 2138 using DB match
2025-06-18 13:14:41 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 13:14:41 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/4223643791110348/'
2025-06-18 13:14:41 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:14:41 - INFO - def process_llm_response: URL https://www.facebook.com/events/4223643791110348/ marked as relevant with events written to the database.
2025-06-18 13:14:41 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/4223643791110348/.
2025-06-18 13:14:41 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1399479741193649/
2025-06-18 13:14:41 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1399479741193649/.
2025-06-18 13:14:41 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1399479741193649/
2025-06-18 13:14:41 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:14:41 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:14:41 - INFO - query_llm(): Querying Mistral
2025-06-18 13:14:44 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:14:44 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "Extracted from webpage text",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "LIVE MUSIC with VINYL WAVE",
    "day_of_week": "Tuesday",
    "start_date": "2025-06-17",
    "end_date": "2025-06-17",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Saxe Point Public House, 101-505 Park Place, Victoria",
    "description": "Join Vinyl Wave at the lovely Saxe Point Pub for a couple of hours of smooth tunes that'll help ease you into the week!"
}]
```
2025-06-18 13:14:44 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1399479741193649/, 
Cleaned JSON ready for parsing:
[{
    "source": "Extracted from webpage text",
    "dance_style": "",
    "url": "",
    "event_type": "live music",
    "event_name": "LIVE MUSIC with VINYL WAVE",
    "day_of_week": "Tuesday",
    "start_date": "2025-06-17",
    "end_date": "2025-06-17",
    "start_time": "",
    "end_time": "",
    "price": "",
    "location": "Saxe Point Public House, 101-505 Park Place, Victoria",
    "description": "Join Vinyl Wave at the lovely Saxe Point Pub for a couple of hours of smooth tunes that'll help ease you into the week!"
}]
2025-06-18 13:14:44 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:14:44 - INFO - def clean_up_address(): Processing location 'Saxe Point Public House, 101-505 Park Place, Victoria' (event_id: None)
2025-06-18 13:14:44 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 13:14:44 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1399479741193649/'
2025-06-18 13:14:44 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:14:44 - INFO - def process_llm_response: URL https://www.facebook.com/events/1399479741193649/ marked as relevant with events written to the database.
2025-06-18 13:14:44 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1399479741193649/.
2025-06-18 13:14:44 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1110747367748372/
2025-06-18 13:14:44 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1110747367748372/.
2025-06-18 13:14:44 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1110747367748372/
2025-06-18 13:14:44 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:14:44 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:14:44 - INFO - query_llm(): Querying Mistral
2025-06-18 13:14:49 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:14:49 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "",
        "url": "https://vicfolkfest.eventbrite.ca",
        "event_type": "live music",
        "event_name": "Victoria Folk Music Festival",
        "day_of_week": "Saturday",
        "start_date": "2025-07-05",
        "end_date": "2025-07-05",
        "start_time": "12:00",
        "end_time": null,
        "price": "Free-CA$86.53",
        "location": "Royal Athletic Park, 1014 Caledonia Ave, Victoria, BC",
        "description": "Join us for a joyful weekend of music, community, and celebration at Victoria Folk Music Festival, on July 5th set in beautiful Royal Athletic Park. Featuring a world-class lineup including Frazey Ford, Joel Plaskett, Kacy & Clayton, Harry Manx, Ferron, Old Man Luedecke, Vince Vaccaro, Canadian Beauty, Daneil Lapp's BC Fiddle Orchestra and more, this family-friendly event brings together the best in folk, roots, and Americana music. With two stages of live performances, the Victoria Folk Music Festival offers a full day of entertainment and community celebration. Explore the ReLove Vintage Pop-Up Market, showcasing top local vendors with the best in thrift, retro, and vintage wear. Enjoy a variety of Artisan goods and vendors, delicious food from Fresh Coast, Deadbeetz, Taco Revolution, and more. Families will love the vibrant children’s area—complete with a jumping castle! Dance in the grass to local Bluegrass groups and explore vendor booth from local music groups & organizations. A community-driven atmosphere with world-class music at its heart, this festival is set to be a summer highlight for music lovers of all ages."
    }
]
```
2025-06-18 13:14:49 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1110747367748372/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "",
        "url": "https://vicfolkfest.eventbrite.ca",
        "event_type": "live music",
        "event_name": "Victoria Folk Music Festival",
        "day_of_week": "Saturday",
        "start_date": "2025-07-05",
        "end_date": "2025-07-05",
        "start_time": "12:00",
        "end_time": null,
        "price": "Free-CA$86.53",
        "location": "Royal Athletic Park, 1014 Caledonia Ave, Victoria, BC",
        "description": "Join us for a joyful weekend of music, community, and celebration at Victoria Folk Music Festival, on July 5th set in beautiful Royal Athletic Park. Featuring a world-class lineup including Frazey Ford, Joel Plaskett, Kacy & Clayton, Harry Manx, Ferron, Old Man Luedecke, Vince Vaccaro, Canadian Beauty, Daneil Lapp's BC Fiddle Orchestra and more, this family-friendly event brings together the best in folk, roots, and Americana music. With two stages of live performances, the Victoria Folk Music Festival offers a full day of entertainment and community celebration. Explore the ReLove Vintage Pop-Up Market, showcasing top local vendors with the best in thrift, retro, and vintage wear. Enjoy a variety of Artisan goods and vendors, delicious food from Fresh Coast, Deadbeetz, Taco Revolution, and more. Families will love the vibrant children’s area—complete with a jumping castle! Dance in the grass to local Bluegrass groups and explore vendor booth from local music groups & organizations. A community-driven atmosphere with world-class music at its heart, this festival is set to be a summer highlight for music lovers of all ages."
    }
]
2025-06-18 13:14:49 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:14:49 - INFO - def clean_up_address(): Processing location 'Royal Athletic Park, 1014 Caledonia Ave, Victoria, BC' (event_id: None)
2025-06-18 13:14:49 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 13:14:49 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1110747367748372/'
2025-06-18 13:14:49 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:14:49 - INFO - def process_llm_response: URL https://www.facebook.com/events/1110747367748372/ marked as relevant with events written to the database.
2025-06-18 13:14:49 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1110747367748372/.
2025-06-18 13:14:49 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1050242777151793/
2025-06-18 13:14:49 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1050242777151793/.
2025-06-18 13:14:49 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1050242777151793/
2025-06-18 13:14:49 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:14:49 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:14:49 - INFO - query_llm(): Querying Mistral
2025-06-18 13:14:51 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:14:51 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "extracted_text",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "Pride Contra Dance",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-20",
    "start_time": "19:00",
    "end_time": "22:00",
    "price": "",
    "location": "",
    "description": "Pride Contra Dance"
}]
```
2025-06-18 13:14:51 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1050242777151793/, 
Cleaned JSON ready for parsing:
[{
    "source": "extracted_text",
    "dance_style": "",
    "url": "",
    "event_type": "social dance",
    "event_name": "Pride Contra Dance",
    "day_of_week": "Friday",
    "start_date": "2025-06-20",
    "end_date": "2025-06-20",
    "start_time": "19:00",
    "end_time": "22:00",
    "price": "",
    "location": "",
    "description": "Pride Contra Dance"
}]
2025-06-18 13:14:51 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:14:51 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 13:14:51 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1050242777151793/'
2025-06-18 13:14:51 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:14:51 - INFO - def process_llm_response: URL https://www.facebook.com/events/1050242777151793/ marked as relevant with events written to the database.
2025-06-18 13:14:51 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1050242777151793/.
2025-06-18 13:14:51 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1451663826076478/
2025-06-18 13:14:51 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1451663826076478/.
2025-06-18 13:14:51 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1451663826076478/
2025-06-18 13:14:51 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:14:51 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:14:51 - INFO - query_llm(): Querying Mistral
2025-06-18 13:14:56 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:14:56 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "extracted_text",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Saanich Strawberry Festival",
        "day_of_week": "Sunday",
        "start_date": "2025-07-06",
        "end_date": "2025-07-06",
        "start_time": "11:00",
        "end_time": "16:00",
        "price": "Free",
        "location": "Beaver Lake Regional Park, 728 Beaver Lake Rd, Saanich, BC V8Z 6K2, Canada",
        "description": "Join Saanich in celebrating the 58th annual Strawberry Festival. This family-friendly, fun, free event features live music, kids' activities, bouncy castles, information booths, arts and craft stations and, of course, the traditional servings of strawberries and ice cream. Strawberries and ice cream sales and service will be from 2 to 4pm, or until sold out. $2/serving. For more details, including vendors, activities and performances, visit saanich.ca/strawberryfestival."
    }
]
```
2025-06-18 13:14:56 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1451663826076478/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "extracted_text",
        "dance_style": "",
        "url": "",
        "event_type": "live music",
        "event_name": "Saanich Strawberry Festival",
        "day_of_week": "Sunday",
        "start_date": "2025-07-06",
        "end_date": "2025-07-06",
        "start_time": "11:00",
        "end_time": "16:00",
        "price": "Free",
        "location": "Beaver Lake Regional Park, 728 Beaver Lake Rd, Saanich, BC V8Z 6K2, Canada",
        "description": "Join Saanich in celebrating the 58th annual Strawberry Festival. This family-friendly, fun, free event features live music, kids' activities, bouncy castles, information booths, arts and craft stations and, of course, the traditional servings of strawberries and ice cream. Strawberries and ice cream sales and service will be from 2 to 4pm, or until sold out. $2/serving. For more details, including vendors, activities and performances, visit saanich.ca/strawberryfestival."
    }
]
2025-06-18 13:14:56 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:14:56 - INFO - def clean_up_address(): Processing location 'Beaver Lake Regional Park, 728 Beaver Lake Rd, Saanich, BC V8Z 6K2, Canada' (event_id: None)
2025-06-18 13:14:56 - INFO - get_address_id: Inserted or updated address_id 12557 for address '728 Beaver Lake RD, VICTORIA, BC, V8Z6K2, CA'.
2025-06-18 13:14:56 - INFO - Populated from DB for postal code 'V8Z6K2': '728 Beaver Lake RD, VICTORIA, BC, V8Z6K2, CA'
2025-06-18 13:14:56 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 13:14:56 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1451663826076478/'
2025-06-18 13:14:56 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:14:56 - INFO - def process_llm_response: URL https://www.facebook.com/events/1451663826076478/ marked as relevant with events written to the database.
2025-06-18 13:14:56 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1451663826076478/.
2025-06-18 13:14:56 - INFO - def driver_fb_search(): Processing Facebook URL: https://www.facebook.com/events/1514674672845802/
2025-06-18 13:14:56 - INFO - def driver_fb_search(): Keywords found in text for https://www.facebook.com/events/1514674672845802/.
2025-06-18 13:14:56 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1514674672845802/
2025-06-18 13:14:56 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:14:56 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:14:56 - INFO - query_llm(): Querying Mistral
2025-06-18 13:14:59 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:14:59 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "Oak Bay Parks, Recreation and Culture",
    "dance_style": "ballet, dance",
    "url": "https://www.oakbay.ca/.../oak-bay-summer-concerts-in-the.../",
    "event_type": "live music",
    "event_name": "Oak Bay Summer Concerts in the Park: Family Show",
    "day_of_week": "Saturday",
    "start_date": "2025-07-05",
    "end_date": "2025-07-05",
    "start_time": "14:00",
    "end_time": null,
    "price": "Free",
    "location": "Willows Beach Park, Oak Bay, 2778 Dalhousie St, Oak Bay, BC V8R, Canada",
    "description": "With a stunning backdrop of Willows Beach, these outdoor concerts gather the community to celebrate music and the arts. Presented by Oak Bay Parks, Recreation and Culture. Family Concert: lək̓ʷəŋən Traditional Dancers, Pacific Opera Victoria, STAGES Dance Company, and Marimba Mufaro."
}]
```
2025-06-18 13:14:59 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1514674672845802/, 
Cleaned JSON ready for parsing:
[{
    "source": "Oak Bay Parks, Recreation and Culture",
    "dance_style": "ballet, dance",
    "url": "https://www.oakbay.ca//oak-bay-summer-concerts-in-the/",
    "event_type": "live music",
    "event_name": "Oak Bay Summer Concerts in the Park: Family Show",
    "day_of_week": "Saturday",
    "start_date": "2025-07-05",
    "end_date": "2025-07-05",
    "start_time": "14:00",
    "end_time": null,
    "price": "Free",
    "location": "Willows Beach Park, Oak Bay, 2778 Dalhousie St, Oak Bay, BC V8R, Canada",
    "description": "With a stunning backdrop of Willows Beach, these outdoor concerts gather the community to celebrate music and the arts. Presented by Oak Bay Parks, Recreation and Culture. Family Concert: lək̓ʷəŋən Traditional Dancers, Pacific Opera Victoria, STAGES Dance Company, and Marimba Mufaro."
}]
2025-06-18 13:14:59 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:14:59 - INFO - def clean_up_address(): Processing location 'Willows Beach Park, Oak Bay, 2778 Dalhousie St, Oak Bay, BC V8R, Canada' (event_id: None)
2025-06-18 13:14:59 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 13:14:59 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1514674672845802/'
2025-06-18 13:14:59 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:14:59 - INFO - def process_llm_response: URL https://www.facebook.com/events/1514674672845802/ marked as relevant with events written to the database.
2025-06-18 13:14:59 - INFO - def driver_fb_search(): Events successfully written to DB for https://www.facebook.com/events/1514674672845802/.
2025-06-18 13:14:59 - INFO - def driver_fb_search(): Keywords checkpoint updated.
2025-06-18 13:14:59 - INFO - def driver_fb_urls(): Processing base URL: https://www.facebook.com/events/331996206027048/
2025-06-18 13:14:59 - INFO - should_process_url: URL https://www.facebook.com/events/331996206027048/ was last seen as relevant, processing it.
2025-06-18 13:15:06 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/331996206027048/ (11198 ms)
2025-06-18 13:15:22 - INFO - extract_event_text: extracted 10862 chars
2025-06-18 13:15:22 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/331996206027048/
2025-06-18 13:15:22 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:15:22 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:15:22 - INFO - query_llm(): Querying Mistral
2025-06-18 13:15:26 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:15:26 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "Facebook",
    "dance_style": "",
    "url": "https://www.swingvictoria.net/.../sdav-annual-general...",
    "event_type": "meeting",
    "event_name": "SDAV Annual General Meeting 2023",
    "day_of_week": "Sunday",
    "start_date": "2023-12-03",
    "end_date": "2023-12-03",
    "start_time": "13:00",
    "end_time": "14:00",
    "price": "",
    "location": "158 Medana Street, Victoria (in James Bay)",
    "description": "Annual General Meeting for the Swing Dance Association of Victoria. This event is in person with the option to attend online. For more information, please check out our website: https://www.swingvictoria.net/.../sdav-annual-general..."
}]
```
2025-06-18 13:15:26 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/331996206027048/, 
Cleaned JSON ready for parsing:
[{
    "source": "Facebook",
    "dance_style": "",
    "url": "https://www.swingvictoria.net//sdav-annual-general",
    "event_type": "meeting",
    "event_name": "SDAV Annual General Meeting 2023",
    "day_of_week": "Sunday",
    "start_date": "2023-12-03",
    "end_date": "2023-12-03",
    "start_time": "13:00",
    "end_time": "14:00",
    "price": "",
    "location": "158 Medana Street, Victoria (in James Bay)",
    "description": "Annual General Meeting for the Swing Dance Association of Victoria. This event is in person with the option to attend online. For more information, please check out our website: https://www.swingvictoria.net//sdav-annual-general"
}]
2025-06-18 13:15:26 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:15:26 - INFO - def clean_up_address(): Processing location '158 Medana Street, Victoria (in James Bay)' (event_id: None)
2025-06-18 13:15:26 - INFO - def clean_up_address(): Updated event None with address_id 2092 using DB match
2025-06-18 13:15:26 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 13:15:26 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/331996206027048/'
2025-06-18 13:15:26 - INFO - def driver_fb_urls(): Base URL marked processed: https://www.facebook.com/events/331996206027048/
2025-06-18 13:15:29 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/events/331996206027048/
2025-06-18 13:15:29 - INFO - extract_event_links(): Navigating to https://www.facebook.com/events/331996206027048/
2025-06-18 13:15:34 - INFO - extract_event_links(): Found 9 links on https://www.facebook.com/events/331996206027048/
2025-06-18 13:15:34 - INFO - should_process_url: URL https://www.facebook.com/events/457213090692060/ was last seen as relevant, processing it.
2025-06-18 13:15:40 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/457213090692060/ (11075 ms)
2025-06-18 13:16:04 - INFO - extract_event_text: extracted 4401 chars
2025-06-18 13:16:04 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/457213090692060/
2025-06-18 13:16:04 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:16:04 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:16:04 - INFO - query_llm(): Querying Mistral
2025-06-18 13:16:16 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:16:16 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "Facebook",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "BC CRABFEST - Serving an Authentic BC CrabBoil",
    "day_of_week": "Sunday",
    "start_date": "2025-06-29",
    "end_date": "2025-06-29",
    "start_time": "11:00",
    "end_time": "19:00",
    "price": "",
    "location": "Ship Point, Wharf St, Victoria, British Columbia",
    "description": "Get ready to crack some claws and dive into an authentic Taste of BC Summer's seafood experience! The 3rd BC CrabFest has a new home and is thrilled to announce its 2025 event, taking place on June 29th from 11:00 AM to 7:00 PM at the scenic Ship Point in Victoria’s Inner Harbour. The most delicious part of the festival is the opportunity to purchase a ticket for an irresistible BC Dungeness CrabBoil. Fresh from the docks to the on-site chefs, cooked to perfection and enjoyed harbourside with family and friends. This is the quintessential taste of BC Summertime. The BC Dungeness CrabBoil bucket features the freshest BC Dungeness crab, mussels, prawns/shrimp, potatoes, and corn, all sourced freshly and locally, directly from BC’s hardworking fishing families. This ocean-to-table experience guarantees high quality and ocean friendly sustainability, showcasing the best of what our coastal waters have to offer. Attendees can enjoy a lively Seaside Family Zone, featuring engaging activities for all ages, and all day programming in the Education Marketplace, where guests can dive into sustainable oceans and seafood practices. Reserve your crab and select a one-hour pickup window—then stay and enjoy the festival all day!"
}]
```
2025-06-18 13:16:16 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/457213090692060/, 
Cleaned JSON ready for parsing:
[{
    "source": "Facebook",
    "dance_style": "",
    "url": "",
    "event_type": "other",
    "event_name": "BC CRABFEST - Serving an Authentic BC CrabBoil",
    "day_of_week": "Sunday",
    "start_date": "2025-06-29",
    "end_date": "2025-06-29",
    "start_time": "11:00",
    "end_time": "19:00",
    "price": "",
    "location": "Ship Point, Wharf St, Victoria, British Columbia",
    "description": "Get ready to crack some claws and dive into an authentic Taste of BC Summer's seafood experience! The 3rd BC CrabFest has a new home and is thrilled to announce its 2025 event, taking place on June 29th from 11:00 AM to 7:00 PM at the scenic Ship Point in Victoria’s Inner Harbour. The most delicious part of the festival is the opportunity to purchase a ticket for an irresistible BC Dungeness CrabBoil. Fresh from the docks to the on-site chefs, cooked to perfection and enjoyed harbourside with family and friends. This is the quintessential taste of BC Summertime. The BC Dungeness CrabBoil bucket features the freshest BC Dungeness crab, mussels, prawns/shrimp, potatoes, and corn, all sourced freshly and locally, directly from BC’s hardworking fishing families. This ocean-to-table experience guarantees high quality and ocean friendly sustainability, showcasing the best of what our coastal waters have to offer. Attendees can enjoy a lively Seaside Family Zone, featuring engaging activities for all ages, and all day programming in the Education Marketplace, where guests can dive into sustainable oceans and seafood practices. Reserve your crab and select a one-hour pickup window—then stay and enjoy the festival all day!"
}]
2025-06-18 13:16:16 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:16:16 - INFO - def clean_up_address(): Processing location 'Ship Point, Wharf St, Victoria, British Columbia' (event_id: None)
2025-06-18 13:16:16 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 13:16:16 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/457213090692060/'
2025-06-18 13:16:16 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:16:16 - INFO - def driver_fb_urls(): Event URL marked processed: https://www.facebook.com/events/457213090692060/
2025-06-18 13:16:16 - INFO - should_process_url: URL https://www.facebook.com/events/1387535795799011/ has never been seen before, processing it.
2025-06-18 13:16:22 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1387535795799011/ (10095 ms)
2025-06-18 13:16:41 - INFO - extract_event_text: extracted 3781 chars
2025-06-18 13:16:41 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1387535795799011/
2025-06-18 13:16:41 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:16:41 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:16:41 - INFO - query_llm(): Querying Mistral
2025-06-18 13:16:47 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:16:47 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "Facebook",
        "dance_style": "swing",
        "url": "https://www.swingvictoria.net/events/swingin-in-the-shell",
        "event_type": "social dance",
        "event_name": "Swingin' in the Shell",
        "day_of_week": "Thursday",
        "start_date": "2025-07-03",
        "end_date": "2025-07-03",
        "start_time": "19:00",
        "end_time": "21:30",
        "price": "",
        "location": "Cameron Bandshell @ Beacon Hill Park, 350 Douglas St, Victoria, BC V8V 2P5, Canada",
        "description": "This summer will see the return of Swingin’ in the Shell, our outdoor dance event funded by the City of Victoria! Everyone is welcome for an hour beginner lesson followed by social dancing to live music from local bands. All ages, bodies, and abilities are welcome, and no partner or dance experience is necessary. Everyone is welcome to come enjoy the music. No tickets are required, but if you would like to make a donation or become a member to support the Swing Dance Association of Victoria and our events. Dates: Thursdays July 3: Avram McCaugherty and Friends with Teacher: Darryl Glenn July 10: The Flying Saucers with Teachers: Kevin and Christabel July 17: Slim Sandy and the Atomic Cocktails with Teachers: Evgeni and Katherine July 24: Live Band Dave Harris and Friends with Teachers: Catie and Dave"
    }
]
```
2025-06-18 13:16:47 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1387535795799011/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Facebook",
        "dance_style": "swing",
        "url": "https://www.swingvictoria.net/events/swingin-in-the-shell",
        "event_type": "social dance",
        "event_name": "Swingin' in the Shell",
        "day_of_week": "Thursday",
        "start_date": "2025-07-03",
        "end_date": "2025-07-03",
        "start_time": "19:00",
        "end_time": "21:30",
        "price": "",
        "location": "Cameron Bandshell @ Beacon Hill Park, 350 Douglas St, Victoria, BC V8V 2P5, Canada",
        "description": "This summer will see the return of Swingin’ in the Shell, our outdoor dance event funded by the City of Victoria! Everyone is welcome for an hour beginner lesson followed by social dancing to live music from local bands. All ages, bodies, and abilities are welcome, and no partner or dance experience is necessary. Everyone is welcome to come enjoy the music. No tickets are required, but if you would like to make a donation or become a member to support the Swing Dance Association of Victoria and our events. Dates: Thursdays July 3: Avram McCaugherty and Friends with Teacher: Darryl Glenn July 10: The Flying Saucers with Teachers: Kevin and Christabel July 17: Slim Sandy and the Atomic Cocktails with Teachers: Evgeni and Katherine July 24: Live Band Dave Harris and Friends with Teachers: Catie and Dave"
    }
]
2025-06-18 13:16:47 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:16:47 - INFO - def clean_up_address(): Processing location 'Cameron Bandshell @ Beacon Hill Park, 350 Douglas St, Victoria, BC V8V 2P5, Canada' (event_id: None)
2025-06-18 13:16:47 - INFO - def clean_up_address(): Updated event None with address_id 8482 using DB match
2025-06-18 13:16:47 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 13:16:47 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1387535795799011/'
2025-06-18 13:16:47 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:16:47 - INFO - def driver_fb_urls(): Event URL marked processed: https://www.facebook.com/events/1387535795799011/
2025-06-18 13:16:47 - INFO - should_process_url: URL https://www.facebook.com/events/1079095920918223/ has never been seen before, processing it.
2025-06-18 13:16:52 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1079095920918223/ (11816 ms)
2025-06-18 13:17:08 - INFO - extract_event_text: extracted 3300 chars
2025-06-18 13:17:08 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1079095920918223/
2025-06-18 13:17:08 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:17:08 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:17:08 - INFO - query_llm(): Querying Mistral
2025-06-18 13:17:11 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:17:11 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "Swing Dancing in City Square | Facebook",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Swing Dancing in City Square",
    "day_of_week": "Wednesday",
    "start_date": "2025-06-18",
    "end_date": "2025-06-18",
    "start_time": "18:30",
    "end_time": "20:30",
    "price": "FREE",
    "location": "Duncan City Hall, 200 Craig Street, Duncan, British Columbia",
    "description": "FREE community event weekly in June! Downtown Duncan Wednesday evenings starting at 6:30pm. The evening starts off with a beginner swing dance class (come early). After the class we’ll played recorded music for social dancing until things get quiet or 8:30pm, whichever comes first. Come with friends or to make friends! Fair weather event only, check Harbour City Swing socials for updates."
}]
```
2025-06-18 13:17:11 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1079095920918223/, 
Cleaned JSON ready for parsing:
[{
    "source": "Swing Dancing in City Square | Facebook",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Swing Dancing in City Square",
    "day_of_week": "Wednesday",
    "start_date": "2025-06-18",
    "end_date": "2025-06-18",
    "start_time": "18:30",
    "end_time": "20:30",
    "price": "FREE",
    "location": "Duncan City Hall, 200 Craig Street, Duncan, British Columbia",
    "description": "FREE community event weekly in June! Downtown Duncan Wednesday evenings starting at 6:30pm. The evening starts off with a beginner swing dance class (come early). After the class we’ll played recorded music for social dancing until things get quiet or 8:30pm, whichever comes first. Come with friends or to make friends! Fair weather event only, check Harbour City Swing socials for updates."
}]
2025-06-18 13:17:11 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:17:11 - INFO - def clean_up_address(): Processing location 'Duncan City Hall, 200 Craig Street, Duncan, British Columbia' (event_id: None)
2025-06-18 13:17:11 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 13:17:11 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1079095920918223/'
2025-06-18 13:17:11 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:17:11 - INFO - def driver_fb_urls(): Event URL marked processed: https://www.facebook.com/events/1079095920918223/
2025-06-18 13:17:11 - INFO - def driver_fb_urls(): Events_scraped flag set for base URL: https://www.facebook.com/events/331996206027048/
2025-06-18 13:17:11 - INFO - def driver_fb_urls(): Processing base URL: https://www.facebook.com/events/1863130401159642/
2025-06-18 13:17:11 - INFO - should_process_url: URL https://www.facebook.com/events/1863130401159642/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:17:17 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1863130401159642/ (14356 ms)
2025-06-18 13:17:43 - INFO - extract_event_text: extracted 3732 chars
2025-06-18 13:17:43 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1863130401159642/
2025-06-18 13:17:43 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:17:43 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:17:43 - INFO - query_llm(): Querying Mistral
2025-06-18 13:17:47 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:17:47 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "Facebook",
        "dance_style": "urban kiz",
        "url": "www.facebook.com/603799179/videos/916294810340366/",
        "event_type": "social dance",
        "event_name": "Kiz\\Met February",
        "day_of_week": "Saturday",
        "start_date": "2025-02-15",
        "end_date": "2025-02-15",
        "start_time": "21:00",
        "end_time": null,
        "price": "$25",
        "location": "Baza Dance Studios, 1304 Seymour St, Vancouver, BC V6B, Canada",
        "description": "Join us for Kiz\\Met February featuring an open level Urban Kiz lesson with Nathan L. Dance until late with Focus & Wuli on the decks. Pre-social class 'February Flow': Techniques and movements and how to connect them together to create interesting moments that express the music! We've got guest DJ Gaz on the decks; hot on the trail of his new single 'Bela Mulher Negra' with Selima Chica! Social only $20 transfer to garysaville@gmail.com or cash at the door."
    }
]
```
2025-06-18 13:17:47 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1863130401159642/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Facebook",
        "dance_style": "urban kiz",
        "url": "www.facebook.com/603799179/videos/916294810340366/",
        "event_type": "social dance",
        "event_name": "Kiz\\Met February",
        "day_of_week": "Saturday",
        "start_date": "2025-02-15",
        "end_date": "2025-02-15",
        "start_time": "21:00",
        "end_time": null,
        "price": "$25",
        "location": "Baza Dance Studios, 1304 Seymour St, Vancouver, BC V6B, Canada",
        "description": "Join us for Kiz\\Met February featuring an open level Urban Kiz lesson with Nathan L. Dance until late with Focus & Wuli on the decks. Pre-social class 'February Flow': Techniques and movements and how to connect them together to create interesting moments that express the music! We've got guest DJ Gaz on the decks; hot on the trail of his new single 'Bela Mulher Negra' with Selima Chica! Social only $20 transfer to garysaville@gmail.com or cash at the door."
    }
]
2025-06-18 13:17:47 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:17:47 - INFO - def clean_up_address(): Processing location 'Baza Dance Studios, 1304 Seymour St, Vancouver, BC V6B, Canada' (event_id: None)
2025-06-18 13:17:47 - INFO - def clean_up_address(): Updated event None with address_id 2642 using DB match
2025-06-18 13:17:47 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 13:17:47 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1863130401159642/'
2025-06-18 13:17:47 - INFO - def driver_fb_urls(): Base URL marked processed: https://www.facebook.com/events/1863130401159642/
2025-06-18 13:17:50 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/events/1863130401159642/
2025-06-18 13:17:50 - INFO - extract_event_links(): Navigating to https://www.facebook.com/events/1863130401159642/
2025-06-18 13:17:55 - INFO - extract_event_links(): Found 7 links on https://www.facebook.com/events/1863130401159642/
2025-06-18 13:17:55 - INFO - should_process_url: URL https://www.facebook.com/events/1381141813052937/ was last seen as relevant, processing it.
2025-06-18 13:18:02 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1381141813052937/ (11679 ms)
2025-06-18 13:18:23 - INFO - extract_event_text: extracted 4199 chars
2025-06-18 13:18:23 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1381141813052937/
2025-06-18 13:18:23 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:18:23 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:18:23 - INFO - query_llm(): Querying Mistral
2025-06-18 13:18:27 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:18:28 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "Facebook",
        "dance_style": "salsa, bachata, merengue",
        "url": "",
        "event_type": "social dance",
        "event_name": "Canada Day Latin Party – July 5th!",
        "day_of_week": "Saturday",
        "start_date": "2025-07-05",
        "end_date": "2025-07-05",
        "start_time": "20:00",
        "end_time": "23:59",
        "price": "$15",
        "location": "Ukrainian Cultural Centre, 3277 Douglas St., Victoria, BC",
        "description": "Let’s celebrate Canada Day with a night full of Latin rhythms, high-energy dancing, and patriotic vibes! Join us for the Canada Day Latin Party, where we bring the heat to the dance floor with Salsa, Bachata, Merengue & more! Dress Code: Wear red & white and show off your Canadian pride! Dance to the best Latin beats all night long! No partner? No problem! Join our fun intro class at 8:00 PM! Entry: $15 at the door – Bring cash, please! What to Expect: A high-energy Latin dance celebration, festive Canada Day decorations & party vibes, a welcoming dance community & an unforgettable night!"
    }
]
```
2025-06-18 13:18:28 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1381141813052937/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Facebook",
        "dance_style": "salsa, bachata, merengue",
        "url": "",
        "event_type": "social dance",
        "event_name": "Canada Day Latin Party – July 5th!",
        "day_of_week": "Saturday",
        "start_date": "2025-07-05",
        "end_date": "2025-07-05",
        "start_time": "20:00",
        "end_time": "23:59",
        "price": "$15",
        "location": "Ukrainian Cultural Centre, 3277 Douglas St., Victoria, BC",
        "description": "Let’s celebrate Canada Day with a night full of Latin rhythms, high-energy dancing, and patriotic vibes! Join us for the Canada Day Latin Party, where we bring the heat to the dance floor with Salsa, Bachata, Merengue & more! Dress Code: Wear red & white and show off your Canadian pride! Dance to the best Latin beats all night long! No partner? No problem! Join our fun intro class at 8:00 PM! Entry: $15 at the door – Bring cash, please! What to Expect: A high-energy Latin dance celebration, festive Canada Day decorations & party vibes, a welcoming dance community & an unforgettable night!"
    }
]
2025-06-18 13:18:28 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:18:28 - INFO - def clean_up_address(): Processing location 'Ukrainian Cultural Centre, 3277 Douglas St., Victoria, BC' (event_id: None)
2025-06-18 13:18:28 - INFO - def clean_up_address(): Updated event None with address_id 4317 using DB match
2025-06-18 13:18:28 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 13:18:28 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1381141813052937/'
2025-06-18 13:18:28 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:18:28 - INFO - def driver_fb_urls(): Event URL marked processed: https://www.facebook.com/events/1381141813052937/
2025-06-18 13:18:28 - INFO - def driver_fb_urls(): Events_scraped flag set for base URL: https://www.facebook.com/events/1863130401159642/
2025-06-18 13:18:28 - INFO - def driver_fb_urls(): Processing base URL: https://www.facebook.com/events/1594017944616421/
2025-06-18 13:18:28 - INFO - should_process_url: URL https://www.facebook.com/events/1594017944616421/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:18:33 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1594017944616421/ (11448 ms)
2025-06-18 13:18:44 - INFO - extract_event_text: extracted 2752 chars
2025-06-18 13:18:44 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1594017944616421/
2025-06-18 13:18:44 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:18:44 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:18:44 - INFO - query_llm(): Querying Mistral
2025-06-18 13:18:55 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:18:55 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "Facebook",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Oak Bay Tea Party",
        "day_of_week": "Friday",
        "start_date": "2025-06-06",
        "end_date": "2025-06-06",
        "start_time": "16:00",
        "end_time": "22:00",
        "price": "",
        "location": "Willows Park, 2778 Dalhousie St, Oak Bay, BC V8R, Canada",
        "description": "Join us for the first day of the Oak Bay Tea Party! The Oak Bay Tea Party is an annual community event held at Willows Park in Oak Bay, B.C. 2025 will mark the 63rd annual Oak Bay Tea Party!"
    }
]
```
2025-06-18 13:18:55 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1594017944616421/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Facebook",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Oak Bay Tea Party",
        "day_of_week": "Friday",
        "start_date": "2025-06-06",
        "end_date": "2025-06-06",
        "start_time": "16:00",
        "end_time": "22:00",
        "price": "",
        "location": "Willows Park, 2778 Dalhousie St, Oak Bay, BC V8R, Canada",
        "description": "Join us for the first day of the Oak Bay Tea Party! The Oak Bay Tea Party is an annual community event held at Willows Park in Oak Bay, B.C. 2025 will mark the 63rd annual Oak Bay Tea Party!"
    }
]
2025-06-18 13:18:55 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:18:55 - INFO - def clean_up_address(): Processing location 'Willows Park, 2778 Dalhousie St, Oak Bay, BC V8R, Canada' (event_id: None)
2025-06-18 13:18:55 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 13:18:55 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1594017944616421/'
2025-06-18 13:18:55 - INFO - def driver_fb_urls(): Base URL marked processed: https://www.facebook.com/events/1594017944616421/
2025-06-18 13:18:59 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/events/1594017944616421/
2025-06-18 13:18:59 - INFO - extract_event_links(): Navigating to https://www.facebook.com/events/1594017944616421/
2025-06-18 13:19:04 - INFO - extract_event_links(): Found 9 links on https://www.facebook.com/events/1594017944616421/
2025-06-18 13:19:04 - INFO - should_process_url: URL https://www.facebook.com/events/1080192430795046/ has never been seen before, processing it.
2025-06-18 13:19:09 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1080192430795046/ (14390 ms)
2025-06-18 13:19:26 - INFO - extract_event_text: extracted 3889 chars
2025-06-18 13:19:26 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1080192430795046/
2025-06-18 13:19:26 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:19:26 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:19:26 - INFO - query_llm(): Querying Mistral
2025-06-18 13:19:31 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:19:31 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "Facebook",
        "dance_style": "",
        "url": "https://aggv.ca/art-gallery-paint-in-2025/",
        "event_type": "other",
        "event_name": "Art Gallery Paint-In",
        "day_of_week": "Saturday",
        "start_date": "2025-07-19",
        "end_date": "2025-07-19",
        "start_time": "11:00",
        "end_time": "18:00",
        "price": "",
        "location": "Art Gallery of Greater Victoria, 238 Moss St, Victoria, BC V8V 4M4, Canada",
        "description": "The Art Gallery of Greater Victoria is excited to announce the 36th annual Art Gallery Paint-In on Saturday, July 19, 2025, from 11am-6pm. This beloved festival draws over 50,000 visitors annually to explore art along Moss Street and brings Vancouver Island artists together in celebration of art! One of the largest free art festivals of its kind in Canada, this event features artists, activities, music, food, and fun."
    }
]
```
2025-06-18 13:19:31 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1080192430795046/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Facebook",
        "dance_style": "",
        "url": "https://aggv.ca/art-gallery-paint-in-2025/",
        "event_type": "other",
        "event_name": "Art Gallery Paint-In",
        "day_of_week": "Saturday",
        "start_date": "2025-07-19",
        "end_date": "2025-07-19",
        "start_time": "11:00",
        "end_time": "18:00",
        "price": "",
        "location": "Art Gallery of Greater Victoria, 238 Moss St, Victoria, BC V8V 4M4, Canada",
        "description": "The Art Gallery of Greater Victoria is excited to announce the 36th annual Art Gallery Paint-In on Saturday, July 19, 2025, from 11am-6pm. This beloved festival draws over 50,000 visitors annually to explore art along Moss Street and brings Vancouver Island artists together in celebration of art! One of the largest free art festivals of its kind in Canada, this event features artists, activities, music, food, and fun."
    }
]
2025-06-18 13:19:31 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:19:31 - INFO - def clean_up_address(): Processing location 'Art Gallery of Greater Victoria, 238 Moss St, Victoria, BC V8V 4M4, Canada' (event_id: None)
2025-06-18 13:19:31 - INFO - get_address_id: Inserted or updated address_id 12563 for address '238 Moss ST, VICTORIA, BC, V8V4M4, CA'.
2025-06-18 13:19:31 - INFO - Populated from DB for postal code 'V8V4M4': '238 Moss ST, VICTORIA, BC, V8V4M4, CA'
2025-06-18 13:19:31 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 13:19:31 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1080192430795046/'
2025-06-18 13:19:31 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:19:31 - INFO - def driver_fb_urls(): Event URL marked processed: https://www.facebook.com/events/1080192430795046/
2025-06-18 13:19:31 - INFO - should_process_url: URL https://www.facebook.com/events/1163972955506339/ was last seen as relevant, processing it.
2025-06-18 13:19:37 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1163972955506339/ (14748 ms)
2025-06-18 13:20:00 - INFO - extract_event_text: extracted 4565 chars
2025-06-18 13:20:00 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1163972955506339/
2025-06-18 13:20:00 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:20:00 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:20:00 - INFO - query_llm(): Querying Mistral
2025-06-18 13:20:04 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:20:04 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "Facebook",
        "dance_style": "salsa, merengue",
        "url": "",
        "event_type": "live music",
        "event_name": "7th Annual ViVa! Victoria Latin Fest 2025",
        "day_of_week": "Saturday",
        "start_date": "2025-08-02",
        "end_date": "2025-08-03",
        "start_time": "12:00",
        "end_time": "18:00",
        "price": "FREE",
        "location": "Centennial Square, Victoria, BC, Canada",
        "description": "An unforgettable celebration of Latin culture in the heart of downtown Victoria! Join us for two vibrant days filled with live Latin bands, mouth-watering Latin American food, colorful arts and crafts, and non-stop fun for the whole family. This free family event brings together the rhythms, flavors, and spirit of Latin America, creating a joyful, inclusive space where everyone is welcome. From salsa and merengue beats to traditional cuisine and handmade artisan treasures, there’s something for all ages to enjoy."
    }
]
```
2025-06-18 13:20:04 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1163972955506339/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Facebook",
        "dance_style": "salsa, merengue",
        "url": "",
        "event_type": "live music",
        "event_name": "7th Annual ViVa! Victoria Latin Fest 2025",
        "day_of_week": "Saturday",
        "start_date": "2025-08-02",
        "end_date": "2025-08-03",
        "start_time": "12:00",
        "end_time": "18:00",
        "price": "FREE",
        "location": "Centennial Square, Victoria, BC, Canada",
        "description": "An unforgettable celebration of Latin culture in the heart of downtown Victoria! Join us for two vibrant days filled with live Latin bands, mouth-watering Latin American food, colorful arts and crafts, and non-stop fun for the whole family. This free family event brings together the rhythms, flavors, and spirit of Latin America, creating a joyful, inclusive space where everyone is welcome. From salsa and merengue beats to traditional cuisine and handmade artisan treasures, there’s something for all ages to enjoy."
    }
]
2025-06-18 13:20:04 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:20:04 - INFO - def clean_up_address(): Processing location 'Centennial Square, Victoria, BC, Canada' (event_id: None)
2025-06-18 13:20:04 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 13:20:04 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1163972955506339/'
2025-06-18 13:20:04 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:20:04 - INFO - def driver_fb_urls(): Event URL marked processed: https://www.facebook.com/events/1163972955506339/
2025-06-18 13:20:04 - INFO - should_process_url: URL https://www.facebook.com/events/698717786229454/ was last seen as relevant, processing it.
2025-06-18 13:20:11 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/698717786229454/ (12359 ms)
2025-06-18 13:20:30 - INFO - extract_event_text: extracted 3380 chars
2025-06-18 13:20:30 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/698717786229454/
2025-06-18 13:20:30 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:20:30 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:20:30 - INFO - query_llm(): Querying Mistral
2025-06-18 13:20:34 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:20:34 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "Facebook",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Gonzales Sunset Beach Party",
        "day_of_week": "Saturday",
        "start_date": "2025-07-12",
        "end_date": "2025-07-12",
        "start_time": "16:30",
        "end_time": "19:30",
        "price": "",
        "location": "1330 Fairfield Rd., Victoria, BC, Canada, British Columbia V8S 5J1",
        "description": "Gonzales Sunset Beach Party, presented by the Fairfield Gonzales Community Association (FGCA) is an evening event celebrating our neighborhood's love for arts and community at our beloved Gonzales Beach! Enjoy craft activities, food, local artisan vendors, and free Stand-Up Paddleboarding tours. There is no parking (except for accessible parking). Please walk, bike, or bus to the event."
    }
]
```
2025-06-18 13:20:34 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/698717786229454/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "Facebook",
        "dance_style": "",
        "url": "",
        "event_type": "other",
        "event_name": "Gonzales Sunset Beach Party",
        "day_of_week": "Saturday",
        "start_date": "2025-07-12",
        "end_date": "2025-07-12",
        "start_time": "16:30",
        "end_time": "19:30",
        "price": "",
        "location": "1330 Fairfield Rd., Victoria, BC, Canada, British Columbia V8S 5J1",
        "description": "Gonzales Sunset Beach Party, presented by the Fairfield Gonzales Community Association (FGCA) is an evening event celebrating our neighborhood's love for arts and community at our beloved Gonzales Beach! Enjoy craft activities, food, local artisan vendors, and free Stand-Up Paddleboarding tours. There is no parking (except for accessible parking). Please walk, bike, or bus to the event."
    }
]
2025-06-18 13:20:34 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:20:34 - INFO - def clean_up_address(): Processing location '1330 Fairfield Rd., Victoria, BC, Canada, British Columbia V8S 5J1' (event_id: None)
2025-06-18 13:20:34 - INFO - def clean_up_address(): Updated event None with address_id 12111 using DB match
2025-06-18 13:20:34 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 13:20:34 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/698717786229454/'
2025-06-18 13:20:34 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:20:34 - INFO - def driver_fb_urls(): Event URL marked processed: https://www.facebook.com/events/698717786229454/
2025-06-18 13:20:34 - INFO - def driver_fb_urls(): Events_scraped flag set for base URL: https://www.facebook.com/events/1594017944616421/
2025-06-18 13:20:34 - INFO - def driver_fb_urls(): Processing base URL: https://www.facebook.com/events/2108062343037268/
2025-06-18 13:20:34 - INFO - should_process_url: URL https://www.facebook.com/events/2108062343037268/ was last seen as not relevant but hit_ratio (1.00) > 0.1 or crawl_try (2) ≤ 3, processing it.
2025-06-18 13:20:40 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/2108062343037268/ (12506 ms)
2025-06-18 13:20:57 - INFO - extract_event_text: extracted 3326 chars
2025-06-18 13:20:57 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/2108062343037268/
2025-06-18 13:20:57 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:20:57 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:20:57 - INFO - query_llm(): Querying Mistral
2025-06-18 13:21:01 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:21:01 - INFO - query_llm(): Mistral response received: ```json
[
    {
        "source": "(20+) Salsa Friday mariachi Saturday fiesta! | Facebook",
        "dance_style": "salsa",
        "url": "",
        "event_type": "live music",
        "event_name": "Salsa Friday mariachi Saturday fiesta!",
        "day_of_week": "Friday",
        "start_date": "2025-05-30",
        "end_date": "2025-05-30",
        "start_time": "17:30",
        "end_time": null,
        "price": "Free entry",
        "location": "1 Dallas Rd, Victoria",
        "description": "¡Fin de Semana Mexicano en Fisherman’s Wharf! Two epic nights of Mexican music, flavours, and fiesta — FREE and family-friendly! Friday, May 30 @ 5:30 PM – Kick things off with the spicy salsa vibes of Miguelito Valdés! Get ready to dance all evening!"
    }
]
```
2025-06-18 13:21:01 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/2108062343037268/, 
Cleaned JSON ready for parsing:
[
    {
        "source": "(20+) Salsa Friday mariachi Saturday fiesta! | Facebook",
        "dance_style": "salsa",
        "url": "",
        "event_type": "live music",
        "event_name": "Salsa Friday mariachi Saturday fiesta!",
        "day_of_week": "Friday",
        "start_date": "2025-05-30",
        "end_date": "2025-05-30",
        "start_time": "17:30",
        "end_time": null,
        "price": "Free entry",
        "location": "1 Dallas Rd, Victoria",
        "description": "¡Fin de Semana Mexicano en Fisherman’s Wharf! Two epic nights of Mexican music, flavours, and fiesta — FREE and family-friendly! Friday, May 30 @ 5:30 PM – Kick things off with the spicy salsa vibes of Miguelito Valdés! Get ready to dance all evening!"
    }
]
2025-06-18 13:21:01 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:21:01 - INFO - def clean_up_address(): Processing location '1 Dallas Rd, Victoria' (event_id: None)
2025-06-18 13:21:01 - INFO - def clean_up_address(): Updated event None with address_id 10242 using DB match
2025-06-18 13:21:01 - INFO - write_events_to_db: No events remain after checking for end_date, skipping write.
2025-06-18 13:21:01 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/2108062343037268/'
2025-06-18 13:21:01 - INFO - def driver_fb_urls(): Base URL marked processed: https://www.facebook.com/events/2108062343037268/
2025-06-18 13:21:03 - INFO - extract_event_links(): Normalized URL: https://www.facebook.com/events/2108062343037268/
2025-06-18 13:21:03 - INFO - extract_event_links(): Navigating to https://www.facebook.com/events/2108062343037268/
2025-06-18 13:21:09 - INFO - extract_event_links(): Found 9 links on https://www.facebook.com/events/2108062343037268/
2025-06-18 13:21:09 - INFO - should_process_url: URL https://www.facebook.com/events/1375625583681530/ was last seen as relevant, processing it.
2025-06-18 13:21:14 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1375625583681530/ (10587 ms)
2025-06-18 13:21:30 - INFO - extract_event_text: extracted 2887 chars
2025-06-18 13:21:30 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1375625583681530/
2025-06-18 13:21:30 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:21:30 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:21:30 - INFO - query_llm(): Querying Mistral
2025-06-18 13:21:33 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:21:33 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "Facebook",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Swing Dancing in City Square",
    "day_of_week": "Wednesday",
    "start_date": "2025-06-18",
    "end_date": "2025-06-18",
    "start_time": "18:30",
    "end_time": null,
    "price": "",
    "location": "Duncan City Hall",
    "description": ""
}]
```
2025-06-18 13:21:33 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1375625583681530/, 
Cleaned JSON ready for parsing:
[{
    "source": "Facebook",
    "dance_style": "swing",
    "url": "",
    "event_type": "social dance",
    "event_name": "Swing Dancing in City Square",
    "day_of_week": "Wednesday",
    "start_date": "2025-06-18",
    "end_date": "2025-06-18",
    "start_time": "18:30",
    "end_time": null,
    "price": "",
    "location": "Duncan City Hall",
    "description": ""
}]
2025-06-18 13:21:33 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:21:33 - INFO - def clean_up_address(): Processing location 'Duncan City Hall' (event_id: None)
2025-06-18 13:21:33 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 13:21:33 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1375625583681530/'
2025-06-18 13:21:33 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:21:33 - INFO - def driver_fb_urls(): Event URL marked processed: https://www.facebook.com/events/1375625583681530/
2025-06-18 13:21:33 - INFO - should_process_url: URL https://www.facebook.com/events/1158685752423240/ was last seen as relevant, processing it.
2025-06-18 13:21:39 - INFO - extract_event_text: Navigating to https://www.facebook.com/events/1158685752423240/ (10127 ms)
2025-06-18 13:21:52 - INFO - extract_event_text: extracted 2960 chars
2025-06-18 13:21:52 - INFO - def generate_prompt(): Generating prompt for URL: https://www.facebook.com/events/1158685752423240/
2025-06-18 13:21:52 - INFO - def generate_prompt(): prompt type: text file path: prompts/fb_prompt.txt
2025-06-18 13:21:52 - INFO - def generate_prompt(): prompts/fb_prompt.txt
2025-06-18 13:21:52 - INFO - query_llm(): Querying Mistral
2025-06-18 13:21:55 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-18 13:21:55 - INFO - query_llm(): Mistral response received: ```json
[{
    "source": "Facebook",
    "dance_style": "salsa, bachata",
    "url": "",
    "event_type": "social dance",
    "event_name": "Saturday Salsa/Bachata Social June 28th",
    "day_of_week": "Saturday",
    "start_date": "2025-06-28",
    "end_date": "2025-06-28",
    "start_time": "20:00",
    "end_time": null,
    "price": "",
    "location": "Ukrainian Cultural Centre",
    "description": "Saturday Salsa/Bachata Social June 28th"
}]
```
2025-06-18 13:21:55 - INFO - def extract_and_parse_json(): for url https://www.facebook.com/events/1158685752423240/, 
Cleaned JSON ready for parsing:
[{
    "source": "Facebook",
    "dance_style": "salsa, bachata",
    "url": "",
    "event_type": "social dance",
    "event_name": "Saturday Salsa/Bachata Social June 28th",
    "day_of_week": "Saturday",
    "start_date": "2025-06-28",
    "end_date": "2025-06-28",
    "start_time": "20:00",
    "end_time": null,
    "price": "",
    "location": "Ukrainian Cultural Centre",
    "description": "Saturday Salsa/Bachata Social June 28th"
}]
2025-06-18 13:21:55 - INFO - def clean_up_address(): Starting with events_df shape: (1, 14)
2025-06-18 13:21:55 - INFO - def clean_up_address(): Processing location 'Ukrainian Cultural Centre' (event_id: None)
2025-06-18 13:21:55 - INFO - write_events_to_db: Number of events to write: 1
2025-06-18 13:21:55 - INFO - write_url_to_db(): appended URL 'https://www.facebook.com/events/1158685752423240/'
2025-06-18 13:21:55 - INFO - write_events_to_db: Events data written to the 'events' table.
2025-06-18 13:21:55 - INFO - def driver_fb_urls(): Event URL marked processed: https://www.facebook.com/events/1158685752423240/
2025-06-18 13:21:55 - INFO - def driver_fb_urls(): Events_scraped flag set for base URL: https://www.facebook.com/events/2108062343037268/
2025-06-18 13:21:55 - INFO - write_run_statistics(): Writing run statistics for Test Run 2025-06-18 12:15:31.
2025-06-18 13:21:56 - INFO - write_run_statistics(): Run statistics written to database for Test Run 2025-06-18 12:15:31.
2025-06-18 13:21:56 - INFO - def count_events_urls_end(): Wrote events and urls statistics to: fb.py
2025-06-18 13:21:56 - INFO - __main__: Finished the crawler process at 2025-06-18 13:21:56.343409
2025-06-18 13:21:56 - INFO - __main__: Elapsed time: 1:06:46.040763
